(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function ib(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var sb={exports:{}},nf={},ob={exports:{}},Se={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var du=Symbol.for("react.element"),ck=Symbol.for("react.portal"),uk=Symbol.for("react.fragment"),dk=Symbol.for("react.strict_mode"),hk=Symbol.for("react.profiler"),fk=Symbol.for("react.provider"),pk=Symbol.for("react.context"),mk=Symbol.for("react.forward_ref"),gk=Symbol.for("react.suspense"),yk=Symbol.for("react.memo"),vk=Symbol.for("react.lazy"),Zv=Symbol.iterator;function _k(t){return t===null||typeof t!="object"?null:(t=Zv&&t[Zv]||t["@@iterator"],typeof t=="function"?t:null)}var ab={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},lb=Object.assign,cb={};function tl(t,e,n){this.props=t,this.context=e,this.refs=cb,this.updater=n||ab}tl.prototype.isReactComponent={};tl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};tl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function ub(){}ub.prototype=tl.prototype;function Qg(t,e,n){this.props=t,this.context=e,this.refs=cb,this.updater=n||ab}var Yg=Qg.prototype=new ub;Yg.constructor=Qg;lb(Yg,tl.prototype);Yg.isPureReactComponent=!0;var e_=Array.isArray,db=Object.prototype.hasOwnProperty,Xg={current:null},hb={key:!0,ref:!0,__self:!0,__source:!0};function fb(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)db.call(e,r)&&!hb.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:du,type:t,key:s,ref:o,props:i,_owner:Xg.current}}function wk(t,e){return{$$typeof:du,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Jg(t){return typeof t=="object"&&t!==null&&t.$$typeof===du}function xk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var t_=/\/+/g;function np(t,e){return typeof t=="object"&&t!==null&&t.key!=null?xk(""+t.key):e.toString(36)}function Ed(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case du:case ck:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+np(o,0):r,e_(i)?(n="",t!=null&&(n=t.replace(t_,"$&/")+"/"),Ed(i,e,n,"",function(c){return c})):i!=null&&(Jg(i)&&(i=wk(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(t_,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",e_(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+np(s,a);o+=Ed(s,e,n,l,i)}else if(l=_k(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+np(s,a++),o+=Ed(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Fu(t,e,n){if(t==null)return t;var r=[],i=0;return Ed(t,r,"","",function(s){return e.call(n,s,i++)}),r}function bk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var on={current:null},Id={transition:null},Ek={ReactCurrentDispatcher:on,ReactCurrentBatchConfig:Id,ReactCurrentOwner:Xg};function pb(){throw Error("act(...) is not supported in production builds of React.")}Se.Children={map:Fu,forEach:function(t,e,n){Fu(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Fu(t,function(){e++}),e},toArray:function(t){return Fu(t,function(e){return e})||[]},only:function(t){if(!Jg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Se.Component=tl;Se.Fragment=uk;Se.Profiler=hk;Se.PureComponent=Qg;Se.StrictMode=dk;Se.Suspense=gk;Se.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ek;Se.act=pb;Se.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=lb({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Xg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)db.call(e,l)&&!hb.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:du,type:t.type,key:i,ref:s,props:r,_owner:o}};Se.createContext=function(t){return t={$$typeof:pk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:fk,_context:t},t.Consumer=t};Se.createElement=fb;Se.createFactory=function(t){var e=fb.bind(null,t);return e.type=t,e};Se.createRef=function(){return{current:null}};Se.forwardRef=function(t){return{$$typeof:mk,render:t}};Se.isValidElement=Jg;Se.lazy=function(t){return{$$typeof:vk,_payload:{_status:-1,_result:t},_init:bk}};Se.memo=function(t,e){return{$$typeof:yk,type:t,compare:e===void 0?null:e}};Se.startTransition=function(t){var e=Id.transition;Id.transition={};try{t()}finally{Id.transition=e}};Se.unstable_act=pb;Se.useCallback=function(t,e){return on.current.useCallback(t,e)};Se.useContext=function(t){return on.current.useContext(t)};Se.useDebugValue=function(){};Se.useDeferredValue=function(t){return on.current.useDeferredValue(t)};Se.useEffect=function(t,e){return on.current.useEffect(t,e)};Se.useId=function(){return on.current.useId()};Se.useImperativeHandle=function(t,e,n){return on.current.useImperativeHandle(t,e,n)};Se.useInsertionEffect=function(t,e){return on.current.useInsertionEffect(t,e)};Se.useLayoutEffect=function(t,e){return on.current.useLayoutEffect(t,e)};Se.useMemo=function(t,e){return on.current.useMemo(t,e)};Se.useReducer=function(t,e,n){return on.current.useReducer(t,e,n)};Se.useRef=function(t){return on.current.useRef(t)};Se.useState=function(t){return on.current.useState(t)};Se.useSyncExternalStore=function(t,e,n){return on.current.useSyncExternalStore(t,e,n)};Se.useTransition=function(){return on.current.useTransition()};Se.version="18.3.1";ob.exports=Se;var D=ob.exports;const K=ib(D);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ik=D,Tk=Symbol.for("react.element"),Sk=Symbol.for("react.fragment"),Ck=Object.prototype.hasOwnProperty,Ak=Ik.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kk={key:!0,ref:!0,__self:!0,__source:!0};function mb(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Ck.call(e,r)&&!kk.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Tk,type:t,key:s,ref:o,props:i,_owner:Ak.current}}nf.Fragment=Sk;nf.jsx=mb;nf.jsxs=mb;sb.exports=nf;var p=sb.exports,om={},gb={exports:{}},Bn={},yb={exports:{}},vb={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,L){var B=j.length;j.push(L);e:for(;0<B;){var G=B-1>>>1,U=j[G];if(0<i(U,L))j[G]=L,j[B]=U,B=G;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var L=j[0],B=j.pop();if(B!==L){j[0]=B;e:for(var G=0,U=j.length,Y=U>>>1;G<Y;){var X=2*(G+1)-1,ee=j[X],oe=X+1,fe=j[oe];if(0>i(ee,B))oe<U&&0>i(fe,ee)?(j[G]=fe,j[oe]=B,G=oe):(j[G]=ee,j[X]=B,G=X);else if(oe<U&&0>i(fe,B))j[G]=fe,j[oe]=B,G=oe;else break e}}return L}function i(j,L){var B=j.sortIndex-L.sortIndex;return B!==0?B:j.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,h=null,f=3,m=!1,E=!1,x=!1,R=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(j){for(var L=n(c);L!==null;){if(L.callback===null)r(c);else if(L.startTime<=j)r(c),L.sortIndex=L.expirationTime,e(l,L);else break;L=n(c)}}function k(j){if(x=!1,T(j),!E)if(n(l)!==null)E=!0,M(O);else{var L=n(c);L!==null&&$(k,L.startTime-j)}}function O(j,L){E=!1,x&&(x=!1,y(b),b=-1),m=!0;var B=f;try{for(T(L),h=n(l);h!==null&&(!(h.expirationTime>L)||j&&!C());){var G=h.callback;if(typeof G=="function"){h.callback=null,f=h.priorityLevel;var U=G(h.expirationTime<=L);L=t.unstable_now(),typeof U=="function"?h.callback=U:h===n(l)&&r(l),T(L)}else r(l);h=n(l)}if(h!==null)var Y=!0;else{var X=n(c);X!==null&&$(k,X.startTime-L),Y=!1}return Y}finally{h=null,f=B,m=!1}}var z=!1,S=null,b=-1,w=5,I=-1;function C(){return!(t.unstable_now()-I<w)}function N(){if(S!==null){var j=t.unstable_now();I=j;var L=!0;try{L=S(!0,j)}finally{L?A():(z=!1,S=null)}}else z=!1}var A;if(typeof v=="function")A=function(){v(N)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,F=P.port2;P.port1.onmessage=N,A=function(){F.postMessage(null)}}else A=function(){R(N,0)};function M(j){S=j,z||(z=!0,A())}function $(j,L){b=R(function(){j(t.unstable_now())},L)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){E||m||(E=!0,M(O))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(j){switch(f){case 1:case 2:case 3:var L=3;break;default:L=f}var B=f;f=L;try{return j()}finally{f=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,L){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var B=f;f=j;try{return L()}finally{f=B}},t.unstable_scheduleCallback=function(j,L,B){var G=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?G+B:G):B=G,j){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=B+U,j={id:d++,callback:L,priorityLevel:j,startTime:B,expirationTime:U,sortIndex:-1},B>G?(j.sortIndex=B,e(c,j),n(l)===null&&j===n(c)&&(x?(y(b),b=-1):x=!0,$(k,B-G))):(j.sortIndex=U,e(l,j),E||m||(E=!0,M(O))),j},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(j){var L=f;return function(){var B=f;f=L;try{return j.apply(this,arguments)}finally{f=B}}}})(vb);yb.exports=vb;var Rk=yb.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nk=D,Fn=Rk;function Z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _b=new Set,Tc={};function yo(t,e){ka(t,e),ka(t+"Capture",e)}function ka(t,e){for(Tc[t]=e,t=0;t<e.length;t++)_b.add(e[t])}var ui=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),am=Object.prototype.hasOwnProperty,Pk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,n_={},r_={};function Dk(t){return am.call(r_,t)?!0:am.call(n_,t)?!1:Pk.test(t)?r_[t]=!0:(n_[t]=!0,!1)}function Vk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Ok(t,e,n,r){if(e===null||typeof e>"u"||Vk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function an(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ht={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ht[t]=new an(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ht[e]=new an(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ht[t]=new an(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ht[t]=new an(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ht[t]=new an(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ht[t]=new an(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ht[t]=new an(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ht[t]=new an(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ht[t]=new an(t,5,!1,t.toLowerCase(),null,!1,!1)});var Zg=/[\-:]([a-z])/g;function e0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Zg,e0);Ht[e]=new an(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Zg,e0);Ht[e]=new an(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Zg,e0);Ht[e]=new an(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ht[t]=new an(t,1,!1,t.toLowerCase(),null,!1,!1)});Ht.xlinkHref=new an("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ht[t]=new an(t,1,!1,t.toLowerCase(),null,!0,!0)});function t0(t,e,n,r){var i=Ht.hasOwnProperty(e)?Ht[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Ok(e,n,i,r)&&(n=null),r||i===null?Dk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var _i=Nk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$u=Symbol.for("react.element"),na=Symbol.for("react.portal"),ra=Symbol.for("react.fragment"),n0=Symbol.for("react.strict_mode"),lm=Symbol.for("react.profiler"),wb=Symbol.for("react.provider"),xb=Symbol.for("react.context"),r0=Symbol.for("react.forward_ref"),cm=Symbol.for("react.suspense"),um=Symbol.for("react.suspense_list"),i0=Symbol.for("react.memo"),Di=Symbol.for("react.lazy"),bb=Symbol.for("react.offscreen"),i_=Symbol.iterator;function Rl(t){return t===null||typeof t!="object"?null:(t=i_&&t[i_]||t["@@iterator"],typeof t=="function"?t:null)}var at=Object.assign,rp;function Wl(t){if(rp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);rp=e&&e[1]||""}return`
`+rp+t}var ip=!1;function sp(t,e){if(!t||ip)return"";ip=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{ip=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Wl(t):""}function zk(t){switch(t.tag){case 5:return Wl(t.type);case 16:return Wl("Lazy");case 13:return Wl("Suspense");case 19:return Wl("SuspenseList");case 0:case 2:case 15:return t=sp(t.type,!1),t;case 11:return t=sp(t.type.render,!1),t;case 1:return t=sp(t.type,!0),t;default:return""}}function dm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ra:return"Fragment";case na:return"Portal";case lm:return"Profiler";case n0:return"StrictMode";case cm:return"Suspense";case um:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case xb:return(t.displayName||"Context")+".Consumer";case wb:return(t._context.displayName||"Context")+".Provider";case r0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case i0:return e=t.displayName||null,e!==null?e:dm(t.type)||"Memo";case Di:e=t._payload,t=t._init;try{return dm(t(e))}catch{}}return null}function Mk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return dm(e);case 8:return e===n0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function as(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Eb(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Lk(t){var e=Eb(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Uu(t){t._valueTracker||(t._valueTracker=Lk(t))}function Ib(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Eb(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Jd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function hm(t,e){var n=e.checked;return at({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function s_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=as(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Tb(t,e){e=e.checked,e!=null&&t0(t,"checked",e,!1)}function fm(t,e){Tb(t,e);var n=as(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?pm(t,e.type,n):e.hasOwnProperty("defaultValue")&&pm(t,e.type,as(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function o_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function pm(t,e,n){(e!=="number"||Jd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ql=Array.isArray;function ma(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+as(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function mm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Z(91));return at({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function a_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Z(92));if(Ql(n)){if(1<n.length)throw Error(Z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:as(n)}}function Sb(t,e){var n=as(e.value),r=as(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function l_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Cb(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function gm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Cb(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Bu,Ab=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Bu=Bu||document.createElement("div"),Bu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Bu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Sc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var lc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},jk=["Webkit","ms","Moz","O"];Object.keys(lc).forEach(function(t){jk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),lc[e]=lc[t]})});function kb(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||lc.hasOwnProperty(t)&&lc[t]?(""+e).trim():e+"px"}function Rb(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=kb(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var Fk=at({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ym(t,e){if(e){if(Fk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Z(62))}}function vm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var _m=null;function s0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var wm=null,ga=null,ya=null;function c_(t){if(t=pu(t)){if(typeof wm!="function")throw Error(Z(280));var e=t.stateNode;e&&(e=lf(e),wm(t.stateNode,t.type,e))}}function Nb(t){ga?ya?ya.push(t):ya=[t]:ga=t}function Pb(){if(ga){var t=ga,e=ya;if(ya=ga=null,c_(t),e)for(t=0;t<e.length;t++)c_(e[t])}}function Db(t,e){return t(e)}function Vb(){}var op=!1;function Ob(t,e,n){if(op)return t(e,n);op=!0;try{return Db(t,e,n)}finally{op=!1,(ga!==null||ya!==null)&&(Vb(),Pb())}}function Cc(t,e){var n=t.stateNode;if(n===null)return null;var r=lf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Z(231,e,typeof n));return n}var xm=!1;if(ui)try{var Nl={};Object.defineProperty(Nl,"passive",{get:function(){xm=!0}}),window.addEventListener("test",Nl,Nl),window.removeEventListener("test",Nl,Nl)}catch{xm=!1}function $k(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var cc=!1,Zd=null,eh=!1,bm=null,Uk={onError:function(t){cc=!0,Zd=t}};function Bk(t,e,n,r,i,s,o,a,l){cc=!1,Zd=null,$k.apply(Uk,arguments)}function qk(t,e,n,r,i,s,o,a,l){if(Bk.apply(this,arguments),cc){if(cc){var c=Zd;cc=!1,Zd=null}else throw Error(Z(198));eh||(eh=!0,bm=c)}}function vo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function zb(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function u_(t){if(vo(t)!==t)throw Error(Z(188))}function Hk(t){var e=t.alternate;if(!e){if(e=vo(t),e===null)throw Error(Z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return u_(i),t;if(s===r)return u_(i),e;s=s.sibling}throw Error(Z(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?t:e}function Mb(t){return t=Hk(t),t!==null?Lb(t):null}function Lb(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Lb(t);if(e!==null)return e;t=t.sibling}return null}var jb=Fn.unstable_scheduleCallback,d_=Fn.unstable_cancelCallback,Kk=Fn.unstable_shouldYield,Gk=Fn.unstable_requestPaint,pt=Fn.unstable_now,Wk=Fn.unstable_getCurrentPriorityLevel,o0=Fn.unstable_ImmediatePriority,Fb=Fn.unstable_UserBlockingPriority,th=Fn.unstable_NormalPriority,Qk=Fn.unstable_LowPriority,$b=Fn.unstable_IdlePriority,rf=null,Vr=null;function Yk(t){if(Vr&&typeof Vr.onCommitFiberRoot=="function")try{Vr.onCommitFiberRoot(rf,t,void 0,(t.current.flags&128)===128)}catch{}}var gr=Math.clz32?Math.clz32:Zk,Xk=Math.log,Jk=Math.LN2;function Zk(t){return t>>>=0,t===0?32:31-(Xk(t)/Jk|0)|0}var qu=64,Hu=4194304;function Yl(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function nh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Yl(a):(s&=o,s!==0&&(r=Yl(s)))}else o=n&~i,o!==0?r=Yl(o):s!==0&&(r=Yl(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-gr(e),i=1<<n,r|=t[n],e&=~i;return r}function eR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function tR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-gr(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=eR(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function Em(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ub(){var t=qu;return qu<<=1,!(qu&4194240)&&(qu=64),t}function ap(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function hu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-gr(e),t[e]=n}function nR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-gr(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function a0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-gr(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Ue=0;function Bb(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var qb,l0,Hb,Kb,Gb,Im=!1,Ku=[],Gi=null,Wi=null,Qi=null,Ac=new Map,kc=new Map,Mi=[],rR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function h_(t,e){switch(t){case"focusin":case"focusout":Gi=null;break;case"dragenter":case"dragleave":Wi=null;break;case"mouseover":case"mouseout":Qi=null;break;case"pointerover":case"pointerout":Ac.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":kc.delete(e.pointerId)}}function Pl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=pu(e),e!==null&&l0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function iR(t,e,n,r,i){switch(e){case"focusin":return Gi=Pl(Gi,t,e,n,r,i),!0;case"dragenter":return Wi=Pl(Wi,t,e,n,r,i),!0;case"mouseover":return Qi=Pl(Qi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ac.set(s,Pl(Ac.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,kc.set(s,Pl(kc.get(s)||null,t,e,n,r,i)),!0}return!1}function Wb(t){var e=Ls(t.target);if(e!==null){var n=vo(e);if(n!==null){if(e=n.tag,e===13){if(e=zb(n),e!==null){t.blockedOn=e,Gb(t.priority,function(){Hb(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Td(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Tm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);_m=r,n.target.dispatchEvent(r),_m=null}else return e=pu(n),e!==null&&l0(e),t.blockedOn=n,!1;e.shift()}return!0}function f_(t,e,n){Td(t)&&n.delete(e)}function sR(){Im=!1,Gi!==null&&Td(Gi)&&(Gi=null),Wi!==null&&Td(Wi)&&(Wi=null),Qi!==null&&Td(Qi)&&(Qi=null),Ac.forEach(f_),kc.forEach(f_)}function Dl(t,e){t.blockedOn===e&&(t.blockedOn=null,Im||(Im=!0,Fn.unstable_scheduleCallback(Fn.unstable_NormalPriority,sR)))}function Rc(t){function e(i){return Dl(i,t)}if(0<Ku.length){Dl(Ku[0],t);for(var n=1;n<Ku.length;n++){var r=Ku[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Gi!==null&&Dl(Gi,t),Wi!==null&&Dl(Wi,t),Qi!==null&&Dl(Qi,t),Ac.forEach(e),kc.forEach(e),n=0;n<Mi.length;n++)r=Mi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Mi.length&&(n=Mi[0],n.blockedOn===null);)Wb(n),n.blockedOn===null&&Mi.shift()}var va=_i.ReactCurrentBatchConfig,rh=!0;function oR(t,e,n,r){var i=Ue,s=va.transition;va.transition=null;try{Ue=1,c0(t,e,n,r)}finally{Ue=i,va.transition=s}}function aR(t,e,n,r){var i=Ue,s=va.transition;va.transition=null;try{Ue=4,c0(t,e,n,r)}finally{Ue=i,va.transition=s}}function c0(t,e,n,r){if(rh){var i=Tm(t,e,n,r);if(i===null)yp(t,e,r,ih,n),h_(t,r);else if(iR(i,t,e,n,r))r.stopPropagation();else if(h_(t,r),e&4&&-1<rR.indexOf(t)){for(;i!==null;){var s=pu(i);if(s!==null&&qb(s),s=Tm(t,e,n,r),s===null&&yp(t,e,r,ih,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else yp(t,e,r,null,n)}}var ih=null;function Tm(t,e,n,r){if(ih=null,t=s0(r),t=Ls(t),t!==null)if(e=vo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=zb(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return ih=t,null}function Qb(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wk()){case o0:return 1;case Fb:return 4;case th:case Qk:return 16;case $b:return 536870912;default:return 16}default:return 16}}var qi=null,u0=null,Sd=null;function Yb(){if(Sd)return Sd;var t,e=u0,n=e.length,r,i="value"in qi?qi.value:qi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Sd=i.slice(t,1<r?1-r:void 0)}function Cd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Gu(){return!0}function p_(){return!1}function qn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Gu:p_,this.isPropagationStopped=p_,this}return at(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Gu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Gu)},persist:function(){},isPersistent:Gu}),e}var nl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},d0=qn(nl),fu=at({},nl,{view:0,detail:0}),lR=qn(fu),lp,cp,Vl,sf=at({},fu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:h0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Vl&&(Vl&&t.type==="mousemove"?(lp=t.screenX-Vl.screenX,cp=t.screenY-Vl.screenY):cp=lp=0,Vl=t),lp)},movementY:function(t){return"movementY"in t?t.movementY:cp}}),m_=qn(sf),cR=at({},sf,{dataTransfer:0}),uR=qn(cR),dR=at({},fu,{relatedTarget:0}),up=qn(dR),hR=at({},nl,{animationName:0,elapsedTime:0,pseudoElement:0}),fR=qn(hR),pR=at({},nl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),mR=qn(pR),gR=at({},nl,{data:0}),g_=qn(gR),yR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_R={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wR(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=_R[t])?!!e[t]:!1}function h0(){return wR}var xR=at({},fu,{key:function(t){if(t.key){var e=yR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Cd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?vR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:h0,charCode:function(t){return t.type==="keypress"?Cd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Cd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),bR=qn(xR),ER=at({},sf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),y_=qn(ER),IR=at({},fu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:h0}),TR=qn(IR),SR=at({},nl,{propertyName:0,elapsedTime:0,pseudoElement:0}),CR=qn(SR),AR=at({},sf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),kR=qn(AR),RR=[9,13,27,32],f0=ui&&"CompositionEvent"in window,uc=null;ui&&"documentMode"in document&&(uc=document.documentMode);var NR=ui&&"TextEvent"in window&&!uc,Xb=ui&&(!f0||uc&&8<uc&&11>=uc),v_=" ",__=!1;function Jb(t,e){switch(t){case"keyup":return RR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zb(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ia=!1;function PR(t,e){switch(t){case"compositionend":return Zb(e);case"keypress":return e.which!==32?null:(__=!0,v_);case"textInput":return t=e.data,t===v_&&__?null:t;default:return null}}function DR(t,e){if(ia)return t==="compositionend"||!f0&&Jb(t,e)?(t=Yb(),Sd=u0=qi=null,ia=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Xb&&e.locale!=="ko"?null:e.data;default:return null}}var VR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function w_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!VR[t.type]:e==="textarea"}function eE(t,e,n,r){Nb(r),e=sh(e,"onChange"),0<e.length&&(n=new d0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var dc=null,Nc=null;function OR(t){dE(t,0)}function of(t){var e=aa(t);if(Ib(e))return t}function zR(t,e){if(t==="change")return e}var tE=!1;if(ui){var dp;if(ui){var hp="oninput"in document;if(!hp){var x_=document.createElement("div");x_.setAttribute("oninput","return;"),hp=typeof x_.oninput=="function"}dp=hp}else dp=!1;tE=dp&&(!document.documentMode||9<document.documentMode)}function b_(){dc&&(dc.detachEvent("onpropertychange",nE),Nc=dc=null)}function nE(t){if(t.propertyName==="value"&&of(Nc)){var e=[];eE(e,Nc,t,s0(t)),Ob(OR,e)}}function MR(t,e,n){t==="focusin"?(b_(),dc=e,Nc=n,dc.attachEvent("onpropertychange",nE)):t==="focusout"&&b_()}function LR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return of(Nc)}function jR(t,e){if(t==="click")return of(e)}function FR(t,e){if(t==="input"||t==="change")return of(e)}function $R(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var wr=typeof Object.is=="function"?Object.is:$R;function Pc(t,e){if(wr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!am.call(e,i)||!wr(t[i],e[i]))return!1}return!0}function E_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function I_(t,e){var n=E_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=E_(n)}}function rE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?rE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function iE(){for(var t=window,e=Jd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Jd(t.document)}return e}function p0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function UR(t){var e=iE(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&rE(n.ownerDocument.documentElement,n)){if(r!==null&&p0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=I_(n,s);var o=I_(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var BR=ui&&"documentMode"in document&&11>=document.documentMode,sa=null,Sm=null,hc=null,Cm=!1;function T_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Cm||sa==null||sa!==Jd(r)||(r=sa,"selectionStart"in r&&p0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),hc&&Pc(hc,r)||(hc=r,r=sh(Sm,"onSelect"),0<r.length&&(e=new d0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=sa)))}function Wu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var oa={animationend:Wu("Animation","AnimationEnd"),animationiteration:Wu("Animation","AnimationIteration"),animationstart:Wu("Animation","AnimationStart"),transitionend:Wu("Transition","TransitionEnd")},fp={},sE={};ui&&(sE=document.createElement("div").style,"AnimationEvent"in window||(delete oa.animationend.animation,delete oa.animationiteration.animation,delete oa.animationstart.animation),"TransitionEvent"in window||delete oa.transitionend.transition);function af(t){if(fp[t])return fp[t];if(!oa[t])return t;var e=oa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in sE)return fp[t]=e[n];return t}var oE=af("animationend"),aE=af("animationiteration"),lE=af("animationstart"),cE=af("transitionend"),uE=new Map,S_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(t,e){uE.set(t,e),yo(e,[t])}for(var pp=0;pp<S_.length;pp++){var mp=S_[pp],qR=mp.toLowerCase(),HR=mp[0].toUpperCase()+mp.slice(1);fs(qR,"on"+HR)}fs(oE,"onAnimationEnd");fs(aE,"onAnimationIteration");fs(lE,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(cE,"onTransitionEnd");ka("onMouseEnter",["mouseout","mouseover"]);ka("onMouseLeave",["mouseout","mouseover"]);ka("onPointerEnter",["pointerout","pointerover"]);ka("onPointerLeave",["pointerout","pointerover"]);yo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));yo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));yo("onBeforeInput",["compositionend","keypress","textInput","paste"]);yo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));yo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xl));function C_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,qk(r,e,void 0,t),t.currentTarget=null}function dE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;C_(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;C_(i,a,c),s=l}}}if(eh)throw t=bm,eh=!1,bm=null,t}function Je(t,e){var n=e[Pm];n===void 0&&(n=e[Pm]=new Set);var r=t+"__bubble";n.has(r)||(hE(e,t,2,!1),n.add(r))}function gp(t,e,n){var r=0;e&&(r|=4),hE(n,t,r,e)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function Dc(t){if(!t[Qu]){t[Qu]=!0,_b.forEach(function(n){n!=="selectionchange"&&(KR.has(n)||gp(n,!1,t),gp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Qu]||(e[Qu]=!0,gp("selectionchange",!1,e))}}function hE(t,e,n,r){switch(Qb(e)){case 1:var i=oR;break;case 4:i=aR;break;default:i=c0}n=i.bind(null,e,n,t),i=void 0,!xm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function yp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ls(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}Ob(function(){var c=s,d=s0(n),h=[];e:{var f=uE.get(t);if(f!==void 0){var m=d0,E=t;switch(t){case"keypress":if(Cd(n)===0)break e;case"keydown":case"keyup":m=bR;break;case"focusin":E="focus",m=up;break;case"focusout":E="blur",m=up;break;case"beforeblur":case"afterblur":m=up;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=m_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=uR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=TR;break;case oE:case aE:case lE:m=fR;break;case cE:m=CR;break;case"scroll":m=lR;break;case"wheel":m=kR;break;case"copy":case"cut":case"paste":m=mR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=y_}var x=(e&4)!==0,R=!x&&t==="scroll",y=x?f!==null?f+"Capture":null:f;x=[];for(var v=c,T;v!==null;){T=v;var k=T.stateNode;if(T.tag===5&&k!==null&&(T=k,y!==null&&(k=Cc(v,y),k!=null&&x.push(Vc(v,k,T)))),R)break;v=v.return}0<x.length&&(f=new m(f,E,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==_m&&(E=n.relatedTarget||n.fromElement)&&(Ls(E)||E[di]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(E=n.relatedTarget||n.toElement,m=c,E=E?Ls(E):null,E!==null&&(R=vo(E),E!==R||E.tag!==5&&E.tag!==6)&&(E=null)):(m=null,E=c),m!==E)){if(x=m_,k="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(x=y_,k="onPointerLeave",y="onPointerEnter",v="pointer"),R=m==null?f:aa(m),T=E==null?f:aa(E),f=new x(k,v+"leave",m,n,d),f.target=R,f.relatedTarget=T,k=null,Ls(d)===c&&(x=new x(y,v+"enter",E,n,d),x.target=T,x.relatedTarget=R,k=x),R=k,m&&E)t:{for(x=m,y=E,v=0,T=x;T;T=jo(T))v++;for(T=0,k=y;k;k=jo(k))T++;for(;0<v-T;)x=jo(x),v--;for(;0<T-v;)y=jo(y),T--;for(;v--;){if(x===y||y!==null&&x===y.alternate)break t;x=jo(x),y=jo(y)}x=null}else x=null;m!==null&&A_(h,f,m,x,!1),E!==null&&R!==null&&A_(h,R,E,x,!0)}}e:{if(f=c?aa(c):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var O=zR;else if(w_(f))if(tE)O=FR;else{O=LR;var z=MR}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=jR);if(O&&(O=O(t,c))){eE(h,O,n,d);break e}z&&z(t,f,c),t==="focusout"&&(z=f._wrapperState)&&z.controlled&&f.type==="number"&&pm(f,"number",f.value)}switch(z=c?aa(c):window,t){case"focusin":(w_(z)||z.contentEditable==="true")&&(sa=z,Sm=c,hc=null);break;case"focusout":hc=Sm=sa=null;break;case"mousedown":Cm=!0;break;case"contextmenu":case"mouseup":case"dragend":Cm=!1,T_(h,n,d);break;case"selectionchange":if(BR)break;case"keydown":case"keyup":T_(h,n,d)}var S;if(f0)e:{switch(t){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else ia?Jb(t,n)&&(b="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(b="onCompositionStart");b&&(Xb&&n.locale!=="ko"&&(ia||b!=="onCompositionStart"?b==="onCompositionEnd"&&ia&&(S=Yb()):(qi=d,u0="value"in qi?qi.value:qi.textContent,ia=!0)),z=sh(c,b),0<z.length&&(b=new g_(b,t,null,n,d),h.push({event:b,listeners:z}),S?b.data=S:(S=Zb(n),S!==null&&(b.data=S)))),(S=NR?PR(t,n):DR(t,n))&&(c=sh(c,"onBeforeInput"),0<c.length&&(d=new g_("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=S))}dE(h,e)})}function Vc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function sh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Cc(t,n),s!=null&&r.unshift(Vc(t,s,i)),s=Cc(t,e),s!=null&&r.push(Vc(t,s,i))),t=t.return}return r}function jo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function A_(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Cc(n,s),l!=null&&o.unshift(Vc(n,l,a))):i||(l=Cc(n,s),l!=null&&o.push(Vc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var GR=/\r\n?/g,WR=/\u0000|\uFFFD/g;function k_(t){return(typeof t=="string"?t:""+t).replace(GR,`
`).replace(WR,"")}function Yu(t,e,n){if(e=k_(e),k_(t)!==e&&n)throw Error(Z(425))}function oh(){}var Am=null,km=null;function Rm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Nm=typeof setTimeout=="function"?setTimeout:void 0,QR=typeof clearTimeout=="function"?clearTimeout:void 0,R_=typeof Promise=="function"?Promise:void 0,YR=typeof queueMicrotask=="function"?queueMicrotask:typeof R_<"u"?function(t){return R_.resolve(null).then(t).catch(XR)}:Nm;function XR(t){setTimeout(function(){throw t})}function vp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Rc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Rc(e)}function Yi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function N_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var rl=Math.random().toString(36).slice(2),Nr="__reactFiber$"+rl,Oc="__reactProps$"+rl,di="__reactContainer$"+rl,Pm="__reactEvents$"+rl,JR="__reactListeners$"+rl,ZR="__reactHandles$"+rl;function Ls(t){var e=t[Nr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[di]||n[Nr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=N_(t);t!==null;){if(n=t[Nr])return n;t=N_(t)}return e}t=n,n=t.parentNode}return null}function pu(t){return t=t[Nr]||t[di],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function aa(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Z(33))}function lf(t){return t[Oc]||null}var Dm=[],la=-1;function ps(t){return{current:t}}function Ze(t){0>la||(t.current=Dm[la],Dm[la]=null,la--)}function Ge(t,e){la++,Dm[la]=t.current,t.current=e}var ls={},Zt=ps(ls),vn=ps(!1),Xs=ls;function Ra(t,e){var n=t.type.contextTypes;if(!n)return ls;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function _n(t){return t=t.childContextTypes,t!=null}function ah(){Ze(vn),Ze(Zt)}function P_(t,e,n){if(Zt.current!==ls)throw Error(Z(168));Ge(Zt,e),Ge(vn,n)}function fE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Z(108,Mk(t)||"Unknown",i));return at({},n,r)}function lh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ls,Xs=Zt.current,Ge(Zt,t),Ge(vn,vn.current),!0}function D_(t,e,n){var r=t.stateNode;if(!r)throw Error(Z(169));n?(t=fE(t,e,Xs),r.__reactInternalMemoizedMergedChildContext=t,Ze(vn),Ze(Zt),Ge(Zt,t)):Ze(vn),Ge(vn,n)}var Xr=null,cf=!1,_p=!1;function pE(t){Xr===null?Xr=[t]:Xr.push(t)}function eN(t){cf=!0,pE(t)}function ms(){if(!_p&&Xr!==null){_p=!0;var t=0,e=Ue;try{var n=Xr;for(Ue=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Xr=null,cf=!1}catch(i){throw Xr!==null&&(Xr=Xr.slice(t+1)),jb(o0,ms),i}finally{Ue=e,_p=!1}}return null}var ca=[],ua=0,ch=null,uh=0,Wn=[],Qn=0,Js=null,Zr=1,ei="";function ks(t,e){ca[ua++]=uh,ca[ua++]=ch,ch=t,uh=e}function mE(t,e,n){Wn[Qn++]=Zr,Wn[Qn++]=ei,Wn[Qn++]=Js,Js=t;var r=Zr;t=ei;var i=32-gr(r)-1;r&=~(1<<i),n+=1;var s=32-gr(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Zr=1<<32-gr(e)+i|n<<i|r,ei=s+t}else Zr=1<<s|n<<i|r,ei=t}function m0(t){t.return!==null&&(ks(t,1),mE(t,1,0))}function g0(t){for(;t===ch;)ch=ca[--ua],ca[ua]=null,uh=ca[--ua],ca[ua]=null;for(;t===Js;)Js=Wn[--Qn],Wn[Qn]=null,ei=Wn[--Qn],Wn[Qn]=null,Zr=Wn[--Qn],Wn[Qn]=null}var Mn=null,On=null,tt=!1,fr=null;function gE(t,e){var n=Yn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function V_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Mn=t,On=Yi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Mn=t,On=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Js!==null?{id:Zr,overflow:ei}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Yn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Mn=t,On=null,!0):!1;default:return!1}}function Vm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Om(t){if(tt){var e=On;if(e){var n=e;if(!V_(t,e)){if(Vm(t))throw Error(Z(418));e=Yi(n.nextSibling);var r=Mn;e&&V_(t,e)?gE(r,n):(t.flags=t.flags&-4097|2,tt=!1,Mn=t)}}else{if(Vm(t))throw Error(Z(418));t.flags=t.flags&-4097|2,tt=!1,Mn=t}}}function O_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Mn=t}function Xu(t){if(t!==Mn)return!1;if(!tt)return O_(t),tt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Rm(t.type,t.memoizedProps)),e&&(e=On)){if(Vm(t))throw yE(),Error(Z(418));for(;e;)gE(t,e),e=Yi(e.nextSibling)}if(O_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){On=Yi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}On=null}}else On=Mn?Yi(t.stateNode.nextSibling):null;return!0}function yE(){for(var t=On;t;)t=Yi(t.nextSibling)}function Na(){On=Mn=null,tt=!1}function y0(t){fr===null?fr=[t]:fr.push(t)}var tN=_i.ReactCurrentBatchConfig;function Ol(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,t))}return t}function Ju(t,e){throw t=Object.prototype.toString.call(e),Error(Z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function z_(t){var e=t._init;return e(t._payload)}function vE(t){function e(y,v){if(t){var T=y.deletions;T===null?(y.deletions=[v],y.flags|=16):T.push(v)}}function n(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function i(y,v){return y=es(y,v),y.index=0,y.sibling=null,y}function s(y,v,T){return y.index=T,t?(T=y.alternate,T!==null?(T=T.index,T<v?(y.flags|=2,v):T):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,v,T,k){return v===null||v.tag!==6?(v=Sp(T,y.mode,k),v.return=y,v):(v=i(v,T),v.return=y,v)}function l(y,v,T,k){var O=T.type;return O===ra?d(y,v,T.props.children,k,T.key):v!==null&&(v.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Di&&z_(O)===v.type)?(k=i(v,T.props),k.ref=Ol(y,v,T),k.return=y,k):(k=Vd(T.type,T.key,T.props,null,y.mode,k),k.ref=Ol(y,v,T),k.return=y,k)}function c(y,v,T,k){return v===null||v.tag!==4||v.stateNode.containerInfo!==T.containerInfo||v.stateNode.implementation!==T.implementation?(v=Cp(T,y.mode,k),v.return=y,v):(v=i(v,T.children||[]),v.return=y,v)}function d(y,v,T,k,O){return v===null||v.tag!==7?(v=Ks(T,y.mode,k,O),v.return=y,v):(v=i(v,T),v.return=y,v)}function h(y,v,T){if(typeof v=="string"&&v!==""||typeof v=="number")return v=Sp(""+v,y.mode,T),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case $u:return T=Vd(v.type,v.key,v.props,null,y.mode,T),T.ref=Ol(y,null,v),T.return=y,T;case na:return v=Cp(v,y.mode,T),v.return=y,v;case Di:var k=v._init;return h(y,k(v._payload),T)}if(Ql(v)||Rl(v))return v=Ks(v,y.mode,T,null),v.return=y,v;Ju(y,v)}return null}function f(y,v,T,k){var O=v!==null?v.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return O!==null?null:a(y,v,""+T,k);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case $u:return T.key===O?l(y,v,T,k):null;case na:return T.key===O?c(y,v,T,k):null;case Di:return O=T._init,f(y,v,O(T._payload),k)}if(Ql(T)||Rl(T))return O!==null?null:d(y,v,T,k,null);Ju(y,T)}return null}function m(y,v,T,k,O){if(typeof k=="string"&&k!==""||typeof k=="number")return y=y.get(T)||null,a(v,y,""+k,O);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case $u:return y=y.get(k.key===null?T:k.key)||null,l(v,y,k,O);case na:return y=y.get(k.key===null?T:k.key)||null,c(v,y,k,O);case Di:var z=k._init;return m(y,v,T,z(k._payload),O)}if(Ql(k)||Rl(k))return y=y.get(T)||null,d(v,y,k,O,null);Ju(v,k)}return null}function E(y,v,T,k){for(var O=null,z=null,S=v,b=v=0,w=null;S!==null&&b<T.length;b++){S.index>b?(w=S,S=null):w=S.sibling;var I=f(y,S,T[b],k);if(I===null){S===null&&(S=w);break}t&&S&&I.alternate===null&&e(y,S),v=s(I,v,b),z===null?O=I:z.sibling=I,z=I,S=w}if(b===T.length)return n(y,S),tt&&ks(y,b),O;if(S===null){for(;b<T.length;b++)S=h(y,T[b],k),S!==null&&(v=s(S,v,b),z===null?O=S:z.sibling=S,z=S);return tt&&ks(y,b),O}for(S=r(y,S);b<T.length;b++)w=m(S,y,b,T[b],k),w!==null&&(t&&w.alternate!==null&&S.delete(w.key===null?b:w.key),v=s(w,v,b),z===null?O=w:z.sibling=w,z=w);return t&&S.forEach(function(C){return e(y,C)}),tt&&ks(y,b),O}function x(y,v,T,k){var O=Rl(T);if(typeof O!="function")throw Error(Z(150));if(T=O.call(T),T==null)throw Error(Z(151));for(var z=O=null,S=v,b=v=0,w=null,I=T.next();S!==null&&!I.done;b++,I=T.next()){S.index>b?(w=S,S=null):w=S.sibling;var C=f(y,S,I.value,k);if(C===null){S===null&&(S=w);break}t&&S&&C.alternate===null&&e(y,S),v=s(C,v,b),z===null?O=C:z.sibling=C,z=C,S=w}if(I.done)return n(y,S),tt&&ks(y,b),O;if(S===null){for(;!I.done;b++,I=T.next())I=h(y,I.value,k),I!==null&&(v=s(I,v,b),z===null?O=I:z.sibling=I,z=I);return tt&&ks(y,b),O}for(S=r(y,S);!I.done;b++,I=T.next())I=m(S,y,b,I.value,k),I!==null&&(t&&I.alternate!==null&&S.delete(I.key===null?b:I.key),v=s(I,v,b),z===null?O=I:z.sibling=I,z=I);return t&&S.forEach(function(N){return e(y,N)}),tt&&ks(y,b),O}function R(y,v,T,k){if(typeof T=="object"&&T!==null&&T.type===ra&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case $u:e:{for(var O=T.key,z=v;z!==null;){if(z.key===O){if(O=T.type,O===ra){if(z.tag===7){n(y,z.sibling),v=i(z,T.props.children),v.return=y,y=v;break e}}else if(z.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Di&&z_(O)===z.type){n(y,z.sibling),v=i(z,T.props),v.ref=Ol(y,z,T),v.return=y,y=v;break e}n(y,z);break}else e(y,z);z=z.sibling}T.type===ra?(v=Ks(T.props.children,y.mode,k,T.key),v.return=y,y=v):(k=Vd(T.type,T.key,T.props,null,y.mode,k),k.ref=Ol(y,v,T),k.return=y,y=k)}return o(y);case na:e:{for(z=T.key;v!==null;){if(v.key===z)if(v.tag===4&&v.stateNode.containerInfo===T.containerInfo&&v.stateNode.implementation===T.implementation){n(y,v.sibling),v=i(v,T.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else e(y,v);v=v.sibling}v=Cp(T,y.mode,k),v.return=y,y=v}return o(y);case Di:return z=T._init,R(y,v,z(T._payload),k)}if(Ql(T))return E(y,v,T,k);if(Rl(T))return x(y,v,T,k);Ju(y,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,v!==null&&v.tag===6?(n(y,v.sibling),v=i(v,T),v.return=y,y=v):(n(y,v),v=Sp(T,y.mode,k),v.return=y,y=v),o(y)):n(y,v)}return R}var Pa=vE(!0),_E=vE(!1),dh=ps(null),hh=null,da=null,v0=null;function _0(){v0=da=hh=null}function w0(t){var e=dh.current;Ze(dh),t._currentValue=e}function zm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function _a(t,e){hh=t,v0=da=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(pn=!0),t.firstContext=null)}function tr(t){var e=t._currentValue;if(v0!==t)if(t={context:t,memoizedValue:e,next:null},da===null){if(hh===null)throw Error(Z(308));da=t,hh.dependencies={lanes:0,firstContext:t}}else da=da.next=t;return e}var js=null;function x0(t){js===null?js=[t]:js.push(t)}function wE(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,x0(e)):(n.next=i.next,i.next=n),e.interleaved=n,hi(t,r)}function hi(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vi=!1;function b0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function xE(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ai(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ve&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,hi(t,n)}return i=r.interleaved,i===null?(e.next=e,x0(r)):(e.next=i.next,i.next=e),r.interleaved=e,hi(t,n)}function Ad(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,a0(t,n)}}function M_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function fh(t,e,n,r){var i=t.updateQueue;Vi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,d=c=l=null,a=s;do{var f=a.lane,m=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var E=t,x=a;switch(f=e,m=n,x.tag){case 1:if(E=x.payload,typeof E=="function"){h=E.call(m,h,f);break e}h=E;break e;case 3:E.flags=E.flags&-65537|128;case 0:if(E=x.payload,f=typeof E=="function"?E.call(m,h,f):E,f==null)break e;h=at({},h,f);break e;case 2:Vi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else m={eventTime:m,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=m,l=h):d=d.next=m,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);eo|=o,t.lanes=o,t.memoizedState=h}}function L_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Z(191,i));i.call(r)}}}var mu={},Or=ps(mu),zc=ps(mu),Mc=ps(mu);function Fs(t){if(t===mu)throw Error(Z(174));return t}function E0(t,e){switch(Ge(Mc,e),Ge(zc,t),Ge(Or,mu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:gm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=gm(e,t)}Ze(Or),Ge(Or,e)}function Da(){Ze(Or),Ze(zc),Ze(Mc)}function bE(t){Fs(Mc.current);var e=Fs(Or.current),n=gm(e,t.type);e!==n&&(Ge(zc,t),Ge(Or,n))}function I0(t){zc.current===t&&(Ze(Or),Ze(zc))}var rt=ps(0);function ph(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var wp=[];function T0(){for(var t=0;t<wp.length;t++)wp[t]._workInProgressVersionPrimary=null;wp.length=0}var kd=_i.ReactCurrentDispatcher,xp=_i.ReactCurrentBatchConfig,Zs=0,st=null,It=null,zt=null,mh=!1,fc=!1,Lc=0,nN=0;function Wt(){throw Error(Z(321))}function S0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!wr(t[n],e[n]))return!1;return!0}function C0(t,e,n,r,i,s){if(Zs=s,st=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,kd.current=t===null||t.memoizedState===null?oN:aN,t=n(r,i),fc){s=0;do{if(fc=!1,Lc=0,25<=s)throw Error(Z(301));s+=1,zt=It=null,e.updateQueue=null,kd.current=lN,t=n(r,i)}while(fc)}if(kd.current=gh,e=It!==null&&It.next!==null,Zs=0,zt=It=st=null,mh=!1,e)throw Error(Z(300));return t}function A0(){var t=Lc!==0;return Lc=0,t}function Rr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return zt===null?st.memoizedState=zt=t:zt=zt.next=t,zt}function nr(){if(It===null){var t=st.alternate;t=t!==null?t.memoizedState:null}else t=It.next;var e=zt===null?st.memoizedState:zt.next;if(e!==null)zt=e,It=t;else{if(t===null)throw Error(Z(310));It=t,t={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},zt===null?st.memoizedState=zt=t:zt=zt.next=t}return zt}function jc(t,e){return typeof e=="function"?e(t):e}function bp(t){var e=nr(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=It,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((Zs&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,st.lanes|=d,eo|=d}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,wr(r,e.memoizedState)||(pn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,st.lanes|=s,eo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Ep(t){var e=nr(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);wr(s,e.memoizedState)||(pn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function EE(){}function IE(t,e){var n=st,r=nr(),i=e(),s=!wr(r.memoizedState,i);if(s&&(r.memoizedState=i,pn=!0),r=r.queue,k0(CE.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||zt!==null&&zt.memoizedState.tag&1){if(n.flags|=2048,Fc(9,SE.bind(null,n,r,i,e),void 0,null),Mt===null)throw Error(Z(349));Zs&30||TE(n,e,i)}return i}function TE(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function SE(t,e,n,r){e.value=n,e.getSnapshot=r,AE(e)&&kE(t)}function CE(t,e,n){return n(function(){AE(e)&&kE(t)})}function AE(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!wr(t,n)}catch{return!0}}function kE(t){var e=hi(t,1);e!==null&&yr(e,t,1,-1)}function j_(t){var e=Rr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jc,lastRenderedState:t},e.queue=t,t=t.dispatch=sN.bind(null,st,t),[e.memoizedState,t]}function Fc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=st.updateQueue,e===null?(e={lastEffect:null,stores:null},st.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RE(){return nr().memoizedState}function Rd(t,e,n,r){var i=Rr();st.flags|=t,i.memoizedState=Fc(1|e,n,void 0,r===void 0?null:r)}function uf(t,e,n,r){var i=nr();r=r===void 0?null:r;var s=void 0;if(It!==null){var o=It.memoizedState;if(s=o.destroy,r!==null&&S0(r,o.deps)){i.memoizedState=Fc(e,n,s,r);return}}st.flags|=t,i.memoizedState=Fc(1|e,n,s,r)}function F_(t,e){return Rd(8390656,8,t,e)}function k0(t,e){return uf(2048,8,t,e)}function NE(t,e){return uf(4,2,t,e)}function PE(t,e){return uf(4,4,t,e)}function DE(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function VE(t,e,n){return n=n!=null?n.concat([t]):null,uf(4,4,DE.bind(null,e,t),n)}function R0(){}function OE(t,e){var n=nr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&S0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function zE(t,e){var n=nr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&S0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function ME(t,e,n){return Zs&21?(wr(n,e)||(n=Ub(),st.lanes|=n,eo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,pn=!0),t.memoizedState=n)}function rN(t,e){var n=Ue;Ue=n!==0&&4>n?n:4,t(!0);var r=xp.transition;xp.transition={};try{t(!1),e()}finally{Ue=n,xp.transition=r}}function LE(){return nr().memoizedState}function iN(t,e,n){var r=Zi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},jE(t))FE(e,n);else if(n=wE(t,e,n,r),n!==null){var i=nn();yr(n,t,r,i),$E(n,e,r)}}function sN(t,e,n){var r=Zi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(jE(t))FE(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,wr(a,o)){var l=e.interleaved;l===null?(i.next=i,x0(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=wE(t,e,i,r),n!==null&&(i=nn(),yr(n,t,r,i),$E(n,e,r))}}function jE(t){var e=t.alternate;return t===st||e!==null&&e===st}function FE(t,e){fc=mh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function $E(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,a0(t,n)}}var gh={readContext:tr,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useInsertionEffect:Wt,useLayoutEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useMutableSource:Wt,useSyncExternalStore:Wt,useId:Wt,unstable_isNewReconciler:!1},oN={readContext:tr,useCallback:function(t,e){return Rr().memoizedState=[t,e===void 0?null:e],t},useContext:tr,useEffect:F_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Rd(4194308,4,DE.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Rd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Rd(4,2,t,e)},useMemo:function(t,e){var n=Rr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Rr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=iN.bind(null,st,t),[r.memoizedState,t]},useRef:function(t){var e=Rr();return t={current:t},e.memoizedState=t},useState:j_,useDebugValue:R0,useDeferredValue:function(t){return Rr().memoizedState=t},useTransition:function(){var t=j_(!1),e=t[0];return t=rN.bind(null,t[1]),Rr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=st,i=Rr();if(tt){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=e(),Mt===null)throw Error(Z(349));Zs&30||TE(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,F_(CE.bind(null,r,s,t),[t]),r.flags|=2048,Fc(9,SE.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Rr(),e=Mt.identifierPrefix;if(tt){var n=ei,r=Zr;n=(r&~(1<<32-gr(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Lc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=nN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},aN={readContext:tr,useCallback:OE,useContext:tr,useEffect:k0,useImperativeHandle:VE,useInsertionEffect:NE,useLayoutEffect:PE,useMemo:zE,useReducer:bp,useRef:RE,useState:function(){return bp(jc)},useDebugValue:R0,useDeferredValue:function(t){var e=nr();return ME(e,It.memoizedState,t)},useTransition:function(){var t=bp(jc)[0],e=nr().memoizedState;return[t,e]},useMutableSource:EE,useSyncExternalStore:IE,useId:LE,unstable_isNewReconciler:!1},lN={readContext:tr,useCallback:OE,useContext:tr,useEffect:k0,useImperativeHandle:VE,useInsertionEffect:NE,useLayoutEffect:PE,useMemo:zE,useReducer:Ep,useRef:RE,useState:function(){return Ep(jc)},useDebugValue:R0,useDeferredValue:function(t){var e=nr();return It===null?e.memoizedState=t:ME(e,It.memoizedState,t)},useTransition:function(){var t=Ep(jc)[0],e=nr().memoizedState;return[t,e]},useMutableSource:EE,useSyncExternalStore:IE,useId:LE,unstable_isNewReconciler:!1};function ur(t,e){if(t&&t.defaultProps){e=at({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Mm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:at({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var df={isMounted:function(t){return(t=t._reactInternals)?vo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=nn(),i=Zi(t),s=ai(r,i);s.payload=e,n!=null&&(s.callback=n),e=Xi(t,s,i),e!==null&&(yr(e,t,i,r),Ad(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=nn(),i=Zi(t),s=ai(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Xi(t,s,i),e!==null&&(yr(e,t,i,r),Ad(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=nn(),r=Zi(t),i=ai(n,r);i.tag=2,e!=null&&(i.callback=e),e=Xi(t,i,r),e!==null&&(yr(e,t,r,n),Ad(e,t,r))}};function $_(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Pc(n,r)||!Pc(i,s):!0}function UE(t,e,n){var r=!1,i=ls,s=e.contextType;return typeof s=="object"&&s!==null?s=tr(s):(i=_n(e)?Xs:Zt.current,r=e.contextTypes,s=(r=r!=null)?Ra(t,i):ls),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=df,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function U_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&df.enqueueReplaceState(e,e.state,null)}function Lm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},b0(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=tr(s):(s=_n(e)?Xs:Zt.current,i.context=Ra(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Mm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&df.enqueueReplaceState(i,i.state,null),fh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Va(t,e){try{var n="",r=e;do n+=zk(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Ip(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function jm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var cN=typeof WeakMap=="function"?WeakMap:Map;function BE(t,e,n){n=ai(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){vh||(vh=!0,Qm=r),jm(t,e)},n}function qE(t,e,n){n=ai(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){jm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){jm(t,e),typeof r!="function"&&(Ji===null?Ji=new Set([this]):Ji.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function B_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new cN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=EN.bind(null,t,e,n),e.then(t,t))}function q_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function H_(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ai(-1,1),e.tag=2,Xi(n,e,1))),n.lanes|=1),t)}var uN=_i.ReactCurrentOwner,pn=!1;function tn(t,e,n,r){e.child=t===null?_E(e,null,n,r):Pa(e,t.child,n,r)}function K_(t,e,n,r,i){n=n.render;var s=e.ref;return _a(e,i),r=C0(t,e,n,r,s,i),n=A0(),t!==null&&!pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,fi(t,e,i)):(tt&&n&&m0(e),e.flags|=1,tn(t,e,r,i),e.child)}function G_(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!L0(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,HE(t,e,s,r,i)):(t=Vd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Pc,n(o,r)&&t.ref===e.ref)return fi(t,e,i)}return e.flags|=1,t=es(s,r),t.ref=e.ref,t.return=e,e.child=t}function HE(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Pc(s,r)&&t.ref===e.ref)if(pn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(pn=!0);else return e.lanes=t.lanes,fi(t,e,i)}return Fm(t,e,n,r,i)}function KE(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(fa,Pn),Pn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ge(fa,Pn),Pn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ge(fa,Pn),Pn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ge(fa,Pn),Pn|=r;return tn(t,e,i,n),e.child}function GE(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Fm(t,e,n,r,i){var s=_n(n)?Xs:Zt.current;return s=Ra(e,s),_a(e,i),n=C0(t,e,n,r,s,i),r=A0(),t!==null&&!pn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,fi(t,e,i)):(tt&&r&&m0(e),e.flags|=1,tn(t,e,n,i),e.child)}function W_(t,e,n,r,i){if(_n(n)){var s=!0;lh(e)}else s=!1;if(_a(e,i),e.stateNode===null)Nd(t,e),UE(e,n,r),Lm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=tr(c):(c=_n(n)?Xs:Zt.current,c=Ra(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&U_(e,o,r,c),Vi=!1;var f=e.memoizedState;o.state=f,fh(e,r,o,i),l=e.memoizedState,a!==r||f!==l||vn.current||Vi?(typeof d=="function"&&(Mm(e,n,d,r),l=e.memoizedState),(a=Vi||$_(e,n,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,xE(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ur(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=tr(l):(l=_n(n)?Xs:Zt.current,l=Ra(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&U_(e,o,r,l),Vi=!1,f=e.memoizedState,o.state=f,fh(e,r,o,i);var E=e.memoizedState;a!==h||f!==E||vn.current||Vi?(typeof m=="function"&&(Mm(e,n,m,r),E=e.memoizedState),(c=Vi||$_(e,n,c,r,f,E,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,E,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,E,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=E),o.props=r,o.state=E,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return $m(t,e,n,r,s,i)}function $m(t,e,n,r,i,s){GE(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&D_(e,n,!1),fi(t,e,s);r=e.stateNode,uN.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Pa(e,t.child,null,s),e.child=Pa(e,null,a,s)):tn(t,e,a,s),e.memoizedState=r.state,i&&D_(e,n,!0),e.child}function WE(t){var e=t.stateNode;e.pendingContext?P_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&P_(t,e.context,!1),E0(t,e.containerInfo)}function Q_(t,e,n,r,i){return Na(),y0(i),e.flags|=256,tn(t,e,n,r),e.child}var Um={dehydrated:null,treeContext:null,retryLane:0};function Bm(t){return{baseLanes:t,cachePool:null,transitions:null}}function QE(t,e,n){var r=e.pendingProps,i=rt.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ge(rt,i&1),t===null)return Om(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=pf(o,r,0,null),t=Ks(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Bm(n),e.memoizedState=Um,t):N0(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return dN(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=es(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=es(a,s):(s=Ks(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Bm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Um,r}return s=t.child,t=s.sibling,r=es(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function N0(t,e){return e=pf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Zu(t,e,n,r){return r!==null&&y0(r),Pa(e,t.child,null,n),t=N0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function dN(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Ip(Error(Z(422))),Zu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=pf({mode:"visible",children:r.children},i,0,null),s=Ks(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Pa(e,t.child,null,o),e.child.memoizedState=Bm(o),e.memoizedState=Um,s);if(!(e.mode&1))return Zu(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Z(419)),r=Ip(s,r,void 0),Zu(t,e,o,r)}if(a=(o&t.childLanes)!==0,pn||a){if(r=Mt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,hi(t,i),yr(r,t,i,-1))}return M0(),r=Ip(Error(Z(421))),Zu(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=IN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,On=Yi(i.nextSibling),Mn=e,tt=!0,fr=null,t!==null&&(Wn[Qn++]=Zr,Wn[Qn++]=ei,Wn[Qn++]=Js,Zr=t.id,ei=t.overflow,Js=e),e=N0(e,r.children),e.flags|=4096,e)}function Y_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),zm(t.return,e,n)}function Tp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function YE(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(tn(t,e,r.children,n),r=rt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Y_(t,n,e);else if(t.tag===19)Y_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ge(rt,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&ph(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),Tp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ph(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}Tp(e,!0,n,null,s);break;case"together":Tp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Nd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function fi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),eo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Z(153));if(e.child!==null){for(t=e.child,n=es(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=es(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function hN(t,e,n){switch(e.tag){case 3:WE(e),Na();break;case 5:bE(e);break;case 1:_n(e.type)&&lh(e);break;case 4:E0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ge(dh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ge(rt,rt.current&1),e.flags|=128,null):n&e.child.childLanes?QE(t,e,n):(Ge(rt,rt.current&1),t=fi(t,e,n),t!==null?t.sibling:null);Ge(rt,rt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return YE(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ge(rt,rt.current),r)break;return null;case 22:case 23:return e.lanes=0,KE(t,e,n)}return fi(t,e,n)}var XE,qm,JE,ZE;XE=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};qm=function(){};JE=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Fs(Or.current);var s=null;switch(n){case"input":i=hm(t,i),r=hm(t,r),s=[];break;case"select":i=at({},i,{value:void 0}),r=at({},r,{value:void 0}),s=[];break;case"textarea":i=mm(t,i),r=mm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=oh)}ym(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Tc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Tc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Je("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};ZE=function(t,e,n,r){n!==r&&(e.flags|=4)};function zl(t,e){if(!tt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function fN(t,e,n){var r=e.pendingProps;switch(g0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(e),null;case 1:return _n(e.type)&&ah(),Qt(e),null;case 3:return r=e.stateNode,Da(),Ze(vn),Ze(Zt),T0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Xu(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,fr!==null&&(Jm(fr),fr=null))),qm(t,e),Qt(e),null;case 5:I0(e);var i=Fs(Mc.current);if(n=e.type,t!==null&&e.stateNode!=null)JE(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Z(166));return Qt(e),null}if(t=Fs(Or.current),Xu(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Nr]=e,r[Oc]=s,t=(e.mode&1)!==0,n){case"dialog":Je("cancel",r),Je("close",r);break;case"iframe":case"object":case"embed":Je("load",r);break;case"video":case"audio":for(i=0;i<Xl.length;i++)Je(Xl[i],r);break;case"source":Je("error",r);break;case"img":case"image":case"link":Je("error",r),Je("load",r);break;case"details":Je("toggle",r);break;case"input":s_(r,s),Je("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Je("invalid",r);break;case"textarea":a_(r,s),Je("invalid",r)}ym(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Yu(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Yu(r.textContent,a,t),i=["children",""+a]):Tc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Je("scroll",r)}switch(n){case"input":Uu(r),o_(r,s,!0);break;case"textarea":Uu(r),l_(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=oh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Cb(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Nr]=e,t[Oc]=r,XE(t,e,!1,!1),e.stateNode=t;e:{switch(o=vm(n,r),n){case"dialog":Je("cancel",t),Je("close",t),i=r;break;case"iframe":case"object":case"embed":Je("load",t),i=r;break;case"video":case"audio":for(i=0;i<Xl.length;i++)Je(Xl[i],t);i=r;break;case"source":Je("error",t),i=r;break;case"img":case"image":case"link":Je("error",t),Je("load",t),i=r;break;case"details":Je("toggle",t),i=r;break;case"input":s_(t,r),i=hm(t,r),Je("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=at({},r,{value:void 0}),Je("invalid",t);break;case"textarea":a_(t,r),i=mm(t,r),Je("invalid",t);break;default:i=r}ym(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?Rb(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&Ab(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Sc(t,l):typeof l=="number"&&Sc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Tc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Je("scroll",t):l!=null&&t0(t,s,l,o))}switch(n){case"input":Uu(t),o_(t,r,!1);break;case"textarea":Uu(t),l_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+as(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?ma(t,!!r.multiple,s,!1):r.defaultValue!=null&&ma(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=oh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Qt(e),null;case 6:if(t&&e.stateNode!=null)ZE(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Z(166));if(n=Fs(Mc.current),Fs(Or.current),Xu(e)){if(r=e.stateNode,n=e.memoizedProps,r[Nr]=e,(s=r.nodeValue!==n)&&(t=Mn,t!==null))switch(t.tag){case 3:Yu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Yu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Nr]=e,e.stateNode=r}return Qt(e),null;case 13:if(Ze(rt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(tt&&On!==null&&e.mode&1&&!(e.flags&128))yE(),Na(),e.flags|=98560,s=!1;else if(s=Xu(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Z(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Z(317));s[Nr]=e}else Na(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Qt(e),s=!1}else fr!==null&&(Jm(fr),fr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||rt.current&1?Tt===0&&(Tt=3):M0())),e.updateQueue!==null&&(e.flags|=4),Qt(e),null);case 4:return Da(),qm(t,e),t===null&&Dc(e.stateNode.containerInfo),Qt(e),null;case 10:return w0(e.type._context),Qt(e),null;case 17:return _n(e.type)&&ah(),Qt(e),null;case 19:if(Ze(rt),s=e.memoizedState,s===null)return Qt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)zl(s,!1);else{if(Tt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ph(t),o!==null){for(e.flags|=128,zl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ge(rt,rt.current&1|2),e.child}t=t.sibling}s.tail!==null&&pt()>Oa&&(e.flags|=128,r=!0,zl(s,!1),e.lanes=4194304)}else{if(!r)if(t=ph(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),zl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!tt)return Qt(e),null}else 2*pt()-s.renderingStartTime>Oa&&n!==1073741824&&(e.flags|=128,r=!0,zl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=pt(),e.sibling=null,n=rt.current,Ge(rt,r?n&1|2:n&1),e):(Qt(e),null);case 22:case 23:return z0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Pn&1073741824&&(Qt(e),e.subtreeFlags&6&&(e.flags|=8192)):Qt(e),null;case 24:return null;case 25:return null}throw Error(Z(156,e.tag))}function pN(t,e){switch(g0(e),e.tag){case 1:return _n(e.type)&&ah(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Da(),Ze(vn),Ze(Zt),T0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return I0(e),null;case 13:if(Ze(rt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Z(340));Na()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ze(rt),null;case 4:return Da(),null;case 10:return w0(e.type._context),null;case 22:case 23:return z0(),null;case 24:return null;default:return null}}var ed=!1,Jt=!1,mN=typeof WeakSet=="function"?WeakSet:Set,ae=null;function ha(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ut(t,e,r)}else n.current=null}function Hm(t,e,n){try{n()}catch(r){ut(t,e,r)}}var X_=!1;function gN(t,e){if(Am=rh,t=iE(),p0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++c===i&&(a=o),f===s&&++d===r&&(l=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(km={focusedElem:t,selectionRange:n},rh=!1,ae=e;ae!==null;)if(e=ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ae=t;else for(;ae!==null;){e=ae;try{var E=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(E!==null){var x=E.memoizedProps,R=E.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:ur(e.type,x),R);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(k){ut(e,e.return,k)}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}return E=X_,X_=!1,E}function pc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Hm(e,n,s)}i=i.next}while(i!==r)}}function hf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Km(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function eI(t){var e=t.alternate;e!==null&&(t.alternate=null,eI(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Nr],delete e[Oc],delete e[Pm],delete e[JR],delete e[ZR])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tI(t){return t.tag===5||t.tag===3||t.tag===4}function J_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tI(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Gm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=oh));else if(r!==4&&(t=t.child,t!==null))for(Gm(t,e,n),t=t.sibling;t!==null;)Gm(t,e,n),t=t.sibling}function Wm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Wm(t,e,n),t=t.sibling;t!==null;)Wm(t,e,n),t=t.sibling}var Ut=null,dr=!1;function Ai(t,e,n){for(n=n.child;n!==null;)nI(t,e,n),n=n.sibling}function nI(t,e,n){if(Vr&&typeof Vr.onCommitFiberUnmount=="function")try{Vr.onCommitFiberUnmount(rf,n)}catch{}switch(n.tag){case 5:Jt||ha(n,e);case 6:var r=Ut,i=dr;Ut=null,Ai(t,e,n),Ut=r,dr=i,Ut!==null&&(dr?(t=Ut,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ut.removeChild(n.stateNode));break;case 18:Ut!==null&&(dr?(t=Ut,n=n.stateNode,t.nodeType===8?vp(t.parentNode,n):t.nodeType===1&&vp(t,n),Rc(t)):vp(Ut,n.stateNode));break;case 4:r=Ut,i=dr,Ut=n.stateNode.containerInfo,dr=!0,Ai(t,e,n),Ut=r,dr=i;break;case 0:case 11:case 14:case 15:if(!Jt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Hm(n,e,o),i=i.next}while(i!==r)}Ai(t,e,n);break;case 1:if(!Jt&&(ha(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ut(n,e,a)}Ai(t,e,n);break;case 21:Ai(t,e,n);break;case 22:n.mode&1?(Jt=(r=Jt)||n.memoizedState!==null,Ai(t,e,n),Jt=r):Ai(t,e,n);break;default:Ai(t,e,n)}}function Z_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new mN),e.forEach(function(r){var i=TN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function cr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ut=a.stateNode,dr=!1;break e;case 3:Ut=a.stateNode.containerInfo,dr=!0;break e;case 4:Ut=a.stateNode.containerInfo,dr=!0;break e}a=a.return}if(Ut===null)throw Error(Z(160));nI(s,o,i),Ut=null,dr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){ut(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rI(e,t),e=e.sibling}function rI(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(cr(e,t),kr(t),r&4){try{pc(3,t,t.return),hf(3,t)}catch(x){ut(t,t.return,x)}try{pc(5,t,t.return)}catch(x){ut(t,t.return,x)}}break;case 1:cr(e,t),kr(t),r&512&&n!==null&&ha(n,n.return);break;case 5:if(cr(e,t),kr(t),r&512&&n!==null&&ha(n,n.return),t.flags&32){var i=t.stateNode;try{Sc(i,"")}catch(x){ut(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&Tb(i,s),vm(a,o);var c=vm(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?Rb(i,h):d==="dangerouslySetInnerHTML"?Ab(i,h):d==="children"?Sc(i,h):t0(i,d,h,c)}switch(a){case"input":fm(i,s);break;case"textarea":Sb(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?ma(i,!!s.multiple,m,!1):f!==!!s.multiple&&(s.defaultValue!=null?ma(i,!!s.multiple,s.defaultValue,!0):ma(i,!!s.multiple,s.multiple?[]:"",!1))}i[Oc]=s}catch(x){ut(t,t.return,x)}}break;case 6:if(cr(e,t),kr(t),r&4){if(t.stateNode===null)throw Error(Z(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){ut(t,t.return,x)}}break;case 3:if(cr(e,t),kr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Rc(e.containerInfo)}catch(x){ut(t,t.return,x)}break;case 4:cr(e,t),kr(t);break;case 13:cr(e,t),kr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(V0=pt())),r&4&&Z_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Jt=(c=Jt)||d,cr(e,t),Jt=c):cr(e,t),kr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(ae=t,d=t.child;d!==null;){for(h=ae=d;ae!==null;){switch(f=ae,m=f.child,f.tag){case 0:case 11:case 14:case 15:pc(4,f,f.return);break;case 1:ha(f,f.return);var E=f.stateNode;if(typeof E.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,E.props=e.memoizedProps,E.state=e.memoizedState,E.componentWillUnmount()}catch(x){ut(r,n,x)}}break;case 5:ha(f,f.return);break;case 22:if(f.memoizedState!==null){tw(h);continue}}m!==null?(m.return=f,ae=m):tw(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=kb("display",o))}catch(x){ut(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){ut(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:cr(e,t),kr(t),r&4&&Z_(t);break;case 21:break;default:cr(e,t),kr(t)}}function kr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tI(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Sc(i,""),r.flags&=-33);var s=J_(t);Wm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=J_(t);Gm(t,a,o);break;default:throw Error(Z(161))}}catch(l){ut(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function yN(t,e,n){ae=t,iI(t)}function iI(t,e,n){for(var r=(t.mode&1)!==0;ae!==null;){var i=ae,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||ed;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Jt;a=ed;var c=Jt;if(ed=o,(Jt=l)&&!c)for(ae=i;ae!==null;)o=ae,l=o.child,o.tag===22&&o.memoizedState!==null?nw(i):l!==null?(l.return=o,ae=l):nw(i);for(;s!==null;)ae=s,iI(s),s=s.sibling;ae=i,ed=a,Jt=c}ew(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ae=s):ew(t)}}function ew(t){for(;ae!==null;){var e=ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Jt||hf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Jt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ur(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&L_(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}L_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Rc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}Jt||e.flags&512&&Km(e)}catch(f){ut(e,e.return,f)}}if(e===t){ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,ae=n;break}ae=e.return}}function tw(t){for(;ae!==null;){var e=ae;if(e===t){ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ae=n;break}ae=e.return}}function nw(t){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{hf(4,e)}catch(l){ut(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ut(e,i,l)}}var s=e.return;try{Km(e)}catch(l){ut(e,s,l)}break;case 5:var o=e.return;try{Km(e)}catch(l){ut(e,o,l)}}}catch(l){ut(e,e.return,l)}if(e===t){ae=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ae=a;break}ae=e.return}}var vN=Math.ceil,yh=_i.ReactCurrentDispatcher,P0=_i.ReactCurrentOwner,Zn=_i.ReactCurrentBatchConfig,Ve=0,Mt=null,_t=null,qt=0,Pn=0,fa=ps(0),Tt=0,$c=null,eo=0,ff=0,D0=0,mc=null,hn=null,V0=0,Oa=1/0,Yr=null,vh=!1,Qm=null,Ji=null,td=!1,Hi=null,_h=0,gc=0,Ym=null,Pd=-1,Dd=0;function nn(){return Ve&6?pt():Pd!==-1?Pd:Pd=pt()}function Zi(t){return t.mode&1?Ve&2&&qt!==0?qt&-qt:tN.transition!==null?(Dd===0&&(Dd=Ub()),Dd):(t=Ue,t!==0||(t=window.event,t=t===void 0?16:Qb(t.type)),t):1}function yr(t,e,n,r){if(50<gc)throw gc=0,Ym=null,Error(Z(185));hu(t,n,r),(!(Ve&2)||t!==Mt)&&(t===Mt&&(!(Ve&2)&&(ff|=n),Tt===4&&Li(t,qt)),wn(t,r),n===1&&Ve===0&&!(e.mode&1)&&(Oa=pt()+500,cf&&ms()))}function wn(t,e){var n=t.callbackNode;tR(t,e);var r=nh(t,t===Mt?qt:0);if(r===0)n!==null&&d_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&d_(n),e===1)t.tag===0?eN(rw.bind(null,t)):pE(rw.bind(null,t)),YR(function(){!(Ve&6)&&ms()}),n=null;else{switch(Bb(r)){case 1:n=o0;break;case 4:n=Fb;break;case 16:n=th;break;case 536870912:n=$b;break;default:n=th}n=hI(n,sI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function sI(t,e){if(Pd=-1,Dd=0,Ve&6)throw Error(Z(327));var n=t.callbackNode;if(wa()&&t.callbackNode!==n)return null;var r=nh(t,t===Mt?qt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=wh(t,r);else{e=r;var i=Ve;Ve|=2;var s=aI();(Mt!==t||qt!==e)&&(Yr=null,Oa=pt()+500,Hs(t,e));do try{xN();break}catch(a){oI(t,a)}while(!0);_0(),yh.current=s,Ve=i,_t!==null?e=0:(Mt=null,qt=0,e=Tt)}if(e!==0){if(e===2&&(i=Em(t),i!==0&&(r=i,e=Xm(t,i))),e===1)throw n=$c,Hs(t,0),Li(t,r),wn(t,pt()),n;if(e===6)Li(t,r);else{if(i=t.current.alternate,!(r&30)&&!_N(i)&&(e=wh(t,r),e===2&&(s=Em(t),s!==0&&(r=s,e=Xm(t,s))),e===1))throw n=$c,Hs(t,0),Li(t,r),wn(t,pt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Z(345));case 2:Rs(t,hn,Yr);break;case 3:if(Li(t,r),(r&130023424)===r&&(e=V0+500-pt(),10<e)){if(nh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){nn(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Nm(Rs.bind(null,t,hn,Yr),e);break}Rs(t,hn,Yr);break;case 4:if(Li(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-gr(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=pt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*vN(r/1960))-r,10<r){t.timeoutHandle=Nm(Rs.bind(null,t,hn,Yr),r);break}Rs(t,hn,Yr);break;case 5:Rs(t,hn,Yr);break;default:throw Error(Z(329))}}}return wn(t,pt()),t.callbackNode===n?sI.bind(null,t):null}function Xm(t,e){var n=mc;return t.current.memoizedState.isDehydrated&&(Hs(t,e).flags|=256),t=wh(t,e),t!==2&&(e=hn,hn=n,e!==null&&Jm(e)),t}function Jm(t){hn===null?hn=t:hn.push.apply(hn,t)}function _N(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!wr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Li(t,e){for(e&=~D0,e&=~ff,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-gr(e),r=1<<n;t[n]=-1,e&=~r}}function rw(t){if(Ve&6)throw Error(Z(327));wa();var e=nh(t,0);if(!(e&1))return wn(t,pt()),null;var n=wh(t,e);if(t.tag!==0&&n===2){var r=Em(t);r!==0&&(e=r,n=Xm(t,r))}if(n===1)throw n=$c,Hs(t,0),Li(t,e),wn(t,pt()),n;if(n===6)throw Error(Z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Rs(t,hn,Yr),wn(t,pt()),null}function O0(t,e){var n=Ve;Ve|=1;try{return t(e)}finally{Ve=n,Ve===0&&(Oa=pt()+500,cf&&ms())}}function to(t){Hi!==null&&Hi.tag===0&&!(Ve&6)&&wa();var e=Ve;Ve|=1;var n=Zn.transition,r=Ue;try{if(Zn.transition=null,Ue=1,t)return t()}finally{Ue=r,Zn.transition=n,Ve=e,!(Ve&6)&&ms()}}function z0(){Pn=fa.current,Ze(fa)}function Hs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,QR(n)),_t!==null)for(n=_t.return;n!==null;){var r=n;switch(g0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ah();break;case 3:Da(),Ze(vn),Ze(Zt),T0();break;case 5:I0(r);break;case 4:Da();break;case 13:Ze(rt);break;case 19:Ze(rt);break;case 10:w0(r.type._context);break;case 22:case 23:z0()}n=n.return}if(Mt=t,_t=t=es(t.current,null),qt=Pn=e,Tt=0,$c=null,D0=ff=eo=0,hn=mc=null,js!==null){for(e=0;e<js.length;e++)if(n=js[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}js=null}return t}function oI(t,e){do{var n=_t;try{if(_0(),kd.current=gh,mh){for(var r=st.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}mh=!1}if(Zs=0,zt=It=st=null,fc=!1,Lc=0,P0.current=null,n===null||n.return===null){Tt=1,$c=e,_t=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=qt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=q_(o);if(m!==null){m.flags&=-257,H_(m,o,a,s,e),m.mode&1&&B_(s,c,e),e=m,l=c;var E=e.updateQueue;if(E===null){var x=new Set;x.add(l),e.updateQueue=x}else E.add(l);break e}else{if(!(e&1)){B_(s,c,e),M0();break e}l=Error(Z(426))}}else if(tt&&a.mode&1){var R=q_(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),H_(R,o,a,s,e),y0(Va(l,a));break e}}s=l=Va(l,a),Tt!==4&&(Tt=2),mc===null?mc=[s]:mc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=BE(s,l,e);M_(s,y);break e;case 1:a=l;var v=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ji===null||!Ji.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var k=qE(s,a,e);M_(s,k);break e}}s=s.return}while(s!==null)}cI(n)}catch(O){e=O,_t===n&&n!==null&&(_t=n=n.return);continue}break}while(!0)}function aI(){var t=yh.current;return yh.current=gh,t===null?gh:t}function M0(){(Tt===0||Tt===3||Tt===2)&&(Tt=4),Mt===null||!(eo&268435455)&&!(ff&268435455)||Li(Mt,qt)}function wh(t,e){var n=Ve;Ve|=2;var r=aI();(Mt!==t||qt!==e)&&(Yr=null,Hs(t,e));do try{wN();break}catch(i){oI(t,i)}while(!0);if(_0(),Ve=n,yh.current=r,_t!==null)throw Error(Z(261));return Mt=null,qt=0,Tt}function wN(){for(;_t!==null;)lI(_t)}function xN(){for(;_t!==null&&!Kk();)lI(_t)}function lI(t){var e=dI(t.alternate,t,Pn);t.memoizedProps=t.pendingProps,e===null?cI(t):_t=e,P0.current=null}function cI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=pN(n,e),n!==null){n.flags&=32767,_t=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Tt=6,_t=null;return}}else if(n=fN(n,e,Pn),n!==null){_t=n;return}if(e=e.sibling,e!==null){_t=e;return}_t=e=t}while(e!==null);Tt===0&&(Tt=5)}function Rs(t,e,n){var r=Ue,i=Zn.transition;try{Zn.transition=null,Ue=1,bN(t,e,n,r)}finally{Zn.transition=i,Ue=r}return null}function bN(t,e,n,r){do wa();while(Hi!==null);if(Ve&6)throw Error(Z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Z(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(nR(t,s),t===Mt&&(_t=Mt=null,qt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||td||(td=!0,hI(th,function(){return wa(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Zn.transition,Zn.transition=null;var o=Ue;Ue=1;var a=Ve;Ve|=4,P0.current=null,gN(t,n),rI(n,t),UR(km),rh=!!Am,km=Am=null,t.current=n,yN(n),Gk(),Ve=a,Ue=o,Zn.transition=s}else t.current=n;if(td&&(td=!1,Hi=t,_h=i),s=t.pendingLanes,s===0&&(Ji=null),Yk(n.stateNode),wn(t,pt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(vh)throw vh=!1,t=Qm,Qm=null,t;return _h&1&&t.tag!==0&&wa(),s=t.pendingLanes,s&1?t===Ym?gc++:(gc=0,Ym=t):gc=0,ms(),null}function wa(){if(Hi!==null){var t=Bb(_h),e=Zn.transition,n=Ue;try{if(Zn.transition=null,Ue=16>t?16:t,Hi===null)var r=!1;else{if(t=Hi,Hi=null,_h=0,Ve&6)throw Error(Z(331));var i=Ve;for(Ve|=4,ae=t.current;ae!==null;){var s=ae,o=s.child;if(ae.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ae=c;ae!==null;){var d=ae;switch(d.tag){case 0:case 11:case 15:pc(8,d,s)}var h=d.child;if(h!==null)h.return=d,ae=h;else for(;ae!==null;){d=ae;var f=d.sibling,m=d.return;if(eI(d),d===c){ae=null;break}if(f!==null){f.return=m,ae=f;break}ae=m}}}var E=s.alternate;if(E!==null){var x=E.child;if(x!==null){E.child=null;do{var R=x.sibling;x.sibling=null,x=R}while(x!==null)}}ae=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ae=o;else e:for(;ae!==null;){if(s=ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:pc(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,ae=y;break e}ae=s.return}}var v=t.current;for(ae=v;ae!==null;){o=ae;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ae=T;else e:for(o=v;ae!==null;){if(a=ae,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:hf(9,a)}}catch(O){ut(a,a.return,O)}if(a===o){ae=null;break e}var k=a.sibling;if(k!==null){k.return=a.return,ae=k;break e}ae=a.return}}if(Ve=i,ms(),Vr&&typeof Vr.onPostCommitFiberRoot=="function")try{Vr.onPostCommitFiberRoot(rf,t)}catch{}r=!0}return r}finally{Ue=n,Zn.transition=e}}return!1}function iw(t,e,n){e=Va(n,e),e=BE(t,e,1),t=Xi(t,e,1),e=nn(),t!==null&&(hu(t,1,e),wn(t,e))}function ut(t,e,n){if(t.tag===3)iw(t,t,n);else for(;e!==null;){if(e.tag===3){iw(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ji===null||!Ji.has(r))){t=Va(n,t),t=qE(e,t,1),e=Xi(e,t,1),t=nn(),e!==null&&(hu(e,1,t),wn(e,t));break}}e=e.return}}function EN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=nn(),t.pingedLanes|=t.suspendedLanes&n,Mt===t&&(qt&n)===n&&(Tt===4||Tt===3&&(qt&130023424)===qt&&500>pt()-V0?Hs(t,0):D0|=n),wn(t,e)}function uI(t,e){e===0&&(t.mode&1?(e=Hu,Hu<<=1,!(Hu&130023424)&&(Hu=4194304)):e=1);var n=nn();t=hi(t,e),t!==null&&(hu(t,e,n),wn(t,n))}function IN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),uI(t,n)}function TN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(e),uI(t,n)}var dI;dI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||vn.current)pn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return pn=!1,hN(t,e,n);pn=!!(t.flags&131072)}else pn=!1,tt&&e.flags&1048576&&mE(e,uh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Nd(t,e),t=e.pendingProps;var i=Ra(e,Zt.current);_a(e,n),i=C0(null,e,r,t,i,n);var s=A0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,_n(r)?(s=!0,lh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,b0(e),i.updater=df,e.stateNode=i,i._reactInternals=e,Lm(e,r,t,n),e=$m(null,e,r,!0,s,n)):(e.tag=0,tt&&s&&m0(e),tn(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Nd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=CN(r),t=ur(r,t),i){case 0:e=Fm(null,e,r,t,n);break e;case 1:e=W_(null,e,r,t,n);break e;case 11:e=K_(null,e,r,t,n);break e;case 14:e=G_(null,e,r,ur(r.type,t),n);break e}throw Error(Z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),Fm(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),W_(t,e,r,i,n);case 3:e:{if(WE(e),t===null)throw Error(Z(387));r=e.pendingProps,s=e.memoizedState,i=s.element,xE(t,e),fh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Va(Error(Z(423)),e),e=Q_(t,e,r,n,i);break e}else if(r!==i){i=Va(Error(Z(424)),e),e=Q_(t,e,r,n,i);break e}else for(On=Yi(e.stateNode.containerInfo.firstChild),Mn=e,tt=!0,fr=null,n=_E(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Na(),r===i){e=fi(t,e,n);break e}tn(t,e,r,n)}e=e.child}return e;case 5:return bE(e),t===null&&Om(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Rm(r,i)?o=null:s!==null&&Rm(r,s)&&(e.flags|=32),GE(t,e),tn(t,e,o,n),e.child;case 6:return t===null&&Om(e),null;case 13:return QE(t,e,n);case 4:return E0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Pa(e,null,r,n):tn(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),K_(t,e,r,i,n);case 7:return tn(t,e,e.pendingProps,n),e.child;case 8:return tn(t,e,e.pendingProps.children,n),e.child;case 12:return tn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ge(dh,r._currentValue),r._currentValue=o,s!==null)if(wr(s.value,o)){if(s.children===i.children&&!vn.current){e=fi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ai(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),zm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Z(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),zm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}tn(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,_a(e,n),i=tr(i),r=r(i),e.flags|=1,tn(t,e,r,n),e.child;case 14:return r=e.type,i=ur(r,e.pendingProps),i=ur(r.type,i),G_(t,e,r,i,n);case 15:return HE(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ur(r,i),Nd(t,e),e.tag=1,_n(r)?(t=!0,lh(e)):t=!1,_a(e,n),UE(e,r,i),Lm(e,r,i,n),$m(null,e,r,!0,t,n);case 19:return YE(t,e,n);case 22:return KE(t,e,n)}throw Error(Z(156,e.tag))};function hI(t,e){return jb(t,e)}function SN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Yn(t,e,n,r){return new SN(t,e,n,r)}function L0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function CN(t){if(typeof t=="function")return L0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===r0)return 11;if(t===i0)return 14}return 2}function es(t,e){var n=t.alternate;return n===null?(n=Yn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Vd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")L0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case ra:return Ks(n.children,i,s,e);case n0:o=8,i|=8;break;case lm:return t=Yn(12,n,e,i|2),t.elementType=lm,t.lanes=s,t;case cm:return t=Yn(13,n,e,i),t.elementType=cm,t.lanes=s,t;case um:return t=Yn(19,n,e,i),t.elementType=um,t.lanes=s,t;case bb:return pf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case wb:o=10;break e;case xb:o=9;break e;case r0:o=11;break e;case i0:o=14;break e;case Di:o=16,r=null;break e}throw Error(Z(130,t==null?t:typeof t,""))}return e=Yn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Ks(t,e,n,r){return t=Yn(7,t,r,e),t.lanes=n,t}function pf(t,e,n,r){return t=Yn(22,t,r,e),t.elementType=bb,t.lanes=n,t.stateNode={isHidden:!1},t}function Sp(t,e,n){return t=Yn(6,t,null,e),t.lanes=n,t}function Cp(t,e,n){return e=Yn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function AN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ap(0),this.expirationTimes=ap(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ap(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function j0(t,e,n,r,i,s,o,a,l){return t=new AN(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Yn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},b0(s),t}function kN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:na,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function fI(t){if(!t)return ls;t=t._reactInternals;e:{if(vo(t)!==t||t.tag!==1)throw Error(Z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(_n(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Z(171))}if(t.tag===1){var n=t.type;if(_n(n))return fE(t,n,e)}return e}function pI(t,e,n,r,i,s,o,a,l){return t=j0(n,r,!0,t,i,s,o,a,l),t.context=fI(null),n=t.current,r=nn(),i=Zi(n),s=ai(r,i),s.callback=e??null,Xi(n,s,i),t.current.lanes=i,hu(t,i,r),wn(t,r),t}function mf(t,e,n,r){var i=e.current,s=nn(),o=Zi(i);return n=fI(n),e.context===null?e.context=n:e.pendingContext=n,e=ai(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xi(i,e,o),t!==null&&(yr(t,i,o,s),Ad(t,i,o)),o}function xh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function sw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function F0(t,e){sw(t,e),(t=t.alternate)&&sw(t,e)}function RN(){return null}var mI=typeof reportError=="function"?reportError:function(t){console.error(t)};function $0(t){this._internalRoot=t}gf.prototype.render=$0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Z(409));mf(t,e,null,null)};gf.prototype.unmount=$0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;to(function(){mf(null,t,null,null)}),e[di]=null}};function gf(t){this._internalRoot=t}gf.prototype.unstable_scheduleHydration=function(t){if(t){var e=Kb();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Mi.length&&e!==0&&e<Mi[n].priority;n++);Mi.splice(n,0,t),n===0&&Wb(t)}};function U0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function yf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function ow(){}function NN(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=xh(o);s.call(c)}}var o=pI(e,r,t,0,null,!1,!1,"",ow);return t._reactRootContainer=o,t[di]=o.current,Dc(t.nodeType===8?t.parentNode:t),to(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=xh(l);a.call(c)}}var l=j0(t,0,!1,null,null,!1,!1,"",ow);return t._reactRootContainer=l,t[di]=l.current,Dc(t.nodeType===8?t.parentNode:t),to(function(){mf(e,l,n,r)}),l}function vf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=xh(o);a.call(l)}}mf(e,o,t,i)}else o=NN(n,e,t,i,r);return xh(o)}qb=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Yl(e.pendingLanes);n!==0&&(a0(e,n|1),wn(e,pt()),!(Ve&6)&&(Oa=pt()+500,ms()))}break;case 13:to(function(){var r=hi(t,1);if(r!==null){var i=nn();yr(r,t,1,i)}}),F0(t,1)}};l0=function(t){if(t.tag===13){var e=hi(t,134217728);if(e!==null){var n=nn();yr(e,t,134217728,n)}F0(t,134217728)}};Hb=function(t){if(t.tag===13){var e=Zi(t),n=hi(t,e);if(n!==null){var r=nn();yr(n,t,e,r)}F0(t,e)}};Kb=function(){return Ue};Gb=function(t,e){var n=Ue;try{return Ue=t,e()}finally{Ue=n}};wm=function(t,e,n){switch(e){case"input":if(fm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=lf(r);if(!i)throw Error(Z(90));Ib(r),fm(r,i)}}}break;case"textarea":Sb(t,n);break;case"select":e=n.value,e!=null&&ma(t,!!n.multiple,e,!1)}};Db=O0;Vb=to;var PN={usingClientEntryPoint:!1,Events:[pu,aa,lf,Nb,Pb,O0]},Ml={findFiberByHostInstance:Ls,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},DN={bundleType:Ml.bundleType,version:Ml.version,rendererPackageName:Ml.rendererPackageName,rendererConfig:Ml.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:_i.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Mb(t),t===null?null:t.stateNode},findFiberByHostInstance:Ml.findFiberByHostInstance||RN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nd.isDisabled&&nd.supportsFiber)try{rf=nd.inject(DN),Vr=nd}catch{}}Bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=PN;Bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!U0(e))throw Error(Z(200));return kN(t,e,null,n)};Bn.createRoot=function(t,e){if(!U0(t))throw Error(Z(299));var n=!1,r="",i=mI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=j0(t,1,!1,null,null,n,!1,r,i),t[di]=e.current,Dc(t.nodeType===8?t.parentNode:t),new $0(e)};Bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Z(188)):(t=Object.keys(t).join(","),Error(Z(268,t)));return t=Mb(e),t=t===null?null:t.stateNode,t};Bn.flushSync=function(t){return to(t)};Bn.hydrate=function(t,e,n){if(!yf(e))throw Error(Z(200));return vf(null,t,e,!0,n)};Bn.hydrateRoot=function(t,e,n){if(!U0(t))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=mI;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=pI(e,null,t,1,n??null,i,!1,s,o),t[di]=e.current,Dc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new gf(e)};Bn.render=function(t,e,n){if(!yf(e))throw Error(Z(200));return vf(null,t,e,!1,n)};Bn.unmountComponentAtNode=function(t){if(!yf(t))throw Error(Z(40));return t._reactRootContainer?(to(function(){vf(null,null,t,!1,function(){t._reactRootContainer=null,t[di]=null})}),!0):!1};Bn.unstable_batchedUpdates=O0;Bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!yf(n))throw Error(Z(200));if(t==null||t._reactInternals===void 0)throw Error(Z(38));return vf(t,e,n,!1,r)};Bn.version="18.3.1-next-f1338f8080-20240426";function gI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gI)}catch(t){console.error(t)}}gI(),gb.exports=Bn;var Uc=gb.exports,aw=Uc;om.createRoot=aw.createRoot,om.hydrateRoot=aw.hydrateRoot;function jt(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,r;n<t.length;n++)(r=jt(t[n]))!==""&&(e+=(e&&" ")+r);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var yI={exports:{}},vI={},_I={exports:{}},wI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var za=D;function VN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ON=typeof Object.is=="function"?Object.is:VN,zN=za.useState,MN=za.useEffect,LN=za.useLayoutEffect,jN=za.useDebugValue;function FN(t,e){var n=e(),r=zN({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return LN(function(){i.value=n,i.getSnapshot=e,Ap(i)&&s({inst:i})},[t,n,e]),MN(function(){return Ap(i)&&s({inst:i}),t(function(){Ap(i)&&s({inst:i})})},[t]),jN(n),n}function Ap(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ON(t,n)}catch{return!0}}function $N(t,e){return e()}var UN=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$N:FN;wI.useSyncExternalStore=za.useSyncExternalStore!==void 0?za.useSyncExternalStore:UN;_I.exports=wI;var BN=_I.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _f=D,qN=BN;function HN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var KN=typeof Object.is=="function"?Object.is:HN,GN=qN.useSyncExternalStore,WN=_f.useRef,QN=_f.useEffect,YN=_f.useMemo,XN=_f.useDebugValue;vI.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=WN(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=YN(function(){function l(m){if(!c){if(c=!0,d=m,m=r(m),i!==void 0&&o.hasValue){var E=o.value;if(i(E,m))return h=E}return h=m}if(E=h,KN(d,m))return E;var x=r(m);return i!==void 0&&i(E,x)?(d=m,E):(d=m,h=x)}var c=!1,d,h,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,i]);var a=GN(t,s[0],s[1]);return QN(function(){o.hasValue=!0,o.value=a},[a]),XN(a),a};yI.exports=vI;var JN=yI.exports;const ZN=ib(JN),eP={},lw=t=>{let e;const n=new Set,r=(d,h)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const m=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(E=>E(e,m))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(eP?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},tP=t=>t?lw(t):lw,{useDebugValue:nP}=K,{useSyncExternalStoreWithSelector:rP}=ZN,iP=t=>t;function xI(t,e=iP,n){const r=rP(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return nP(r),r}const cw=(t,e)=>{const n=tP(t),r=(i,s=e)=>xI(n,i,s);return Object.assign(r,n),r},sP=(t,e)=>t?cw(t,e):cw;function Lt(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,i]of t)if(!Object.is(i,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(t[r],e[r]))return!1;return!0}var oP={value:()=>{}};function wf(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Od(n)}function Od(t){this._=t}function aP(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Od.prototype=wf.prototype={constructor:Od,on:function(t,e){var n=this._,r=aP(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=lP(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=uw(n[i],t.name,e);else if(e==null)for(i in n)n[i]=uw(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Od(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function lP(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function uw(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=oP,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Zm="http://www.w3.org/1999/xhtml";const dw={svg:"http://www.w3.org/2000/svg",xhtml:Zm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function xf(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),dw.hasOwnProperty(e)?{space:dw[e],local:t}:t}function cP(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Zm&&e.documentElement.namespaceURI===Zm?e.createElement(t):e.createElementNS(n,t)}}function uP(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function bI(t){var e=xf(t);return(e.local?uP:cP)(e)}function dP(){}function B0(t){return t==null?dP:function(){return this.querySelector(t)}}function hP(t){typeof t!="function"&&(t=B0(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),l,c,d=0;d<o;++d)(l=s[d])&&(c=t.call(l,l.__data__,d,s))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new $n(r,this._parents)}function fP(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function pP(){return[]}function EI(t){return t==null?pP:function(){return this.querySelectorAll(t)}}function mP(t){return function(){return fP(t.apply(this,arguments))}}function gP(t){typeof t=="function"?t=mP(t):t=EI(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(r.push(t.call(l,l.__data__,c,o)),i.push(l));return new $n(r,i)}function II(t){return function(){return this.matches(t)}}function TI(t){return function(e){return e.matches(t)}}var yP=Array.prototype.find;function vP(t){return function(){return yP.call(this.children,t)}}function _P(){return this.firstElementChild}function wP(t){return this.select(t==null?_P:vP(typeof t=="function"?t:TI(t)))}var xP=Array.prototype.filter;function bP(){return Array.from(this.children)}function EP(t){return function(){return xP.call(this.children,t)}}function IP(t){return this.selectAll(t==null?bP:EP(typeof t=="function"?t:TI(t)))}function TP(t){typeof t!="function"&&(t=II(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new $n(r,this._parents)}function SI(t){return new Array(t.length)}function SP(){return new $n(this._enter||this._groups.map(SI),this._parents)}function bh(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}bh.prototype={constructor:bh,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function CP(t){return function(){return t}}function AP(t,e,n,r,i,s){for(var o=0,a,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new bh(t,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function kP(t,e,n,r,i,s,o){var a,l,c=new Map,d=e.length,h=s.length,f=new Array(d),m;for(a=0;a<d;++a)(l=e[a])&&(f[a]=m=o.call(l,l.__data__,a,e)+"",c.has(m)?i[a]=l:c.set(m,l));for(a=0;a<h;++a)m=o.call(t,s[a],a,s)+"",(l=c.get(m))?(r[a]=l,l.__data__=s[a],c.delete(m)):n[a]=new bh(t,s[a]);for(a=0;a<d;++a)(l=e[a])&&c.get(f[a])===l&&(i[a]=l)}function RP(t){return t.__data__}function NP(t,e){if(!arguments.length)return Array.from(this,RP);var n=e?kP:AP,r=this._parents,i=this._groups;typeof t!="function"&&(t=CP(t));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var d=r[c],h=i[c],f=h.length,m=PP(t.call(d,d&&d.__data__,c,r)),E=m.length,x=a[c]=new Array(E),R=o[c]=new Array(E),y=l[c]=new Array(f);n(d,h,x,R,y,m,e);for(var v=0,T=0,k,O;v<E;++v)if(k=x[v]){for(v>=T&&(T=v+1);!(O=R[T])&&++T<E;);k._next=O||null}}return o=new $n(o,r),o._enter=a,o._exit=l,o}function PP(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function DP(){return new $n(this._exit||this._groups.map(SI),this._parents)}function VP(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function OP(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var c=n[l],d=r[l],h=c.length,f=a[l]=new Array(h),m,E=0;E<h;++E)(m=c[E]||d[E])&&(f[E]=m);for(;l<i;++l)a[l]=n[l];return new $n(a,this._parents)}function zP(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function MP(t){t||(t=LP);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,l=i[s]=new Array(a),c,d=0;d<a;++d)(c=o[d])&&(l[d]=c);l.sort(e)}return new $n(i,this._parents).order()}function LP(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function jP(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function FP(){return Array.from(this)}function $P(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function UP(){let t=0;for(const e of this)++t;return t}function BP(){return!this.node()}function qP(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function HP(t){return function(){this.removeAttribute(t)}}function KP(t){return function(){this.removeAttributeNS(t.space,t.local)}}function GP(t,e){return function(){this.setAttribute(t,e)}}function WP(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function QP(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function YP(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function XP(t,e){var n=xf(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?KP:HP:typeof e=="function"?n.local?YP:QP:n.local?WP:GP)(n,e))}function CI(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function JP(t){return function(){this.style.removeProperty(t)}}function ZP(t,e,n){return function(){this.style.setProperty(t,e,n)}}function eD(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function tD(t,e,n){return arguments.length>1?this.each((e==null?JP:typeof e=="function"?eD:ZP)(t,e,n??"")):Ma(this.node(),t)}function Ma(t,e){return t.style.getPropertyValue(e)||CI(t).getComputedStyle(t,null).getPropertyValue(e)}function nD(t){return function(){delete this[t]}}function rD(t,e){return function(){this[t]=e}}function iD(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function sD(t,e){return arguments.length>1?this.each((e==null?nD:typeof e=="function"?iD:rD)(t,e)):this.node()[t]}function AI(t){return t.trim().split(/^|\s+/)}function q0(t){return t.classList||new kI(t)}function kI(t){this._node=t,this._names=AI(t.getAttribute("class")||"")}kI.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function RI(t,e){for(var n=q0(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function NI(t,e){for(var n=q0(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function oD(t){return function(){RI(this,t)}}function aD(t){return function(){NI(this,t)}}function lD(t,e){return function(){(e.apply(this,arguments)?RI:NI)(this,t)}}function cD(t,e){var n=AI(t+"");if(arguments.length<2){for(var r=q0(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?lD:e?oD:aD)(n,e))}function uD(){this.textContent=""}function dD(t){return function(){this.textContent=t}}function hD(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function fD(t){return arguments.length?this.each(t==null?uD:(typeof t=="function"?hD:dD)(t)):this.node().textContent}function pD(){this.innerHTML=""}function mD(t){return function(){this.innerHTML=t}}function gD(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function yD(t){return arguments.length?this.each(t==null?pD:(typeof t=="function"?gD:mD)(t)):this.node().innerHTML}function vD(){this.nextSibling&&this.parentNode.appendChild(this)}function _D(){return this.each(vD)}function wD(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function xD(){return this.each(wD)}function bD(t){var e=typeof t=="function"?t:bI(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ED(){return null}function ID(t,e){var n=typeof t=="function"?t:bI(t),r=e==null?ED:typeof e=="function"?e:B0(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function TD(){var t=this.parentNode;t&&t.removeChild(this)}function SD(){return this.each(TD)}function CD(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function AD(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function kD(t){return this.select(t?AD:CD)}function RD(t){return arguments.length?this.property("__data__",t):this.node().__data__}function ND(t){return function(e){t.call(this,e,this.__data__)}}function PD(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function DD(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function VD(t,e,n){return function(){var r=this.__on,i,s=ND(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function OD(t,e,n){var r=PD(t+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(i=0,d=a[l];i<s;++i)if((o=r[i]).type===d.type&&o.name===d.name)return d.value}return}for(a=e?VD:DD,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function PI(t,e,n){var r=CI(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function zD(t,e){return function(){return PI(this,t,e)}}function MD(t,e){return function(){return PI(this,t,e.apply(this,arguments))}}function LD(t,e){return this.each((typeof e=="function"?MD:zD)(t,e))}function*jD(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var DI=[null];function $n(t,e){this._groups=t,this._parents=e}function gu(){return new $n([[document.documentElement]],DI)}function FD(){return this}$n.prototype=gu.prototype={constructor:$n,select:hP,selectAll:gP,selectChild:wP,selectChildren:IP,filter:TP,data:NP,enter:SP,exit:DP,join:VP,merge:OP,selection:FD,order:zP,sort:MP,call:jP,nodes:FP,node:$P,size:UP,empty:BP,each:qP,attr:XP,style:tD,property:sD,classed:cD,text:fD,html:yD,raise:_D,lower:xD,append:bD,insert:ID,remove:SD,clone:kD,datum:RD,on:OD,dispatch:LD,[Symbol.iterator]:jD};function Dn(t){return typeof t=="string"?new $n([[document.querySelector(t)]],[document.documentElement]):new $n([[t]],DI)}function $D(t){let e;for(;e=t.sourceEvent;)t=e;return t}function hr(t,e){if(t=$D(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const UD={passive:!1},Bc={capture:!0,passive:!1};function kp(t){t.stopImmediatePropagation()}function xa(t){t.preventDefault(),t.stopImmediatePropagation()}function VI(t){var e=t.document.documentElement,n=Dn(t).on("dragstart.drag",xa,Bc);"onselectstart"in e?n.on("selectstart.drag",xa,Bc):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function OI(t,e){var n=t.document.documentElement,r=Dn(t).on("dragstart.drag",null);e&&(r.on("click.drag",xa,Bc),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const rd=t=>()=>t;function eg(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}eg.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function BD(t){return!t.ctrlKey&&!t.button}function qD(){return this.parentNode}function HD(t,e){return e??{x:t.x,y:t.y}}function KD(){return navigator.maxTouchPoints||"ontouchstart"in this}function zI(){var t=BD,e=qD,n=HD,r=KD,i={},s=wf("start","drag","end"),o=0,a,l,c,d,h=0;function f(k){k.on("mousedown.drag",m).filter(r).on("touchstart.drag",R).on("touchmove.drag",y,UD).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(k,O){if(!(d||!t.call(this,k,O))){var z=T(this,e.call(this,k,O),k,O,"mouse");z&&(Dn(k.view).on("mousemove.drag",E,Bc).on("mouseup.drag",x,Bc),VI(k.view),kp(k),c=!1,a=k.clientX,l=k.clientY,z("start",k))}}function E(k){if(xa(k),!c){var O=k.clientX-a,z=k.clientY-l;c=O*O+z*z>h}i.mouse("drag",k)}function x(k){Dn(k.view).on("mousemove.drag mouseup.drag",null),OI(k.view,c),xa(k),i.mouse("end",k)}function R(k,O){if(t.call(this,k,O)){var z=k.changedTouches,S=e.call(this,k,O),b=z.length,w,I;for(w=0;w<b;++w)(I=T(this,S,k,O,z[w].identifier,z[w]))&&(kp(k),I("start",k,z[w]))}}function y(k){var O=k.changedTouches,z=O.length,S,b;for(S=0;S<z;++S)(b=i[O[S].identifier])&&(xa(k),b("drag",k,O[S]))}function v(k){var O=k.changedTouches,z=O.length,S,b;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),S=0;S<z;++S)(b=i[O[S].identifier])&&(kp(k),b("end",k,O[S]))}function T(k,O,z,S,b,w){var I=s.copy(),C=hr(w||z,O),N,A,P;if((P=n.call(k,new eg("beforestart",{sourceEvent:z,target:f,identifier:b,active:o,x:C[0],y:C[1],dx:0,dy:0,dispatch:I}),S))!=null)return N=P.x-C[0]||0,A=P.y-C[1]||0,function F(M,$,j){var L=C,B;switch(M){case"start":i[b]=F,B=o++;break;case"end":delete i[b],--o;case"drag":C=hr(j||$,O),B=o;break}I.call(M,k,new eg(M,{sourceEvent:$,subject:P,target:f,identifier:b,active:B,x:C[0]+N,y:C[1]+A,dx:C[0]-L[0],dy:C[1]-L[1],dispatch:I}),S)}}return f.filter=function(k){return arguments.length?(t=typeof k=="function"?k:rd(!!k),f):t},f.container=function(k){return arguments.length?(e=typeof k=="function"?k:rd(k),f):e},f.subject=function(k){return arguments.length?(n=typeof k=="function"?k:rd(k),f):n},f.touchable=function(k){return arguments.length?(r=typeof k=="function"?k:rd(!!k),f):r},f.on=function(){var k=s.on.apply(s,arguments);return k===s?f:k},f.clickDistance=function(k){return arguments.length?(h=(k=+k)*k,f):Math.sqrt(h)},f}function H0(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function MI(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function yu(){}var qc=.7,Eh=1/qc,ba="\\s*([+-]?\\d+)\\s*",Hc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",zr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",GD=/^#([0-9a-f]{3,8})$/,WD=new RegExp(`^rgb\\(${ba},${ba},${ba}\\)$`),QD=new RegExp(`^rgb\\(${zr},${zr},${zr}\\)$`),YD=new RegExp(`^rgba\\(${ba},${ba},${ba},${Hc}\\)$`),XD=new RegExp(`^rgba\\(${zr},${zr},${zr},${Hc}\\)$`),JD=new RegExp(`^hsl\\(${Hc},${zr},${zr}\\)$`),ZD=new RegExp(`^hsla\\(${Hc},${zr},${zr},${Hc}\\)$`),hw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};H0(yu,Kc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fw,formatHex:fw,formatHex8:eV,formatHsl:tV,formatRgb:pw,toString:pw});function fw(){return this.rgb().formatHex()}function eV(){return this.rgb().formatHex8()}function tV(){return LI(this).formatHsl()}function pw(){return this.rgb().formatRgb()}function Kc(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=GD.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?mw(e):n===3?new mn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?id(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?id(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=WD.exec(t))?new mn(e[1],e[2],e[3],1):(e=QD.exec(t))?new mn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=YD.exec(t))?id(e[1],e[2],e[3],e[4]):(e=XD.exec(t))?id(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=JD.exec(t))?vw(e[1],e[2]/100,e[3]/100,1):(e=ZD.exec(t))?vw(e[1],e[2]/100,e[3]/100,e[4]):hw.hasOwnProperty(t)?mw(hw[t]):t==="transparent"?new mn(NaN,NaN,NaN,0):null}function mw(t){return new mn(t>>16&255,t>>8&255,t&255,1)}function id(t,e,n,r){return r<=0&&(t=e=n=NaN),new mn(t,e,n,r)}function nV(t){return t instanceof yu||(t=Kc(t)),t?(t=t.rgb(),new mn(t.r,t.g,t.b,t.opacity)):new mn}function tg(t,e,n,r){return arguments.length===1?nV(t):new mn(t,e,n,r??1)}function mn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}H0(mn,tg,MI(yu,{brighter(t){return t=t==null?Eh:Math.pow(Eh,t),new mn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?qc:Math.pow(qc,t),new mn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new mn(Gs(this.r),Gs(this.g),Gs(this.b),Ih(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gw,formatHex:gw,formatHex8:rV,formatRgb:yw,toString:yw}));function gw(){return`#${$s(this.r)}${$s(this.g)}${$s(this.b)}`}function rV(){return`#${$s(this.r)}${$s(this.g)}${$s(this.b)}${$s((isNaN(this.opacity)?1:this.opacity)*255)}`}function yw(){const t=Ih(this.opacity);return`${t===1?"rgb(":"rgba("}${Gs(this.r)}, ${Gs(this.g)}, ${Gs(this.b)}${t===1?")":`, ${t})`}`}function Ih(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Gs(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function $s(t){return t=Gs(t),(t<16?"0":"")+t.toString(16)}function vw(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new pr(t,e,n,r)}function LI(t){if(t instanceof pr)return new pr(t.h,t.s,t.l,t.opacity);if(t instanceof yu||(t=Kc(t)),!t)return new pr;if(t instanceof pr)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new pr(o,a,l,t.opacity)}function iV(t,e,n,r){return arguments.length===1?LI(t):new pr(t,e,n,r??1)}function pr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}H0(pr,iV,MI(yu,{brighter(t){return t=t==null?Eh:Math.pow(Eh,t),new pr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?qc:Math.pow(qc,t),new pr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new mn(Rp(t>=240?t-240:t+120,i,r),Rp(t,i,r),Rp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new pr(_w(this.h),sd(this.s),sd(this.l),Ih(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ih(this.opacity);return`${t===1?"hsl(":"hsla("}${_w(this.h)}, ${sd(this.s)*100}%, ${sd(this.l)*100}%${t===1?")":`, ${t})`}`}}));function _w(t){return t=(t||0)%360,t<0?t+360:t}function sd(t){return Math.max(0,Math.min(1,t||0))}function Rp(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const jI=t=>()=>t;function sV(t,e){return function(n){return t+n*e}}function oV(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function aV(t){return(t=+t)==1?FI:function(e,n){return n-e?oV(e,n,t):jI(isNaN(e)?n:e)}}function FI(t,e){var n=e-t;return n?sV(t,n):jI(isNaN(t)?e:t)}const ww=function t(e){var n=aV(e);function r(i,s){var o=n((i=tg(i)).r,(s=tg(s)).r),a=n(i.g,s.g),l=n(i.b,s.b),c=FI(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=a(d),i.b=l(d),i.opacity=c(d),i+""}}return r.gamma=t,r}(1);function Oi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var ng=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Np=new RegExp(ng.source,"g");function lV(t){return function(){return t}}function cV(t){return function(e){return t(e)+""}}function uV(t,e){var n=ng.lastIndex=Np.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=ng.exec(t))&&(i=Np.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:Oi(r,i)})),n=Np.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?cV(l[0].x):lV(e):(e=l.length,function(c){for(var d=0,h;d<e;++d)a[(h=l[d]).i]=h.x(c);return a.join("")})}var xw=180/Math.PI,rg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function $I(t,e,n,r,i,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*xw,skewX:Math.atan(l)*xw,scaleX:o,scaleY:a}}var od;function dV(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?rg:$I(e.a,e.b,e.c,e.d,e.e,e.f)}function hV(t){return t==null||(od||(od=document.createElementNS("http://www.w3.org/2000/svg","g")),od.setAttribute("transform",t),!(t=od.transform.baseVal.consolidate()))?rg:(t=t.matrix,$I(t.a,t.b,t.c,t.d,t.e,t.f))}function UI(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,d,h,f,m,E){if(c!==h||d!==f){var x=m.push("translate(",null,e,null,n);E.push({i:x-4,x:Oi(c,h)},{i:x-2,x:Oi(d,f)})}else(h||f)&&m.push("translate("+h+e+f+n)}function o(c,d,h,f){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:Oi(c,d)})):d&&h.push(i(h)+"rotate("+d+r)}function a(c,d,h,f){c!==d?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:Oi(c,d)}):d&&h.push(i(h)+"skewX("+d+r)}function l(c,d,h,f,m,E){if(c!==h||d!==f){var x=m.push(i(m)+"scale(",null,",",null,")");E.push({i:x-4,x:Oi(c,h)},{i:x-2,x:Oi(d,f)})}else(h!==1||f!==1)&&m.push(i(m)+"scale("+h+","+f+")")}return function(c,d){var h=[],f=[];return c=t(c),d=t(d),s(c.translateX,c.translateY,d.translateX,d.translateY,h,f),o(c.rotate,d.rotate,h,f),a(c.skewX,d.skewX,h,f),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,h,f),c=d=null,function(m){for(var E=-1,x=f.length,R;++E<x;)h[(R=f[E]).i]=R.x(m);return h.join("")}}}var fV=UI(dV,"px, ","px)","deg)"),pV=UI(hV,", ",")",")"),mV=1e-12;function bw(t){return((t=Math.exp(t))+1/t)/2}function gV(t){return((t=Math.exp(t))-1/t)/2}function yV(t){return((t=Math.exp(2*t))-1)/(t+1)}const vV=function t(e,n,r){function i(s,o){var a=s[0],l=s[1],c=s[2],d=o[0],h=o[1],f=o[2],m=d-a,E=h-l,x=m*m+E*E,R,y;if(x<mV)y=Math.log(f/c)/e,R=function(S){return[a+S*m,l+S*E,c*Math.exp(e*S*y)]};else{var v=Math.sqrt(x),T=(f*f-c*c+r*x)/(2*c*n*v),k=(f*f-c*c-r*x)/(2*f*n*v),O=Math.log(Math.sqrt(T*T+1)-T),z=Math.log(Math.sqrt(k*k+1)-k);y=(z-O)/e,R=function(S){var b=S*y,w=bw(O),I=c/(n*v)*(w*yV(e*b+O)-gV(O));return[a+I*m,l+I*E,c*w/bw(e*b+O)]}}return R.duration=y*1e3*e/Math.SQRT2,R}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return t(o,a,l)},i}(Math.SQRT2,2,4);var La=0,Jl=0,Ll=0,BI=1e3,Th,Zl,Sh=0,no=0,bf=0,Gc=typeof performance=="object"&&performance.now?performance:Date,qI=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function K0(){return no||(qI(_V),no=Gc.now()+bf)}function _V(){no=0}function Ch(){this._call=this._time=this._next=null}Ch.prototype=HI.prototype={constructor:Ch,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?K0():+n)+(e==null?0:+e),!this._next&&Zl!==this&&(Zl?Zl._next=this:Th=this,Zl=this),this._call=t,this._time=n,ig()},stop:function(){this._call&&(this._call=null,this._time=1/0,ig())}};function HI(t,e,n){var r=new Ch;return r.restart(t,e,n),r}function wV(){K0(),++La;for(var t=Th,e;t;)(e=no-t._time)>=0&&t._call.call(void 0,e),t=t._next;--La}function Ew(){no=(Sh=Gc.now())+bf,La=Jl=0;try{wV()}finally{La=0,bV(),no=0}}function xV(){var t=Gc.now(),e=t-Sh;e>BI&&(bf-=e,Sh=t)}function bV(){for(var t,e=Th,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Th=n);Zl=t,ig(r)}function ig(t){if(!La){Jl&&(Jl=clearTimeout(Jl));var e=t-no;e>24?(t<1/0&&(Jl=setTimeout(Ew,t-Gc.now()-bf)),Ll&&(Ll=clearInterval(Ll))):(Ll||(Sh=Gc.now(),Ll=setInterval(xV,BI)),La=1,qI(Ew))}}function Iw(t,e,n){var r=new Ch;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var EV=wf("start","end","cancel","interrupt"),IV=[],KI=0,Tw=1,sg=2,zd=3,Sw=4,og=5,Md=6;function Ef(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;TV(t,n,{name:e,index:r,group:i,on:EV,tween:IV,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:KI})}function G0(t,e){var n=br(t,e);if(n.state>KI)throw new Error("too late; already scheduled");return n}function $r(t,e){var n=br(t,e);if(n.state>zd)throw new Error("too late; already running");return n}function br(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function TV(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=HI(s,0,n.time);function s(c){n.state=Tw,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var d,h,f,m;if(n.state!==Tw)return l();for(d in r)if(m=r[d],m.name===n.name){if(m.state===zd)return Iw(o);m.state===Sw?(m.state=Md,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[d]):+d<e&&(m.state=Md,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[d])}if(Iw(function(){n.state===zd&&(n.state=Sw,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=sg,n.on.call("start",t,t.__data__,n.index,n.group),n.state===sg){for(n.state=zd,i=new Array(f=n.tween.length),d=0,h=-1;d<f;++d)(m=n.tween[d].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=m);i.length=h+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=og,1),h=-1,f=i.length;++h<f;)i[h].call(t,d);n.state===og&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Md,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function Ld(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>sg&&r.state<og,r.state=Md,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function SV(t){return this.each(function(){Ld(this,t)})}function CV(t,e){var n,r;return function(){var i=$r(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function AV(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=$r(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}s.tween=i}}function kV(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=br(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?CV:AV)(n,t,e))}function W0(t,e,n){var r=t._id;return t.each(function(){var i=$r(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return br(i,r).value[e]}}function GI(t,e){var n;return(typeof e=="number"?Oi:e instanceof Kc?ww:(n=Kc(e))?(e=n,ww):uV)(t,e)}function RV(t){return function(){this.removeAttribute(t)}}function NV(t){return function(){this.removeAttributeNS(t.space,t.local)}}function PV(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function DV(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function VV(t,e,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function OV(t,e,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function zV(t,e){var n=xf(t),r=n==="transform"?pV:GI;return this.attrTween(t,typeof e=="function"?(n.local?OV:VV)(n,r,W0(this,"attr."+t,e)):e==null?(n.local?NV:RV)(n):(n.local?DV:PV)(n,r,e))}function MV(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function LV(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function jV(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&LV(t,s)),n}return i._value=e,i}function FV(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&MV(t,s)),n}return i._value=e,i}function $V(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=xf(t);return this.tween(n,(r.local?jV:FV)(r,e))}function UV(t,e){return function(){G0(this,t).delay=+e.apply(this,arguments)}}function BV(t,e){return e=+e,function(){G0(this,t).delay=e}}function qV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?UV:BV)(e,t)):br(this.node(),e).delay}function HV(t,e){return function(){$r(this,t).duration=+e.apply(this,arguments)}}function KV(t,e){return e=+e,function(){$r(this,t).duration=e}}function GV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?HV:KV)(e,t)):br(this.node(),e).duration}function WV(t,e){if(typeof e!="function")throw new Error;return function(){$r(this,t).ease=e}}function QV(t){var e=this._id;return arguments.length?this.each(WV(e,t)):br(this.node(),e).ease}function YV(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;$r(this,t).ease=n}}function XV(t){if(typeof t!="function")throw new Error;return this.each(YV(this._id,t))}function JV(t){typeof t!="function"&&(t=II(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new pi(r,this._parents,this._name,this._id)}function ZV(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var l=e[a],c=n[a],d=l.length,h=o[a]=new Array(d),f,m=0;m<d;++m)(f=l[m]||c[m])&&(h[m]=f);for(;a<r;++a)o[a]=e[a];return new pi(o,this._parents,this._name,this._id)}function e4(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function t4(t,e,n){var r,i,s=e4(e)?G0:$r;return function(){var o=s(this,t),a=o.on;a!==r&&(i=(r=a).copy()).on(e,n),o.on=i}}function n4(t,e){var n=this._id;return arguments.length<2?br(this.node(),n).on.on(t):this.each(t4(n,t,e))}function r4(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function i4(){return this.on("end.remove",r4(this._id))}function s4(t){var e=this._name,n=this._id;typeof t!="function"&&(t=B0(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],l=a.length,c=s[o]=new Array(l),d,h,f=0;f<l;++f)(d=a[f])&&(h=t.call(d,d.__data__,f,a))&&("__data__"in d&&(h.__data__=d.__data__),c[f]=h,Ef(c[f],e,n,f,c,br(d,n)));return new pi(s,this._parents,e,n)}function o4(t){var e=this._name,n=this._id;typeof t!="function"&&(t=EI(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l=r[a],c=l.length,d,h=0;h<c;++h)if(d=l[h]){for(var f=t.call(d,d.__data__,h,l),m,E=br(d,n),x=0,R=f.length;x<R;++x)(m=f[x])&&Ef(m,e,n,x,f,E);s.push(f),o.push(d)}return new pi(s,o,e,n)}var a4=gu.prototype.constructor;function l4(){return new a4(this._groups,this._parents)}function c4(t,e){var n,r,i;return function(){var s=Ma(this,t),o=(this.style.removeProperty(t),Ma(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function WI(t){return function(){this.style.removeProperty(t)}}function u4(t,e,n){var r,i=n+"",s;return function(){var o=Ma(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function d4(t,e,n){var r,i,s;return function(){var o=Ma(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),Ma(this,t))),o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a))}}function h4(t,e){var n,r,i,s="style."+e,o="end."+s,a;return function(){var l=$r(this,t),c=l.on,d=l.value[s]==null?a||(a=WI(e)):void 0;(c!==n||i!==d)&&(r=(n=c).copy()).on(o,i=d),l.on=r}}function f4(t,e,n){var r=(t+="")=="transform"?fV:GI;return e==null?this.styleTween(t,c4(t,r)).on("end.style."+t,WI(t)):typeof e=="function"?this.styleTween(t,d4(t,r,W0(this,"style."+t,e))).each(h4(this._id,t)):this.styleTween(t,u4(t,r,e),n).on("end.style."+t,null)}function p4(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function m4(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&p4(t,o,n)),r}return s._value=e,s}function g4(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,m4(t,e,n??""))}function y4(t){return function(){this.textContent=t}}function v4(t){return function(){var e=t(this);this.textContent=e??""}}function _4(t){return this.tween("text",typeof t=="function"?v4(W0(this,"text",t)):y4(t==null?"":t+""))}function w4(t){return function(e){this.textContent=t.call(this,e)}}function x4(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&w4(i)),e}return r._value=t,r}function b4(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,x4(t))}function E4(){for(var t=this._name,e=this._id,n=QI(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var d=br(l,e);Ef(l,t,n,c,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new pi(r,this._parents,t,n)}function I4(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--i===0&&s()}};n.each(function(){var c=$r(this,r),d=c.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),i===0&&s()})}var T4=0;function pi(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function QI(){return++T4}var Wr=gu.prototype;pi.prototype={constructor:pi,select:s4,selectAll:o4,selectChild:Wr.selectChild,selectChildren:Wr.selectChildren,filter:JV,merge:ZV,selection:l4,transition:E4,call:Wr.call,nodes:Wr.nodes,node:Wr.node,size:Wr.size,empty:Wr.empty,each:Wr.each,on:n4,attr:zV,attrTween:$V,style:f4,styleTween:g4,text:_4,textTween:b4,remove:i4,tween:kV,delay:qV,duration:GV,ease:QV,easeVarying:XV,end:I4,[Symbol.iterator]:Wr[Symbol.iterator]};function S4(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var C4={time:null,delay:0,duration:250,ease:S4};function A4(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function k4(t){var e,n;t instanceof pi?(e=t._id,t=t._name):(e=QI(),(n=C4).time=K0(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&Ef(l,t,e,c,o,n||A4(l,e));return new pi(r,this._parents,t,e)}gu.prototype.interrupt=SV;gu.prototype.transition=k4;const ad=t=>()=>t;function R4(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function ti(t,e,n){this.k=t,this.x=e,this.y=n}ti.prototype={constructor:ti,scale:function(t){return t===1?this:new ti(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ti(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var li=new ti(1,0,0);ti.prototype;function Pp(t){t.stopImmediatePropagation()}function jl(t){t.preventDefault(),t.stopImmediatePropagation()}function N4(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function P4(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Cw(){return this.__zoom||li}function D4(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function V4(){return navigator.maxTouchPoints||"ontouchstart"in this}function O4(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function YI(){var t=N4,e=P4,n=O4,r=D4,i=V4,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=vV,c=wf("start","zoom","end"),d,h,f,m=500,E=150,x=0,R=10;function y(P){P.property("__zoom",Cw).on("wheel.zoom",b,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",I).filter(i).on("touchstart.zoom",C).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(P,F,M,$){var j=P.selection?P.selection():P;j.property("__zoom",Cw),P!==j?O(P,F,M,$):j.interrupt().each(function(){z(this,arguments).event($).start().zoom(null,typeof F=="function"?F.apply(this,arguments):F).end()})},y.scaleBy=function(P,F,M,$){y.scaleTo(P,function(){var j=this.__zoom.k,L=typeof F=="function"?F.apply(this,arguments):F;return j*L},M,$)},y.scaleTo=function(P,F,M,$){y.transform(P,function(){var j=e.apply(this,arguments),L=this.__zoom,B=M==null?k(j):typeof M=="function"?M.apply(this,arguments):M,G=L.invert(B),U=typeof F=="function"?F.apply(this,arguments):F;return n(T(v(L,U),B,G),j,o)},M,$)},y.translateBy=function(P,F,M,$){y.transform(P,function(){return n(this.__zoom.translate(typeof F=="function"?F.apply(this,arguments):F,typeof M=="function"?M.apply(this,arguments):M),e.apply(this,arguments),o)},null,$)},y.translateTo=function(P,F,M,$,j){y.transform(P,function(){var L=e.apply(this,arguments),B=this.__zoom,G=$==null?k(L):typeof $=="function"?$.apply(this,arguments):$;return n(li.translate(G[0],G[1]).scale(B.k).translate(typeof F=="function"?-F.apply(this,arguments):-F,typeof M=="function"?-M.apply(this,arguments):-M),L,o)},$,j)};function v(P,F){return F=Math.max(s[0],Math.min(s[1],F)),F===P.k?P:new ti(F,P.x,P.y)}function T(P,F,M){var $=F[0]-M[0]*P.k,j=F[1]-M[1]*P.k;return $===P.x&&j===P.y?P:new ti(P.k,$,j)}function k(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function O(P,F,M,$){P.on("start.zoom",function(){z(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){z(this,arguments).event($).end()}).tween("zoom",function(){var j=this,L=arguments,B=z(j,L).event($),G=e.apply(j,L),U=M==null?k(G):typeof M=="function"?M.apply(j,L):M,Y=Math.max(G[1][0]-G[0][0],G[1][1]-G[0][1]),X=j.__zoom,ee=typeof F=="function"?F.apply(j,L):F,oe=l(X.invert(U).concat(Y/X.k),ee.invert(U).concat(Y/ee.k));return function(fe){if(fe===1)fe=ee;else{var ue=oe(fe),_e=Y/ue[2];fe=new ti(_e,U[0]-ue[0]*_e,U[1]-ue[1]*_e)}B.zoom(null,fe)}})}function z(P,F,M){return!M&&P.__zooming||new S(P,F)}function S(P,F){this.that=P,this.args=F,this.active=0,this.sourceEvent=null,this.extent=e.apply(P,F),this.taps=0}S.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,F){return this.mouse&&P!=="mouse"&&(this.mouse[1]=F.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=F.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=F.invert(this.touch1[0])),this.that.__zoom=F,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var F=Dn(this.that).datum();c.call(P,this.that,new R4(P,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:c}),F)}};function b(P,...F){if(!t.apply(this,arguments))return;var M=z(this,F).event(P),$=this.__zoom,j=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,r.apply(this,arguments)))),L=hr(P);if(M.wheel)(M.mouse[0][0]!==L[0]||M.mouse[0][1]!==L[1])&&(M.mouse[1]=$.invert(M.mouse[0]=L)),clearTimeout(M.wheel);else{if($.k===j)return;M.mouse=[L,$.invert(L)],Ld(this),M.start()}jl(P),M.wheel=setTimeout(B,E),M.zoom("mouse",n(T(v($,j),M.mouse[0],M.mouse[1]),M.extent,o));function B(){M.wheel=null,M.end()}}function w(P,...F){if(f||!t.apply(this,arguments))return;var M=P.currentTarget,$=z(this,F,!0).event(P),j=Dn(P.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",Y,!0),L=hr(P,M),B=P.clientX,G=P.clientY;VI(P.view),Pp(P),$.mouse=[L,this.__zoom.invert(L)],Ld(this),$.start();function U(X){if(jl(X),!$.moved){var ee=X.clientX-B,oe=X.clientY-G;$.moved=ee*ee+oe*oe>x}$.event(X).zoom("mouse",n(T($.that.__zoom,$.mouse[0]=hr(X,M),$.mouse[1]),$.extent,o))}function Y(X){j.on("mousemove.zoom mouseup.zoom",null),OI(X.view,$.moved),jl(X),$.event(X).end()}}function I(P,...F){if(t.apply(this,arguments)){var M=this.__zoom,$=hr(P.changedTouches?P.changedTouches[0]:P,this),j=M.invert($),L=M.k*(P.shiftKey?.5:2),B=n(T(v(M,L),$,j),e.apply(this,F),o);jl(P),a>0?Dn(this).transition().duration(a).call(O,B,$,P):Dn(this).call(y.transform,B,$,P)}}function C(P,...F){if(t.apply(this,arguments)){var M=P.touches,$=M.length,j=z(this,F,P.changedTouches.length===$).event(P),L,B,G,U;for(Pp(P),B=0;B<$;++B)G=M[B],U=hr(G,this),U=[U,this.__zoom.invert(U),G.identifier],j.touch0?!j.touch1&&j.touch0[2]!==U[2]&&(j.touch1=U,j.taps=0):(j.touch0=U,L=!0,j.taps=1+!!d);d&&(d=clearTimeout(d)),L&&(j.taps<2&&(h=U[0],d=setTimeout(function(){d=null},m)),Ld(this),j.start())}}function N(P,...F){if(this.__zooming){var M=z(this,F).event(P),$=P.changedTouches,j=$.length,L,B,G,U;for(jl(P),L=0;L<j;++L)B=$[L],G=hr(B,this),M.touch0&&M.touch0[2]===B.identifier?M.touch0[0]=G:M.touch1&&M.touch1[2]===B.identifier&&(M.touch1[0]=G);if(B=M.that.__zoom,M.touch1){var Y=M.touch0[0],X=M.touch0[1],ee=M.touch1[0],oe=M.touch1[1],fe=(fe=ee[0]-Y[0])*fe+(fe=ee[1]-Y[1])*fe,ue=(ue=oe[0]-X[0])*ue+(ue=oe[1]-X[1])*ue;B=v(B,Math.sqrt(fe/ue)),G=[(Y[0]+ee[0])/2,(Y[1]+ee[1])/2],U=[(X[0]+oe[0])/2,(X[1]+oe[1])/2]}else if(M.touch0)G=M.touch0[0],U=M.touch0[1];else return;M.zoom("touch",n(T(B,G,U),M.extent,o))}}function A(P,...F){if(this.__zooming){var M=z(this,F).event(P),$=P.changedTouches,j=$.length,L,B;for(Pp(P),f&&clearTimeout(f),f=setTimeout(function(){f=null},m),L=0;L<j;++L)B=$[L],M.touch0&&M.touch0[2]===B.identifier?delete M.touch0:M.touch1&&M.touch1[2]===B.identifier&&delete M.touch1;if(M.touch1&&!M.touch0&&(M.touch0=M.touch1,delete M.touch1),M.touch0)M.touch0[1]=this.__zoom.invert(M.touch0[0]);else if(M.end(),M.taps===2&&(B=hr(B,this),Math.hypot(h[0]-B[0],h[1]-B[1])<R)){var G=Dn(this).on("dblclick.zoom");G&&G.apply(this,arguments)}}}return y.wheelDelta=function(P){return arguments.length?(r=typeof P=="function"?P:ad(+P),y):r},y.filter=function(P){return arguments.length?(t=typeof P=="function"?P:ad(!!P),y):t},y.touchable=function(P){return arguments.length?(i=typeof P=="function"?P:ad(!!P),y):i},y.extent=function(P){return arguments.length?(e=typeof P=="function"?P:ad([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),y):e},y.scaleExtent=function(P){return arguments.length?(s[0]=+P[0],s[1]=+P[1],y):[s[0],s[1]]},y.translateExtent=function(P){return arguments.length?(o[0][0]=+P[0][0],o[1][0]=+P[1][0],o[0][1]=+P[0][1],o[1][1]=+P[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(P){return arguments.length?(n=P,y):n},y.duration=function(P){return arguments.length?(a=+P,y):a},y.interpolate=function(P){return arguments.length?(l=P,y):l},y.on=function(){var P=c.on.apply(c,arguments);return P===c?y:P},y.clickDistance=function(P){return arguments.length?(x=(P=+P)*P,y):Math.sqrt(x)},y.tapDistance=function(P){return arguments.length?(R=+P,y):R},y}const If=D.createContext(null),z4=If.Provider,mi={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,e)=>`Couldn't create edge for ${t?"target":"source"} handle id: "${t?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},XI=mi.error001();function Ke(t,e){const n=D.useContext(If);if(n===null)throw new Error(XI);return xI(n,t,e)}const wt=()=>{const t=D.useContext(If);if(t===null)throw new Error(XI);return D.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},M4=t=>t.userSelectionActive?"none":"all";function Q0({position:t,children:e,className:n,style:r,...i}){const s=Ke(M4),o=`${t}`.split("-");return K.createElement("div",{className:jt(["react-flow__panel",n,...o]),style:{...r,pointerEvents:s},...i},e)}function L4({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:K.createElement(Q0,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},K.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const j4=({x:t,y:e,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d})=>{const h=D.useRef(null),[f,m]=D.useState({x:0,y:0,width:0,height:0}),E=jt(["react-flow__edge-textwrapper",c]);return D.useEffect(()=>{if(h.current){const x=h.current.getBBox();m({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),typeof n>"u"||!n?null:K.createElement("g",{transform:`translate(${t-f.width/2} ${e-f.height/2})`,className:E,visibility:f.width?"visible":"hidden",...d},i&&K.createElement("rect",{width:f.width+2*o[0],x:-o[0],y:-o[1],height:f.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),K.createElement("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:h,style:r},n),l)};var F4=D.memo(j4);const Y0=t=>({width:t.offsetWidth,height:t.offsetHeight}),cs=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),X0=(t={x:0,y:0},e)=>({x:cs(t.x,e[0][0],e[1][0]),y:cs(t.y,e[0][1],e[1][1])}),Aw=(t,e,n)=>t<e?cs(Math.abs(t-e),1,50)/50:t>n?-cs(Math.abs(t-n),1,50)/50:0,JI=(t,e)=>{const n=Aw(t.x,35,e.width-35)*20,r=Aw(t.y,35,e.height-35)*20;return[n,r]},ZI=t=>{var e;return((e=t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},eT=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Wc=({x:t,y:e,width:n,height:r})=>({x:t,y:e,x2:t+n,y2:e+r}),tT=({x:t,y:e,x2:n,y2:r})=>({x:t,y:e,width:n-t,height:r-e}),kw=t=>({...t.positionAbsolute||{x:0,y:0},width:t.width||0,height:t.height||0}),$4=(t,e)=>tT(eT(Wc(t),Wc(e))),ag=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),r=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*r)},U4=t=>Xn(t.width)&&Xn(t.height)&&Xn(t.x)&&Xn(t.y),Xn=t=>!isNaN(t)&&isFinite(t),ht=Symbol.for("internals"),nT=["Enter"," ","Escape"],B4=(t,e)=>{},q4=t=>"nativeEvent"in t;function lg(t){var i,s;const e=q4(t)?t.nativeEvent:t,n=((s=(i=e.composedPath)==null?void 0:i.call(e))==null?void 0:s[0])||t.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const rT=t=>"clientX"in t,ts=(t,e)=>{var s,o;const n=rT(t),r=n?t.clientX:(s=t.touches)==null?void 0:s[0].clientX,i=n?t.clientY:(o=t.touches)==null?void 0:o[0].clientY;return{x:r-((e==null?void 0:e.left)??0),y:i-((e==null?void 0:e.top)??0)}},Ah=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0},il=({id:t,path:e,labelX:n,labelY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m=20})=>K.createElement(K.Fragment,null,K.createElement("path",{id:t,style:d,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:h,markerStart:f}),m&&K.createElement("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),i&&Xn(n)&&Xn(r)?K.createElement(F4,{x:n,y:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c}):null);il.displayName="BaseEdge";function Fl(t,e,n){return n===void 0?n:r=>{const i=e().edges.find(s=>s.id===t);i&&n(r,{...i})}}function iT({sourceX:t,sourceY:e,targetX:n,targetY:r}){const i=Math.abs(n-t)/2,s=n<t?n+i:n-i,o=Math.abs(r-e)/2,a=r<e?r+o:r-o;return[s,a,i,o]}function sT({sourceX:t,sourceY:e,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const l=t*.125+i*.375+o*.375+n*.125,c=e*.125+s*.375+a*.375+r*.125,d=Math.abs(l-t),h=Math.abs(c-e);return[l,c,d,h]}var ro;(function(t){t.Strict="strict",t.Loose="loose"})(ro||(ro={}));var Us;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(Us||(Us={}));var Qc;(function(t){t.Partial="partial",t.Full="full"})(Qc||(Qc={}));var ji;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(ji||(ji={}));var kh;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(kh||(kh={}));var le;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(le||(le={}));function Rw({pos:t,x1:e,y1:n,x2:r,y2:i}){return t===le.Left||t===le.Right?[.5*(e+r),n]:[e,.5*(n+i)]}function oT({sourceX:t,sourceY:e,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top}){const[o,a]=Rw({pos:n,x1:t,y1:e,x2:r,y2:i}),[l,c]=Rw({pos:s,x1:r,y1:i,x2:t,y2:e}),[d,h,f,m]=sT({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${t},${e} C${o},${a} ${l},${c} ${r},${i}`,d,h,f,m]}const J0=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:i=le.Bottom,targetPosition:s=le.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:E,interactionWidth:x})=>{const[R,y,v]=oT({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:r,targetPosition:s});return K.createElement(il,{path:R,labelX:y,labelY:v,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:E,interactionWidth:x})});J0.displayName="SimpleBezierEdge";const Nw={[le.Left]:{x:-1,y:0},[le.Right]:{x:1,y:0},[le.Top]:{x:0,y:-1},[le.Bottom]:{x:0,y:1}},H4=({source:t,sourcePosition:e=le.Bottom,target:n})=>e===le.Left||e===le.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},Pw=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function K4({source:t,sourcePosition:e=le.Bottom,target:n,targetPosition:r=le.Top,center:i,offset:s}){const o=Nw[e],a=Nw[r],l={x:t.x+o.x*s,y:t.y+o.y*s},c={x:n.x+a.x*s,y:n.y+a.y*s},d=H4({source:l,sourcePosition:e,target:c}),h=d.x!==0?"x":"y",f=d[h];let m=[],E,x;const R={x:0,y:0},y={x:0,y:0},[v,T,k,O]=iT({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(o[h]*a[h]===-1){E=i.x??v,x=i.y??T;const S=[{x:E,y:l.y},{x:E,y:c.y}],b=[{x:l.x,y:x},{x:c.x,y:x}];o[h]===f?m=h==="x"?S:b:m=h==="x"?b:S}else{const S=[{x:l.x,y:c.y}],b=[{x:c.x,y:l.y}];if(h==="x"?m=o.x===f?b:S:m=o.y===f?S:b,e===r){const A=Math.abs(t[h]-n[h]);if(A<=s){const P=Math.min(s-1,s-A);o[h]===f?R[h]=(l[h]>t[h]?-1:1)*P:y[h]=(c[h]>n[h]?-1:1)*P}}if(e!==r){const A=h==="x"?"y":"x",P=o[h]===a[A],F=l[A]>c[A],M=l[A]<c[A];(o[h]===1&&(!P&&F||P&&M)||o[h]!==1&&(!P&&M||P&&F))&&(m=h==="x"?S:b)}const w={x:l.x+R.x,y:l.y+R.y},I={x:c.x+y.x,y:c.y+y.y},C=Math.max(Math.abs(w.x-m[0].x),Math.abs(I.x-m[0].x)),N=Math.max(Math.abs(w.y-m[0].y),Math.abs(I.y-m[0].y));C>=N?(E=(w.x+I.x)/2,x=m[0].y):(E=m[0].x,x=(w.y+I.y)/2)}return[[t,{x:l.x+R.x,y:l.y+R.y},...m,{x:c.x+y.x,y:c.y+y.y},n],E,x,k,O]}function G4(t,e,n,r){const i=Math.min(Pw(t,e)/2,Pw(e,n)/2,r),{x:s,y:o}=e;if(t.x===s&&s===n.x||t.y===o&&o===n.y)return`L${s} ${o}`;if(t.y===o){const c=t.x<n.x?-1:1,d=t.y<n.y?1:-1;return`L ${s+i*c},${o}Q ${s},${o} ${s},${o+i*d}`}const a=t.x<n.x?1:-1,l=t.y<n.y?-1:1;return`L ${s},${o+i*l}Q ${s},${o} ${s+i*a},${o}`}function Yc({sourceX:t,sourceY:e,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top,borderRadius:o=5,centerX:a,centerY:l,offset:c=20}){const[d,h,f,m,E]=K4({source:{x:t,y:e},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:l},offset:c});return[d.reduce((R,y,v)=>{let T="";return v>0&&v<d.length-1?T=G4(d[v-1],y,d[v+1],o):T=`${v===0?"M":"L"}${y.x} ${y.y}`,R+=T,R},""),h,f,m,E]}const Tf=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,sourcePosition:h=le.Bottom,targetPosition:f=le.Top,markerEnd:m,markerStart:E,pathOptions:x,interactionWidth:R})=>{const[y,v,T]=Yc({sourceX:t,sourceY:e,sourcePosition:h,targetX:n,targetY:r,targetPosition:f,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset});return K.createElement(il,{path:y,labelX:v,labelY:T,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:m,markerStart:E,interactionWidth:R})});Tf.displayName="SmoothStepEdge";const Z0=D.memo(t=>{var e;return K.createElement(Tf,{...t,pathOptions:D.useMemo(()=>{var n;return{borderRadius:0,offset:(n=t.pathOptions)==null?void 0:n.offset}},[(e=t.pathOptions)==null?void 0:e.offset])})});Z0.displayName="StepEdge";function aT({sourceX:t,sourceY:e,targetX:n,targetY:r}){const[i,s,o,a]=iT({sourceX:t,sourceY:e,targetX:n,targetY:r});return[`M ${t},${e}L ${n},${r}`,i,s,o,a]}const ey=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m})=>{const[E,x,R]=aT({sourceX:t,sourceY:e,targetX:n,targetY:r});return K.createElement(il,{path:E,labelX:x,labelY:R,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m})});ey.displayName="StraightEdge";function ld(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function Dw({pos:t,x1:e,y1:n,x2:r,y2:i,c:s}){switch(t){case le.Left:return[e-ld(e-r,s),n];case le.Right:return[e+ld(r-e,s),n];case le.Top:return[e,n-ld(n-i,s)];case le.Bottom:return[e,n+ld(i-n,s)]}}function ty({sourceX:t,sourceY:e,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top,curvature:o=.25}){const[a,l]=Dw({pos:n,x1:t,y1:e,x2:r,y2:i,c:o}),[c,d]=Dw({pos:s,x1:r,y1:i,x2:t,y2:e,c:o}),[h,f,m,E]=sT({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${t},${e} C${a},${l} ${c},${d} ${r},${i}`,h,f,m,E]}const Rh=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:i=le.Bottom,targetPosition:s=le.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:E,pathOptions:x,interactionWidth:R})=>{const[y,v,T]=ty({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:r,targetPosition:s,curvature:x==null?void 0:x.curvature});return K.createElement(il,{path:y,labelX:v,labelY:T,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:E,interactionWidth:R})});Rh.displayName="BezierEdge";const ny=D.createContext(null),W4=ny.Provider;ny.Consumer;const lT=()=>D.useContext(ny),Q4=t=>"id"in t&&"source"in t&&"target"in t,Y4=({source:t,sourceHandle:e,target:n,targetHandle:r})=>`reactflow__edge-${t}${e||""}-${n}${r||""}`,cg=(t,e)=>typeof t>"u"?"":typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(r=>`${r}=${t[r]}`).join("&")}`,X4=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),cT=(t,e)=>{if(!t.source||!t.target)return e;let n;return Q4(t)?n={...t}:n={...t,id:Y4(t)},X4(n,e)?e:e.concat(n)},ug=({x:t,y:e},[n,r,i],s,[o,a])=>{const l={x:(t-n)/i,y:(e-r)/i};return s?{x:o*Math.round(l.x/o),y:a*Math.round(l.y/a)}:l},uT=({x:t,y:e},[n,r,i])=>({x:t*i+n,y:e*i+r}),Ws=(t,e=[0,0])=>{if(!t)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(t.width??0)*e[0],r=(t.height??0)*e[1],i={x:t.position.x-n,y:t.position.y-r};return{...i,positionAbsolute:t.positionAbsolute?{x:t.positionAbsolute.x-n,y:t.positionAbsolute.y-r}:i}},vu=(t,e=[0,0])=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((r,i)=>{const{x:s,y:o}=Ws(i,e).positionAbsolute;return eT(r,Wc({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return tT(n)},dT=(t,e,[n,r,i]=[0,0,1],s=!1,o=!1,a=[0,0])=>{const l={x:(e.x-n)/i,y:(e.y-r)/i,width:e.width/i,height:e.height/i},c=[];return t.forEach(d=>{const{width:h,height:f,selectable:m=!0,hidden:E=!1}=d;if(o&&!m||E)return!1;const{positionAbsolute:x}=Ws(d,a),R={x:x.x,y:x.y,width:h||0,height:f||0},y=ag(l,R),v=typeof h>"u"||typeof f>"u"||h===null||f===null,T=s&&y>0,k=(h||0)*(f||0);(v||T||y>=k||d.dragging)&&c.push(d)}),c},hT=(t,e)=>{const n=t.map(r=>r.id);return e.filter(r=>n.includes(r.source)||n.includes(r.target))},fT=(t,e,n,r,i,s=.1)=>{const o=e/(t.width*(1+s)),a=n/(t.height*(1+s)),l=Math.min(o,a),c=cs(l,r,i),d=t.x+t.width/2,h=t.y+t.height/2,f=e/2-d*c,m=n/2-h*c;return{x:f,y:m,zoom:c}},Ns=(t,e=0)=>t.transition().duration(e);function Vw(t,e,n,r){return(e[n]||[]).reduce((i,s)=>{var o,a;return`${t.id}-${s.id}-${n}`!==r&&i.push({id:s.id||null,type:n,nodeId:t.id,x:(((o=t.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((a=t.positionAbsolute)==null?void 0:a.y)??0)+s.y+s.height/2}),i},[])}function J4(t,e,n,r,i,s){const{x:o,y:a}=ts(t),c=e.elementsFromPoint(o,a).find(E=>E.classList.contains("react-flow__handle"));if(c){const E=c.getAttribute("data-nodeid");if(E){const x=ry(void 0,c),R=c.getAttribute("data-handleid"),y=s({nodeId:E,id:R,type:x});if(y){const v=i.find(T=>T.nodeId===E&&T.type===x&&T.id===R);return{handle:{id:R,type:x,nodeId:E,x:(v==null?void 0:v.x)||n.x,y:(v==null?void 0:v.y)||n.y},validHandleResult:y}}}}let d=[],h=1/0;if(i.forEach(E=>{const x=Math.sqrt((E.x-n.x)**2+(E.y-n.y)**2);if(x<=r){const R=s(E);x<=h&&(x<h?d=[{handle:E,validHandleResult:R}]:x===h&&d.push({handle:E,validHandleResult:R}),h=x)}}),!d.length)return{handle:null,validHandleResult:pT()};if(d.length===1)return d[0];const f=d.some(({validHandleResult:E})=>E.isValid),m=d.some(({handle:E})=>E.type==="target");return d.find(({handle:E,validHandleResult:x})=>m?E.type==="target":f?x.isValid:!0)||d[0]}const Z4={source:null,target:null,sourceHandle:null,targetHandle:null},pT=()=>({handleDomNode:null,isValid:!1,connection:Z4,endHandle:null});function mT(t,e,n,r,i,s,o){const a=i==="target",l=o.querySelector(`.react-flow__handle[data-id="${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`),c={...pT(),handleDomNode:l};if(l){const d=ry(void 0,l),h=l.getAttribute("data-nodeid"),f=l.getAttribute("data-handleid"),m=l.classList.contains("connectable"),E=l.classList.contains("connectableend"),x={source:a?h:n,sourceHandle:a?f:r,target:a?n:h,targetHandle:a?r:f};c.connection=x,m&&E&&(e===ro.Strict?a&&d==="source"||!a&&d==="target":h!==n||f!==r)&&(c.endHandle={nodeId:h,handleId:f,type:d},c.isValid=s(x))}return c}function e5({nodes:t,nodeId:e,handleId:n,handleType:r}){return t.reduce((i,s)=>{if(s[ht]){const{handleBounds:o}=s[ht];let a=[],l=[];o&&(a=Vw(s,o,"source",`${e}-${n}-${r}`),l=Vw(s,o,"target",`${e}-${n}-${r}`)),i.push(...a,...l)}return i},[])}function ry(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Dp(t){t==null||t.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function t5(t,e){let n=null;return e?n="valid":t&&!e&&(n="invalid"),n}function gT({event:t,handleId:e,nodeId:n,onConnect:r,isTarget:i,getState:s,setState:o,isValidConnection:a,edgeUpdaterType:l,onReconnectEnd:c}){const d=ZI(t.target),{connectionMode:h,domNode:f,autoPanOnConnect:m,connectionRadius:E,onConnectStart:x,panBy:R,getNodes:y,cancelConnection:v}=s();let T=0,k;const{x:O,y:z}=ts(t),S=d==null?void 0:d.elementFromPoint(O,z),b=ry(l,S),w=f==null?void 0:f.getBoundingClientRect();if(!w||!b)return;let I,C=ts(t,w),N=!1,A=null,P=!1,F=null;const M=e5({nodes:y(),nodeId:n,handleId:e,handleType:b}),$=()=>{if(!m)return;const[B,G]=JI(C,w);R({x:B,y:G}),T=requestAnimationFrame($)};o({connectionPosition:C,connectionStatus:null,connectionNodeId:n,connectionHandleId:e,connectionHandleType:b,connectionStartHandle:{nodeId:n,handleId:e,type:b},connectionEndHandle:null}),x==null||x(t,{nodeId:n,handleId:e,handleType:b});function j(B){const{transform:G}=s();C=ts(B,w);const{handle:U,validHandleResult:Y}=J4(B,d,ug(C,G,!1,[1,1]),E,M,X=>mT(X,h,n,e,i?"target":"source",a,d));if(k=U,N||($(),N=!0),F=Y.handleDomNode,A=Y.connection,P=Y.isValid,o({connectionPosition:k&&P?uT({x:k.x,y:k.y},G):C,connectionStatus:t5(!!k,P),connectionEndHandle:Y.endHandle}),!k&&!P&&!F)return Dp(I);A.source!==A.target&&F&&(Dp(I),I=F,F.classList.add("connecting","react-flow__handle-connecting"),F.classList.toggle("valid",P),F.classList.toggle("react-flow__handle-valid",P))}function L(B){var G,U;(k||F)&&A&&P&&(r==null||r(A)),(U=(G=s()).onConnectEnd)==null||U.call(G,B),l&&(c==null||c(B)),Dp(I),v(),cancelAnimationFrame(T),N=!1,P=!1,A=null,F=null,d.removeEventListener("mousemove",j),d.removeEventListener("mouseup",L),d.removeEventListener("touchmove",j),d.removeEventListener("touchend",L)}d.addEventListener("mousemove",j),d.addEventListener("mouseup",L),d.addEventListener("touchmove",j),d.addEventListener("touchend",L)}const Ow=()=>!0,n5=t=>({connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName}),r5=(t,e,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=r;return{connecting:(i==null?void 0:i.nodeId)===t&&(i==null?void 0:i.handleId)===e&&(i==null?void 0:i.type)===n||(s==null?void 0:s.nodeId)===t&&(s==null?void 0:s.handleId)===e&&(s==null?void 0:s.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===t&&(o==null?void 0:o.handleId)===e&&(o==null?void 0:o.type)===n}},yT=D.forwardRef(({type:t="source",position:e=le.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:h,...f},m)=>{var w,I;const E=o||null,x=t==="target",R=wt(),y=lT(),{connectOnClick:v,noPanClassName:T}=Ke(n5,Lt),{connecting:k,clickConnecting:O}=Ke(r5(y,E,t),Lt);y||(I=(w=R.getState()).onError)==null||I.call(w,"010",mi.error010());const z=C=>{const{defaultEdgeOptions:N,onConnect:A,hasDefaultEdges:P}=R.getState(),F={...N,...C};if(P){const{edges:M,setEdges:$}=R.getState();$(cT(F,M))}A==null||A(F),a==null||a(F)},S=C=>{if(!y)return;const N=rT(C);i&&(N&&C.button===0||!N)&&gT({event:C,handleId:E,nodeId:y,onConnect:z,isTarget:x,getState:R.getState,setState:R.setState,isValidConnection:n||R.getState().isValidConnection||Ow}),N?d==null||d(C):h==null||h(C)},b=C=>{const{onClickConnectStart:N,onClickConnectEnd:A,connectionClickStartHandle:P,connectionMode:F,isValidConnection:M}=R.getState();if(!y||!P&&!i)return;if(!P){N==null||N(C,{nodeId:y,handleId:E,handleType:t}),R.setState({connectionClickStartHandle:{nodeId:y,type:t,handleId:E}});return}const $=ZI(C.target),j=n||M||Ow,{connection:L,isValid:B}=mT({nodeId:y,id:E,type:t},F,P.nodeId,P.handleId||null,P.type,j,$);B&&z(L),A==null||A(C),R.setState({connectionClickStartHandle:null})};return K.createElement("div",{"data-handleid":E,"data-nodeid":y,"data-handlepos":e,"data-id":`${y}-${E}-${t}`,className:jt(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",T,c,{source:!x,target:x,connectable:r,connectablestart:i,connectableend:s,connecting:O,connectionindicator:r&&(i&&!k||s&&k)}]),onMouseDown:S,onTouchStart:S,onClick:v?b:void 0,ref:m,...f},l)});yT.displayName="Handle";var In=D.memo(yT);const vT=({data:t,isConnectable:e,targetPosition:n=le.Top,sourcePosition:r=le.Bottom})=>K.createElement(K.Fragment,null,K.createElement(In,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label,K.createElement(In,{type:"source",position:r,isConnectable:e}));vT.displayName="DefaultNode";var dg=D.memo(vT);const _T=({data:t,isConnectable:e,sourcePosition:n=le.Bottom})=>K.createElement(K.Fragment,null,t==null?void 0:t.label,K.createElement(In,{type:"source",position:n,isConnectable:e}));_T.displayName="InputNode";var wT=D.memo(_T);const xT=({data:t,isConnectable:e,targetPosition:n=le.Top})=>K.createElement(K.Fragment,null,K.createElement(In,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label);xT.displayName="OutputNode";var bT=D.memo(xT);const iy=()=>null;iy.displayName="GroupNode";const i5=t=>({selectedNodes:t.getNodes().filter(e=>e.selected),selectedEdges:t.edges.filter(e=>e.selected).map(e=>({...e}))}),cd=t=>t.id;function s5(t,e){return Lt(t.selectedNodes.map(cd),e.selectedNodes.map(cd))&&Lt(t.selectedEdges.map(cd),e.selectedEdges.map(cd))}const ET=D.memo(({onSelectionChange:t})=>{const e=wt(),{selectedNodes:n,selectedEdges:r}=Ke(i5,s5);return D.useEffect(()=>{const i={nodes:n,edges:r};t==null||t(i),e.getState().onSelectionChange.forEach(s=>s(i))},[n,r,t]),null});ET.displayName="SelectionListener";const o5=t=>!!t.onSelectionChange;function a5({onSelectionChange:t}){const e=Ke(o5);return t||e?K.createElement(ET,{onSelectionChange:t}):null}const l5=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset});function Fo(t,e){D.useEffect(()=>{typeof t<"u"&&e(t)},[t])}function Ie(t,e,n){D.useEffect(()=>{typeof e<"u"&&n({[t]:e})},[e])}const c5=({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:c,nodesConnectable:d,nodesFocusable:h,edgesFocusable:f,edgesUpdatable:m,elevateNodesOnSelect:E,minZoom:x,maxZoom:R,nodeExtent:y,onNodesChange:v,onEdgesChange:T,elementsSelectable:k,connectionMode:O,snapGrid:z,snapToGrid:S,translateExtent:b,connectOnClick:w,defaultEdgeOptions:I,fitView:C,fitViewOptions:N,onNodesDelete:A,onEdgesDelete:P,onNodeDrag:F,onNodeDragStart:M,onNodeDragStop:$,onSelectionDrag:j,onSelectionDragStart:L,onSelectionDragStop:B,noPanClassName:G,nodeOrigin:U,rfId:Y,autoPanOnConnect:X,autoPanOnNodeDrag:ee,onError:oe,connectionRadius:fe,isValidConnection:ue,nodeDragThreshold:_e})=>{const{setNodes:we,setEdges:Ce,setDefaultNodesAndEdges:Be,setMinZoom:Pe,setMaxZoom:Qe,setTranslateExtent:ge,setNodeExtent:ft,reset:Ae}=Ke(l5,Lt),se=wt();return D.useEffect(()=>{const ke=r==null?void 0:r.map(kt=>({...kt,...I}));return Be(n,ke),()=>{Ae()}},[]),Ie("defaultEdgeOptions",I,se.setState),Ie("connectionMode",O,se.setState),Ie("onConnect",i,se.setState),Ie("onConnectStart",s,se.setState),Ie("onConnectEnd",o,se.setState),Ie("onClickConnectStart",a,se.setState),Ie("onClickConnectEnd",l,se.setState),Ie("nodesDraggable",c,se.setState),Ie("nodesConnectable",d,se.setState),Ie("nodesFocusable",h,se.setState),Ie("edgesFocusable",f,se.setState),Ie("edgesUpdatable",m,se.setState),Ie("elementsSelectable",k,se.setState),Ie("elevateNodesOnSelect",E,se.setState),Ie("snapToGrid",S,se.setState),Ie("snapGrid",z,se.setState),Ie("onNodesChange",v,se.setState),Ie("onEdgesChange",T,se.setState),Ie("connectOnClick",w,se.setState),Ie("fitViewOnInit",C,se.setState),Ie("fitViewOnInitOptions",N,se.setState),Ie("onNodesDelete",A,se.setState),Ie("onEdgesDelete",P,se.setState),Ie("onNodeDrag",F,se.setState),Ie("onNodeDragStart",M,se.setState),Ie("onNodeDragStop",$,se.setState),Ie("onSelectionDrag",j,se.setState),Ie("onSelectionDragStart",L,se.setState),Ie("onSelectionDragStop",B,se.setState),Ie("noPanClassName",G,se.setState),Ie("nodeOrigin",U,se.setState),Ie("rfId",Y,se.setState),Ie("autoPanOnConnect",X,se.setState),Ie("autoPanOnNodeDrag",ee,se.setState),Ie("onError",oe,se.setState),Ie("connectionRadius",fe,se.setState),Ie("isValidConnection",ue,se.setState),Ie("nodeDragThreshold",_e,se.setState),Fo(t,we),Fo(e,Ce),Fo(x,Pe),Fo(R,Qe),Fo(b,ge),Fo(y,ft),null},zw={display:"none"},u5={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},IT="react-flow__node-desc",TT="react-flow__edge-desc",d5="react-flow__aria-live",h5=t=>t.ariaLiveMessage;function f5({rfId:t}){const e=Ke(h5);return K.createElement("div",{id:`${d5}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:u5},e)}function p5({rfId:t,disableKeyboardA11y:e}){return K.createElement(K.Fragment,null,K.createElement("div",{id:`${IT}-${t}`,style:zw},"Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),K.createElement("div",{id:`${TT}-${t}`,style:zw},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!e&&K.createElement(f5,{rfId:t}))}var Xc=(t=null,e={actInsideInputWithModifier:!0})=>{const[n,r]=D.useState(!1),i=D.useRef(!1),s=D.useRef(new Set([])),[o,a]=D.useMemo(()=>{if(t!==null){const c=(Array.isArray(t)?t:[t]).filter(h=>typeof h=="string").map(h=>h.split("+")),d=c.reduce((h,f)=>h.concat(...f),[]);return[c,d]}return[[],[]]},[t]);return D.useEffect(()=>{const l=typeof document<"u"?document:null,c=(e==null?void 0:e.target)||l;if(t!==null){const d=m=>{if(i.current=m.ctrlKey||m.metaKey||m.shiftKey,(!i.current||i.current&&!e.actInsideInputWithModifier)&&lg(m))return!1;const x=Lw(m.code,a);s.current.add(m[x]),Mw(o,s.current,!1)&&(m.preventDefault(),r(!0))},h=m=>{if((!i.current||i.current&&!e.actInsideInputWithModifier)&&lg(m))return!1;const x=Lw(m.code,a);Mw(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(m[x]),m.key==="Meta"&&s.current.clear(),i.current=!1},f=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",d),c==null||c.addEventListener("keyup",h),window.addEventListener("blur",f),()=>{c==null||c.removeEventListener("keydown",d),c==null||c.removeEventListener("keyup",h),window.removeEventListener("blur",f)}}},[t,r]),n};function Mw(t,e,n){return t.filter(r=>n||r.length===e.size).some(r=>r.every(i=>e.has(i)))}function Lw(t,e){return e.includes(t)?"code":"key"}function ST(t,e,n,r){var a,l;const i=t.parentNode||t.parentId;if(!i)return n;const s=e.get(i),o=Ws(s,r);return ST(s,e,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((a=s[ht])==null?void 0:a.z)??0)>(n.z??0)?((l=s[ht])==null?void 0:l.z)??0:n.z??0},r)}function CT(t,e,n){t.forEach(r=>{var s;const i=r.parentNode||r.parentId;if(i&&!t.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:o,y:a,z:l}=ST(r,t,{...r.position,z:((s=r[ht])==null?void 0:s.z)??0},e);r.positionAbsolute={x:o,y:a},r[ht].z=l,n!=null&&n[r.id]&&(r[ht].isParent=!0)}})}function Vp(t,e,n,r){const i=new Map,s={},o=r?1e3:0;return t.forEach(a=>{var m;const l=(Xn(a.zIndex)?a.zIndex:0)+(a.selected?o:0),c=e.get(a.id),d={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},h=a.parentNode||a.parentId;h&&(s[h]=!0);const f=(c==null?void 0:c.type)&&(c==null?void 0:c.type)!==a.type;Object.defineProperty(d,ht,{enumerable:!1,value:{handleBounds:f||(m=c==null?void 0:c[ht])==null?void 0:m.handleBounds,z:l}}),i.set(a.id,d)}),CT(i,n,s),i}function AT(t,e={}){const{getNodes:n,width:r,height:i,minZoom:s,maxZoom:o,d3Zoom:a,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:h}=t(),f=e.initial&&!c&&d;if(a&&l&&(f||!e.initial)){const E=n().filter(R=>{var v;const y=e.includeHiddenNodes?R.width&&R.height:!R.hidden;return(v=e.nodes)!=null&&v.length?y&&e.nodes.some(T=>T.id===R.id):y}),x=E.every(R=>R.width&&R.height);if(E.length>0&&x){const R=vu(E,h),{x:y,y:v,zoom:T}=fT(R,r,i,e.minZoom??s,e.maxZoom??o,e.padding??.1),k=li.translate(y,v).scale(T);return typeof e.duration=="number"&&e.duration>0?a.transform(Ns(l,e.duration),k):a.transform(l,k),!0}}return!1}function m5(t,e){return t.forEach(n=>{const r=e.get(n.id);r&&e.set(r.id,{...r,[ht]:r[ht],selected:n.selected})}),new Map(e)}function g5(t,e){return e.map(n=>{const r=t.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function ud({changedNodes:t,changedEdges:e,get:n,set:r}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:c}=n();t!=null&&t.length&&(l&&r({nodeInternals:m5(t,i)}),o==null||o(t)),e!=null&&e.length&&(c&&r({edges:g5(e,s)}),a==null||a(e))}const $o=()=>{},y5={zoomIn:$o,zoomOut:$o,zoomTo:$o,getZoom:()=>1,setViewport:$o,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:$o,fitBounds:$o,project:t=>t,screenToFlowPosition:t=>t,flowToScreenPosition:t=>t,viewportInitialized:!1},v5=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}),_5=()=>{const t=wt(),{d3Zoom:e,d3Selection:n}=Ke(v5,Lt);return D.useMemo(()=>n&&e?{zoomIn:i=>e.scaleBy(Ns(n,i==null?void 0:i.duration),1.2),zoomOut:i=>e.scaleBy(Ns(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>e.scaleTo(Ns(n,s==null?void 0:s.duration),i),getZoom:()=>t.getState().transform[2],setViewport:(i,s)=>{const[o,a,l]=t.getState().transform,c=li.translate(i.x??o,i.y??a).scale(i.zoom??l);e.transform(Ns(n,s==null?void 0:s.duration),c)},getViewport:()=>{const[i,s,o]=t.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>AT(t.getState,i),setCenter:(i,s,o)=>{const{width:a,height:l,maxZoom:c}=t.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:c,h=a/2-i*d,f=l/2-s*d,m=li.translate(h,f).scale(d);e.transform(Ns(n,o==null?void 0:o.duration),m)},fitBounds:(i,s)=>{const{width:o,height:a,minZoom:l,maxZoom:c}=t.getState(),{x:d,y:h,zoom:f}=fT(i,o,a,l,c,(s==null?void 0:s.padding)??.1),m=li.translate(d,h).scale(f);e.transform(Ns(n,s==null?void 0:s.duration),m)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:a}=t.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),ug(i,s,o,a)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:a,domNode:l}=t.getState();if(!l)return i;const{x:c,y:d}=l.getBoundingClientRect(),h={x:i.x-c,y:i.y-d};return ug(h,s,o,a)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=t.getState();if(!o)return i;const{x:a,y:l}=o.getBoundingClientRect(),c=uT(i,s);return{x:c.x+a,y:c.y+l}},viewportInitialized:!0}:y5,[e,n])};function Ur(){const t=_5(),e=wt(),n=D.useCallback(()=>e.getState().getNodes().map(x=>({...x})),[]),r=D.useCallback(x=>e.getState().nodeInternals.get(x),[]),i=D.useCallback(()=>{const{edges:x=[]}=e.getState();return x.map(R=>({...R}))},[]),s=D.useCallback(x=>{const{edges:R=[]}=e.getState();return R.find(y=>y.id===x)},[]),o=D.useCallback(x=>{const{getNodes:R,setNodes:y,hasDefaultNodes:v,onNodesChange:T}=e.getState(),k=R(),O=typeof x=="function"?x(k):x;if(v)y(O);else if(T){const z=O.length===0?k.map(S=>({type:"remove",id:S.id})):O.map(S=>({item:S,type:"reset"}));T(z)}},[]),a=D.useCallback(x=>{const{edges:R=[],setEdges:y,hasDefaultEdges:v,onEdgesChange:T}=e.getState(),k=typeof x=="function"?x(R):x;if(v)y(k);else if(T){const O=k.length===0?R.map(z=>({type:"remove",id:z.id})):k.map(z=>({item:z,type:"reset"}));T(O)}},[]),l=D.useCallback(x=>{const R=Array.isArray(x)?x:[x],{getNodes:y,setNodes:v,hasDefaultNodes:T,onNodesChange:k}=e.getState();if(T){const z=[...y(),...R];v(z)}else if(k){const O=R.map(z=>({item:z,type:"add"}));k(O)}},[]),c=D.useCallback(x=>{const R=Array.isArray(x)?x:[x],{edges:y=[],setEdges:v,hasDefaultEdges:T,onEdgesChange:k}=e.getState();if(T)v([...y,...R]);else if(k){const O=R.map(z=>({item:z,type:"add"}));k(O)}},[]),d=D.useCallback(()=>{const{getNodes:x,edges:R=[],transform:y}=e.getState(),[v,T,k]=y;return{nodes:x().map(O=>({...O})),edges:R.map(O=>({...O})),viewport:{x:v,y:T,zoom:k}}},[]),h=D.useCallback(({nodes:x,edges:R})=>{const{nodeInternals:y,getNodes:v,edges:T,hasDefaultNodes:k,hasDefaultEdges:O,onNodesDelete:z,onEdgesDelete:S,onNodesChange:b,onEdgesChange:w}=e.getState(),I=(x||[]).map(F=>F.id),C=(R||[]).map(F=>F.id),N=v().reduce((F,M)=>{const $=M.parentNode||M.parentId,j=!I.includes(M.id)&&$&&F.find(B=>B.id===$);return(typeof M.deletable=="boolean"?M.deletable:!0)&&(I.includes(M.id)||j)&&F.push(M),F},[]),A=T.filter(F=>typeof F.deletable=="boolean"?F.deletable:!0),P=A.filter(F=>C.includes(F.id));if(N||P){const F=hT(N,A),M=[...P,...F],$=M.reduce((j,L)=>(j.includes(L.id)||j.push(L.id),j),[]);if((O||k)&&(O&&e.setState({edges:T.filter(j=>!$.includes(j.id))}),k&&(N.forEach(j=>{y.delete(j.id)}),e.setState({nodeInternals:new Map(y)}))),$.length>0&&(S==null||S(M),w&&w($.map(j=>({id:j,type:"remove"})))),N.length>0&&(z==null||z(N),b)){const j=N.map(L=>({id:L.id,type:"remove"}));b(j)}}},[]),f=D.useCallback(x=>{const R=U4(x),y=R?null:e.getState().nodeInternals.get(x.id);return!R&&!y?[null,null,R]:[R?x:kw(y),y,R]},[]),m=D.useCallback((x,R=!0,y)=>{const[v,T,k]=f(x);return v?(y||e.getState().getNodes()).filter(O=>{if(!k&&(O.id===T.id||!O.positionAbsolute))return!1;const z=kw(O),S=ag(z,v);return R&&S>0||S>=v.width*v.height}):[]},[]),E=D.useCallback((x,R,y=!0)=>{const[v]=f(x);if(!v)return!1;const T=ag(v,R);return y&&T>0||T>=v.width*v.height},[]);return D.useMemo(()=>({...t,getNodes:n,getNode:r,getEdges:i,getEdge:s,setNodes:o,setEdges:a,addNodes:l,addEdges:c,toObject:d,deleteElements:h,getIntersectingNodes:m,isNodeIntersecting:E}),[t,n,r,i,s,o,a,l,c,d,h,m,E])}const w5={actInsideInputWithModifier:!1};var x5=({deleteKeyCode:t,multiSelectionKeyCode:e})=>{const n=wt(),{deleteElements:r}=Ur(),i=Xc(t,w5),s=Xc(e);D.useEffect(()=>{if(i){const{edges:o,getNodes:a}=n.getState(),l=a().filter(d=>d.selected),c=o.filter(d=>d.selected);r({nodes:l,edges:c}),n.setState({nodesSelectionActive:!1})}},[i]),D.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function b5(t){const e=wt();D.useEffect(()=>{let n;const r=()=>{var s,o;if(!t.current)return;const i=Y0(t.current);(i.height===0||i.width===0)&&((o=(s=e.getState()).onError)==null||o.call(s,"004",mi.error004())),e.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),t.current&&(n=new ResizeObserver(()=>r()),n.observe(t.current)),()=>{window.removeEventListener("resize",r),n&&t.current&&n.unobserve(t.current)}},[])}const sy={position:"absolute",width:"100%",height:"100%",top:0,left:0},E5=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,dd=t=>({x:t.x,y:t.y,zoom:t.k}),Uo=(t,e)=>t.target.closest(`.${e}`),jw=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),Fw=t=>{const e=t.ctrlKey&&Ah()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e},I5=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler,userSelectionActive:t.userSelectionActive}),T5=({onMove:t,onMoveStart:e,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=Us.Free,zoomOnDoubleClick:c=!0,elementsSelectable:d,panOnDrag:h=!0,defaultViewport:f,translateExtent:m,minZoom:E,maxZoom:x,zoomActivationKeyCode:R,preventScrolling:y=!0,children:v,noWheelClassName:T,noPanClassName:k})=>{const O=D.useRef(),z=wt(),S=D.useRef(!1),b=D.useRef(!1),w=D.useRef(null),I=D.useRef({x:0,y:0,zoom:0}),{d3Zoom:C,d3Selection:N,d3ZoomHandler:A,userSelectionActive:P}=Ke(I5,Lt),F=Xc(R),M=D.useRef(0),$=D.useRef(!1),j=D.useRef();return b5(w),D.useEffect(()=>{if(w.current){const L=w.current.getBoundingClientRect(),B=YI().scaleExtent([E,x]).translateExtent(m),G=Dn(w.current).call(B),U=li.translate(f.x,f.y).scale(cs(f.zoom,E,x)),Y=[[0,0],[L.width,L.height]],X=B.constrain()(U,Y,m);B.transform(G,X),B.wheelDelta(Fw),z.setState({d3Zoom:B,d3Selection:G,d3ZoomHandler:G.on("wheel.zoom"),transform:[X.x,X.y,X.k],domNode:w.current.closest(".react-flow")})}},[]),D.useEffect(()=>{N&&C&&(o&&!F&&!P?N.on("wheel.zoom",L=>{if(Uo(L,T))return!1;L.preventDefault(),L.stopImmediatePropagation();const B=N.property("__zoom").k||1;if(L.ctrlKey&&s){const ue=hr(L),_e=Fw(L),we=B*Math.pow(2,_e);C.scaleTo(N,we,ue,L);return}const G=L.deltaMode===1?20:1;let U=l===Us.Vertical?0:L.deltaX*G,Y=l===Us.Horizontal?0:L.deltaY*G;!Ah()&&L.shiftKey&&l!==Us.Vertical&&(U=L.deltaY*G,Y=0),C.translateBy(N,-(U/B)*a,-(Y/B)*a,{internal:!0});const X=dd(N.property("__zoom")),{onViewportChangeStart:ee,onViewportChange:oe,onViewportChangeEnd:fe}=z.getState();clearTimeout(j.current),$.current||($.current=!0,e==null||e(L,X),ee==null||ee(X)),$.current&&(t==null||t(L,X),oe==null||oe(X),j.current=setTimeout(()=>{n==null||n(L,X),fe==null||fe(X),$.current=!1},150))},{passive:!1}):typeof A<"u"&&N.on("wheel.zoom",function(L,B){if(!y&&L.type==="wheel"&&!L.ctrlKey||Uo(L,T))return null;L.preventDefault(),A.call(this,L,B)},{passive:!1}))},[P,o,l,N,C,A,F,s,y,T,e,t,n]),D.useEffect(()=>{C&&C.on("start",L=>{var U,Y;if(!L.sourceEvent||L.sourceEvent.internal)return null;M.current=(U=L.sourceEvent)==null?void 0:U.button;const{onViewportChangeStart:B}=z.getState(),G=dd(L.transform);S.current=!0,I.current=G,((Y=L.sourceEvent)==null?void 0:Y.type)==="mousedown"&&z.setState({paneDragging:!0}),B==null||B(G),e==null||e(L.sourceEvent,G)})},[C,e]),D.useEffect(()=>{C&&(P&&!S.current?C.on("zoom",null):P||C.on("zoom",L=>{var G;const{onViewportChange:B}=z.getState();if(z.setState({transform:[L.transform.x,L.transform.y,L.transform.k]}),b.current=!!(r&&jw(h,M.current??0)),(t||B)&&!((G=L.sourceEvent)!=null&&G.internal)){const U=dd(L.transform);B==null||B(U),t==null||t(L.sourceEvent,U)}}))},[P,C,t,h,r]),D.useEffect(()=>{C&&C.on("end",L=>{if(!L.sourceEvent||L.sourceEvent.internal)return null;const{onViewportChangeEnd:B}=z.getState();if(S.current=!1,z.setState({paneDragging:!1}),r&&jw(h,M.current??0)&&!b.current&&r(L.sourceEvent),b.current=!1,(n||B)&&E5(I.current,L.transform)){const G=dd(L.transform);I.current=G,clearTimeout(O.current),O.current=setTimeout(()=>{B==null||B(G),n==null||n(L.sourceEvent,G)},o?150:0)}})},[C,o,h,n,r]),D.useEffect(()=>{C&&C.filter(L=>{const B=F||i,G=s&&L.ctrlKey;if((h===!0||Array.isArray(h)&&h.includes(1))&&L.button===1&&L.type==="mousedown"&&(Uo(L,"react-flow__node")||Uo(L,"react-flow__edge")))return!0;if(!h&&!B&&!o&&!c&&!s||P||!c&&L.type==="dblclick"||Uo(L,T)&&L.type==="wheel"||Uo(L,k)&&(L.type!=="wheel"||o&&L.type==="wheel"&&!F)||!s&&L.ctrlKey&&L.type==="wheel"||!B&&!o&&!G&&L.type==="wheel"||!h&&(L.type==="mousedown"||L.type==="touchstart")||Array.isArray(h)&&!h.includes(L.button)&&L.type==="mousedown")return!1;const U=Array.isArray(h)&&h.includes(L.button)||!L.button||L.button<=1;return(!L.ctrlKey||L.type==="wheel")&&U})},[P,C,i,s,o,c,h,d,F]),K.createElement("div",{className:"react-flow__renderer",ref:w,style:sy},v)},S5=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function C5(){const{userSelectionActive:t,userSelectionRect:e}=Ke(S5,Lt);return t&&e?K.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function $w(t,e){const n=e.parentNode||e.parentId,r=t.find(i=>i.id===n);if(r){const i=e.position.x+e.width-r.width,s=e.position.y+e.height-r.height;if(i>0||s>0||e.position.x<0||e.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),s>0&&(r.style.height+=s),e.position.x<0){const o=Math.abs(e.position.x);r.position.x=r.position.x-o,r.style.width+=o,e.position.x=0}if(e.position.y<0){const o=Math.abs(e.position.y);r.position.y=r.position.y-o,r.style.height+=o,e.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function kT(t,e){if(t.some(r=>r.type==="reset"))return t.filter(r=>r.type==="reset").map(r=>r.item);const n=t.filter(r=>r.type==="add").map(r=>r.item);return e.reduce((r,i)=>{const s=t.filter(a=>a.id===i.id);if(s.length===0)return r.push(i),r;const o={...i};for(const a of s)if(a)switch(a.type){case"select":{o.selected=a.selected;break}case"position":{typeof a.position<"u"&&(o.position=a.position),typeof a.positionAbsolute<"u"&&(o.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(o.dragging=a.dragging),o.expandParent&&$w(r,o);break}case"dimensions":{typeof a.dimensions<"u"&&(o.width=a.dimensions.width,o.height=a.dimensions.height),typeof a.updateStyle<"u"&&(o.style={...o.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(o.resizing=a.resizing),o.expandParent&&$w(r,o);break}case"remove":return r}return r.push(o),r},n)}function RT(t,e){return kT(t,e)}function A5(t,e){return kT(t,e)}const zi=(t,e)=>({id:t,type:"select",selected:e});function pa(t,e){return t.reduce((n,r)=>{const i=e.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(zi(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(zi(r.id,!1))),n},[])}const Op=(t,e)=>n=>{n.target===e.current&&(t==null||t(n))},k5=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,dragging:t.paneDragging}),NT=D.memo(({isSelecting:t,selectionMode:e=Qc.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:c,onPaneMouseLeave:d,children:h})=>{const f=D.useRef(null),m=wt(),E=D.useRef(0),x=D.useRef(0),R=D.useRef(),{userSelectionActive:y,elementsSelectable:v,dragging:T}=Ke(k5,Lt),k=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),E.current=0,x.current=0},O=A=>{s==null||s(A),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},z=A=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){A.preventDefault();return}o==null||o(A)},S=a?A=>a(A):void 0,b=A=>{const{resetSelectedElements:P,domNode:F}=m.getState();if(R.current=F==null?void 0:F.getBoundingClientRect(),!v||!t||A.button!==0||A.target!==f.current||!R.current)return;const{x:M,y:$}=ts(A,R.current);P(),m.setState({userSelectionRect:{width:0,height:0,startX:M,startY:$,x:M,y:$}}),r==null||r(A)},w=A=>{const{userSelectionRect:P,nodeInternals:F,edges:M,transform:$,onNodesChange:j,onEdgesChange:L,nodeOrigin:B,getNodes:G}=m.getState();if(!t||!R.current||!P)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const U=ts(A,R.current),Y=P.startX??0,X=P.startY??0,ee={...P,x:U.x<Y?U.x:Y,y:U.y<X?U.y:X,width:Math.abs(U.x-Y),height:Math.abs(U.y-X)},oe=G(),fe=dT(F,ee,$,e===Qc.Partial,!0,B),ue=hT(fe,M).map(we=>we.id),_e=fe.map(we=>we.id);if(E.current!==_e.length){E.current=_e.length;const we=pa(oe,_e);we.length&&(j==null||j(we))}if(x.current!==ue.length){x.current=ue.length;const we=pa(M,ue);we.length&&(L==null||L(we))}m.setState({userSelectionRect:ee})},I=A=>{if(A.button!==0)return;const{userSelectionRect:P}=m.getState();!y&&P&&A.target===f.current&&(O==null||O(A)),m.setState({nodesSelectionActive:E.current>0}),k(),i==null||i(A)},C=A=>{y&&(m.setState({nodesSelectionActive:E.current>0}),i==null||i(A)),k()},N=v&&(t||y);return K.createElement("div",{className:jt(["react-flow__pane",{dragging:T,selection:t}]),onClick:N?void 0:Op(O,f),onContextMenu:Op(z,f),onWheel:Op(S,f),onMouseEnter:N?void 0:l,onMouseDown:N?b:void 0,onMouseMove:N?w:c,onMouseUp:N?I:void 0,onMouseLeave:N?C:d,ref:f,style:sy},h,K.createElement(C5,null))});NT.displayName="Pane";function PT(t,e){const n=t.parentNode||t.parentId;if(!n)return!1;const r=e.get(n);return r?r.selected?!0:PT(r,e):!1}function Uw(t,e,n){let r=t;do{if(r!=null&&r.matches(e))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function R5(t,e,n,r){return Array.from(t.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!PT(i,t))&&(i.draggable||e&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function N5(t,e){return!e||e==="parent"?e:[e[0],[e[1][0]-(t.width||0),e[1][1]-(t.height||0)]]}function DT(t,e,n,r,i=[0,0],s){const o=N5(t,t.extent||r);let a=o;const l=t.parentNode||t.parentId;if(t.extent==="parent"&&!t.expandParent)if(l&&t.width&&t.height){const h=n.get(l),{x:f,y:m}=Ws(h,i).positionAbsolute;a=h&&Xn(f)&&Xn(m)&&Xn(h.width)&&Xn(h.height)?[[f+t.width*i[0],m+t.height*i[1]],[f+h.width-t.width+t.width*i[0],m+h.height-t.height+t.height*i[1]]]:a}else s==null||s("005",mi.error005()),a=o;else if(t.extent&&l&&t.extent!=="parent"){const h=n.get(l),{x:f,y:m}=Ws(h,i).positionAbsolute;a=[[t.extent[0][0]+f,t.extent[0][1]+m],[t.extent[1][0]+f,t.extent[1][1]+m]]}let c={x:0,y:0};if(l){const h=n.get(l);c=Ws(h,i).positionAbsolute}const d=a&&a!=="parent"?X0(e,a):e;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function zp({nodeId:t,dragItems:e,nodeInternals:n}){const r=e.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[t?r.find(i=>i.id===t):r[0],r]}const Bw=(t,e,n,r)=>{const i=e.querySelectorAll(t);if(!i||!i.length)return null;const s=Array.from(i),o=e.getBoundingClientRect(),a={x:o.width*r[0],y:o.height*r[1]};return s.map(l=>{const c=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(c.left-o.left-a.x)/n,y:(c.top-o.top-a.y)/n,...Y0(l)}})};function $l(t,e,n){return n===void 0?n:r=>{const i=e().nodeInternals.get(t);i&&n(r,{...i})}}function hg({id:t,store:e,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:a,onError:l}=e.getState(),c=a.get(t);if(!c){l==null||l("012",mi.error012(t));return}e.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&o)&&(s({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):i([t])}function VT(){const t=wt();return D.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:s}=t.getState(),o=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,l={x:(o-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:s?i[0]*Math.round(l.x/i[0]):l.x,ySnapped:s?i[1]*Math.round(l.y/i[1]):l.y,...l}},[])}function Mp(t){return(e,n,r)=>t==null?void 0:t(e,r)}function OT({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const a=wt(),[l,c]=D.useState(!1),d=D.useRef([]),h=D.useRef({x:null,y:null}),f=D.useRef(0),m=D.useRef(null),E=D.useRef({x:0,y:0}),x=D.useRef(null),R=D.useRef(!1),y=D.useRef(!1),v=D.useRef(!1),T=VT();return D.useEffect(()=>{if(t!=null&&t.current){const k=Dn(t.current),O=({x:b,y:w})=>{const{nodeInternals:I,onNodeDrag:C,onSelectionDrag:N,updateNodePositions:A,nodeExtent:P,snapGrid:F,snapToGrid:M,nodeOrigin:$,onError:j}=a.getState();h.current={x:b,y:w};let L=!1,B={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&P){const U=vu(d.current,$);B=Wc(U)}if(d.current=d.current.map(U=>{const Y={x:b-U.distance.x,y:w-U.distance.y};M&&(Y.x=F[0]*Math.round(Y.x/F[0]),Y.y=F[1]*Math.round(Y.y/F[1]));const X=[[P[0][0],P[0][1]],[P[1][0],P[1][1]]];d.current.length>1&&P&&!U.extent&&(X[0][0]=U.positionAbsolute.x-B.x+P[0][0],X[1][0]=U.positionAbsolute.x+(U.width??0)-B.x2+P[1][0],X[0][1]=U.positionAbsolute.y-B.y+P[0][1],X[1][1]=U.positionAbsolute.y+(U.height??0)-B.y2+P[1][1]);const ee=DT(U,Y,I,X,$,j);return L=L||U.position.x!==ee.position.x||U.position.y!==ee.position.y,U.position=ee.position,U.positionAbsolute=ee.positionAbsolute,U}),!L)return;A(d.current,!0,!0),c(!0);const G=i?C:Mp(N);if(G&&x.current){const[U,Y]=zp({nodeId:i,dragItems:d.current,nodeInternals:I});G(x.current,U,Y)}},z=()=>{if(!m.current)return;const[b,w]=JI(E.current,m.current);if(b!==0||w!==0){const{transform:I,panBy:C}=a.getState();h.current.x=(h.current.x??0)-b/I[2],h.current.y=(h.current.y??0)-w/I[2],C({x:b,y:w})&&O(h.current)}f.current=requestAnimationFrame(z)},S=b=>{var $;const{nodeInternals:w,multiSelectionActive:I,nodesDraggable:C,unselectNodesAndEdges:N,onNodeDragStart:A,onSelectionDragStart:P}=a.getState();y.current=!0;const F=i?A:Mp(P);(!o||!s)&&!I&&i&&(($=w.get(i))!=null&&$.selected||N()),i&&s&&o&&hg({id:i,store:a,nodeRef:t});const M=T(b);if(h.current=M,d.current=R5(w,C,M,i),F&&d.current){const[j,L]=zp({nodeId:i,dragItems:d.current,nodeInternals:w});F(b.sourceEvent,j,L)}};if(e)k.on(".drag",null);else{const b=zI().on("start",w=>{const{domNode:I,nodeDragThreshold:C}=a.getState();C===0&&S(w),v.current=!1;const N=T(w);h.current=N,m.current=(I==null?void 0:I.getBoundingClientRect())||null,E.current=ts(w.sourceEvent,m.current)}).on("drag",w=>{var A,P;const I=T(w),{autoPanOnNodeDrag:C,nodeDragThreshold:N}=a.getState();if(w.sourceEvent.type==="touchmove"&&w.sourceEvent.touches.length>1&&(v.current=!0),!v.current){if(!R.current&&y.current&&C&&(R.current=!0,z()),!y.current){const F=I.xSnapped-(((A=h==null?void 0:h.current)==null?void 0:A.x)??0),M=I.ySnapped-(((P=h==null?void 0:h.current)==null?void 0:P.y)??0);Math.sqrt(F*F+M*M)>N&&S(w)}(h.current.x!==I.xSnapped||h.current.y!==I.ySnapped)&&d.current&&y.current&&(x.current=w.sourceEvent,E.current=ts(w.sourceEvent,m.current),O(I))}}).on("end",w=>{if(!(!y.current||v.current)&&(c(!1),R.current=!1,y.current=!1,cancelAnimationFrame(f.current),d.current)){const{updateNodePositions:I,nodeInternals:C,onNodeDragStop:N,onSelectionDragStop:A}=a.getState(),P=i?N:Mp(A);if(I(d.current,!1,!1),P){const[F,M]=zp({nodeId:i,dragItems:d.current,nodeInternals:C});P(w.sourceEvent,F,M)}}}).filter(w=>{const I=w.target;return!w.button&&(!n||!Uw(I,`.${n}`,t))&&(!r||Uw(I,r,t))});return k.call(b),()=>{k.on(".drag",null)}}}},[t,e,n,r,s,a,i,o,T]),l}function zT(){const t=wt();return D.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:a,snapGrid:l,onError:c,nodesDraggable:d}=t.getState(),h=o().filter(v=>v.selected&&(v.draggable||d&&typeof v.draggable>"u")),f=a?l[0]:5,m=a?l[1]:5,E=n.isShiftPressed?4:1,x=n.x*f*E,R=n.y*m*E,y=h.map(v=>{if(v.positionAbsolute){const T={x:v.positionAbsolute.x+x,y:v.positionAbsolute.y+R};a&&(T.x=l[0]*Math.round(T.x/l[0]),T.y=l[1]*Math.round(T.y/l[1]));const{positionAbsolute:k,position:O}=DT(v,T,r,i,void 0,c);v.position=O,v.positionAbsolute=k}return v});s(y,!0,!1)},[])}const Ea={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ul=t=>{const e=({id:n,type:r,data:i,xPos:s,yPos:o,xPosOrigin:a,yPosOrigin:l,selected:c,onClick:d,onMouseEnter:h,onMouseMove:f,onMouseLeave:m,onContextMenu:E,onDoubleClick:x,style:R,className:y,isDraggable:v,isSelectable:T,isConnectable:k,isFocusable:O,selectNodesOnDrag:z,sourcePosition:S,targetPosition:b,hidden:w,resizeObserver:I,dragHandle:C,zIndex:N,isParent:A,noDragClassName:P,noPanClassName:F,initialized:M,disableKeyboardA11y:$,ariaLabel:j,rfId:L,hasHandleBounds:B})=>{const G=wt(),U=D.useRef(null),Y=D.useRef(null),X=D.useRef(S),ee=D.useRef(b),oe=D.useRef(r),fe=T||v||d||h||f||m,ue=zT(),_e=$l(n,G.getState,h),we=$l(n,G.getState,f),Ce=$l(n,G.getState,m),Be=$l(n,G.getState,E),Pe=$l(n,G.getState,x),Qe=Ae=>{const{nodeDragThreshold:se}=G.getState();if(T&&(!z||!v||se>0)&&hg({id:n,store:G,nodeRef:U}),d){const ke=G.getState().nodeInternals.get(n);ke&&d(Ae,{...ke})}},ge=Ae=>{if(!lg(Ae)&&!$)if(nT.includes(Ae.key)&&T){const se=Ae.key==="Escape";hg({id:n,store:G,unselect:se,nodeRef:U})}else v&&c&&Object.prototype.hasOwnProperty.call(Ea,Ae.key)&&(G.setState({ariaLiveMessage:`Moved selected node ${Ae.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),ue({x:Ea[Ae.key].x,y:Ea[Ae.key].y,isShiftPressed:Ae.shiftKey}))};D.useEffect(()=>()=>{Y.current&&(I==null||I.unobserve(Y.current),Y.current=null)},[]),D.useEffect(()=>{if(U.current&&!w){const Ae=U.current;(!M||!B||Y.current!==Ae)&&(Y.current&&(I==null||I.unobserve(Y.current)),I==null||I.observe(Ae),Y.current=Ae)}},[w,M,B]),D.useEffect(()=>{const Ae=oe.current!==r,se=X.current!==S,ke=ee.current!==b;U.current&&(Ae||se||ke)&&(Ae&&(oe.current=r),se&&(X.current=S),ke&&(ee.current=b),G.getState().updateNodeDimensions([{id:n,nodeElement:U.current,forceUpdate:!0}]))},[n,r,S,b]);const ft=OT({nodeRef:U,disabled:w||!v,noDragClassName:P,handleSelector:C,nodeId:n,isSelectable:T,selectNodesOnDrag:z});return w?null:K.createElement("div",{className:jt(["react-flow__node",`react-flow__node-${r}`,{[F]:v},y,{selected:c,selectable:T,parent:A,dragging:ft}]),ref:U,style:{zIndex:N,transform:`translate(${a}px,${l}px)`,pointerEvents:fe?"all":"none",visibility:M?"visible":"hidden",...R},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:_e,onMouseMove:we,onMouseLeave:Ce,onContextMenu:Be,onClick:Qe,onDoubleClick:Pe,onKeyDown:O?ge:void 0,tabIndex:O?0:void 0,role:O?"button":void 0,"aria-describedby":$?void 0:`${IT}-${L}`,"aria-label":j},K.createElement(W4,{value:n},K.createElement(t,{id:n,data:i,type:r,xPos:s,yPos:o,selected:c,isConnectable:k,sourcePosition:S,targetPosition:b,dragging:ft,dragHandle:C,zIndex:N})))};return e.displayName="NodeWrapper",D.memo(e)};const P5=t=>{const e=t.getNodes().filter(n=>n.selected);return{...vu(e,t.nodeOrigin),transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`,userSelectionActive:t.userSelectionActive}};function D5({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const r=wt(),{width:i,height:s,x:o,y:a,transformString:l,userSelectionActive:c}=Ke(P5,Lt),d=zT(),h=D.useRef(null);if(D.useEffect(()=>{var E;n||(E=h.current)==null||E.focus({preventScroll:!0})},[n]),OT({nodeRef:h}),c||!i||!s)return null;const f=t?E=>{const x=r.getState().getNodes().filter(R=>R.selected);t(E,x)}:void 0,m=E=>{Object.prototype.hasOwnProperty.call(Ea,E.key)&&d({x:Ea[E.key].x,y:Ea[E.key].y,isShiftPressed:E.shiftKey})};return K.createElement("div",{className:jt(["react-flow__nodesselection","react-flow__container",e]),style:{transform:l}},K.createElement("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:i,height:s,top:a,left:o}}))}var V5=D.memo(D5);const O5=t=>t.nodesSelectionActive,MT=({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:a,onMove:l,onMoveStart:c,onMoveEnd:d,selectionKeyCode:h,selectionOnDrag:f,selectionMode:m,onSelectionStart:E,onSelectionEnd:x,multiSelectionKeyCode:R,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:T,zoomOnScroll:k,zoomOnPinch:O,panOnScroll:z,panOnScrollSpeed:S,panOnScrollMode:b,zoomOnDoubleClick:w,panOnDrag:I,defaultViewport:C,translateExtent:N,minZoom:A,maxZoom:P,preventScrolling:F,onSelectionContextMenu:M,noWheelClassName:$,noPanClassName:j,disableKeyboardA11y:L})=>{const B=Ke(O5),G=Xc(h),U=Xc(y),Y=U||I,X=U||z,ee=G||f&&Y!==!0;return x5({deleteKeyCode:a,multiSelectionKeyCode:R}),K.createElement(T5,{onMove:l,onMoveStart:c,onMoveEnd:d,onPaneContextMenu:s,elementsSelectable:T,zoomOnScroll:k,zoomOnPinch:O,panOnScroll:X,panOnScrollSpeed:S,panOnScrollMode:b,zoomOnDoubleClick:w,panOnDrag:!G&&Y,defaultViewport:C,translateExtent:N,minZoom:A,maxZoom:P,zoomActivationKeyCode:v,preventScrolling:F,noWheelClassName:$,noPanClassName:j},K.createElement(NT,{onSelectionStart:E,onSelectionEnd:x,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:Y,isSelecting:!!ee,selectionMode:m},t,B&&K.createElement(V5,{onSelectionContextMenu:M,noPanClassName:j,disableKeyboardA11y:L})))};MT.displayName="FlowRenderer";var z5=D.memo(MT);function M5(t){return Ke(D.useCallback(n=>t?dT(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[t]))}function L5(t){const e={input:Ul(t.input||wT),default:Ul(t.default||dg),output:Ul(t.output||bT),group:Ul(t.group||iy)},n={},r=Object.keys(t).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=Ul(t[s]||dg),i),n);return{...e,...r}}const j5=({x:t,y:e,width:n,height:r,origin:i})=>!n||!r?{x:t,y:e}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:t,y:e}:{x:t-n*i[0],y:e-r*i[1]},F5=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions,onError:t.onError}),LT=t=>{const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Ke(F5,Lt),a=M5(t.onlyRenderVisibleElements),l=D.useRef(),c=D.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(h=>{const f=h.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));s(f)});return l.current=d,d},[]);return D.useEffect(()=>()=>{var d;(d=l==null?void 0:l.current)==null||d.disconnect()},[]),K.createElement("div",{className:"react-flow__nodes",style:sy},a.map(d=>{var O,z,S;let h=d.type||"default";t.nodeTypes[h]||(o==null||o("003",mi.error003(h)),h="default");const f=t.nodeTypes[h]||t.nodeTypes.default,m=!!(d.draggable||e&&typeof d.draggable>"u"),E=!!(d.selectable||i&&typeof d.selectable>"u"),x=!!(d.connectable||n&&typeof d.connectable>"u"),R=!!(d.focusable||r&&typeof d.focusable>"u"),y=t.nodeExtent?X0(d.positionAbsolute,t.nodeExtent):d.positionAbsolute,v=(y==null?void 0:y.x)??0,T=(y==null?void 0:y.y)??0,k=j5({x:v,y:T,width:d.width??0,height:d.height??0,origin:t.nodeOrigin});return K.createElement(f,{key:d.id,id:d.id,className:d.className,style:d.style,type:h,data:d.data,sourcePosition:d.sourcePosition||le.Bottom,targetPosition:d.targetPosition||le.Top,hidden:d.hidden,xPos:v,yPos:T,xPosOrigin:k.x,yPosOrigin:k.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!d.selected,isDraggable:m,isSelectable:E,isConnectable:x,isFocusable:R,resizeObserver:c,dragHandle:d.dragHandle,zIndex:((O=d[ht])==null?void 0:O.z)??0,isParent:!!((z=d[ht])!=null&&z.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!d.width&&!!d.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((S=d[ht])!=null&&S.handleBounds)})}))};LT.displayName="NodeRenderer";var $5=D.memo(LT);const U5=(t,e,n)=>n===le.Left?t-e:n===le.Right?t+e:t,B5=(t,e,n)=>n===le.Top?t-e:n===le.Bottom?t+e:t,qw="react-flow__edgeupdater",Hw=({position:t,centerX:e,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a})=>K.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:jt([qw,`${qw}-${a}`]),cx:U5(e,r,t),cy:B5(n,r,t),r,stroke:"transparent",fill:"transparent"}),q5=()=>!0;var Bo=t=>{const e=({id:n,className:r,type:i,data:s,onClick:o,onEdgeDoubleClick:a,selected:l,animated:c,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:m,labelBgPadding:E,labelBgBorderRadius:x,style:R,source:y,target:v,sourceX:T,sourceY:k,targetX:O,targetY:z,sourcePosition:S,targetPosition:b,elementsSelectable:w,hidden:I,sourceHandleId:C,targetHandleId:N,onContextMenu:A,onMouseEnter:P,onMouseMove:F,onMouseLeave:M,reconnectRadius:$,onReconnect:j,onReconnectStart:L,onReconnectEnd:B,markerEnd:G,markerStart:U,rfId:Y,ariaLabel:X,isFocusable:ee,isReconnectable:oe,pathOptions:fe,interactionWidth:ue,disableKeyboardA11y:_e})=>{const we=D.useRef(null),[Ce,Be]=D.useState(!1),[Pe,Qe]=D.useState(!1),ge=wt(),ft=D.useMemo(()=>`url('#${cg(U,Y)}')`,[U,Y]),Ae=D.useMemo(()=>`url('#${cg(G,Y)}')`,[G,Y]);if(I)return null;const se=Fe=>{var cn;const{edges:yt,addSelectedEdges:Tn,unselectNodesAndEdges:Sn,multiSelectionActive:Cn}=ge.getState(),An=yt.find(ir=>ir.id===n);An&&(w&&(ge.setState({nodesSelectionActive:!1}),An.selected&&Cn?(Sn({nodes:[],edges:[An]}),(cn=we.current)==null||cn.blur()):Tn([n])),o&&o(Fe,An))},ke=Fl(n,ge.getState,a),kt=Fl(n,ge.getState,A),Rt=Fl(n,ge.getState,P),ln=Fl(n,ge.getState,F),nt=Fl(n,ge.getState,M),xt=(Fe,yt)=>{if(Fe.button!==0)return;const{edges:Tn,isValidConnection:Sn}=ge.getState(),Cn=yt?v:y,An=(yt?N:C)||null,cn=yt?"target":"source",ir=Sn||q5,Pt=yt,Hn=Tn.find(un=>un.id===n);Qe(!0),L==null||L(Fe,Hn,cn);const sr=un=>{Qe(!1),B==null||B(un,Hn,cn)};gT({event:Fe,handleId:An,nodeId:Cn,onConnect:un=>j==null?void 0:j(Hn,un),isTarget:Pt,getState:ge.getState,setState:ge.setState,isValidConnection:ir,edgeUpdaterType:cn,onReconnectEnd:sr})},bt=Fe=>xt(Fe,!0),Oe=Fe=>xt(Fe,!1),Me=()=>Be(!0),Nt=()=>Be(!1),en=!w&&!o,Ir=Fe=>{var yt;if(!_e&&nT.includes(Fe.key)&&w){const{unselectNodesAndEdges:Tn,addSelectedEdges:Sn,edges:Cn}=ge.getState();Fe.key==="Escape"?((yt=we.current)==null||yt.blur(),Tn({edges:[Cn.find(cn=>cn.id===n)]})):Sn([n])}};return K.createElement("g",{className:jt(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:l,animated:c,inactive:en,updating:Ce}]),onClick:se,onDoubleClick:ke,onContextMenu:kt,onMouseEnter:Rt,onMouseMove:ln,onMouseLeave:nt,onKeyDown:ee?Ir:void 0,tabIndex:ee?0:void 0,role:ee?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":X===null?void 0:X||`Edge from ${y} to ${v}`,"aria-describedby":ee?`${TT}-${Y}`:void 0,ref:we},!Pe&&K.createElement(t,{id:n,source:y,target:v,selected:l,animated:c,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:m,labelBgPadding:E,labelBgBorderRadius:x,data:s,style:R,sourceX:T,sourceY:k,targetX:O,targetY:z,sourcePosition:S,targetPosition:b,sourceHandleId:C,targetHandleId:N,markerStart:ft,markerEnd:Ae,pathOptions:fe,interactionWidth:ue}),oe&&K.createElement(K.Fragment,null,(oe==="source"||oe===!0)&&K.createElement(Hw,{position:S,centerX:T,centerY:k,radius:$,onMouseDown:bt,onMouseEnter:Me,onMouseOut:Nt,type:"source"}),(oe==="target"||oe===!0)&&K.createElement(Hw,{position:b,centerX:O,centerY:z,radius:$,onMouseDown:Oe,onMouseEnter:Me,onMouseOut:Nt,type:"target"})))};return e.displayName="EdgeWrapper",D.memo(e)};function H5(t){const e={default:Bo(t.default||Rh),straight:Bo(t.bezier||ey),step:Bo(t.step||Z0),smoothstep:Bo(t.step||Tf),simplebezier:Bo(t.simplebezier||J0)},n={},r=Object.keys(t).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Bo(t[s]||Rh),i),n);return{...e,...r}}function Kw(t,e,n=null){const r=((n==null?void 0:n.x)||0)+e.x,i=((n==null?void 0:n.y)||0)+e.y,s=(n==null?void 0:n.width)||e.width,o=(n==null?void 0:n.height)||e.height;switch(t){case le.Top:return{x:r+s/2,y:i};case le.Right:return{x:r+s,y:i+o/2};case le.Bottom:return{x:r+s/2,y:i+o};case le.Left:return{x:r,y:i+o/2}}}function Gw(t,e){return t?t.length===1||!e?t[0]:e&&t.find(n=>n.id===e)||null:null}const K5=(t,e,n,r,i,s)=>{const o=Kw(n,t,e),a=Kw(s,r,i);return{sourceX:o.x,sourceY:o.y,targetX:a.x,targetY:a.y}};function G5({sourcePos:t,targetPos:e,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:s,width:o,height:a,transform:l}){const c={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x+n,e.x+i),y2:Math.max(t.y+r,e.y+s)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=Wc({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:o/l[2],height:a/l[2]}),h=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),f=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(h*f)>0}function Ww(t){var r,i,s,o,a;const e=((r=t==null?void 0:t[ht])==null?void 0:r.handleBounds)||null,n=e&&(t==null?void 0:t.width)&&(t==null?void 0:t.height)&&typeof((i=t==null?void 0:t.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=t==null?void 0:t.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=t==null?void 0:t.positionAbsolute)==null?void 0:o.x)||0,y:((a=t==null?void 0:t.positionAbsolute)==null?void 0:a.y)||0,width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0},e,!!n]}const W5=[{level:0,isMaxLevel:!0,edges:[]}];function Q5(t,e,n=!1){let r=-1;const i=t.reduce((o,a)=>{var d,h;const l=Xn(a.zIndex);let c=l?a.zIndex:0;if(n){const f=e.get(a.target),m=e.get(a.source),E=a.selected||(f==null?void 0:f.selected)||(m==null?void 0:m.selected),x=Math.max(((d=m==null?void 0:m[ht])==null?void 0:d.z)||0,((h=f==null?void 0:f[ht])==null?void 0:h.z)||0,1e3);c=(l?a.zIndex:0)+(E?x:0)}return o[c]?o[c].push(a):o[c]=[a],r=c>r?c:r,o},{}),s=Object.entries(i).map(([o,a])=>{const l=+o;return{edges:a,level:l,isMaxLevel:l===r}});return s.length===0?W5:s}function Y5(t,e,n){const r=Ke(D.useCallback(i=>t?i.edges.filter(s=>{const o=e.get(s.source),a=e.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&G5({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:a.width,targetHeight:a.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[t,e]));return Q5(r,e,n)}const X5=({color:t="none",strokeWidth:e=1})=>K.createElement("polyline",{style:{stroke:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),J5=({color:t="none",strokeWidth:e=1})=>K.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Qw={[kh.Arrow]:X5,[kh.ArrowClosed]:J5};function Z5(t){const e=wt();return D.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Qw,t)?Qw[t]:((s=(i=e.getState()).onError)==null||s.call(i,"009",mi.error009(t)),null)},[t])}const eO=({id:t,type:e,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const l=Z5(e);return l?K.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0"},K.createElement(l,{color:n,strokeWidth:o})):null},tO=({defaultColor:t,rfId:e})=>n=>{const r=[];return n.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const a=cg(o,e);r.includes(a)||(i.push({id:a,color:o.color||t,...o}),r.push(a))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},jT=({defaultColor:t,rfId:e})=>{const n=Ke(D.useCallback(tO({defaultColor:t,rfId:e}),[t,e]),(r,i)=>!(r.length!==i.length||r.some((s,o)=>s.id!==i[o].id)));return K.createElement("defs",null,n.map(r=>K.createElement(eO,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};jT.displayName="MarkerDefinitions";var nO=D.memo(jT);const rO=t=>({nodesConnectable:t.nodesConnectable,edgesFocusable:t.edgesFocusable,edgesUpdatable:t.edgesUpdatable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals,onError:t.onError}),FT=({defaultMarkerColor:t,onlyRenderVisibleElements:e,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,onEdgeDoubleClick:h,onReconnect:f,onReconnectStart:m,onReconnectEnd:E,reconnectRadius:x,children:R,disableKeyboardA11y:y})=>{const{edgesFocusable:v,edgesUpdatable:T,elementsSelectable:k,width:O,height:z,connectionMode:S,nodeInternals:b,onError:w}=Ke(rO,Lt),I=Y5(e,b,n);return O?K.createElement(K.Fragment,null,I.map(({level:C,edges:N,isMaxLevel:A})=>K.createElement("svg",{key:C,style:{zIndex:C},width:O,height:z,className:"react-flow__edges react-flow__container"},A&&K.createElement(nO,{defaultColor:t,rfId:r}),K.createElement("g",null,N.map(P=>{const[F,M,$]=Ww(b.get(P.source)),[j,L,B]=Ww(b.get(P.target));if(!$||!B)return null;let G=P.type||"default";i[G]||(w==null||w("011",mi.error011(G)),G="default");const U=i[G]||i.default,Y=S===ro.Strict?L.target:(L.target??[]).concat(L.source??[]),X=Gw(M.source,P.sourceHandle),ee=Gw(Y,P.targetHandle),oe=(X==null?void 0:X.position)||le.Bottom,fe=(ee==null?void 0:ee.position)||le.Top,ue=!!(P.focusable||v&&typeof P.focusable>"u"),_e=P.reconnectable||P.updatable,we=typeof f<"u"&&(_e||T&&typeof _e>"u");if(!X||!ee)return w==null||w("008",mi.error008(X,P)),null;const{sourceX:Ce,sourceY:Be,targetX:Pe,targetY:Qe}=K5(F,X,oe,j,ee,fe);return K.createElement(U,{key:P.id,id:P.id,className:jt([P.className,s]),type:G,data:P.data,selected:!!P.selected,animated:!!P.animated,hidden:!!P.hidden,label:P.label,labelStyle:P.labelStyle,labelShowBg:P.labelShowBg,labelBgStyle:P.labelBgStyle,labelBgPadding:P.labelBgPadding,labelBgBorderRadius:P.labelBgBorderRadius,style:P.style,source:P.source,target:P.target,sourceHandleId:P.sourceHandle,targetHandleId:P.targetHandle,markerEnd:P.markerEnd,markerStart:P.markerStart,sourceX:Ce,sourceY:Be,targetX:Pe,targetY:Qe,sourcePosition:oe,targetPosition:fe,elementsSelectable:k,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,onEdgeDoubleClick:h,onReconnect:f,onReconnectStart:m,onReconnectEnd:E,reconnectRadius:x,rfId:r,ariaLabel:P.ariaLabel,isFocusable:ue,isReconnectable:we,pathOptions:"pathOptions"in P?P.pathOptions:void 0,interactionWidth:P.interactionWidth,disableKeyboardA11y:y})})))),R):null};FT.displayName="EdgeRenderer";var iO=D.memo(FT);const sO=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function oO({children:t}){const e=Ke(sO);return K.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:e}},t)}function aO(t){const e=Ur(),n=D.useRef(!1);D.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const lO={[le.Left]:le.Right,[le.Right]:le.Left,[le.Top]:le.Bottom,[le.Bottom]:le.Top},$T=({nodeId:t,handleType:e,style:n,type:r=ji.Bezier,CustomComponent:i,connectionStatus:s})=>{var z,S,b;const{fromNode:o,handleId:a,toX:l,toY:c,connectionMode:d}=Ke(D.useCallback(w=>({fromNode:w.nodeInternals.get(t),handleId:w.connectionHandleId,toX:(w.connectionPosition.x-w.transform[0])/w.transform[2],toY:(w.connectionPosition.y-w.transform[1])/w.transform[2],connectionMode:w.connectionMode}),[t]),Lt),h=(z=o==null?void 0:o[ht])==null?void 0:z.handleBounds;let f=h==null?void 0:h[e];if(d===ro.Loose&&(f=f||(h==null?void 0:h[e==="source"?"target":"source"])),!o||!f)return null;const m=a?f.find(w=>w.id===a):f[0],E=m?m.x+m.width/2:(o.width??0)/2,x=m?m.y+m.height/2:o.height??0,R=(((S=o.positionAbsolute)==null?void 0:S.x)??0)+E,y=(((b=o.positionAbsolute)==null?void 0:b.y)??0)+x,v=m==null?void 0:m.position,T=v?lO[v]:null;if(!v||!T)return null;if(i)return K.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:m,fromX:R,fromY:y,toX:l,toY:c,fromPosition:v,toPosition:T,connectionStatus:s});let k="";const O={sourceX:R,sourceY:y,sourcePosition:v,targetX:l,targetY:c,targetPosition:T};return r===ji.Bezier?[k]=ty(O):r===ji.Step?[k]=Yc({...O,borderRadius:0}):r===ji.SmoothStep?[k]=Yc(O):r===ji.SimpleBezier?[k]=oT(O):k=`M${R},${y} ${l},${c}`,K.createElement("path",{d:k,fill:"none",className:"react-flow__connection-path",style:n})};$T.displayName="ConnectionLine";const cO=t=>({nodeId:t.connectionNodeId,handleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,connectionStatus:t.connectionStatus,width:t.width,height:t.height});function uO({containerStyle:t,style:e,type:n,component:r}){const{nodeId:i,handleType:s,nodesConnectable:o,width:a,height:l,connectionStatus:c}=Ke(cO,Lt);return!(i&&s&&a&&o)?null:K.createElement("svg",{style:t,width:a,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},K.createElement("g",{className:jt(["react-flow__connection",c])},K.createElement($T,{nodeId:i,handleType:s,style:e,type:n,CustomComponent:r,connectionStatus:c})))}function Yw(t,e){return D.useRef(null),wt(),D.useMemo(()=>e(t),[t])}const UT=({nodeTypes:t,edgeTypes:e,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:m,onSelectionContextMenu:E,onSelectionStart:x,onSelectionEnd:R,connectionLineType:y,connectionLineStyle:v,connectionLineComponent:T,connectionLineContainerStyle:k,selectionKeyCode:O,selectionOnDrag:z,selectionMode:S,multiSelectionKeyCode:b,panActivationKeyCode:w,zoomActivationKeyCode:I,deleteKeyCode:C,onlyRenderVisibleElements:N,elementsSelectable:A,selectNodesOnDrag:P,defaultViewport:F,translateExtent:M,minZoom:$,maxZoom:j,preventScrolling:L,defaultMarkerColor:B,zoomOnScroll:G,zoomOnPinch:U,panOnScroll:Y,panOnScrollSpeed:X,panOnScrollMode:ee,zoomOnDoubleClick:oe,panOnDrag:fe,onPaneClick:ue,onPaneMouseEnter:_e,onPaneMouseMove:we,onPaneMouseLeave:Ce,onPaneScroll:Be,onPaneContextMenu:Pe,onEdgeContextMenu:Qe,onEdgeMouseEnter:ge,onEdgeMouseMove:ft,onEdgeMouseLeave:Ae,onReconnect:se,onReconnectStart:ke,onReconnectEnd:kt,reconnectRadius:Rt,noDragClassName:ln,noWheelClassName:nt,noPanClassName:xt,elevateEdgesOnSelect:bt,disableKeyboardA11y:Oe,nodeOrigin:Me,nodeExtent:Nt,rfId:en})=>{const Ir=Yw(t,L5),Fe=Yw(e,H5);return aO(s),K.createElement(z5,{onPaneClick:ue,onPaneMouseEnter:_e,onPaneMouseMove:we,onPaneMouseLeave:Ce,onPaneContextMenu:Pe,onPaneScroll:Be,deleteKeyCode:C,selectionKeyCode:O,selectionOnDrag:z,selectionMode:S,onSelectionStart:x,onSelectionEnd:R,multiSelectionKeyCode:b,panActivationKeyCode:w,zoomActivationKeyCode:I,elementsSelectable:A,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:G,zoomOnPinch:U,zoomOnDoubleClick:oe,panOnScroll:Y,panOnScrollSpeed:X,panOnScrollMode:ee,panOnDrag:fe,defaultViewport:F,translateExtent:M,minZoom:$,maxZoom:j,onSelectionContextMenu:E,preventScrolling:L,noDragClassName:ln,noWheelClassName:nt,noPanClassName:xt,disableKeyboardA11y:Oe},K.createElement(oO,null,K.createElement(iO,{edgeTypes:Fe,onEdgeClick:a,onEdgeDoubleClick:c,onlyRenderVisibleElements:N,onEdgeContextMenu:Qe,onEdgeMouseEnter:ge,onEdgeMouseMove:ft,onEdgeMouseLeave:Ae,onReconnect:se,onReconnectStart:ke,onReconnectEnd:kt,reconnectRadius:Rt,defaultMarkerColor:B,noPanClassName:xt,elevateEdgesOnSelect:!!bt,disableKeyboardA11y:Oe,rfId:en},K.createElement(uO,{style:v,type:y,component:T,containerStyle:k})),K.createElement("div",{className:"react-flow__edgelabel-renderer"}),K.createElement($5,{nodeTypes:Ir,onNodeClick:o,onNodeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:m,selectNodesOnDrag:P,onlyRenderVisibleElements:N,noPanClassName:xt,noDragClassName:ln,disableKeyboardA11y:Oe,nodeOrigin:Me,nodeExtent:Nt,rfId:en})))};UT.displayName="GraphView";var dO=D.memo(UT);const fg=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ki={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:fg,nodeExtent:fg,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ro.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:B4,isValidConnection:void 0},hO=()=>sP((t,e)=>({...ki,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:s}=e();t({nodeInternals:Vp(n,r,i,s)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=e();t({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",s=typeof r<"u",o=i?Vp(n,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map;t({nodeInternals:o,edges:s?r:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:a,domNode:l,nodeOrigin:c}=e(),d=l==null?void 0:l.querySelector(".react-flow__viewport");if(!d)return;const h=window.getComputedStyle(d),{m22:f}=new window.DOMMatrixReadOnly(h.transform),m=n.reduce((x,R)=>{const y=i.get(R.id);if(y!=null&&y.hidden)i.set(y.id,{...y,[ht]:{...y[ht],handleBounds:void 0}});else if(y){const v=Y0(R.nodeElement);!!(v.width&&v.height&&(y.width!==v.width||y.height!==v.height||R.forceUpdate))&&(i.set(y.id,{...y,[ht]:{...y[ht],handleBounds:{source:Bw(".source",R.nodeElement,f,c),target:Bw(".target",R.nodeElement,f,c)}},...v}),x.push({id:y.id,type:"dimensions",dimensions:v}))}return x},[]);CT(i,c);const E=o||s&&!o&&AT(e,{initial:!0,...a});t({nodeInternals:new Map(i),fitViewOnInitDone:E}),(m==null?void 0:m.length)>0&&(r==null||r(m))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:s}=e(),o=n.map(a=>{const l={id:a.id,type:"position",dragging:i};return r&&(l.positionAbsolute=a.positionAbsolute,l.position=a.position),l});s(o)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:a,elevateNodesOnSelect:l}=e();if(n!=null&&n.length){if(s){const c=RT(n,a()),d=Vp(c,i,o,l);t({nodeInternals:d})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=e();let o,a=null;r?o=n.map(l=>zi(l,!0)):(o=pa(s(),n),a=pa(i,[])),ud({changedNodes:o,changedEdges:a,get:e,set:t})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=e();let o,a=null;r?o=n.map(l=>zi(l,!0)):(o=pa(i,n),a=pa(s(),[])),ud({changedNodes:a,changedEdges:o,get:e,set:t})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:s}=e(),o=n||s(),a=r||i,l=o.map(d=>(d.selected=!1,zi(d.id,!1))),c=a.map(d=>zi(d.id,!1));ud({changedNodes:l,changedEdges:c,get:e,set:t})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=e();r==null||r.scaleExtent([n,i]),t({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=e();r==null||r.scaleExtent([i,n]),t({maxZoom:n})},setTranslateExtent:n=>{var r;(r=e().d3Zoom)==null||r.translateExtent(n),t({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=e(),s=r().filter(a=>a.selected).map(a=>zi(a.id,!1)),o=n.filter(a=>a.selected).map(a=>zi(a.id,!1));ud({changedNodes:s,changedEdges:o,get:e,set:t})},setNodeExtent:n=>{const{nodeInternals:r}=e();r.forEach(i=>{i.positionAbsolute=X0(i.position,n)}),t({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:s,d3Zoom:o,d3Selection:a,translateExtent:l}=e();if(!o||!a||!n.x&&!n.y)return!1;const c=li.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),d=[[0,0],[i,s]],h=o==null?void 0:o.constrain()(c,d,l);return o.transform(a,h),r[0]!==h.x||r[1]!==h.y||r[2]!==h.k},cancelConnection:()=>t({connectionNodeId:ki.connectionNodeId,connectionHandleId:ki.connectionHandleId,connectionHandleType:ki.connectionHandleType,connectionStatus:ki.connectionStatus,connectionStartHandle:ki.connectionStartHandle,connectionEndHandle:ki.connectionEndHandle}),reset:()=>t({...ki})}),Object.is),oy=({children:t})=>{const e=D.useRef(null);return e.current||(e.current=hO()),K.createElement(z4,{value:e.current},t)};oy.displayName="ReactFlowProvider";const BT=({children:t})=>D.useContext(If)?K.createElement(K.Fragment,null,t):K.createElement(oy,null,t);BT.displayName="ReactFlowWrapper";const fO={input:wT,default:dg,output:bT,group:iy},pO={default:Rh,straight:ey,step:Z0,smoothstep:Tf,simplebezier:J0},mO=[0,0],gO=[15,15],yO={x:0,y:0,zoom:1},vO={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},qT=D.forwardRef(({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s=fO,edgeTypes:o=pO,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:h,onMoveEnd:f,onConnect:m,onConnectStart:E,onConnectEnd:x,onClickConnectStart:R,onClickConnectEnd:y,onNodeMouseEnter:v,onNodeMouseMove:T,onNodeMouseLeave:k,onNodeContextMenu:O,onNodeDoubleClick:z,onNodeDragStart:S,onNodeDrag:b,onNodeDragStop:w,onNodesDelete:I,onEdgesDelete:C,onSelectionChange:N,onSelectionDragStart:A,onSelectionDrag:P,onSelectionDragStop:F,onSelectionContextMenu:M,onSelectionStart:$,onSelectionEnd:j,connectionMode:L=ro.Strict,connectionLineType:B=ji.Bezier,connectionLineStyle:G,connectionLineComponent:U,connectionLineContainerStyle:Y,deleteKeyCode:X="Backspace",selectionKeyCode:ee="Shift",selectionOnDrag:oe=!1,selectionMode:fe=Qc.Full,panActivationKeyCode:ue="Space",multiSelectionKeyCode:_e=Ah()?"Meta":"Control",zoomActivationKeyCode:we=Ah()?"Meta":"Control",snapToGrid:Ce=!1,snapGrid:Be=gO,onlyRenderVisibleElements:Pe=!1,selectNodesOnDrag:Qe=!0,nodesDraggable:ge,nodesConnectable:ft,nodesFocusable:Ae,nodeOrigin:se=mO,edgesFocusable:ke,edgesUpdatable:kt,elementsSelectable:Rt,defaultViewport:ln=yO,minZoom:nt=.5,maxZoom:xt=2,translateExtent:bt=fg,preventScrolling:Oe=!0,nodeExtent:Me,defaultMarkerColor:Nt="#b1b1b7",zoomOnScroll:en=!0,zoomOnPinch:Ir=!0,panOnScroll:Fe=!1,panOnScrollSpeed:yt=.5,panOnScrollMode:Tn=Us.Free,zoomOnDoubleClick:Sn=!0,panOnDrag:Cn=!0,onPaneClick:An,onPaneMouseEnter:cn,onPaneMouseMove:ir,onPaneMouseLeave:Pt,onPaneScroll:Hn,onPaneContextMenu:sr,children:Ye,onEdgeContextMenu:un,onEdgeDoubleClick:or,onEdgeMouseEnter:bo,onEdgeMouseMove:bi,onEdgeMouseLeave:Eo,onEdgeUpdate:qr,onEdgeUpdateStart:Io,onEdgeUpdateEnd:Et,onReconnect:To,onReconnectStart:Kn,onReconnectEnd:Tr,reconnectRadius:gl=10,edgeUpdaterRadius:yl=10,onNodesChange:Sr,onEdgesChange:So,noDragClassName:vl="nodrag",noWheelClassName:Ei="nowheel",noPanClassName:bs="nopan",fitView:Es=!1,fitViewOptions:kn,connectOnClick:Gn=!0,attributionPosition:Co,proOptions:Ao,defaultEdgeOptions:Is,elevateNodesOnSelect:Ts=!0,elevateEdgesOnSelect:ko=!1,disableKeyboardA11y:Ss=!1,autoPanOnConnect:_l=!0,autoPanOnNodeDrag:Ii=!0,connectionRadius:Ro=20,isValidConnection:Ti,onError:Hr,style:ar,id:Cr,nodeDragThreshold:No,...Po},Do)=>{const Ar=Cr||"1";return K.createElement("div",{...Po,style:{...ar,...vO},ref:Do,className:jt(["react-flow",i]),"data-testid":"rf__wrapper",id:Cr},K.createElement(BT,null,K.createElement(dO,{onInit:c,onMove:d,onMoveStart:h,onMoveEnd:f,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:v,onNodeMouseMove:T,onNodeMouseLeave:k,onNodeContextMenu:O,onNodeDoubleClick:z,nodeTypes:s,edgeTypes:o,connectionLineType:B,connectionLineStyle:G,connectionLineComponent:U,connectionLineContainerStyle:Y,selectionKeyCode:ee,selectionOnDrag:oe,selectionMode:fe,deleteKeyCode:X,multiSelectionKeyCode:_e,panActivationKeyCode:ue,zoomActivationKeyCode:we,onlyRenderVisibleElements:Pe,selectNodesOnDrag:Qe,defaultViewport:ln,translateExtent:bt,minZoom:nt,maxZoom:xt,preventScrolling:Oe,zoomOnScroll:en,zoomOnPinch:Ir,zoomOnDoubleClick:Sn,panOnScroll:Fe,panOnScrollSpeed:yt,panOnScrollMode:Tn,panOnDrag:Cn,onPaneClick:An,onPaneMouseEnter:cn,onPaneMouseMove:ir,onPaneMouseLeave:Pt,onPaneScroll:Hn,onPaneContextMenu:sr,onSelectionContextMenu:M,onSelectionStart:$,onSelectionEnd:j,onEdgeContextMenu:un,onEdgeDoubleClick:or,onEdgeMouseEnter:bo,onEdgeMouseMove:bi,onEdgeMouseLeave:Eo,onReconnect:To??qr,onReconnectStart:Kn??Io,onReconnectEnd:Tr??Et,reconnectRadius:gl??yl,defaultMarkerColor:Nt,noDragClassName:vl,noWheelClassName:Ei,noPanClassName:bs,elevateEdgesOnSelect:ko,rfId:Ar,disableKeyboardA11y:Ss,nodeOrigin:se,nodeExtent:Me}),K.createElement(c5,{nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:E,onConnectEnd:x,onClickConnectStart:R,onClickConnectEnd:y,nodesDraggable:ge,nodesConnectable:ft,nodesFocusable:Ae,edgesFocusable:ke,edgesUpdatable:kt,elementsSelectable:Rt,elevateNodesOnSelect:Ts,minZoom:nt,maxZoom:xt,nodeExtent:Me,onNodesChange:Sr,onEdgesChange:So,snapToGrid:Ce,snapGrid:Be,connectionMode:L,translateExtent:bt,connectOnClick:Gn,defaultEdgeOptions:Is,fitView:Es,fitViewOptions:kn,onNodesDelete:I,onEdgesDelete:C,onNodeDragStart:S,onNodeDrag:b,onNodeDragStop:w,onSelectionDrag:P,onSelectionDragStart:A,onSelectionDragStop:F,noPanClassName:bs,nodeOrigin:se,rfId:Ar,autoPanOnConnect:_l,autoPanOnNodeDrag:Ii,onError:Hr,connectionRadius:Ro,isValidConnection:Ti,nodeDragThreshold:No}),K.createElement(a5,{onSelectionChange:N}),Ye,K.createElement(L4,{proOptions:Ao,position:Co}),K.createElement(p5,{rfId:Ar,disableKeyboardA11y:Ss})))});qT.displayName="ReactFlow";const _O=t=>{var e;return(e=t.domNode)==null?void 0:e.querySelector(".react-flow__edgelabel-renderer")};function wO({children:t}){const e=Ke(_O);return e?Uc.createPortal(t,e):null}function HT(t){return e=>{const[n,r]=D.useState(e),i=D.useCallback(s=>r(o=>t(s,o)),[]);return[n,r,i]}}const xO=HT(RT),bO=HT(A5),KT=({id:t,x:e,y:n,width:r,height:i,style:s,color:o,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:h,onClick:f,selected:m})=>{const{background:E,backgroundColor:x}=s||{},R=o||E||x;return K.createElement("rect",{className:jt(["react-flow__minimap-node",{selected:m},c]),x:e,y:n,rx:d,ry:d,width:r,height:i,fill:R,stroke:a,strokeWidth:l,shapeRendering:h,onClick:f?y=>f(y,t):void 0})};KT.displayName="MiniMapNode";var EO=D.memo(KT);const IO=t=>t.nodeOrigin,TO=t=>t.getNodes().filter(e=>!e.hidden&&e.width&&e.height),Lp=t=>t instanceof Function?t:()=>t;function SO({nodeStrokeColor:t="transparent",nodeColor:e="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i=2,nodeComponent:s=EO,onClick:o}){const a=Ke(TO,Lt),l=Ke(IO),c=Lp(e),d=Lp(t),h=Lp(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return K.createElement(K.Fragment,null,a.map(m=>{const{x:E,y:x}=Ws(m,l).positionAbsolute;return K.createElement(s,{key:m.id,x:E,y:x,width:m.width,height:m.height,style:m.style,selected:m.selected,className:h(m),color:c(m),borderRadius:r,strokeColor:d(m),strokeWidth:i,shapeRendering:f,onClick:o,id:m.id})}))}var CO=D.memo(SO);const AO=200,kO=150,RO=t=>{const e=t.getNodes(),n={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:n,boundingRect:e.length>0?$4(vu(e,t.nodeOrigin),n):n,rfId:t.rfId}},NO="react-flow__minimap-desc";function GT({style:t,className:e,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:a,maskColor:l="rgb(240, 240, 240, 0.6)",maskStrokeColor:c="none",maskStrokeWidth:d=1,position:h="bottom-right",onClick:f,onNodeClick:m,pannable:E=!1,zoomable:x=!1,ariaLabel:R="React Flow mini map",inversePan:y=!1,zoomStep:v=10,offsetScale:T=5}){const k=wt(),O=D.useRef(null),{boundingRect:z,viewBB:S,rfId:b}=Ke(RO,Lt),w=(t==null?void 0:t.width)??AO,I=(t==null?void 0:t.height)??kO,C=z.width/w,N=z.height/I,A=Math.max(C,N),P=A*w,F=A*I,M=T*A,$=z.x-(P-z.width)/2-M,j=z.y-(F-z.height)/2-M,L=P+M*2,B=F+M*2,G=`${NO}-${b}`,U=D.useRef(0);U.current=A,D.useEffect(()=>{if(O.current){const ee=Dn(O.current),oe=_e=>{const{transform:we,d3Selection:Ce,d3Zoom:Be}=k.getState();if(_e.sourceEvent.type!=="wheel"||!Ce||!Be)return;const Pe=-_e.sourceEvent.deltaY*(_e.sourceEvent.deltaMode===1?.05:_e.sourceEvent.deltaMode?1:.002)*v,Qe=we[2]*Math.pow(2,Pe);Be.scaleTo(Ce,Qe)},fe=_e=>{const{transform:we,d3Selection:Ce,d3Zoom:Be,translateExtent:Pe,width:Qe,height:ge}=k.getState();if(_e.sourceEvent.type!=="mousemove"||!Ce||!Be)return;const ft=U.current*Math.max(1,we[2])*(y?-1:1),Ae={x:we[0]-_e.sourceEvent.movementX*ft,y:we[1]-_e.sourceEvent.movementY*ft},se=[[0,0],[Qe,ge]],ke=li.translate(Ae.x,Ae.y).scale(we[2]),kt=Be.constrain()(ke,se,Pe);Be.transform(Ce,kt)},ue=YI().on("zoom",E?fe:null).on("zoom.wheel",x?oe:null);return ee.call(ue),()=>{ee.on("zoom",null)}}},[E,x,y,v]);const Y=f?ee=>{const oe=hr(ee);f(ee,{x:oe[0],y:oe[1]})}:void 0,X=m?(ee,oe)=>{const fe=k.getState().nodeInternals.get(oe);m(ee,fe)}:void 0;return K.createElement(Q0,{position:h,style:t,className:jt(["react-flow__minimap",e]),"data-testid":"rf__minimap"},K.createElement("svg",{width:w,height:I,viewBox:`${$} ${j} ${L} ${B}`,role:"img","aria-labelledby":G,ref:O,onClick:Y},R&&K.createElement("title",{id:G},R),K.createElement(CO,{onClick:X,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:a}),K.createElement("path",{className:"react-flow__minimap-mask",d:`M${$-M},${j-M}h${L+M*2}v${B+M*2}h${-L-M*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fill:l,fillRule:"evenodd",stroke:c,strokeWidth:d,pointerEvents:"none"})))}GT.displayName="MiniMap";var PO=D.memo(GT);function DO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},K.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function VO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},K.createElement("path",{d:"M0 0h32v4.2H0z"}))}function OO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},K.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function zO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},K.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function MO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},K.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const ec=({children:t,className:e,...n})=>K.createElement("button",{type:"button",className:jt(["react-flow__controls-button",e]),...n},t);ec.displayName="ControlButton";const LO=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom}),WT=({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:l,className:c,children:d,position:h="bottom-left"})=>{const f=wt(),[m,E]=D.useState(!1),{isInteractive:x,minZoomReached:R,maxZoomReached:y}=Ke(LO,Lt),{zoomIn:v,zoomOut:T,fitView:k}=Ur();if(D.useEffect(()=>{E(!0)},[]),!m)return null;const O=()=>{v(),s==null||s()},z=()=>{T(),o==null||o()},S=()=>{k(i),a==null||a()},b=()=>{f.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),l==null||l(!x)};return K.createElement(Q0,{className:jt(["react-flow__controls",c]),position:h,style:t,"data-testid":"rf__controls"},e&&K.createElement(K.Fragment,null,K.createElement(ec,{onClick:O,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y},K.createElement(DO,null)),K.createElement(ec,{onClick:z,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:R},K.createElement(VO,null))),n&&K.createElement(ec,{className:"react-flow__controls-fitview",onClick:S,title:"fit view","aria-label":"fit view"},K.createElement(OO,null)),r&&K.createElement(ec,{className:"react-flow__controls-interactive",onClick:b,title:"toggle interactivity","aria-label":"toggle interactivity"},x?K.createElement(MO,null):K.createElement(zO,null)),d)};WT.displayName="Controls";var jO=D.memo(WT),vr;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(vr||(vr={}));function FO({color:t,dimensions:e,lineWidth:n}){return K.createElement("path",{stroke:t,strokeWidth:n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function $O({color:t,radius:e}){return K.createElement("circle",{cx:e,cy:e,r:e,fill:t})}const UO={[vr.Dots]:"#91919a",[vr.Lines]:"#eee",[vr.Cross]:"#e2e2e2"},BO={[vr.Dots]:1,[vr.Lines]:1,[vr.Cross]:6},qO=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function QT({id:t,variant:e=vr.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=2,color:o,style:a,className:l}){const c=D.useRef(null),{transform:d,patternId:h}=Ke(qO,Lt),f=o||UO[e],m=r||BO[e],E=e===vr.Dots,x=e===vr.Cross,R=Array.isArray(n)?n:[n,n],y=[R[0]*d[2]||1,R[1]*d[2]||1],v=m*d[2],T=x?[v,v]:y,k=E?[v/s,v/s]:[T[0]/s,T[1]/s];return K.createElement("svg",{className:jt(["react-flow__background",l]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:c,"data-testid":"rf__background"},K.createElement("pattern",{id:h+t,x:d[0]%y[0],y:d[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${k[0]},-${k[1]})`},E?K.createElement($O,{color:f,radius:v/s}):K.createElement(FO,{dimensions:T,color:f,lineWidth:i})),K.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${h+t})`}))}QT.displayName="Background";var HO=D.memo(QT),Ia;(function(t){t.Line="line",t.Handle="handle"})(Ia||(Ia={}));function KO({width:t,prevWidth:e,height:n,prevHeight:r,invertX:i,invertY:s}){const o=t-e,a=n-r,l=[o>0?1:o<0?-1:0,a>0?1:a<0?-1:0];return o&&i&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}const YT={width:0,height:0,x:0,y:0},GO={...YT,pointerX:0,pointerY:0,aspectRatio:1};function WO({nodeId:t,position:e,variant:n=Ia.Handle,className:r,style:i={},children:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,shouldResize:f,onResizeStart:m,onResize:E,onResizeEnd:x}){const R=lT(),y=typeof t=="string"?t:R,v=wt(),T=D.useRef(null),k=D.useRef(GO),O=D.useRef(YT),z=VT(),S=n===Ia.Line?"right":"bottom-right",b=e??S;D.useEffect(()=>{if(!T.current||!y)return;const N=Dn(T.current),A=b.includes("right")||b.includes("left"),P=b.includes("bottom")||b.includes("top"),F=b.includes("left"),M=b.includes("top"),$=zI().on("start",j=>{const L=v.getState().nodeInternals.get(y),{xSnapped:B,ySnapped:G}=z(j);O.current={width:(L==null?void 0:L.width)??0,height:(L==null?void 0:L.height)??0,x:(L==null?void 0:L.position.x)??0,y:(L==null?void 0:L.position.y)??0},k.current={...O.current,pointerX:B,pointerY:G,aspectRatio:O.current.width/O.current.height},m==null||m(j,{...O.current})}).on("drag",j=>{const{nodeInternals:L,triggerNodeChanges:B}=v.getState(),{xSnapped:G,ySnapped:U}=z(j),Y=L.get(y);if(Y){const X=[],{pointerX:ee,pointerY:oe,width:fe,height:ue,x:_e,y:we,aspectRatio:Ce}=k.current,{x:Be,y:Pe,width:Qe,height:ge}=O.current,ft=Math.floor(A?G-ee:0),Ae=Math.floor(P?U-oe:0);let se=cs(fe+(F?-ft:ft),a,c),ke=cs(ue+(M?-Ae:Ae),l,d);if(h){const bt=se/ke,Oe=A&&P,Me=A&&!P,Nt=P&&!A;se=bt<=Ce&&Oe||Nt?ke*Ce:se,ke=bt>Ce&&Oe||Me?se/Ce:ke,se>=c?(se=c,ke=c/Ce):se<=a&&(se=a,ke=a/Ce),ke>=d?(ke=d,se=d*Ce):ke<=l&&(ke=l,se=l*Ce)}const kt=se!==Qe,Rt=ke!==ge;if(F||M){const bt=F?_e-(se-fe):_e,Oe=M?we-(ke-ue):we,Me=bt!==Be&&kt,Nt=Oe!==Pe&&Rt;if(Me||Nt){const en={id:Y.id,type:"position",position:{x:Me?bt:Be,y:Nt?Oe:Pe}};X.push(en),O.current.x=en.position.x,O.current.y=en.position.y}}if(kt||Rt){const bt={id:y,type:"dimensions",updateStyle:!0,resizing:!0,dimensions:{width:se,height:ke}};X.push(bt),O.current.width=se,O.current.height=ke}if(X.length===0)return;const ln=KO({width:O.current.width,prevWidth:Qe,height:O.current.height,prevHeight:ge,invertX:F,invertY:M}),nt={...O.current,direction:ln};if((f==null?void 0:f(j,nt))===!1)return;E==null||E(j,nt),B(X)}}).on("end",j=>{const L={id:y,type:"dimensions",resizing:!1};x==null||x(j,{...O.current}),v.getState().triggerNodeChanges([L])});return N.call($),()=>{N.on(".drag",null)}},[y,b,a,l,c,d,h,z,m,E,x]);const w=b.split("-"),I=n===Ia.Line?"borderColor":"backgroundColor",C=o?{...i,[I]:o}:i;return K.createElement("div",{className:jt(["react-flow__resize-control","nodrag",...w,n,r]),ref:T,style:C},s)}var Xw=D.memo(WO);const QO=["top-left","top-right","bottom-left","bottom-right"],YO=["top","right","bottom","left"];function sl({nodeId:t,isVisible:e=!0,handleClassName:n,handleStyle:r,lineClassName:i,lineStyle:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,shouldResize:f,onResizeStart:m,onResize:E,onResizeEnd:x}){return e?K.createElement(K.Fragment,null,YO.map(R=>K.createElement(Xw,{key:R,className:i,style:s,nodeId:t,position:R,variant:Ia.Line,color:o,minWidth:a,minHeight:l,maxWidth:c,maxHeight:d,onResizeStart:m,keepAspectRatio:h,shouldResize:f,onResize:E,onResizeEnd:x})),QO.map(R=>K.createElement(Xw,{key:R,className:n,style:r,nodeId:t,position:R,color:o,minWidth:a,minHeight:l,maxWidth:c,maxHeight:d,onResizeStart:m,keepAspectRatio:h,shouldResize:f,onResize:E,onResizeEnd:x}))):null}/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),XT=(...t)=>t.filter((e,n,r)=>!!e&&r.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var JO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=D.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>D.createElement("svg",{ref:l,...JO,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:XT("lucide",i),...a},[...o.map(([c,d])=>D.createElement(c,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=(t,e)=>{const n=D.forwardRef(({className:r,...i},s)=>D.createElement(ZO,{ref:s,iconNode:e,className:XT(`lucide-${XO(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=ie("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=ie("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=ie("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=ie("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=ie("BoxSelect",[["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M21 14v1",key:"169vum"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=ie("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=ie("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=ie("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=ie("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=ie("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=ie("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=ie("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=ie("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=ie("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=ie("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=ie("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=ie("CornerDownRight",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=ie("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=ie("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=ie("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=ie("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=ie("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=ie("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=ie("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=ie("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=ie("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=ie("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=ie("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=ie("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=ie("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=ie("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qr=ie("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=ie("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=ie("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=ie("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=ie("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dy=ie("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=ie("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=ie("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=ie("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=ie("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=ie("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=ie("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jp=ie("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=ie("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=ie("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=ie("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=ie("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=ie("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=ie("PinOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V17h12",key:"13x2n8"}],["path",{d:"M15 9.34V6h1a2 2 0 0 0 0-4H7.89",key:"reo3ki"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=ie("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=ie("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ex=ie("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=ie("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hy=ie("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pz=ie("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=ie("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=ie("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=ie("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=ie("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=ie("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=ie("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=ie("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lS=ie("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=ie("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cS=ie("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uS=ie("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=ie("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=ie("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fy=ie("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=ie("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=ie("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=ie("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $z=ie("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Uz=({connectionColor:t="#dc2626",setConnectionColor:e=()=>{},connectionLineType:n,setConnectionLineType:r,lastSaved:i,onSave:s,onLoad:o,onClear:a,onHelp:l,isDarkMode:c,toggleTheme:d,searchTerm:h,setSearchTerm:f,onExport:m,isOpen:E,onToggle:x,onOpenCaseManager:R,currentBoardName:y,onToggleZen:v,onNextMatch:T,onPrevMatch:k,onToggleBg:O,onLogout:z,currentUser:S,isSyncing:b,syncError:w,onRetry:I,onManualSave:C})=>{const N=D.useRef(null),[A,P]=D.useState(()=>{try{const j=localStorage.getItem("sidebar-sections");return j?JSON.parse(j):{evidence:!0,connection:!0,extras:!0,zones:!0}}catch{return{evidence:!0,connection:!0,extras:!0,zones:!0}}});D.useEffect(()=>{localStorage.setItem("sidebar-sections",JSON.stringify(A))},[A]);const F=j=>{P(L=>({...L,[j]:!L[j]}))},M=()=>{const j=Object.values(A).some(L=>L);P(Object.keys(A).reduce((L,B)=>({...L,[B]:!j}),{}))},$=(j,L,B)=>{j.dataTransfer.setData("application/reactflow",L),j.dataTransfer.setData("application/category",B),j.dataTransfer.effectAllowed="move"};return p.jsxs("div",{className:`fixed top-0 left-0 h-full z-50 transition-transform duration-300 ease-in-out ${E?"translate-x-0":"-translate-x-full"} w-80 resize-x overflow-x-hidden`,children:["      ",p.jsxs("aside",{className:`h-full w-80 border-r flex flex-col shadow-2xl backdrop-blur-xl transition-colors duration-500 ease-in-out ${c?"bg-zinc-900/95 border-zinc-800":"bg-white/90 border-gray-200"}`,children:[p.jsxs("div",{className:`p-3 border-b transition-colors duration-500 ${c?"border-zinc-800":"border-gray-200"}`,children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("div",{children:p.jsxs("h1",{className:"text-lg font-bold text-red-500 tracking-widest uppercase leading-tight",children:["Detective",p.jsx("br",{}),"Board"]})}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:M,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:Object.values(A).some(j=>j)?"Colapsar todo":"Expandir todo",children:Object.values(A).some(j=>j)?p.jsx(az,{size:16}):p.jsx(oz,{size:16})}),p.jsx("button",{onClick:v,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Modo Zen (Pantalla Completa)",children:p.jsx(bz,{size:16})}),p.jsx("button",{onClick:O,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Cambiar Fondo (Corcho/Pizarra/Papel)",children:p.jsx(Sz,{size:16})}),p.jsx("button",{onClick:d,className:`p-2 rounded-full ${c?"bg-zinc-800 text-yellow-400 hover:bg-zinc-700":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Cambiar tema",children:c?p.jsx(lS,{size:16}):p.jsx(iS,{size:16})})]})]}),y&&p.jsxs("div",{className:"mt-2 px-2 py-1 bg-zinc-100/5 rounded border border-zinc-500/20",children:[p.jsx("p",{className:"text-xs text-zinc-500 font-mono uppercase mb-0",children:"Expediente:"}),p.jsx("p",{className:`text-xs font-bold font-mono truncate w-full ${c?"text-yellow-500":"text-yellow-700"}`,title:y,children:y})]})]}),p.jsx("div",{className:"px-3 pt-2 pb-1",children:p.jsxs("div",{className:`flex items-center px-2 py-1.5 rounded border transition-colors duration-500 ${c?"bg-zinc-950 border-zinc-800":"bg-white border-gray-300"}`,children:[p.jsx(sS,{size:12,className:"text-zinc-500 mr-2"}),p.jsx("input",{type:"text",name:"search",placeholder:"Buscar pistas...",value:h,onChange:j=>f(j.target.value),className:`bg-transparent w-full text-xs outline-none font-mono ${c?"text-zinc-300 placeholder-zinc-600":"text-zinc-700 placeholder-zinc-400"}`}),h&&p.jsxs("div",{className:"flex gap-1 ml-1 border-l border-zinc-700 pl-1",children:[p.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),k()},className:"p-0.5 hover:text-white text-zinc-500 transition-colors",title:"Anterior",children:p.jsx(nz,{size:12})}),p.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),T()},className:"p-0.5 hover:text-white text-zinc-500 transition-colors",title:"Siguiente",children:p.jsx(ez,{size:12})})]})]})}),p.jsxs("div",{className:"p-3 space-y-2 overflow-y-auto",children:[p.jsx(hd,{title:"Evidencia",icon:gz,isDarkMode:c,isOpen:A.evidence,onToggle:()=>F("evidence"),children:p.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[p.jsx(Vt,{onDragStart:$,type:"evidence",category:"person",icon:fy,label:"Sospechoso",color:"border-blue-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"evidence",category:"place",icon:nS,label:"Lugar",color:"border-green-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"evidence",category:"clue",icon:ly,label:"Pista",color:"border-yellow-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"evidence",category:"event",icon:JT,label:"Evento",color:"border-red-500",isDarkMode:c,compact:!0})]})}),p.jsxs(hd,{title:"Configuracin de Hilo",icon:pg,isDarkMode:c,isOpen:A.connection,onToggle:()=>F("connection"),children:[p.jsx("div",{className:"flex items-center justify-center gap-3 mb-2 px-1 py-0.5",children:[{color:"#dc2626",label:"Rojo"},{color:"#3b82f6",label:"Azul"},{color:"#22c55e",label:"Verde"},{color:"#eab308",label:"Amarillo"},{color:"#a855f7",label:"Morado"}].map(j=>p.jsx("button",{onClick:()=>e(j.color),className:`w-5 h-5 rounded-full border-2 transition-all ${t===j.color?"border-white scale-100 ring-1 ring-zinc-500":"border-transparent hover:scale-100"}`,style:{backgroundColor:j.color},title:j.label},j.color))}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:()=>r("straight"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="straight"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Recta",children:p.jsx(rS,{size:14})}),p.jsx("button",{onClick:()=>r("default"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="default"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Curva",children:p.jsx(pg,{size:14})}),p.jsx("button",{onClick:()=>r("step"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="step"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Escalonada",children:p.jsx(eS,{size:14})})]})]}),p.jsx(hd,{title:"Extras",icon:wz,isDarkMode:c,isOpen:A.extras,onToggle:()=>F("extras"),children:p.jsxs("div",{className:"grid grid-cols-4 gap-1.5",children:[p.jsx(Vt,{onDragStart:$,type:"note",category:"note",icon:aS,label:"Nota",color:"border-yellow-400",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"text",category:"text",icon:uS,label:"Texto",color:"border-zinc-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"image",category:"image",icon:cy,label:"Imagen",color:"border-purple-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"url",category:"url",icon:uy,label:"URL",color:"border-blue-500",isDarkMode:c,compact:!0})]})}),p.jsx(hd,{title:"Zonas y Sellos",icon:Jw,isDarkMode:c,isOpen:A.zones,onToggle:()=>F("zones"),children:p.jsxs("div",{className:"space-y-2",children:[p.jsx(Vt,{onDragStart:$,type:"zone",category:"zone",icon:Jw,label:"Zona de Grupo",color:"border-zinc-600",isDarkMode:c}),p.jsxs("div",{className:"grid grid-cols-3 gap-1.5 pt-1",children:[p.jsx(Vt,{onDragStart:$,type:"stamp",category:"solved",icon:lz,label:"Resuelto",color:"border-green-600",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"stamp",category:"discarded",icon:cz,label:"Descartado",color:"border-red-600",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"stamp",category:"key",icon:zz,label:"Clave",color:"border-yellow-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"stamp",category:"question",icon:mg,label:"?",color:"border-blue-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"stamp",category:"important",icon:cS,label:"!",color:"border-orange-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"stamp",category:"verify",icon:tS,label:"Ojo",color:"border-purple-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"stamp",category:"danger",icon:oS,label:"Peligro",color:"border-red-600",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"stamp",category:"confidential",icon:ja,label:"Top",color:"border-zinc-500",isDarkMode:c,compact:!0}),p.jsx(Vt,{onDragStart:$,type:"stamp",category:"custom",icon:Cz,label:"Personalizado",color:"border-zinc-400",isDarkMode:c,compact:!0})]})]})})]}),p.jsxs("div",{className:`mt-auto p-3 border-t space-y-2 transition-colors duration-500 ${c?"border-zinc-800":"border-gray-200"}`,children:[p.jsxs("button",{onClick:R,title:"Abrir gestor de expedientes",className:`w-full py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-yellow-900/20 text-yellow-500 border-yellow-900/50 hover:bg-yellow-900/40":"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100"}`,children:[p.jsx(yz,{size:14})," Gestionar Casos"]}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsxs("button",{onClick:s,className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Descargar (JSON)",children:[p.jsx(mz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Descargar"})]}),p.jsxs("button",{onClick:()=>N.current.click(),className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Cargar (JSON)",children:[p.jsx(Lz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Cargar"})]}),p.jsxs("button",{onClick:m,className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Exportar (PNG)",children:[p.jsx(fz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"PNG"})]})]}),p.jsx("input",{type:"file",name:"file-upload",ref:N,onChange:o,className:"hidden",accept:".json"}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsxs("button",{onClick:C,title:"Guardar cambios en la nube ahora",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,children:[p.jsx(Vz,{size:14})," Guardar"]}),p.jsxs("button",{onClick:a,title:"Borrar todo el contenido",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-red-900/20 text-red-500 border-red-900/50 hover:bg-red-900/40":"bg-red-50 text-red-600 border-red-200 hover:bg-red-100"}`,children:[p.jsx(gg,{size:14})," Limpiar"]}),p.jsxs("button",{onClick:l,title:"Ver atajos de teclado",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,children:[p.jsx(mg,{size:14})," Ayuda"]})]}),i&&p.jsxs("div",{className:`text-[10px] text-center mt-2 font-mono ${c?"text-zinc-600":"text-gray-400"}`,children:["Guardado: ",i.toLocaleTimeString()]}),p.jsxs("button",{onClick:z,className:`w-full py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 mt-2 ${c?"bg-red-950/50 text-red-500 border-red-900/30 hover:bg-red-900/40":"bg-red-50 text-red-600 border-red-200 hover:bg-red-100"}`,children:[p.jsx(xz,{size:14})," Cerrar Sesin"]})]})]}),p.jsx("button",{onClick:x,className:`absolute top-6 -right-8 p-1.5 rounded-r-md shadow-md border-y border-r cursor-pointer flex items-center justify-center transition-colors duration-500 ${c?"bg-zinc-900 border-zinc-800 text-zinc-400 hover:text-white":"bg-white border-gray-200 text-zinc-600 hover:text-black"} `,title:E?"Ocultar barra lateral":"Mostrar barra lateral",children:E?p.jsx(iz,{size:16}):p.jsx(sz,{size:16})})]})},hd=({title:t,icon:e,isDarkMode:n,children:r,isOpen:i,onToggle:s})=>p.jsxs("div",{className:`p-2 rounded-lg border transition-all duration-200 ${n?"bg-zinc-950/50 border-zinc-800":"bg-white border-gray-200 shadow-sm"}`,children:[p.jsxs("button",{onClick:s,className:`w-full text-xs font-bold uppercase flex items-center justify-between gap-2 ${n?"text-zinc-500 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(e,{size:10})," ",t]}),p.jsx("div",{className:`transition-transform duration-300 ${i?"rotate-0":"-rotate-90"}`,children:p.jsx(rz,{size:12})})]}),p.jsx("div",{className:`grid transition-all duration-300 ease-in-out ${i?"grid-rows-[1fr] opacity-100 mt-2":"grid-rows-[0fr] opacity-0 mt-0"}`,children:p.jsx("div",{className:"overflow-hidden",children:r})})]}),Vt=({onDragStart:t,type:e,category:n,icon:r,label:i,color:s,isDarkMode:o,compact:a})=>p.jsxs("div",{className:`${a?"flex flex-col items-center justify-center p-2 gap-1 text-center":"flex items-center gap-3 p-3"} rounded cursor-grab border-l-4 ${s.replace("border-","border-l-")} transition-all ${a?"hover:scale-105":"hover:translate-x-2"} ${o?"bg-zinc-800/40 border-y border-r border-zinc-800 hover:bg-zinc-800":"bg-white border-y border-r border-gray-200 hover:bg-gray-50 shadow-sm"}`,onDragStart:l=>t(l,e,n),draggable:!0,title:i,children:[p.jsx(r,{size:a?16:18,className:s.replace("border-","text-")}),p.jsx("span",{className:`${a?"text-[10px]":"text-sm"} font-bold font-mono ${o?"text-zinc-300":"text-zinc-700"}`,children:i})]}),Bz=({isOpen:t,onClose:e,node:n,onSave:r,onDelete:i,isDarkMode:s})=>{const[o,a]=D.useState(""),[l,c]=D.useState(""),[d,h]=D.useState(""),[f,m]=D.useState("clue"),[E,x]=D.useState(!1);if(D.useEffect(()=>{n&&(a(n.data.label||""),c(n.data.description||""),h(n.data.image||""),m(n.data.category||"clue"),x(!1))},[n]),!t)return null;if(E)return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm",children:p.jsxs("div",{className:`${s?"bg-zinc-900":"bg-white"} border border-red-900/50 p-6 rounded-lg w-96 shadow-2xl animate-in fade-in zoom-in duration-200 text-center`,children:[p.jsx("h2",{className:"text-xl font-bold text-red-500 font-mono tracking-wider mb-4",children:"ELIMINAR EVIDENCIA?"}),p.jsx("p",{className:`${s?"text-zinc-400":"text-gray-600"} text-sm font-mono mb-6`,children:"Esta accin es irreversible. Ests seguro?"}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsx("button",{onClick:()=>x(!1),className:`px-4 py-2 ${s?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:"Cancelar"}),p.jsx("button",{onClick:()=>i(n.id),className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Confirmar"})]})]})});const R=y=>{y.preventDefault(),r(n.id,{...n.data,label:o,description:l,image:d,category:f}),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm",children:p.jsxs("div",{className:`${s?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-96 shadow-2xl animate-in fade-in zoom-in duration-200`,children:[p.jsxs("div",{className:`flex justify-between items-center mb-4 border-b ${s?"border-zinc-800":"border-gray-200"} pb-2`,children:[p.jsx("h2",{className:"text-xl font-bold text-red-500 font-mono tracking-wider",children:"EDITAR EVIDENCIA"}),p.jsx("button",{onClick:e,className:`${s?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(gs,{size:20})})]}),p.jsxs("form",{onSubmit:R,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-category",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Categora"}),p.jsxs("select",{id:"evidence-category",name:"evidence-category",value:f,onChange:y=>m(y.target.value),className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all text-sm`,children:[p.jsx("option",{value:"person",children:"Sospechoso"}),p.jsx("option",{value:"place",children:"Lugar"}),p.jsx("option",{value:"clue",children:"Pista"}),p.jsx("option",{value:"event",children:"Evento"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-title",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Ttulo"}),p.jsx("input",{id:"evidence-title",type:"text",name:"evidence-title",value:o,onChange:y=>a(y.target.value),className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all`,autoFocus:!0})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-description",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Descripcin"}),p.jsx("textarea",{id:"evidence-description",name:"evidence-description",value:l,onChange:y=>c(y.target.value),rows:4,className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-300":"bg-gray-50 border-gray-300 text-gray-700"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono text-sm resize-none transition-all`})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-image-url",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Imagen (URL o Local)"}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("input",{id:"evidence-image-url",type:"text",name:"evidence-image-url",value:d,onChange:y=>h(y.target.value),placeholder:"https://...",className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-400":"bg-gray-50 border-gray-300 text-gray-600"} border p-2 rounded focus:border-red-900 outline-none font-mono text-xs`}),p.jsx("div",{className:`text-[10px] ${s?"text-zinc-600":"text-gray-400"} text-center font-mono uppercase tracking-widest`,children:"- O -"}),p.jsxs("label",{className:`flex items-center justify-center w-full p-2 ${s?"bg-zinc-950 border-zinc-800 hover:border-zinc-600 hover:text-zinc-200":"bg-gray-50 border-gray-300 hover:border-gray-400 hover:text-gray-800"} border border-dashed rounded cursor-pointer transition-colors group`,children:[p.jsx("span",{className:`text-xs ${s?"text-zinc-500 group-hover:text-zinc-300":"text-gray-500 group-hover:text-gray-700"} font-mono uppercase`,children:"Subir archivo local"}),p.jsx("input",{type:"file",name:"evidence-image-file",className:"hidden",accept:"image/*",onChange:y=>{const v=y.target.files[0];if(v){const T=new FileReader;T.onload=k=>h(k.target.result),T.readAsDataURL(v)}}})]})]})]}),n.data.status&&p.jsx("div",{className:`flex justify-end pt-2 border-t ${s?"border-zinc-800":"border-gray-200"}`,children:p.jsxs("button",{type:"button",onClick:()=>{r(n.id,{...n.data,status:null}),e()},className:"text-[10px] flex items-center gap-1 text-orange-500 hover:text-orange-400 uppercase font-bold tracking-wider",children:[p.jsx(ay,{size:12})," Quitar Sello"]})}),p.jsxs("div",{className:`flex justify-between items-center mt-6 pt-4 border-t ${s?"border-zinc-800":"border-gray-200"}`,children:[p.jsx("button",{type:"button",onClick:()=>x(!0),className:"text-red-600 hover:text-red-500 text-xs font-bold uppercase tracking-wider transition-colors",children:"Eliminar"}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:`px-4 py-2 ${s?"text-zinc-400 hover:text-white":"text-gray-500 hover:text-gray-800"} text-xs font-bold uppercase tracking-wider transition-colors`,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Guardar"})]})]})]})]})})};let fd;const qz=new Uint8Array(16);function Hz(){if(!fd&&(fd=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!fd))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fd(qz)}const $t=[];for(let t=0;t<256;++t)$t.push((t+256).toString(16).slice(1));function Kz(t,e=0){return $t[t[e+0]]+$t[t[e+1]]+$t[t[e+2]]+$t[t[e+3]]+"-"+$t[t[e+4]]+$t[t[e+5]]+"-"+$t[t[e+6]]+$t[t[e+7]]+"-"+$t[t[e+8]]+$t[t[e+9]]+"-"+$t[t[e+10]]+$t[t[e+11]]+$t[t[e+12]]+$t[t[e+13]]+$t[t[e+14]]+$t[t[e+15]]}const Gz=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),tx={randomUUID:Gz};function Vn(t,e,n){if(tx.randomUUID&&!t)return tx.randomUUID();t=t||{};const r=t.random||(t.rng||Hz)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Kz(r)}function Wz({top:t,left:e,right:n,bottom:r,clientX:i,clientY:s,onHide:o,takeSnapshot:a,setNodes:l}){const{screenToFlowPosition:c,setCenter:d,getZoom:h}=Ur(),f=E=>{E.stopPropagation();const{x,y:R}=c({x:i,y:s});d(x,R,{zoom:h(),duration:800}),o()},m=D.useCallback((E,x,R)=>{const y=c({x:i,y:s}),v={id:Vn(),type:E,position:y,data:{label:R,category:x}};a(),l(T=>T.concat(v)),o()},[i,s,c,a,l,o]);return p.jsxs("div",{style:{top:t,left:e,right:n,bottom:r},className:"absolute z-50 bg-zinc-800 border border-zinc-700 shadow-xl rounded-md overflow-hidden min-w-[150px] flex flex-col animate-in fade-in zoom-in duration-100",children:[p.jsxs("button",{onClick:f,className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors border-b border-zinc-700",children:[p.jsx(hz,{size:14,className:"text-blue-400"})," Centrar Vista"]}),p.jsxs("button",{onClick:()=>m("note","note","Nota"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(aS,{size:14,className:"text-yellow-500"})," Aadir Nota"]}),p.jsxs("button",{onClick:()=>m("text","text","Texto"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(uS,{size:14,className:"text-zinc-400"})," Aadir Texto"]}),p.jsxs("button",{onClick:()=>m("image","image","Imagen"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(cy,{size:14,className:"text-purple-500"})," Aadir Imagen"]}),p.jsxs("button",{onClick:()=>m("url","url","Enlace"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(uy,{size:14,className:"text-blue-400"})," Aadir URL"]})]})}const Qz=({isOpen:t,onClose:e,onConfirm:n,title:r,message:i,confirmText:s="Confirmar",cancelText:o="Cancelar",isDanger:a=!1,isDarkMode:l})=>t?p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[300] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${l?"bg-zinc-900":"bg-white"} border ${a?"border-red-900/50":l?"border-zinc-700":"border-gray-200"} p-6 rounded-lg w-96 shadow-2xl animate-in zoom-in duration-200 text-center`,children:[p.jsx("h2",{className:`text-xl font-bold ${a?"text-red-500":l?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-4`,children:r}),p.jsx("p",{className:`${l?"text-zinc-400":"text-gray-600"} text-sm font-mono mb-6`,children:i}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsx("button",{onClick:e,className:`px-4 py-2 ${l?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:o}),p.jsx("button",{onClick:()=>{n&&n(),e()},className:`px-6 py-2 ${a?"bg-red-900/80 hover:bg-red-800 text-red-100 border-red-900":"bg-blue-900/80 hover:bg-blue-800 text-blue-100 border-blue-900"} text-xs font-bold uppercase tracking-wider rounded shadow-lg border transition-all`,children:s})]})]})}):null,Yz=({isOpen:t,onClose:e,isDarkMode:n})=>{if(!t)return null;const r=[{key:"Doble Clic (Nodo)",desc:"Editar contenido de la evidencia",icon:jp},{key:"Doble Clic (Hilo)",desc:"Aadir/Editar etiqueta de relacin",icon:jp},{key:"Clic (Hilo)",desc:"Cambiar estilo (Slido / Punteado)",icon:jp},{key:"Backspace",desc:"Eliminar elementos seleccionados",icon:Qr},{key:"Ctrl + D",desc:"Duplicar nodos seleccionados",icon:Qr},{key:"Ctrl + Z",desc:"Deshacer accin",icon:Qr},{key:"Ctrl + Y",desc:"Rehacer accin",icon:Qr},{key:"Ctrl + S",desc:"Guardar tablero manualmente",icon:Qr},{key:"Ctrl + V",desc:"Pegar imagen del portapapeles",icon:Qr},{key:"F3 / Shift + F3",desc:"Navegar resultados de bsqueda",icon:Qr},{key:"Shift + C",desc:"Conectar nodos seleccionados",icon:Qr},{key:"Ctrl + Shift + L",desc:"Bloquear/Desbloquear seleccin",icon:ja}];return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${n?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-[500px] shadow-2xl animate-in zoom-in duration-200 relative`,children:[p.jsx("button",{onClick:e,className:`absolute top-4 right-4 ${n?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(gs,{size:20})}),p.jsxs("h2",{className:`text-xl font-bold ${n?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-6 flex items-center gap-2`,children:[p.jsx(Qr,{className:"text-red-500"})," ATAJOS DE TECLADO"]}),p.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.map((i,s)=>p.jsxs("div",{className:`flex items-center justify-between p-2 rounded border transition-colors ${n?"bg-zinc-950/50 border-zinc-800/50 hover:border-zinc-700":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(i.icon,{size:14,className:n?"text-zinc-500":"text-gray-400"}),p.jsx("span",{className:`${n?"text-zinc-300":"text-gray-700"} text-sm font-mono`,children:i.desc})]}),p.jsx("span",{className:"text-xs font-bold text-red-400 bg-red-900/10 px-2 py-1 rounded border border-red-900/20 font-mono",children:i.key})]},s))})]})})},Xz=({isOpen:t,onClose:e,onConfirm:n,onDelete:r,title:i,initialValue:s="",initialColor:o="#dc2626",initialType:a,showTypeSelector:l=!1,colorLabel:c="Color",placeholder:d="Escribe una relacin...",isDarkMode:h})=>{const[f,m]=D.useState(s),[E,x]=D.useState(o),[R,y]=D.useState(a||"default");if(D.useEffect(()=>{t&&(m(s),x(o),a&&y(a))},[t,s,o,a]),!t)return null;const v=[{color:"#dc2626",label:"Rojo"},{color:"#3b82f6",label:"Azul"},{color:"#22c55e",label:"Verde"},{color:"#eab308",label:"Amarillo"},{color:"#a855f7",label:"Morado"}],T=k=>{k.preventDefault(),n(f,E,R),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${h?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-96 shadow-2xl animate-in zoom-in duration-200`,children:[p.jsx("h2",{className:`text-xl font-bold ${h?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-4`,children:i}),p.jsxs("form",{onSubmit:T,children:[p.jsx("input",{type:"text",name:"input-value",value:f,onChange:k=>m(k.target.value),className:`w-full ${h?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all mb-4`,autoFocus:!0,placeholder:d}),l&&p.jsxs("div",{className:"mb-4",children:[p.jsx("span",{className:`block text-xs font-bold ${h?"text-zinc-500":"text-gray-500"} uppercase mb-2 font-mono`,children:"Tipo de Conexin"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{type:"button",onClick:()=>y("straight"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="straight"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Recta",children:p.jsx(rS,{size:16})}),p.jsx("button",{type:"button",onClick:()=>y("default"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="default"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Curva",children:p.jsx(pg,{size:16})}),p.jsx("button",{type:"button",onClick:()=>y("step"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="step"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Escalonada",children:p.jsx(eS,{size:16})})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("span",{className:`block text-xs font-bold ${h?"text-zinc-500":"text-gray-500"} uppercase mb-2 font-mono`,children:c}),p.jsx("div",{className:"flex gap-3",children:v.map(k=>p.jsx("button",{type:"button",onClick:()=>x(k.color),className:`w-6 h-6 rounded-full border-2 transition-all ${E===k.color?(h?"border-white ring-zinc-400":"border-gray-800 ring-gray-400")+" scale-110 ring-1":"border-transparent hover:scale-110"}`,style:{backgroundColor:k.color},title:k.label},k.color))})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[r?p.jsx("button",{type:"button",onClick:r,className:"text-red-600 hover:text-red-500 text-xs font-bold uppercase tracking-wider transition-colors",children:"Eliminar"}):p.jsx("div",{}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:`px-4 py-2 ${h?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Guardar"})]})]})]})]})})},Jz=({isOpen:t,onClose:e,boards:n,currentBoardId:r,onSwitch:i,onCreate:s,onDelete:o,onRename:a,onClone:l,onReorder:c,trash:d,onRestore:h,onPermanentDelete:f,isDarkMode:m})=>{const[E,x]=D.useState(null),[R,y]=D.useState(""),[v,T]=D.useState(!1),[k,O]=D.useState(""),[z,S]=D.useState(null),[b,w]=D.useState(""),[I,C]=D.useState("manual"),[N,A]=D.useState(!1),P=D.useMemo(()=>{let Y=(N?d:n).filter(X=>X.name.toLowerCase().includes(b.toLowerCase()));return I==="name"?Y.sort((X,ee)=>X.name.localeCompare(ee.name)):I==="created"?Y.sort((X,ee)=>ee.createdAt-X.createdAt):I==="modified"?Y.sort((X,ee)=>(ee.lastModified||0)-(X.lastModified||0)):Y},[n,d,b,I,N]),F=I==="manual"&&!b&&!N,M=(U,Y)=>{U.dataTransfer.setData("boardIndex",Y),U.dataTransfer.effectAllowed="move"},$=U=>{U.preventDefault(),U.dataTransfer.dropEffect="move"},j=(U,Y)=>{U.preventDefault();const X=parseInt(U.dataTransfer.getData("boardIndex"));if(isNaN(X)||X===Y)return;const ee=[...n],[oe]=ee.splice(X,1);ee.splice(Y,0,oe),c(ee)};if(!t)return null;const L=U=>{x(U.id),y(U.name)},B=()=>{R.trim()&&a(E,R),x(null)},G=()=>{k.trim()&&(s(k),O(""),T(!1))};return p.jsx("div",{className:"fixed inset-0 bg-black/90 z-[200] flex items-center justify-center backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${m?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border w-[900px] h-[600px] rounded-lg shadow-2xl flex flex-col overflow-hidden`,children:[p.jsxs("div",{className:`p-6 border-b ${m?"border-zinc-800 bg-zinc-950":"border-gray-200 bg-gray-50"} flex justify-between items-center z-50 relative`,children:[p.jsxs("div",{children:[p.jsxs("h2",{className:`text-2xl font-bold ${m?"text-zinc-100":"text-gray-800"} font-mono tracking-widest flex items-center gap-3 uppercase`,children:[N?p.jsx(ex,{className:"text-red-500",size:28}):p.jsx(Zw,{className:"text-yellow-600",size:28}),N?"PAPELERA DE RECICLAJE":"ARCHIVOS DE CASO"]}),p.jsx("p",{className:`${m?"text-zinc-500":"text-gray-500"} text-xs font-mono mt-1`,children:N?"Restaura casos eliminados o brralos definitivamente":"Selecciona un expediente para investigar"})]}),p.jsx("button",{onClick:e,className:`${m?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(gs,{size:24})})]}),p.jsxs("div",{className:`px-6 py-3 border-b flex gap-4 items-center justify-between ${m?"border-zinc-800 bg-zinc-900/50":"border-gray-200 bg-gray-50/50"}`,children:[p.jsxs("div",{className:`flex-1 flex items-center px-3 py-1.5 rounded border ${m?"bg-zinc-950 border-zinc-700":"bg-white border-gray-300"}`,children:[p.jsx(sS,{size:14,className:m?"text-zinc-500":"text-gray-400"}),p.jsx("input",{type:"text",name:"case-search",placeholder:"Buscar expediente...",value:b,onChange:U=>w(U.target.value),className:`ml-2 bg-transparent w-full text-xs outline-none font-mono ${m?"text-zinc-300 placeholder-zinc-600":"text-zinc-700 placeholder-zinc-400"}`})]}),p.jsxs("button",{onClick:()=>A(!N),className:`flex items-center gap-2 px-3 py-1.5 rounded border text-xs font-bold uppercase transition-colors ${N?m?"bg-red-900/30 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-600":m?"bg-zinc-900 border-zinc-700 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-600 hover:text-black"}`,children:[N?p.jsx(Zw,{size:14}):p.jsx(ex,{size:14}),N?"Ver Archivos":"Papelera"]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(tz,{size:14,className:m?"text-zinc-500":"text-gray-400"}),p.jsxs("select",{name:"sort-cases",value:I,onChange:U=>C(U.target.value),className:`text-xs font-mono p-1.5 rounded border outline-none cursor-pointer ${m?"bg-zinc-950 border-zinc-700 text-zinc-300":"bg-white border-gray-300 text-zinc-700"}`,children:[p.jsx("option",{value:"manual",children:"Manual (Arrastrar)"}),p.jsx("option",{value:"name",children:"Nombre (A-Z)"}),p.jsx("option",{value:"created",children:"Creado (Reciente)"}),p.jsx("option",{value:"modified",children:"Modificado (Reciente)"})]})]})]}),p.jsx("div",{className:`flex-1 p-8 overflow-y-auto overflow-x-hidden ${m?"bg-zinc-900/50":"bg-gray-100"}`,children:p.jsxs("div",{className:"flex flex-wrap justify-center items-start gap-y-12 pl-8 pb-12 pt-[2px]",children:[!b&&!N&&(v?p.jsx("div",{className:"relative w-56 h-40 -ml-12 first:ml-0 z-50 transition-all duration-300 shadow-2xl transform scale-105",children:p.jsxs("div",{className:`flex flex-col items-center justify-center h-full border-2 border-dashed border-yellow-600/50 bg-yellow-900/10 rounded-lg p-4 animate-in zoom-in duration-200 ${m?"bg-zinc-900":"bg-white"}`,children:[p.jsx("span",{className:"text-yellow-500 font-mono text-xs font-bold mb-2",children:"NOMBRE DEL CASO"}),p.jsx("input",{type:"text",name:"new-case-name",autoFocus:!0,value:k,onChange:U=>O(U.target.value),onKeyDown:U=>{U.key==="Enter"&&G(),U.key==="Escape"&&T(!1)},placeholder:"Ej: El Robo del Siglo",className:`${m?"bg-zinc-950 border-zinc-700 text-white":"bg-white border-gray-300 text-gray-900"} border text-xs p-2 w-full rounded outline-none focus:border-yellow-600 font-mono text-center mb-2`}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>T(!1),className:`${m?"text-zinc-500 hover:text-white hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 hover:bg-gray-200"} text-[10px] uppercase font-bold px-2 py-1 rounded`,children:"Cancelar"}),p.jsx("button",{onClick:G,className:"text-zinc-900 bg-yellow-600 hover:bg-yellow-500 text-[10px] uppercase font-bold px-3 py-1 rounded",children:"Crear"})]})]})}):p.jsx("button",{onClick:()=>{T(!0),O(`Caso #${n.length+1}`)},className:"relative w-56 h-40 -ml-12 first:ml-0 transition-all duration-300 group",style:{zIndex:z==="new"?50:0,transform:z==="new"?"translateY(-1rem) scale(1.05) rotate(0deg)":"rotate(-3deg)"},onMouseEnter:()=>S("new"),onMouseLeave:()=>S(null),children:p.jsxs("div",{className:`flex flex-col items-center justify-center h-full border-2 border-dashed rounded-lg shadow-lg ${m?"border-zinc-700 hover:border-zinc-500 bg-zinc-800/50":"border-gray-300 hover:border-gray-400 bg-white"}`,children:[p.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 transition-all group-hover:scale-110 ${m?"bg-zinc-800 group-hover:bg-zinc-700":"bg-gray-200 group-hover:bg-gray-300"}`,children:p.jsx(Rz,{className:m?"text-zinc-400 group-hover:text-white":"text-gray-500 group-hover:text-gray-800"})}),p.jsx("span",{className:`${m?"text-zinc-400 group-hover:text-white":"text-gray-500 group-hover:text-gray-800"} font-mono text-sm font-bold`,children:"NUEVO CASO"})]})})),P.map((U,Y)=>{const X=z===U.id,ee=r===U.id,oe=U.isDeleting,fe=Y%3===0?"2deg":Y%3===1?"-1deg":"3deg";return p.jsx("div",{draggable:F,onDragStart:ue=>M(ue,Y),onDragOver:$,onDrop:ue=>j(ue,Y),className:"relative w-56 h-40 -ml-12 transition-all duration-300 ease-out cursor-pointer group",style:{zIndex:X?50:Y+1,transform:X?"translateY(-1.5rem) scale(1.1) rotate(0deg)":`rotate(${fe})`,animation:oe?"delete-burn 0.5s ease-in-out forwards":"none",pointerEvents:oe?"none":"auto"},onMouseEnter:()=>S(U.id),onMouseLeave:()=>S(null),onClick:()=>{E!==U.id&&!N&&i(U.id)},children:p.jsxs("div",{className:`relative flex flex-col h-full border-2 rounded-lg overflow-hidden shadow-[0_5px_15px_rgba(0,0,0,0.5)] transition-colors duration-300
                    ${ee?m?"border-yellow-500 bg-yellow-900/40":"border-yellow-500 bg-yellow-100":m?N?"border-zinc-700 bg-zinc-900/50":"border-yellow-900/40 bg-yellow-950/30 hover:border-yellow-700 hover:bg-yellow-900/20":N?"border-gray-300 bg-gray-100":"border-yellow-200 bg-yellow-50 hover:border-yellow-300 hover:bg-yellow-100"}
                `,children:[F&&X&&p.jsx("div",{className:"absolute top-2 right-2 text-yellow-600/50",children:p.jsx(_z,{size:16})}),p.jsx("div",{className:`absolute top-0 left-0 w-24 h-6 rounded-br-lg border-b-2 border-r-2 shadow-sm transition-colors duration-300
                        ${ee?"bg-yellow-500 border-yellow-500":m?N?"bg-zinc-800 border-zinc-700":"bg-yellow-900/40 border-yellow-900/40 group-hover:bg-yellow-800 group-hover:border-yellow-700":N?"bg-gray-300 border-gray-300":"bg-yellow-200 border-yellow-200 group-hover:bg-yellow-300 group-hover:border-yellow-300"}
                    `}),p.jsxs("div",{className:"flex-1 p-4 pt-8 flex flex-col items-center justify-between text-center",children:[p.jsxs("div",{children:[p.jsx(ly,{size:32,className:`mb-2 drop-shadow-md transition-colors duration-300 ${ee?m?"text-yellow-400":"text-yellow-600":m?"text-yellow-800/60 group-hover:text-yellow-600":"text-yellow-300 group-hover:text-yellow-500"}`}),E===U.id?p.jsxs("div",{className:"flex items-center gap-1 w-full",onClick:ue=>ue.stopPropagation(),children:[p.jsx("input",{type:"text",name:"edit-case-name",value:R,onChange:ue=>y(ue.target.value),className:`${m?"bg-zinc-950 border-zinc-600 text-white":"bg-white border-gray-300 text-gray-900"} border text-xs p-1 w-full rounded outline-none focus:border-yellow-600 font-mono`,autoFocus:!0,onKeyDown:ue=>ue.key==="Enter"&&B()}),p.jsx("button",{onClick:B,className:"text-green-500 hover:text-green-400",children:p.jsx(ZT,{size:14})})]}):p.jsx("h3",{className:`font-mono font-bold text-sm line-clamp-2 ${r===U.id?m?"text-yellow-100":"text-yellow-800":m?N?"text-zinc-500 line-through":"text-zinc-300":N?"text-gray-400 line-through":"text-gray-700"}`,onDoubleClick:ue=>{N||(ue.stopPropagation(),L(U))},children:U.name})]}),p.jsxs("div",{className:`text-[10px] ${m?"text-zinc-500":"text-gray-500"} font-mono w-full`,children:[U.lastModified&&p.jsxs("p",{children:["Modif: ",new Date(U.lastModified).toLocaleString([],{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),p.jsxs("p",{className:`${m?"text-zinc-600":"text-gray-400"}`,children:["Creado: ",new Date(U.createdAt).toLocaleDateString()]})]})]}),p.jsx("div",{className:`absolute bottom-2 right-2 flex gap-1 ${N?"opacity-100":"opacity-0 group-hover:opacity-100"} transition-opacity z-50`,onClick:ue=>ue.stopPropagation(),children:N?p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:ue=>{ue.stopPropagation(),h(U.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-green-500 hover:text-green-400 hover:bg-zinc-950 border-zinc-700":"bg-white text-green-600 hover:text-green-700 hover:bg-gray-50 border-gray-200"}`,title:"Restaurar Caso",children:p.jsx(hy,{size:12})}),p.jsx("button",{onClick:ue=>{ue.stopPropagation(),f(U.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-red-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-red-600 hover:bg-gray-50 border-gray-200"}`,title:"Eliminar Definitivamente",children:p.jsx(gg,{size:12})})]}):p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:ue=>{ue.preventDefault(),ue.stopPropagation(),l(U.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-green-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-green-600 hover:bg-gray-50 border-gray-200"}`,title:"Clonar Caso",children:p.jsx(uz,{size:12})}),p.jsx("button",{onClick:ue=>{ue.stopPropagation(),L(U)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-blue-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-blue-600 hover:bg-gray-50 border-gray-200"}`,title:"Renombrar Caso",children:p.jsx(kz,{size:12})}),n.length>1&&p.jsx("button",{onClick:ue=>{ue.stopPropagation(),o(U.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-red-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-red-600 hover:bg-gray-50 border-gray-200"}`,title:"Mover a Papelera",children:p.jsx(gg,{size:12})})]})})]})},U.id)})]})}),p.jsx("div",{className:`p-4 border-t text-center z-50 relative ${m?"bg-zinc-950 border-zinc-800":"bg-gray-50 border-gray-200"}`,children:p.jsx("p",{className:`${m?"text-zinc-600":"text-gray-400"} text-[10px] font-mono`,children:"CONFIDENCIAL - SOLO PARA USO OFICIAL"})})]})})},Zz=({isZenMode:t,setIsZenMode:e,undo:n,redo:r,isDarkMode:i})=>p.jsxs("div",{className:"absolute top-4 right-4 z-50 flex gap-2",children:[!t&&p.jsxs(p.Fragment,{children:[p.jsxs("button",{onClick:n,className:`px-4 py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 shadow-lg ${i?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-white text-zinc-600 border-gray-300 hover:bg-gray-100"}`,title:"Deshacer (Ctrl+Z)",children:[p.jsx(Mz,{size:14})," Deshacer"]}),p.jsxs("button",{onClick:r,className:`px-4 py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 shadow-lg ${i?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-white text-zinc-600 border-gray-300 hover:bg-gray-100"}`,title:"Rehacer (Ctrl+Y)",children:[p.jsx(Nz,{size:14})," Rehacer"]})]}),t&&p.jsxs("button",{onClick:()=>e(!1),className:"px-4 py-2 bg-black/50 hover:bg-black/80 text-white border border-white/20 rounded backdrop-blur-sm flex items-center gap-2 transition-all animate-in fade-in",title:"Salir de Modo Zen (Esc)",children:[p.jsx(Ez,{size:14})," Salir"]})]}),py=(t,e)=>{if(!t||!t.type.startsWith("image/"))return;const n=new FileReader;n.onload=r=>{const i=new Image;i.onload=()=>{let o=i.width,a=i.height;if(o>400||a>400){const h=o/a;o>a?(o=400,a=400/h):(a=400,o=400*h)}const l=document.createElement("canvas");l.width=o,l.height=a,l.getContext("2d").drawImage(i,0,0,o,a);const d=l.toDataURL("image/jpeg",.7);e(d,o,a)},i.src=r.target.result},n.readAsDataURL(t)},eM=({isInteractive:t,reactFlowInstance:e,takeSnapshot:n,setNodes:r})=>{D.useEffect(()=>{const i=s=>{if(!t||!e)return;const o=s.clipboardData.items;for(const a of o)if(a.type.indexOf("image")!==-1){const l=a.getAsFile();py(l,(c,d,h)=>{const f=e.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2}),m={id:Vn(),type:"image",position:f,data:{label:"Imagen Pegada",image:c},style:{width:d,height:h}};n(),r(E=>E.concat(m))})}};return window.addEventListener("paste",i),()=>window.removeEventListener("paste",i)},[e,t,n,r])};function tM(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),e&&(r.href=e),i.href=t,i.href}const nM=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function ns(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let qo=null;function dS(t={}){return qo||(t.includeStyleProperties?(qo=t.includeStyleProperties,qo):(qo=ns(window.getComputedStyle(document.documentElement)),qo))}function Nh(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function rM(t){const e=Nh(t,"border-left-width"),n=Nh(t,"border-right-width");return t.clientWidth+e+n}function iM(t){const e=Nh(t,"border-top-width"),n=Nh(t,"border-bottom-width");return t.clientHeight+e+n}function hS(t,e={}){const n=e.width||rM(t),r=e.height||iM(t);return{width:n,height:r}}function sM(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Nn=16384;function oM(t){(t.width>Nn||t.height>Nn)&&(t.width>Nn&&t.height>Nn?t.width>t.height?(t.height*=Nn/t.width,t.width=Nn):(t.width*=Nn/t.height,t.height=Nn):t.width>Nn?(t.height*=Nn/t.width,t.width=Nn):(t.width*=Nn/t.height,t.height=Nn))}function Ph(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function aM(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function lM(t,e,n){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${e}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${e} ${n}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),i.appendChild(s),s.appendChild(t),aM(i)}const xn=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||xn(n,e)};function cM(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function uM(t,e){return dS(e).map(n=>{const r=t.getPropertyValue(n),i=t.getPropertyPriority(n);return`${n}: ${r}${i?" !important":""};`}).join(" ")}function dM(t,e,n,r){const i=`.${t}:${e}`,s=n.cssText?cM(n):uM(n,r);return document.createTextNode(`${i}{${s}}`)}function nx(t,e,n,r){const i=window.getComputedStyle(t,n),s=i.getPropertyValue("content");if(s===""||s==="none")return;const o=nM();try{e.className=`${e.className} ${o}`}catch{return}const a=document.createElement("style");a.appendChild(dM(o,n,i,r)),e.appendChild(a)}function hM(t,e,n){nx(t,e,":before",n),nx(t,e,":after",n)}const rx="application/font-woff",ix="image/jpeg",fM={woff:rx,woff2:rx,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:ix,jpeg:ix,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function pM(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function my(t){const e=pM(t).toLowerCase();return fM[e]||""}function mM(t){return t.split(/,/)[1]}function yg(t){return t.search(/^(data:)/)!==-1}function gM(t,e){return`data:${e};base64,${t}`}async function fS(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const i=await r.blob();return new Promise((s,o)=>{const a=new FileReader;a.onerror=o,a.onloadend=()=>{try{s(n({res:r,result:a.result}))}catch(l){o(l)}},a.readAsDataURL(i)})}const Fp={};function yM(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function gy(t,e,n){const r=yM(t,e,n.includeQueryParams);if(Fp[r]!=null)return Fp[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let i;try{const s=await fS(t,n.fetchRequestInit,({res:o,result:a})=>(e||(e=o.headers.get("Content-Type")||""),mM(a)));i=gM(s,e)}catch(s){i=n.imagePlaceholder||"";let o=`Failed to fetch resource: ${t}`;s&&(o=typeof s=="string"?s:s.message),o&&console.warn(o)}return Fp[r]=i,i}async function vM(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):Ph(e)}async function _M(t,e){if(t.currentSrc){const s=document.createElement("canvas"),o=s.getContext("2d");s.width=t.clientWidth,s.height=t.clientHeight,o==null||o.drawImage(t,0,0,s.width,s.height);const a=s.toDataURL();return Ph(a)}const n=t.poster,r=my(n),i=await gy(n,r,e);return Ph(i)}async function wM(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await Sf(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function xM(t,e){return xn(t,HTMLCanvasElement)?vM(t):xn(t,HTMLVideoElement)?_M(t,e):xn(t,HTMLIFrameElement)?wM(t,e):t.cloneNode(pS(t))}const bM=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",pS=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function EM(t,e,n){var r,i;if(pS(e))return e;let s=[];return bM(t)&&t.assignedNodes?s=ns(t.assignedNodes()):xn(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?s=ns(t.contentDocument.body.childNodes):s=ns(((i=t.shadowRoot)!==null&&i!==void 0?i:t).childNodes),s.length===0||xn(t,HTMLVideoElement)||await s.reduce((o,a)=>o.then(()=>Sf(a,n)).then(l=>{l&&e.appendChild(l)}),Promise.resolve()),e}function IM(t,e,n){const r=e.style;if(!r)return;const i=window.getComputedStyle(t);i.cssText?(r.cssText=i.cssText,r.transformOrigin=i.transformOrigin):dS(n).forEach(s=>{let o=i.getPropertyValue(s);s==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),xn(t,HTMLIFrameElement)&&s==="display"&&o==="inline"&&(o="block"),s==="d"&&e.getAttribute("d")&&(o=`path(${e.getAttribute("d")})`),r.setProperty(s,o,i.getPropertyPriority(s))})}function TM(t,e){xn(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),xn(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function SM(t,e){if(xn(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(i=>t.value===i.getAttribute("value"));r&&r.setAttribute("selected","")}}function CM(t,e,n){return xn(e,Element)&&(IM(t,e,n),hM(t,e,n),TM(t,e),SM(t,e)),e}async function AM(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let s=0;s<n.length;s++){const a=n[s].getAttribute("xlink:href");if(a){const l=t.querySelector(a),c=document.querySelector(a);!l&&c&&!r[a]&&(r[a]=await Sf(c,e,!0))}}const i=Object.values(r);if(i.length){const s="http://www.w3.org/1999/xhtml",o=document.createElementNS(s,"svg");o.setAttribute("xmlns",s),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const a=document.createElementNS(s,"defs");o.appendChild(a);for(let l=0;l<i.length;l++)a.appendChild(i[l]);t.appendChild(o)}return t}async function Sf(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>xM(r,e)).then(r=>EM(t,r,e)).then(r=>CM(t,r,e)).then(r=>AM(r,e))}const mS=/url\((['"]?)([^'"]+?)\1\)/g,kM=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,RM=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function NM(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function PM(t){const e=[];return t.replace(mS,(n,r,i)=>(e.push(i),n)),e.filter(n=>!yg(n))}async function DM(t,e,n,r,i){try{const s=n?tM(e,n):e,o=my(e);let a;return i||(a=await gy(s,o,r)),t.replace(NM(e),`$1${a}$3`)}catch{}return t}function VM(t,{preferredFontFormat:e}){return e?t.replace(RM,n=>{for(;;){const[r,,i]=kM.exec(n)||[];if(!i)return"";if(i===e)return`src: ${r};`}}):t}function gS(t){return t.search(mS)!==-1}async function yS(t,e,n){if(!gS(t))return t;const r=VM(t,n);return PM(r).reduce((s,o)=>s.then(a=>DM(a,o,e,n)),Promise.resolve(r))}async function Ho(t,e,n){var r;const i=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(i){const s=await yS(i,null,n);return e.style.setProperty(t,s,e.style.getPropertyPriority(t)),!0}return!1}async function OM(t,e){await Ho("background",t,e)||await Ho("background-image",t,e),await Ho("mask",t,e)||await Ho("-webkit-mask",t,e)||await Ho("mask-image",t,e)||await Ho("-webkit-mask-image",t,e)}async function zM(t,e){const n=xn(t,HTMLImageElement);if(!(n&&!yg(t.src))&&!(xn(t,SVGImageElement)&&!yg(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,i=await gy(r,my(r),e);await new Promise((s,o)=>{t.onload=s,t.onerror=e.onImageErrorHandler?(...l)=>{try{s(e.onImageErrorHandler(...l))}catch(c){o(c)}}:o;const a=t;a.decode&&(a.decode=s),a.loading==="lazy"&&(a.loading="eager"),n?(t.srcset="",t.src=i):t.href.baseVal=i})}async function MM(t,e){const r=ns(t.childNodes).map(i=>vS(i,e));await Promise.all(r).then(()=>t)}async function vS(t,e){xn(t,Element)&&(await OM(t,e),await zM(t,e),await MM(t,e))}function LM(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(i=>{n[i]=r[i]}),t}const sx={};async function ox(t){let e=sx[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},sx[t]=e,e}async function ax(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,s=(n.match(/url\([^)]+\)/g)||[]).map(async o=>{let a=o.replace(r,"$1");return a.startsWith("https://")||(a=new URL(a,t.url).href),fS(a,e.fetchRequestInit,({result:l})=>(n=n.replace(o,`url(${l})`),[o,l]))});return Promise.all(s).then(()=>n)}function lx(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const l=i.exec(r);if(l===null)break;e.push(l[0])}r=r.replace(i,"");const s=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(o,"gi");for(;;){let l=s.exec(r);if(l===null){if(l=a.exec(r),l===null)break;s.lastIndex=a.lastIndex}else a.lastIndex=s.lastIndex;e.push(l[0])}return e}async function jM(t,e){const n=[],r=[];return t.forEach(i=>{if("cssRules"in i)try{ns(i.cssRules||[]).forEach((s,o)=>{if(s.type===CSSRule.IMPORT_RULE){let a=o+1;const l=s.href,c=ox(l).then(d=>ax(d,e)).then(d=>lx(d).forEach(h=>{try{i.insertRule(h,h.startsWith("@import")?a+=1:i.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:h,error:f})}})).catch(d=>{console.error("Error loading remote css",d.toString())});r.push(c)}})}catch(s){const o=t.find(a=>a.href==null)||document.styleSheets[0];i.href!=null&&r.push(ox(i.href).then(a=>ax(a,e)).then(a=>lx(a).forEach(l=>{o.insertRule(l,o.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",s)}}),Promise.all(r).then(()=>(t.forEach(i=>{if("cssRules"in i)try{ns(i.cssRules||[]).forEach(s=>{n.push(s)})}catch(s){console.error(`Error while reading CSS rules from ${i.href}`,s)}}),n))}function FM(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>gS(e.style.getPropertyValue("src")))}async function $M(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=ns(t.ownerDocument.styleSheets),r=await jM(n,e);return FM(r)}function _S(t){return t.trim().replace(/["']/g,"")}function UM(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(s=>{e.add(_S(s))}),Array.from(r.children).forEach(s=>{s instanceof HTMLElement&&n(s)})}return n(t),e}async function BM(t,e){const n=await $M(t,e),r=UM(t);return(await Promise.all(n.filter(s=>r.has(_S(s.style.fontFamily))).map(s=>{const o=s.parentStyleSheet?s.parentStyleSheet.href:null;return yS(s.cssText,o,e)}))).join(`
`)}async function qM(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await BM(t,e);if(n){const r=document.createElement("style"),i=document.createTextNode(n);r.appendChild(i),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function HM(t,e={}){const{width:n,height:r}=hS(t,e),i=await Sf(t,e,!0);return await qM(i,e),await vS(i,e),LM(i,e),await lM(i,n,r)}async function KM(t,e={}){const{width:n,height:r}=hS(t,e),i=await HM(t,e),s=await Ph(i),o=document.createElement("canvas"),a=o.getContext("2d"),l=e.pixelRatio||sM(),c=e.canvasWidth||n,d=e.canvasHeight||r;return o.width=c*l,o.height=d*l,e.skipAutoScale||oM(o),o.style.width=`${c}`,o.style.height=`${d}`,e.backgroundColor&&(a.fillStyle=e.backgroundColor,a.fillRect(0,0,o.width,o.height)),a.drawImage(s,0,0,o.width,o.height),o}async function cx(t,e={}){return(await KM(t,e)).toDataURL()}const GM=({reactFlowWrapper:t,reactFlowInstance:e,boards:n,currentBoardId:r,bgType:i,isDarkMode:s,setNodes:o})=>{const[a,l]=D.useState(!1),c=D.useCallback(async()=>{if(t.current===null||!e||!o)return;l(!0),await new Promise(M=>setTimeout(M,100));const{x:d,y:h,zoom:f}=e.getViewport(),m=e.getNodes(),E=m.filter(M=>M.selected),x=E.map(M=>M.id);x.length>0&&(o(M=>M.map($=>({...$,selected:!1}))),await new Promise(M=>setTimeout(M,50)));const R=E.length>0?E:m;if(R.length===0){l(!1),x.length>0&&o(M=>M.map($=>({...$,selected:x.includes($.id)})));return}const y=vu(R),v=100,T=y.width+v*2,k=y.height+v*2,O=-y.x+v,z=-y.y+v;e.setViewport({x:O,y:z,zoom:1}),await new Promise(M=>setTimeout(M,1e3)),document.fonts&&await document.fonts.ready;const b=t.current.querySelector(".react-flow");if(!b){l(!1),x.length>0&&o(M=>M.map($=>({...$,selected:x.includes($.id)})));return}const w=n.find(M=>M.id===r),C=(w?w.name:"Tablero sin nombre").toUpperCase(),N=Math.max(16,Math.min(72,T*.04)),A=N*.5;let P={};i==="cork"?P={backgroundColor:s?"#18181b":"#e5e5e5",backgroundImage:s?"radial-gradient(rgba(255,255,255,0.05) 1px, transparent 1px), radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px)":"radial-gradient(#999 1px, transparent 1px), radial-gradient(#999 1px, transparent 1px)",backgroundSize:"40px 40px",backgroundPosition:"0 0, 20px 20px"}:i==="blackboard"?P={backgroundColor:s?"#27272a":"#ffffff",backgroundImage:s?"linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px)":"radial-gradient(#e5e7eb 2px, transparent 2px)",backgroundSize:s?"100px 100px":"30px 30px"}:P={backgroundColor:s?"#1e293b":"#f0f9ff",backgroundImage:s?"linear-gradient(#334155 1px, transparent 1px), linear-gradient(90deg, #334155 1px, transparent 1px)":"linear-gradient(#cbd5e1 1px, transparent 1px), linear-gradient(90deg, #cbd5e1 1px, transparent 1px)",backgroundSize:"20px 20px"};const F={pixelRatio:2,skipAutoScale:!0,backgroundColor:P.backgroundColor,width:T,height:k,style:{width:`${T}px`,height:`${k}px`,overflow:"visible",fontFamily:"'Courier Prime', monospace",...P},imagePlaceholder:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",filter:M=>!(M.classList&&(M.classList.contains("react-flow__controls")||M.classList.contains("react-flow__minimap")||M.classList.contains("react-flow__attribution")))};try{let M;try{M=await cx(b,{...F,useCORS:!0})}catch(oe){console.warn("Error exportando con CORS, reintentando sin CORS...",oe),await new Promise(fe=>setTimeout(fe,1e3)),M=await cx(b,{...F,useCORS:!1})}const $=document.createElement("canvas"),j=F.pixelRatio||1;$.width=T*j,$.height=k*j;const L=$.getContext("2d"),B=new Image;await new Promise((oe,fe)=>{B.onload=oe,B.onerror=fe,B.src=M}),L.drawImage(B,0,0);const G=N*j;L.font=`bold ${G}px "Courier Prime", monospace`,L.fillStyle=s?"rgba(255, 255, 255, 0.4)":"rgba(0, 0, 0, 0.4)",L.shadowColor=s?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.2)",L.shadowBlur=3*j,L.shadowOffsetX=1*j,L.shadowOffsetY=1*j,L.textAlign="right",L.textBaseline="bottom";const U=A*j;L.fillText(C,$.width-U,$.height-U),M=$.toDataURL("image/png");const Y=document.createElement("a"),X=n.find(oe=>oe.id===r),ee=X?X.name.replace(/[^a-z0-9\u00C0-\u017F\s-_]/gi,""):"caso-detective";Y.download=`${ee}.png`,Y.href=M,Y.click()}catch(M){console.error("Error al exportar",M),alert("Error al generar la imagen. Si utilizas imgenes externas (URL), es posible que tengan restricciones de seguridad (CORS).")}finally{e.setViewport({x:d,y:h,zoom:f}),x.length>0&&o(M=>M.map($=>({...$,selected:x.includes($.id)}))),l(!1)}},[t,s,e,n,r,i,o]);return{isExporting:a,onExport:c}},WM="default-case",$p=(t,e=[])=>{let n=localStorage.getItem(`board-${t}-nodes`),r=localStorage.getItem(`board-${t}-edges`),i=localStorage.getItem(`board-${t}-bg`);return!n&&t===WM&&(n=localStorage.getItem("detective-board-nodes"),r=localStorage.getItem("detective-board-edges")),{nodes:n?JSON.parse(n):e,edges:r?JSON.parse(r):[],bgType:i||"cork"}},pd="default-case",QM=({nodes:t,edges:e,bgType:n,setNodes:r,setEdges:i,setBgType:s,reactFlowInstance:o,clearHistory:a,setCaseManagerOpen:l,setConfirmModal:c,lastSaved:d})=>{const[h,f]=D.useState(()=>{try{const w=localStorage.getItem("detective-boards-list");return w?JSON.parse(w):localStorage.getItem("detective-board-nodes")?[{id:pd,name:"Caso #001: Principal",createdAt:Date.now(),lastModified:Date.now()}]:[{id:pd,name:"Caso #001: Nuevo",createdAt:Date.now(),lastModified:Date.now()}]}catch{return[{id:pd,name:"Caso #001: Nuevo",createdAt:Date.now(),lastModified:Date.now()}]}}),[m,E]=D.useState(()=>{try{const w=localStorage.getItem("detective-boards-trash");return w?JSON.parse(w):[]}catch{return[]}}),[x,R]=D.useState(()=>localStorage.getItem("detective-current-board-id")||pd);D.useEffect(()=>{localStorage.setItem("detective-boards-list",JSON.stringify(h))},[h]),D.useEffect(()=>{localStorage.setItem("detective-boards-trash",JSON.stringify(m))},[m]),D.useEffect(()=>{localStorage.setItem("detective-current-board-id",x)},[x]),D.useEffect(()=>{d&&f(w=>w.map(I=>I.id===x?{...I,lastModified:d.getTime()}:I))},[d,x]),D.useEffect(()=>{const w=h.find(I=>I.id===x);w&&(document.title=`${w.name} | Detective Board`)},[x,h]);const y=D.useCallback(w=>{localStorage.setItem(`board-${x}-nodes`,JSON.stringify(t)),localStorage.setItem(`board-${x}-edges`,JSON.stringify(e)),localStorage.setItem(`board-${x}-bg`,n);const I=$p(w);r(I.nodes),i(I.edges),s(I.bgType),R(w),a(),l(!1),o&&setTimeout(()=>{o.fitView({duration:800,padding:.2})},100)},[x,t,e,n,r,i,s,a,o,l]),v=w=>{if(!w)return;const I=Vn(),C={id:I,name:w,createdAt:Date.now(),lastModified:Date.now()};f(N=>[...N,C]),y(I)},T=w=>{h.length<=1||c({isOpen:!0,title:"MOVER A PAPELERA?",message:"El caso se mover a la papelera. Podrs restaurarlo si lo necesitas.",isDanger:!0,confirmText:"Mover",onConfirm:()=>{f(I=>I.map(C=>C.id===w?{...C,isDeleting:!0}:C)),setTimeout(()=>{const I=h.find(N=>N.id===w),C=h.filter(N=>N.id!==w);if(I){const{isDeleting:N,...A}=I;E(P=>[{...A,deletedAt:Date.now()},...P])}if(f(C),x===w){const N=C[0].id,A=$p(N);r(A.nodes),i(A.edges),s(A.bgType),R(N),a(),o&&setTimeout(()=>{o.fitView({duration:800,padding:.2})},100)}},500)}})},k=D.useCallback(w=>{const I=m.find(C=>C.id===w);I&&(E(C=>C.filter(N=>N.id!==w)),f(C=>[...C,{...I,isDeleting:!1}]))},[m]),O=D.useCallback(w=>{c({isOpen:!0,title:"ELIMINAR DEFINITIVAMENTE?",message:"Esta accin es irreversible. Los datos del caso se borrarn del disco para siempre.",isDanger:!0,confirmText:"Eliminar",onConfirm:()=>{E(I=>I.filter(C=>C.id!==w)),localStorage.removeItem(`board-${w}-nodes`),localStorage.removeItem(`board-${w}-edges`),localStorage.removeItem(`board-${w}-bg`)}})},[]),z=(w,I)=>{f(C=>C.map(N=>N.id===w?{...N,name:I}:N))},S=D.useCallback(w=>{f(w)},[]),b=D.useCallback(w=>{const I=h.find(C=>C.id===w);I&&c({isOpen:!0,title:"CLONAR CASO?",message:`Deseas crear una copia del expediente "${I.name}"?`,confirmText:"Clonar",onConfirm:()=>{let C,N,A;if(w===x)C=t,N=e,A=n;else{const M=$p(w);C=M.nodes,N=M.edges,A=M.bgType}const P=Vn(),F={id:P,name:`${I.name} (Copia)`,createdAt:Date.now(),lastModified:Date.now()};localStorage.setItem(`board-${P}-nodes`,JSON.stringify(C)),localStorage.setItem(`board-${P}-edges`,JSON.stringify(N)),localStorage.setItem(`board-${P}-bg`,A),f(M=>{const $=M.findIndex(L=>L.id===w),j=[...M];return j.splice($+1,0,F),j}),y(P)}})},[h,y,x,t,e,n,c]);return D.useEffect(()=>{h.length>0&&!h.find(w=>w.id===x)&&y(h[0].id)},[h,x,y]),{boards:h,setBoards:f,trash:m,currentBoardId:x,setCurrentBoardId:R,handleSwitchBoard:y,handleCreateBoard:v,handleDeleteBoard:T,handleRestoreBoard:k,handlePermanentDelete:O,handleRenameBoard:z,handleReorderBoards:S,handleCloneBoard:b}},YM=({onSave:t,undo:e,redo:n,duplicateSelected:r,navigateSearch:i,reactFlowInstance:s,edges:o,setEdges:a,takeSnapshot:l,connectionLineType:c,connectionColor:d})=>{D.useEffect(()=>{const h=f=>{if((f.ctrlKey||f.metaKey)&&f.key==="s"&&(f.preventDefault(),t()),(f.ctrlKey||f.metaKey)&&f.key==="z"&&(f.preventDefault(),f.shiftKey?n():e()),(f.ctrlKey||f.metaKey)&&f.key==="y"&&(f.preventDefault(),n()),(f.ctrlKey||f.metaKey)&&f.key==="d"&&(f.preventDefault(),r()),f.key==="F3"&&(f.preventDefault(),f.shiftKey?i("prev"):i("next")),f.shiftKey&&f.key.toLowerCase()==="c"){if(f.preventDefault(),!s)return;const m=s.getNodes().filter(E=>E.selected);if(m.length>=2){m.sort((x,R)=>x.position.x-R.position.x);const E=[];for(let x=0;x<m.length-1;x++){const R=m[x],y=m[x+1];o.some(T=>T.source===R.id&&T.target===y.id||T.source===y.id&&T.target===R.id)||E.push({id:Vn(),source:R.id,target:y.id,type:c,style:{stroke:d,strokeWidth:2},className:"quick-draw"})}E.length>0&&(l(),a(x=>x.concat(E)))}}};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,e,n,r,i,o,c,d,s,a,l])},XM=({isInteractive:t,reactFlowInstance:e,setNodes:n,takeSnapshot:r,setPendingStampNodeId:i,setInputModalOpen:s,setEditingEdge:o,setEditingNode:a})=>{const l=D.useCallback(d=>{if(d.preventDefault(),!t){d.dataTransfer.dropEffect="none";return}d.dataTransfer.dropEffect="move"},[t]),c=D.useCallback(d=>{if(d.preventDefault(),!t)return;if(d.dataTransfer.files&&d.dataTransfer.files.length>0){const R=d.dataTransfer.files[0];py(R,(y,v,T)=>{const k=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),O={id:Vn(),type:"image",position:k,data:{label:"Imagen",image:y},style:{width:v,height:T}};r(),n(z=>z.concat(O))});return}const h=d.dataTransfer.getData("text/uri-list")||d.dataTransfer.getData("text/plain");if(h&&(h.startsWith("data:image")||h.startsWith("http"))){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:Vn(),type:"image",position:R,data:{label:"Imagen Extrada",image:h},style:{width:300,height:300}};r(),n(v=>v.concat(y));return}const f=d.dataTransfer.getData("application/reactflow"),m=d.dataTransfer.getData("application/category");if(typeof f>"u"||!f)return;if(f==="stamp"){const R=d.dataTransfer.getData("application/category"),y=R==="custom",v=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),k=e.getIntersectingNodes({x:v.x,y:v.y,width:1,height:1}).slice().reverse().find(O=>O.type==="evidence"||O.type==="note"||O.type==="image");if(k){if(y){i(k.id),s(!0),o(null),a(null);return}r(),n(O=>O.map(z=>z.id===k.id?{...z,data:{...z.data,status:R}}:z))}return}if(f==="zone"){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:Vn(),type:"zone",position:R,data:{label:"ZONA SEGURA"},style:{width:300,height:300,backgroundColor:"rgba(113, 113, 122, 0.05)",borderColor:"#71717a"}};r(),n(v=>[y,...v]);return}if(f==="url"){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:Vn(),type:"url",position:R,data:{url:"",label:"Nuevo Enlace"},style:{width:300,height:250}};r(),n(v=>v.concat(y));return}const E=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),x={id:Vn(),type:f,position:E,data:{label:`Nuevo ${m}`,category:m,description:"Doble click para editar..."}};r(),n(R=>R.concat(x))},[e,n,t,r,i,s,o,a]);return{onDragOver:l,onDrop:c}},yy=({status:t})=>{if(typeof t=="object"&&t.type==="custom")return p.jsx("div",{className:"border-4 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif",borderColor:t.color,color:t.color,backgroundColor:`${t.color}30`},children:t.label});switch(t){case"solved":return p.jsx("div",{className:"border-4 border-green-600 text-green-600 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-green-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"RESUELTO"});case"discarded":return p.jsx("div",{className:"border-4 border-red-600 text-red-600 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-red-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"DESCARTADO"});case"key":return p.jsx("div",{className:"border-4 border-yellow-500 text-yellow-500 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-yellow-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"CLAVE"});case"question":return p.jsx("div",{className:"border-4 border-blue-500 text-blue-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-blue-950/30",children:p.jsx(mg,{size:40,strokeWidth:3})});case"important":return p.jsx("div",{className:"border-4 border-orange-500 text-orange-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-orange-950/30",children:p.jsx(cS,{size:40,strokeWidth:3})});case"verify":return p.jsx("div",{className:"border-4 border-purple-500 text-purple-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-purple-950/30",children:p.jsx(tS,{size:40,strokeWidth:3})});case"danger":return p.jsx("div",{className:"border-4 border-red-600 text-red-600 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-red-950/30",children:p.jsx(oS,{size:40,strokeWidth:3})});case"confidential":return p.jsx("div",{className:"border-4 border-zinc-500 text-zinc-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-zinc-950/30",children:p.jsx(ja,{size:40,strokeWidth:3})});default:return null}},ux={person:{color:"border-blue-500",icon:fy,dark:{bg:"bg-gradient-to-br from-blue-900 to-blue-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-blue-50 to-blue-100",text:"text-blue-900/70",title:"text-blue-950",border:"border-black/10"}},place:{color:"border-green-500",icon:nS,dark:{bg:"bg-gradient-to-br from-green-900 to-green-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-green-50 to-green-100",text:"text-green-900/70",title:"text-green-950",border:"border-black/10"}},clue:{color:"border-orange-500",icon:ly,dark:{bg:"bg-gradient-to-br from-orange-900 to-orange-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-orange-50 to-orange-100",text:"text-orange-900/70",title:"text-orange-950",border:"border-black/10"}},event:{color:"border-red-500",icon:JT,dark:{bg:"bg-gradient-to-br from-red-900 to-red-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-red-50 to-red-100",text:"text-red-900/70",title:"text-red-950",border:"border-black/10"}}},JM=({id:t,data:e,selected:n,isDarkMode:r})=>{const i=ux[e.category]||ux.clue,s=r?i.dark:i.light,o=i.icon,{setNodes:a}=Ur(),l=!!e.locked,[c,d]=D.useState(!1),h=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]),f=m=>{m.stopPropagation(),a(E=>E.map(x=>{if(x.id===t){const R=!!x.data.locked;return{...x,draggable:!0,data:{...x.data,locked:!R}}}return x}))};return p.jsxs("div",{className:`
        relative h-full w-full shadow-[0_10px_20px_-5px_rgba(0,0,0,0.6)] rounded-sm border-l-4 transition-all duration-300 ease-out group
        ${i.color} ${s.bg}
        ${n?"ring-2 ring-white scale-105 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.9)] z-50":"hover:scale-105 hover:-translate-y-1 hover:shadow-[0_20px_40px_-5px_rgba(0,0,0,0.8)] hover:z-40"}
        ${l?"nodrag":""} ${e.isDeleting?"deleting-default":""}
      `,children:[p.jsx(sl,{color:"#ef4444",isVisible:n&&!l,minWidth:250,minHeight:150,handleStyle:{width:15,height:15}}),(n||l)&&p.jsx("button",{onClick:f,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${l?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:l?p.jsx(al,{size:12}):p.jsx(ol,{size:12})}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(In,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(In,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${h}deg)`},children:p.jsx(yy,{status:e.status},JSON.stringify(e.status))}),p.jsxs("div",{className:"p-3 flex flex-col gap-2 h-full w-full overflow-hidden",children:[p.jsxs("div",{className:`flex items-center justify-between border-b ${s.border} pb-2`,children:[p.jsx("span",{className:`text-xs uppercase tracking-widest ${s.text} font-bold`,children:e.category}),p.jsx(o,{size:16,className:s.text})]}),e.image&&p.jsx("div",{className:`nodrag w-full h-32 overflow-hidden rounded-sm border ${s.border} sepia-[.5] cursor-zoom-in hover:sepia-0 transition-all`,onClick:m=>{m.stopPropagation(),d(!0)},children:p.jsx("img",{src:e.image,alt:"evidence",className:"w-full h-full object-cover"})}),c&&Uc.createPortal(p.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-8 cursor-zoom-out backdrop-blur-sm animate-in fade-in duration-200",onClick:m=>{m.stopPropagation(),d(!1)},children:p.jsx("img",{src:e.image,alt:"Evidence HD",className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm"})}),document.body),p.jsxs("div",{children:[p.jsx("h3",{className:`text-lg font-bold ${s.title} leading-tight font-mono`,children:e.label}),p.jsx("p",{className:`text-xs ${s.text} mt-1 font-mono leading-relaxed`,children:e.description})]})]})]})},ZM=D.memo(JM),Up={yellow:{bg:"from-yellow-100 to-yellow-300",btn:"bg-yellow-500"},green:{bg:"from-green-100 to-green-300",btn:"bg-green-500"},blue:{bg:"from-blue-100 to-blue-300",btn:"bg-blue-500"},red:{bg:"from-red-100 to-red-300",btn:"bg-red-500"},purple:{bg:"from-purple-100 to-purple-300",btn:"bg-purple-500"}},eL=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Ur(),o=!!e.locked,a=Up[e.color]||Up.yellow,l=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]),c=f=>{f.stopPropagation(),s(m=>m.map(E=>{if(E.id===t){const x=!!E.data.locked;return{...E,draggable:!0,data:{...E.data,locked:!x}}}return E}))},d=f=>{s(m=>m.map(E=>E.id===t?{...E,data:{...E.data,color:f}}:E))},h=()=>{s(f=>f.map(m=>m.id===t?{...m,data:{...m.data,status:null}}:m))};return p.jsxs(p.Fragment,{children:[p.jsx(sl,{color:"#eab308",isVisible:n&&!o,minWidth:150,minHeight:150,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{i({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(gs,{size:12})}),(n||o)&&p.jsx("button",{onClick:c,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${o?"bg-red-900 border-red-700 text-red-200":"bg-yellow-500 border-yellow-700 text-white hover:bg-yellow-600"}`,children:o?p.jsx(al,{size:12}):p.jsx(ol,{size:12})}),n&&!o&&p.jsxs("div",{className:`nodrag absolute -bottom-8 left-1/2 transform -translate-x-1/2 flex gap-1 p-1.5 rounded-full shadow-xl border z-50 backdrop-blur-sm ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[Object.entries(Up).map(([f,m])=>p.jsx("button",{onClick:()=>d(f),className:`w-4 h-4 rounded-full ${m.btn} border border-white/20 hover:scale-125 transition-transform`},f)),e.status&&p.jsx("button",{onClick:h,className:`w-4 h-4 rounded-full flex items-center justify-center border border-white/20 hover:scale-125 transition-transform ml-1 ${r?"bg-zinc-700 text-zinc-400 hover:text-white":"bg-gray-200 text-gray-500 hover:text-black"}`,title:"Quitar Sello",children:p.jsx(ay,{size:10})})]}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(In,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(In,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${l}deg)`},children:p.jsx(yy,{status:e.status},JSON.stringify(e.status))}),p.jsxs("div",{className:`relative h-full w-full bg-gradient-to-br ${a.bg} shadow-[5px_5px_15px_rgba(0,0,0,0.5)] rotate-1 p-4 note-rough border-t border-l border-white/50 flex flex-col transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-1 hover:shadow-[10px_15px_25px_rgba(0,0,0,0.6)] overflow-hidden ${o?"nodrag":""} ${e.isDeleting?"deleting-note":""}`,children:[p.jsx("div",{className:"absolute inset-0 paper-texture pointer-events-none opacity-50 mix-blend-multiply"}),p.jsx("textarea",{name:"note-content",className:"nodrag relative z-10 w-full h-full bg-transparent resize-none outline-none text-gray-800 placeholder-yellow-600/50 text-lg leading-relaxed",placeholder:"Escribe una nota...",defaultValue:e.label,onChange:f=>e.label=f.target.value,style:{fontFamily:'"Comic Sans MS", "Chalkboard SE", sans-serif'}})]})]})},tL=D.memo(eL),nL=({isOpen:t,onClose:e,imageSrc:n,onCropComplete:r})=>{const[i,s]=D.useState(1),[o,a]=D.useState({x:0,y:0}),[l,c]=D.useState(!1),[d,h]=D.useState({x:0,y:0}),f=D.useRef(null),m=D.useRef(null);if(D.useEffect(()=>{t&&(s(1),a({x:0,y:0}))},[t,n]),!t||!n)return null;const E=v=>{c(!0),h({x:v.clientX-o.x,y:v.clientY-o.y})},x=v=>{l&&a({x:v.clientX-d.x,y:v.clientY-d.y})},R=()=>{c(!1)},y=()=>{const v=document.createElement("canvas"),T=v.getContext("2d"),k=m.current,O=f.current,z=k.clientWidth,S=k.clientHeight;v.width=z,v.height=S;const b=z/2,w=S/2;T.translate(b+o.x,w+o.y),T.scale(i,i),T.drawImage(O,-O.naturalWidth/2,-O.naturalHeight/2),r(v.toDataURL("image/jpeg",.9)),e()};return p.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center p-4 animate-in fade-in duration-200 select-none",onMouseUp:R,onMouseLeave:R,children:[p.jsxs("div",{className:"w-full max-w-lg flex justify-between items-center mb-4",children:[p.jsxs("h2",{className:"text-zinc-100 font-mono font-bold text-lg flex items-center gap-2",children:[p.jsx(Tz,{size:18})," AJUSTAR RECORTE"]}),p.jsx("button",{onClick:e,className:"text-zinc-400 hover:text-white",children:p.jsx(gs,{})})]}),p.jsxs("div",{ref:m,className:"relative w-[400px] h-[400px] bg-zinc-900 overflow-hidden border-2 border-dashed border-zinc-500 cursor-move shadow-2xl rounded-sm",onMouseDown:E,onMouseMove:x,children:[p.jsx("img",{ref:f,src:n,alt:"Crop target",className:"absolute max-w-none origin-center pointer-events-none",style:{left:"50%",top:"50%",transform:`translate(-50%, -50%) translate(${o.x}px, ${o.y}px) scale(${i})`}}),p.jsxs("div",{className:"absolute inset-0 pointer-events-none opacity-30",children:[p.jsx("div",{className:"w-full h-1/3 border-b border-white/50 absolute top-0"}),p.jsx("div",{className:"w-full h-1/3 border-b border-white/50 absolute top-1/3"}),p.jsx("div",{className:"h-full w-1/3 border-r border-white/50 absolute left-0"}),p.jsx("div",{className:"h-full w-1/3 border-r border-white/50 absolute left-1/3"})]})]}),p.jsxs("div",{className:"mt-6 flex items-center gap-4 w-full max-w-md bg-zinc-900 p-4 rounded-lg border border-zinc-800",children:[p.jsx($z,{size:20,className:"text-zinc-400"}),p.jsx("input",{type:"range",name:"crop-scale",min:"0.1",max:"3",step:"0.05",value:i,onChange:v=>s(parseFloat(v.target.value)),className:"w-full accent-red-600 h-1 bg-zinc-700 rounded-lg appearance-none cursor-pointer"}),p.jsx(Fz,{size:20,className:"text-zinc-400"})]}),p.jsxs("div",{className:"mt-6 flex gap-4",children:[p.jsx("button",{onClick:e,className:"px-6 py-2 border border-zinc-600 text-zinc-300 hover:text-white rounded font-bold uppercase text-xs tracking-wider transition-colors",children:"Cancelar"}),p.jsxs("button",{onClick:y,className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold uppercase text-xs tracking-wider shadow-lg flex items-center gap-2 transition-colors",children:[p.jsx(ZT,{size:16})," Aplicar"]})]})]})},rL=({id:t,data:e,selected:n,isDarkMode:r})=>{const[i,s]=D.useState(e.image),[o,a]=D.useState(!1),[l,c]=D.useState(!1),[d,h]=D.useState(!1),[f,m]=D.useState(e.filters||{brightness:100,contrast:100,grayscale:0,sepia:0}),{deleteElements:E,setNodes:x,getNode:R}=Ur(),y=!!e.locked,v=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]);D.useEffect(()=>{e.filters&&m(e.filters)},[e.filters]),D.useEffect(()=>{if(e.image&&e.image.startsWith("http")){const I=new Image;I.crossOrigin="Anonymous",I.src=e.image,I.onload=()=>{try{const C=document.createElement("canvas");C.width=I.width,C.height=I.height,C.getContext("2d").drawImage(I,0,0);const A=C.toDataURL("image/jpeg");A.length>100&&(s(A),x(P=>P.map(F=>F.id===t?{...F,data:{...F.data,image:A}}:F)))}catch{}}}},[]);const T=I=>{I.stopPropagation(),x(C=>C.map(N=>{if(N.id===t){const A=!!N.data.locked;return{...N,draggable:!0,data:{...N.data,locked:!A}}}return N}))},k=I=>{const C=I.target.files[0];C&&py(C,(N,A,P)=>{s(N),x(F=>F.map(M=>M.id===t?{...M,data:{...M.data,image:N},style:{...M.style,width:A,height:P}}:M))})},O=I=>{if(!i)return;const C=new Image;C.src=i,C.onload=()=>{var j,L;const N=document.createElement("canvas");N.width=C.height,N.height=C.width;const A=N.getContext("2d");A.translate(N.width/2,N.height/2),A.rotate(I==="right"?90*Math.PI/180:-90*Math.PI/180),A.drawImage(C,-C.width/2,-C.height/2);const P=N.toDataURL();s(P);const F=R(t),M=(j=F==null?void 0:F.style)==null?void 0:j.width,$=(L=F==null?void 0:F.style)==null?void 0:L.height;x(B=>B.map(G=>G.id===t?{...G,data:{...G.data,image:P},style:{...G.style,width:$,height:M}}:G))}},z=()=>{c(!0)},S=I=>{s(I),x(C=>C.map(N=>N.id===t?{...N,data:{...N.data,image:I},style:{...N.style,width:300,height:300}}:N))},b=()=>{x(I=>I.map(C=>C.id===t?{...C,data:{...C.data,status:null}}:C))},w=(I,C)=>{const N={...f,[I]:C};m(N),x(A=>A.map(P=>P.id===t?{...P,data:{...P.data,filters:N}}:P))};return p.jsxs(p.Fragment,{children:[p.jsx(sl,{color:"#ef4444",isVisible:n&&!y,minWidth:100,minHeight:100,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{E({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(gs,{size:12})}),(n||y)&&p.jsx("button",{onClick:T,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${y?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:y?p.jsx(al,{size:12}):p.jsx(ol,{size:12})}),n&&!y&&i&&p.jsxs("div",{className:`nodrag absolute -bottom-9 left-1/2 transform -translate-x-1/2 flex gap-1 p-1.5 rounded-full shadow-xl border z-50 backdrop-blur-sm items-center ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[p.jsx("button",{onClick:()=>h(!d),className:`p-1.5 rounded-full transition-colors ${d?"bg-blue-600 text-white":r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Filtros",children:p.jsx(Oz,{size:14})}),p.jsx("div",{className:`w-px h-4 mx-0.5 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsx("button",{onClick:()=>O("left"),className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Rotar Izquierda",children:p.jsx(Pz,{size:14})}),p.jsx("button",{onClick:z,className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Recortar",children:p.jsx(dz,{size:14})}),p.jsx("button",{onClick:()=>O("right"),className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Rotar Derecha",children:p.jsx(Dz,{size:14})}),e.status&&p.jsx("button",{onClick:b,className:`p-1.5 text-red-500 hover:text-red-400 rounded-full transition-colors ${r?"hover:bg-zinc-700":"hover:bg-gray-200"}`,title:"Quitar Sello",children:p.jsx(ay,{size:14})})]}),d&&n&&!y&&p.jsxs("div",{className:`nodrag absolute -bottom-44 left-1/2 transform -translate-x-1/2 p-3 rounded-lg border z-50 w-48 backdrop-blur-sm flex flex-col gap-2 shadow-2xl animate-in fade-in slide-in-from-bottom-2 ${r?"bg-zinc-900/95 border-zinc-700":"bg-white/95 border-gray-200"}`,children:[p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Brillo"})," ",p.jsxs("span",{children:[f.brightness,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"200",value:f.brightness,onChange:I=>w("brightness",parseInt(I.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Contraste"})," ",p.jsxs("span",{children:[f.contrast,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"200",value:f.contrast,onChange:I=>w("contrast",parseInt(I.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"B/N"})," ",p.jsxs("span",{children:[f.grayscale,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"100",value:f.grayscale,onChange:I=>w("grayscale",parseInt(I.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Sepia"})," ",p.jsxs("span",{children:[f.sepia,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"100",value:f.sepia,onChange:I=>w("sepia",parseInt(I.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`})]}),p.jsx("div",{className:"tape-visual"}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(In,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(In,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${v}deg)`},children:p.jsx(yy,{status:e.status},JSON.stringify(e.status))}),p.jsx("div",{className:`h-full w-full ${i?"bg-zinc-100 p-2 pb-10 rotate-1 hover:rotate-0":r?"bg-zinc-900/50 border-zinc-700 hover:border-zinc-500":"bg-gray-200/50 border-gray-400 hover:border-gray-500"} shadow-[0_10px_20px_-5px_rgba(0,0,0,0.7)] flex items-center justify-center overflow-hidden rounded-sm relative group transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-1 hover:shadow-[0_25px_50px_-12px_rgba(0,0,0,0.9)] ${y?"nodrag":""} ${e.isDeleting?"deleting-image":""} border-2 border-dashed`,children:i?p.jsxs("div",{className:"w-full h-full cursor-zoom-in",onClick:I=>{I.stopPropagation(),a(!0)},children:[p.jsx("img",{src:i,alt:"evidence",className:"w-full h-full object-cover border border-zinc-200",style:{filter:`brightness(${f.brightness}%) contrast(${f.contrast}%) grayscale(${f.grayscale}%) sepia(${f.sepia}%)`}}),p.jsx("div",{className:"absolute bottom-0 left-0 w-full h-10 flex items-center justify-center px-2",children:p.jsx("input",{type:"text",name:"image-caption",className:"nodrag w-full bg-transparent text-center text-zinc-800 text-xs outline-none placeholder-zinc-400/50 border-none p-0",placeholder:"",defaultValue:e.caption,onChange:I=>e.caption=I.target.value,onClick:I=>I.stopPropagation(),style:{fontFamily:'"Comic Sans MS", "Chalkboard SE", cursive'}})})]}):p.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full p-2 gap-1",children:[p.jsxs("label",{className:`nodrag cursor-pointer flex flex-col items-center gap-1 transition-colors ${r?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,children:[p.jsx(cy,{size:24}),p.jsx("span",{className:"text-[10px] font-mono uppercase text-center",children:"Subir Local"}),p.jsx("input",{type:"file",name:"upload-image",className:"hidden",accept:"image/*",onChange:k})]}),p.jsx("div",{className:`text-[10px] font-mono ${r?"text-zinc-600":"text-zinc-400"}`,children:"- O -"}),p.jsx("input",{type:"text",name:"image-url",placeholder:"Pegar URL...",className:`nodrag w-full border text-[10px] p-1 rounded outline-none focus:border-purple-500 font-mono text-center ${r?"bg-zinc-950 border-zinc-700 text-zinc-300":"bg-white border-gray-300 text-zinc-700"}`,onKeyDown:I=>{if(I.key==="Enter"){const C=I.currentTarget.value;s(C),e.image=C;const N=new Image;N.crossOrigin="Anonymous",N.onload=()=>{try{const A=document.createElement("canvas");A.width=N.width,A.height=N.height,A.getContext("2d").drawImage(N,0,0);const F=A.toDataURL("image/jpeg");s(F),x(M=>M.map($=>$.id===t?{...$,data:{...$.data,image:F}}:$))}catch(A){console.warn("CORS blocked",A)}},N.src=C}}})]})}),o&&Uc.createPortal(p.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-8 cursor-zoom-out backdrop-blur-sm animate-in fade-in duration-200",onClick:I=>{I.stopPropagation(),a(!1)},children:p.jsx("img",{src:i,alt:"Evidence HD",className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm",style:{filter:`brightness(${f.brightness}%) contrast(${f.contrast}%) grayscale(${f.grayscale}%) sepia(${f.sepia}%)`}})}),document.body),l&&Uc.createPortal(p.jsx(nL,{isOpen:l,onClose:()=>c(!1),imageSrc:i,onCropComplete:S}),document.body)]})},iL=D.memo(rL),sL=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Ur(),o=!!e.locked,a=h=>{h.stopPropagation(),s(f=>f.map(m=>{if(m.id===t){const E=!!m.data.locked;return{...m,draggable:!0,data:{...m.data,locked:!E}}}return m}))},l=(h,f)=>{s(m=>m.map(E=>E.id===t?{...E,data:{...E.data,[h]:f}}:E))},c=["#e5e5e5","#18181b","#ef4444","#3b82f6","#22c55e","#eab308"],d=[{label:"S",val:"14px"},{label:"M",val:"24px"},{label:"L",val:"36px"},{label:"XL",val:"48px"}];return p.jsxs(p.Fragment,{children:[p.jsx(sl,{color:"#71717a",isVisible:n&&!o,minWidth:100,minHeight:30,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{i({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(gs,{size:12})}),(n||o)&&p.jsx("button",{onClick:a,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${o?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:o?p.jsx(al,{size:12}):p.jsx(ol,{size:12})}),n&&!o&&p.jsxs("div",{className:`nodrag absolute -bottom-10 left-1/2 transform -translate-x-1/2 flex flex-col gap-1 p-1.5 rounded-lg shadow-xl border z-50 backdrop-blur-sm items-center ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[p.jsx("div",{className:"flex gap-1",children:c.map(h=>p.jsx("button",{onClick:()=>l("color",h),className:"w-4 h-4 rounded-full border border-white/20 hover:scale-125 transition-transform",style:{backgroundColor:h}},h))}),p.jsx("div",{className:`flex gap-1 border-t pt-1 mt-0.5 ${r?"border-white/10":"border-black/10"}`,children:d.map(h=>p.jsx("button",{onClick:()=>l("fontSize",h.val),className:`text-[8px] px-1 font-mono border rounded ${r?"text-zinc-300 hover:text-white border-zinc-700 bg-zinc-800 hover:bg-zinc-700":"text-zinc-600 hover:text-black border-gray-300 bg-gray-100 hover:bg-gray-200"}`,children:h.label},h.label))})]}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(In,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(In,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),p.jsx("div",{className:`h-full w-full p-2 flex items-center justify-center overflow-hidden border border-transparent hover:border-zinc-700/50 rounded transition-colors ${o?"nodrag":""} ${e.isDeleting?"deleting-default":""}`,children:p.jsx("textarea",{name:"text-content",className:`nodrag w-full h-full bg-transparent resize-none outline-none font-bold text-center p-2 ${e.color?"":"text-node-content text-gray-200"}`,placeholder:"Escribe un ttulo...",defaultValue:e.label,onChange:h=>e.label=h.target.value,style:{fontFamily:'"Courier Prime", monospace',color:e.color,fontSize:e.fontSize||"24px"}})})]})},oL=D.memo(sL),aL=({id:t,data:e,selected:n,style:r,isDarkMode:i})=>{const{setNodes:s}=Ur(),o=(r==null?void 0:r.borderColor)||"#71717a",a=(r==null?void 0:r.backgroundColor)||(i?"rgba(113, 113, 122, 0.05)":"rgba(100, 116, 139, 0.05)"),l=!!e.locked,c=d=>{d.stopPropagation(),s(h=>h.map(f=>{if(f.id===t){const m=!!f.data.locked;return{...f,draggable:m,data:{...f.data,locked:!m}}}return f}))};return p.jsxs(p.Fragment,{children:[p.jsx(sl,{color:o,isVisible:n&&!l,minWidth:150,minHeight:150}),(n||l)&&p.jsx("button",{onClick:c,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${l?"bg-red-900 border-red-700 text-red-200":i?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:l?p.jsx(al,{size:12}):p.jsx(ol,{size:12})}),p.jsx("div",{className:`h-full w-full border-2 border-dashed rounded-xl transition-colors ${l?"nodrag":""} ${e.isDeleting?"deleting-zone":""}`,style:{borderColor:o,backgroundColor:a},children:p.jsx("div",{className:`absolute -top-3 left-4 px-2 py-0.5 rounded text-[10px] font-mono uppercase tracking-widest select-none whitespace-nowrap shadow-sm ${i?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-white border border-gray-300 text-gray-600"}`,children:e.label})})]})},lL=D.memo(aL),cL=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Ur(),[o,a]=D.useState(e.url||""),[l,c]=D.useState(!e.url),d=!!e.showIframe,[h,f]=D.useState(!1),[m,E]=D.useState(0),[x,R]=D.useState(null),[y,v]=D.useState(!0),[T,k]=D.useState(!1),O=!!e.locked,z=D.useMemo(()=>{if(!e.url)return"";try{const P=new URL(e.url);if(P.hostname.includes("youtube.com")||P.hostname.includes("youtu.be")){let M=null;if(P.hostname.includes("youtu.be"))M=P.pathname.slice(1);else if(P.searchParams.has("v"))M=P.searchParams.get("v");else if(P.pathname.startsWith("/embed/"))return e.url;if(M)return`https://www.youtube.com/embed/${M}?rel=0&modestbranding=1&iv_load_policy=3&controls=1&playsinline=1&loop=1&playlist=${M}`}}catch{}return e.url},[e.url]),S=e.url?`https://s.wordpress.com/mshots/v1/${encodeURIComponent(e.url)}?w=400&v=${m}`:null,b=S?`https://wsrv.nl/?url=${encodeURIComponent(S)}`:null;D.useEffect(()=>{if(R(null),!b)return;(F=>{const M=new Image;M.crossOrigin="Anonymous",M.referrerPolicy="no-referrer",M.src=F,M.onload=()=>{try{const $=document.createElement("canvas");$.width=M.width,$.height=M.height,$.getContext("2d").drawImage(M,0,0);const L=$.toDataURL("image/jpeg");R(L),v(!1)}catch{v(!1),k(!0)}},M.onerror=()=>{v(!1),k(!0)}})(b)},[b]);const w=P=>{P.stopPropagation(),s(F=>F.map(M=>{if(M.id===t){const $=!!M.data.locked;return{...M,draggable:$,data:{...M.data,locked:!$}}}return M}))},I=()=>{let P=o;P&&!P.startsWith("http")&&(P="https://"+P),s(F=>F.map(M=>M.id===t?{...M,data:{...M.data,url:P,showIframe:!1}}:M)),c(!1),f(!1),k(!1),v(!0)},C=()=>{c(!0),f(!1),k(!1),v(!0)},N=P=>{P.stopPropagation(),E(F=>F+1),f(!1),k(!1),v(!0)},A=()=>{const P=!d;f(!1),s(F=>F.map(M=>M.id===t?{...M,data:{...M.data,showIframe:P}}:M))};return p.jsxs(p.Fragment,{children:[p.jsx(sl,{color:"#3b82f6",isVisible:n&&!O,minWidth:200,minHeight:100}),n&&p.jsx("button",{onClick:()=>i({nodes:[{id:t}]}),className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(gs,{size:12})}),(n||O)&&p.jsx("button",{onClick:w,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${O?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:O?p.jsx(al,{size:12}):p.jsx(ol,{size:12})}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(In,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(In,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),p.jsxs("div",{className:`relative w-full h-full rounded-lg overflow-hidden border-2 transition-all shadow-lg flex flex-col ${r?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} ${O?"nodrag":""} ${e.isDeleting?"deleting-default":""}`,children:[p.jsxs("div",{className:`h-8 flex items-center px-2 gap-2 border-b ${r?"bg-zinc-800 border-zinc-700":"bg-gray-100 border-gray-200"}`,children:[p.jsx(vz,{size:14,className:"text-blue-500"}),p.jsx("span",{className:`text-[10px] font-mono truncate flex-1 ${r?"text-zinc-400":"text-gray-600"}`,children:e.url?new URL(e.url).hostname:"ENLACE WEB"}),!l&&p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:A,className:`text-zinc-500 transition-colors ${d?"text-blue-500":"hover:text-blue-500"}`,title:d?"Ver miniatura":"Ver interactivo",children:p.jsx(Iz,{size:12})}),p.jsx("button",{onClick:N,className:"text-zinc-500 hover:text-green-500 transition-colors",title:"Actualizar miniatura",children:p.jsx(hy,{size:12})}),p.jsx("button",{onClick:C,className:"text-zinc-500 hover:text-blue-500 transition-colors",children:p.jsx(Az,{size:12})})]})]}),p.jsx("div",{className:"flex-1 relative bg-black/5 group",children:l?p.jsxs("div",{className:"p-4 flex flex-col gap-2 h-full justify-center",children:[p.jsx("input",{type:"text",name:"url-input",value:o,onChange:P=>a(P.target.value),placeholder:"https://ejemplo.com",className:`nodrag w-full text-xs p-2 rounded border outline-none font-mono ${r?"bg-zinc-950 border-zinc-700 text-white":"bg-white border-gray-300 text-black"}`,onKeyDown:P=>P.key==="Enter"&&I()}),p.jsx("button",{onClick:I,className:"bg-blue-600 text-white text-xs py-1 rounded hover:bg-blue-500 font-bold uppercase",children:"Guardar"})]}):p.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[p.jsx("div",{className:"flex-1 relative overflow-hidden bg-zinc-200 dark:bg-zinc-800 min-h-0",children:d?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:`absolute top-0 left-0 w-full py-1 px-2 flex flex-col gap-1 items-center justify-center z-20 ${r?"bg-zinc-950/80":"bg-white/80"} backdrop-blur-[2px]`,children:p.jsx("span",{className:`text-[9px] leading-tight text-center select-none ${r?"text-zinc-400":"text-zinc-600"}`,children:"Si no carga, el sitio bloquea la conexin."})}),p.jsx("iframe",{src:z,className:"w-full h-full border-none relative z-10 bg-white",title:"Embedded Content",loading:"lazy",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation allow-modals allow-popups-to-escape-sandbox",onError:P=>{console.warn("Error loading iframe:",e.url),P.target.style.display="none"}},m)]}):p.jsxs(p.Fragment,{children:[y&&e.url&&p.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-4 text-center z-20",children:p.jsx("div",{className:"w-6 h-6 border-2 border-zinc-400 border-t-transparent rounded-full animate-spin"})}),x&&!T&&p.jsx("img",{src:x,alt:"Preview",className:"w-full h-full object-cover opacity-90 hover:opacity-100 transition-opacity"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(!e.url||T)&&p.jsx(uy,{size:32,className:"text-zinc-400"})})]})}),p.jsxs("a",{href:e.url,target:"_blank",rel:"noopener",draggable:"false",onDragStart:P=>P.preventDefault(),className:`nodrag h-10 shrink-0 flex items-center justify-center gap-2 text-xs font-bold uppercase transition-colors z-10 relative ${r?"bg-zinc-800 hover:bg-zinc-700 text-blue-400":"bg-gray-200 hover:bg-gray-300 text-zinc-900"}`,children:[p.jsx(pz,{size:14})," Visitar Sitio"]})]})})]})]})},uL=D.memo(cL),Cf=({id:t,sourceX:e,sourceY:n,targetX:r,targetY:i,sourcePosition:s,targetPosition:o,style:a={},markerEnd:l,label:c,type:d,className:h})=>{let f="",m=0,E=0;const x={sourceX:e,sourceY:n,targetX:r,targetY:i,sourcePosition:s,targetPosition:o};return d==="straight"?[f,m,E]=aT(x):d==="step"?[f,m,E]=Yc({...x,borderRadius:0}):d==="smoothstep"?[f,m,E]=Yc(x):[f,m,E]=ty(x),p.jsxs(p.Fragment,{children:[p.jsx(il,{path:f,markerEnd:l,style:a,className:h}),c&&p.jsx(wO,{children:p.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${m}px,${E}px)`,pointerEvents:"all"},className:"nodrag nopan",children:p.jsx("div",{className:"custom-edge-label",children:c})})})]})},dL=t=>p.jsx(Cf,{...t,type:"straight"}),hL=t=>p.jsx(Cf,{...t,type:"step"}),fL=t=>p.jsx(Cf,{...t,type:"smoothstep"}),pL=t=>p.jsx(Cf,{...t,type:"default"}),wS=D.createContext(!0),Ko=t=>e=>{const n=D.useContext(wS);return D.createElement(t,{...e,isDarkMode:n})},mL={evidence:Ko(ZM),note:Ko(tL),image:Ko(iL),text:Ko(oL),zone:Ko(lL),url:Ko(uL)},gL={default:pL,straight:dL,step:hL,smoothstep:fL},yL=({connectionColor:t})=>{const e=D.useMemo(()=>({hideAttribution:!0}),[]),n=D.useMemo(()=>({stroke:t,strokeWidth:2}),[t]),r=D.useCallback(i=>{switch(i.type){case"evidence":switch(i.data.category){case"person":return"#3b82f6";case"place":return"#22c55e";case"clue":return"#f97316";case"event":return"#ef4444";default:return"#ef4444"}case"note":return"#eab308";case"image":return"#a855f7";case"text":return"#71717a";default:return"#ef4444"}},[]);return{nodeTypes:mL,edgeTypes:gL,proOptions:e,connectionLineStyle:n,nodeColor:r}},vL=(t,e,n,r)=>{const[i,s]=D.useState([]),[o,a]=D.useState([]),l=D.useCallback(()=>{s(f=>[...f,{nodes:t,edges:e}]),a([])},[t,e]),c=D.useCallback(()=>{if(i.length===0)return;const f=i[i.length-1],m=i.slice(0,i.length-1);a(E=>[{nodes:t,edges:e},...E]),s(m),n(f.nodes),r(f.edges)},[i,t,e,n,r]),d=D.useCallback(()=>{if(o.length===0)return;const f=o[0],m=o.slice(1);s(E=>[...E,{nodes:t,edges:e}]),a(m),n(f.nodes),r(f.edges)},[o,t,e,n,r]),h=D.useCallback(()=>{s([]),a([])},[]);return{takeSnapshot:l,undo:c,redo:d,clearHistory:h,canUndo:i.length>0,canRedo:o.length>0}},_L=({nodes:t,edges:e,setNodes:n,setEdges:r,onNodesChange:i,onEdgesChange:s})=>{const{takeSnapshot:o,undo:a,redo:l,clearHistory:c}=vL(t,e,n,r),d=D.useCallback(E=>{n(x=>{var y;const R=x.find(v=>v.id===E);return!R||(y=R.data)!=null&&y.isDeleting?x:(setTimeout(()=>{n(v=>{var k;const T=v.find(O=>O.id===E);return T&&((k=T.data)!=null&&k.isDeleting)?v.filter(O=>O.id!==E):v}),r(v=>v.filter(T=>T.source!==E&&T.target!==E))},500),x.map(v=>v.id===E?{...v,data:{...v.data,isDeleting:!0}}:v))})},[n,r]),h=D.useCallback(E=>{r(x=>{var y;const R=x.find(v=>v.id===E);return!R||(y=R.className)!=null&&y.includes("deleting-edge")?x:(setTimeout(()=>{r(v=>v.filter(T=>T.id!==E))},300),x.map(v=>v.id===E?{...v,className:`${v.className||""} deleting-edge`}:v))})},[r]),f=D.useCallback(E=>{const x=E.filter(y=>y.type!=="remove"),R=E.filter(y=>y.type==="remove");R.length>0&&(o(),R.forEach(y=>d(y.id))),x.length>0&&i(x)},[i,o,d]),m=D.useCallback(E=>{const x=E.filter(y=>y.type!=="remove"),R=E.filter(y=>y.type==="remove");R.length>0&&(o(),R.forEach(y=>h(y.id))),x.length>0&&s(x)},[s,o,h]);return{takeSnapshot:o,undo:a,redo:l,clearHistory:c,onNodesChangeWithHistory:f,onEdgesChangeWithHistory:m,animateAndRemoveNode:d,animateAndRemoveEdge:h}},wL=(t,e,n,r,i)=>{const[s,o]=D.useState(null),a=D.useRef(null),l=D.useCallback(c=>{if(c.button!==2||!n||c.target.closest(".react-flow__node")||c.target.closest(".react-flow__edge")||c.target.closest(".react-flow__controls")||c.target.closest(".react-flow__minimap"))return;c.preventDefault();const{left:d,top:h}=t.current.getBoundingClientRect(),f=c.clientX-d,m=c.clientY-h;a.current={startX:f,startY:m,x:f,y:m,width:0,height:0,isDragging:!1};const E=R=>{if(R.buttons===0){x(R);return}if(!a.current||!t.current)return;const y=t.current.getBoundingClientRect(),v=R.clientX-y.left,T=R.clientY-y.top,k=Math.min(a.current.startX,v),O=Math.min(a.current.startY,T),z=Math.abs(v-a.current.startX),S=Math.abs(T-a.current.startY);(z>5||S>5)&&(a.current={...a.current,x:k,y:O,width:z,height:S,isDragging:!0},o({...a.current}))},x=R=>{var T;window.removeEventListener("pointermove",E),window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",x);const y=(T=a.current)==null?void 0:T.isDragging,v=a.current;if(a.current=null,o(null),!y)r(R);else if(v&&e){const k=t.current.getBoundingClientRect(),O=e.screenToFlowPosition({x:k.left+v.x,y:k.top+v.y}),z=e.screenToFlowPosition({x:k.left+v.x+v.width,y:k.top+v.y+v.height}),S={x:Math.min(O.x,z.x),y:Math.min(O.y,z.y),width:Math.abs(z.x-O.x),height:Math.abs(z.y-O.y)},b=e.getNodes().filter(w=>{var P,F,M,$;const I=w.width??((P=w.measured)==null?void 0:P.width)??200,C=w.height??((F=w.measured)==null?void 0:F.height)??150,N=((M=w.positionAbsolute)==null?void 0:M.x)??w.position.x,A=(($=w.positionAbsolute)==null?void 0:$.y)??w.position.y;return S.x<N+I&&S.x+S.width>N&&S.y<A+C&&S.y+S.height>A});i(w=>w.map(I=>({...I,selected:b.some(C=>C.id===I.id)||R.shiftKey&&I.selected})))}};window.addEventListener("pointermove",E),window.addEventListener("pointerup",x),window.addEventListener("pointercancel",x)},[n,r,e,i,t]);return{selectionRect:s,handleRightPointerDown:l}},xL=({isInteractive:t,reactFlowInstance:e,reactFlowWrapper:n,setEdges:r,setNodes:i,connectionLineType:s,connectionColor:o,takeSnapshot:a,setEditingNode:l,setEditingEdge:c,setInputModalOpen:d,setEditModalOpen:h,setMenu:f})=>{const m=D.useCallback(b=>{a(),r(w=>cT({...b,type:s,style:{stroke:o,strokeWidth:2}},w))},[r,o,a,s]),E=D.useCallback((b,w)=>{b.preventDefault(),b.stopPropagation(),t&&(l(null),c(w),d(!0))},[t,l,c,d]),x=D.useCallback((b,w)=>{t&&(a(),r(I=>I.map(C=>{var N;if(C.id===w.id){const A=(N=C.style)==null?void 0:N.strokeDasharray;return{...C,style:{...C.style,strokeDasharray:A?void 0:"10,10"}}}return C})))},[r,t,a]),R=D.useCallback(()=>f(null),[f]),y=D.useCallback(b=>{if(b.preventDefault(),!t)return;const w=n.current.getBoundingClientRect();f({top:b.clientY<w.bottom-200?b.clientY-w.top:void 0,left:b.clientX<w.right-200?b.clientX-w.left:void 0,right:b.clientX>=w.right-200?w.width-(b.clientX-w.left):void 0,bottom:b.clientY>=w.bottom-200?w.height-(b.clientY-w.top):void 0,clientX:b.clientX,clientY:b.clientY})},[t,n,f]),{selectionRect:v,handleRightPointerDown:T}=wL(n,e,t,y,i),k=D.useCallback((b,w)=>{w.type==="evidence"?(l(w),h(!0)):w.type==="zone"&&(c(null),l(w),d(!0))},[l,h,c,d]),O=D.useCallback((b,w)=>{a(),w.type!=="zone"&&i(I=>{const C=I.findIndex(P=>P.id===w.id);if(C===I.length-1)return I;const N=[...I],[A]=N.splice(C,1);return N.push(A),N})},[a,i]),z=D.useCallback(()=>{n.current&&n.current.classList.add("is-moving")},[n]),S=D.useCallback(()=>{n.current&&n.current.classList.remove("is-moving")},[n]);return{onConnect:m,onEdgeContextMenu:E,onEdgeClick:x,onPaneClick:R,onPaneContextMenu:y,onNodeDoubleClick:k,onNodeDragStart:O,onMoveStart:z,onMoveEnd:S,selectionRect:v,handleRightPointerDown:T}},bL=({reactFlowInstance:t,boards:e,currentBoardId:n,bgType:r,setBoards:i,setNodes:s,setEdges:o,setBgType:a,handleSwitchBoard:l,clearHistory:c,takeSnapshot:d,setConfirmModal:h})=>{const f=D.useCallback(()=>{if(t){const R={...t.toObject(),bgType:r},y=new Blob([JSON.stringify(R,null,2)],{type:"application/json"}),v=URL.createObjectURL(y),T=document.createElement("a");T.href=v;const k=e.find(z=>z.id===n),O=k?k.name.replace(/[^a-z0-9\u00C0-\u017F\s-_]/gi,""):"caso-detective";T.download=`${O}.json`,T.click(),URL.revokeObjectURL(v)}},[t,e,n,r]),m=D.useCallback(x=>{const R=x.target.files[0];if(!R)return;const y=R.name.replace(/\.json$/i,""),v=new FileReader;v.onload=T=>{try{const k=JSON.parse(T.target.result);if(k&&(k.nodes||k.edges)){const O=k.nodes||[],z=k.edges||[],S=k.bgType||"cork",b=e.find(w=>w.name===y);if(b)h({isOpen:!0,title:"SOBRESCRIBIR CASO?",message:`Ya existe un caso llamado "${y}". Deseas sobrescribir sus datos con este archivo?`,confirmText:"Sobrescribir",cancelText:"Cancelar",isDanger:!0,onConfirm:()=>{localStorage.setItem(`board-${b.id}-nodes`,JSON.stringify(O)),localStorage.setItem(`board-${b.id}-edges`,JSON.stringify(z)),localStorage.setItem(`board-${b.id}-bg`,S),b.id===n?(s(O),o(z),a(S),c()):l(b.id)}});else{const w=Vn(),I={id:w,name:y,createdAt:Date.now(),lastModified:Date.now()};localStorage.setItem(`board-${w}-nodes`,JSON.stringify(O)),localStorage.setItem(`board-${w}-edges`,JSON.stringify(z)),localStorage.setItem(`board-${w}-bg`,S),i(C=>[...C,I]),l(w)}}}catch(k){console.error("Error al cargar el caso",k),alert("El archivo no es vlido.")}},v.readAsText(R),x.target.value=""},[e,n,s,o,a,l,i,h,c]),E=D.useCallback(()=>{h({isOpen:!0,title:"LIMPIAR TABLERO?",message:"Ests seguro de que quieres eliminar todo el contenido del tablero? Esta accin no se puede deshacer.",onConfirm:()=>{d(),s([]),o([])},isDanger:!0})},[d,s,o,h]);return{onSave:f,onLoad:m,onClear:E}},EL=({searchTerm:t,setNodes:e,reactFlowInstance:n})=>(D.useEffect(()=>{if(e(i=>i.map(s=>{var c,d;if(!t)return{...s,style:{...s.style,opacity:1}};const o=((c=s.data.label)==null?void 0:c.toLowerCase())||"",a=((d=s.data.description)==null?void 0:d.toLowerCase())||"",l=o.includes(t.toLowerCase())||a.includes(t.toLowerCase());return{...s,style:{...s.style,opacity:l?1:.1}}})),t&&t.length>1&&n){const s=n.getNodes().find(o=>{var c,d;const a=((c=o.data.label)==null?void 0:c.toLowerCase())||"",l=((d=o.data.description)==null?void 0:d.toLowerCase())||"";return a.includes(t.toLowerCase())||l.includes(t.toLowerCase())});s&&n.setCenter(s.position.x+(s.width||0)/2,s.position.y+(s.height||0)/2,{zoom:1.5,duration:800})}},[t,e,n]),{navigateSearch:D.useCallback(i=>{if(!t||!n)return;const o=n.getNodes().filter(f=>{var x,R;const m=((x=f.data.label)==null?void 0:x.toLowerCase())||"",E=((R=f.data.description)==null?void 0:R.toLowerCase())||"";return m.includes(t.toLowerCase())||E.includes(t.toLowerCase())});if(o.length===0)return;const a=o.findIndex(f=>f.selected);let l=i==="next"?a+1:a-1;l>=o.length&&(l=0),l<0&&(l=o.length-1);const c=o[l];e(f=>f.map(m=>({...m,selected:m.id===c.id})));const d=c.width||150,h=c.height||50;n.setCenter(c.position.x+d/2,c.position.y+h/2,{zoom:1.5,duration:600})},[t,n,e])}),IL=t=>{const[e,n]=D.useState("#dc2626"),[r,i]=D.useState("straight"),[s,o]=D.useState(!0),[a,l]=D.useState(!0),[c,d]=D.useState(""),[h,f]=D.useState(!0),[m,E]=D.useState(!1),[x,R]=D.useState(t),y=D.useCallback(()=>{const v=["cork","blackboard","paper"];R(T=>v[(v.indexOf(T)+1)%v.length])},[]);return{connectionColor:e,setConnectionColor:n,connectionLineType:r,setConnectionLineType:i,isInteractive:s,setIsInteractive:o,isDarkMode:a,setIsDarkMode:l,searchTerm:c,setSearchTerm:d,isSidebarOpen:h,setIsSidebarOpen:f,isZenMode:m,setIsZenMode:E,bgType:x,setBgType:R,toggleBackground:y}},TL=({reactFlowInstance:t,setNodes:e,setEdges:n,takeSnapshot:r,animateAndRemoveNode:i,animateAndRemoveEdge:s,setEditModalOpen:o,setEditingNode:a,setEditingEdge:l,setInputModalOpen:c,setConnectionColor:d,setConnectionLineType:h,setPendingStampNodeId:f})=>{const m=D.useCallback((O,z)=>{r(),e(S=>S.map(b=>b.id===O?{...b,data:z}:b))},[e,r]),E=D.useCallback(O=>{r(),i(O),o(!1),a(null)},[i,r,o,a]),x=D.useCallback(()=>{if(!t)return;const O=t.getNodes().filter(z=>z.selected);if(O.length>0){r();const z=new Map,S=O.map(I=>{const C=Vn();return z.set(I.id,C),{...I,id:C,position:{x:I.position.x+50,y:I.position.y+50},selected:!0,data:{...I.data}}}),w=t.getEdges().filter(I=>z.has(I.source)&&z.has(I.target)).map(I=>({...I,id:Vn(),source:z.get(I.source),target:z.get(I.target),selected:!0}));e(I=>I.map(C=>({...C,selected:!1})).concat(S)),n(I=>I.map(C=>({...C,selected:!1})).concat(w))}},[t,e,n,r]),R=D.useCallback(O=>{d(O),n(z=>z.map(S=>S.selected?{...S,style:{...S.style,stroke:O}}:S))},[n,d]),y=D.useCallback(O=>{h(O),n(z=>z.map(S=>S.selected?{...S,type:O}:S))},[n,h]),v=D.useCallback((O,z,S,b)=>{b&&(r(),n(w=>w.map(I=>I.id===b.id?{...I,label:O,type:S||I.type,style:{...I.style,stroke:z},labelStyle:void 0,labelBgStyle:void 0}:I)),l(null))},[n,r,l]),T=D.useCallback((O,z)=>{O?(r(),s(O.id),l(null),c(!1)):z&&z.type==="zone"&&(E(z.id),c(!1))},[s,E,r,l,c]),k=D.useCallback((O,z,S,b,w,I)=>{b?v(O,z,S,b):w&&w.type==="zone"?(r(),e(C=>C.map(N=>N.id===w.id?{...N,data:{...N.data,label:O},style:{...N.style,borderColor:z,backgroundColor:`${z}10`}}:N)),a(null),c(!1)):I&&(r(),e(C=>C.map(N=>N.id===I?{...N,data:{...N.data,status:{type:"custom",label:O||"SELLO",color:z}}}:N)),f(null),c(!1))},[v,e,r,a,c,f]);return{handleSaveNode:m,handleDeleteNode:E,duplicateSelected:x,handleConnectionColorChange:R,handleConnectionLineTypeChange:y,handleEdgeLabelSave:v,handleEdgeDelete:T,handleInputModalConfirm:k}};var dx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},SL=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},bS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):SL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new CL;const f=s<<2|a>>4;if(r.push(f),c!==64){const m=a<<4&240|c>>2;if(r.push(m),h!==64){const E=c<<6&192|h;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class CL extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const AL=function(t){const e=xS(t);return bS.encodeByteArray(e,!0)},ES=function(t){return AL(t).replace(/\./g,"")},IS=function(t){try{return bS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RL=()=>kL().__FIREBASE_DEFAULTS__,NL=()=>{if(typeof process>"u"||typeof dx>"u")return;const t=dx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},PL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&IS(t[1]);return e&&JSON.parse(e)},Af=()=>{try{return RL()||NL()||PL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},DL=t=>{var e,n;return(n=(e=Af())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},TS=()=>{var t;return(t=Af())===null||t===void 0?void 0:t.config},SS=t=>{var e;return(e=Af())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VL{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function St(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function OL(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(St())}function zL(){var t;const e=(t=Af())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ML(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function CS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function LL(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function jL(){const t=St();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function AS(){return!zL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function vy(){try{return typeof indexedDB=="object"}catch{return!1}}function kS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function FL(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $L="FirebaseError";class Er extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=$L,Object.setPrototypeOf(this,Er.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_o.prototype.create)}}class _o{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?UL(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new Er(i,a,r)}}function UL(t,e){return t.replace(BL,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const BL=/\{\$([^}]+)}/g;function qL(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Fa(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(hx(s)&&hx(o)){if(!Fa(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function hx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _u(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function tc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function nc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function HL(t,e){const n=new KL(t,e);return n.subscribe.bind(n)}class KL{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");GL(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Bp),i.error===void 0&&(i.error=Bp),i.complete===void 0&&(i.complete=Bp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function GL(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Bp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WL=1e3,QL=2,YL=4*60*60*1e3,XL=.5;function fx(t,e=WL,n=QL){const r=e*Math.pow(n,t),i=Math.round(XL*r*(Math.random()-.5)*2);return Math.min(YL,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ct(t){return t&&t._delegate?t._delegate:t}class xr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JL{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new VL;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(e3(e))try{this.getOrInitializeService({instanceIdentifier:Ps})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ps){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ps){return this.instances.has(e)}getOptions(e=Ps){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ZL(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ps){return this.component?this.component.multipleInstances?e:Ps:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ZL(t){return t===Ps?void 0:t}function e3(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t3{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new JL(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Re;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Re||(Re={}));const n3={debug:Re.DEBUG,verbose:Re.VERBOSE,info:Re.INFO,warn:Re.WARN,error:Re.ERROR,silent:Re.SILENT},r3=Re.INFO,i3={[Re.DEBUG]:"log",[Re.VERBOSE]:"log",[Re.INFO]:"info",[Re.WARN]:"warn",[Re.ERROR]:"error"},s3=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=i3[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kf{constructor(e){this.name=e,this._logLevel=r3,this._logHandler=s3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Re))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?n3[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Re.DEBUG,...e),this._logHandler(this,Re.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Re.VERBOSE,...e),this._logHandler(this,Re.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Re.INFO,...e),this._logHandler(this,Re.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Re.WARN,...e),this._logHandler(this,Re.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Re.ERROR,...e),this._logHandler(this,Re.ERROR,...e)}}const o3=(t,e)=>e.some(n=>t instanceof n);let px,mx;function a3(){return px||(px=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function l3(){return mx||(mx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const RS=new WeakMap,vg=new WeakMap,NS=new WeakMap,qp=new WeakMap,_y=new WeakMap;function c3(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(rs(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&RS.set(n,t)}).catch(()=>{}),_y.set(e,t),e}function u3(t){if(vg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});vg.set(t,e)}let _g={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return vg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||NS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return rs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function d3(t){_g=t(_g)}function h3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Hp(this),e,...n);return NS.set(r,e.sort?e.sort():[e]),rs(r)}:l3().includes(t)?function(...e){return t.apply(Hp(this),e),rs(RS.get(this))}:function(...e){return rs(t.apply(Hp(this),e))}}function f3(t){return typeof t=="function"?h3(t):(t instanceof IDBTransaction&&u3(t),o3(t,a3())?new Proxy(t,_g):t)}function rs(t){if(t instanceof IDBRequest)return c3(t);if(qp.has(t))return qp.get(t);const e=f3(t);return e!==t&&(qp.set(t,e),_y.set(e,t)),e}const Hp=t=>_y.get(t);function PS(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=rs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(rs(o.result),l.oldVersion,l.newVersion,rs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const p3=["get","getKey","getAll","getAllKeys","count"],m3=["put","add","delete","clear"],Kp=new Map;function gx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Kp.get(e))return Kp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=m3.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||p3.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return Kp.set(e,s),s}d3(t=>({...t,get:(e,n,r)=>gx(e,n)||t.get(e,n,r),has:(e,n)=>!!gx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(y3(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function y3(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const wg="@firebase/app",yx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gi=new kf("@firebase/app"),v3="@firebase/app-compat",_3="@firebase/analytics-compat",w3="@firebase/analytics",x3="@firebase/app-check-compat",b3="@firebase/app-check",E3="@firebase/auth",I3="@firebase/auth-compat",T3="@firebase/database",S3="@firebase/data-connect",C3="@firebase/database-compat",A3="@firebase/functions",k3="@firebase/functions-compat",R3="@firebase/installations",N3="@firebase/installations-compat",P3="@firebase/messaging",D3="@firebase/messaging-compat",V3="@firebase/performance",O3="@firebase/performance-compat",z3="@firebase/remote-config",M3="@firebase/remote-config-compat",L3="@firebase/storage",j3="@firebase/storage-compat",F3="@firebase/firestore",$3="@firebase/vertexai-preview",U3="@firebase/firestore-compat",B3="firebase",q3="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xg="[DEFAULT]",H3={[wg]:"fire-core",[v3]:"fire-core-compat",[w3]:"fire-analytics",[_3]:"fire-analytics-compat",[b3]:"fire-app-check",[x3]:"fire-app-check-compat",[E3]:"fire-auth",[I3]:"fire-auth-compat",[T3]:"fire-rtdb",[S3]:"fire-data-connect",[C3]:"fire-rtdb-compat",[A3]:"fire-fn",[k3]:"fire-fn-compat",[R3]:"fire-iid",[N3]:"fire-iid-compat",[P3]:"fire-fcm",[D3]:"fire-fcm-compat",[V3]:"fire-perf",[O3]:"fire-perf-compat",[z3]:"fire-rc",[M3]:"fire-rc-compat",[L3]:"fire-gcs",[j3]:"fire-gcs-compat",[F3]:"fire-fst",[U3]:"fire-fst-compat",[$3]:"fire-vertex","fire-js":"fire-js",[B3]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dh=new Map,K3=new Map,bg=new Map;function vx(t,e){try{t.container.addComponent(e)}catch(n){gi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function jr(t){const e=t.name;if(bg.has(e))return gi.debug(`There were multiple attempts to register component ${e}.`),!1;bg.set(e,t);for(const n of Dh.values())vx(n,t);for(const n of K3.values())vx(n,t);return!0}function wo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function mr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G3={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},is=new _o("app","Firebase",G3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W3{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new xr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw is.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ll=q3;function DS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:xg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw is.create("bad-app-name",{appName:String(i)});if(n||(n=TS()),!n)throw is.create("no-options");const s=Dh.get(i);if(s){if(Fa(n,s.options)&&Fa(r,s.config))return s;throw is.create("duplicate-app",{appName:i})}const o=new t3(i);for(const l of bg.values())o.addComponent(l);const a=new W3(n,r,o);return Dh.set(i,a),a}function VS(t=xg){const e=Dh.get(t);if(!e&&t===xg&&TS())return DS();if(!e)throw is.create("no-app",{appName:t});return e}function er(t,e,n){var r;let i=(r=H3[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),gi.warn(a.join(" "));return}jr(new xr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q3="firebase-heartbeat-database",Y3=1,Jc="firebase-heartbeat-store";let Gp=null;function OS(){return Gp||(Gp=PS(Q3,Y3,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Jc)}catch(n){console.warn(n)}}}}).catch(t=>{throw is.create("idb-open",{originalErrorMessage:t.message})})),Gp}async function X3(t){try{const n=(await OS()).transaction(Jc),r=await n.objectStore(Jc).get(zS(t));return await n.done,r}catch(e){if(e instanceof Er)gi.warn(e.message);else{const n=is.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});gi.warn(n.message)}}}async function _x(t,e){try{const r=(await OS()).transaction(Jc,"readwrite");await r.objectStore(Jc).put(e,zS(t)),await r.done}catch(n){if(n instanceof Er)gi.warn(n.message);else{const r=is.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});gi.warn(r.message)}}}function zS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3=1024,Z3=30*24*60*60*1e3;class ej{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new nj(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=wx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Z3}),this._storage.overwrite(this._heartbeatsCache))}catch(r){gi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=wx(),{heartbeatsToSend:r,unsentEntries:i}=tj(this._heartbeatsCache.heartbeats),s=ES(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return gi.warn(n),""}}}function wx(){return new Date().toISOString().substring(0,10)}function tj(t,e=J3){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),xx(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),xx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class nj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return vy()?kS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await X3(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return _x(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return _x(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function xx(t){return ES(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rj(t){jr(new xr("platform-logger",e=>new g3(e),"PRIVATE")),jr(new xr("heartbeat",e=>new ej(e),"PRIVATE")),er(wg,yx,t),er(wg,yx,"esm2017"),er("fire-js","")}rj("");function wy(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function MS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ij=MS,LS=new _o("auth","Firebase",MS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vh=new kf("@firebase/auth");function sj(t,...e){Vh.logLevel<=Re.WARN&&Vh.warn(`Auth (${ll}): ${t}`,...e)}function jd(t,...e){Vh.logLevel<=Re.ERROR&&Vh.error(`Auth (${ll}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rr(t,...e){throw by(t,...e)}function _r(t,...e){return by(t,...e)}function xy(t,e,n){const r=Object.assign(Object.assign({},ij()),{[e]:n});return new _o("auth","Firebase",r).create(e,{appName:t.name})}function ci(t){return xy(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function oj(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&rr(t,"argument-error"),xy(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function by(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return LS.create(t,...e)}function me(t,e,...n){if(!t)throw by(e,...n)}function ni(t){const e="INTERNAL ASSERTION FAILED: "+t;throw jd(e),new Error(e)}function yi(t,e){t||ni(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function aj(){return bx()==="http:"||bx()==="https:"}function bx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(aj()||CS()||"connection"in navigator)?navigator.onLine:!0}function cj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(e,n){this.shortDelay=e,this.longDelay=n,yi(n>e,"Short delay should be less than long delay!"),this.isMobile=OL()||LL()}get(){return lj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ey(t,e){yi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ni("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ni("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ni("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dj=new wu(3e4,6e4);function wi(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Br(t,e,n,r,i={}){return FS(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=_u(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return ML()||(c.referrerPolicy="no-referrer"),jS.fetch()($S(t,t.config.apiHost,n,a),c)})}async function FS(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},uj),e);try{const i=new fj(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw md(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw md(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw md(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw md(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw xy(t,d,c);rr(t,d)}}catch(i){if(i instanceof Er)throw i;rr(t,"network-request-failed",{message:String(i)})}}async function xu(t,e,n,r,i={}){const s=await Br(t,e,n,r,i);return"mfaPendingCredential"in s&&rr(t,"multi-factor-auth-required",{_serverResponse:s}),s}function $S(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?Ey(t.config,i):`${t.config.apiScheme}://${i}`}function hj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class fj{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(_r(this.auth,"network-request-failed")),dj.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function md(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=_r(t,e,r);return i.customData._tokenResponse=n,i}function Ex(t){return t!==void 0&&t.enterprise!==void 0}class pj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return hj(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function mj(t,e){return Br(t,"GET","/v2/recaptchaConfig",wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gj(t,e){return Br(t,"POST","/v1/accounts:delete",e)}async function US(t,e){return Br(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function yj(t,e=!1){const n=Ct(t),r=await n.getIdToken(e),i=Iy(r);me(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:yc(Wp(i.auth_time)),issuedAtTime:yc(Wp(i.iat)),expirationTime:yc(Wp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Wp(t){return Number(t)*1e3}function Iy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return jd("JWT malformed, contained fewer than 3 sections"),null;try{const i=IS(n);return i?JSON.parse(i):(jd("Failed to decode base64 JWT payload"),null)}catch(i){return jd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function Ix(t){const e=Iy(t);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $a(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Er&&vj(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function vj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _j{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=yc(this.lastLoginAt),this.creationTime=yc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await $a(t,US(n,{idToken:r}));me(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?BS(s.providerUserInfo):[],a=xj(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Ig(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function wj(t){const e=Ct(t);await Oh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function xj(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function BS(t){return t.map(e=>{var{providerId:n}=e,r=wy(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bj(t,e){const n=await FS(t,{},async()=>{const r=_u({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=$S(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",jS.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Ej(t,e){return Br(t,"POST","/v2/accounts:revokeToken",wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ix(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){me(e.length!==0,"internal-error");const n=Ix(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await bj(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new Ta;return r&&(me(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(me(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(me(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ta,this.toJSON())}_performRefresh(){return ni("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(t,e){me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ri{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=wy(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new _j(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new Ig(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await $a(this,this.stsTokenManager.getToken(this.auth,e));return me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return yj(this,e)}reload(){return wj(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ri(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Oh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(mr(this.auth.app))return Promise.reject(ci(this.auth));const e=await this.getIdToken();return await $a(this,gj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,c,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(i=n.email)!==null&&i!==void 0?i:void 0,m=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,R=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=n.createdAt)!==null&&c!==void 0?c:void 0,v=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:T,emailVerified:k,isAnonymous:O,providerData:z,stsTokenManager:S}=n;me(T&&S,e,"internal-error");const b=Ta.fromJSON(this.name,S);me(typeof T=="string",e,"internal-error"),Ri(h,e.name),Ri(f,e.name),me(typeof k=="boolean",e,"internal-error"),me(typeof O=="boolean",e,"internal-error"),Ri(m,e.name),Ri(E,e.name),Ri(x,e.name),Ri(R,e.name),Ri(y,e.name),Ri(v,e.name);const w=new ri({uid:T,auth:e,email:f,emailVerified:k,displayName:h,isAnonymous:O,photoURL:E,phoneNumber:m,tenantId:x,stsTokenManager:b,createdAt:y,lastLoginAt:v});return z&&Array.isArray(z)&&(w.providerData=z.map(I=>Object.assign({},I))),R&&(w._redirectEventId=R),w}static async _fromIdTokenResponse(e,n,r=!1){const i=new Ta;i.updateFromServerResponse(n);const s=new ri({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Oh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];me(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?BS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new Ta;a.updateFromIdToken(r);const l=new ri({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new Ig(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx=new Map;function ii(t){yi(t instanceof Function,"Expected a class definition");let e=Tx.get(t);return e?(yi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Tx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}qS.type="NONE";const Sx=qS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(t,e,n){return`firebase:${t}:${e}:${n}`}class Sa{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Fd(this.userKey,i.apiKey,s),this.fullPersistenceKey=Fd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ri._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Sa(ii(Sx),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||ii(Sx);const o=Fd(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const d=await c._get(o);if(d){const h=ri._fromJSON(e,d);c!==s&&(a=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new Sa(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new Sa(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(WS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(HS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(YS(e))return"Blackberry";if(XS(e))return"Webos";if(KS(e))return"Safari";if((e.includes("chrome/")||GS(e))&&!e.includes("edge/"))return"Chrome";if(QS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function HS(t=St()){return/firefox\//i.test(t)}function KS(t=St()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function GS(t=St()){return/crios\//i.test(t)}function WS(t=St()){return/iemobile/i.test(t)}function QS(t=St()){return/android/i.test(t)}function YS(t=St()){return/blackberry/i.test(t)}function XS(t=St()){return/webos/i.test(t)}function Ty(t=St()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Ij(t=St()){var e;return Ty(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Tj(){return jL()&&document.documentMode===10}function JS(t=St()){return Ty(t)||QS(t)||XS(t)||YS(t)||/windows phone/i.test(t)||WS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZS(t,e=[]){let n;switch(t){case"Browser":n=Cx(St());break;case"Worker":n=`${Cx(St())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${ll}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cj(t,e={}){return Br(t,"GET","/v2/passwordPolicy",wi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aj=6;class kj{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Aj,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ax(this),this.idTokenSubscription=new Ax(this),this.beforeStateQueue=new Sj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=LS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ii(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await Sa.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await US(this,{idToken:e}),r=await ri._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(mr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Oh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=cj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(mr(this.app))return Promise.reject(ci(this));const n=e?Ct(e):null;return n&&me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return mr(this.app)?Promise.reject(ci(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return mr(this.app)?Promise.reject(ci(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ii(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Cj(this),n=new kj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new _o("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Ej(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ii(e)||this._popupRedirectResolver;me(n,this,"argument-error"),this.redirectPersistenceManager=await Sa.create(this,[ii(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(me(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ZS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&sj(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function xi(t){return Ct(t)}class Ax{constructor(e){this.auth=e,this.observer=null,this.addObserver=HL(n=>this.observer=n)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Nj(t){Rf=t}function e2(t){return Rf.loadJS(t)}function Pj(){return Rf.recaptchaEnterpriseScript}function Dj(){return Rf.gapiScript}function Vj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const Oj="recaptcha-enterprise",zj="NO_RECAPTCHA";class Mj{constructor(e){this.type=Oj,this.auth=xi(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{mj(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new pj(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;Ex(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(zj)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&Ex(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=Pj();l.length!==0&&(l+=a),e2(l).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function kx(t,e,n,r=!1){const i=new Mj(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function zh(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await kx(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await kx(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lj(t,e){const n=wo(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Fa(s,e??{}))return i;rr(i,"already-initialized")}return n.initialize({options:e})}function jj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ii);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Fj(t,e,n){const r=xi(t);me(r._canInitEmulator,r,"emulator-config-failed"),me(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=t2(e),{host:o,port:a}=$j(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),Uj()}function t2(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $j(t){const e=t2(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Rx(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Rx(o)}}}function Rx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Uj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ni("not implemented")}_getIdTokenResponse(e){return ni("not implemented")}_linkToIdToken(e,n){return ni("not implemented")}_getReauthenticationResolver(e){return ni("not implemented")}}async function Bj(t,e){return Br(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qj(t,e){return xu(t,"POST","/v1/accounts:signInWithPassword",wi(t,e))}async function n2(t,e){return Br(t,"POST","/v1/accounts:sendOobCode",wi(t,e))}async function Hj(t,e){return n2(t,e)}async function Kj(t,e){return n2(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gj(t,e){return xu(t,"POST","/v1/accounts:signInWithEmailLink",wi(t,e))}async function Wj(t,e){return xu(t,"POST","/v1/accounts:signInWithEmailLink",wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc extends Sy{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new Zc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Zc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zh(e,n,"signInWithPassword",qj);case"emailLink":return Gj(e,{email:this._email,oobCode:this._password});default:rr(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zh(e,r,"signUpPassword",Bj);case"emailLink":return Wj(e,{idToken:n,email:this._email,oobCode:this._password});default:rr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ca(t,e){return xu(t,"POST","/v1/accounts:signInWithIdp",wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qj="http://localhost";class io extends Sy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new io(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):rr("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=wy(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new io(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ca(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ca(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ca(e,n)}buildRequest(){const e={requestUri:Qj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=_u(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Xj(t){const e=tc(nc(t)).link,n=e?tc(nc(e)).deep_link_id:null,r=tc(nc(t)).deep_link_id;return(r?tc(nc(r)).link:null)||r||n||e||t}class Cy{constructor(e){var n,r,i,s,o,a;const l=tc(nc(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,h=Yj((i=l.mode)!==null&&i!==void 0?i:null);me(c&&d&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=Xj(e);try{return new Cy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cl{constructor(){this.providerId=cl.PROVIDER_ID}static credential(e,n){return Zc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Cy.parseLink(n);return me(r,"argument-error"),Zc._fromEmailAndCode(e,r.code,r.tenantId)}}cl.PROVIDER_ID="password";cl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";cl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu extends Ay{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends bu{constructor(){super("facebook.com")}static credential(e){return io._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jr extends bu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return io._fromParams({providerId:Jr.PROVIDER_ID,signInMethod:Jr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Jr.credentialFromTaggedObject(e)}static credentialFromError(e){return Jr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Jr.credential(n,r)}catch{return null}}}Jr.GOOGLE_SIGN_IN_METHOD="google.com";Jr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends bu{constructor(){super("github.com")}static credential(e){return io._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $i.credential(e.oauthAccessToken)}catch{return null}}}$i.GITHUB_SIGN_IN_METHOD="github.com";$i.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends bu{constructor(){super("twitter.com")}static credential(e,n){return io._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ui.credential(n,r)}catch{return null}}}Ui.TWITTER_SIGN_IN_METHOD="twitter.com";Ui.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jj(t,e){return xu(t,"POST","/v1/accounts:signUp",wi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await ri._fromIdTokenResponse(e,r,i),o=Nx(r);return new so({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Nx(r);return new so({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Nx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh extends Er{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Mh.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Mh(e,n,r,i)}}function r2(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Mh._fromErrorAndOperation(t,s,e,r):s})}async function Zj(t,e,n=!1){const r=await $a(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return so._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e6(t,e,n=!1){const{auth:r}=t;if(mr(r.app))return Promise.reject(ci(r));const i="reauthenticate";try{const s=await $a(t,r2(r,i,e,t),n);me(s.idToken,r,"internal-error");const o=Iy(s.idToken);me(o,r,"internal-error");const{sub:a}=o;return me(t.uid===a,r,"user-mismatch"),so._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&rr(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i2(t,e,n=!1){if(mr(t.app))return Promise.reject(ci(t));const r="signIn",i=await r2(t,r,e),s=await so._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function t6(t,e){return i2(xi(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s2(t){const e=xi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function n6(t,e,n){const r=xi(t);await zh(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Kj)}async function r6(t,e,n){if(mr(t.app))return Promise.reject(ci(t));const r=xi(t),o=await zh(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Jj).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&s2(t),l}),a=await so._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function i6(t,e,n){return mr(t.app)?Promise.reject(ci(t)):t6(Ct(t),cl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&s2(t),r})}async function s6(t,e){const n=Ct(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:s}=await Hj(n.auth,i);s!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o6(t,e){return Br(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function a6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Ct(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await $a(r,o6(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function l6(t,e,n,r){return Ct(t).onIdTokenChanged(e,n,r)}function c6(t,e,n){return Ct(t).beforeAuthStateChanged(e,n)}function u6(t,e,n,r){return Ct(t).onAuthStateChanged(e,n,r)}function d6(t){return Ct(t).signOut()}const Lh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Lh,"1"),this.storage.removeItem(Lh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h6=1e3,f6=10;class a2 extends o2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=JS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);Tj()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,f6):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},h6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}a2.type="LOCAL";const p6=a2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l2 extends o2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}l2.type="SESSION";const c2=l2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Nf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await m6(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Nf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ky(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=ky("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(){return window}function y6(t){Mr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(){return typeof Mr().WorkerGlobalScope<"u"&&typeof Mr().importScripts=="function"}async function v6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function _6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function w6(){return u2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2="firebaseLocalStorageDb",x6=1,jh="firebaseLocalStorage",h2="fbase_key";class Eu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Pf(t,e){return t.transaction([jh],e?"readwrite":"readonly").objectStore(jh)}function b6(){const t=indexedDB.deleteDatabase(d2);return new Eu(t).toPromise()}function Tg(){const t=indexedDB.open(d2,x6);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(jh,{keyPath:h2})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(jh)?e(r):(r.close(),await b6(),e(await Tg()))})})}async function Px(t,e,n){const r=Pf(t,!0).put({[h2]:e,value:n});return new Eu(r).toPromise()}async function E6(t,e){const n=Pf(t,!1).get(e),r=await new Eu(n).toPromise();return r===void 0?null:r.value}function Dx(t,e){const n=Pf(t,!0).delete(e);return new Eu(n).toPromise()}const I6=800,T6=3;class f2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Tg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>T6)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return u2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Nf._getInstance(w6()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await v6(),!this.activeServiceWorker)return;this.sender=new g6(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||_6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Tg();return await Px(e,Lh,"1"),await Dx(e,Lh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Px(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>E6(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Dx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Pf(i,!1).getAll();return new Eu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),I6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}f2.type="LOCAL";const S6=f2;new wu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p2(t,e){return e?ii(e):(me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry extends Sy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ca(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ca(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ca(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function C6(t){return i2(t.auth,new Ry(t),t.bypassAuthState)}function A6(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),e6(n,new Ry(t),t.bypassAuthState)}async function k6(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),Zj(n,new Ry(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m2{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return C6;case"linkViaPopup":case"linkViaRedirect":return k6;case"reauthViaPopup":case"reauthViaRedirect":return A6;default:rr(this.auth,"internal-error")}}resolve(e){yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){yi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R6=new wu(2e3,1e4);async function N6(t,e,n){if(mr(t.app))return Promise.reject(_r(t,"operation-not-supported-in-this-environment"));const r=xi(t);oj(t,e,Ay);const i=p2(r,n);return new Bs(r,"signInViaPopup",e,i).executeNotNull()}class Bs extends m2{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Bs.currentPopupAction&&Bs.currentPopupAction.cancel(),Bs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){yi(this.filter.length===1,"Popup operations only handle one event");const e=ky();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(_r(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(_r(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(_r(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,R6.get())};e()}}Bs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P6="pendingRedirect",$d=new Map;class D6 extends m2{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=$d.get(this.auth._key());if(!e){try{const r=await V6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}$d.set(this.auth._key(),e)}return this.bypassAuthState||$d.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function V6(t,e){const n=M6(e),r=z6(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function O6(t,e){$d.set(t._key(),e)}function z6(t){return ii(t._redirectPersistence)}function M6(t){return Fd(P6,t.config.apiKey,t.name)}async function L6(t,e,n=!1){if(mr(t.app))return Promise.reject(ci(t));const r=xi(t),i=p2(r,e),o=await new D6(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6=10*60*1e3;class F6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!$6(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!g2(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(_r(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=j6&&this.cachedEventUids.clear(),this.cachedEventUids.has(Vx(e))}saveEventToCache(e){this.cachedEventUids.add(Vx(e)),this.lastProcessedEventTime=Date.now()}}function Vx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function g2({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function $6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return g2(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U6(t,e={}){return Br(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,q6=/^https?/;async function H6(t){if(t.config.emulator)return;const{authorizedDomains:e}=await U6(t);for(const n of e)try{if(K6(n))return}catch{}rr(t,"unauthorized-domain")}function K6(t){const e=Eg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!q6.test(n))return!1;if(B6.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G6=new wu(3e4,6e4);function Ox(){const t=Mr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function W6(t){return new Promise((e,n)=>{var r,i,s;function o(){Ox(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Ox(),n(_r(t,"network-request-failed"))},timeout:G6.get()})}if(!((i=(r=Mr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Mr().gapi)===null||s===void 0)&&s.load)o();else{const a=Vj("iframefcb");return Mr()[a]=()=>{gapi.load?o():n(_r(t,"network-request-failed"))},e2(`${Dj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Ud=null,e})}let Ud=null;function Q6(t){return Ud=Ud||W6(t),Ud}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y6=new wu(5e3,15e3),X6="__/auth/iframe",J6="emulator/auth/iframe",Z6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},e9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function t9(t){const e=t.config;me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Ey(e,J6):`https://${t.config.authDomain}/${X6}`,r={apiKey:e.apiKey,appName:t.name,v:ll},i=e9.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${_u(r).slice(1)}`}async function n9(t){const e=await Q6(t),n=Mr().gapi;return me(n,t,"internal-error"),e.open({where:document.body,url:t9(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Z6,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=_r(t,"network-request-failed"),a=Mr().setTimeout(()=>{s(o)},Y6.get());function l(){Mr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},i9=500,s9=600,o9="_blank",a9="http://localhost";class zx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function l9(t,e,n,r=i9,i=s9){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},r9),{width:r.toString(),height:i.toString(),top:s,left:o}),c=St().toLowerCase();n&&(a=GS(c)?o9:n),HS(c)&&(e=e||a9,l.scrollbars="yes");const d=Object.entries(l).reduce((f,[m,E])=>`${f}${m}=${E},`,"");if(Ij(c)&&a!=="_self")return c9(e||"",a),new zx(null);const h=window.open(e||"",a,d);me(h,t,"popup-blocked");try{h.focus()}catch{}return new zx(h)}function c9(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9="__/auth/handler",d9="emulator/auth/handler",h9=encodeURIComponent("fac");async function Mx(t,e,n,r,i,s){me(t.config.authDomain,t,"auth-domain-config-required"),me(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:ll,eventId:i};if(e instanceof Ay){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",qL(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))o[d]=h}if(e instanceof bu){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),c=l?`#${h9}=${encodeURIComponent(l)}`:"";return`${f9(t)}?${_u(a).slice(1)}${c}`}function f9({config:t}){return t.emulator?Ey(t,d9):`https://${t.authDomain}/${u9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qp="webStorageSupport";class p9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=c2,this._completeRedirectFn=L6,this._overrideRedirectResult=O6}async _openPopup(e,n,r,i){var s;yi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await Mx(e,n,r,Eg(),i);return l9(e,o,ky())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Mx(e,n,r,Eg(),i);return y6(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(yi(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await n9(e),r=new F6(e);return n.register("authEvent",i=>(me(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Qp,{type:Qp},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Qp];o!==void 0&&n(!!o),rr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=H6(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return JS()||KS()||Ty()}}const m9=p9;var Lx="@firebase/auth",jx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function v9(t){jr(new xr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;me(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ZS(t)},c=new Rj(r,i,s,l);return jj(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),jr(new xr("auth-internal",e=>{const n=xi(e.getProvider("auth").getImmediate());return(r=>new g9(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),er(Lx,jx,y9(t)),er(Lx,jx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _9=5*60,w9=SS("authIdTokenMaxAge")||_9;let Fx=null;const x9=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>w9)return;const i=n==null?void 0:n.token;Fx!==i&&(Fx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function b9(t=VS()){const e=wo(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Lj(t,{popupRedirectResolver:m9,persistence:[S6,p6,c2]}),r=SS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=x9(s.toString());c6(n,o,()=>o(n.currentUser)),l6(n,a=>o(a))}}const i=DL("auth");return i&&Fj(n,`http://${i}`),n}function E9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Nj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=_r("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",E9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});v9("Browser");var I9="firebase",T9="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */er(I9,T9,"app");var $x=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Qs,y2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,b){function w(){}w.prototype=b.prototype,S.D=b.prototype,S.prototype=new w,S.prototype.constructor=S,S.C=function(I,C,N){for(var A=Array(arguments.length-2),P=2;P<arguments.length;P++)A[P-2]=arguments[P];return b.prototype[C].apply(I,A)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,b,w){w||(w=0);var I=Array(16);if(typeof b=="string")for(var C=0;16>C;++C)I[C]=b.charCodeAt(w++)|b.charCodeAt(w++)<<8|b.charCodeAt(w++)<<16|b.charCodeAt(w++)<<24;else for(C=0;16>C;++C)I[C]=b[w++]|b[w++]<<8|b[w++]<<16|b[w++]<<24;b=S.g[0],w=S.g[1],C=S.g[2];var N=S.g[3],A=b+(N^w&(C^N))+I[0]+3614090360&4294967295;b=w+(A<<7&4294967295|A>>>25),A=N+(C^b&(w^C))+I[1]+3905402710&4294967295,N=b+(A<<12&4294967295|A>>>20),A=C+(w^N&(b^w))+I[2]+606105819&4294967295,C=N+(A<<17&4294967295|A>>>15),A=w+(b^C&(N^b))+I[3]+3250441966&4294967295,w=C+(A<<22&4294967295|A>>>10),A=b+(N^w&(C^N))+I[4]+4118548399&4294967295,b=w+(A<<7&4294967295|A>>>25),A=N+(C^b&(w^C))+I[5]+1200080426&4294967295,N=b+(A<<12&4294967295|A>>>20),A=C+(w^N&(b^w))+I[6]+2821735955&4294967295,C=N+(A<<17&4294967295|A>>>15),A=w+(b^C&(N^b))+I[7]+4249261313&4294967295,w=C+(A<<22&4294967295|A>>>10),A=b+(N^w&(C^N))+I[8]+1770035416&4294967295,b=w+(A<<7&4294967295|A>>>25),A=N+(C^b&(w^C))+I[9]+2336552879&4294967295,N=b+(A<<12&4294967295|A>>>20),A=C+(w^N&(b^w))+I[10]+4294925233&4294967295,C=N+(A<<17&4294967295|A>>>15),A=w+(b^C&(N^b))+I[11]+2304563134&4294967295,w=C+(A<<22&4294967295|A>>>10),A=b+(N^w&(C^N))+I[12]+1804603682&4294967295,b=w+(A<<7&4294967295|A>>>25),A=N+(C^b&(w^C))+I[13]+4254626195&4294967295,N=b+(A<<12&4294967295|A>>>20),A=C+(w^N&(b^w))+I[14]+2792965006&4294967295,C=N+(A<<17&4294967295|A>>>15),A=w+(b^C&(N^b))+I[15]+1236535329&4294967295,w=C+(A<<22&4294967295|A>>>10),A=b+(C^N&(w^C))+I[1]+4129170786&4294967295,b=w+(A<<5&4294967295|A>>>27),A=N+(w^C&(b^w))+I[6]+3225465664&4294967295,N=b+(A<<9&4294967295|A>>>23),A=C+(b^w&(N^b))+I[11]+643717713&4294967295,C=N+(A<<14&4294967295|A>>>18),A=w+(N^b&(C^N))+I[0]+3921069994&4294967295,w=C+(A<<20&4294967295|A>>>12),A=b+(C^N&(w^C))+I[5]+3593408605&4294967295,b=w+(A<<5&4294967295|A>>>27),A=N+(w^C&(b^w))+I[10]+38016083&4294967295,N=b+(A<<9&4294967295|A>>>23),A=C+(b^w&(N^b))+I[15]+3634488961&4294967295,C=N+(A<<14&4294967295|A>>>18),A=w+(N^b&(C^N))+I[4]+3889429448&4294967295,w=C+(A<<20&4294967295|A>>>12),A=b+(C^N&(w^C))+I[9]+568446438&4294967295,b=w+(A<<5&4294967295|A>>>27),A=N+(w^C&(b^w))+I[14]+3275163606&4294967295,N=b+(A<<9&4294967295|A>>>23),A=C+(b^w&(N^b))+I[3]+4107603335&4294967295,C=N+(A<<14&4294967295|A>>>18),A=w+(N^b&(C^N))+I[8]+1163531501&4294967295,w=C+(A<<20&4294967295|A>>>12),A=b+(C^N&(w^C))+I[13]+2850285829&4294967295,b=w+(A<<5&4294967295|A>>>27),A=N+(w^C&(b^w))+I[2]+4243563512&4294967295,N=b+(A<<9&4294967295|A>>>23),A=C+(b^w&(N^b))+I[7]+1735328473&4294967295,C=N+(A<<14&4294967295|A>>>18),A=w+(N^b&(C^N))+I[12]+2368359562&4294967295,w=C+(A<<20&4294967295|A>>>12),A=b+(w^C^N)+I[5]+4294588738&4294967295,b=w+(A<<4&4294967295|A>>>28),A=N+(b^w^C)+I[8]+2272392833&4294967295,N=b+(A<<11&4294967295|A>>>21),A=C+(N^b^w)+I[11]+1839030562&4294967295,C=N+(A<<16&4294967295|A>>>16),A=w+(C^N^b)+I[14]+4259657740&4294967295,w=C+(A<<23&4294967295|A>>>9),A=b+(w^C^N)+I[1]+2763975236&4294967295,b=w+(A<<4&4294967295|A>>>28),A=N+(b^w^C)+I[4]+1272893353&4294967295,N=b+(A<<11&4294967295|A>>>21),A=C+(N^b^w)+I[7]+4139469664&4294967295,C=N+(A<<16&4294967295|A>>>16),A=w+(C^N^b)+I[10]+3200236656&4294967295,w=C+(A<<23&4294967295|A>>>9),A=b+(w^C^N)+I[13]+681279174&4294967295,b=w+(A<<4&4294967295|A>>>28),A=N+(b^w^C)+I[0]+3936430074&4294967295,N=b+(A<<11&4294967295|A>>>21),A=C+(N^b^w)+I[3]+3572445317&4294967295,C=N+(A<<16&4294967295|A>>>16),A=w+(C^N^b)+I[6]+76029189&4294967295,w=C+(A<<23&4294967295|A>>>9),A=b+(w^C^N)+I[9]+3654602809&4294967295,b=w+(A<<4&4294967295|A>>>28),A=N+(b^w^C)+I[12]+3873151461&4294967295,N=b+(A<<11&4294967295|A>>>21),A=C+(N^b^w)+I[15]+530742520&4294967295,C=N+(A<<16&4294967295|A>>>16),A=w+(C^N^b)+I[2]+3299628645&4294967295,w=C+(A<<23&4294967295|A>>>9),A=b+(C^(w|~N))+I[0]+4096336452&4294967295,b=w+(A<<6&4294967295|A>>>26),A=N+(w^(b|~C))+I[7]+1126891415&4294967295,N=b+(A<<10&4294967295|A>>>22),A=C+(b^(N|~w))+I[14]+2878612391&4294967295,C=N+(A<<15&4294967295|A>>>17),A=w+(N^(C|~b))+I[5]+4237533241&4294967295,w=C+(A<<21&4294967295|A>>>11),A=b+(C^(w|~N))+I[12]+1700485571&4294967295,b=w+(A<<6&4294967295|A>>>26),A=N+(w^(b|~C))+I[3]+2399980690&4294967295,N=b+(A<<10&4294967295|A>>>22),A=C+(b^(N|~w))+I[10]+4293915773&4294967295,C=N+(A<<15&4294967295|A>>>17),A=w+(N^(C|~b))+I[1]+2240044497&4294967295,w=C+(A<<21&4294967295|A>>>11),A=b+(C^(w|~N))+I[8]+1873313359&4294967295,b=w+(A<<6&4294967295|A>>>26),A=N+(w^(b|~C))+I[15]+4264355552&4294967295,N=b+(A<<10&4294967295|A>>>22),A=C+(b^(N|~w))+I[6]+2734768916&4294967295,C=N+(A<<15&4294967295|A>>>17),A=w+(N^(C|~b))+I[13]+1309151649&4294967295,w=C+(A<<21&4294967295|A>>>11),A=b+(C^(w|~N))+I[4]+4149444226&4294967295,b=w+(A<<6&4294967295|A>>>26),A=N+(w^(b|~C))+I[11]+3174756917&4294967295,N=b+(A<<10&4294967295|A>>>22),A=C+(b^(N|~w))+I[2]+718787259&4294967295,C=N+(A<<15&4294967295|A>>>17),A=w+(N^(C|~b))+I[9]+3951481745&4294967295,S.g[0]=S.g[0]+b&4294967295,S.g[1]=S.g[1]+(C+(A<<21&4294967295|A>>>11))&4294967295,S.g[2]=S.g[2]+C&4294967295,S.g[3]=S.g[3]+N&4294967295}r.prototype.u=function(S,b){b===void 0&&(b=S.length);for(var w=b-this.blockSize,I=this.B,C=this.h,N=0;N<b;){if(C==0)for(;N<=w;)i(this,S,N),N+=this.blockSize;if(typeof S=="string"){for(;N<b;)if(I[C++]=S.charCodeAt(N++),C==this.blockSize){i(this,I),C=0;break}}else for(;N<b;)if(I[C++]=S[N++],C==this.blockSize){i(this,I),C=0;break}}this.h=C,this.o+=b},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var b=1;b<S.length-8;++b)S[b]=0;var w=8*this.o;for(b=S.length-8;b<S.length;++b)S[b]=w&255,w/=256;for(this.u(S),S=Array(16),b=w=0;4>b;++b)for(var I=0;32>I;I+=8)S[w++]=this.g[b]>>>I&255;return S};function s(S,b){var w=a;return Object.prototype.hasOwnProperty.call(w,S)?w[S]:w[S]=b(S)}function o(S,b){this.h=b;for(var w=[],I=!0,C=S.length-1;0<=C;C--){var N=S[C]|0;I&&N==b||(w[C]=N,I=!1)}this.g=w}var a={};function l(S){return-128<=S&&128>S?s(S,function(b){return new o([b|0],0>b?-1:0)}):new o([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return R(c(-S));for(var b=[],w=1,I=0;S>=w;I++)b[I]=S/w|0,w*=4294967296;return new o(b,0)}function d(S,b){if(S.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(S.charAt(0)=="-")return R(d(S.substring(1),b));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=c(Math.pow(b,8)),I=h,C=0;C<S.length;C+=8){var N=Math.min(8,S.length-C),A=parseInt(S.substring(C,C+N),b);8>N?(N=c(Math.pow(b,N)),I=I.j(N).add(c(A))):(I=I.j(w),I=I.add(c(A)))}return I}var h=l(0),f=l(1),m=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-R(this).m();for(var S=0,b=1,w=0;w<this.g.length;w++){var I=this.i(w);S+=(0<=I?I:4294967296+I)*b,b*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(E(this))return"0";if(x(this))return"-"+R(this).toString(S);for(var b=c(Math.pow(S,6)),w=this,I="";;){var C=k(w,b).g;w=y(w,C.j(b));var N=((0<w.g.length?w.g[0]:w.h)>>>0).toString(S);if(w=C,E(w))return N+I;for(;6>N.length;)N="0"+N;I=N+I}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function E(S){if(S.h!=0)return!1;for(var b=0;b<S.g.length;b++)if(S.g[b]!=0)return!1;return!0}function x(S){return S.h==-1}t.l=function(S){return S=y(this,S),x(S)?-1:E(S)?0:1};function R(S){for(var b=S.g.length,w=[],I=0;I<b;I++)w[I]=~S.g[I];return new o(w,~S.h).add(f)}t.abs=function(){return x(this)?R(this):this},t.add=function(S){for(var b=Math.max(this.g.length,S.g.length),w=[],I=0,C=0;C<=b;C++){var N=I+(this.i(C)&65535)+(S.i(C)&65535),A=(N>>>16)+(this.i(C)>>>16)+(S.i(C)>>>16);I=A>>>16,N&=65535,A&=65535,w[C]=A<<16|N}return new o(w,w[w.length-1]&-2147483648?-1:0)};function y(S,b){return S.add(R(b))}t.j=function(S){if(E(this)||E(S))return h;if(x(this))return x(S)?R(this).j(R(S)):R(R(this).j(S));if(x(S))return R(this.j(R(S)));if(0>this.l(m)&&0>S.l(m))return c(this.m()*S.m());for(var b=this.g.length+S.g.length,w=[],I=0;I<2*b;I++)w[I]=0;for(I=0;I<this.g.length;I++)for(var C=0;C<S.g.length;C++){var N=this.i(I)>>>16,A=this.i(I)&65535,P=S.i(C)>>>16,F=S.i(C)&65535;w[2*I+2*C]+=A*F,v(w,2*I+2*C),w[2*I+2*C+1]+=N*F,v(w,2*I+2*C+1),w[2*I+2*C+1]+=A*P,v(w,2*I+2*C+1),w[2*I+2*C+2]+=N*P,v(w,2*I+2*C+2)}for(I=0;I<b;I++)w[I]=w[2*I+1]<<16|w[2*I];for(I=b;I<2*b;I++)w[I]=0;return new o(w,0)};function v(S,b){for(;(S[b]&65535)!=S[b];)S[b+1]+=S[b]>>>16,S[b]&=65535,b++}function T(S,b){this.g=S,this.h=b}function k(S,b){if(E(b))throw Error("division by zero");if(E(S))return new T(h,h);if(x(S))return b=k(R(S),b),new T(R(b.g),R(b.h));if(x(b))return b=k(S,R(b)),new T(R(b.g),b.h);if(30<S.g.length){if(x(S)||x(b))throw Error("slowDivide_ only works with positive integers.");for(var w=f,I=b;0>=I.l(S);)w=O(w),I=O(I);var C=z(w,1),N=z(I,1);for(I=z(I,2),w=z(w,2);!E(I);){var A=N.add(I);0>=A.l(S)&&(C=C.add(w),N=A),I=z(I,1),w=z(w,1)}return b=y(S,C.j(b)),new T(C,b)}for(C=h;0<=S.l(b);){for(w=Math.max(1,Math.floor(S.m()/b.m())),I=Math.ceil(Math.log(w)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),N=c(w),A=N.j(b);x(A)||0<A.l(S);)w-=I,N=c(w),A=N.j(b);E(N)&&(N=f),C=C.add(N),S=y(S,A)}return new T(C,S)}t.A=function(S){return k(this,S).h},t.and=function(S){for(var b=Math.max(this.g.length,S.g.length),w=[],I=0;I<b;I++)w[I]=this.i(I)&S.i(I);return new o(w,this.h&S.h)},t.or=function(S){for(var b=Math.max(this.g.length,S.g.length),w=[],I=0;I<b;I++)w[I]=this.i(I)|S.i(I);return new o(w,this.h|S.h)},t.xor=function(S){for(var b=Math.max(this.g.length,S.g.length),w=[],I=0;I<b;I++)w[I]=this.i(I)^S.i(I);return new o(w,this.h^S.h)};function O(S){for(var b=S.g.length+1,w=[],I=0;I<b;I++)w[I]=S.i(I)<<1|S.i(I-1)>>>31;return new o(w,S.h)}function z(S,b){var w=b>>5;b%=32;for(var I=S.g.length-w,C=[],N=0;N<I;N++)C[N]=0<b?S.i(N+w)>>>b|S.i(N+w+1)<<32-b:S.i(N+w);return new o(C,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,y2=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Qs=o}).apply(typeof $x<"u"?$x:typeof self<"u"?self:typeof window<"u"?window:{});var gd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var v2,rc,_2,Bd,Sg,w2,x2,b2;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof gd=="object"&&gd];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=n(this);function i(u,g){if(g)e:{var _=r;u=u.split(".");for(var V=0;V<u.length-1;V++){var q=u[V];if(!(q in _))break e;_=_[q]}u=u[u.length-1],V=_[u],g=g(V),g!=V&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var _=0,V=!1,q={next:function(){if(!V&&_<u.length){var W=_++;return{value:g(W,u[W]),done:!1}}return V=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}i("Array.prototype.values",function(u){return u||function(){return s(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function c(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function d(u,g,_){return u.call.apply(u.bind,arguments)}function h(u,g,_){if(!u)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,V),u.apply(g,q)}}return function(){return u.apply(g,arguments)}}function f(u,g,_){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var V=_.slice();return V.push.apply(V,arguments),u.apply(this,V)}}function E(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(V,q,W){for(var te=Array(arguments.length-2),He=2;He<arguments.length;He++)te[He-2]=arguments[He];return g.prototype[q].apply(V,te)}}function x(u){const g=u.length;if(0<g){const _=Array(g);for(let V=0;V<g;V++)_[V]=u[V];return _}return[]}function R(u,g){for(let _=1;_<arguments.length;_++){const V=arguments[_];if(l(V)){const q=u.length||0,W=V.length||0;u.length=q+W;for(let te=0;te<W;te++)u[q+te]=V[te]}else u.push(V)}}class y{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function v(u){return/^[\s\xa0]*$/.test(u)}function T(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function k(u){return k[" "](u),u}k[" "]=function(){};var O=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function z(u,g,_){for(const V in u)g.call(_,u[V],V,u)}function S(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function b(u){const g={};for(const _ in u)g[_]=u[_];return g}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,g){let _,V;for(let q=1;q<arguments.length;q++){V=arguments[q];for(_ in V)u[_]=V[_];for(let W=0;W<w.length;W++)_=w[W],Object.prototype.hasOwnProperty.call(V,_)&&(u[_]=V[_])}}function C(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function N(u){a.setTimeout(()=>{throw u},0)}function A(){var u=L;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class P{constructor(){this.h=this.g=null}add(g,_){const V=F.get();V.set(g,_),this.h?this.h.next=V:this.g=V,this.h=V}}var F=new y(()=>new M,u=>u.reset());class M{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let $,j=!1,L=new P,B=()=>{const u=a.Promise.resolve(void 0);$=()=>{u.then(G)}};var G=()=>{for(var u;u=A();){try{u.h.call(u.g)}catch(_){N(_)}var g=F;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}j=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};a.addEventListener("test",_,g),a.removeEventListener("test",_,g)}catch{}return u}();function ee(u,g){if(Y.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,V=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(O){e:{try{k(g.nodeName);var q=!0;break e}catch{}q=!1}q||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:oe[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&ee.aa.h.call(this)}}E(ee,Y);var oe={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var fe="closure_listenable_"+(1e6*Math.random()|0),ue=0;function _e(u,g,_,V,q){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!V,this.ha=q,this.key=++ue,this.da=this.fa=!1}function we(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Ce(u){this.src=u,this.g={},this.h=0}Ce.prototype.add=function(u,g,_,V,q){var W=u.toString();u=this.g[W],u||(u=this.g[W]=[],this.h++);var te=Pe(u,g,V,q);return-1<te?(g=u[te],_||(g.fa=!1)):(g=new _e(g,this.src,W,!!V,q),g.fa=_,u.push(g)),g};function Be(u,g){var _=g.type;if(_ in u.g){var V=u.g[_],q=Array.prototype.indexOf.call(V,g,void 0),W;(W=0<=q)&&Array.prototype.splice.call(V,q,1),W&&(we(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function Pe(u,g,_,V){for(var q=0;q<u.length;++q){var W=u[q];if(!W.da&&W.listener==g&&W.capture==!!_&&W.ha==V)return q}return-1}var Qe="closure_lm_"+(1e6*Math.random()|0),ge={};function ft(u,g,_,V,q){if(Array.isArray(g)){for(var W=0;W<g.length;W++)ft(u,g[W],_,V,q);return null}return _=bt(_),u&&u[fe]?u.K(g,_,c(V)?!!V.capture:!1,q):Ae(u,g,_,!1,V,q)}function Ae(u,g,_,V,q,W){if(!g)throw Error("Invalid event type");var te=c(q)?!!q.capture:!!q,He=nt(u);if(He||(u[Qe]=He=new Ce(u)),_=He.add(g,_,V,te,W),_.proxy)return _;if(V=se(),_.proxy=V,V.src=u,V.listener=_,u.addEventListener)X||(q=te),q===void 0&&(q=!1),u.addEventListener(g.toString(),V,q);else if(u.attachEvent)u.attachEvent(Rt(g.toString()),V);else if(u.addListener&&u.removeListener)u.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return _}function se(){function u(_){return g.call(u.src,u.listener,_)}const g=ln;return u}function ke(u,g,_,V,q){if(Array.isArray(g))for(var W=0;W<g.length;W++)ke(u,g[W],_,V,q);else V=c(V)?!!V.capture:!!V,_=bt(_),u&&u[fe]?(u=u.i,g=String(g).toString(),g in u.g&&(W=u.g[g],_=Pe(W,_,V,q),-1<_&&(we(W[_]),Array.prototype.splice.call(W,_,1),W.length==0&&(delete u.g[g],u.h--)))):u&&(u=nt(u))&&(g=u.g[g.toString()],u=-1,g&&(u=Pe(g,_,V,q)),(_=-1<u?g[u]:null)&&kt(_))}function kt(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[fe])Be(g.i,u);else{var _=u.type,V=u.proxy;g.removeEventListener?g.removeEventListener(_,V,u.capture):g.detachEvent?g.detachEvent(Rt(_),V):g.addListener&&g.removeListener&&g.removeListener(V),(_=nt(g))?(Be(_,u),_.h==0&&(_.src=null,g[Qe]=null)):we(u)}}}function Rt(u){return u in ge?ge[u]:ge[u]="on"+u}function ln(u,g){if(u.da)u=!0;else{g=new ee(g,this);var _=u.listener,V=u.ha||u.src;u.fa&&kt(u),u=_.call(V,g)}return u}function nt(u){return u=u[Qe],u instanceof Ce?u:null}var xt="__closure_events_fn_"+(1e9*Math.random()>>>0);function bt(u){return typeof u=="function"?u:(u[xt]||(u[xt]=function(g){return u.handleEvent(g)}),u[xt])}function Oe(){U.call(this),this.i=new Ce(this),this.M=this,this.F=null}E(Oe,U),Oe.prototype[fe]=!0,Oe.prototype.removeEventListener=function(u,g,_,V){ke(this,u,g,_,V)};function Me(u,g){var _,V=u.F;if(V)for(_=[];V;V=V.F)_.push(V);if(u=u.M,V=g.type||g,typeof g=="string")g=new Y(g,u);else if(g instanceof Y)g.target=g.target||u;else{var q=g;g=new Y(V,u),I(g,q)}if(q=!0,_)for(var W=_.length-1;0<=W;W--){var te=g.g=_[W];q=Nt(te,V,!0,g)&&q}if(te=g.g=u,q=Nt(te,V,!0,g)&&q,q=Nt(te,V,!1,g)&&q,_)for(W=0;W<_.length;W++)te=g.g=_[W],q=Nt(te,V,!1,g)&&q}Oe.prototype.N=function(){if(Oe.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],V=0;V<_.length;V++)we(_[V]);delete u.g[g],u.h--}}this.F=null},Oe.prototype.K=function(u,g,_,V){return this.i.add(String(u),g,!1,_,V)},Oe.prototype.L=function(u,g,_,V){return this.i.add(String(u),g,!0,_,V)};function Nt(u,g,_,V){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var q=!0,W=0;W<g.length;++W){var te=g[W];if(te&&!te.da&&te.capture==_){var He=te.listener,Ft=te.ha||te.src;te.fa&&Be(u.i,te),q=He.call(Ft,V)!==!1&&q}}return q&&!V.defaultPrevented}function en(u,g,_){if(typeof u=="function")_&&(u=f(u,_));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(u,g||0)}function Ir(u){u.g=en(()=>{u.g=null,u.i&&(u.i=!1,Ir(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Fe extends U{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Ir(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yt(u){U.call(this),this.h=u,this.g={}}E(yt,U);var Tn=[];function Sn(u){z(u.g,function(g,_){this.g.hasOwnProperty(_)&&kt(g)},u),u.g={}}yt.prototype.N=function(){yt.aa.N.call(this),Sn(this)},yt.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Cn=a.JSON.stringify,An=a.JSON.parse,cn=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ir(){}ir.prototype.h=null;function Pt(u){return u.h||(u.h=u.i())}function Hn(){}var sr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ye(){Y.call(this,"d")}E(Ye,Y);function un(){Y.call(this,"c")}E(un,Y);var or={},bo=null;function bi(){return bo=bo||new Oe}or.La="serverreachability";function Eo(u){Y.call(this,or.La,u)}E(Eo,Y);function qr(u){const g=bi();Me(g,new Eo(g))}or.STAT_EVENT="statevent";function Io(u,g){Y.call(this,or.STAT_EVENT,u),this.stat=g}E(Io,Y);function Et(u){const g=bi();Me(g,new Io(g,u))}or.Ma="timingevent";function To(u,g){Y.call(this,or.Ma,u),this.size=g}E(To,Y);function Kn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},g)}function Tr(){this.g=!0}Tr.prototype.xa=function(){this.g=!1};function gl(u,g,_,V,q,W){u.info(function(){if(u.g)if(W)for(var te="",He=W.split("&"),Ft=0;Ft<He.length;Ft++){var ze=He[Ft].split("=");if(1<ze.length){var Kt=ze[0];ze=ze[1];var Gt=Kt.split("_");te=2<=Gt.length&&Gt[1]=="type"?te+(Kt+"="+ze+"&"):te+(Kt+"=redacted&")}}else te=null;else te=W;return"XMLHTTP REQ ("+V+") [attempt "+q+"]: "+g+`
`+_+`
`+te})}function yl(u,g,_,V,q,W,te){u.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+q+"]: "+g+`
`+_+`
`+W+" "+te})}function Sr(u,g,_,V){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+vl(u,_)+(V?" "+V:"")})}function So(u,g){u.info(function(){return"TIMEOUT: "+g})}Tr.prototype.info=function(){};function vl(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var V=_[u];if(!(2>V.length)){var q=V[1];if(Array.isArray(q)&&!(1>q.length)){var W=q[0];if(W!="noop"&&W!="stop"&&W!="close")for(var te=1;te<q.length;te++)q[te]=""}}}}return Cn(_)}catch{return g}}var Ei={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},bs={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Es;function kn(){}E(kn,ir),kn.prototype.g=function(){return new XMLHttpRequest},kn.prototype.i=function(){return{}},Es=new kn;function Gn(u,g,_,V){this.j=u,this.i=g,this.l=_,this.R=V||1,this.U=new yt(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Co}function Co(){this.i=null,this.g="",this.h=!1}var Ao={},Is={};function Ts(u,g,_){u.L=1,u.v=Nu(Dt(g)),u.m=_,u.P=!0,ko(u,null)}function ko(u,g){u.F=Date.now(),Ii(u),u.A=Dt(u.v);var _=u.A,V=u.R;Array.isArray(V)||(V=[String(V)]),Nv(_.i,"t",V),u.C=0,_=u.j.J,u.h=new Co,u.g=Qv(u.j,_?g:null,!u.m),0<u.O&&(u.M=new Fe(f(u.Y,u,u.g),u.O)),g=u.U,_=u.g,V=u.ca;var q="readystatechange";Array.isArray(q)||(q&&(Tn[0]=q.toString()),q=Tn);for(var W=0;W<q.length;W++){var te=ft(_,q[W],V||g.handleEvent,!1,g.h||g);if(!te)break;g.g[te.key]=te}g=u.H?b(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),qr(),gl(u.i,u.u,u.A,u.l,u.R,u.m)}Gn.prototype.ca=function(u){u=u.target;const g=this.M;g&&Gr(u)==3?g.j():this.Y(u)},Gn.prototype.Y=function(u){try{if(u==this.g)e:{const Gt=Gr(this.g);var g=this.g.Ba();const Lo=this.g.Z();if(!(3>Gt)&&(Gt!=3||this.g&&(this.h.h||this.g.oa()||Lv(this.g)))){this.J||Gt!=4||g==7||(g==8||0>=Lo?qr(3):qr(2)),Ti(this);var _=this.g.Z();this.X=_;t:if(Ss(this)){var V=Lv(this.g);u="";var q=V.length,W=Gr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ar(this),Hr(this);var te="";break t}this.h.i=new a.TextDecoder}for(g=0;g<q;g++)this.h.h=!0,u+=this.h.i.decode(V[g],{stream:!(W&&g==q-1)});V.length=0,this.h.g+=u,this.C=0,te=this.h.g}else te=this.g.oa();if(this.o=_==200,yl(this.i,this.u,this.A,this.l,this.R,Gt,_),this.o){if(this.T&&!this.K){t:{if(this.g){var He,Ft=this.g;if((He=Ft.g?Ft.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(He)){var ze=He;break t}}ze=null}if(_=ze)Sr(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Cr(this,_);else{this.o=!1,this.s=3,Et(12),ar(this),Hr(this);break e}}if(this.P){_=!0;let lr;for(;!this.J&&this.C<te.length;)if(lr=_l(this,te),lr==Is){Gt==4&&(this.s=4,Et(14),_=!1),Sr(this.i,this.l,null,"[Incomplete Response]");break}else if(lr==Ao){this.s=4,Et(15),Sr(this.i,this.l,te,"[Invalid Chunk]"),_=!1;break}else Sr(this.i,this.l,lr,null),Cr(this,lr);if(Ss(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Gt!=4||te.length!=0||this.h.h||(this.s=1,Et(16),_=!1),this.o=this.o&&_,!_)Sr(this.i,this.l,te,"[Invalid Chunked Response]"),ar(this),Hr(this);else if(0<te.length&&!this.W){this.W=!0;var Kt=this.j;Kt.g==this&&Kt.ba&&!Kt.M&&(Kt.j.info("Great, no buffering proxy detected. Bytes received: "+te.length),ep(Kt),Kt.M=!0,Et(11))}}else Sr(this.i,this.l,te,null),Cr(this,te);Gt==4&&ar(this),this.o&&!this.J&&(Gt==4?Hv(this.j,this):(this.o=!1,Ii(this)))}else ak(this.g),_==400&&0<te.indexOf("Unknown SID")?(this.s=3,Et(12)):(this.s=0,Et(13)),ar(this),Hr(this)}}}catch{}finally{}};function Ss(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function _l(u,g){var _=u.C,V=g.indexOf(`
`,_);return V==-1?Is:(_=Number(g.substring(_,V)),isNaN(_)?Ao:(V+=1,V+_>g.length?Is:(g=g.slice(V,V+_),u.C=V+_,g)))}Gn.prototype.cancel=function(){this.J=!0,ar(this)};function Ii(u){u.S=Date.now()+u.I,Ro(u,u.I)}function Ro(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Kn(f(u.ba,u),g)}function Ti(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Gn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(So(this.i,this.A),this.L!=2&&(qr(),Et(17)),ar(this),this.s=2,Hr(this)):Ro(this,this.S-u)};function Hr(u){u.j.G==0||u.J||Hv(u.j,u)}function ar(u){Ti(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Sn(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Cr(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||wl(_.h,u))){if(!u.K&&wl(_.h,u)&&_.G==3){try{var V=_.Da.g.parse(g)}catch{V=null}if(Array.isArray(V)&&V.length==3){var q=V;if(q[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Mu(_),Ou(_);else break e;Zf(_),Et(18)}}else _.za=q[1],0<_.za-_.T&&37500>q[2]&&_.F&&_.v==0&&!_.C&&(_.C=Kn(f(_.Za,_),6e3));if(1>=Ar(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Cs(_,11)}else if((u.K||_.g==u)&&Mu(_),!v(g))for(q=_.Da.g.parse(g),g=0;g<q.length;g++){let ze=q[g];if(_.T=ze[0],ze=ze[1],_.G==2)if(ze[0]=="c"){_.K=ze[1],_.ia=ze[2];const Kt=ze[3];Kt!=null&&(_.la=Kt,_.j.info("VER="+_.la));const Gt=ze[4];Gt!=null&&(_.Aa=Gt,_.j.info("SVER="+_.Aa));const Lo=ze[5];Lo!=null&&typeof Lo=="number"&&0<Lo&&(V=1.5*Lo,_.L=V,_.j.info("backChannelRequestTimeoutMs_="+V)),V=_;const lr=u.g;if(lr){const ju=lr.g?lr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ju){var W=V.h;W.g||ju.indexOf("spdy")==-1&&ju.indexOf("quic")==-1&&ju.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(Vo(W,W.h),W.h=null))}if(V.D){const tp=lr.g?lr.g.getResponseHeader("X-HTTP-Session-Id"):null;tp&&(V.ya=tp,Xe(V.I,V.D,tp))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),V=_;var te=u;if(V.qa=Wv(V,V.J?V.ia:null,V.W),te.K){xl(V.h,te);var He=te,Ft=V.L;Ft&&(He.I=Ft),He.B&&(Ti(He),Ii(He)),V.g=te}else Bv(V);0<_.i.length&&zu(_)}else ze[0]!="stop"&&ze[0]!="close"||Cs(_,7);else _.G==3&&(ze[0]=="stop"||ze[0]=="close"?ze[0]=="stop"?Cs(_,7):Jf(_):ze[0]!="noop"&&_.l&&_.l.ta(ze),_.v=0)}}qr(4)}catch{}}var No=class{constructor(u,g){this.g=u,this.map=g}};function Po(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Do(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Ar(u){return u.h?1:u.g?u.g.size:0}function wl(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Vo(u,g){u.g?u.g.add(g):u.h=g}function xl(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}Po.prototype.cancel=function(){if(this.i=bl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function bl(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return x(u.i)}function xe(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var g=[],_=u.length,V=0;V<_;V++)g.push(u[V]);return g}g=[],_=0;for(V in u)g[_++]=u[V];return g}function ye(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const V in u)g[_++]=V;return g}}}function Le(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=ye(u),V=xe(u),q=V.length,W=0;W<q;W++)g.call(void 0,V[W],_&&_[W],u)}var Ee=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Te(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var V=u[_].indexOf("="),q=null;if(0<=V){var W=u[_].substring(0,V);q=u[_].substring(V+1)}else W=u[_];g(W,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function lt(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof lt){this.h=u.h,Kr(this,u.j),this.o=u.o,this.g=u.g,Oo(this,u.s),this.l=u.l;var g=u.i,_=new Tl;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),Cv(this,_),this.m=u.m}else u&&(g=String(u).match(Ee))?(this.h=!1,Kr(this,g[1]||"",!0),this.o=El(g[2]||""),this.g=El(g[3]||"",!0),Oo(this,g[4]),this.l=El(g[5]||"",!0),Cv(this,g[6]||"",!0),this.m=El(g[7]||"")):(this.h=!1,this.i=new Tl(null,this.h))}lt.prototype.toString=function(){var u=[],g=this.j;g&&u.push(Il(g,Av,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(Il(g,Av,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(Il(_,_.charAt(0)=="/"?XA:YA,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",Il(_,ZA)),u.join("")};function Dt(u){return new lt(u)}function Kr(u,g,_){u.j=_?El(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Oo(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function Cv(u,g,_){g instanceof Tl?(u.i=g,ek(u.i,u.h)):(_||(g=Il(g,JA)),u.i=new Tl(g,u.h))}function Xe(u,g,_){u.i.set(g,_)}function Nu(u){return Xe(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function El(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function Il(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,QA),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function QA(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Av=/[#\/\?@]/g,YA=/[#\?:]/g,XA=/[#\?]/g,JA=/[#\?@]/g,ZA=/#/g;function Tl(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Si(u){u.g||(u.g=new Map,u.h=0,u.i&&Te(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}t=Tl.prototype,t.add=function(u,g){Si(this),this.i=null,u=zo(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function kv(u,g){Si(u),g=zo(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function Rv(u,g){return Si(u),g=zo(u,g),u.g.has(g)}t.forEach=function(u,g){Si(this),this.g.forEach(function(_,V){_.forEach(function(q){u.call(g,q,V,this)},this)},this)},t.na=function(){Si(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let V=0;V<g.length;V++){const q=u[V];for(let W=0;W<q.length;W++)_.push(g[V])}return _},t.V=function(u){Si(this);let g=[];if(typeof u=="string")Rv(this,u)&&(g=g.concat(this.g.get(zo(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},t.set=function(u,g){return Si(this),this.i=null,u=zo(this,u),Rv(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Nv(u,g,_){kv(u,g),0<_.length&&(u.i=null,u.g.set(zo(u,g),x(_)),u.h+=_.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var V=g[_];const W=encodeURIComponent(String(V)),te=this.V(V);for(V=0;V<te.length;V++){var q=W;te[V]!==""&&(q+="="+encodeURIComponent(String(te[V]))),u.push(q)}}return this.i=u.join("&")};function zo(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function ek(u,g){g&&!u.j&&(Si(u),u.i=null,u.g.forEach(function(_,V){var q=V.toLowerCase();V!=q&&(kv(this,V),Nv(this,q,_))},u)),u.j=g}function tk(u,g){const _=new Tr;if(a.Image){const V=new Image;V.onload=m(Ci,_,"TestLoadImage: loaded",!0,g,V),V.onerror=m(Ci,_,"TestLoadImage: error",!1,g,V),V.onabort=m(Ci,_,"TestLoadImage: abort",!1,g,V),V.ontimeout=m(Ci,_,"TestLoadImage: timeout",!1,g,V),a.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=u}else g(!1)}function nk(u,g){const _=new Tr,V=new AbortController,q=setTimeout(()=>{V.abort(),Ci(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:V.signal}).then(W=>{clearTimeout(q),W.ok?Ci(_,"TestPingServer: ok",!0,g):Ci(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(q),Ci(_,"TestPingServer: error",!1,g)})}function Ci(u,g,_,V,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),V(_)}catch{}}function rk(){this.g=new cn}function ik(u,g,_){const V=_||"";try{Le(u,function(q,W){let te=q;c(q)&&(te=Cn(q)),g.push(V+W+"="+encodeURIComponent(te))})}catch(q){throw g.push(V+"type="+encodeURIComponent("_badmap")),q}}function Pu(u){this.l=u.Ub||null,this.j=u.eb||!1}E(Pu,ir),Pu.prototype.g=function(){return new Du(this.l,this.j)},Pu.prototype.i=function(u){return function(){return u}}({});function Du(u,g){Oe.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Du,Oe),t=Du.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Cl(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Sl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Cl(this)),this.g&&(this.readyState=3,Cl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Pv(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Pv(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?Sl(this):Cl(this),this.readyState==3&&Pv(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,Sl(this))},t.Qa=function(u){this.g&&(this.response=u,Sl(this))},t.ga=function(){this.g&&Sl(this)};function Sl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Cl(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function Cl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Du.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function Dv(u){let g="";return z(u,function(_,V){g+=V,g+=":",g+=_,g+=`\r
`}),g}function Xf(u,g,_){e:{for(V in _){var V=!1;break e}V=!0}V||(_=Dv(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):Xe(u,g,_))}function ct(u){Oe.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(ct,Oe);var sk=/^https?$/i,ok=["POST","PUT"];t=ct.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,_,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Es.g(),this.v=this.o?Pt(this.o):Pt(Es),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(W){Vv(this,W);return}if(u=_||"",_=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var q in V)_.set(q,V[q]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const W of V.keys())_.set(W,V.get(W));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(_.keys()).find(W=>W.toLowerCase()=="content-type"),q=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(ok,g,void 0))||V||q||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,te]of _)this.g.setRequestHeader(W,te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Mv(this),this.u=!0,this.g.send(u),this.u=!1}catch(W){Vv(this,W)}};function Vv(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Ov(u),Vu(u)}function Ov(u){u.A||(u.A=!0,Me(u,"complete"),Me(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Me(this,"complete"),Me(this,"abort"),Vu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Vu(this,!0)),ct.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?zv(this):this.bb())},t.bb=function(){zv(this)};function zv(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Gr(u)!=4||u.Z()!=2)){if(u.u&&Gr(u)==4)en(u.Ea,0,u);else if(Me(u,"readystatechange"),Gr(u)==4){u.h=!1;try{const te=u.Z();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var V;if(V=te===0){var q=String(u.D).match(Ee)[1]||null;!q&&a.self&&a.self.location&&(q=a.self.location.protocol.slice(0,-1)),V=!sk.test(q?q.toLowerCase():"")}_=V}if(_)Me(u,"complete"),Me(u,"success");else{u.m=6;try{var W=2<Gr(u)?u.g.statusText:""}catch{W=""}u.l=W+" ["+u.Z()+"]",Ov(u)}}finally{Vu(u)}}}}function Vu(u,g){if(u.g){Mv(u);const _=u.g,V=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||Me(u,"ready");try{_.onreadystatechange=V}catch{}}}function Mv(u){u.I&&(a.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Gr(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Gr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),An(g)}};function Lv(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function ak(u){const g={};u=(u.g&&2<=Gr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<u.length;V++){if(v(u[V]))continue;var _=C(u[V]);const q=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const W=g[q]||[];g[q]=W,W.push(_)}S(g,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Al(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function jv(u){this.Aa=0,this.i=[],this.j=new Tr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Al("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Al("baseRetryDelayMs",5e3,u),this.cb=Al("retryDelaySeedMs",1e4,u),this.Wa=Al("forwardChannelMaxRetries",2,u),this.wa=Al("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Po(u&&u.concurrentRequestLimit),this.Da=new rk,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=jv.prototype,t.la=8,t.G=1,t.connect=function(u,g,_,V){Et(0),this.W=u,this.H=g||{},_&&V!==void 0&&(this.H.OSID=_,this.H.OAID=V),this.F=this.X,this.I=Wv(this,null,this.W),zu(this)};function Jf(u){if(Fv(u),u.G==3){var g=u.U++,_=Dt(u.I);if(Xe(_,"SID",u.K),Xe(_,"RID",g),Xe(_,"TYPE","terminate"),kl(u,_),g=new Gn(u,u.j,g),g.L=2,g.v=Nu(Dt(_)),_=!1,a.navigator&&a.navigator.sendBeacon)try{_=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&a.Image&&(new Image().src=g.v,_=!0),_||(g.g=Qv(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Ii(g)}Gv(u)}function Ou(u){u.g&&(ep(u),u.g.cancel(),u.g=null)}function Fv(u){Ou(u),u.u&&(a.clearTimeout(u.u),u.u=null),Mu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function zu(u){if(!Do(u.h)&&!u.s){u.s=!0;var g=u.Ga;$||B(),j||($(),j=!0),L.add(g,u),u.B=0}}function lk(u,g){return Ar(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Kn(f(u.Ga,u,g),Kv(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const q=new Gn(this,this.j,u);let W=this.o;if(this.S&&(W?(W=b(W),I(W,this.S)):W=this.S),this.m!==null||this.O||(q.H=W,W=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var V=this.i[_];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(g+=V,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=Uv(this,q,g),_=Dt(this.I),Xe(_,"RID",u),Xe(_,"CVER",22),this.D&&Xe(_,"X-HTTP-Session-Id",this.D),kl(this,_),W&&(this.O?g="headers="+encodeURIComponent(String(Dv(W)))+"&"+g:this.m&&Xf(_,this.m,W)),Vo(this.h,q),this.Ua&&Xe(_,"TYPE","init"),this.P?(Xe(_,"$req",g),Xe(_,"SID","null"),q.T=!0,Ts(q,_,null)):Ts(q,_,g),this.G=2}}else this.G==3&&(u?$v(this,u):this.i.length==0||Do(this.h)||$v(this))};function $v(u,g){var _;g?_=g.l:_=u.U++;const V=Dt(u.I);Xe(V,"SID",u.K),Xe(V,"RID",_),Xe(V,"AID",u.T),kl(u,V),u.m&&u.o&&Xf(V,u.m,u.o),_=new Gn(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Uv(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Vo(u.h,_),Ts(_,V,g)}function kl(u,g){u.H&&z(u.H,function(_,V){Xe(g,V,_)}),u.l&&Le({},function(_,V){Xe(g,V,_)})}function Uv(u,g,_){_=Math.min(u.i.length,_);var V=u.l?f(u.l.Na,u.l,u):null;e:{var q=u.i;let W=-1;for(;;){const te=["count="+_];W==-1?0<_?(W=q[0].g,te.push("ofs="+W)):W=0:te.push("ofs="+W);let He=!0;for(let Ft=0;Ft<_;Ft++){let ze=q[Ft].g;const Kt=q[Ft].map;if(ze-=W,0>ze)W=Math.max(0,q[Ft].g-100),He=!1;else try{ik(Kt,te,"req"+ze+"_")}catch{V&&V(Kt)}}if(He){V=te.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,V}function Bv(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;$||B(),j||($(),j=!0),L.add(g,u),u.v=0}}function Zf(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Kn(f(u.Fa,u),Kv(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,qv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Kn(f(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Et(10),Ou(this),qv(this))};function ep(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function qv(u){u.g=new Gn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Dt(u.qa);Xe(g,"RID","rpc"),Xe(g,"SID",u.K),Xe(g,"AID",u.T),Xe(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Xe(g,"TO",u.ja),Xe(g,"TYPE","xmlhttp"),kl(u,g),u.m&&u.o&&Xf(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Nu(Dt(g)),_.m=null,_.P=!0,ko(_,u)}t.Za=function(){this.C!=null&&(this.C=null,Ou(this),Zf(this),Et(19))};function Mu(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Hv(u,g){var _=null;if(u.g==g){Mu(u),ep(u),u.g=null;var V=2}else if(wl(u.h,g))_=g.D,xl(u.h,g),V=1;else return;if(u.G!=0){if(g.o)if(V==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var q=u.B;V=bi(),Me(V,new To(V,_)),zu(u)}else Bv(u);else if(q=g.s,q==3||q==0&&0<g.X||!(V==1&&lk(u,g)||V==2&&Zf(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),q){case 1:Cs(u,5);break;case 4:Cs(u,10);break;case 3:Cs(u,6);break;default:Cs(u,2)}}}function Kv(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Cs(u,g){if(u.j.info("Error code "+g),g==2){var _=f(u.fb,u),V=u.Xa;const q=!V;V=new lt(V||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Kr(V,"https"),Nu(V),q?tk(V.toString(),_):nk(V.toString(),_)}else Et(2);u.G=0,u.l&&u.l.sa(g),Gv(u),Fv(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Et(2)):(this.j.info("Failed to ping google.com"),Et(1))};function Gv(u){if(u.G=0,u.ka=[],u.l){const g=bl(u.h);(g.length!=0||u.i.length!=0)&&(R(u.ka,g),R(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function Wv(u,g,_){var V=_ instanceof lt?Dt(_):new lt(_);if(V.g!="")g&&(V.g=g+"."+V.g),Oo(V,V.s);else{var q=a.location;V=q.protocol,g=g?g+"."+q.hostname:q.hostname,q=+q.port;var W=new lt(null);V&&Kr(W,V),g&&(W.g=g),q&&Oo(W,q),_&&(W.l=_),V=W}return _=u.D,g=u.ya,_&&g&&Xe(V,_,g),Xe(V,"VER",u.la),kl(u,V),V}function Qv(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new ct(new Pu({eb:_})):new ct(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Yv(){}t=Yv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Lu(){}Lu.prototype.g=function(u,g){return new Rn(u,g)};function Rn(u,g){Oe.call(this),this.g=new jv(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!v(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!v(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Mo(this)}E(Rn,Oe),Rn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Rn.prototype.close=function(){Jf(this.g)},Rn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=Cn(u),u=_);g.i.push(new No(g.Ya++,u)),g.G==3&&zu(g)},Rn.prototype.N=function(){this.g.l=null,delete this.j,Jf(this.g),delete this.g,Rn.aa.N.call(this)};function Xv(u){Ye.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}E(Xv,Ye);function Jv(){un.call(this),this.status=1}E(Jv,un);function Mo(u){this.g=u}E(Mo,Yv),Mo.prototype.ua=function(){Me(this.g,"a")},Mo.prototype.ta=function(u){Me(this.g,new Xv(u))},Mo.prototype.sa=function(u){Me(this.g,new Jv)},Mo.prototype.ra=function(){Me(this.g,"b")},Lu.prototype.createWebChannel=Lu.prototype.g,Rn.prototype.send=Rn.prototype.o,Rn.prototype.open=Rn.prototype.m,Rn.prototype.close=Rn.prototype.close,b2=function(){return new Lu},x2=function(){return bi()},w2=or,Sg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ei.NO_ERROR=0,Ei.TIMEOUT=8,Ei.HTTP_ERROR=6,Bd=Ei,bs.COMPLETE="complete",_2=bs,Hn.EventType=sr,sr.OPEN="a",sr.CLOSE="b",sr.ERROR="c",sr.MESSAGE="d",Oe.prototype.listen=Oe.prototype.K,rc=Hn,ct.prototype.listenOnce=ct.prototype.L,ct.prototype.getLastError=ct.prototype.Ka,ct.prototype.getLastErrorCode=ct.prototype.Ba,ct.prototype.getStatus=ct.prototype.Z,ct.prototype.getResponseJson=ct.prototype.Oa,ct.prototype.getResponseText=ct.prototype.oa,ct.prototype.send=ct.prototype.ea,ct.prototype.setWithCredentials=ct.prototype.Ha,v2=ct}).apply(typeof gd<"u"?gd:typeof self<"u"?self:typeof window<"u"?window:{});const Ux="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Xt.UNAUTHENTICATED=new Xt(null),Xt.GOOGLE_CREDENTIALS=new Xt("google-credentials-uid"),Xt.FIRST_PARTY=new Xt("first-party-uid"),Xt.MOCK_USER=new Xt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ul="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oo=new kf("@firebase/firestore");function Xo(){return oo.logLevel}function J(t,...e){if(oo.logLevel<=Re.DEBUG){const n=e.map(Ny);oo.debug(`Firestore (${ul}): ${t}`,...n)}}function mt(t,...e){if(oo.logLevel<=Re.ERROR){const n=e.map(Ny);oo.error(`Firestore (${ul}): ${t}`,...n)}}function eu(t,...e){if(oo.logLevel<=Re.WARN){const n=e.map(Ny);oo.warn(`Firestore (${ul}): ${t}`,...n)}}function Ny(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ce(t="Unexpected state"){const e=`FIRESTORE (${ul}) INTERNAL ASSERTION FAILED: `+t;throw mt(e),new Error(e)}function he(t,e){t||ce()}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ne extends Er{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S9{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class C9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Xt.UNAUTHENTICATED))}shutdown(){}}class A9{constructor(e){this.t=e,this.currentUser=Xt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){he(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Lr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Lr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Lr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(he(typeof r.accessToken=="string"),new S9(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string"),new Xt(e)}}class k9{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Xt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class R9{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new k9(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Xt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class N9{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class P9{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){he(this.o===void 0);const r=s=>{s.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,J("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string"),this.R=n.token,new N9(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D9(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=D9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function ve(t,e){return t<e?-1:t>e?1:0}function Ua(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function I2(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ot{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ne(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ne(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ne(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return ot.fromMillis(Date.now())}static fromDate(e){return ot.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new ot(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ve(this.nanoseconds,e.nanoseconds):ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pe(e)}static min(){return new pe(new ot(0,0))}static max(){return new pe(new ot(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tu{constructor(e,n,r){n===void 0?n=0:n>e.length&&ce(),r===void 0?r=e.length-n:r>e.length-n&&ce(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return tu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof tu?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class je extends tu{construct(e,n,r){return new je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ne(Q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new je(n)}static emptyPath(){return new je([])}}const V9=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class it extends tu{construct(e,n,r){return new it(e,n,r)}static isValidIdentifier(e){return V9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),it.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new it(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ne(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ne(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ne(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ne(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new it(n)}static emptyPath(){return new it([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class re{constructor(e){this.path=e}static fromPath(e){return new re(je.fromString(e))}static fromName(e){return new re(je.fromString(e).popFirst(5))}static empty(){return new re(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new re(new je(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Cg(t){return t.fields.find(e=>e.kind===2)}function Ds(t){return t.fields.filter(e=>e.kind!==2)}Fh.UNKNOWN_ID=-1;class qd{constructor(e,n){this.fieldPath=e,this.kind=n}}class nu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new nu(0,Un.min())}}function T2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=pe.fromTimestamp(r===1e9?new ot(n+1,0):new ot(n,r));return new Un(i,re.empty(),e)}function S2(t){return new Un(t.readTime,t.key,-1)}class Un{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Un(pe.min(),re.empty(),-1)}static max(){return new Un(pe.max(),re.empty(),-1)}}function Py(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=re.comparator(t.documentKey,e.documentKey),n!==0?n:ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class A2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ys(t){if(t.code!==Q.FAILED_PRECONDITION||t.message!==C2)throw t;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ce(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new H((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof H?n:H.resolve(n)}catch(n){return H.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):H.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):H.reject(n)}static resolve(e){return new H((n,r)=>{n(e)})}static reject(e){return new H((n,r)=>{r(e)})}static waitFor(e){return new H((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=H.resolve(!1);for(const r of e)n=n.next(i=>i?H.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new H((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(d=>{o[c]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new H((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Lr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new vc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Dy(r.target.error);this.V.reject(new vc(e,i))}}static open(e,n,r,i){try{return new Df(n,e.transaction(i,r))}catch(s){throw new vc(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(J("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new z9(n)}}class ss{constructor(e,n,r){this.name=e,this.version=n,this.p=r,ss.S(St())===12.2&&mt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return J("SimpleDb","Removing database:",e),Vs(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!vy())return!1;if(ss.v())return!0;const e=St(),n=ss.S(e),r=0<n&&n<10,i=k2(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(J("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new vc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new ne(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ne(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new vc(e,o))},i.onupgradeneeded=s=>{J("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{J("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Df.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),H.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(J("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function k2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class O9{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Vs(this.B.delete())}}class vc extends ne{constructor(e,n){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function vs(t){return t.name==="IndexedDbTransactionError"}class z9{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(J("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(J("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Vs(r)}add(e){return J("SimpleDb","ADD",this.store.name,e,e),Vs(this.store.add(e))}get(e){return Vs(this.store.get(e)).next(n=>(n===void 0&&(n=null),J("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return J("SimpleDb","DELETE",this.store.name,e),Vs(this.store.delete(e))}count(){return J("SimpleDb","COUNT",this.store.name),Vs(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new H((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new H((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){J("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new H((r,i)=>{n.onerror=s=>{const o=Dy(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new H((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new O9(a),c=n(a.primaryKey,a.value,l);if(c instanceof H){const d=c.catch(h=>(l.done(),H.reject(h)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>H.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Vs(t){return new H((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Dy(r.target.error);n(i)}})}let Bx=!1;function Dy(t){const e=ss.S(St());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Bx||(Bx=!0,setTimeout(()=>{throw r},0)),r}}return t}class M9{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){J("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{J("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){vs(n)?J("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await ys(n)}await this.X(6e4)})}}class L9{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return H.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return J("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(J("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=S2(s);Py(o,r)>0&&(r=o)}),new Un(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}gn.oe=-1;function Vf(t){return t==null}function ru(t){return t===0&&1/t==-1/0}function R2(t){return typeof t=="number"&&Number.isInteger(t)&&!ru(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=qx(e)),e=j9(t.get(n),e);return qx(e)}function j9(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function qx(t){return t+""}function Pr(t){const e=t.length;if(he(e>=2),e===2)return he(t.charAt(0)===""&&t.charAt(1)===""),je.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&ce(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:ce()}s=o+2}return new je(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hx=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(t,e){return[t,rn(e)]}function N2(t,e,n){return[t,rn(e),n]}const F9={},$9=["prefixPath","collectionGroup","readTime","documentId"],U9=["prefixPath","collectionGroup","documentId"],B9=["collectionGroup","readTime","prefixPath","documentId"],q9=["canonicalId","targetId"],H9=["targetId","path"],K9=["path","targetId"],G9=["collectionId","parent"],W9=["indexId","uid"],Q9=["uid","sequenceNumber"],Y9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],X9=["indexId","uid","orderedDocumentKey"],J9=["userId","collectionPath","documentId"],Z9=["userId","collectionPath","largestBatchId"],eF=["userId","collectionGroup","largestBatchId"],P2=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],tF=[...P2,"documentOverlays"],D2=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],V2=D2,Vy=[...V2,"indexConfiguration","indexState","indexEntries"],nF=Vy,rF=[...Vy,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ag extends A2{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function At(t,e){const n=de(t);return ss.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function dl(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function O2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e,n){this.comparator=e,this.root=n||Bt.EMPTY}insert(e,n){return new We(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(e){return new We(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new yd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new yd(this.root,e,this.comparator,!1)}getReverseIterator(){return new yd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new yd(this.root,e,this.comparator,!0)}}class yd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Bt.RED,this.left=i??Bt.EMPTY,this.right=s??Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Bt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Bt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ce();const e=this.left.check();if(e!==this.right.check())throw ce();return e+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1;Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw ce()}get value(){throw ce()}get color(){throw ce()}get left(){throw ce()}get right(){throw ce()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Bt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.comparator=e,this.data=new We(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Gx(this.data.getIterator())}getIteratorFrom(e){return new Gx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof qe)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new qe(this.comparator);return n.data=e,n}}class Gx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Go(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.fields=e,e.sort(it.comparator)}static empty(){return new Jn([])}unionWith(e){let n=new qe(it.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Jn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ua(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new z2("Invalid base64 string: "+s):s}}(e);return new gt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new gt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}gt.EMPTY_BYTE_STRING=new gt("");const iF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vi(t){if(he(!!t),typeof t=="string"){let e=0;const n=iF.exec(t);if(he(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:et(t.seconds),nanos:et(t.nanos)}}function et(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function us(t){return typeof t=="string"?gt.fromBase64String(t):gt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oy(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function zy(t){const e=t.mapValue.fields.__previous_value__;return Oy(e)?zy(e):e}function iu(t){const e=vi(t.mapValue.fields.__local_write_time__.timestampValue);return new ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sF{constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class ao{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ao("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ao&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Kd={nullValue:"NULL_VALUE"};function lo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Oy(t)?4:M2(t)?9007199254740991:Of(t)?10:11:ce()}function Fr(t,e){if(t===e)return!0;const n=lo(t);if(n!==lo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return iu(t).isEqual(iu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=vi(i.timestampValue),a=vi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return us(i.bytesValue).isEqual(us(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return et(i.geoPointValue.latitude)===et(s.geoPointValue.latitude)&&et(i.geoPointValue.longitude)===et(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return et(i.integerValue)===et(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=et(i.doubleValue),a=et(s.doubleValue);return o===a?ru(o)===ru(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Ua(t.arrayValue.values||[],e.arrayValue.values||[],Fr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Kx(o)!==Kx(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Fr(o[l],a[l])))return!1;return!0}(t,e);default:return ce()}}function su(t,e){return(t.values||[]).find(n=>Fr(n,e))!==void 0}function ds(t,e){if(t===e)return 0;const n=lo(t),r=lo(e);if(n!==r)return ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ve(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=et(s.integerValue||s.doubleValue),l=et(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return Wx(t.timestampValue,e.timestampValue);case 4:return Wx(iu(t),iu(e));case 5:return ve(t.stringValue,e.stringValue);case 6:return function(s,o){const a=us(s),l=us(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=ve(a[c],l[c]);if(d!==0)return d}return ve(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ve(et(s.latitude),et(o.latitude));return a!==0?a:ve(et(s.longitude),et(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Qx(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,d;const h=s.fields||{},f=o.fields||{},m=(a=h.value)===null||a===void 0?void 0:a.arrayValue,E=(l=f.value)===null||l===void 0?void 0:l.arrayValue,x=ve(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((d=E==null?void 0:E.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:Qx(m,E)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ki.mapValue&&o===Ki.mapValue)return 0;if(s===Ki.mapValue)return 1;if(o===Ki.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const f=ve(l[h],d[h]);if(f!==0)return f;const m=ds(a[l[h]],c[d[h]]);if(m!==0)return m}return ve(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ce()}}function Wx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ve(t,e);const n=vi(t),r=vi(e),i=ve(n.seconds,r.seconds);return i!==0?i:ve(n.nanos,r.nanos)}function Qx(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ds(n[i],r[i]);if(s)return s}return ve(n.length,r.length)}function Ba(t){return kg(t)}function kg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=vi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return us(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return re.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=kg(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${kg(n.fields[o])}`;return i+"}"}(t.mapValue):ce()}function ou(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Rg(t){return!!t&&"integerValue"in t}function au(t){return!!t&&"arrayValue"in t}function Yx(t){return!!t&&"nullValue"in t}function Xx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Gd(t){return!!t&&"mapValue"in t}function Of(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function _c(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return dl(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=_c(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=_c(t.arrayValue.values[n]);return e}return Object.assign({},t)}function M2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const L2={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function oF(t){return"nullValue"in t?Kd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?ou(ao.empty(),re.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Of(t)?L2:{mapValue:{}}:ce()}function aF(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?ou(ao.empty(),re.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?L2:"mapValue"in t?Of(t)?{mapValue:{}}:Ki:ce()}function Jx(t,e){const n=ds(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Zx(t,e){const n=ds(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.value=e}static empty(){return new fn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Gd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=_c(n)}setAll(e){let n=it.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=_c(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Gd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Fr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Gd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){dl(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new fn(_c(this.value))}}function j2(t){const e=[];return dl(t.fields,(n,r)=>{const i=new it([n]);if(Gd(r)){const s=j2(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Jn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new dt(e,0,pe.min(),pe.min(),pe.min(),fn.empty(),0)}static newFoundDocument(e,n,r,i){return new dt(e,1,n,pe.min(),r,i,0)}static newNoDocument(e,n){return new dt(e,2,n,pe.min(),pe.min(),fn.empty(),0)}static newUnknownDocument(e,n){return new dt(e,3,n,pe.min(),pe.min(),fn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=fn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=fn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n){this.position=e,this.inclusive=n}}function e1(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=re.comparator(re.fromName(o.referenceValue),n.key):r=ds(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function t1(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Fr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $h{constructor(e,n="asc"){this.field=e,this.dir=n}}function lF(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F2{}class Ne extends F2{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new cF(e,n,r):n==="array-contains"?new hF(e,r):n==="in"?new K2(e,r):n==="not-in"?new fF(e,r):n==="array-contains-any"?new pF(e,r):new Ne(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new uF(e,r):new dF(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ds(n,this.value)):n!==null&&lo(this.value)===lo(n)&&this.matchesComparison(ds(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ce()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $e extends F2{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new $e(e,n)}matches(e){return Ha(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ha(t){return t.op==="and"}function Ng(t){return t.op==="or"}function My(t){return $2(t)&&Ha(t)}function $2(t){for(const e of t.filters)if(e instanceof $e)return!1;return!0}function Pg(t){if(t instanceof Ne)return t.field.canonicalString()+t.op.toString()+Ba(t.value);if(My(t))return t.filters.map(e=>Pg(e)).join(",");{const e=t.filters.map(n=>Pg(n)).join(",");return`${t.op}(${e})`}}function U2(t,e){return t instanceof Ne?function(r,i){return i instanceof Ne&&r.op===i.op&&r.field.isEqual(i.field)&&Fr(r.value,i.value)}(t,e):t instanceof $e?function(r,i){return i instanceof $e&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&U2(o,i.filters[a]),!0):!1}(t,e):void ce()}function B2(t,e){const n=t.filters.concat(e);return $e.create(n,t.op)}function q2(t){return t instanceof Ne?function(n){return`${n.field.canonicalString()} ${n.op} ${Ba(n.value)}`}(t):t instanceof $e?function(n){return n.op.toString()+" {"+n.getFilters().map(q2).join(" ,")+"}"}(t):"Filter"}class cF extends Ne{constructor(e,n,r){super(e,n,r),this.key=re.fromName(r.referenceValue)}matches(e){const n=re.comparator(e.key,this.key);return this.matchesComparison(n)}}class uF extends Ne{constructor(e,n){super(e,"in",n),this.keys=H2("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class dF extends Ne{constructor(e,n){super(e,"not-in",n),this.keys=H2("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function H2(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>re.fromName(r.referenceValue))}class hF extends Ne{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return au(n)&&su(n.arrayValue,this.value)}}class K2 extends Ne{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&su(this.value.arrayValue,n)}}class fF extends Ne{constructor(e,n){super(e,"not-in",n)}matches(e){if(su(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!su(this.value.arrayValue,n)}}class pF extends Ne{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!au(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>su(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mF{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function Dg(t,e=null,n=[],r=[],i=null,s=null,o=null){return new mF(t,e,n,r,i,s,o)}function co(t){const e=de(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Pg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),Vf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Ba(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Ba(r)).join(",")),e.ue=n}return e.ue}function Iu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!lF(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!U2(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!t1(t.startAt,e.startAt)&&t1(t.endAt,e.endAt)}function Uh(t){return re.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Bh(t,e){return t.filters.filter(n=>n instanceof Ne&&n.field.isEqual(e))}function n1(t,e,n){let r=Kd,i=!0;for(const s of Bh(t,e)){let o=Kd,a=!0;switch(s.op){case"<":case"<=":o=oF(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Kd}Jx({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Jx({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function r1(t,e,n){let r=Ki,i=!0;for(const s of Bh(t,e)){let o=Ki,a=!0;switch(s.op){case">=":case">":o=aF(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ki}Zx({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Zx({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function G2(t,e,n,r,i,s,o,a){return new Tu(t,e,n,r,i,s,o,a)}function zf(t){return new Tu(t)}function i1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function W2(t){return t.collectionGroup!==null}function wc(t){const e=de(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new qe(it.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new $h(s,r))}),n.has(it.keyField().canonicalString())||e.ce.push(new $h(it.keyField(),r))}return e.ce}function Ln(t){const e=de(t);return e.le||(e.le=gF(e,wc(t))),e.le}function gF(t,e){if(t.limitType==="F")return Dg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new $h(i.field,s)});const n=t.endAt?new qa(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new qa(t.startAt.position,t.startAt.inclusive):null;return Dg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Vg(t,e){const n=t.filters.concat([e]);return new Tu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Og(t,e,n){return new Tu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Mf(t,e){return Iu(Ln(t),Ln(e))&&t.limitType===e.limitType}function Q2(t){return`${co(Ln(t))}|lt:${t.limitType}`}function Jo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>q2(i)).join(", ")}]`),Vf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Ba(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Ba(i)).join(",")),`Target(${r})`}(Ln(t))}; limitType=${t.limitType})`}function Su(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):re.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of wc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=e1(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,wc(r),i)||r.endAt&&!function(o,a,l){const c=e1(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,wc(r),i))}(t,e)}function Y2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function X2(t){return(e,n)=>{let r=!1;for(const i of wc(t)){const s=yF(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function yF(t,e,n){const r=t.field.isKeyField()?re.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ds(l,c):ce()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ce()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _s{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){dl(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return O2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF=new We(re.comparator);function zn(){return vF}const J2=new We(re.comparator);function ic(...t){let e=J2;for(const n of t)e=e.insert(n.key,n);return e}function Z2(t){let e=J2;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Dr(){return xc()}function eC(){return xc()}function xc(){return new _s(t=>t.toString(),(t,e)=>t.isEqual(e))}const _F=new We(re.comparator),wF=new qe(re.comparator);function be(...t){let e=wF;for(const n of t)e=e.add(n);return e}const xF=new qe(ve);function Ly(){return xF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ru(e)?"-0":e}}function tC(t){return{integerValue:""+t}}function bF(t,e){return R2(e)?tC(e):jy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lf{constructor(){this._=void 0}}function EF(t,e,n){return t instanceof Ka?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Oy(s)&&(s=zy(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof Ga?rC(t,e):t instanceof Wa?iC(t,e):function(i,s){const o=nC(i,s),a=s1(o)+s1(i.Pe);return Rg(o)&&Rg(i.Pe)?tC(a):jy(i.serializer,a)}(t,e)}function IF(t,e,n){return t instanceof Ga?rC(t,e):t instanceof Wa?iC(t,e):n}function nC(t,e){return t instanceof lu?function(r){return Rg(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ka extends Lf{}class Ga extends Lf{constructor(e){super(),this.elements=e}}function rC(t,e){const n=sC(e);for(const r of t.elements)n.some(i=>Fr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Wa extends Lf{constructor(e){super(),this.elements=e}}function iC(t,e){let n=sC(e);for(const r of t.elements)n=n.filter(i=>!Fr(i,r));return{arrayValue:{values:n}}}class lu extends Lf{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function s1(t){return et(t.integerValue||t.doubleValue)}function sC(t){return au(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,n){this.field=e,this.transform=n}}function TF(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof Ga&&i instanceof Ga||r instanceof Wa&&i instanceof Wa?Ua(r.elements,i.elements,Fr):r instanceof lu&&i instanceof lu?Fr(r.Pe,i.Pe):r instanceof Ka&&i instanceof Ka}(t.transform,e.transform)}class SF{constructor(e,n){this.version=e,this.transformResults=n}}class yn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new yn}static exists(e){return new yn(void 0,e)}static updateTime(e){return new yn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Wd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class jf{}function aC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ff(t.key,yn.none()):new hl(t.key,t.data,yn.none());{const n=t.data,r=fn.empty();let i=new qe(it.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ws(t.key,r,new Jn(i.toArray()),yn.none())}}function CF(t,e,n){t instanceof hl?function(i,s,o){const a=i.value.clone(),l=a1(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ws?function(i,s,o){if(!Wd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=a1(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(lC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function bc(t,e,n,r){return t instanceof hl?function(s,o,a,l){if(!Wd(s.precondition,o))return a;const c=s.value.clone(),d=l1(s.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ws?function(s,o,a,l){if(!Wd(s.precondition,o))return a;const c=l1(s.fieldTransforms,l,o),d=o.data;return d.setAll(lC(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return Wd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function AF(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=nC(r.transform,i||null);s!=null&&(n===null&&(n=fn.empty()),n.set(r.field,s))}return n||null}function o1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Ua(r,i,(s,o)=>TF(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class hl extends jf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ws extends jf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function lC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function a1(t,e,n){const r=new Map;he(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,IF(o,a,n[i]))}return r}function l1(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,EF(s,o,e))}return r}class Ff extends jf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class cC extends jf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&CF(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=bc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=bc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=eC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=aC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),be())}isEqual(e){return this.batchId===e.batchId&&Ua(this.mutations,e.mutations,(n,r)=>o1(n,r))&&Ua(this.baseMutations,e.baseMutations,(n,r)=>o1(n,r))}}class $y{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){he(e.mutations.length===r.length);let i=function(){return _F}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new $y(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt,De;function RF(t){switch(t){default:return ce();case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0}}function uC(t){if(t===void 0)return mt("GRPC error has no .code"),Q.UNKNOWN;switch(t){case vt.OK:return Q.OK;case vt.CANCELLED:return Q.CANCELLED;case vt.UNKNOWN:return Q.UNKNOWN;case vt.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case vt.INTERNAL:return Q.INTERNAL;case vt.UNAVAILABLE:return Q.UNAVAILABLE;case vt.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case vt.NOT_FOUND:return Q.NOT_FOUND;case vt.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case vt.ABORTED:return Q.ABORTED;case vt.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case vt.DATA_LOSS:return Q.DATA_LOSS;default:return ce()}}(De=vt||(vt={}))[De.OK=0]="OK",De[De.CANCELLED=1]="CANCELLED",De[De.UNKNOWN=2]="UNKNOWN",De[De.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",De[De.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",De[De.NOT_FOUND=5]="NOT_FOUND",De[De.ALREADY_EXISTS=6]="ALREADY_EXISTS",De[De.PERMISSION_DENIED=7]="PERMISSION_DENIED",De[De.UNAUTHENTICATED=16]="UNAUTHENTICATED",De[De.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",De[De.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",De[De.ABORTED=10]="ABORTED",De[De.OUT_OF_RANGE=11]="OUT_OF_RANGE",De[De.UNIMPLEMENTED=12]="UNIMPLEMENTED",De[De.INTERNAL=13]="INTERNAL",De[De.UNAVAILABLE=14]="UNAVAILABLE",De[De.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PF=new Qs([4294967295,4294967295],0);function c1(t){const e=NF().encode(t),n=new y2;return n.update(e),new Uint8Array(n.digest())}function u1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Qs([n,r],0),new Qs([i,s],0)]}class By{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new sc(`Invalid padding: ${n}`);if(r<0)throw new sc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new sc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new sc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Qs.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Qs.fromNumber(r)));return i.compare(PF)===1&&(i=new Qs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=c1(e),[r,i]=u1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new By(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=c1(e),[r,i]=u1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class sc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cu{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Au.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Cu(pe.min(),i,new We(ve),zn(),be())}}class Au{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Au(r,n,be(),be(),be())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qd{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class dC{constructor(e,n){this.targetId=e,this.me=n}}class hC{constructor(e,n,r=gt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class d1{constructor(){this.fe=0,this.ge=f1(),this.pe=gt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=be(),n=be(),r=be();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ce()}}),new Au(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=f1()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,he(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class DF{constructor(e){this.Le=e,this.Be=new Map,this.ke=zn(),this.qe=h1(),this.Qe=new We(ve)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ce()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Uh(s))if(r===0){const o=new re(s.path);this.Ue(n,o,dt.newNoDocument(o,pe.min()))}else he(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=us(r).toUint8Array()}catch(l){if(l instanceof z2)return eu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new By(o,i,s)}catch(l){return eu(l instanceof sc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&Uh(a.target)){const l=new re(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,dt.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=be();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Cu(e,n,this.Qe,this.ke,r);return this.ke=zn(),this.qe=h1(),this.Qe=new We(ve),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new d1,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new qe(ve),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||J("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new d1),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function h1(){return new We(re.comparator)}function f1(){return new We(re.comparator)}const VF={asc:"ASCENDING",desc:"DESCENDING"},OF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},zF={and:"AND",or:"OR"};class MF{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function zg(t,e){return t.useProto3Json||Vf(e)?e:{value:e}}function Qa(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function fC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function LF(t,e){return Qa(t,e.toTimestamp())}function sn(t){return he(!!t),pe.fromTimestamp(function(n){const r=vi(n);return new ot(r.seconds,r.nanos)}(t))}function qy(t,e){return Mg(t,e).canonicalString()}function Mg(t,e){const n=function(i){return new je(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function pC(t){const e=je.fromString(t);return he(EC(e)),e}function qh(t,e){return qy(t.databaseId,e.path)}function Ys(t,e){const n=pC(e);if(n.get(1)!==t.databaseId.projectId)throw new ne(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ne(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new re(yC(n))}function mC(t,e){return qy(t.databaseId,e)}function gC(t){const e=pC(t);return e.length===4?je.emptyPath():yC(e)}function Lg(t){return new je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function yC(t){return he(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function p1(t,e,n){return{name:qh(t,e),fields:n.value.mapValue.fields}}function jF(t,e,n){const r=Ys(t,e.name),i=sn(e.updateTime),s=e.createTime?sn(e.createTime):pe.min(),o=new fn({mapValue:{fields:e.fields}}),a=dt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function FF(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ce()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(he(d===void 0||typeof d=="string"),gt.fromBase64String(d||"")):(he(d===void 0||d instanceof Buffer||d instanceof Uint8Array),gt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?Q.UNKNOWN:uC(c.code);return new ne(d,c.message||"")}(o);n=new hC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ys(t,r.document.name),s=sn(r.document.updateTime),o=r.document.createTime?sn(r.document.createTime):pe.min(),a=new fn({mapValue:{fields:r.document.fields}}),l=dt.newFoundDocument(i,s,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new Qd(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ys(t,r.document),s=r.readTime?sn(r.readTime):pe.min(),o=dt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Qd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ys(t,r.document),s=r.removedTargetIds||[];n=new Qd([],s,i,null)}else{if(!("filter"in e))return ce();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new kF(i,s),a=r.targetId;n=new dC(a,o)}}return n}function Hh(t,e){let n;if(e instanceof hl)n={update:p1(t,e.key,e.value)};else if(e instanceof Ff)n={delete:qh(t,e.key)};else if(e instanceof ws)n={update:p1(t,e.key,e.data),updateMask:KF(e.fieldMask)};else{if(!(e instanceof cC))return ce();n={verify:qh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Ka)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Ga)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Wa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof lu)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ce()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:LF(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ce()}(t,e.precondition)),n}function jg(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?yn.updateTime(sn(s.updateTime)):s.exists!==void 0?yn.exists(s.exists):yn.none()}(e.currentDocument):yn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)he(a.setToServerValue==="REQUEST_TIME"),l=new Ka;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new Ga(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new Wa(d)}else"increment"in a?l=new lu(o,a.increment):ce();const c=it.fromServerFormat(a.fieldPath);return new oC(c,l)}(t,i)):[];if(e.update){e.update.name;const i=Ys(t,e.update.name),s=new fn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new Jn(c.map(d=>it.fromServerFormat(d)))}(e.updateMask);return new ws(i,s,o,n,r)}return new hl(i,s,n,r)}if(e.delete){const i=Ys(t,e.delete);return new Ff(i,n)}if(e.verify){const i=Ys(t,e.verify);return new cC(i,n)}return ce()}function $F(t,e){return t&&t.length>0?(he(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?sn(i.updateTime):sn(s);return o.isEqual(pe.min())&&(o=sn(s)),new SF(o,i.transformResults||[])}(n,e))):[]}function vC(t,e){return{documents:[mC(t,e.path)]}}function _C(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=mC(t,i);const s=function(c){if(c.length!==0)return bC($e.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(f){return{field:Zo(f.field),direction:BF(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=zg(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function wC(t){let e=gC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){he(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(h){const f=xC(h);return f instanceof $e&&My(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(E){return new $h(ea(E.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,Vf(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(h){const f=!!h.before,m=h.values||[];return new qa(m,f)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const f=!h.before,m=h.values||[];return new qa(m,f)}(n.endAt)),G2(e,i,o,s,a,"F",l,c)}function UF(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ce()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function xC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=ea(n.unaryFilter.field);return Ne.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=ea(n.unaryFilter.field);return Ne.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=ea(n.unaryFilter.field);return Ne.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=ea(n.unaryFilter.field);return Ne.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ce()}}(t):t.fieldFilter!==void 0?function(n){return Ne.create(ea(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ce()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return $e.create(n.compositeFilter.filters.map(r=>xC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ce()}}(n.compositeFilter.op))}(t):ce()}function BF(t){return VF[t]}function qF(t){return OF[t]}function HF(t){return zF[t]}function Zo(t){return{fieldPath:t.canonicalString()}}function ea(t){return it.fromServerFormat(t.fieldPath)}function bC(t){return t instanceof Ne?function(n){if(n.op==="=="){if(Xx(n.value))return{unaryFilter:{field:Zo(n.field),op:"IS_NAN"}};if(Yx(n.value))return{unaryFilter:{field:Zo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Xx(n.value))return{unaryFilter:{field:Zo(n.field),op:"IS_NOT_NAN"}};if(Yx(n.value))return{unaryFilter:{field:Zo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zo(n.field),op:qF(n.op),value:n.value}}}(t):t instanceof $e?function(n){const r=n.getFilters().map(i=>bC(i));return r.length===1?r[0]:{compositeFilter:{op:HF(n.op),filters:r}}}(t):ce()}function KF(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function EC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,n,r,i,s=pe.min(),o=pe.min(),a=gt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new si(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e){this.ct=e}}function GF(t,e){let n;if(e.document)n=jF(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=re.fromSegments(e.noDocument.path),i=ho(e.noDocument.readTime);n=dt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ce();{const r=re.fromSegments(e.unknownDocument.path),i=ho(e.unknownDocument.version);n=dt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new ot(i[0],i[1]);return pe.fromTimestamp(s)}(e.readTime)),n}function m1(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Kh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:qh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Qa(s,o.version.toTimestamp()),createTime:Qa(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:uo(e.version)};else{if(!e.isUnknownDocument())return ce();r.unknownDocument={path:n.path.toArray(),version:uo(e.version)}}return r}function Kh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function uo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ho(t){const e=new ot(t.seconds,t.nanoseconds);return pe.fromTimestamp(e)}function Os(t,e){const n=(e.baseMutations||[]).map(s=>jg(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>jg(t.ct,s)),i=ot.fromMillis(e.localWriteTimeMs);return new Fy(e.batchId,i,n,r)}function oc(t){const e=ho(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?ho(t.lastLimboFreeSnapshotVersion):pe.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return he(s.documents.length===1),Ln(zf(gC(s.documents[0])))}(t.query):function(s){return Ln(wC(s))}(t.query),new si(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,gt.fromBase64String(t.resumeToken))}function TC(t,e){const n=uo(e.snapshotVersion),r=uo(e.lastLimboFreeSnapshotVersion);let i;i=Uh(e.target)?vC(t.ct,e.target):_C(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:co(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function SC(t){const e=wC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Og(e,e.limit,"L"):e}function Yp(t,e){return new Uy(e.largestBatchId,jg(t.ct,e.overlayMutation))}function g1(t,e){const n=e.path.lastSegment();return[t,rn(e.path.popLast()),n]}function y1(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:uo(r.readTime),documentKey:rn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{getBundleMetadata(e,n){return v1(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ho(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return v1(e).put(function(i){return{bundleId:i.id,createTime:uo(sn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return _1(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:SC(s.bundledQuery),readTime:ho(s.readTime)}}(r)})}saveNamedQuery(e,n){return _1(e).put(function(i){return{name:i.name,readTime:uo(sn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function v1(t){return At(t,"bundles")}function _1(t){return At(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $f{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new $f(e,r)}getOverlay(e,n){return Bl(e).get(g1(this.userId,n)).next(r=>r?Yp(this.serializer,r):null)}getOverlays(e,n){const r=Dr();return H.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Uy(n,o);i.push(this.ht(e,a))}),H.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(rn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Bl(e).j("collectionPathOverlayIndex",a))}),H.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Dr(),s=rn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Bl(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Yp(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Dr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Bl(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{const h=Yp(this.serializer,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,n){return Bl(e).put(function(i,s,o){const[a,l,c]=g1(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Hh(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Bl(t){return At(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{Pt(e){return At(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?gt.fromUint8Array(r):gt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(et(e.integerValue));else if("doubleValue"in e){const r=et(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),ru(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=vi(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(us(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?M2(e)?this.dt(n,Number.MAX_SAFE_INTEGER):Of(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):ce()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(et(a)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),re.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}zs.vt=new zs;function YF(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function w1(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=YF(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class XF{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=w1(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=w1(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class JF{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class ZF{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class ql{constructor(){this.jt=new XF,this.Ht=new JF(this.jt),this.Jt=new ZF(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Ms(this.indexId,this.documentKey,this.arrayValue,r)}}function Ni(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=x1(t.arrayValue,e.arrayValue),n!==0?n:(n=x1(t.directionalValue,e.directionalValue),n!==0?n:re.comparator(t.documentKey,e.documentKey)))}function x1(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b1{constructor(e){this.Xt=new qe((n,r)=>it.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(he(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Cg(e);if(n!==void 0&&!this.sn(n))return!1;const r=Ds(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new qe(it.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new qd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new qd(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new qd(r.field,r.dir==="asc"?0:1)));return new Fh(Fh.UNKNOWN_ID,this.collectionId,n,nu.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(t){var e,n;if(he(t instanceof Ne||t instanceof $e),t instanceof Ne){if(t instanceof K2){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>Ne.create(t.field,"==",s)))||[];return $e.create(i,"or")}return t}const r=t.filters.map(i=>CC(i));return $e.create(r,t.op)}function e$(t){if(t.getFilters().length===0)return[];const e=Ug(CC(t));return he(AC(e)),Fg(e)||$g(e)?[e]:e.getFilters()}function Fg(t){return t instanceof Ne}function $g(t){return t instanceof $e&&My(t)}function AC(t){return Fg(t)||$g(t)||function(n){if(n instanceof $e&&Ng(n)){for(const r of n.getFilters())if(!Fg(r)&&!$g(r))return!1;return!0}return!1}(t)}function Ug(t){if(he(t instanceof Ne||t instanceof $e),t instanceof Ne)return t;if(t.filters.length===1)return Ug(t.filters[0]);const e=t.filters.map(r=>Ug(r));let n=$e.create(e,t.op);return n=Gh(n),AC(n)?n:(he(n instanceof $e),he(Ha(n)),he(n.filters.length>1),n.filters.reduce((r,i)=>Hy(r,i)))}function Hy(t,e){let n;return he(t instanceof Ne||t instanceof $e),he(e instanceof Ne||e instanceof $e),n=t instanceof Ne?e instanceof Ne?function(i,s){return $e.create([i,s],"and")}(t,e):E1(t,e):e instanceof Ne?E1(e,t):function(i,s){if(he(i.filters.length>0&&s.filters.length>0),Ha(i)&&Ha(s))return B2(i,s.getFilters());const o=Ng(i)?i:s,a=Ng(i)?s:i,l=o.filters.map(c=>Hy(c,a));return $e.create(l,"or")}(t,e),Gh(n)}function E1(t,e){if(Ha(e))return B2(e,t.getFilters());{const n=e.filters.map(r=>Hy(t,r));return $e.create(n,"or")}}function Gh(t){if(he(t instanceof Ne||t instanceof $e),t instanceof Ne)return t;const e=t.getFilters();if(e.length===1)return Gh(e[0]);if($2(t))return t;const n=e.map(i=>Gh(i)),r=[];return n.forEach(i=>{i instanceof Ne?r.push(i):i instanceof $e&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:$e.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t${constructor(){this.un=new Ky}addToCollectionParentIndex(e,n){return this.un.add(n),H.resolve()}getCollectionParents(e,n){return H.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return H.resolve()}deleteFieldIndex(e,n){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,n){return H.resolve()}getDocumentsMatchingTarget(e,n){return H.resolve(null)}getIndexType(e,n){return H.resolve(0)}getFieldIndexes(e,n){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,n){return H.resolve(Un.min())}getMinOffsetFromCollectionGroup(e,n){return H.resolve(Un.min())}updateCollectionGroup(e,n,r){return H.resolve()}updateIndexEntries(e,n){return H.resolve()}}class Ky{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new qe(je.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new qe(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vd=new Uint8Array(0);class n${constructor(e,n){this.databaseId=n,this.cn=new Ky,this.ln=new _s(r=>co(r),(r,i)=>Iu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:rn(i)};return I1(e).put(s)}return H.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[I2(n),""],!1,!0);return I1(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Pr(o.parent))}return r})}addFieldIndex(e,n){const r=Hl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Qo(e);return s.next(a=>{o.put(y1(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Hl(e),i=Qo(e),s=Wo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Hl(e),r=Wo(e),i=Qo(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return H.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new b1(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Wo(e);let i=!0;const s=new Map;return H.forEach(this.hn(n),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=be();const a=[];return H.forEach(s,(l,c)=>{J("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(k=>`${k.fieldPath}:${k.kind}`).join(",")}`}(l)} to execute ${co(n)}`);const d=function(T,k){const O=Cg(k);if(O===void 0)return null;for(const z of Bh(T,O.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null}(c,l),h=function(T,k){const O=new Map;for(const z of Ds(k))for(const S of Bh(T,z.fieldPath))switch(S.op){case"==":case"in":O.set(z.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return O.set(z.fieldPath.canonicalString(),S.value),Array.from(O.values())}return null}(c,l),f=function(T,k){const O=[];let z=!0;for(const S of Ds(k)){const b=S.kind===0?n1(T,S.fieldPath,T.startAt):r1(T,S.fieldPath,T.startAt);O.push(b.value),z&&(z=b.inclusive)}return new qa(O,z)}(c,l),m=function(T,k){const O=[];let z=!0;for(const S of Ds(k)){const b=S.kind===0?r1(T,S.fieldPath,T.endAt):n1(T,S.fieldPath,T.endAt);O.push(b.value),z&&(z=b.inclusive)}return new qa(O,z)}(c,l),E=this.In(l,c,f),x=this.In(l,c,m),R=this.Tn(l,c,h),y=this.En(l.indexId,d,E,f.inclusive,x,m.inclusive,R);return H.forEach(y,v=>r.G(v,n.limit).next(T=>{T.forEach(k=>{const O=re.fromSegments(k.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return H.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=e$($e.create(e.filters,"and")).map(r=>Dg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),d=[];for(let h=0;h<l;++h){const f=n?this.dn(n[h/c]):vd,m=this.An(e,f,r[h%c],i),E=this.Rn(e,f,s[h%c],o),x=a.map(R=>this.An(e,f,R,!0));d.push(...this.createRange(m,E,x))}return d}An(e,n,r,i){const s=new Ms(e,re.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new Ms(e,re.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new b1(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.hn(n);return H.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new qe(it.comparator),d=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new ql;for(const i of Ds(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);zs.vt.It(s,o)}return r.zt()}dn(e){const n=new ql;return zs.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new ql;return zs.vt.It(ou(this.databaseId,n),r.Yt(function(s){const o=Ds(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new ql);let s=0;for(const o of Ds(e)){const a=r[s++];for(const l of i)if(this.fn(n,o.fieldPath)&&au(a))i=this.gn(i,o,a);else{const c=l.Yt(o.kind);zs.vt.It(a,c)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new ql;l.seed(a.zt()),zs.vt.It(o,l.Yt(n.kind)),s.push(l)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof Ne&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Hl(e),i=Qo(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return H.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,h){const f=h?new nu(h.sequenceNumber,new Un(ho(h.readTime),new re(Pr(h.documentKey)),h.largestBatchId)):nu.empty(),m=d.fields.map(([E,x])=>new qd(it.fromServerFormat(E),x));return new Fh(d.indexId,d.collectionGroup,m,f)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ve(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Hl(e),s=Qo(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>H.forEach(a,l=>s.put(y1(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return H.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?H.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),H.forEach(a,l=>this.wn(e,i,l).next(c=>{const d=this.Sn(s,l);return c.isEqual(d)?H.resolve():this.bn(e,s,l,c,d)}))))})}Dn(e,n,r,i){return Wo(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return Wo(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=Wo(e);let s=new qe(Ni);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,a)=>{s=s.add(new Ms(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,n){let r=new qe(Ni);const i=this.Vn(n,e);if(i==null)return r;const s=Cg(n);if(s!=null){const o=e.data.field(s.fieldPath);if(au(o))for(const a of o.arrayValue.values||[])r=r.add(new Ms(n.indexId,e.key,this.dn(a),i))}else r=r.add(new Ms(n.indexId,e.key,vd,i));return r}bn(e,n,r,i,s){J("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,c,d,h,f){const m=l.getIterator(),E=c.getIterator();let x=Go(m),R=Go(E);for(;x||R;){let y=!1,v=!1;if(x&&R){const T=d(x,R);T<0?v=!0:T>0&&(y=!0)}else x!=null?v=!0:y=!0;y?(h(R),R=Go(E)):v?(f(x),x=Go(m)):(x=Go(m),R=Go(E))}}(i,s,Ni,a=>{o.push(this.Dn(e,n,r,a))},a=>{o.push(this.vn(e,n,r,a))}),H.waitFor(o)}yn(e){let n=1;return Qo(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ni(o,a)).filter((o,a,l)=>!a||Ni(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ni(o,e),l=Ni(o,n);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,vd,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,vd,[]];s.push(IDBKeyRange.bound(a,l))}return s}Cn(e,n){return Ni(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(T1)}getMinOffset(e,n){return H.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||ce())).next(T1)}}function I1(t){return At(t,"collectionParents")}function Wo(t){return At(t,"indexEntries")}function Hl(t){return At(t,"indexConfiguration")}function Qo(t){return At(t,"indexState")}function T1(t){he(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Py(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Un(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class dn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new dn(e,dn.DEFAULT_COLLECTION_PERCENTILE,dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(d,h,f)=>(a++,f.delete()));s.push(l.next(()=>{he(a===1)}));const c=[];for(const d of n.mutations){const h=N2(e,d.key.path,n.batchId);s.push(i.delete(h)),c.push(d.key)}return H.waitFor(s).next(()=>c)}function Wh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ce();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dn.DEFAULT_COLLECTION_PERCENTILE=10,dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,dn.DEFAULT=new dn(41943040,dn.DEFAULT_COLLECTION_PERCENTILE,dn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),dn.DISABLED=new dn(-1,0,0);class Uf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){he(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Uf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=ta(e),o=Pi(e);return o.add({}).next(a=>{he(typeof a=="number");const l=new Fy(a,n,r,i),c=function(m,E,x){const R=x.baseMutations.map(v=>Hh(m.ct,v)),y=x.mutations.map(v=>Hh(m.ct,v));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:R,mutations:y}}(this.serializer,this.userId,l),d=[];let h=new qe((f,m)=>ve(f.canonicalString(),m.canonicalString()));for(const f of i){const m=N2(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),d.push(o.put(c)),d.push(s.put(m,F9))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),H.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return Pi(e).get(n).next(r=>r?(he(r.userId===this.userId),Os(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?H.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Pi(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(he(a.batchId>=r),s=Os(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Pi(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Pi(e).U("userMutationsIndex",n).next(r=>r.map(i=>Os(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Hd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ta(e).J({range:i},(o,a,l)=>{const[c,d,h]=o,f=Pr(d);if(c===this.userId&&n.path.isEqual(f))return Pi(e).get(h).next(m=>{if(!m)throw ce();he(m.userId===this.userId),s.push(Os(this.serializer,m))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new qe(ve);const i=[];return n.forEach(s=>{const o=Hd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=ta(e).J({range:a},(c,d,h)=>{const[f,m,E]=c,x=Pr(m);f===this.userId&&s.path.isEqual(x)?r=r.add(E):h.done()});i.push(l)}),H.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Hd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new qe(ve);return ta(e).J({range:o},(l,c,d)=>{const[h,f,m]=l,E=Pr(f);h===this.userId&&r.isPrefixOf(E)?E.length===i&&(a=a.add(m)):d.done()}).next(()=>this.xn(e,a))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Pi(e).get(s).next(o=>{if(o===null)throw ce();he(o.userId===this.userId),r.push(Os(this.serializer,o))}))}),H.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return kC(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),H.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return H.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ta(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Pr(s[1]);i.push(l)}else a.done()}).next(()=>{he(i.length===0)})})}containsKey(e,n){return RC(e,this.userId,n)}Nn(e){return NC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function RC(t,e,n){const r=Hd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return ta(t).J({range:s,H:!0},(a,l,c)=>{const[d,h,f]=a;d===e&&h===i&&(o=!0),c.done()}).next(()=>o)}function Pi(t){return At(t,"mutations")}function ta(t){return At(t,"documentMutations")}function NC(t){return At(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new fo(0)}static kn(){return new fo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r${constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new fo(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>pe.fromTimestamp(new ot(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Yo(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(he(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Yo(e).J((o,a)=>{const l=oc(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>H.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Yo(e).J((r,i)=>{const s=oc(i);n(s)})}qn(e){return C1(e).get("targetGlobalKey").next(n=>(he(n!==null),n))}Qn(e,n){return C1(e).put("targetGlobalKey",n)}Kn(e,n){return Yo(e).put(TC(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=co(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Yo(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const c=oc(a);Iu(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Bi(e);return n.forEach(o=>{const a=rn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),H.waitFor(i)}removeMatchingKeys(e,n,r){const i=Bi(e);return H.forEach(n,s=>{const o=rn(s.path);return H.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Bi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Bi(e);let s=be();return i.J({range:r,H:!0},(o,a,l)=>{const c=Pr(o[1]),d=new re(c);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=rn(n.path),i=IDBKeyRange.bound([r],[I2(r)],!1,!0);let s=0;return Bi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return Yo(e).get(n).next(r=>r?oc(r):null)}}function Yo(t){return At(t,"targets")}function C1(t){return At(t,"targetGlobal")}function Bi(t){return At(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A1([t,e],[n,r]){const i=ve(t,n);return i===0?ve(e,r):i}class i${constructor(e){this.Un=e,this.buffer=new qe(A1),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();A1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class s${constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){J("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){vs(n)?J("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ys(n)}await this.Hn(3e5)})}}class o${constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return H.resolve(gn.oe);const r=new i$(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(J("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(S1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(J("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),S1):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(J("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),Xo()<=Re.DEBUG&&J("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function a$(t,e){return new o$(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l${constructor(e,n){this.db=e,this.garbageCollector=a$(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return _d(e,r)}removeReference(e,n,r){return _d(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return _d(e,n)}nr(e,n){return function(i,s){let o=!1;return NC(i).Y(a=>RC(i,a,s).next(l=>(l&&(o=!0),H.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=n){const l=this.nr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,pe.min()),Bi(e).delete(function(h){return[0,rn(h.path)]}(o))))});i.push(l)}}).next(()=>H.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return _d(e,n)}tr(e,n){const r=Bi(e);let i,s=gn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==gn.oe&&n(new re(Pr(i)),s),s=c,i=l):s=gn.oe}).next(()=>{s!==gn.oe&&n(new re(Pr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function _d(t,e){return Bi(t).put(function(r,i){return{targetId:0,path:rn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(){this.changes=new _s(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,dt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?H.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c${constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return As(e).put(r)}removeEntry(e,n,r){return As(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Kh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=dt.newInvalidDocument(n);return As(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Kl(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:dt.newInvalidDocument(n)};return As(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Kl(n))},(i,s)=>{r={document:this.ir(n,s),size:Wh(s)}}).next(()=>r)}getEntries(e,n){let r=zn();return this._r(e,n,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,n){let r=zn(),i=new We(re.comparator);return this._r(e,n,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,Wh(o))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return H.resolve();let i=new qe(N1);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Kl(i.first()),Kl(i.last())),o=i.getIterator();let a=o.getNext();return As(e).J({index:"documentKeyIndex",range:s},(l,c,d)=>{const h=re.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&N1(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(Kl(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Kh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return As(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let d=zn();for(const h of c){const f=this.ir(re.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(Su(n,f)||i.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=zn();const o=R1(n,r),a=R1(n,Un.max());return As(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{const h=this.ir(re.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new u$(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return k1(e).get("remoteDocumentGlobalKey").next(n=>(he(!!n),n))}rr(e,n){return k1(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=GF(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(pe.min())))return r}return dt.newInvalidDocument(e)}}function DC(t){return new c$(t)}class u$ extends PC{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new _s(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new qe((s,o)=>ve(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=m1(this.cr.serializer,o);i=i.add(s.path.popLast());const c=Wh(l);r+=c-a.size,n.push(this.cr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=m1(this.cr.serializer,o.convertToNoDocument(pe.min()));n.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),H.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function k1(t){return At(t,"remoteDocumentGlobal")}function As(t){return At(t,"remoteDocumentsV14")}function Kl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function R1(t,e){const n=e.documentKey.path.toArray();return[t,Kh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function N1(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ve(n[s],r[s]),i)return i;return i=ve(n.length,r.length),i||(i=ve(n[n.length-2],r[r.length-2]),i||ve(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d${constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&bc(r.mutation,i,Jn.empty(),ot.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,be()).next(()=>r))}getLocalViewOfDocuments(e,n,r=be()){const i=Dr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ic();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Dr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,be()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=zn();const o=xc(),a=function(){return xc()}();return n.forEach((l,c)=>{const d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof ws)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),bc(d.mutation,c,d.mutation.getFieldMask(),ot.now())):o.set(c.key,Jn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var h;return a.set(c,new d$(d,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=xc();let i=new We((o,a)=>o-a),s=be();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=r.get(l)||Jn.empty();d=a.applyToLocalView(c,d),r.set(l,d);const h=(i.get(a.batchId)||be()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,h=eC();d.forEach(f=>{if(!s.has(f)){const m=aC(n.get(f),r.get(f));m!==null&&h.set(f,m),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return H.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return re.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):W2(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):H.resolve(Dr());let a=-1,l=s;return o.next(c=>H.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?H.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,be())).next(d=>({batchId:a,changes:Z2(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new re(n)).next(r=>{let i=ic();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=ic();return this.indexManager.getCollectionParents(e,s).next(a=>H.forEach(a,l=>{const c=function(h,f){return new Tu(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,dt.newInvalidDocument(d)))});let a=ic();return o.forEach((l,c)=>{const d=s.get(l);d!==void 0&&bc(d.mutation,c,Jn.empty(),ot.now()),Su(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h${constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return H.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:sn(i.createTime)}}(n)),H.resolve()}getNamedQuery(e,n){return H.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:SC(i.bundledQuery),readTime:sn(i.readTime)}}(n)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f${constructor(){this.overlays=new We(re.comparator),this.Ir=new Map}getOverlay(e,n){return H.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Dr();return H.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),H.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),H.resolve()}getOverlaysForCollection(e,n,r){const i=Dr(),s=n.length+1,o=new re(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return H.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new We((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=Dr(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Dr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return H.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Uy(n,r));let s=this.Ir.get(n);s===void 0&&(s=be(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p${constructor(){this.sessionToken=gt.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gy{constructor(){this.Tr=new qe(Ot.Er),this.dr=new qe(Ot.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Ot(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Ot(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new re(new je([])),r=new Ot(n,e),i=new Ot(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new re(new je([])),r=new Ot(n,e),i=new Ot(n,e+1);let s=be();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Ot(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Ot{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return re.comparator(e.key,n.key)||ve(e.wr,n.wr)}static Ar(e,n){return ve(e.wr,n.wr)||re.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m${constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new qe(Ot.Er)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Fy(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new Ot(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return H.resolve(o)}lookupMutationBatch(e,n){return H.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return H.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Ot(n,0),i=new Ot(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),H.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new qe(ve);return n.forEach(i=>{const s=new Ot(i,0),o=new Ot(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),H.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;re.isDocumentKey(s)||(s=s.child(""));const o=new Ot(new re(s),0);let a=new qe(ve);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.wr)),!0)},o),H.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){he(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return H.forEach(n.mutations,i=>{const s=new Ot(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Ot(n,0),i=this.br.firstAfterOrEqual(r);return H.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g${constructor(e){this.Mr=e,this.docs=function(){return new We(re.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return H.resolve(r?r.document.mutableCopy():dt.newInvalidDocument(n))}getEntries(e,n){let r=zn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():dt.newInvalidDocument(i))}),H.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=zn();const o=n.path,a=new re(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Py(S2(d),r)<=0||(i.has(d.key)||Su(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return H.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ce()}Or(e,n){return H.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new y$(this)}getSize(e){return H.resolve(this.size)}}class y$ extends PC{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),H.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v${constructor(e){this.persistence=e,this.Nr=new _s(n=>co(n),Iu),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Gy,this.targetCount=0,this.kr=fo.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),H.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new fo(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,H.resolve()}updateTargetData(e,n){return this.Kn(n),H.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),H.waitFor(s).next(()=>i)}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return H.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),H.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),H.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),H.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return H.resolve(r)}containsKey(e,n){return H.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(e,n){this.qr={},this.overlays={},this.Qr=new gn(0),this.Kr=!1,this.Kr=!0,this.$r=new p$,this.referenceDelegate=e(this),this.Ur=new v$(this),this.indexManager=new t$,this.remoteDocumentCache=function(i){return new g$(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new IC(n),this.Gr=new h$(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new f$,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new m$(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("MemoryPersistence","Starting transaction:",e);const i=new _$(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return H.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class _$ extends A2{constructor(e){super(),this.currentSequenceNumber=e}}class Bf{constructor(e){this.persistence=e,this.Jr=new Gy,this.Yr=null}static Zr(e){return new Bf(e)}get Xr(){if(this.Yr)return this.Yr;throw ce()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),H.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),H.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),H.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.Xr,r=>{const i=re.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,pe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return H.or([()=>H.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w${constructor(e){this.serializer=e}O(e,n,r,i){const s=new Df("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Hx,{unique:!0}),l.createObjectStore("documentMutations")}(e),P1(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=H.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),P1(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pe.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Hx,{unique:!0});const h=c.store("mutations"),f=d.map(m=>h.put(m));return H.waitFor(f)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:J9});c.createIndex("collectionPathOverlayIndex",Z9,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",eF,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:$9});c.createIndex("documentKeyIndex",U9),c.createIndex("collectionGroupIndex",B9)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:W9}).createIndex("sequenceNumberIndex",Q9,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:Y9}).createIndex("documentKeyIndex",X9,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Wh(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>H.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>H.forEach(a,l=>{he(l.userId===s.userId);const c=Os(this.serializer,l);return kC(e,s.userId,c).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new je(o),c=function(h){return[0,rn(h)]}(l);s.push(n.get(c).next(d=>d?H.resolve():(h=>n.put({targetId:0,path:rn(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>H.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:G9});const r=n.store("collectionParents"),i=new Ky,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:rn(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new je(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],c)=>{const d=Pr(a);return s(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=oc(i),o=TC(this.serializer,s);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(h){return h.document?new re(je.fromString(h.document.name).popFirst(5)):h.noDocument?re.fromSegments(h.noDocument.path):h.unknownDocument?re.fromSegments(h.unknownDocument.path):ce()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>H.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=DC(this.serializer),s=new OC(Bf.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:be();Os(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),H.forEach(a,(l,c)=>{const d=new Xt(c),h=$f.lt(this.serializer,d),f=s.getIndexManager(d),m=Uf.lt(d,this.serializer,f,s.referenceDelegate);return new VC(i,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new Ag(n,gn.oe),l).next()})})}}function P1(t){t.createObjectStore("targetDocuments",{keyPath:H9}).createIndex("documentTargetsIndex",K9,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",q9,{unique:!0}),t.createObjectStore("targetGlobal")}const Xp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Wy{constructor(e,n,r,i,s,o,a,l,c,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=f=>Promise.resolve(),!Wy.D())throw new ne(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new l$(this,i),this.Ai=n+"main",this.serializer=new IC(l),this.Ri=new ss(this.Ai,this.hi,new w$(this.serializer)),this.$r=new QF,this.Ur=new r$(this.referenceDelegate,this.serializer),this.remoteDocumentCache=DC(this.serializer),this.Gr=new WF,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&mt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ne(Q.FAILED_PRECONDITION,Xp);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new gn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>wd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(vs(e))return J("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return J("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Gl(e).get("owner").next(n=>H.resolve(this.vi(n)))}Ci(e){return wd(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=At(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return H.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?H.resolve(!0):Gl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new ne(Q.FAILED_PRECONDITION,Xp);return!1}}return!(!this.networkEnabled||!this.inForeground)||wd(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&J("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new Ag(e,gn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>wd(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Uf.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new n$(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return $f.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===17?rF:l===16?nF:l===15?Vy:l===14?V2:l===13?D2:l===12?tF:l===11?P2:void ce()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new Ag(a,this.Qr?this.Qr.next():gn.oe),n==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw mt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ne(Q.FAILED_PRECONDITION,C2);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Gl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ne(Q.FAILED_PRECONDITION,Xp)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Gl(e).put("owner",n)}static D(){return ss.D()}bi(e){const n=Gl(e);return n.get("owner").next(r=>this.vi(r)?(J("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):H.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(mt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;AS()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return J("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return mt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){mt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Gl(t){return At(t,"owner")}function wd(t){return At(t,"clientMetadata")}function zC(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qy{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=be(),i=be();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Qy(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x${constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return AS()?8:k2(St())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new x$;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Xo()<=Re.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Jo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),H.resolve()):(Xo()<=Re.DEBUG&&J("QueryEngine","Query:",Jo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Xo()<=Re.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Jo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ln(n))):H.resolve())}Yi(e,n){if(i1(n))return H.resolve(null);let r=Ln(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Og(n,null,"F"),r=Ln(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=be(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(n,a);return this.ns(n,c,o,l.readTime)?this.Yi(e,Og(n,null,"F")):this.rs(e,c,n,l)}))})))}Zi(e,n,r,i){return i1(n)||i.isEqual(pe.min())?H.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?H.resolve(null):(Xo()<=Re.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Jo(n)),this.rs(e,o,n,T2(i,-1)).next(a=>a))})}ts(e,n){let r=new qe(X2(e));return n.forEach((i,s)=>{Su(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Xo()<=Re.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Jo(n)),this.Ji.getDocumentsMatchingQuery(e,n,Un.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b${constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new We(ve),this._s=new _s(s=>co(s),Iu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new VC(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function LC(t,e,n,r){return new b$(t,e,n,r)}async function jC(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=be();for(const c of i){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function E$(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const h=c.batch,f=h.keys();let m=H.resolve();return f.forEach(E=>{m=m.next(()=>d.getEntry(l,E)).next(x=>{const R=c.docVersions.get(E);he(R!==null),x.version.compareTo(R)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=be();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function FC(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function I$(t,e){const n=de(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];e.targetChanges.forEach((d,h)=>{const f=i.get(h);if(!f)return;a.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,h)));let m=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(gt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),i=i.insert(h,m),function(x,R,y){return x.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(f,m,d)&&a.push(n.Ur.updateTargetData(s,m))});let l=zn(),c=be();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(T$(s,o,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!r.isEqual(pe.min())){const d=n.Ur.getLastRemoteSnapshotVersion(s).next(h=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return H.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.os=i,s))}function T$(t,e,n){let r=be(),i=be();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=zn();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):J("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function S$(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Qh(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,H.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new si(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Ya(t,e,n){const r=de(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!vs(o))throw o;J("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Bg(t,e,n){const r=de(t);let i=pe.min(),s=be();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const h=de(l),f=h._s.get(d);return f!==void 0?H.resolve(h.os.get(f)):h.Ur.getTargetData(c,d)}(r,o,Ln(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:pe.min(),n?s:be())).next(a=>(BC(r,Y2(e),a),{documents:a,Ts:s})))}function $C(t,e){const n=de(t),r=de(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function UC(t,e){const n=de(t),r=n.us.get(e)||pe.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,T2(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(BC(n,e,i),i))}function BC(t,e,n){let r=t.us.get(e)||pe.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}function D1(t,e){return`firestore_clients_${t}_${e}`}function V1(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Jp(t,e){return`firestore_targets_${t}_${e}`}class Yh{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new ne(i.error.code,i.error.message))),o?new Yh(e,n,i.state,s):(mt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ec{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new ne(r.error.code,r.error.message))),s?new Ec(e,r.state,i):(mt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Xh{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Ly();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=R2(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Xh(e,s):(mt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Yy{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Yy(n.clientId,n.onlineState):(mt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class qg{constructor(){this.activeTargetIds=Ly()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Zp{constructor(e,n,r,i,s){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new We(ve),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=D1(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new qg),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(D1(this.persistenceKey,r));if(i){const s=Xh.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Jp(this.persistenceKey,e));if(i){const s=Ec.Rs(e,i);s&&(r=s.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Jp(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return J("SharedClientState","READ",e,n),n}setItem(e,n){J("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){J("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(J("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void mt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(s){let o=gn.oe;if(s!=null)try{const a=JSON.parse(s);he(typeof a=="number"),o=a}catch(a){mt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==gn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new Yh(this.currentUser,e,n,r),s=V1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const n=V1(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=Jp(this.persistenceKey,e),s=new Ec(e,n,r);this.setItem(i,s.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return Xh.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return Yh.Rs(new Xt(s),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return Ec.Rs(i,n)}Ls(e){return Yy.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);J("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=Ly();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class qC{constructor(){this.so=new qg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new qg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C${_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O1{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){J("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){J("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xd=null;function em(){return xd===null?xd=function(){return 268435456+Math.round(2147483648*Math.random())}():xd++,"0x"+xd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k${constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yt="WebChannelConnection";class R$ extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const a=em(),l=this.xo(n,r.toUriEncodedString());J("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(n,l,c,i).then(d=>(J("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw eu("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ul}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=A$[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=em();return new Promise((o,a)=>{const l=new v2;l.setWithCredentials(!0),l.listenOnce(_2.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Bd.NO_ERROR:const d=l.getResponseJson();J(Yt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Bd.TIMEOUT:J(Yt,`RPC '${e}' ${s} timed out`),a(new ne(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Bd.HTTP_ERROR:const h=l.getStatus();if(J(Yt,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const E=function(R){const y=R.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(y)>=0?y:Q.UNKNOWN}(m.status);a(new ne(E,m.message))}else a(new ne(Q.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ne(Q.UNAVAILABLE,"Connection failed."));break;default:ce()}}finally{J(Yt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);J(Yt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",c,r,15)})}Bo(e,n,r){const i=em(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=b2(),a=x2(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");J(Yt,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=o.createWebChannel(d,l);let f=!1,m=!1;const E=new k$({Io:R=>{m?J(Yt,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(f||(J(Yt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),J(Yt,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},To:()=>h.close()}),x=(R,y,v)=>{R.listen(y,T=>{try{v(T)}catch(k){setTimeout(()=>{throw k},0)}})};return x(h,rc.EventType.OPEN,()=>{m||(J(Yt,`RPC '${e}' stream ${i} transport opened.`),E.yo())}),x(h,rc.EventType.CLOSE,()=>{m||(m=!0,J(Yt,`RPC '${e}' stream ${i} transport closed`),E.So())}),x(h,rc.EventType.ERROR,R=>{m||(m=!0,eu(Yt,`RPC '${e}' stream ${i} transport errored:`,R),E.So(new ne(Q.UNAVAILABLE,"The operation could not be completed")))}),x(h,rc.EventType.MESSAGE,R=>{var y;if(!m){const v=R.data[0];he(!!v);const T=v,k=T.error||((y=T[0])===null||y===void 0?void 0:y.error);if(k){J(Yt,`RPC '${e}' stream ${i} received error:`,k);const O=k.status;let z=function(w){const I=vt[w];if(I!==void 0)return uC(I)}(O),S=k.message;z===void 0&&(z=Q.INTERNAL,S="Unknown error status: "+O+" with message "+k.message),m=!0,E.So(new ne(z,S)),h.close()}else J(Yt,`RPC '${e}' stream ${i} received:`,v),E.bo(v)}}),x(a,w2.STAT_EVENT,R=>{R.stat===Sg.PROXY?J(Yt,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===Sg.NOPROXY&&J(Yt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.wo()},0),E}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HC(){return typeof window<"u"?window:null}function Yd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qf(t){return new MF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&J("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GC{constructor(e,n,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new KC(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Q.RESOURCE_EXHAUSTED?(mt(n.toString()),mt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ne(Q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return J("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(J("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class N$ extends GC{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=FF(this.serializer,e),r=function(s){if(!("targetChange"in s))return pe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?sn(o.readTime):pe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Lg(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Uh(l)?{documents:vC(s,l)}:{query:_C(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=fC(s,o.resumeToken);const c=zg(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=Qa(s,o.snapshotVersion.toTimestamp());const c=zg(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=UF(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Lg(this.serializer),n.removeTarget=e,this.a_(n)}}class P$ extends GC{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return he(!!e.streamToken),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){he(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=$F(e.writeResults,e.commitTime),r=sn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Lg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Hh(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D$ extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ne(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Mg(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ne(Q.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Mg(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ne(Q.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class V${constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(mt(n),this.D_=!1):J("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O${constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{xo(this)&&(J("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=de(l);c.L_.add(4),await ku(c),c.q_.set("Unknown"),c.L_.delete(4),await Hf(c)}(this))})}),this.q_=new V$(r,i)}}async function Hf(t){if(xo(t))for(const e of t.B_)await e(!0)}async function ku(t){for(const e of t.B_)await e(!1)}function Kf(t,e){const n=de(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Zy(n)?Jy(n):pl(n).r_()&&Xy(n,e))}function Xa(t,e){const n=de(t),r=pl(n);n.N_.delete(e),r.r_()&&WC(n,e),n.N_.size===0&&(r.r_()?r.o_():xo(n)&&n.q_.set("Unknown"))}function Xy(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}pl(t).A_(e)}function WC(t,e){t.Q_.xe(e),pl(t).R_(e)}function Jy(t){t.Q_=new DF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),pl(t).start(),t.q_.v_()}function Zy(t){return xo(t)&&!pl(t).n_()&&t.N_.size>0}function xo(t){return de(t).L_.size===0}function QC(t){t.Q_=void 0}async function z$(t){t.q_.set("Online")}async function M$(t){t.N_.forEach((e,n)=>{Xy(t,e)})}async function L$(t,e){QC(t),Zy(t)?(t.q_.M_(e),Jy(t)):t.q_.set("Unknown")}async function j$(t,e,n){if(t.q_.set("Online"),e instanceof hC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(t,e)}catch(r){J("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Jh(t,r)}else if(e instanceof Qd?t.Q_.Ke(e):e instanceof dC?t.Q_.He(e):t.Q_.We(e),!n.isEqual(pe.min()))try{const r=await FC(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(gt.EMPTY_BYTE_STRING,d.snapshotVersion)),WC(s,l);const h=new si(d.target,l,c,d.sequenceNumber);Xy(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){J("RemoteStore","Failed to raise snapshot:",r),await Jh(t,r)}}async function Jh(t,e,n){if(!vs(e))throw e;t.L_.add(1),await ku(t),t.q_.set("Offline"),n||(n=()=>FC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{J("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Hf(t)})}function YC(t,e){return e().catch(n=>Jh(t,n,e))}async function fl(t){const e=de(t),n=hs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;F$(e);)try{const i=await S$(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,$$(e,i)}catch(i){await Jh(e,i)}XC(e)&&JC(e)}function F$(t){return xo(t)&&t.O_.length<10}function $$(t,e){t.O_.push(e);const n=hs(t);n.r_()&&n.V_&&n.m_(e.mutations)}function XC(t){return xo(t)&&!hs(t).n_()&&t.O_.length>0}function JC(t){hs(t).start()}async function U$(t){hs(t).p_()}async function B$(t){const e=hs(t);for(const n of t.O_)e.m_(n.mutations)}async function q$(t,e,n){const r=t.O_.shift(),i=$y.from(r,e,n);await YC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await fl(t)}async function H$(t,e){e&&hs(t).V_&&await async function(r,i){if(function(o){return RF(o)&&o!==Q.ABORTED}(i.code)){const s=r.O_.shift();hs(r).s_(),await YC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await fl(r)}}(t,e),XC(t)&&JC(t)}async function z1(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),J("RemoteStore","RemoteStore received new credentials");const r=xo(n);n.L_.add(3),await ku(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Hf(n)}async function Hg(t,e){const n=de(t);e?(n.L_.delete(2),await Hf(n)):e||(n.L_.add(2),await ku(n),n.q_.set("Unknown"))}function pl(t){return t.K_||(t.K_=function(n,r,i){const s=de(n);return s.w_(),new N$(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:z$.bind(null,t),Ro:M$.bind(null,t),mo:L$.bind(null,t),d_:j$.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Zy(t)?Jy(t):t.q_.set("Unknown")):(await t.K_.stop(),QC(t))})),t.K_}function hs(t){return t.U_||(t.U_=function(n,r,i){const s=de(n);return s.w_(),new P$(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:U$.bind(null,t),mo:H$.bind(null,t),f_:B$.bind(null,t),g_:q$.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await fl(t)):(await t.U_.stop(),t.O_.length>0&&(J("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ev{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Lr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new ev(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ne(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function tv(t,e){if(mt("AsyncQueue",`${e}: ${t}`),vs(t))return new ne(Q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aa{constructor(e){this.comparator=e?(n,r)=>e(n,r)||re.comparator(n.key,r.key):(n,r)=>re.comparator(n.key,r.key),this.keyedMap=ic(),this.sortedSet=new We(this.comparator)}static emptySet(e){return new Aa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Aa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Aa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M1{constructor(){this.W_=new We(re.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ce():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ja{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ja(e,n,Aa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Mf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K${constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class G${constructor(){this.queries=L1(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=de(n),s=i.queries;i.queries=L1(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new ne(Q.ABORTED,"Firestore shutting down"))}}function L1(){return new _s(t=>Q2(t),Mf)}async function ZC(t,e){const n=de(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new K$,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=tv(o,`Initialization of query '${Jo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&nv(n)}async function eA(t,e){const n=de(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function W$(t,e){const n=de(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&nv(n)}function Q$(t,e,n){const r=de(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function nv(t){t.Y_.forEach(e=>{e.next()})}var Kg,j1;(j1=Kg||(Kg={})).ea="default",j1.Cache="cache";class tA{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ja(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ja.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Kg.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e){this.key=e}}class rA{constructor(e){this.key=e}}class Y${constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=be(),this.mutatedKeys=be(),this.Aa=X2(e),this.Ra=new Aa(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new M1,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const f=i.get(d),m=Su(this.query,h)?h:null,E=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let R=!1;f&&m?f.data.isEqual(m.data)?E!==x&&(r.track({type:3,doc:m}),R=!0):this.ga(f,m)||(r.track({type:2,doc:m}),R=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),R=!0):f&&!m&&(r.track({type:1,doc:f}),R=!0,(l||c)&&(a=!0)),R&&(m?(o=o.add(m),s=x?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,h)=>function(m,E){const x=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ce()}};return x(m)-x(E)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;const a=n&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new Ja(this.query,e.Ra,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new M1,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=be(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new rA(r))}),this.da.forEach(r=>{e.has(r)||n.push(new nA(r))}),n}ba(e){this.Ta=e.Ts,this.da=be();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ja.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class X${constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class J${constructor(e){this.key=e,this.va=!1}}class Z${constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new _s(a=>Q2(a),Mf),this.Ma=new Map,this.xa=new Set,this.Oa=new We(re.comparator),this.Na=new Map,this.La=new Gy,this.Ba={},this.ka=new Map,this.qa=fo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function eU(t,e,n=!0){const r=Gf(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await iA(r,e,n,!0),i}async function tU(t,e){const n=Gf(t);await iA(n,e,!0,!1)}async function iA(t,e,n,r){const i=await Qh(t.localStore,Ln(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await rv(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&Kf(t.remoteStore,i),a}async function rv(t,e,n,r,i){t.Ka=(h,f,m)=>async function(x,R,y,v){let T=R.view.ma(y);T.ns&&(T=await Bg(x.localStore,R.query,!1).then(({documents:S})=>R.view.ma(S,T)));const k=v&&v.targetChanges.get(R.targetId),O=v&&v.targetMismatches.get(R.targetId)!=null,z=R.view.applyChanges(T,x.isPrimaryClient,k,O);return Gg(x,R.targetId,z.wa),z.snapshot}(t,h,f,m);const s=await Bg(t.localStore,e,!0),o=new Y$(e,s.Ts),a=o.ma(s.documents),l=Au.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);Gg(t,n,c.wa);const d=new X$(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function nU(t,e,n){const r=de(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Mf(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ya(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Xa(r.remoteStore,i.targetId),Za(r,i.targetId)}).catch(ys)):(Za(r,i.targetId),await Ya(r.localStore,i.targetId,!0))}async function rU(t,e){const n=de(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Xa(n.remoteStore,r.targetId))}async function iU(t,e,n){const r=av(t);try{const i=await function(o,a){const l=de(o),c=ot.now(),d=a.reduce((m,E)=>m.add(E.key),be());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let E=zn(),x=be();return l.cs.getEntries(m,d).next(R=>{E=R,E.forEach((y,v)=>{v.isValidDocument()||(x=x.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,E)).next(R=>{h=R;const y=[];for(const v of a){const T=AF(v,h.get(v.key).overlayedDocument);T!=null&&y.push(new ws(v.key,T,j2(T.value.mapValue),yn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,y,a)}).next(R=>{f=R;const y=R.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(m,R.batchId,y)})}).then(()=>({batchId:f.batchId,changes:Z2(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new We(ve)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,n),await xs(r,i.changes),await fl(r.remoteStore)}catch(i){const s=tv(i,"Failed to persist write");n.reject(s)}}async function sA(t,e){const n=de(t);try{const r=await I$(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(he(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?he(o.va):i.removedDocuments.size>0&&(he(o.va),o.va=!1))}),await xs(n,r,e)}catch(r){await ys(r)}}function F1(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=de(o);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(const f of h.j_)f.Z_(a)&&(c=!0)}),c&&nv(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function sU(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new We(re.comparator);o=o.insert(s,dt.newNoDocument(s,pe.min()));const a=be().add(s),l=new Cu(pe.min(),new Map,new We(ve),o,a);await sA(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),ov(r)}else await Ya(r.localStore,e,!1).then(()=>Za(r,e,n)).catch(ys)}async function oU(t,e){const n=de(t),r=e.batch.batchId;try{const i=await E$(n.localStore,e);sv(n,r,null),iv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await xs(n,i)}catch(i){await ys(i)}}async function aU(t,e,n){const r=de(t);try{const i=await function(o,a){const l=de(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(he(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);sv(r,e,n),iv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await xs(r,i)}catch(i){await ys(i)}}function iv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function sv(t,e,n){const r=de(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Za(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||oA(t,r)})}function oA(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Xa(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),ov(t))}function Gg(t,e,n){for(const r of n)r instanceof nA?(t.La.addReference(r.key,e),lU(t,r)):r instanceof rA?(J("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||oA(t,r.key)):ce()}function lU(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(J("SyncEngine","New document in limbo: "+n),t.xa.add(r),ov(t))}function ov(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new re(je.fromString(e)),r=t.qa.next();t.Na.set(r,new J$(n)),t.Oa=t.Oa.insert(n,r),Kf(t.remoteStore,new si(Ln(zf(n.path)),r,"TargetPurposeLimboResolution",gn.oe))}}async function xs(t,e,n){const r=de(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const h=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Qy.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,c){const d=de(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>H.forEach(c,f=>H.forEach(f.$i,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>H.forEach(f.Ui,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!vs(h))throw h;J("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const m=d.os.get(f),E=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(E);d.os=d.os.insert(f,x)}}}(r.localStore,s))}async function cU(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){J("SyncEngine","User change. New user:",e.toKey());const r=await jC(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new ne(Q.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await xs(n,r.hs)}}function uU(t,e){const n=de(t),r=n.Na.get(e);if(r&&r.va)return be().add(r.key);{let i=be();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}async function dU(t,e){const n=de(t),r=await Bg(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&Gg(n,e.targetId,i.wa),i}async function hU(t,e){const n=de(t);return UC(n.localStore,e).then(r=>xs(n,r))}async function fU(t,e,n,r){const i=de(t),s=await function(a,l){const c=de(a),d=de(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.Mn(h,l).next(f=>f?c.localDocuments.getDocuments(h,f):H.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await fl(i.remoteStore):n==="acknowledged"||n==="rejected"?(sv(i,e,r||null),iv(i,e),function(a,l){de(de(a).mutationQueue).On(l)}(i.localStore,e)):ce(),await xs(i,s)):J("SyncEngine","Cannot apply mutation batch with id: "+e)}async function pU(t,e){const n=de(t);if(Gf(n),av(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await $1(n,r.toArray());n.Qa=!0,await Hg(n.remoteStore,!0);for(const s of i)Kf(n.remoteStore,s)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Za(n,o),Ya(n.localStore,o,!0))),Xa(n.remoteStore,o)}),await i,await $1(n,r),function(o){const a=de(o);a.Na.forEach((l,c)=>{Xa(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new We(re.comparator)}(n),n.Qa=!1,await Hg(n.remoteStore,!1)}}async function $1(t,e,n){const r=de(t),i=[],s=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await Qh(r.localStore,Ln(l[0]));for(const c of l){const d=r.Fa.get(c),h=await dU(r,d);h.snapshot&&s.push(h.snapshot)}}else{const c=await $C(r.localStore,o);a=await Qh(r.localStore,c),await rv(r,aA(c),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i}function aA(t){return G2(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function mU(t){return function(n){return de(de(n).persistence).Qi()}(de(t).localStore)}async function gU(t,e,n,r){const i=de(t);if(i.Qa)return void J("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await UC(i.localStore,Y2(s[0])),a=Cu.createSynthesizedRemoteEventForCurrentChange(e,n==="current",gt.EMPTY_BYTE_STRING);await xs(i,o,a);break}case"rejected":await Ya(i.localStore,e,!0),Za(i,e,r);break;default:ce()}}async function yU(t,e,n){const r=Gf(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){J("SyncEngine","Adding an already active target "+i);continue}const s=await $C(r.localStore,i),o=await Qh(r.localStore,s);await rv(r,aA(s),o.targetId,!1,o.resumeToken),Kf(r.remoteStore,o)}for(const i of n)r.Ma.has(i)&&await Ya(r.localStore,i,!1).then(()=>{Xa(r.remoteStore,i),Za(r,i)}).catch(ys)}}function Gf(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=sA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=uU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=sU.bind(null,e),e.Ca.d_=W$.bind(null,e.eventManager),e.Ca.$a=Q$.bind(null,e.eventManager),e}function av(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=oU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=aU.bind(null,e),e}class cu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return LC(this.persistence,new MC,e.initialUser,this.serializer)}Ga(e){return new OC(Bf.Zr,this.serializer)}Wa(e){return new qC}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cu.provider={build:()=>new cu};class lA extends cu{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await av(this.Ja.syncEngine),await fl(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return LC(this.persistence,new MC,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new s$(r,e.asyncQueue,n)}Ha(e,n){const r=new L9(n,this.persistence);return new M9(e.asyncQueue,r)}Ga(e){const n=zC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?dn.withCacheSize(this.cacheSizeBytes):dn.DEFAULT;return new Wy(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,HC(),Yd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new qC}}class vU extends lA{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof Zp&&(this.sharedClientState.syncEngine={no:fU.bind(null,n),ro:gU.bind(null,n),io:yU.bind(null,n),Qi:mU.bind(null,n),eo:hU.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await pU(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=HC();if(!Zp.D(n))throw new ne(Q.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=zC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Zp(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class uu{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>F1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=cU.bind(null,this.syncEngine),await Hg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new G$}()}createDatastore(e){const n=qf(e.databaseInfo.databaseId),r=function(s){return new R$(s)}(e.databaseInfo);return function(s,o,a,l){return new D$(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new O$(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>F1(this.syncEngine,n,0),function(){return O1.D()?new O1:new C$}())}createSyncEngine(e,n){return function(i,s,o,a,l,c,d){const h=new Z$(i,s,o,a,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=de(i);J("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await ku(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}uu.provider={build:()=>new uu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):mt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Xt.UNAUTHENTICATED,this.clientId=E2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{J("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(J("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Lr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=tv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function tm(t,e){t.asyncQueue.verifyOperationInProgress(),J("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await jC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function U1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await wU(t);J("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>z1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>z1(e.remoteStore,i)),t._onlineComponents=e}async function wU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){J("FirestoreClient","Using user provided OfflineComponentProvider");try{await tm(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Q.FAILED_PRECONDITION||i.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;eu("Error using user provided cache. Falling back to memory cache: "+n),await tm(t,new cu)}}else J("FirestoreClient","Using default OfflineComponentProvider"),await tm(t,new cu);return t._offlineComponents}async function uA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(J("FirestoreClient","Using user provided OnlineComponentProvider"),await U1(t,t._uninitializedComponentsProvider._online)):(J("FirestoreClient","Using default OnlineComponentProvider"),await U1(t,new uu))),t._onlineComponents}function xU(t){return uA(t).then(e=>e.syncEngine)}async function dA(t){const e=await uA(t),n=e.eventManager;return n.onListen=eU.bind(null,e.syncEngine),n.onUnlisten=nU.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=tU.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=rU.bind(null,e.syncEngine),n}function bU(t,e,n={}){const r=new Lr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new cA({next:f=>{d.Za(),o.enqueueAndForget(()=>eA(s,h));const m=f.docs.has(a);!m&&f.fromCache?c.reject(new ne(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&l&&l.source==="server"?c.reject(new ne(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new tA(zf(a.path),d,{includeMetadataChanges:!0,_a:!0});return ZC(s,h)}(await dA(t),t.asyncQueue,e,n,r)),r.promise}function EU(t,e,n={}){const r=new Lr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new cA({next:f=>{d.Za(),o.enqueueAndForget(()=>eA(s,h)),f.fromCache&&l.source==="server"?c.reject(new ne(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new tA(a,d,{includeMetadataChanges:!0,_a:!0});return ZC(s,h)}(await dA(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(t,e,n){if(!n)throw new ne(Q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function IU(t,e,n,r){if(e===!0&&r===!0)throw new ne(Q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function q1(t){if(!re.isDocumentKey(t))throw new ne(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function H1(t){if(re.isDocumentKey(t))throw new ne(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Wf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ce()}function po(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ne(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Wf(t);throw new ne(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K1{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ne(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ne(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=hA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ne(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ne(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ne(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class lv{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new K1({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ne(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ne(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new K1(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new C9;switch(r.type){case"firstParty":return new R9(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=B1.get(n);r&&(J("ComponentProvider","Removing Datastore"),B1.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ml(this.firestore,e,this._query)}}class bn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new os(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new bn(this.firestore,e,this._key)}}class os extends ml{constructor(e,n,r){super(e,n,zf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new bn(this.firestore,null,new re(e))}withConverter(e){return new os(this.firestore,e,this._path)}}function TU(t,e,...n){if(t=Ct(t),fA("collection","path",e),t instanceof lv){const r=je.fromString(e,...n);return H1(r),new os(t,null,r)}{if(!(t instanceof bn||t instanceof os))throw new ne(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return H1(r),new os(t.firestore,null,r)}}function nm(t,e,...n){if(t=Ct(t),arguments.length===1&&(e=E2.newId()),fA("doc","path",e),t instanceof lv){const r=je.fromString(e,...n);return q1(r),new bn(t,null,new re(r))}{if(!(t instanceof bn||t instanceof os))throw new ne(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return q1(r),new bn(t.firestore,t instanceof os?t.converter:null,new re(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G1{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new KC(this,"async_queue_retry"),this.Vu=()=>{const r=Yd();r&&J("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Yd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Yd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Lr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!vs(e))throw e;J("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw mt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=ev.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ce()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Ru extends lv{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new G1,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new G1(e),this._firestoreClient=void 0,await e}}}function SU(t,e,n){n||(n="(default)");const r=wo(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Fa(s,e))return i;throw new ne(Q.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ne(Q.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ne(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function cv(t){if(t._terminated)throw new ne(Q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||CU(t),t._firestoreClient}function CU(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,c,d){return new sF(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,hA(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new _U(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el{constructor(e){this._byteString=e}static fromBase64String(e){try{return new el(gt.fromBase64String(e))}catch(n){throw new ne(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new el(gt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ne(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new it(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dv{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ne(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ne(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ve(this._lat,e._lat)||ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fv{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AU=/^__.*__$/;class kU{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ws(e,this.data,this.fieldMask,n,this.fieldTransforms):new hl(e,this.data,n,this.fieldTransforms)}}function pA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ce()}}class pv{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new pv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Zh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(pA(this.Cu)&&AU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class RU{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||qf(e)}Qu(e,n,r,i=!1){return new pv({Cu:e,methodName:n,qu:r,path:it.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function mA(t){const e=t._freezeSettings(),n=qf(t._databaseId);return new RU(t._databaseId,!!e.ignoreUndefinedProperties,n)}function NU(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);vA("Data must be an object, but it was:",o,r);const a=gA(r,o);let l,c;if(s.merge)l=new Jn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const f=DU(e,h,n);if(!o.contains(f))throw new ne(Q.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);OU(d,f)||d.push(f)}l=new Jn(d),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new kU(new fn(a),l,c)}class mv extends dv{_toFieldTransform(e){return new oC(e.path,new Ka)}isEqual(e){return e instanceof mv}}function PU(t,e,n,r=!1){return gv(n,t.Qu(r?4:3,e))}function gv(t,e){if(yA(t=Ct(t)))return vA("Unsupported field value:",e,t),gA(t,e);if(t instanceof dv)return function(r,i){if(!pA(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=gv(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Ct(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return bF(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=ot.fromDate(r);return{timestampValue:Qa(i.serializer,s)}}if(r instanceof ot){const s=new ot(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Qa(i.serializer,s)}}if(r instanceof hv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof el)return{bytesValue:fC(i.serializer,r._byteString)};if(r instanceof bn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:qy(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof fv)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return jy(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Wf(r)}`)}(t,e)}function gA(t,e){const n={};return O2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):dl(t,(r,i)=>{const s=gv(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function yA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof ot||t instanceof hv||t instanceof el||t instanceof bn||t instanceof dv||t instanceof fv)}function vA(t,e,n){if(!yA(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Wf(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function DU(t,e,n){if((e=Ct(e))instanceof uv)return e._internalPath;if(typeof e=="string")return _A(t,e);throw Zh("Field path arguments must be of type string or ",t,!1,void 0,n)}const VU=new RegExp("[~\\*/\\[\\]]");function _A(t,e,n){if(e.search(VU)>=0)throw Zh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new uv(...e.split("."))._internalPath}catch{throw Zh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Zh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ne(Q.INVALID_ARGUMENT,a+t+l)}function OU(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new bn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new zU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(xA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class zU extends wA{data(){return super.data()}}function xA(t,e){return typeof e=="string"?_A(t,e):e instanceof uv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ne(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yv{}class LU extends yv{}function jU(t,e,...n){let r=[];e instanceof yv&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof _v).length,a=s.filter(l=>l instanceof vv).length;if(o>1||o>0&&a>0)throw new ne(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class vv extends LU{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new vv(e,n,r)}_apply(e){const n=this._parse(e);return bA(e._query,n),new ml(e.firestore,e.converter,Vg(e._query,n))}_parse(e){const n=mA(e.firestore);return function(s,o,a,l,c,d,h){let f;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ne(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Q1(h,d);const m=[];for(const E of h)m.push(W1(l,s,E));f={arrayValue:{values:m}}}else f=W1(l,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Q1(h,d),f=PU(a,o,h,d==="in"||d==="not-in");return Ne.create(c,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class _v extends yv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new _v(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:$e.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)bA(o,l),o=Vg(o,l)}(e._query,n),new ml(e.firestore,e.converter,Vg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function W1(t,e,n){if(typeof(n=Ct(n))=="string"){if(n==="")throw new ne(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!W2(e)&&n.indexOf("/")!==-1)throw new ne(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(je.fromString(n));if(!re.isDocumentKey(r))throw new ne(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return ou(t,new re(r))}if(n instanceof bn)return ou(t,n._key);throw new ne(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Wf(n)}.`)}function Q1(t,e){if(!Array.isArray(t)||t.length===0)throw new ne(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bA(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ne(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ne(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class FU{convertValue(e,n="none"){switch(lo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return et(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ce()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return dl(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>et(o.doubleValue));return new fv(s)}convertGeoPoint(e){return new hv(et(e.latitude),et(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=zy(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(iu(e));default:return null}}convertTimestamp(e){const n=vi(e);return new ot(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=je.fromString(e);he(EC(r));const i=new ao(r.get(1),r.get(3)),s=new re(r.popFirst(5));return i.isEqual(n)||mt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $U(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ac{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class EA extends wA{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Xd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(xA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Xd extends EA{data(e={}){return super.data(e)}}class UU{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new ac(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Xd(this._firestore,this._userDataWriter,r.key,r,new ac(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ne(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Xd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ac(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Xd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new ac(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:BU(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function BU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ce()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qU(t){t=po(t,bn);const e=po(t.firestore,Ru);return bU(cv(e),t._key).then(n=>WU(e,t,n))}class IA extends FU{constructor(e){super(),this.firestore=e}convertBytes(e){return new el(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new bn(this.firestore,null,n)}}function HU(t){t=po(t,ml);const e=po(t.firestore,Ru),n=cv(e),r=new IA(e);return MU(t._query),EU(n,t._query).then(i=>new UU(e,r,t,i))}function KU(t,e,n){t=po(t,bn);const r=po(t.firestore,Ru),i=$U(t.converter,e,n);return TA(r,[NU(mA(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,yn.none())])}function GU(t){return TA(po(t.firestore,Ru),[new Ff(t._key,yn.none())])}function TA(t,e){return function(r,i){const s=new Lr;return r.asyncQueue.enqueueAndForget(async()=>iU(await xU(r),i,s)),s.promise}(cv(t),e)}function WU(t,e,n){const r=n.docs.get(e._key),i=new IA(t);return new EA(t,i,e._key,r,new ac(n.hasPendingWrites,n.fromCache),e.converter)}class QU{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=ZU(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function YU(t){return new QU(t)}class XU{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=uu.provider,this._offlineComponentProvider={build:n=>new lA(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class JU{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=uu.provider,this._offlineComponentProvider={build:n=>new vU(n,e==null?void 0:e.cacheSizeBytes)}}}function ZU(t){return new XU(void 0)}function e8(){return new JU}function t8(){return new mv("serverTimestamp")}(function(e,n=!0){(function(i){ul=i})(ll),jr(new xr("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Ru(new A9(r.getProvider("auth-internal")),new P9(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ne(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ao(c.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),er(Ux,"4.7.3",e),er(Ux,"4.7.3","esm2017")})();const SA="@firebase/installations",wv="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CA=1e4,AA=`w:${wv}`,kA="FIS_v2",n8="https://firebaseinstallations.googleapis.com/v1",r8=60*60*1e3,i8="installations",s8="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o8={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},mo=new _o(i8,s8,o8);function RA(t){return t instanceof Er&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NA({projectId:t}){return`${n8}/projects/${t}/installations`}function PA(t){return{token:t.token,requestStatus:2,expiresIn:l8(t.expiresIn),creationTime:Date.now()}}async function DA(t,e){const r=(await e.json()).error;return mo.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function VA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function a8(t,{refreshToken:e}){const n=VA(t);return n.append("Authorization",c8(e)),n}async function OA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function l8(t){return Number(t.replace("s","000"))}function c8(t){return`${kA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u8({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=NA(t),i=VA(t),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={fid:n,authVersion:kA,appId:t.appId,sdkVersion:AA},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await OA(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:PA(c.authToken)}}else throw await DA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d8(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h8=/^[cdef][\w-]{21}$/,Wg="";function f8(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=p8(t);return h8.test(n)?n:Wg}catch{return Wg}}function p8(t){return d8(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MA=new Map;function LA(t,e){const n=Qf(t);jA(n,e),m8(n,e)}function jA(t,e){const n=MA.get(t);if(n)for(const r of n)r(e)}function m8(t,e){const n=g8();n&&n.postMessage({key:t,fid:e}),y8()}let qs=null;function g8(){return!qs&&"BroadcastChannel"in self&&(qs=new BroadcastChannel("[Firebase] FID Change"),qs.onmessage=t=>{jA(t.data.key,t.data.fid)}),qs}function y8(){MA.size===0&&qs&&(qs.close(),qs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8="firebase-installations-database",_8=1,go="firebase-installations-store";let rm=null;function xv(){return rm||(rm=PS(v8,_8,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(go)}}})),rm}async function ef(t,e){const n=Qf(t),i=(await xv()).transaction(go,"readwrite"),s=i.objectStore(go),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&LA(t,e.fid),e}async function FA(t){const e=Qf(t),r=(await xv()).transaction(go,"readwrite");await r.objectStore(go).delete(e),await r.done}async function Yf(t,e){const n=Qf(t),i=(await xv()).transaction(go,"readwrite"),s=i.objectStore(go),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&LA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bv(t){let e;const n=await Yf(t.appConfig,r=>{const i=w8(r),s=x8(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Wg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function w8(t){const e=t||{fid:f8(),registrationStatus:0};return $A(e)}function x8(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(mo.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=b8(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:E8(t)}:{installationEntry:e}}async function b8(t,e){try{const n=await u8(t,e);return ef(t.appConfig,n)}catch(n){throw RA(n)&&n.customData.serverCode===409?await FA(t.appConfig):await ef(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function E8(t){let e=await Y1(t.appConfig);for(;e.registrationStatus===1;)await zA(100),e=await Y1(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await bv(t);return r||n}return e}function Y1(t){return Yf(t,e=>{if(!e)throw mo.create("installation-not-found");return $A(e)})}function $A(t){return I8(t)?{fid:t.fid,registrationStatus:0}:t}function I8(t){return t.registrationStatus===1&&t.registrationTime+CA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T8({appConfig:t,heartbeatServiceProvider:e},n){const r=S8(t,n),i=a8(t,n),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={installation:{sdkVersion:AA,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await OA(()=>fetch(r,a));if(l.ok){const c=await l.json();return PA(c)}else throw await DA("Generate Auth Token",l)}function S8(t,{fid:e}){return`${NA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ev(t,e=!1){let n;const r=await Yf(t.appConfig,s=>{if(!UA(s))throw mo.create("not-registered");const o=s.authToken;if(!e&&k8(o))return s;if(o.requestStatus===1)return n=C8(t,e),s;{if(!navigator.onLine)throw mo.create("app-offline");const a=N8(s);return n=A8(t,a),a}});return n?await n:r.authToken}async function C8(t,e){let n=await X1(t.appConfig);for(;n.authToken.requestStatus===1;)await zA(100),n=await X1(t.appConfig);const r=n.authToken;return r.requestStatus===0?Ev(t,e):r}function X1(t){return Yf(t,e=>{if(!UA(e))throw mo.create("not-registered");const n=e.authToken;return P8(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function A8(t,e){try{const n=await T8(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await ef(t.appConfig,r),n}catch(n){if(RA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await FA(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await ef(t.appConfig,r)}throw n}}function UA(t){return t!==void 0&&t.registrationStatus===2}function k8(t){return t.requestStatus===2&&!R8(t)}function R8(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+r8}function N8(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function P8(t){return t.requestStatus===1&&t.requestTime+CA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D8(t){const e=t,{installationEntry:n,registrationPromise:r}=await bv(e);return r?r.catch(console.error):Ev(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V8(t,e=!1){const n=t;return await O8(n),(await Ev(n,e)).token}async function O8(t){const{registrationPromise:e}=await bv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z8(t){if(!t||!t.options)throw im("App Configuration");if(!t.name)throw im("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw im(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function im(t){return mo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BA="installations",M8="installations-internal",L8=t=>{const e=t.getProvider("app").getImmediate(),n=z8(e),r=wo(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},j8=t=>{const e=t.getProvider("app").getImmediate(),n=wo(e,BA).getImmediate();return{getId:()=>D8(n),getToken:i=>V8(n,i)}};function F8(){jr(new xr(BA,L8,"PUBLIC")),jr(new xr(M8,j8,"PRIVATE"))}F8();er(SA,wv);er(SA,wv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tf="analytics",$8="firebase_id",U8="origin",B8=60*1e3,q8="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Iv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const En=new kf("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H8={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},jn=new _o("analytics","Analytics",H8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function K8(t){if(!t.startsWith(Iv)){const e=jn.create("invalid-gtag-resource",{gtagURL:t});return En.warn(e.message),""}return t}function qA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function G8(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function W8(t,e){const n=G8("firebase-js-sdk-policy",{createScriptURL:K8}),r=document.createElement("script"),i=`${Iv}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function Q8(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function Y8(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await qA(n)).find(c=>c.measurementId===i);l&&await e[l.appId]}}catch(a){En.error(a)}t("config",i,s)}async function X8(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await qA(n);for(const l of o){const c=a.find(h=>h.measurementId===l),d=c&&e[c.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){En.error(s)}}function J8(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await X8(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await Y8(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,c]=o;t("get",a,l,c)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){En.error(a)}}return i}function Z8(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=J8(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function eB(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(Iv)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tB=30,nB=1e3;class rB{constructor(e={},n=nB){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const HA=new rB;function iB(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function sB(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:iB(r)},s=q8.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw jn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function oB(t,e=HA,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw jn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw jn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new cB;return setTimeout(async()=>{a.abort()},B8),KA({appId:r,apiKey:i,measurementId:s},o,a,e)}async function KA(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=HA){var s;const{appId:o,measurementId:a}=t;try{await aB(r,e)}catch(l){if(a)return En.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await sB(t);return i.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!lB(c)){if(i.deleteThrottleMetadata(o),a)return En.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const d=Number((s=c==null?void 0:c.customData)===null||s===void 0?void 0:s.httpStatus)===503?fx(n,i.intervalMillis,tB):fx(n,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return i.setThrottleMetadata(o,h),En.debug(`Calling attemptFetch again in ${d} millis`),KA(t,h,r,i)}}function aB(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(jn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function lB(t){if(!(t instanceof Er)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class cB{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function uB(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dB(){if(vy())try{await kS()}catch(t){return En.warn(jn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return En.warn(jn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function hB(t,e,n,r,i,s,o){var a;const l=oB(t);l.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&En.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>En.error(m)),e.push(l);const c=dB().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([l,c]);eB(s)||W8(s,d.measurementId),i("js",new Date);const f=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return f[U8]="firebase",f.update=!0,h!=null&&(f[$8]=h),i("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fB{constructor(e){this.app=e}_delete(){return delete Ic[this.app.options.appId],Promise.resolve()}}let Ic={},J1=[];const Z1={};let sm="dataLayer",pB="gtag",eb,GA,tb=!1;function mB(){const t=[];if(CS()&&t.push("This is a browser extension environment."),FL()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=jn.create("invalid-analytics-context",{errorInfo:e});En.warn(n.message)}}function gB(t,e,n){mB();const r=t.options.appId;if(!r)throw jn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)En.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw jn.create("no-api-key");if(Ic[r]!=null)throw jn.create("already-exists",{id:r});if(!tb){Q8(sm);const{wrappedGtag:s,gtagCore:o}=Z8(Ic,J1,Z1,sm,pB);GA=s,eb=o,tb=!0}return Ic[r]=hB(t,J1,Z1,e,eb,sm,n),new fB(t)}function yB(t=VS()){t=Ct(t);const e=wo(t,tf);return e.isInitialized()?e.getImmediate():vB(t)}function vB(t,e={}){const n=wo(t,tf);if(n.isInitialized()){const i=n.getImmediate();if(Fa(e,n.getOptions()))return i;throw jn.create("already-initialized")}return n.initialize({options:e})}function _B(t,e,n,r){t=Ct(t),uB(GA,Ic[t.app.options.appId],e,n,r).catch(i=>En.error(i))}const nb="@firebase/analytics",rb="0.10.8";function wB(){jr(new xr(tf,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return gB(r,i,n)},"PUBLIC")),jr(new xr("analytics-internal",t,"PRIVATE")),er(nb,rb),er(nb,rb,"esm2017");function t(e){try{const n=e.getProvider(tf).getImmediate();return{logEvent:(r,i,s)=>_B(n,r,i,s)}}catch(n){throw jn.create("interop-component-reg-failed",{reason:n})}}}wB();const xB={apiKey:"AIzaSyBRvglSh40aRJFOA9SNxoyBhNjslW_7p8k",authDomain:"detective-board-b108b.firebaseapp.com",projectId:"detective-board-b108b",storageBucket:"detective-board-b108b.firebasestorage.app",messagingSenderId:"140107009046",appId:"1:140107009046:web:49e3c650ea0e90a5f2b937",measurementId:"G-TBJ91VEM4Y"},Tv=DS(xB);yB(Tv);const oi=b9(Tv),bd=SU(Tv,{localCache:YU({tabManager:e8()}),experimentalForceLongPolling:!0}),bB=new Jr,WA=D.createContext();function Sv(){return D.useContext(WA)}function EB({children:t}){const[e,n]=D.useState(null),[r,i]=D.useState(!0);D.useEffect(()=>u6(oi,a=>{n(a),i(!1)}),[]);const s={currentUser:e};return p.jsx(WA.Provider,{value:s,children:!r&&t})}const IB=({onSwitchToSignUp:t,onForgotPassword:e,isDarkMode:n})=>{const[r,i]=D.useState(""),[s,o]=D.useState(""),[a,l]=D.useState(""),c=async h=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)){l("Por favor, introduce un correo electrnico vlido.");return}h.preventDefault(),l("");try{if(await i6(oi,r,s),!oi.currentUser.emailVerified){l("Por favor, verifica tu correo electrnico antes de iniciar sesin."),await oi.signOut();return}}catch(m){console.error(m),l("Error: "+m.message)}},d=async()=>{l("");try{await N6(oi,bB)}catch(h){console.error(h),h.code==="auth/cancelled-popup-request"?l(""):l("Error Google: "+h.message)}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto ",children:[p.jsxs("form",{onSubmit:c,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${n?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mt-4 mb-6 text-center font-mono ${n?"text-white":"text-gray-800"}`,children:"INICIAR SESIN"}),a&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:a}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${n?"text-zinc-400":"text-gray-600"}`,htmlFor:"login-email",children:"Correo"}),p.jsxs("div",{className:"relative",children:[p.jsx(dy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${n?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"login-email",type:"email",placeholder:"detective@agencia.com",value:r,onChange:h=>i(h.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${n?"text-zinc-400":"text-gray-600"}`,htmlFor:"login-password",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(ja,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${n?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"login-password",type:"password",placeholder:"",value:s,onChange:h=>o(h.target.value),required:!0})]})]}),p.jsxs("div",{className:"flex flex-col gap-4",children:[p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Entrar"}),p.jsxs("div",{className:"relative flex py-1 items-center",children:[p.jsx("div",{className:`flex-grow border-t ${n?"border-zinc-600":"border-gray-300"}`}),p.jsx("span",{className:`flex-shrink mx-2 text-xs ${n?"text-zinc-500":"text-gray-400"}`,children:"O"}),p.jsx("div",{className:`flex-grow border-t ${n?"border-zinc-600":"border-gray-300"}`})]}),p.jsxs("button",{onClick:d,type:"button",className:`flex items-center justify-center gap-3 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-all active:scale-95 ${n?"bg-white text-gray-700 hover:bg-gray-100":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[p.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),p.jsx("div",{className:"text-center mt-6",children:p.jsx("a",{onClick:e,className:"inline-block align-baseline font-bold text-sm text-blue-400 hover:text-blue-300 cursor-pointer",children:"Olvidaste tu contrasea?"})})]}),p.jsxs("p",{className:`text-center text-xs ${n?"text-zinc-500":"text-gray-500"}`,children:["No tienes cuenta?"," ",p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Regstrate aqu."})]})]})},TB=["gmail.com","outlook.com","hotmail.com","yahoo.com","icloud.com","live.com","protonmail.com","msn.com","uni.pe"],SB=({onSwitchToLogin:t,isDarkMode:e})=>{const[n,r]=D.useState(""),[i,s]=D.useState(""),[o,a]=D.useState(""),[l,c]=D.useState(""),[d,h]=D.useState(""),[f,m]=D.useState(""),[E,x]=D.useState(!1),R=async y=>{var k;if(y.preventDefault(),h(""),m(""),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i))return h("Por favor, introduce un correo electrnico vlido.");if(o!==l)return h("Las contraseas no coinciden.");const T=(k=i.split("@")[1])==null?void 0:k.toLowerCase();if(!TB.includes(T))return h("Por favor, usa un correo de un proveedor reconocido (Gmail, Outlook, etc.).");x(!0);try{if((await(await fetch(`https://api.mailcheck.ai/email/${encodeURIComponent(i)}`)).json()).disposable===!0)return x(!1),h("No se permiten correos temporales.")}catch{console.warn("MailCheck no disponible, continuando con whitelist.")}try{const O=await r6(oi,i,o);await a6(O.user,{displayName:n}),await s6(O.user),await oi.signOut(),m("Cuenta creada! Te enviamos un correo de verificacin. Revsalo antes de iniciar sesin.")}catch(O){O.code==="auth/email-already-in-use"?h("Este correo ya est en uso."):O.code==="auth/weak-password"?h("La contrasea es muy dbil (mnimo 6 caracteres)."):h("Error: "+O.message)}finally{x(!1)}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:R,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${e?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"} `,children:[p.jsx("h2",{className:`text-2xl font-bold mt-4 mb-6 text-center font-mono ${e?"text-white":"text-gray-800"}`,children:"CREAR CUENTA"}),d&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:d}),f&&p.jsx("p",{className:"bg-green-900/50 text-green-300 text-xs p-3 rounded mb-4",children:f}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-name",children:"Nombre"}),p.jsxs("div",{className:"relative",children:[p.jsx(fy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-name",type:"text",placeholder:"Sherlock Holmes",value:n,onChange:y=>r(y.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-email",children:"Correo"}),p.jsxs("div",{className:"relative",children:[p.jsx(dy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-email",type:"email",placeholder:"detective@agencia.com",value:i,onChange:y=>s(y.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-password",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(ja,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-password",type:"password",placeholder:"",value:o,onChange:y=>a(y.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-confirm-password",children:"Confirmar Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(ja,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-confirm-password",type:"password",placeholder:"",value:l,onChange:y=>c(y.target.value),required:!0})]})]}),p.jsx("div",{className:"flex flex-col gap-4",children:p.jsx("button",{disabled:E,className:"bg-red-600 hover:bg-red-700 disabled:opacity-50 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:E?"Verificando...":"Registrarse"})})]}),p.jsxs("p",{className:`text-center text-xs ${e?"text-zinc-500":"text-gray-500"}`,children:["Ya tienes una cuenta?"," ",p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Inicia sesin."})]})]})},CB=({onSwitchToLogin:t,isDarkMode:e})=>{const[n,r]=D.useState(""),[i,s]=D.useState(""),[o,a]=D.useState(""),l=async c=>{c.preventDefault(),a(""),s("");try{await n6(oi,n),s("Revisa tu correo! Se ha enviado un enlace para restablecer tu contrasea.")}catch{a("Error al enviar el correo. Verifica que la direccin sea correcta.")}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:l,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${e?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${e?"text-white":"text-gray-800"}`,children:"RECUPERAR CONTRASEA"}),o&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:o}),i&&p.jsx("p",{className:"bg-green-900/50 text-green-300 text-xs p-3 rounded mb-4",children:i}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"reset-email",children:"Correo Electrnico"}),p.jsxs("div",{className:"relative",children:[p.jsx(dy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"reset-email",type:"email",placeholder:"detective@agencia.com",value:n,onChange:c=>r(c.target.value),required:!0})]})]}),p.jsx("div",{className:"flex flex-col gap-4",children:p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Enviar Enlace"})})]}),p.jsx("p",{className:`text-center text-xs ${e?"text-zinc-500":"text-gray-500"}`,children:p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Volver a Iniciar Sesin"})})]})},AB=()=>{const[t,e]=D.useState("login"),[n,r]=D.useState(!0),i=()=>{switch(t){case"signup":return p.jsx(SB,{onSwitchToLogin:()=>e("login"),isDarkMode:n});case"forgot":return p.jsx(CB,{onSwitchToLogin:()=>e("login"),isDarkMode:n});case"login":default:return p.jsx(IB,{onSwitchToSignUp:()=>e("signup"),onForgotPassword:()=>e("forgot"),isDarkMode:n})}};return p.jsxs("div",{className:`w-screen h-screen flex flex-col items-center justify-center p-4 transition-colors duration-500 ${n?"bg-zinc-900":"bg-gray-100"}`,children:[p.jsx("button",{onClick:()=>r(!n),className:`absolute top-4 right-4 p-2 rounded-full transition-colors ${n?"bg-zinc-800 text-yellow-400 hover:bg-zinc-700":"bg-white text-gray-600 hover:bg-gray-200 shadow-sm"}`,children:n?p.jsx(lS,{size:20}):p.jsx(iS,{size:20})}),p.jsx("h1",{className:`text-5xl font-black font-mono mb-8 tracking-[0.2em] uppercase text-center ${n?"text-zinc-500":"text-zinc-400"}`,children:"DETECTIVE BOARD"}),p.jsx("div",{className:"w-full flex justify-center animate-in fade-in slide-in-from-bottom-8 duration-500",children:i()},t)]})},kB=()=>{const{currentUser:t}=Sv(),e=D.useCallback(async(s,o)=>{if(!(!t||!s))try{console.log(`[NUBE]  Intentando guardar tablero ${s}...`);const a=nm(bd,"users",t.uid,"boards",s),l=JSON.parse(JSON.stringify(o));await KU(a,{...l,updatedAt:t8(),ownerId:t.uid},{merge:!0}),console.log(`[NUBE]  Guardado exitoso. Deberas ver la coleccin 'users' -> '${t.uid}' en Firestore.`)}catch(a){console.error(" ERROR CRTICO al guardar en Firestore (Revisa Reglas o Conexin):",a)}},[t]),n=D.useCallback(async s=>{if(!t||!s)return null;try{console.log(`[NUBE] Descargando tablero ${s}...`);const o=nm(bd,"users",t.uid,"boards",s),a=await qU(o);return a.exists()?a.data():null}catch(o){throw console.error("Error al cargar de Firestore:",o),o}},[t]),r=D.useCallback(async()=>{if(!t)return[];try{console.log("[NUBE] Sincronizando lista de casos...");const s=TU(bd,"users",t.uid,"boards"),o=jU(s);return(await HU(o)).docs.map(l=>({id:l.id,...l.data()}))}catch(s){throw console.error("Error al obtener tableros:",s),s}},[t]),i=D.useCallback(async s=>{t&&await GU(nm(bd,"users",t.uid,"boards",s))},[t]);return{saveBoard:e,loadBoard:n,getBoards:r,deleteBoard:i}},RB=()=>{var Vo,xl,bl;const t=D.useRef(null),{currentUser:e}=Sv(),[n,r]=D.useState(!1),[i,s,o]=xO([]),[a,l,c]=bO([]),[d,h]=D.useState(null),[f,m]=D.useState(!1),[E,x]=D.useState(null),[R,y]=D.useState(null),[v,T]=D.useState(null),[k,O]=D.useState({isOpen:!1,title:"",message:"",onConfirm:null,isDanger:!1}),[z,S]=D.useState(!1),[b,w]=D.useState(!1),[I,C]=D.useState(null),[N,A]=D.useState(null),[P,F]=D.useState(!1),[M,$]=D.useState(null),[j,L]=D.useState(0),[B,G]=D.useState(!1),[U,Y]=D.useState(!1),X=D.useRef(!1),ee=D.useRef(null),{saveBoard:oe,loadBoard:fe,getBoards:ue}=kB(),{connectionColor:_e,setConnectionColor:we,connectionLineType:Ce,setConnectionLineType:Be,isInteractive:Pe,setIsInteractive:Qe,isDarkMode:ge,setIsDarkMode:ft,searchTerm:Ae,setSearchTerm:se,isSidebarOpen:ke,setIsSidebarOpen:kt,isZenMode:Rt,setIsZenMode:ln,bgType:nt,setBgType:xt,toggleBackground:bt}=IL("cork"),{nodeTypes:Oe,edgeTypes:Me,proOptions:Nt,connectionLineStyle:en,nodeColor:Ir}=yL({connectionColor:_e}),{takeSnapshot:Fe,undo:yt,redo:Tn,clearHistory:Sn,onNodesChangeWithHistory:Cn,onEdgesChangeWithHistory:An,animateAndRemoveNode:cn,animateAndRemoveEdge:ir}=_L({nodes:i,edges:a,setNodes:s,setEdges:l,onNodesChange:o,onEdgesChange:c}),{boards:Pt,setBoards:Hn,trash:sr,currentBoardId:Ye,setCurrentBoardId:un,handleSwitchBoard:or,handleCreateBoard:bo,handleDeleteBoard:bi,handleRestoreBoard:Eo,handlePermanentDelete:qr,handleRenameBoard:Io,handleReorderBoards:Et,handleCloneBoard:To}=QM({nodes:i,edges:a,bgType:nt,setNodes:s,setEdges:l,setBgType:xt,reactFlowInstance:d,clearHistory:Sn,setCaseManagerOpen:r,setConfirmModal:O,lastSaved:R});D.useEffect(()=>{(async()=>{if(e){Y(!1);try{const Le=(await ue()).map(Ee=>{var Te,lt;return{...Ee,createdAt:(Te=Ee.createdAt)!=null&&Te.toMillis?Ee.createdAt.toMillis():Ee.createdAt||Date.now(),lastModified:(lt=Ee.updatedAt)!=null&&lt.toMillis?Ee.updatedAt.toMillis():Ee.updatedAt||Date.now()}}).sort((Ee,Te)=>Te.lastModified-Ee.lastModified);Hn(Le),Le.length>0&&(!Ye||!Le.find(Ee=>Ee.id===Ye))?un(Le[0].id):Le.length===0&&console.log("No se encontraron tableros remotos.")}catch(ye){console.error("Error sincronizando tableros:",ye)}finally{Y(!0)}}})()},[e,ue,Hn,un]),D.useEffect(()=>{(async()=>{var ye,Le,Ee;if(U&&Ye){F(!0),$(null),X.current=!1;try{const Te=await fe(Ye);if(Te){s(Te.nodes||[]),l(Te.edges||[]),Te.bgType&&xt(Te.bgType),X.current=!0;const lt=((ye=Pt.find(Dt=>Dt.id===Ye))==null?void 0:ye.name)||"Caso Sin Nombre";ee.current=JSON.stringify({nodes:Te.nodes||[],edges:Te.edges||[],bgType:Te.bgType||"cork",name:lt})}else if(Pt.some(Dt=>Dt.id===Ye)){s([]),l([]),X.current=!0;const Dt=((Le=Pt.find(Kr=>Kr.id===Ye))==null?void 0:Le.name)||"Caso Sin Nombre";ee.current=JSON.stringify({nodes:[],edges:[],bgType:"cork",name:Dt})}else console.warn("ID de tablero obsoleto detectado, omitiendo carga para evitar sobrescritura.")}catch(Te){Te.code==="unavailable"||(Ee=Te.message)!=null&&Ee.includes("offline")?(console.warn("Modo offline: No se pudo sincronizar con la nube, usando cach local si existe."),$("offline")):(console.error("Error cargando tablero:",Te),$("error"))}finally{F(!1)}}})()},[Ye,fe,s,l,xt,U,j]);const Kn=K.useCallback(async(xe=!1)=>{var Te;if(!Ye||!X.current||P||M)return;const ye=((Te=Pt.find(lt=>lt.id===Ye))==null?void 0:Te.name)||"Caso Sin Nombre",Le={nodes:i,edges:a,bgType:nt,name:ye},Ee=JSON.stringify(Le);if(!(!xe&&ee.current===Ee)){G(!0);try{await oe(Ye,Le),ee.current=Ee,y(new Date),console.log("Guardado automtico completado."),G(!1)}catch(lt){console.error("Error al guardar:",lt)}}},[Ye,i,a,nt,Pt,oe,P,M]);D.useEffect(()=>{const xe=setInterval(Kn,3e5);return()=>clearInterval(xe)},[Kn]);const Tr=async xe=>{await Kn(),or(xe)};D.useEffect(()=>{const xe=ye=>{var Te;const Le=((Te=Pt.find(lt=>lt.id===Ye))==null?void 0:Te.name)||"Caso Sin Nombre",Ee=JSON.stringify({nodes:i,edges:a,bgType:nt,name:Le});if(X.current&&ee.current!==Ee)return ye.preventDefault(),ye.returnValue="Tienes cambios sin guardar. Seguro que quieres salir?",ye.returnValue};return window.addEventListener("beforeunload",xe),()=>window.removeEventListener("beforeunload",xe)},[i,a,nt,Ye,Pt]),eM({isInteractive:Pe,reactFlowInstance:d,takeSnapshot:Fe,setNodes:s});const{onConnect:gl,onEdgeContextMenu:yl,onEdgeClick:Sr,onPaneClick:So,onNodeDoubleClick:vl,onNodeDragStart:Ei,onMoveStart:bs,onMoveEnd:Es,selectionRect:kn,handleRightPointerDown:Gn}=xL({isInteractive:Pe,reactFlowInstance:d,reactFlowWrapper:t,setEdges:l,setNodes:s,connectionLineType:Ce,connectionColor:_e,takeSnapshot:Fe,setEditingNode:x,setEditingEdge:C,setInputModalOpen:w,setEditModalOpen:m,setMenu:T});D.useEffect(()=>{const xe=ye=>{ye.key==="Escape"&&Rt&&ln(!1)};return window.addEventListener("keydown",xe),()=>window.removeEventListener("keydown",xe)},[Rt]);const{handleSaveNode:Co,handleDeleteNode:Ao,duplicateSelected:Is,handleConnectionColorChange:Ts,handleConnectionLineTypeChange:ko,handleEdgeDelete:Ss,handleInputModalConfirm:_l}=TL({reactFlowInstance:d,setNodes:s,setEdges:l,takeSnapshot:Fe,animateAndRemoveNode:cn,animateAndRemoveEdge:ir,setEditModalOpen:m,setEditingNode:x,setEditingEdge:C,setInputModalOpen:w,setConnectionColor:we,setConnectionLineType:Be,setPendingStampNodeId:A}),{onDragOver:Ii,onDrop:Ro}=XM({isInteractive:Pe,reactFlowInstance:d,setNodes:s,takeSnapshot:Fe,setPendingStampNodeId:A,setInputModalOpen:w,setEditingEdge:C,setEditingNode:x}),{onSave:Ti,onLoad:Hr,onClear:ar}=bL({reactFlowInstance:d,boards:Pt,currentBoardId:Ye,bgType:nt,setBoards:Hn,setNodes:s,setEdges:l,setBgType:xt,handleSwitchBoard:Tr,clearHistory:Sn,takeSnapshot:Fe,setConfirmModal:O}),{navigateSearch:Cr}=EL({searchTerm:Ae,setNodes:s,reactFlowInstance:d}),No=K.useCallback(()=>{Fe(),s(xe=>{const ye=xe.filter(Ee=>Ee.selected);if(ye.length===0)return xe;const Le=ye.some(Ee=>!Ee.data.locked);return xe.map(Ee=>Ee.selected?{...Ee,data:{...Ee.data,locked:Le},draggable:!Le}:Ee)})},[s,Fe]);D.useEffect(()=>{const xe=ye=>{["INPUT","TEXTAREA","SELECT"].includes(ye.target.tagName)||ye.target.isContentEditable||(ye.ctrlKey||ye.metaKey)&&ye.shiftKey&&ye.key.toLowerCase()==="l"&&(ye.preventDefault(),No())};return window.addEventListener("keydown",xe),()=>window.removeEventListener("keydown",xe)},[No]),D.useEffect(()=>{const xe=i.filter(ye=>ye.selected).map(ye=>ye.id);l(ye=>{let Le=!1;const Ee=ye.map(Te=>{var Kr;const lt=xe.includes(Te.source)||xe.includes(Te.target),Dt=(Kr=Te.className)==null?void 0:Kr.includes("animated-flow");if(lt&&!Dt){Le=!0;const Oo=(Te.className||"").replace("quick-draw","").trim();return{...Te,className:`${Oo} animated-flow`.trim()}}else if(!lt&&Dt)return Le=!0,{...Te,className:(Te.className||"").replace("animated-flow","").trim()};return Te});return Le?Ee:ye})},[i,l]),D.useEffect(()=>{if(a.some(ye=>{var Le;return(Le=ye.className)==null?void 0:Le.includes("quick-draw")})){const ye=setTimeout(()=>{l(Le=>Le.map(Ee=>{var Te;return(Te=Ee.className)!=null&&Te.includes("quick-draw")?{...Ee,className:Ee.className.replace("quick-draw","").trim()}:Ee}))},1e3);return()=>clearTimeout(ye)}},[a,l]);const{isExporting:Po,onExport:Do}=GM({reactFlowWrapper:t,reactFlowInstance:d,boards:Pt,currentBoardId:Ye,bgType:nt,isDarkMode:ge,setNodes:s});YM({onSave:Ti,undo:yt,redo:Tn,duplicateSelected:Is,navigateSearch:Cr,reactFlowInstance:d,edges:a,setEdges:l,takeSnapshot:Fe,connectionLineType:Ce,connectionColor:_e});const Ar=Pt.find(xe=>xe.id===Ye),wl=async()=>{try{await d6(oi)}catch(xe){console.error("Error al cerrar sesin",xe)}};return p.jsx("div",{className:`flex h-screen w-screen transition-colors duration-500 ease-in-out ${ge?"bg-[#1a1a1a]":"bg-gray-50 light-mode"}`,children:p.jsx(wS.Provider,{value:ge,children:p.jsxs(oy,{children:[!Rt&&p.jsx(Uz,{connectionColor:_e,setConnectionColor:Ts,connectionLineType:Ce,setConnectionLineType:ko,lastSaved:R,onSave:Ti,onLoad:Hr,onClear:ar,onHelp:()=>S(!0),isDarkMode:ge,toggleTheme:()=>ft(!ge),searchTerm:Ae,setSearchTerm:se,onExport:Do,isOpen:ke,onToggle:()=>kt(!ke),onOpenCaseManager:()=>r(!0),currentBoardName:Ar==null?void 0:Ar.name,onToggleZen:()=>ln(!0),onNextMatch:()=>Cr("next"),onPrevMatch:()=>Cr("prev"),onToggleBg:bt,onLogout:wl,currentUser:e,isSyncing:P||!U,syncError:M,onRetry:()=>L(xe=>xe+1),onManualSave:()=>Kn(!0)}),p.jsxs("div",{className:"flex-grow h-full relative overflow-hidden",ref:t,style:{"--connection-color":_e},onPointerDown:Gn,onContextMenu:xe=>xe.preventDefault(),children:[p.jsx(Zz,{isZenMode:Rt,setIsZenMode:ln,undo:yt,redo:Tn,isDarkMode:ge}),p.jsxs(qT,{nodes:i,edges:a,onNodesChange:Cn,onEdgesChange:An,onConnect:gl,onInit:h,onDrop:Ro,onDragOver:Ii,onNodeDoubleClick:vl,onEdgeClick:Sr,onEdgeContextMenu:yl,onPaneClick:So,nodeTypes:Oe,edgeTypes:Me,fitView:!0,className:`${nt==="cork"?"cork-pattern":nt==="blackboard"?"blackboard-pattern":"graph-paper-pattern"} ${Pe?"":"board-locked"} ${ge?"":"light-mode"}`,connectionLineType:Ce,connectionLineStyle:en,nodesDraggable:Pe,proOptions:Nt,elevateNodesOnSelect:!1,nodesConnectable:Pe,elementsSelectable:Pe,panOnDrag:Pe,zoomOnScroll:Pe,zoomOnPinch:Pe,panOnScroll:Pe,zoomOnDoubleClick:Pe,onNodeDragStart:Ei,onMoveStart:bs,onMoveEnd:Es,connectionRadius:30,children:[!Rt&&p.jsx(jO,{showInteractive:!0,onInteractiveChange:Qe,fitViewOptions:{duration:800,padding:.2},style:{bottom:"10px",left:"10px",transition:"left 0.2s ease-in-out"}}),!Rt&&p.jsx(PO,{nodeColor:Ir,maskColor:ge?"rgba(0, 0, 0, 0.6)":"rgba(0, 0, 0, 0.1)",className:ge?"bg-zinc-900 border border-zinc-800":"bg-white border border-gray-200 shadow-md"}),p.jsx(HO,{gap:20,size:1,color:ge?"#444":"#aaa",variant:"dots",className:"opacity-20"}),v&&p.jsx(Wz,{onClick:So,...v,onHide:()=>T(null),takeSnapshot:Fe,setNodes:s}),i.length===0&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-10 select-none",children:p.jsxs("div",{className:`text-center ${ge?"opacity-10":"opacity-20"}`,children:[p.jsx("h1",{className:"text-5xl md:text-7xl font-black text-zinc-500 font-mono mb-4 tracking-[0.2em] uppercase",children:"CONFIDENCIAL"}),p.jsx("p",{className:"text-sm text-zinc-500 font-mono uppercase tracking-widest",children:"Arrastra evidencia o haz doble clic"})]})}),p.jsx("svg",{style:{position:"absolute",top:0,left:0,width:0,height:0,pointerEvents:"none"},children:p.jsx("defs",{children:p.jsxs("filter",{id:"yarn-texture",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[p.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.8",numOctaves:"3",result:"noise"}),p.jsx("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"1.5"})]})})})]}),p.jsx("div",{className:"absolute inset-0 pointer-events-none z-[5] bg-[radial-gradient(circle_at_center,transparent_40%,rgba(0,0,0,0.6)_100%)]"}),Po&&p.jsxs("div",{className:"absolute inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center backdrop-blur-sm animate-in fade-in duration-200 cursor-wait",children:[p.jsx("div",{className:"w-16 h-16 border-4 border-red-600 border-t-transparent rounded-full animate-spin mb-4"}),p.jsx("h2",{className:"text-xl font-bold text-white font-mono tracking-widest animate-pulse",children:"REVELANDO EVIDENCIA..."}),p.jsx("p",{className:"text-zinc-400 text-xs font-mono mt-2",children:"Procesando fotografa del tablero completo."})]}),kn&&kn.isDragging&&p.jsx("div",{className:"absolute z-50 pointer-events-none",style:{left:`${kn.x}px`,top:`${kn.y}px`,width:`${kn.width}px`,height:`${kn.height}px`,border:"2px dashed #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)"}}),M&&p.jsx("div",{className:"absolute inset-0 z-[60] bg-black/60 flex items-center justify-center backdrop-blur-sm animate-in fade-in duration-300",children:p.jsxs("div",{className:"bg-zinc-900 p-8 rounded-xl border border-red-500/30 text-center shadow-2xl max-w-md",children:[p.jsx(jz,{size:48,className:"mx-auto text-red-500 mb-4 animate-pulse"}),p.jsx("h2",{className:"text-xl font-bold text-white mb-2 font-mono tracking-wider",children:"CONEXIN INTERRUMPIDA"}),p.jsx("p",{className:"text-zinc-400 mb-6 text-sm",children:M==="offline"?"No se pudo sincronizar con la base de datos. Es posible que un firewall o configuracin de red est bloqueando la conexin.":"Hubo un error crtico al cargar el expediente."}),p.jsxs("button",{onClick:()=>L(xe=>xe+1),className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold uppercase tracking-wider transition-colors flex items-center gap-2 mx-auto shadow-lg",children:[p.jsx(hy,{size:16})," Reintentar Conexin"]})]})})]}),p.jsx(Bz,{isOpen:f,onClose:()=>m(!1),node:E,onSave:Co,onDelete:Ao,isDarkMode:ge}),p.jsx(Qz,{isOpen:k.isOpen,onClose:()=>O(xe=>({...xe,isOpen:!1})),onConfirm:k.onConfirm,title:k.title,message:k.message,isDanger:k.isDanger,confirmText:k.confirmText,cancelText:k.cancelText,isDarkMode:ge}),p.jsx(Yz,{isOpen:z,onClose:()=>S(!1),isDarkMode:ge}),p.jsx(Xz,{isOpen:b,onClose:()=>{w(!1),C(null),x(null),A(null)},onConfirm:(xe,ye,Le)=>_l(xe,ye,Le,I,E,N),onDelete:()=>{N?(Fe(),s(xe=>xe.map(ye=>ye.id===N?{...ye,data:{...ye.data,status:null}}:ye)),w(!1),A(null)):Ss(I,E)},title:I?"EDITAR CONEXIN":N?"CREAR SELLO":"EDITAR ZONA",initialValue:I?I.label||"":N?"":((Vo=E==null?void 0:E.data)==null?void 0:Vo.label)||"",initialColor:I?((xl=I.style)==null?void 0:xl.stroke)||"#dc2626":N?"#dc2626":((bl=E==null?void 0:E.style)==null?void 0:bl.borderColor)||"#71717a",initialType:I==null?void 0:I.type,showTypeSelector:!!I,colorLabel:I?"Color del Hilo":N?"Color del Sello":"Color de Zona",placeholder:N?"Texto del sello (ej: CONFIRMADO)":"Escribe una etiqueta...",isDarkMode:ge}),p.jsx(Jz,{isOpen:n,onClose:()=>r(!1),boards:Pt,currentBoardId:Ye,onSwitch:Tr,onCreate:bo,onDelete:bi,onRename:Io,onClone:To,onReorder:Et,trash:sr,onRestore:Eo,onPermanentDelete:qr,isDarkMode:ge})]})})})},NB=()=>{const{currentUser:t}=Sv();return D.useEffect(()=>{document.title="Detective Board";const e="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%23dc2626%22%20stroke-width%3D%222.5%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Ccircle%20cx%3D%2211%22%20cy%3D%2211%22%20r%3D%228%22%3E%3C%2Fcircle%3E%3Cline%20x1%3D%2221%22%20y1%3D%2221%22%20x2%3D%2216.65%22%20y2%3D%2216.65%22%3E%3C%2Fline%3E%3C%2Fsvg%3E";let n=document.querySelector("link[rel~='icon']");n||(n=document.createElement("link"),n.rel="icon",document.head.appendChild(n)),n.href=e},[]),t&&t.emailVerified?p.jsx(RB,{}):p.jsx(AB,{})};om.createRoot(document.getElementById("root")).render(p.jsx(K.StrictMode,{children:p.jsx(EB,{children:p.jsx(NB,{})})}));
