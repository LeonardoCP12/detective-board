(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function M1(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var j1={exports:{}},Uh={},F1={exports:{}},be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xc=Symbol.for("react.element"),$A=Symbol.for("react.portal"),UA=Symbol.for("react.fragment"),BA=Symbol.for("react.strict_mode"),HA=Symbol.for("react.profiler"),qA=Symbol.for("react.provider"),KA=Symbol.for("react.context"),GA=Symbol.for("react.forward_ref"),WA=Symbol.for("react.suspense"),QA=Symbol.for("react.memo"),YA=Symbol.for("react.lazy"),Dv=Symbol.iterator;function XA(t){return t===null||typeof t!="object"?null:(t=Dv&&t[Dv]||t["@@iterator"],typeof t=="function"?t:null)}var $1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U1=Object.assign,B1={};function Ba(t,e,n){this.props=t,this.context=e,this.refs=B1,this.updater=n||$1}Ba.prototype.isReactComponent={};Ba.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ba.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function H1(){}H1.prototype=Ba.prototype;function Pg(t,e,n){this.props=t,this.context=e,this.refs=B1,this.updater=n||$1}var Ng=Pg.prototype=new H1;Ng.constructor=Pg;U1(Ng,Ba.prototype);Ng.isPureReactComponent=!0;var Vv=Array.isArray,q1=Object.prototype.hasOwnProperty,Dg={current:null},K1={key:!0,ref:!0,__self:!0,__source:!0};function G1(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)q1.call(e,r)&&!K1.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Xc,type:t,key:s,ref:o,props:i,_owner:Dg.current}}function JA(t,e){return{$$typeof:Xc,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Vg(t){return typeof t=="object"&&t!==null&&t.$$typeof===Xc}function ZA(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ov=/\/+/g;function Uf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?ZA(""+t.key):e.toString(36)}function ud(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Xc:case $A:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Uf(o,0):r,Vv(i)?(n="",t!=null&&(n=t.replace(Ov,"$&/")+"/"),ud(i,e,n,"",function(c){return c})):i!=null&&(Vg(i)&&(i=JA(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Ov,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Vv(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Uf(s,a);o+=ud(s,e,n,l,i)}else if(l=XA(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Uf(s,a++),o+=ud(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Au(t,e,n){if(t==null)return t;var r=[],i=0;return ud(t,r,"","",function(s){return e.call(n,s,i++)}),r}function ek(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var rn={current:null},dd={transition:null},tk={ReactCurrentDispatcher:rn,ReactCurrentBatchConfig:dd,ReactCurrentOwner:Dg};function W1(){throw Error("act(...) is not supported in production builds of React.")}be.Children={map:Au,forEach:function(t,e,n){Au(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Au(t,function(){e++}),e},toArray:function(t){return Au(t,function(e){return e})||[]},only:function(t){if(!Vg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};be.Component=Ba;be.Fragment=UA;be.Profiler=HA;be.PureComponent=Pg;be.StrictMode=BA;be.Suspense=WA;be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tk;be.act=W1;be.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=U1({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Dg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)q1.call(e,l)&&!K1.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Xc,type:t.type,key:i,ref:s,props:r,_owner:o}};be.createContext=function(t){return t={$$typeof:KA,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:qA,_context:t},t.Consumer=t};be.createElement=G1;be.createFactory=function(t){var e=G1.bind(null,t);return e.type=t,e};be.createRef=function(){return{current:null}};be.forwardRef=function(t){return{$$typeof:GA,render:t}};be.isValidElement=Vg;be.lazy=function(t){return{$$typeof:YA,_payload:{_status:-1,_result:t},_init:ek}};be.memo=function(t,e){return{$$typeof:QA,type:t,compare:e===void 0?null:e}};be.startTransition=function(t){var e=dd.transition;dd.transition={};try{t()}finally{dd.transition=e}};be.unstable_act=W1;be.useCallback=function(t,e){return rn.current.useCallback(t,e)};be.useContext=function(t){return rn.current.useContext(t)};be.useDebugValue=function(){};be.useDeferredValue=function(t){return rn.current.useDeferredValue(t)};be.useEffect=function(t,e){return rn.current.useEffect(t,e)};be.useId=function(){return rn.current.useId()};be.useImperativeHandle=function(t,e,n){return rn.current.useImperativeHandle(t,e,n)};be.useInsertionEffect=function(t,e){return rn.current.useInsertionEffect(t,e)};be.useLayoutEffect=function(t,e){return rn.current.useLayoutEffect(t,e)};be.useMemo=function(t,e){return rn.current.useMemo(t,e)};be.useReducer=function(t,e,n){return rn.current.useReducer(t,e,n)};be.useRef=function(t){return rn.current.useRef(t)};be.useState=function(t){return rn.current.useState(t)};be.useSyncExternalStore=function(t,e,n){return rn.current.useSyncExternalStore(t,e,n)};be.useTransition=function(){return rn.current.useTransition()};be.version="18.3.1";F1.exports=be;var D=F1.exports;const K=M1(D);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nk=D,rk=Symbol.for("react.element"),ik=Symbol.for("react.fragment"),sk=Object.prototype.hasOwnProperty,ok=nk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ak={key:!0,ref:!0,__self:!0,__source:!0};function Q1(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)sk.call(e,r)&&!ak.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:rk,type:t,key:s,ref:o,props:i,_owner:ok.current}}Uh.Fragment=ik;Uh.jsx=Q1;Uh.jsxs=Q1;j1.exports=Uh;var p=j1.exports,Hp={},Y1={exports:{}},Ln={},X1={exports:{}},J1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,M){var U=F.length;F.push(M);e:for(;0<U;){var G=U-1>>>1,$=F[G];if(0<i($,M))F[G]=M,F[U]=$,U=G;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var M=F[0],U=F.pop();if(U!==M){F[0]=U;e:for(var G=0,$=F.length,X=$>>>1;G<X;){var Y=2*(G+1)-1,ee=F[Y],ne=Y+1,fe=F[ne];if(0>i(ee,U))ne<$&&0>i(fe,ee)?(F[G]=fe,F[ne]=U,G=ne):(F[G]=ee,F[Y]=U,G=Y);else if(ne<$&&0>i(fe,U))F[G]=fe,F[ne]=U,G=ne;else break e}}return M}function i(F,M){var U=F.sortIndex-M.sortIndex;return U!==0?U:F.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,h=null,f=3,m=!1,b=!1,x=!1,R=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(F){for(var M=n(c);M!==null;){if(M.callback===null)r(c);else if(M.startTime<=F)r(c),M.sortIndex=M.expirationTime,e(l,M);else break;M=n(c)}}function A(F){if(x=!1,T(F),!b)if(n(l)!==null)b=!0,z(O);else{var M=n(c);M!==null&&B(A,M.startTime-F)}}function O(F,M){b=!1,x&&(x=!1,y(I),I=-1),m=!0;var U=f;try{for(T(M),h=n(l);h!==null&&(!(h.expirationTime>M)||F&&!C());){var G=h.callback;if(typeof G=="function"){h.callback=null,f=h.priorityLevel;var $=G(h.expirationTime<=M);M=t.unstable_now(),typeof $=="function"?h.callback=$:h===n(l)&&r(l),T(M)}else r(l);h=n(l)}if(h!==null)var X=!0;else{var Y=n(c);Y!==null&&B(A,Y.startTime-M),X=!1}return X}finally{h=null,f=U,m=!1}}var L=!1,S=null,I=-1,w=5,E=-1;function C(){return!(t.unstable_now()-E<w)}function P(){if(S!==null){var F=t.unstable_now();E=F;var M=!0;try{M=S(!0,F)}finally{M?k():(L=!1,S=null)}}else L=!1}var k;if(typeof v=="function")k=function(){v(P)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,j=N.port2;N.port1.onmessage=P,k=function(){j.postMessage(null)}}else k=function(){R(P,0)};function z(F){S=F,L||(L=!0,k())}function B(F,M){I=R(function(){F(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){b||m||(b=!0,z(O))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(f){case 1:case 2:case 3:var M=3;break;default:M=f}var U=f;f=M;try{return F()}finally{f=U}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,M){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var U=f;f=F;try{return M()}finally{f=U}},t.unstable_scheduleCallback=function(F,M,U){var G=t.unstable_now();switch(typeof U=="object"&&U!==null?(U=U.delay,U=typeof U=="number"&&0<U?G+U:G):U=G,F){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=U+$,F={id:d++,callback:M,priorityLevel:F,startTime:U,expirationTime:$,sortIndex:-1},U>G?(F.sortIndex=U,e(c,F),n(l)===null&&F===n(c)&&(x?(y(I),I=-1):x=!0,B(A,U-G))):(F.sortIndex=$,e(l,F),b||m||(b=!0,z(O))),F},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(F){var M=f;return function(){var U=f;f=M;try{return F.apply(this,arguments)}finally{f=U}}}})(J1);X1.exports=J1;var lk=X1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ck=D,Vn=lk;function Z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Z1=new Set,hc={};function mo(t,e){wa(t,e),wa(t+"Capture",e)}function wa(t,e){for(hc[t]=e,t=0;t<e.length;t++)Z1.add(e[t])}var ai=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),qp=Object.prototype.hasOwnProperty,uk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zv={},Lv={};function dk(t){return qp.call(Lv,t)?!0:qp.call(zv,t)?!1:uk.test(t)?Lv[t]=!0:(zv[t]=!0,!1)}function hk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function fk(t,e,n,r){if(e===null||typeof e>"u"||hk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function sn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var $t={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){$t[t]=new sn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];$t[e]=new sn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){$t[t]=new sn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){$t[t]=new sn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){$t[t]=new sn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){$t[t]=new sn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){$t[t]=new sn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){$t[t]=new sn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){$t[t]=new sn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Og=/[\-:]([a-z])/g;function zg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Og,zg);$t[e]=new sn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Og,zg);$t[e]=new sn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Og,zg);$t[e]=new sn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){$t[t]=new sn(t,1,!1,t.toLowerCase(),null,!1,!1)});$t.xlinkHref=new sn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){$t[t]=new sn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Lg(t,e,n,r){var i=$t.hasOwnProperty(e)?$t[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(fk(e,n,i,r)&&(n=null),r||i===null?dk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var yi=ck.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ku=Symbol.for("react.element"),Go=Symbol.for("react.portal"),Wo=Symbol.for("react.fragment"),Mg=Symbol.for("react.strict_mode"),Kp=Symbol.for("react.profiler"),eE=Symbol.for("react.provider"),tE=Symbol.for("react.context"),jg=Symbol.for("react.forward_ref"),Gp=Symbol.for("react.suspense"),Wp=Symbol.for("react.suspense_list"),Fg=Symbol.for("react.memo"),Di=Symbol.for("react.lazy"),nE=Symbol.for("react.offscreen"),Mv=Symbol.iterator;function yl(t){return t===null||typeof t!="object"?null:(t=Mv&&t[Mv]||t["@@iterator"],typeof t=="function"?t:null)}var it=Object.assign,Bf;function Ol(t){if(Bf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bf=e&&e[1]||""}return`
`+Bf+t}var Hf=!1;function qf(t,e){if(!t||Hf)return"";Hf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Hf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Ol(t):""}function pk(t){switch(t.tag){case 5:return Ol(t.type);case 16:return Ol("Lazy");case 13:return Ol("Suspense");case 19:return Ol("SuspenseList");case 0:case 2:case 15:return t=qf(t.type,!1),t;case 11:return t=qf(t.type.render,!1),t;case 1:return t=qf(t.type,!0),t;default:return""}}function Qp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wo:return"Fragment";case Go:return"Portal";case Kp:return"Profiler";case Mg:return"StrictMode";case Gp:return"Suspense";case Wp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case tE:return(t.displayName||"Context")+".Consumer";case eE:return(t._context.displayName||"Context")+".Provider";case jg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Fg:return e=t.displayName||null,e!==null?e:Qp(t.type)||"Memo";case Di:e=t._payload,t=t._init;try{return Qp(t(e))}catch{}}return null}function mk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qp(e);case 8:return e===Mg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function as(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function rE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function gk(t){var e=rE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Ru(t){t._valueTracker||(t._valueTracker=gk(t))}function iE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=rE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function jd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yp(t,e){var n=e.checked;return it({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function jv(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=as(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function sE(t,e){e=e.checked,e!=null&&Lg(t,"checked",e,!1)}function Xp(t,e){sE(t,e);var n=as(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Jp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Jp(t,e.type,as(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Fv(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Jp(t,e,n){(e!=="number"||jd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var zl=Array.isArray;function oa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+as(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Zp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Z(91));return it({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function $v(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Z(92));if(zl(n)){if(1<n.length)throw Error(Z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:as(n)}}function oE(t,e){var n=as(e.value),r=as(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Uv(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function aE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function em(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?aE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Pu,lE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Pu=Pu||document.createElement("div"),Pu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Pu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function fc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Yl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yk=["Webkit","ms","Moz","O"];Object.keys(Yl).forEach(function(t){yk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Yl[e]=Yl[t]})});function cE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Yl.hasOwnProperty(t)&&Yl[t]?(""+e).trim():e+"px"}function uE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=cE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var vk=it({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function tm(t,e){if(e){if(vk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Z(62))}}function nm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rm=null;function $g(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var im=null,aa=null,la=null;function Bv(t){if(t=eu(t)){if(typeof im!="function")throw Error(Z(280));var e=t.stateNode;e&&(e=Gh(e),im(t.stateNode,t.type,e))}}function dE(t){aa?la?la.push(t):la=[t]:aa=t}function hE(){if(aa){var t=aa,e=la;if(la=aa=null,Bv(t),e)for(t=0;t<e.length;t++)Bv(e[t])}}function fE(t,e){return t(e)}function pE(){}var Kf=!1;function mE(t,e,n){if(Kf)return t(e,n);Kf=!0;try{return fE(t,e,n)}finally{Kf=!1,(aa!==null||la!==null)&&(pE(),hE())}}function pc(t,e){var n=t.stateNode;if(n===null)return null;var r=Gh(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Z(231,e,typeof n));return n}var sm=!1;if(ai)try{var vl={};Object.defineProperty(vl,"passive",{get:function(){sm=!0}}),window.addEventListener("test",vl,vl),window.removeEventListener("test",vl,vl)}catch{sm=!1}function _k(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Xl=!1,Fd=null,$d=!1,om=null,wk={onError:function(t){Xl=!0,Fd=t}};function xk(t,e,n,r,i,s,o,a,l){Xl=!1,Fd=null,_k.apply(wk,arguments)}function Ek(t,e,n,r,i,s,o,a,l){if(xk.apply(this,arguments),Xl){if(Xl){var c=Fd;Xl=!1,Fd=null}else throw Error(Z(198));$d||($d=!0,om=c)}}function go(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function gE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Hv(t){if(go(t)!==t)throw Error(Z(188))}function bk(t){var e=t.alternate;if(!e){if(e=go(t),e===null)throw Error(Z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Hv(i),t;if(s===r)return Hv(i),e;s=s.sibling}throw Error(Z(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?t:e}function yE(t){return t=bk(t),t!==null?vE(t):null}function vE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=vE(t);if(e!==null)return e;t=t.sibling}return null}var _E=Vn.unstable_scheduleCallback,qv=Vn.unstable_cancelCallback,Ik=Vn.unstable_shouldYield,Tk=Vn.unstable_requestPaint,ft=Vn.unstable_now,Sk=Vn.unstable_getCurrentPriorityLevel,Ug=Vn.unstable_ImmediatePriority,wE=Vn.unstable_UserBlockingPriority,Ud=Vn.unstable_NormalPriority,Ck=Vn.unstable_LowPriority,xE=Vn.unstable_IdlePriority,Bh=null,Sr=null;function Ak(t){if(Sr&&typeof Sr.onCommitFiberRoot=="function")try{Sr.onCommitFiberRoot(Bh,t,void 0,(t.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:Pk,kk=Math.log,Rk=Math.LN2;function Pk(t){return t>>>=0,t===0?32:31-(kk(t)/Rk|0)|0}var Nu=64,Du=4194304;function Ll(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Bd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Ll(a):(s&=o,s!==0&&(r=Ll(s)))}else o=n&~i,o!==0?r=Ll(o):s!==0&&(r=Ll(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ur(e),i=1<<n,r|=t[n],e&=~i;return r}function Nk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Dk(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-ur(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=Nk(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function am(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function EE(){var t=Nu;return Nu<<=1,!(Nu&4194240)&&(Nu=64),t}function Gf(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Jc(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ur(e),t[e]=n}function Vk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ur(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function Bg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ur(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var Fe=0;function bE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var IE,Hg,TE,SE,CE,lm=!1,Vu=[],Gi=null,Wi=null,Qi=null,mc=new Map,gc=new Map,Li=[],Ok="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Kv(t,e){switch(t){case"focusin":case"focusout":Gi=null;break;case"dragenter":case"dragleave":Wi=null;break;case"mouseover":case"mouseout":Qi=null;break;case"pointerover":case"pointerout":mc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":gc.delete(e.pointerId)}}function _l(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=eu(e),e!==null&&Hg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function zk(t,e,n,r,i){switch(e){case"focusin":return Gi=_l(Gi,t,e,n,r,i),!0;case"dragenter":return Wi=_l(Wi,t,e,n,r,i),!0;case"mouseover":return Qi=_l(Qi,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return mc.set(s,_l(mc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,gc.set(s,_l(gc.get(s)||null,t,e,n,r,i)),!0}return!1}function AE(t){var e=zs(t.target);if(e!==null){var n=go(e);if(n!==null){if(e=n.tag,e===13){if(e=gE(n),e!==null){t.blockedOn=e,CE(t.priority,function(){TE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function hd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=cm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);rm=r,n.target.dispatchEvent(r),rm=null}else return e=eu(n),e!==null&&Hg(e),t.blockedOn=n,!1;e.shift()}return!0}function Gv(t,e,n){hd(t)&&n.delete(e)}function Lk(){lm=!1,Gi!==null&&hd(Gi)&&(Gi=null),Wi!==null&&hd(Wi)&&(Wi=null),Qi!==null&&hd(Qi)&&(Qi=null),mc.forEach(Gv),gc.forEach(Gv)}function wl(t,e){t.blockedOn===e&&(t.blockedOn=null,lm||(lm=!0,Vn.unstable_scheduleCallback(Vn.unstable_NormalPriority,Lk)))}function yc(t){function e(i){return wl(i,t)}if(0<Vu.length){wl(Vu[0],t);for(var n=1;n<Vu.length;n++){var r=Vu[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Gi!==null&&wl(Gi,t),Wi!==null&&wl(Wi,t),Qi!==null&&wl(Qi,t),mc.forEach(e),gc.forEach(e),n=0;n<Li.length;n++)r=Li[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Li.length&&(n=Li[0],n.blockedOn===null);)AE(n),n.blockedOn===null&&Li.shift()}var ca=yi.ReactCurrentBatchConfig,Hd=!0;function Mk(t,e,n,r){var i=Fe,s=ca.transition;ca.transition=null;try{Fe=1,qg(t,e,n,r)}finally{Fe=i,ca.transition=s}}function jk(t,e,n,r){var i=Fe,s=ca.transition;ca.transition=null;try{Fe=4,qg(t,e,n,r)}finally{Fe=i,ca.transition=s}}function qg(t,e,n,r){if(Hd){var i=cm(t,e,n,r);if(i===null)rp(t,e,r,qd,n),Kv(t,r);else if(zk(i,t,e,n,r))r.stopPropagation();else if(Kv(t,r),e&4&&-1<Ok.indexOf(t)){for(;i!==null;){var s=eu(i);if(s!==null&&IE(s),s=cm(t,e,n,r),s===null&&rp(t,e,r,qd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else rp(t,e,r,null,n)}}var qd=null;function cm(t,e,n,r){if(qd=null,t=$g(r),t=zs(t),t!==null)if(e=go(t),e===null)t=null;else if(n=e.tag,n===13){if(t=gE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return qd=t,null}function kE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Sk()){case Ug:return 1;case wE:return 4;case Ud:case Ck:return 16;case xE:return 536870912;default:return 16}default:return 16}}var Hi=null,Kg=null,fd=null;function RE(){if(fd)return fd;var t,e=Kg,n=e.length,r,i="value"in Hi?Hi.value:Hi.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return fd=i.slice(t,1<r?1-r:void 0)}function pd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ou(){return!0}function Wv(){return!1}function Mn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Ou:Wv,this.isPropagationStopped=Wv,this}return it(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ou)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ou)},persist:function(){},isPersistent:Ou}),e}var Ha={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Gg=Mn(Ha),Zc=it({},Ha,{view:0,detail:0}),Fk=Mn(Zc),Wf,Qf,xl,Hh=it({},Zc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Wg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==xl&&(xl&&t.type==="mousemove"?(Wf=t.screenX-xl.screenX,Qf=t.screenY-xl.screenY):Qf=Wf=0,xl=t),Wf)},movementY:function(t){return"movementY"in t?t.movementY:Qf}}),Qv=Mn(Hh),$k=it({},Hh,{dataTransfer:0}),Uk=Mn($k),Bk=it({},Zc,{relatedTarget:0}),Yf=Mn(Bk),Hk=it({},Ha,{animationName:0,elapsedTime:0,pseudoElement:0}),qk=Mn(Hk),Kk=it({},Ha,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Gk=Mn(Kk),Wk=it({},Ha,{data:0}),Yv=Mn(Wk),Qk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Jk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=Xk[t])?!!e[t]:!1}function Wg(){return Jk}var Zk=it({},Zc,{key:function(t){if(t.key){var e=Qk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=pd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?Yk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Wg,charCode:function(t){return t.type==="keypress"?pd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?pd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),eR=Mn(Zk),tR=it({},Hh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xv=Mn(tR),nR=it({},Zc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Wg}),rR=Mn(nR),iR=it({},Ha,{propertyName:0,elapsedTime:0,pseudoElement:0}),sR=Mn(iR),oR=it({},Hh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),aR=Mn(oR),lR=[9,13,27,32],Qg=ai&&"CompositionEvent"in window,Jl=null;ai&&"documentMode"in document&&(Jl=document.documentMode);var cR=ai&&"TextEvent"in window&&!Jl,PE=ai&&(!Qg||Jl&&8<Jl&&11>=Jl),Jv=" ",Zv=!1;function NE(t,e){switch(t){case"keyup":return lR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function DE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Qo=!1;function uR(t,e){switch(t){case"compositionend":return DE(e);case"keypress":return e.which!==32?null:(Zv=!0,Jv);case"textInput":return t=e.data,t===Jv&&Zv?null:t;default:return null}}function dR(t,e){if(Qo)return t==="compositionend"||!Qg&&NE(t,e)?(t=RE(),fd=Kg=Hi=null,Qo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return PE&&e.locale!=="ko"?null:e.data;default:return null}}var hR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function e_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!hR[t.type]:e==="textarea"}function VE(t,e,n,r){dE(r),e=Kd(e,"onChange"),0<e.length&&(n=new Gg("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Zl=null,vc=null;function fR(t){qE(t,0)}function qh(t){var e=Jo(t);if(iE(e))return t}function pR(t,e){if(t==="change")return e}var OE=!1;if(ai){var Xf;if(ai){var Jf="oninput"in document;if(!Jf){var t_=document.createElement("div");t_.setAttribute("oninput","return;"),Jf=typeof t_.oninput=="function"}Xf=Jf}else Xf=!1;OE=Xf&&(!document.documentMode||9<document.documentMode)}function n_(){Zl&&(Zl.detachEvent("onpropertychange",zE),vc=Zl=null)}function zE(t){if(t.propertyName==="value"&&qh(vc)){var e=[];VE(e,vc,t,$g(t)),mE(fR,e)}}function mR(t,e,n){t==="focusin"?(n_(),Zl=e,vc=n,Zl.attachEvent("onpropertychange",zE)):t==="focusout"&&n_()}function gR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qh(vc)}function yR(t,e){if(t==="click")return qh(e)}function vR(t,e){if(t==="input"||t==="change")return qh(e)}function _R(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pr=typeof Object.is=="function"?Object.is:_R;function _c(t,e){if(pr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!qp.call(e,i)||!pr(t[i],e[i]))return!1}return!0}function r_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function i_(t,e){var n=r_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=r_(n)}}function LE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?LE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function ME(){for(var t=window,e=jd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=jd(t.document)}return e}function Yg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function wR(t){var e=ME(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&LE(n.ownerDocument.documentElement,n)){if(r!==null&&Yg(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=i_(n,s);var o=i_(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var xR=ai&&"documentMode"in document&&11>=document.documentMode,Yo=null,um=null,ec=null,dm=!1;function s_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;dm||Yo==null||Yo!==jd(r)||(r=Yo,"selectionStart"in r&&Yg(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ec&&_c(ec,r)||(ec=r,r=Kd(um,"onSelect"),0<r.length&&(e=new Gg("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Yo)))}function zu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Xo={animationend:zu("Animation","AnimationEnd"),animationiteration:zu("Animation","AnimationIteration"),animationstart:zu("Animation","AnimationStart"),transitionend:zu("Transition","TransitionEnd")},Zf={},jE={};ai&&(jE=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function Kh(t){if(Zf[t])return Zf[t];if(!Xo[t])return t;var e=Xo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in jE)return Zf[t]=e[n];return t}var FE=Kh("animationend"),$E=Kh("animationiteration"),UE=Kh("animationstart"),BE=Kh("transitionend"),HE=new Map,o_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(t,e){HE.set(t,e),mo(e,[t])}for(var ep=0;ep<o_.length;ep++){var tp=o_[ep],ER=tp.toLowerCase(),bR=tp[0].toUpperCase()+tp.slice(1);fs(ER,"on"+bR)}fs(FE,"onAnimationEnd");fs($E,"onAnimationIteration");fs(UE,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(BE,"onTransitionEnd");wa("onMouseEnter",["mouseout","mouseover"]);wa("onMouseLeave",["mouseout","mouseover"]);wa("onPointerEnter",["pointerout","pointerover"]);wa("onPointerLeave",["pointerout","pointerover"]);mo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));mo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));mo("onBeforeInput",["compositionend","keypress","textInput","paste"]);mo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));mo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));mo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),IR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ml));function a_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Ek(r,e,void 0,t),t.currentTarget=null}function qE(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;a_(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;a_(i,a,c),s=l}}}if($d)throw t=om,$d=!1,om=null,t}function We(t,e){var n=e[gm];n===void 0&&(n=e[gm]=new Set);var r=t+"__bubble";n.has(r)||(KE(e,t,2,!1),n.add(r))}function np(t,e,n){var r=0;e&&(r|=4),KE(n,t,r,e)}var Lu="_reactListening"+Math.random().toString(36).slice(2);function wc(t){if(!t[Lu]){t[Lu]=!0,Z1.forEach(function(n){n!=="selectionchange"&&(IR.has(n)||np(n,!1,t),np(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Lu]||(e[Lu]=!0,np("selectionchange",!1,e))}}function KE(t,e,n,r){switch(kE(e)){case 1:var i=Mk;break;case 4:i=jk;break;default:i=qg}n=i.bind(null,e,n,t),i=void 0,!sm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function rp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=zs(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}mE(function(){var c=s,d=$g(n),h=[];e:{var f=HE.get(t);if(f!==void 0){var m=Gg,b=t;switch(t){case"keypress":if(pd(n)===0)break e;case"keydown":case"keyup":m=eR;break;case"focusin":b="focus",m=Yf;break;case"focusout":b="blur",m=Yf;break;case"beforeblur":case"afterblur":m=Yf;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Qv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=Uk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=rR;break;case FE:case $E:case UE:m=qk;break;case BE:m=sR;break;case"scroll":m=Fk;break;case"wheel":m=aR;break;case"copy":case"cut":case"paste":m=Gk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=Xv}var x=(e&4)!==0,R=!x&&t==="scroll",y=x?f!==null?f+"Capture":null:f;x=[];for(var v=c,T;v!==null;){T=v;var A=T.stateNode;if(T.tag===5&&A!==null&&(T=A,y!==null&&(A=pc(v,y),A!=null&&x.push(xc(v,A,T)))),R)break;v=v.return}0<x.length&&(f=new m(f,b,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==rm&&(b=n.relatedTarget||n.fromElement)&&(zs(b)||b[li]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(b=n.relatedTarget||n.toElement,m=c,b=b?zs(b):null,b!==null&&(R=go(b),b!==R||b.tag!==5&&b.tag!==6)&&(b=null)):(m=null,b=c),m!==b)){if(x=Qv,A="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(x=Xv,A="onPointerLeave",y="onPointerEnter",v="pointer"),R=m==null?f:Jo(m),T=b==null?f:Jo(b),f=new x(A,v+"leave",m,n,d),f.target=R,f.relatedTarget=T,A=null,zs(d)===c&&(x=new x(y,v+"enter",b,n,d),x.target=T,x.relatedTarget=R,A=x),R=A,m&&b)t:{for(x=m,y=b,v=0,T=x;T;T=Ro(T))v++;for(T=0,A=y;A;A=Ro(A))T++;for(;0<v-T;)x=Ro(x),v--;for(;0<T-v;)y=Ro(y),T--;for(;v--;){if(x===y||y!==null&&x===y.alternate)break t;x=Ro(x),y=Ro(y)}x=null}else x=null;m!==null&&l_(h,f,m,x,!1),b!==null&&R!==null&&l_(h,R,b,x,!0)}}e:{if(f=c?Jo(c):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var O=pR;else if(e_(f))if(OE)O=vR;else{O=gR;var L=mR}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=yR);if(O&&(O=O(t,c))){VE(h,O,n,d);break e}L&&L(t,f,c),t==="focusout"&&(L=f._wrapperState)&&L.controlled&&f.type==="number"&&Jp(f,"number",f.value)}switch(L=c?Jo(c):window,t){case"focusin":(e_(L)||L.contentEditable==="true")&&(Yo=L,um=c,ec=null);break;case"focusout":ec=um=Yo=null;break;case"mousedown":dm=!0;break;case"contextmenu":case"mouseup":case"dragend":dm=!1,s_(h,n,d);break;case"selectionchange":if(xR)break;case"keydown":case"keyup":s_(h,n,d)}var S;if(Qg)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Qo?NE(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(PE&&n.locale!=="ko"&&(Qo||I!=="onCompositionStart"?I==="onCompositionEnd"&&Qo&&(S=RE()):(Hi=d,Kg="value"in Hi?Hi.value:Hi.textContent,Qo=!0)),L=Kd(c,I),0<L.length&&(I=new Yv(I,t,null,n,d),h.push({event:I,listeners:L}),S?I.data=S:(S=DE(n),S!==null&&(I.data=S)))),(S=cR?uR(t,n):dR(t,n))&&(c=Kd(c,"onBeforeInput"),0<c.length&&(d=new Yv("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=S))}qE(h,e)})}function xc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Kd(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=pc(t,n),s!=null&&r.unshift(xc(t,s,i)),s=pc(t,e),s!=null&&r.push(xc(t,s,i))),t=t.return}return r}function Ro(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function l_(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=pc(n,s),l!=null&&o.unshift(xc(n,l,a))):i||(l=pc(n,s),l!=null&&o.push(xc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var TR=/\r\n?/g,SR=/\u0000|\uFFFD/g;function c_(t){return(typeof t=="string"?t:""+t).replace(TR,`
`).replace(SR,"")}function Mu(t,e,n){if(e=c_(e),c_(t)!==e&&n)throw Error(Z(425))}function Gd(){}var hm=null,fm=null;function pm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var mm=typeof setTimeout=="function"?setTimeout:void 0,CR=typeof clearTimeout=="function"?clearTimeout:void 0,u_=typeof Promise=="function"?Promise:void 0,AR=typeof queueMicrotask=="function"?queueMicrotask:typeof u_<"u"?function(t){return u_.resolve(null).then(t).catch(kR)}:mm;function kR(t){setTimeout(function(){throw t})}function ip(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),yc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);yc(e)}function Yi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function d_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var qa=Math.random().toString(36).slice(2),br="__reactFiber$"+qa,Ec="__reactProps$"+qa,li="__reactContainer$"+qa,gm="__reactEvents$"+qa,RR="__reactListeners$"+qa,PR="__reactHandles$"+qa;function zs(t){var e=t[br];if(e)return e;for(var n=t.parentNode;n;){if(e=n[li]||n[br]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=d_(t);t!==null;){if(n=t[br])return n;t=d_(t)}return e}t=n,n=t.parentNode}return null}function eu(t){return t=t[br]||t[li],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Jo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Z(33))}function Gh(t){return t[Ec]||null}var ym=[],Zo=-1;function ps(t){return{current:t}}function Qe(t){0>Zo||(t.current=ym[Zo],ym[Zo]=null,Zo--)}function Ke(t,e){Zo++,ym[Zo]=t.current,t.current=e}var ls={},Qt=ps(ls),pn=ps(!1),Qs=ls;function xa(t,e){var n=t.type.contextTypes;if(!n)return ls;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function mn(t){return t=t.childContextTypes,t!=null}function Wd(){Qe(pn),Qe(Qt)}function h_(t,e,n){if(Qt.current!==ls)throw Error(Z(168));Ke(Qt,e),Ke(pn,n)}function GE(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Z(108,mk(t)||"Unknown",i));return it({},n,r)}function Qd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ls,Qs=Qt.current,Ke(Qt,t),Ke(pn,pn.current),!0}function f_(t,e,n){var r=t.stateNode;if(!r)throw Error(Z(169));n?(t=GE(t,e,Qs),r.__reactInternalMemoizedMergedChildContext=t,Qe(pn),Qe(Qt),Ke(Qt,t)):Qe(pn),Ke(pn,n)}var Qr=null,Wh=!1,sp=!1;function WE(t){Qr===null?Qr=[t]:Qr.push(t)}function NR(t){Wh=!0,WE(t)}function ms(){if(!sp&&Qr!==null){sp=!0;var t=0,e=Fe;try{var n=Qr;for(Fe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Qr=null,Wh=!1}catch(i){throw Qr!==null&&(Qr=Qr.slice(t+1)),_E(Ug,ms),i}finally{Fe=e,sp=!1}}return null}var ea=[],ta=0,Yd=null,Xd=0,Fn=[],$n=0,Ys=null,Xr=1,Jr="";function Cs(t,e){ea[ta++]=Xd,ea[ta++]=Yd,Yd=t,Xd=e}function QE(t,e,n){Fn[$n++]=Xr,Fn[$n++]=Jr,Fn[$n++]=Ys,Ys=t;var r=Xr;t=Jr;var i=32-ur(r)-1;r&=~(1<<i),n+=1;var s=32-ur(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xr=1<<32-ur(e)+i|n<<i|r,Jr=s+t}else Xr=1<<s|n<<i|r,Jr=t}function Xg(t){t.return!==null&&(Cs(t,1),QE(t,1,0))}function Jg(t){for(;t===Yd;)Yd=ea[--ta],ea[ta]=null,Xd=ea[--ta],ea[ta]=null;for(;t===Ys;)Ys=Fn[--$n],Fn[$n]=null,Jr=Fn[--$n],Fn[$n]=null,Xr=Fn[--$n],Fn[$n]=null}var Nn=null,Rn=null,Je=!1,ar=null;function YE(t,e){var n=Un(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function p_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Nn=t,Rn=Yi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Nn=t,Rn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ys!==null?{id:Xr,overflow:Jr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Un(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Nn=t,Rn=null,!0):!1;default:return!1}}function vm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function _m(t){if(Je){var e=Rn;if(e){var n=e;if(!p_(t,e)){if(vm(t))throw Error(Z(418));e=Yi(n.nextSibling);var r=Nn;e&&p_(t,e)?YE(r,n):(t.flags=t.flags&-4097|2,Je=!1,Nn=t)}}else{if(vm(t))throw Error(Z(418));t.flags=t.flags&-4097|2,Je=!1,Nn=t}}}function m_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Nn=t}function ju(t){if(t!==Nn)return!1;if(!Je)return m_(t),Je=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!pm(t.type,t.memoizedProps)),e&&(e=Rn)){if(vm(t))throw XE(),Error(Z(418));for(;e;)YE(t,e),e=Yi(e.nextSibling)}if(m_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Rn=Yi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Rn=null}}else Rn=Nn?Yi(t.stateNode.nextSibling):null;return!0}function XE(){for(var t=Rn;t;)t=Yi(t.nextSibling)}function Ea(){Rn=Nn=null,Je=!1}function Zg(t){ar===null?ar=[t]:ar.push(t)}var DR=yi.ReactCurrentBatchConfig;function El(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,t))}return t}function Fu(t,e){throw t=Object.prototype.toString.call(e),Error(Z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function g_(t){var e=t._init;return e(t._payload)}function JE(t){function e(y,v){if(t){var T=y.deletions;T===null?(y.deletions=[v],y.flags|=16):T.push(v)}}function n(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function i(y,v){return y=es(y,v),y.index=0,y.sibling=null,y}function s(y,v,T){return y.index=T,t?(T=y.alternate,T!==null?(T=T.index,T<v?(y.flags|=2,v):T):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,v,T,A){return v===null||v.tag!==6?(v=hp(T,y.mode,A),v.return=y,v):(v=i(v,T),v.return=y,v)}function l(y,v,T,A){var O=T.type;return O===Wo?d(y,v,T.props.children,A,T.key):v!==null&&(v.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Di&&g_(O)===v.type)?(A=i(v,T.props),A.ref=El(y,v,T),A.return=y,A):(A=xd(T.type,T.key,T.props,null,y.mode,A),A.ref=El(y,v,T),A.return=y,A)}function c(y,v,T,A){return v===null||v.tag!==4||v.stateNode.containerInfo!==T.containerInfo||v.stateNode.implementation!==T.implementation?(v=fp(T,y.mode,A),v.return=y,v):(v=i(v,T.children||[]),v.return=y,v)}function d(y,v,T,A,O){return v===null||v.tag!==7?(v=Hs(T,y.mode,A,O),v.return=y,v):(v=i(v,T),v.return=y,v)}function h(y,v,T){if(typeof v=="string"&&v!==""||typeof v=="number")return v=hp(""+v,y.mode,T),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case ku:return T=xd(v.type,v.key,v.props,null,y.mode,T),T.ref=El(y,null,v),T.return=y,T;case Go:return v=fp(v,y.mode,T),v.return=y,v;case Di:var A=v._init;return h(y,A(v._payload),T)}if(zl(v)||yl(v))return v=Hs(v,y.mode,T,null),v.return=y,v;Fu(y,v)}return null}function f(y,v,T,A){var O=v!==null?v.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return O!==null?null:a(y,v,""+T,A);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case ku:return T.key===O?l(y,v,T,A):null;case Go:return T.key===O?c(y,v,T,A):null;case Di:return O=T._init,f(y,v,O(T._payload),A)}if(zl(T)||yl(T))return O!==null?null:d(y,v,T,A,null);Fu(y,T)}return null}function m(y,v,T,A,O){if(typeof A=="string"&&A!==""||typeof A=="number")return y=y.get(T)||null,a(v,y,""+A,O);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case ku:return y=y.get(A.key===null?T:A.key)||null,l(v,y,A,O);case Go:return y=y.get(A.key===null?T:A.key)||null,c(v,y,A,O);case Di:var L=A._init;return m(y,v,T,L(A._payload),O)}if(zl(A)||yl(A))return y=y.get(T)||null,d(v,y,A,O,null);Fu(v,A)}return null}function b(y,v,T,A){for(var O=null,L=null,S=v,I=v=0,w=null;S!==null&&I<T.length;I++){S.index>I?(w=S,S=null):w=S.sibling;var E=f(y,S,T[I],A);if(E===null){S===null&&(S=w);break}t&&S&&E.alternate===null&&e(y,S),v=s(E,v,I),L===null?O=E:L.sibling=E,L=E,S=w}if(I===T.length)return n(y,S),Je&&Cs(y,I),O;if(S===null){for(;I<T.length;I++)S=h(y,T[I],A),S!==null&&(v=s(S,v,I),L===null?O=S:L.sibling=S,L=S);return Je&&Cs(y,I),O}for(S=r(y,S);I<T.length;I++)w=m(S,y,I,T[I],A),w!==null&&(t&&w.alternate!==null&&S.delete(w.key===null?I:w.key),v=s(w,v,I),L===null?O=w:L.sibling=w,L=w);return t&&S.forEach(function(C){return e(y,C)}),Je&&Cs(y,I),O}function x(y,v,T,A){var O=yl(T);if(typeof O!="function")throw Error(Z(150));if(T=O.call(T),T==null)throw Error(Z(151));for(var L=O=null,S=v,I=v=0,w=null,E=T.next();S!==null&&!E.done;I++,E=T.next()){S.index>I?(w=S,S=null):w=S.sibling;var C=f(y,S,E.value,A);if(C===null){S===null&&(S=w);break}t&&S&&C.alternate===null&&e(y,S),v=s(C,v,I),L===null?O=C:L.sibling=C,L=C,S=w}if(E.done)return n(y,S),Je&&Cs(y,I),O;if(S===null){for(;!E.done;I++,E=T.next())E=h(y,E.value,A),E!==null&&(v=s(E,v,I),L===null?O=E:L.sibling=E,L=E);return Je&&Cs(y,I),O}for(S=r(y,S);!E.done;I++,E=T.next())E=m(S,y,I,E.value,A),E!==null&&(t&&E.alternate!==null&&S.delete(E.key===null?I:E.key),v=s(E,v,I),L===null?O=E:L.sibling=E,L=E);return t&&S.forEach(function(P){return e(y,P)}),Je&&Cs(y,I),O}function R(y,v,T,A){if(typeof T=="object"&&T!==null&&T.type===Wo&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case ku:e:{for(var O=T.key,L=v;L!==null;){if(L.key===O){if(O=T.type,O===Wo){if(L.tag===7){n(y,L.sibling),v=i(L,T.props.children),v.return=y,y=v;break e}}else if(L.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Di&&g_(O)===L.type){n(y,L.sibling),v=i(L,T.props),v.ref=El(y,L,T),v.return=y,y=v;break e}n(y,L);break}else e(y,L);L=L.sibling}T.type===Wo?(v=Hs(T.props.children,y.mode,A,T.key),v.return=y,y=v):(A=xd(T.type,T.key,T.props,null,y.mode,A),A.ref=El(y,v,T),A.return=y,y=A)}return o(y);case Go:e:{for(L=T.key;v!==null;){if(v.key===L)if(v.tag===4&&v.stateNode.containerInfo===T.containerInfo&&v.stateNode.implementation===T.implementation){n(y,v.sibling),v=i(v,T.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else e(y,v);v=v.sibling}v=fp(T,y.mode,A),v.return=y,y=v}return o(y);case Di:return L=T._init,R(y,v,L(T._payload),A)}if(zl(T))return b(y,v,T,A);if(yl(T))return x(y,v,T,A);Fu(y,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,v!==null&&v.tag===6?(n(y,v.sibling),v=i(v,T),v.return=y,y=v):(n(y,v),v=hp(T,y.mode,A),v.return=y,y=v),o(y)):n(y,v)}return R}var ba=JE(!0),ZE=JE(!1),Jd=ps(null),Zd=null,na=null,e0=null;function t0(){e0=na=Zd=null}function n0(t){var e=Jd.current;Qe(Jd),t._currentValue=e}function wm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ua(t,e){Zd=t,e0=na=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(dn=!0),t.firstContext=null)}function Qn(t){var e=t._currentValue;if(e0!==t)if(t={context:t,memoizedValue:e,next:null},na===null){if(Zd===null)throw Error(Z(308));na=t,Zd.dependencies={lanes:0,firstContext:t}}else na=na.next=t;return e}var Ls=null;function r0(t){Ls===null?Ls=[t]:Ls.push(t)}function eb(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,r0(e)):(n.next=i.next,i.next=n),e.interleaved=n,ci(t,r)}function ci(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vi=!1;function i0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function tb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ii(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Xi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ne&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ci(t,n)}return i=r.interleaved,i===null?(e.next=e,r0(r)):(e.next=i.next,i.next=e),r.interleaved=e,ci(t,n)}function md(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Bg(t,n)}}function y_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function eh(t,e,n,r){var i=t.updateQueue;Vi=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,d=c=l=null,a=s;do{var f=a.lane,m=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,x=a;switch(f=e,m=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){h=b.call(m,h,f);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,f=typeof b=="function"?b.call(m,h,f):b,f==null)break e;h=it({},h,f);break e;case 2:Vi=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else m={eventTime:m,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=m,l=h):d=d.next=m,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Js|=o,t.lanes=o,t.memoizedState=h}}function v_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Z(191,i));i.call(r)}}}var tu={},Cr=ps(tu),bc=ps(tu),Ic=ps(tu);function Ms(t){if(t===tu)throw Error(Z(174));return t}function s0(t,e){switch(Ke(Ic,e),Ke(bc,t),Ke(Cr,tu),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:em(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=em(e,t)}Qe(Cr),Ke(Cr,e)}function Ia(){Qe(Cr),Qe(bc),Qe(Ic)}function nb(t){Ms(Ic.current);var e=Ms(Cr.current),n=em(e,t.type);e!==n&&(Ke(bc,t),Ke(Cr,n))}function o0(t){bc.current===t&&(Qe(Cr),Qe(bc))}var et=ps(0);function th(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var op=[];function a0(){for(var t=0;t<op.length;t++)op[t]._workInProgressVersionPrimary=null;op.length=0}var gd=yi.ReactCurrentDispatcher,ap=yi.ReactCurrentBatchConfig,Xs=0,nt=null,xt=null,kt=null,nh=!1,tc=!1,Tc=0,VR=0;function qt(){throw Error(Z(321))}function l0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!pr(t[n],e[n]))return!1;return!0}function c0(t,e,n,r,i,s){if(Xs=s,nt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,gd.current=t===null||t.memoizedState===null?MR:jR,t=n(r,i),tc){s=0;do{if(tc=!1,Tc=0,25<=s)throw Error(Z(301));s+=1,kt=xt=null,e.updateQueue=null,gd.current=FR,t=n(r,i)}while(tc)}if(gd.current=rh,e=xt!==null&&xt.next!==null,Xs=0,kt=xt=nt=null,nh=!1,e)throw Error(Z(300));return t}function u0(){var t=Tc!==0;return Tc=0,t}function Er(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return kt===null?nt.memoizedState=kt=t:kt=kt.next=t,kt}function Yn(){if(xt===null){var t=nt.alternate;t=t!==null?t.memoizedState:null}else t=xt.next;var e=kt===null?nt.memoizedState:kt.next;if(e!==null)kt=e,xt=t;else{if(t===null)throw Error(Z(310));xt=t,t={memoizedState:xt.memoizedState,baseState:xt.baseState,baseQueue:xt.baseQueue,queue:xt.queue,next:null},kt===null?nt.memoizedState=kt=t:kt=kt.next=t}return kt}function Sc(t,e){return typeof e=="function"?e(t):e}function lp(t){var e=Yn(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=xt,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((Xs&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,nt.lanes|=d,Js|=d}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,pr(r,e.memoizedState)||(dn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,nt.lanes|=s,Js|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function cp(t){var e=Yn(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);pr(s,e.memoizedState)||(dn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function rb(){}function ib(t,e){var n=nt,r=Yn(),i=e(),s=!pr(r.memoizedState,i);if(s&&(r.memoizedState=i,dn=!0),r=r.queue,d0(ab.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||kt!==null&&kt.memoizedState.tag&1){if(n.flags|=2048,Cc(9,ob.bind(null,n,r,i,e),void 0,null),Rt===null)throw Error(Z(349));Xs&30||sb(n,e,i)}return i}function sb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=nt.updateQueue,e===null?(e={lastEffect:null,stores:null},nt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function ob(t,e,n,r){e.value=n,e.getSnapshot=r,lb(e)&&cb(t)}function ab(t,e,n){return n(function(){lb(e)&&cb(t)})}function lb(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!pr(t,n)}catch{return!0}}function cb(t){var e=ci(t,1);e!==null&&dr(e,t,1,-1)}function __(t){var e=Er();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sc,lastRenderedState:t},e.queue=t,t=t.dispatch=LR.bind(null,nt,t),[e.memoizedState,t]}function Cc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=nt.updateQueue,e===null?(e={lastEffect:null,stores:null},nt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function ub(){return Yn().memoizedState}function yd(t,e,n,r){var i=Er();nt.flags|=t,i.memoizedState=Cc(1|e,n,void 0,r===void 0?null:r)}function Qh(t,e,n,r){var i=Yn();r=r===void 0?null:r;var s=void 0;if(xt!==null){var o=xt.memoizedState;if(s=o.destroy,r!==null&&l0(r,o.deps)){i.memoizedState=Cc(e,n,s,r);return}}nt.flags|=t,i.memoizedState=Cc(1|e,n,s,r)}function w_(t,e){return yd(8390656,8,t,e)}function d0(t,e){return Qh(2048,8,t,e)}function db(t,e){return Qh(4,2,t,e)}function hb(t,e){return Qh(4,4,t,e)}function fb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function pb(t,e,n){return n=n!=null?n.concat([t]):null,Qh(4,4,fb.bind(null,e,t),n)}function h0(){}function mb(t,e){var n=Yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&l0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function gb(t,e){var n=Yn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&l0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function yb(t,e,n){return Xs&21?(pr(n,e)||(n=EE(),nt.lanes|=n,Js|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,dn=!0),t.memoizedState=n)}function OR(t,e){var n=Fe;Fe=n!==0&&4>n?n:4,t(!0);var r=ap.transition;ap.transition={};try{t(!1),e()}finally{Fe=n,ap.transition=r}}function vb(){return Yn().memoizedState}function zR(t,e,n){var r=Zi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},_b(t))wb(e,n);else if(n=eb(t,e,n,r),n!==null){var i=en();dr(n,t,r,i),xb(n,e,r)}}function LR(t,e,n){var r=Zi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(_b(t))wb(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,pr(a,o)){var l=e.interleaved;l===null?(i.next=i,r0(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=eb(t,e,i,r),n!==null&&(i=en(),dr(n,t,r,i),xb(n,e,r))}}function _b(t){var e=t.alternate;return t===nt||e!==null&&e===nt}function wb(t,e){tc=nh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function xb(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Bg(t,n)}}var rh={readContext:Qn,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useInsertionEffect:qt,useLayoutEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useMutableSource:qt,useSyncExternalStore:qt,useId:qt,unstable_isNewReconciler:!1},MR={readContext:Qn,useCallback:function(t,e){return Er().memoizedState=[t,e===void 0?null:e],t},useContext:Qn,useEffect:w_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,yd(4194308,4,fb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return yd(4194308,4,t,e)},useInsertionEffect:function(t,e){return yd(4,2,t,e)},useMemo:function(t,e){var n=Er();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Er();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=zR.bind(null,nt,t),[r.memoizedState,t]},useRef:function(t){var e=Er();return t={current:t},e.memoizedState=t},useState:__,useDebugValue:h0,useDeferredValue:function(t){return Er().memoizedState=t},useTransition:function(){var t=__(!1),e=t[0];return t=OR.bind(null,t[1]),Er().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=nt,i=Er();if(Je){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=e(),Rt===null)throw Error(Z(349));Xs&30||sb(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,w_(ab.bind(null,r,s,t),[t]),r.flags|=2048,Cc(9,ob.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Er(),e=Rt.identifierPrefix;if(Je){var n=Jr,r=Xr;n=(r&~(1<<32-ur(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Tc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=VR++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},jR={readContext:Qn,useCallback:mb,useContext:Qn,useEffect:d0,useImperativeHandle:pb,useInsertionEffect:db,useLayoutEffect:hb,useMemo:gb,useReducer:lp,useRef:ub,useState:function(){return lp(Sc)},useDebugValue:h0,useDeferredValue:function(t){var e=Yn();return yb(e,xt.memoizedState,t)},useTransition:function(){var t=lp(Sc)[0],e=Yn().memoizedState;return[t,e]},useMutableSource:rb,useSyncExternalStore:ib,useId:vb,unstable_isNewReconciler:!1},FR={readContext:Qn,useCallback:mb,useContext:Qn,useEffect:d0,useImperativeHandle:pb,useInsertionEffect:db,useLayoutEffect:hb,useMemo:gb,useReducer:cp,useRef:ub,useState:function(){return cp(Sc)},useDebugValue:h0,useDeferredValue:function(t){var e=Yn();return xt===null?e.memoizedState=t:yb(e,xt.memoizedState,t)},useTransition:function(){var t=cp(Sc)[0],e=Yn().memoizedState;return[t,e]},useMutableSource:rb,useSyncExternalStore:ib,useId:vb,unstable_isNewReconciler:!1};function ir(t,e){if(t&&t.defaultProps){e=it({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function xm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:it({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Yh={isMounted:function(t){return(t=t._reactInternals)?go(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=en(),i=Zi(t),s=ii(r,i);s.payload=e,n!=null&&(s.callback=n),e=Xi(t,s,i),e!==null&&(dr(e,t,i,r),md(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=en(),i=Zi(t),s=ii(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Xi(t,s,i),e!==null&&(dr(e,t,i,r),md(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=en(),r=Zi(t),i=ii(n,r);i.tag=2,e!=null&&(i.callback=e),e=Xi(t,i,r),e!==null&&(dr(e,t,r,n),md(e,t,r))}};function x_(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!_c(n,r)||!_c(i,s):!0}function Eb(t,e,n){var r=!1,i=ls,s=e.contextType;return typeof s=="object"&&s!==null?s=Qn(s):(i=mn(e)?Qs:Qt.current,r=e.contextTypes,s=(r=r!=null)?xa(t,i):ls),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yh,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function E_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Yh.enqueueReplaceState(e,e.state,null)}function Em(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},i0(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Qn(s):(s=mn(e)?Qs:Qt.current,i.context=xa(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(xm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Yh.enqueueReplaceState(i,i.state,null),eh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ta(t,e){try{var n="",r=e;do n+=pk(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function up(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function bm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var $R=typeof WeakMap=="function"?WeakMap:Map;function bb(t,e,n){n=ii(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){sh||(sh=!0,Dm=r),bm(t,e)},n}function Ib(t,e,n){n=ii(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){bm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){bm(t,e),typeof r!="function"&&(Ji===null?Ji=new Set([this]):Ji.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function b_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new $R;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=tP.bind(null,t,e,n),e.then(t,t))}function I_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function T_(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ii(-1,1),e.tag=2,Xi(n,e,1))),n.lanes|=1),t)}var UR=yi.ReactCurrentOwner,dn=!1;function Jt(t,e,n,r){e.child=t===null?ZE(e,null,n,r):ba(e,t.child,n,r)}function S_(t,e,n,r,i){n=n.render;var s=e.ref;return ua(e,i),r=c0(t,e,n,r,s,i),n=u0(),t!==null&&!dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ui(t,e,i)):(Je&&n&&Xg(e),e.flags|=1,Jt(t,e,r,i),e.child)}function C_(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!w0(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,Tb(t,e,s,r,i)):(t=xd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:_c,n(o,r)&&t.ref===e.ref)return ui(t,e,i)}return e.flags|=1,t=es(s,r),t.ref=e.ref,t.return=e,e.child=t}function Tb(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(_c(s,r)&&t.ref===e.ref)if(dn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(dn=!0);else return e.lanes=t.lanes,ui(t,e,i)}return Im(t,e,n,r,i)}function Sb(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ke(ia,Cn),Cn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Ke(ia,Cn),Cn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ke(ia,Cn),Cn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Ke(ia,Cn),Cn|=r;return Jt(t,e,i,n),e.child}function Cb(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Im(t,e,n,r,i){var s=mn(n)?Qs:Qt.current;return s=xa(e,s),ua(e,i),n=c0(t,e,n,r,s,i),r=u0(),t!==null&&!dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,ui(t,e,i)):(Je&&r&&Xg(e),e.flags|=1,Jt(t,e,n,i),e.child)}function A_(t,e,n,r,i){if(mn(n)){var s=!0;Qd(e)}else s=!1;if(ua(e,i),e.stateNode===null)vd(t,e),Eb(e,n,r),Em(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Qn(c):(c=mn(n)?Qs:Qt.current,c=xa(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&E_(e,o,r,c),Vi=!1;var f=e.memoizedState;o.state=f,eh(e,r,o,i),l=e.memoizedState,a!==r||f!==l||pn.current||Vi?(typeof d=="function"&&(xm(e,n,d,r),l=e.memoizedState),(a=Vi||x_(e,n,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,tb(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ir(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Qn(l):(l=mn(n)?Qs:Qt.current,l=xa(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&E_(e,o,r,l),Vi=!1,f=e.memoizedState,o.state=f,eh(e,r,o,i);var b=e.memoizedState;a!==h||f!==b||pn.current||Vi?(typeof m=="function"&&(xm(e,n,m,r),b=e.memoizedState),(c=Vi||x_(e,n,c,r,f,b,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),o.props=r,o.state=b,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return Tm(t,e,n,r,s,i)}function Tm(t,e,n,r,i,s){Cb(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&f_(e,n,!1),ui(t,e,s);r=e.stateNode,UR.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ba(e,t.child,null,s),e.child=ba(e,null,a,s)):Jt(t,e,a,s),e.memoizedState=r.state,i&&f_(e,n,!0),e.child}function Ab(t){var e=t.stateNode;e.pendingContext?h_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&h_(t,e.context,!1),s0(t,e.containerInfo)}function k_(t,e,n,r,i){return Ea(),Zg(i),e.flags|=256,Jt(t,e,n,r),e.child}var Sm={dehydrated:null,treeContext:null,retryLane:0};function Cm(t){return{baseLanes:t,cachePool:null,transitions:null}}function kb(t,e,n){var r=e.pendingProps,i=et.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Ke(et,i&1),t===null)return _m(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Zh(o,r,0,null),t=Hs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Cm(n),e.memoizedState=Sm,t):f0(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return BR(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=es(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=es(a,s):(s=Hs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Cm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Sm,r}return s=t.child,t=s.sibling,r=es(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function f0(t,e){return e=Zh({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function $u(t,e,n,r){return r!==null&&Zg(r),ba(e,t.child,null,n),t=f0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function BR(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=up(Error(Z(422))),$u(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Zh({mode:"visible",children:r.children},i,0,null),s=Hs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&ba(e,t.child,null,o),e.child.memoizedState=Cm(o),e.memoizedState=Sm,s);if(!(e.mode&1))return $u(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Z(419)),r=up(s,r,void 0),$u(t,e,o,r)}if(a=(o&t.childLanes)!==0,dn||a){if(r=Rt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ci(t,i),dr(r,t,i,-1))}return _0(),r=up(Error(Z(421))),$u(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=nP.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,Rn=Yi(i.nextSibling),Nn=e,Je=!0,ar=null,t!==null&&(Fn[$n++]=Xr,Fn[$n++]=Jr,Fn[$n++]=Ys,Xr=t.id,Jr=t.overflow,Ys=e),e=f0(e,r.children),e.flags|=4096,e)}function R_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),wm(t.return,e,n)}function dp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Rb(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Jt(t,e,r.children,n),r=et.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&R_(t,n,e);else if(t.tag===19)R_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Ke(et,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&th(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),dp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&th(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}dp(e,!0,n,null,s);break;case"together":dp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function vd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ui(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Js|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Z(153));if(e.child!==null){for(t=e.child,n=es(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=es(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function HR(t,e,n){switch(e.tag){case 3:Ab(e),Ea();break;case 5:nb(e);break;case 1:mn(e.type)&&Qd(e);break;case 4:s0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Ke(Jd,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Ke(et,et.current&1),e.flags|=128,null):n&e.child.childLanes?kb(t,e,n):(Ke(et,et.current&1),t=ui(t,e,n),t!==null?t.sibling:null);Ke(et,et.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Rb(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ke(et,et.current),r)break;return null;case 22:case 23:return e.lanes=0,Sb(t,e,n)}return ui(t,e,n)}var Pb,Am,Nb,Db;Pb=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Am=function(){};Nb=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Ms(Cr.current);var s=null;switch(n){case"input":i=Yp(t,i),r=Yp(t,r),s=[];break;case"select":i=it({},i,{value:void 0}),r=it({},r,{value:void 0}),s=[];break;case"textarea":i=Zp(t,i),r=Zp(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Gd)}tm(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(hc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(hc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&We("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Db=function(t,e,n,r){n!==r&&(e.flags|=4)};function bl(t,e){if(!Je)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Kt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function qR(t,e,n){var r=e.pendingProps;switch(Jg(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(e),null;case 1:return mn(e.type)&&Wd(),Kt(e),null;case 3:return r=e.stateNode,Ia(),Qe(pn),Qe(Qt),a0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(ju(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ar!==null&&(zm(ar),ar=null))),Am(t,e),Kt(e),null;case 5:o0(e);var i=Ms(Ic.current);if(n=e.type,t!==null&&e.stateNode!=null)Nb(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Z(166));return Kt(e),null}if(t=Ms(Cr.current),ju(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[br]=e,r[Ec]=s,t=(e.mode&1)!==0,n){case"dialog":We("cancel",r),We("close",r);break;case"iframe":case"object":case"embed":We("load",r);break;case"video":case"audio":for(i=0;i<Ml.length;i++)We(Ml[i],r);break;case"source":We("error",r);break;case"img":case"image":case"link":We("error",r),We("load",r);break;case"details":We("toggle",r);break;case"input":jv(r,s),We("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},We("invalid",r);break;case"textarea":$v(r,s),We("invalid",r)}tm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&Mu(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Mu(r.textContent,a,t),i=["children",""+a]):hc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&We("scroll",r)}switch(n){case"input":Ru(r),Fv(r,s,!0);break;case"textarea":Ru(r),Uv(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Gd)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=aE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[br]=e,t[Ec]=r,Pb(t,e,!1,!1),e.stateNode=t;e:{switch(o=nm(n,r),n){case"dialog":We("cancel",t),We("close",t),i=r;break;case"iframe":case"object":case"embed":We("load",t),i=r;break;case"video":case"audio":for(i=0;i<Ml.length;i++)We(Ml[i],t);i=r;break;case"source":We("error",t),i=r;break;case"img":case"image":case"link":We("error",t),We("load",t),i=r;break;case"details":We("toggle",t),i=r;break;case"input":jv(t,r),i=Yp(t,r),We("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=it({},r,{value:void 0}),We("invalid",t);break;case"textarea":$v(t,r),i=Zp(t,r),We("invalid",t);break;default:i=r}tm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?uE(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&lE(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&fc(t,l):typeof l=="number"&&fc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(hc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&We("scroll",t):l!=null&&Lg(t,s,l,o))}switch(n){case"input":Ru(t),Fv(t,r,!1);break;case"textarea":Ru(t),Uv(t);break;case"option":r.value!=null&&t.setAttribute("value",""+as(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?oa(t,!!r.multiple,s,!1):r.defaultValue!=null&&oa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Gd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Kt(e),null;case 6:if(t&&e.stateNode!=null)Db(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Z(166));if(n=Ms(Ic.current),Ms(Cr.current),ju(e)){if(r=e.stateNode,n=e.memoizedProps,r[br]=e,(s=r.nodeValue!==n)&&(t=Nn,t!==null))switch(t.tag){case 3:Mu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Mu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[br]=e,e.stateNode=r}return Kt(e),null;case 13:if(Qe(et),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Je&&Rn!==null&&e.mode&1&&!(e.flags&128))XE(),Ea(),e.flags|=98560,s=!1;else if(s=ju(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Z(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Z(317));s[br]=e}else Ea(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Kt(e),s=!1}else ar!==null&&(zm(ar),ar=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||et.current&1?Et===0&&(Et=3):_0())),e.updateQueue!==null&&(e.flags|=4),Kt(e),null);case 4:return Ia(),Am(t,e),t===null&&wc(e.stateNode.containerInfo),Kt(e),null;case 10:return n0(e.type._context),Kt(e),null;case 17:return mn(e.type)&&Wd(),Kt(e),null;case 19:if(Qe(et),s=e.memoizedState,s===null)return Kt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)bl(s,!1);else{if(Et!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=th(t),o!==null){for(e.flags|=128,bl(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Ke(et,et.current&1|2),e.child}t=t.sibling}s.tail!==null&&ft()>Sa&&(e.flags|=128,r=!0,bl(s,!1),e.lanes=4194304)}else{if(!r)if(t=th(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),bl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!Je)return Kt(e),null}else 2*ft()-s.renderingStartTime>Sa&&n!==1073741824&&(e.flags|=128,r=!0,bl(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ft(),e.sibling=null,n=et.current,Ke(et,r?n&1|2:n&1),e):(Kt(e),null);case 22:case 23:return v0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Cn&1073741824&&(Kt(e),e.subtreeFlags&6&&(e.flags|=8192)):Kt(e),null;case 24:return null;case 25:return null}throw Error(Z(156,e.tag))}function KR(t,e){switch(Jg(e),e.tag){case 1:return mn(e.type)&&Wd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ia(),Qe(pn),Qe(Qt),a0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return o0(e),null;case 13:if(Qe(et),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Z(340));Ea()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qe(et),null;case 4:return Ia(),null;case 10:return n0(e.type._context),null;case 22:case 23:return v0(),null;case 24:return null;default:return null}}var Uu=!1,Wt=!1,GR=typeof WeakSet=="function"?WeakSet:Set,ae=null;function ra(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){at(t,e,r)}else n.current=null}function km(t,e,n){try{n()}catch(r){at(t,e,r)}}var P_=!1;function WR(t,e){if(hm=Hd,t=ME(),Yg(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++c===i&&(a=o),f===s&&++d===r&&(l=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(fm={focusedElem:t,selectionRange:n},Hd=!1,ae=e;ae!==null;)if(e=ae,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ae=t;else for(;ae!==null;){e=ae;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,R=b.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:ir(e.type,x),R);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(A){at(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,ae=t;break}ae=e.return}return b=P_,P_=!1,b}function nc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&km(e,n,s)}i=i.next}while(i!==r)}}function Xh(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Rm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Vb(t){var e=t.alternate;e!==null&&(t.alternate=null,Vb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[br],delete e[Ec],delete e[gm],delete e[RR],delete e[PR])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Ob(t){return t.tag===5||t.tag===3||t.tag===4}function N_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ob(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Pm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Gd));else if(r!==4&&(t=t.child,t!==null))for(Pm(t,e,n),t=t.sibling;t!==null;)Pm(t,e,n),t=t.sibling}function Nm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Nm(t,e,n),t=t.sibling;t!==null;)Nm(t,e,n),t=t.sibling}var Lt=null,sr=!1;function Ai(t,e,n){for(n=n.child;n!==null;)zb(t,e,n),n=n.sibling}function zb(t,e,n){if(Sr&&typeof Sr.onCommitFiberUnmount=="function")try{Sr.onCommitFiberUnmount(Bh,n)}catch{}switch(n.tag){case 5:Wt||ra(n,e);case 6:var r=Lt,i=sr;Lt=null,Ai(t,e,n),Lt=r,sr=i,Lt!==null&&(sr?(t=Lt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Lt.removeChild(n.stateNode));break;case 18:Lt!==null&&(sr?(t=Lt,n=n.stateNode,t.nodeType===8?ip(t.parentNode,n):t.nodeType===1&&ip(t,n),yc(t)):ip(Lt,n.stateNode));break;case 4:r=Lt,i=sr,Lt=n.stateNode.containerInfo,sr=!0,Ai(t,e,n),Lt=r,sr=i;break;case 0:case 11:case 14:case 15:if(!Wt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&km(n,e,o),i=i.next}while(i!==r)}Ai(t,e,n);break;case 1:if(!Wt&&(ra(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){at(n,e,a)}Ai(t,e,n);break;case 21:Ai(t,e,n);break;case 22:n.mode&1?(Wt=(r=Wt)||n.memoizedState!==null,Ai(t,e,n),Wt=r):Ai(t,e,n);break;default:Ai(t,e,n)}}function D_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new GR),e.forEach(function(r){var i=rP.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function rr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Lt=a.stateNode,sr=!1;break e;case 3:Lt=a.stateNode.containerInfo,sr=!0;break e;case 4:Lt=a.stateNode.containerInfo,sr=!0;break e}a=a.return}if(Lt===null)throw Error(Z(160));zb(s,o,i),Lt=null,sr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){at(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Lb(e,t),e=e.sibling}function Lb(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rr(e,t),xr(t),r&4){try{nc(3,t,t.return),Xh(3,t)}catch(x){at(t,t.return,x)}try{nc(5,t,t.return)}catch(x){at(t,t.return,x)}}break;case 1:rr(e,t),xr(t),r&512&&n!==null&&ra(n,n.return);break;case 5:if(rr(e,t),xr(t),r&512&&n!==null&&ra(n,n.return),t.flags&32){var i=t.stateNode;try{fc(i,"")}catch(x){at(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&sE(i,s),nm(a,o);var c=nm(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?uE(i,h):d==="dangerouslySetInnerHTML"?lE(i,h):d==="children"?fc(i,h):Lg(i,d,h,c)}switch(a){case"input":Xp(i,s);break;case"textarea":oE(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?oa(i,!!s.multiple,m,!1):f!==!!s.multiple&&(s.defaultValue!=null?oa(i,!!s.multiple,s.defaultValue,!0):oa(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ec]=s}catch(x){at(t,t.return,x)}}break;case 6:if(rr(e,t),xr(t),r&4){if(t.stateNode===null)throw Error(Z(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){at(t,t.return,x)}}break;case 3:if(rr(e,t),xr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{yc(e.containerInfo)}catch(x){at(t,t.return,x)}break;case 4:rr(e,t),xr(t);break;case 13:rr(e,t),xr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(g0=ft())),r&4&&D_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Wt=(c=Wt)||d,rr(e,t),Wt=c):rr(e,t),xr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(ae=t,d=t.child;d!==null;){for(h=ae=d;ae!==null;){switch(f=ae,m=f.child,f.tag){case 0:case 11:case 14:case 15:nc(4,f,f.return);break;case 1:ra(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){at(r,n,x)}}break;case 5:ra(f,f.return);break;case 22:if(f.memoizedState!==null){O_(h);continue}}m!==null?(m.return=f,ae=m):O_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=cE("display",o))}catch(x){at(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){at(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:rr(e,t),xr(t),r&4&&D_(t);break;case 21:break;default:rr(e,t),xr(t)}}function xr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Ob(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(fc(i,""),r.flags&=-33);var s=N_(t);Nm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=N_(t);Pm(t,a,o);break;default:throw Error(Z(161))}}catch(l){at(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function QR(t,e,n){ae=t,Mb(t)}function Mb(t,e,n){for(var r=(t.mode&1)!==0;ae!==null;){var i=ae,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Uu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Wt;a=Uu;var c=Wt;if(Uu=o,(Wt=l)&&!c)for(ae=i;ae!==null;)o=ae,l=o.child,o.tag===22&&o.memoizedState!==null?z_(i):l!==null?(l.return=o,ae=l):z_(i);for(;s!==null;)ae=s,Mb(s),s=s.sibling;ae=i,Uu=a,Wt=c}V_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ae=s):V_(t)}}function V_(t){for(;ae!==null;){var e=ae;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Wt||Xh(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Wt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ir(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&v_(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}v_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&yc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}Wt||e.flags&512&&Rm(e)}catch(f){at(e,e.return,f)}}if(e===t){ae=null;break}if(n=e.sibling,n!==null){n.return=e.return,ae=n;break}ae=e.return}}function O_(t){for(;ae!==null;){var e=ae;if(e===t){ae=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ae=n;break}ae=e.return}}function z_(t){for(;ae!==null;){var e=ae;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Xh(4,e)}catch(l){at(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){at(e,i,l)}}var s=e.return;try{Rm(e)}catch(l){at(e,s,l)}break;case 5:var o=e.return;try{Rm(e)}catch(l){at(e,o,l)}}}catch(l){at(e,e.return,l)}if(e===t){ae=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ae=a;break}ae=e.return}}var YR=Math.ceil,ih=yi.ReactCurrentDispatcher,p0=yi.ReactCurrentOwner,Kn=yi.ReactCurrentBatchConfig,Ne=0,Rt=null,gt=null,Ft=0,Cn=0,ia=ps(0),Et=0,Ac=null,Js=0,Jh=0,m0=0,rc=null,cn=null,g0=0,Sa=1/0,Wr=null,sh=!1,Dm=null,Ji=null,Bu=!1,qi=null,oh=0,ic=0,Vm=null,_d=-1,wd=0;function en(){return Ne&6?ft():_d!==-1?_d:_d=ft()}function Zi(t){return t.mode&1?Ne&2&&Ft!==0?Ft&-Ft:DR.transition!==null?(wd===0&&(wd=EE()),wd):(t=Fe,t!==0||(t=window.event,t=t===void 0?16:kE(t.type)),t):1}function dr(t,e,n,r){if(50<ic)throw ic=0,Vm=null,Error(Z(185));Jc(t,n,r),(!(Ne&2)||t!==Rt)&&(t===Rt&&(!(Ne&2)&&(Jh|=n),Et===4&&Mi(t,Ft)),gn(t,r),n===1&&Ne===0&&!(e.mode&1)&&(Sa=ft()+500,Wh&&ms()))}function gn(t,e){var n=t.callbackNode;Dk(t,e);var r=Bd(t,t===Rt?Ft:0);if(r===0)n!==null&&qv(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&qv(n),e===1)t.tag===0?NR(L_.bind(null,t)):WE(L_.bind(null,t)),AR(function(){!(Ne&6)&&ms()}),n=null;else{switch(bE(r)){case 1:n=Ug;break;case 4:n=wE;break;case 16:n=Ud;break;case 536870912:n=xE;break;default:n=Ud}n=Kb(n,jb.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function jb(t,e){if(_d=-1,wd=0,Ne&6)throw Error(Z(327));var n=t.callbackNode;if(da()&&t.callbackNode!==n)return null;var r=Bd(t,t===Rt?Ft:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=ah(t,r);else{e=r;var i=Ne;Ne|=2;var s=$b();(Rt!==t||Ft!==e)&&(Wr=null,Sa=ft()+500,Bs(t,e));do try{ZR();break}catch(a){Fb(t,a)}while(!0);t0(),ih.current=s,Ne=i,gt!==null?e=0:(Rt=null,Ft=0,e=Et)}if(e!==0){if(e===2&&(i=am(t),i!==0&&(r=i,e=Om(t,i))),e===1)throw n=Ac,Bs(t,0),Mi(t,r),gn(t,ft()),n;if(e===6)Mi(t,r);else{if(i=t.current.alternate,!(r&30)&&!XR(i)&&(e=ah(t,r),e===2&&(s=am(t),s!==0&&(r=s,e=Om(t,s))),e===1))throw n=Ac,Bs(t,0),Mi(t,r),gn(t,ft()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Z(345));case 2:As(t,cn,Wr);break;case 3:if(Mi(t,r),(r&130023424)===r&&(e=g0+500-ft(),10<e)){if(Bd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){en(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=mm(As.bind(null,t,cn,Wr),e);break}As(t,cn,Wr);break;case 4:if(Mi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-ur(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=ft()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*YR(r/1960))-r,10<r){t.timeoutHandle=mm(As.bind(null,t,cn,Wr),r);break}As(t,cn,Wr);break;case 5:As(t,cn,Wr);break;default:throw Error(Z(329))}}}return gn(t,ft()),t.callbackNode===n?jb.bind(null,t):null}function Om(t,e){var n=rc;return t.current.memoizedState.isDehydrated&&(Bs(t,e).flags|=256),t=ah(t,e),t!==2&&(e=cn,cn=n,e!==null&&zm(e)),t}function zm(t){cn===null?cn=t:cn.push.apply(cn,t)}function XR(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!pr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Mi(t,e){for(e&=~m0,e&=~Jh,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ur(e),r=1<<n;t[n]=-1,e&=~r}}function L_(t){if(Ne&6)throw Error(Z(327));da();var e=Bd(t,0);if(!(e&1))return gn(t,ft()),null;var n=ah(t,e);if(t.tag!==0&&n===2){var r=am(t);r!==0&&(e=r,n=Om(t,r))}if(n===1)throw n=Ac,Bs(t,0),Mi(t,e),gn(t,ft()),n;if(n===6)throw Error(Z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,As(t,cn,Wr),gn(t,ft()),null}function y0(t,e){var n=Ne;Ne|=1;try{return t(e)}finally{Ne=n,Ne===0&&(Sa=ft()+500,Wh&&ms())}}function Zs(t){qi!==null&&qi.tag===0&&!(Ne&6)&&da();var e=Ne;Ne|=1;var n=Kn.transition,r=Fe;try{if(Kn.transition=null,Fe=1,t)return t()}finally{Fe=r,Kn.transition=n,Ne=e,!(Ne&6)&&ms()}}function v0(){Cn=ia.current,Qe(ia)}function Bs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,CR(n)),gt!==null)for(n=gt.return;n!==null;){var r=n;switch(Jg(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Wd();break;case 3:Ia(),Qe(pn),Qe(Qt),a0();break;case 5:o0(r);break;case 4:Ia();break;case 13:Qe(et);break;case 19:Qe(et);break;case 10:n0(r.type._context);break;case 22:case 23:v0()}n=n.return}if(Rt=t,gt=t=es(t.current,null),Ft=Cn=e,Et=0,Ac=null,m0=Jh=Js=0,cn=rc=null,Ls!==null){for(e=0;e<Ls.length;e++)if(n=Ls[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ls=null}return t}function Fb(t,e){do{var n=gt;try{if(t0(),gd.current=rh,nh){for(var r=nt.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}nh=!1}if(Xs=0,kt=xt=nt=null,tc=!1,Tc=0,p0.current=null,n===null||n.return===null){Et=1,Ac=e,gt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Ft,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=I_(o);if(m!==null){m.flags&=-257,T_(m,o,a,s,e),m.mode&1&&b_(s,c,e),e=m,l=c;var b=e.updateQueue;if(b===null){var x=new Set;x.add(l),e.updateQueue=x}else b.add(l);break e}else{if(!(e&1)){b_(s,c,e),_0();break e}l=Error(Z(426))}}else if(Je&&a.mode&1){var R=I_(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),T_(R,o,a,s,e),Zg(Ta(l,a));break e}}s=l=Ta(l,a),Et!==4&&(Et=2),rc===null?rc=[s]:rc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=bb(s,l,e);y_(s,y);break e;case 1:a=l;var v=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Ji===null||!Ji.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var A=Ib(s,a,e);y_(s,A);break e}}s=s.return}while(s!==null)}Bb(n)}catch(O){e=O,gt===n&&n!==null&&(gt=n=n.return);continue}break}while(!0)}function $b(){var t=ih.current;return ih.current=rh,t===null?rh:t}function _0(){(Et===0||Et===3||Et===2)&&(Et=4),Rt===null||!(Js&268435455)&&!(Jh&268435455)||Mi(Rt,Ft)}function ah(t,e){var n=Ne;Ne|=2;var r=$b();(Rt!==t||Ft!==e)&&(Wr=null,Bs(t,e));do try{JR();break}catch(i){Fb(t,i)}while(!0);if(t0(),Ne=n,ih.current=r,gt!==null)throw Error(Z(261));return Rt=null,Ft=0,Et}function JR(){for(;gt!==null;)Ub(gt)}function ZR(){for(;gt!==null&&!Ik();)Ub(gt)}function Ub(t){var e=qb(t.alternate,t,Cn);t.memoizedProps=t.pendingProps,e===null?Bb(t):gt=e,p0.current=null}function Bb(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=KR(n,e),n!==null){n.flags&=32767,gt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Et=6,gt=null;return}}else if(n=qR(n,e,Cn),n!==null){gt=n;return}if(e=e.sibling,e!==null){gt=e;return}gt=e=t}while(e!==null);Et===0&&(Et=5)}function As(t,e,n){var r=Fe,i=Kn.transition;try{Kn.transition=null,Fe=1,eP(t,e,n,r)}finally{Kn.transition=i,Fe=r}return null}function eP(t,e,n,r){do da();while(qi!==null);if(Ne&6)throw Error(Z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Z(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Vk(t,s),t===Rt&&(gt=Rt=null,Ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Bu||(Bu=!0,Kb(Ud,function(){return da(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Kn.transition,Kn.transition=null;var o=Fe;Fe=1;var a=Ne;Ne|=4,p0.current=null,WR(t,n),Lb(n,t),wR(fm),Hd=!!hm,fm=hm=null,t.current=n,QR(n),Tk(),Ne=a,Fe=o,Kn.transition=s}else t.current=n;if(Bu&&(Bu=!1,qi=t,oh=i),s=t.pendingLanes,s===0&&(Ji=null),Ak(n.stateNode),gn(t,ft()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(sh)throw sh=!1,t=Dm,Dm=null,t;return oh&1&&t.tag!==0&&da(),s=t.pendingLanes,s&1?t===Vm?ic++:(ic=0,Vm=t):ic=0,ms(),null}function da(){if(qi!==null){var t=bE(oh),e=Kn.transition,n=Fe;try{if(Kn.transition=null,Fe=16>t?16:t,qi===null)var r=!1;else{if(t=qi,qi=null,oh=0,Ne&6)throw Error(Z(331));var i=Ne;for(Ne|=4,ae=t.current;ae!==null;){var s=ae,o=s.child;if(ae.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ae=c;ae!==null;){var d=ae;switch(d.tag){case 0:case 11:case 15:nc(8,d,s)}var h=d.child;if(h!==null)h.return=d,ae=h;else for(;ae!==null;){d=ae;var f=d.sibling,m=d.return;if(Vb(d),d===c){ae=null;break}if(f!==null){f.return=m,ae=f;break}ae=m}}}var b=s.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var R=x.sibling;x.sibling=null,x=R}while(x!==null)}}ae=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,ae=o;else e:for(;ae!==null;){if(s=ae,s.flags&2048)switch(s.tag){case 0:case 11:case 15:nc(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,ae=y;break e}ae=s.return}}var v=t.current;for(ae=v;ae!==null;){o=ae;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ae=T;else e:for(o=v;ae!==null;){if(a=ae,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Xh(9,a)}}catch(O){at(a,a.return,O)}if(a===o){ae=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,ae=A;break e}ae=a.return}}if(Ne=i,ms(),Sr&&typeof Sr.onPostCommitFiberRoot=="function")try{Sr.onPostCommitFiberRoot(Bh,t)}catch{}r=!0}return r}finally{Fe=n,Kn.transition=e}}return!1}function M_(t,e,n){e=Ta(n,e),e=bb(t,e,1),t=Xi(t,e,1),e=en(),t!==null&&(Jc(t,1,e),gn(t,e))}function at(t,e,n){if(t.tag===3)M_(t,t,n);else for(;e!==null;){if(e.tag===3){M_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ji===null||!Ji.has(r))){t=Ta(n,t),t=Ib(e,t,1),e=Xi(e,t,1),t=en(),e!==null&&(Jc(e,1,t),gn(e,t));break}}e=e.return}}function tP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=en(),t.pingedLanes|=t.suspendedLanes&n,Rt===t&&(Ft&n)===n&&(Et===4||Et===3&&(Ft&130023424)===Ft&&500>ft()-g0?Bs(t,0):m0|=n),gn(t,e)}function Hb(t,e){e===0&&(t.mode&1?(e=Du,Du<<=1,!(Du&130023424)&&(Du=4194304)):e=1);var n=en();t=ci(t,e),t!==null&&(Jc(t,e,n),gn(t,n))}function nP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Hb(t,n)}function rP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(e),Hb(t,n)}var qb;qb=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||pn.current)dn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return dn=!1,HR(t,e,n);dn=!!(t.flags&131072)}else dn=!1,Je&&e.flags&1048576&&QE(e,Xd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;vd(t,e),t=e.pendingProps;var i=xa(e,Qt.current);ua(e,n),i=c0(null,e,r,t,i,n);var s=u0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mn(r)?(s=!0,Qd(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i0(e),i.updater=Yh,e.stateNode=i,i._reactInternals=e,Em(e,r,t,n),e=Tm(null,e,r,!0,s,n)):(e.tag=0,Je&&s&&Xg(e),Jt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(vd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=sP(r),t=ir(r,t),i){case 0:e=Im(null,e,r,t,n);break e;case 1:e=A_(null,e,r,t,n);break e;case 11:e=S_(null,e,r,t,n);break e;case 14:e=C_(null,e,r,ir(r.type,t),n);break e}throw Error(Z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),Im(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),A_(t,e,r,i,n);case 3:e:{if(Ab(e),t===null)throw Error(Z(387));r=e.pendingProps,s=e.memoizedState,i=s.element,tb(t,e),eh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ta(Error(Z(423)),e),e=k_(t,e,r,n,i);break e}else if(r!==i){i=Ta(Error(Z(424)),e),e=k_(t,e,r,n,i);break e}else for(Rn=Yi(e.stateNode.containerInfo.firstChild),Nn=e,Je=!0,ar=null,n=ZE(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ea(),r===i){e=ui(t,e,n);break e}Jt(t,e,r,n)}e=e.child}return e;case 5:return nb(e),t===null&&_m(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,pm(r,i)?o=null:s!==null&&pm(r,s)&&(e.flags|=32),Cb(t,e),Jt(t,e,o,n),e.child;case 6:return t===null&&_m(e),null;case 13:return kb(t,e,n);case 4:return s0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ba(e,null,r,n):Jt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),S_(t,e,r,i,n);case 7:return Jt(t,e,e.pendingProps,n),e.child;case 8:return Jt(t,e,e.pendingProps.children,n),e.child;case 12:return Jt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Ke(Jd,r._currentValue),r._currentValue=o,s!==null)if(pr(s.value,o)){if(s.children===i.children&&!pn.current){e=ui(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ii(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),wm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Z(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),wm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Jt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ua(e,n),i=Qn(i),r=r(i),e.flags|=1,Jt(t,e,r,n),e.child;case 14:return r=e.type,i=ir(r,e.pendingProps),i=ir(r.type,i),C_(t,e,r,i,n);case 15:return Tb(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),vd(t,e),e.tag=1,mn(r)?(t=!0,Qd(e)):t=!1,ua(e,n),Eb(e,r,i),Em(e,r,i,n),Tm(null,e,r,!0,t,n);case 19:return Rb(t,e,n);case 22:return Sb(t,e,n)}throw Error(Z(156,e.tag))};function Kb(t,e){return _E(t,e)}function iP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Un(t,e,n,r){return new iP(t,e,n,r)}function w0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function sP(t){if(typeof t=="function")return w0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===jg)return 11;if(t===Fg)return 14}return 2}function es(t,e){var n=t.alternate;return n===null?(n=Un(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function xd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")w0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Wo:return Hs(n.children,i,s,e);case Mg:o=8,i|=8;break;case Kp:return t=Un(12,n,e,i|2),t.elementType=Kp,t.lanes=s,t;case Gp:return t=Un(13,n,e,i),t.elementType=Gp,t.lanes=s,t;case Wp:return t=Un(19,n,e,i),t.elementType=Wp,t.lanes=s,t;case nE:return Zh(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case eE:o=10;break e;case tE:o=9;break e;case jg:o=11;break e;case Fg:o=14;break e;case Di:o=16,r=null;break e}throw Error(Z(130,t==null?t:typeof t,""))}return e=Un(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function Hs(t,e,n,r){return t=Un(7,t,r,e),t.lanes=n,t}function Zh(t,e,n,r){return t=Un(22,t,r,e),t.elementType=nE,t.lanes=n,t.stateNode={isHidden:!1},t}function hp(t,e,n){return t=Un(6,t,null,e),t.lanes=n,t}function fp(t,e,n){return e=Un(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function oP(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gf(0),this.expirationTimes=Gf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gf(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function x0(t,e,n,r,i,s,o,a,l){return t=new oP(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=Un(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},i0(s),t}function aP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Go,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Gb(t){if(!t)return ls;t=t._reactInternals;e:{if(go(t)!==t||t.tag!==1)throw Error(Z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Z(171))}if(t.tag===1){var n=t.type;if(mn(n))return GE(t,n,e)}return e}function Wb(t,e,n,r,i,s,o,a,l){return t=x0(n,r,!0,t,i,s,o,a,l),t.context=Gb(null),n=t.current,r=en(),i=Zi(n),s=ii(r,i),s.callback=e??null,Xi(n,s,i),t.current.lanes=i,Jc(t,i,r),gn(t,r),t}function ef(t,e,n,r){var i=e.current,s=en(),o=Zi(i);return n=Gb(n),e.context===null?e.context=n:e.pendingContext=n,e=ii(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Xi(i,e,o),t!==null&&(dr(t,i,o,s),md(t,i,o)),o}function lh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function j_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function E0(t,e){j_(t,e),(t=t.alternate)&&j_(t,e)}function lP(){return null}var Qb=typeof reportError=="function"?reportError:function(t){console.error(t)};function b0(t){this._internalRoot=t}tf.prototype.render=b0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Z(409));ef(t,e,null,null)};tf.prototype.unmount=b0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Zs(function(){ef(null,t,null,null)}),e[li]=null}};function tf(t){this._internalRoot=t}tf.prototype.unstable_scheduleHydration=function(t){if(t){var e=SE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Li.length&&e!==0&&e<Li[n].priority;n++);Li.splice(n,0,t),n===0&&AE(t)}};function I0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function nf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function F_(){}function cP(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=lh(o);s.call(c)}}var o=Wb(e,r,t,0,null,!1,!1,"",F_);return t._reactRootContainer=o,t[li]=o.current,wc(t.nodeType===8?t.parentNode:t),Zs(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=lh(l);a.call(c)}}var l=x0(t,0,!1,null,null,!1,!1,"",F_);return t._reactRootContainer=l,t[li]=l.current,wc(t.nodeType===8?t.parentNode:t),Zs(function(){ef(e,l,n,r)}),l}function rf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=lh(o);a.call(l)}}ef(e,o,t,i)}else o=cP(n,e,t,i,r);return lh(o)}IE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ll(e.pendingLanes);n!==0&&(Bg(e,n|1),gn(e,ft()),!(Ne&6)&&(Sa=ft()+500,ms()))}break;case 13:Zs(function(){var r=ci(t,1);if(r!==null){var i=en();dr(r,t,1,i)}}),E0(t,1)}};Hg=function(t){if(t.tag===13){var e=ci(t,134217728);if(e!==null){var n=en();dr(e,t,134217728,n)}E0(t,134217728)}};TE=function(t){if(t.tag===13){var e=Zi(t),n=ci(t,e);if(n!==null){var r=en();dr(n,t,e,r)}E0(t,e)}};SE=function(){return Fe};CE=function(t,e){var n=Fe;try{return Fe=t,e()}finally{Fe=n}};im=function(t,e,n){switch(e){case"input":if(Xp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Gh(r);if(!i)throw Error(Z(90));iE(r),Xp(r,i)}}}break;case"textarea":oE(t,n);break;case"select":e=n.value,e!=null&&oa(t,!!n.multiple,e,!1)}};fE=y0;pE=Zs;var uP={usingClientEntryPoint:!1,Events:[eu,Jo,Gh,dE,hE,y0]},Il={findFiberByHostInstance:zs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dP={bundleType:Il.bundleType,version:Il.version,rendererPackageName:Il.rendererPackageName,rendererConfig:Il.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=yE(t),t===null?null:t.stateNode},findFiberByHostInstance:Il.findFiberByHostInstance||lP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hu.isDisabled&&Hu.supportsFiber)try{Bh=Hu.inject(dP),Sr=Hu}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=uP;Ln.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!I0(e))throw Error(Z(200));return aP(t,e,null,n)};Ln.createRoot=function(t,e){if(!I0(t))throw Error(Z(299));var n=!1,r="",i=Qb;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=x0(t,1,!1,null,null,n,!1,r,i),t[li]=e.current,wc(t.nodeType===8?t.parentNode:t),new b0(e)};Ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Z(188)):(t=Object.keys(t).join(","),Error(Z(268,t)));return t=yE(e),t=t===null?null:t.stateNode,t};Ln.flushSync=function(t){return Zs(t)};Ln.hydrate=function(t,e,n){if(!nf(e))throw Error(Z(200));return rf(null,t,e,!0,n)};Ln.hydrateRoot=function(t,e,n){if(!I0(t))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=Qb;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Wb(e,null,t,1,n??null,i,!1,s,o),t[li]=e.current,wc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new tf(e)};Ln.render=function(t,e,n){if(!nf(e))throw Error(Z(200));return rf(null,t,e,!1,n)};Ln.unmountComponentAtNode=function(t){if(!nf(t))throw Error(Z(40));return t._reactRootContainer?(Zs(function(){rf(null,null,t,!1,function(){t._reactRootContainer=null,t[li]=null})}),!0):!1};Ln.unstable_batchedUpdates=y0;Ln.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!nf(n))throw Error(Z(200));if(t==null||t._reactInternals===void 0)throw Error(Z(38));return rf(t,e,n,!1,r)};Ln.version="18.3.1-next-f1338f8080-20240426";function Yb(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Yb)}catch(t){console.error(t)}}Yb(),Y1.exports=Ln;var kc=Y1.exports,$_=kc;Hp.createRoot=$_.createRoot,Hp.hydrateRoot=$_.hydrateRoot;function Dt(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,r;n<t.length;n++)(r=Dt(t[n]))!==""&&(e+=(e&&" ")+r);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var Xb={exports:{}},Jb={},Zb={exports:{}},eI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ca=D;function hP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var fP=typeof Object.is=="function"?Object.is:hP,pP=Ca.useState,mP=Ca.useEffect,gP=Ca.useLayoutEffect,yP=Ca.useDebugValue;function vP(t,e){var n=e(),r=pP({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return gP(function(){i.value=n,i.getSnapshot=e,pp(i)&&s({inst:i})},[t,n,e]),mP(function(){return pp(i)&&s({inst:i}),t(function(){pp(i)&&s({inst:i})})},[t]),yP(n),n}function pp(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!fP(t,n)}catch{return!0}}function _P(t,e){return e()}var wP=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?_P:vP;eI.useSyncExternalStore=Ca.useSyncExternalStore!==void 0?Ca.useSyncExternalStore:wP;Zb.exports=eI;var xP=Zb.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sf=D,EP=xP;function bP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var IP=typeof Object.is=="function"?Object.is:bP,TP=EP.useSyncExternalStore,SP=sf.useRef,CP=sf.useEffect,AP=sf.useMemo,kP=sf.useDebugValue;Jb.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=SP(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=AP(function(){function l(m){if(!c){if(c=!0,d=m,m=r(m),i!==void 0&&o.hasValue){var b=o.value;if(i(b,m))return h=b}return h=m}if(b=h,IP(d,m))return b;var x=r(m);return i!==void 0&&i(b,x)?(d=m,b):(d=m,h=x)}var c=!1,d,h,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,i]);var a=TP(t,s[0],s[1]);return CP(function(){o.hasValue=!0,o.value=a},[a]),kP(a),a};Xb.exports=Jb;var RP=Xb.exports;const PP=M1(RP),NP={},U_=t=>{let e;const n=new Set,r=(d,h)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const m=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(b=>b(e,m))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(NP?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},DP=t=>t?U_(t):U_,{useDebugValue:VP}=K,{useSyncExternalStoreWithSelector:OP}=PP,zP=t=>t;function tI(t,e=zP,n){const r=OP(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return VP(r),r}const B_=(t,e)=>{const n=DP(t),r=(i,s=e)=>tI(n,i,s);return Object.assign(r,n),r},LP=(t,e)=>t?B_(t,e):B_;function Pt(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,i]of t)if(!Object.is(i,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(t[r],e[r]))return!1;return!0}var MP={value:()=>{}};function of(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Ed(n)}function Ed(t){this._=t}function jP(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Ed.prototype=of.prototype={constructor:Ed,on:function(t,e){var n=this._,r=jP(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=FP(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=H_(n[i],t.name,e);else if(e==null)for(i in n)n[i]=H_(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Ed(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function FP(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function H_(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=MP,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Lm="http://www.w3.org/1999/xhtml";const q_={svg:"http://www.w3.org/2000/svg",xhtml:Lm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function af(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),q_.hasOwnProperty(e)?{space:q_[e],local:t}:t}function $P(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Lm&&e.documentElement.namespaceURI===Lm?e.createElement(t):e.createElementNS(n,t)}}function UP(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function nI(t){var e=af(t);return(e.local?UP:$P)(e)}function BP(){}function T0(t){return t==null?BP:function(){return this.querySelector(t)}}function HP(t){typeof t!="function"&&(t=T0(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),l,c,d=0;d<o;++d)(l=s[d])&&(c=t.call(l,l.__data__,d,s))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new On(r,this._parents)}function qP(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function KP(){return[]}function rI(t){return t==null?KP:function(){return this.querySelectorAll(t)}}function GP(t){return function(){return qP(t.apply(this,arguments))}}function WP(t){typeof t=="function"?t=GP(t):t=rI(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(r.push(t.call(l,l.__data__,c,o)),i.push(l));return new On(r,i)}function iI(t){return function(){return this.matches(t)}}function sI(t){return function(e){return e.matches(t)}}var QP=Array.prototype.find;function YP(t){return function(){return QP.call(this.children,t)}}function XP(){return this.firstElementChild}function JP(t){return this.select(t==null?XP:YP(typeof t=="function"?t:sI(t)))}var ZP=Array.prototype.filter;function eN(){return Array.from(this.children)}function tN(t){return function(){return ZP.call(this.children,t)}}function nN(t){return this.selectAll(t==null?eN:tN(typeof t=="function"?t:sI(t)))}function rN(t){typeof t!="function"&&(t=iI(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new On(r,this._parents)}function oI(t){return new Array(t.length)}function iN(){return new On(this._enter||this._groups.map(oI),this._parents)}function ch(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}ch.prototype={constructor:ch,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function sN(t){return function(){return t}}function oN(t,e,n,r,i,s){for(var o=0,a,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new ch(t,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function aN(t,e,n,r,i,s,o){var a,l,c=new Map,d=e.length,h=s.length,f=new Array(d),m;for(a=0;a<d;++a)(l=e[a])&&(f[a]=m=o.call(l,l.__data__,a,e)+"",c.has(m)?i[a]=l:c.set(m,l));for(a=0;a<h;++a)m=o.call(t,s[a],a,s)+"",(l=c.get(m))?(r[a]=l,l.__data__=s[a],c.delete(m)):n[a]=new ch(t,s[a]);for(a=0;a<d;++a)(l=e[a])&&c.get(f[a])===l&&(i[a]=l)}function lN(t){return t.__data__}function cN(t,e){if(!arguments.length)return Array.from(this,lN);var n=e?aN:oN,r=this._parents,i=this._groups;typeof t!="function"&&(t=sN(t));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var d=r[c],h=i[c],f=h.length,m=uN(t.call(d,d&&d.__data__,c,r)),b=m.length,x=a[c]=new Array(b),R=o[c]=new Array(b),y=l[c]=new Array(f);n(d,h,x,R,y,m,e);for(var v=0,T=0,A,O;v<b;++v)if(A=x[v]){for(v>=T&&(T=v+1);!(O=R[T])&&++T<b;);A._next=O||null}}return o=new On(o,r),o._enter=a,o._exit=l,o}function uN(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function dN(){return new On(this._exit||this._groups.map(oI),this._parents)}function hN(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function fN(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var c=n[l],d=r[l],h=c.length,f=a[l]=new Array(h),m,b=0;b<h;++b)(m=c[b]||d[b])&&(f[b]=m);for(;l<i;++l)a[l]=n[l];return new On(a,this._parents)}function pN(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function mN(t){t||(t=gN);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,l=i[s]=new Array(a),c,d=0;d<a;++d)(c=o[d])&&(l[d]=c);l.sort(e)}return new On(i,this._parents).order()}function gN(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function yN(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function vN(){return Array.from(this)}function _N(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function wN(){let t=0;for(const e of this)++t;return t}function xN(){return!this.node()}function EN(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function bN(t){return function(){this.removeAttribute(t)}}function IN(t){return function(){this.removeAttributeNS(t.space,t.local)}}function TN(t,e){return function(){this.setAttribute(t,e)}}function SN(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function CN(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function AN(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function kN(t,e){var n=af(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?IN:bN:typeof e=="function"?n.local?AN:CN:n.local?SN:TN)(n,e))}function aI(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function RN(t){return function(){this.style.removeProperty(t)}}function PN(t,e,n){return function(){this.style.setProperty(t,e,n)}}function NN(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function DN(t,e,n){return arguments.length>1?this.each((e==null?RN:typeof e=="function"?NN:PN)(t,e,n??"")):Aa(this.node(),t)}function Aa(t,e){return t.style.getPropertyValue(e)||aI(t).getComputedStyle(t,null).getPropertyValue(e)}function VN(t){return function(){delete this[t]}}function ON(t,e){return function(){this[t]=e}}function zN(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function LN(t,e){return arguments.length>1?this.each((e==null?VN:typeof e=="function"?zN:ON)(t,e)):this.node()[t]}function lI(t){return t.trim().split(/^|\s+/)}function S0(t){return t.classList||new cI(t)}function cI(t){this._node=t,this._names=lI(t.getAttribute("class")||"")}cI.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function uI(t,e){for(var n=S0(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function dI(t,e){for(var n=S0(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function MN(t){return function(){uI(this,t)}}function jN(t){return function(){dI(this,t)}}function FN(t,e){return function(){(e.apply(this,arguments)?uI:dI)(this,t)}}function $N(t,e){var n=lI(t+"");if(arguments.length<2){for(var r=S0(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?FN:e?MN:jN)(n,e))}function UN(){this.textContent=""}function BN(t){return function(){this.textContent=t}}function HN(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function qN(t){return arguments.length?this.each(t==null?UN:(typeof t=="function"?HN:BN)(t)):this.node().textContent}function KN(){this.innerHTML=""}function GN(t){return function(){this.innerHTML=t}}function WN(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function QN(t){return arguments.length?this.each(t==null?KN:(typeof t=="function"?WN:GN)(t)):this.node().innerHTML}function YN(){this.nextSibling&&this.parentNode.appendChild(this)}function XN(){return this.each(YN)}function JN(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function ZN(){return this.each(JN)}function eD(t){var e=typeof t=="function"?t:nI(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function tD(){return null}function nD(t,e){var n=typeof t=="function"?t:nI(t),r=e==null?tD:typeof e=="function"?e:T0(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function rD(){var t=this.parentNode;t&&t.removeChild(this)}function iD(){return this.each(rD)}function sD(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function oD(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function aD(t){return this.select(t?oD:sD)}function lD(t){return arguments.length?this.property("__data__",t):this.node().__data__}function cD(t){return function(e){t.call(this,e,this.__data__)}}function uD(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function dD(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function hD(t,e,n){return function(){var r=this.__on,i,s=cD(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function fD(t,e,n){var r=uD(t+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(i=0,d=a[l];i<s;++i)if((o=r[i]).type===d.type&&o.name===d.name)return d.value}return}for(a=e?hD:dD,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function hI(t,e,n){var r=aI(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function pD(t,e){return function(){return hI(this,t,e)}}function mD(t,e){return function(){return hI(this,t,e.apply(this,arguments))}}function gD(t,e){return this.each((typeof e=="function"?mD:pD)(t,e))}function*yD(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var fI=[null];function On(t,e){this._groups=t,this._parents=e}function nu(){return new On([[document.documentElement]],fI)}function vD(){return this}On.prototype=nu.prototype={constructor:On,select:HP,selectAll:WP,selectChild:JP,selectChildren:nN,filter:rN,data:cN,enter:iN,exit:dN,join:hN,merge:fN,selection:vD,order:pN,sort:mN,call:yN,nodes:vN,node:_N,size:wN,empty:xN,each:EN,attr:kN,style:DN,property:LN,classed:$N,text:qN,html:QN,raise:XN,lower:ZN,append:eD,insert:nD,remove:iD,clone:aD,datum:lD,on:fD,dispatch:gD,[Symbol.iterator]:yD};function An(t){return typeof t=="string"?new On([[document.querySelector(t)]],[document.documentElement]):new On([[t]],fI)}function _D(t){let e;for(;e=t.sourceEvent;)t=e;return t}function or(t,e){if(t=_D(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const wD={passive:!1},Rc={capture:!0,passive:!1};function mp(t){t.stopImmediatePropagation()}function ha(t){t.preventDefault(),t.stopImmediatePropagation()}function pI(t){var e=t.document.documentElement,n=An(t).on("dragstart.drag",ha,Rc);"onselectstart"in e?n.on("selectstart.drag",ha,Rc):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function mI(t,e){var n=t.document.documentElement,r=An(t).on("dragstart.drag",null);e&&(r.on("click.drag",ha,Rc),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const qu=t=>()=>t;function Mm(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}Mm.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function xD(t){return!t.ctrlKey&&!t.button}function ED(){return this.parentNode}function bD(t,e){return e??{x:t.x,y:t.y}}function ID(){return navigator.maxTouchPoints||"ontouchstart"in this}function gI(){var t=xD,e=ED,n=bD,r=ID,i={},s=of("start","drag","end"),o=0,a,l,c,d,h=0;function f(A){A.on("mousedown.drag",m).filter(r).on("touchstart.drag",R).on("touchmove.drag",y,wD).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(A,O){if(!(d||!t.call(this,A,O))){var L=T(this,e.call(this,A,O),A,O,"mouse");L&&(An(A.view).on("mousemove.drag",b,Rc).on("mouseup.drag",x,Rc),pI(A.view),mp(A),c=!1,a=A.clientX,l=A.clientY,L("start",A))}}function b(A){if(ha(A),!c){var O=A.clientX-a,L=A.clientY-l;c=O*O+L*L>h}i.mouse("drag",A)}function x(A){An(A.view).on("mousemove.drag mouseup.drag",null),mI(A.view,c),ha(A),i.mouse("end",A)}function R(A,O){if(t.call(this,A,O)){var L=A.changedTouches,S=e.call(this,A,O),I=L.length,w,E;for(w=0;w<I;++w)(E=T(this,S,A,O,L[w].identifier,L[w]))&&(mp(A),E("start",A,L[w]))}}function y(A){var O=A.changedTouches,L=O.length,S,I;for(S=0;S<L;++S)(I=i[O[S].identifier])&&(ha(A),I("drag",A,O[S]))}function v(A){var O=A.changedTouches,L=O.length,S,I;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),S=0;S<L;++S)(I=i[O[S].identifier])&&(mp(A),I("end",A,O[S]))}function T(A,O,L,S,I,w){var E=s.copy(),C=or(w||L,O),P,k,N;if((N=n.call(A,new Mm("beforestart",{sourceEvent:L,target:f,identifier:I,active:o,x:C[0],y:C[1],dx:0,dy:0,dispatch:E}),S))!=null)return P=N.x-C[0]||0,k=N.y-C[1]||0,function j(z,B,F){var M=C,U;switch(z){case"start":i[I]=j,U=o++;break;case"end":delete i[I],--o;case"drag":C=or(F||B,O),U=o;break}E.call(z,A,new Mm(z,{sourceEvent:B,subject:N,target:f,identifier:I,active:U,x:C[0]+P,y:C[1]+k,dx:C[0]-M[0],dy:C[1]-M[1],dispatch:E}),S)}}return f.filter=function(A){return arguments.length?(t=typeof A=="function"?A:qu(!!A),f):t},f.container=function(A){return arguments.length?(e=typeof A=="function"?A:qu(A),f):e},f.subject=function(A){return arguments.length?(n=typeof A=="function"?A:qu(A),f):n},f.touchable=function(A){return arguments.length?(r=typeof A=="function"?A:qu(!!A),f):r},f.on=function(){var A=s.on.apply(s,arguments);return A===s?f:A},f.clickDistance=function(A){return arguments.length?(h=(A=+A)*A,f):Math.sqrt(h)},f}function C0(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function yI(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function ru(){}var Pc=.7,uh=1/Pc,fa="\\s*([+-]?\\d+)\\s*",Nc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ar="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",TD=/^#([0-9a-f]{3,8})$/,SD=new RegExp(`^rgb\\(${fa},${fa},${fa}\\)$`),CD=new RegExp(`^rgb\\(${Ar},${Ar},${Ar}\\)$`),AD=new RegExp(`^rgba\\(${fa},${fa},${fa},${Nc}\\)$`),kD=new RegExp(`^rgba\\(${Ar},${Ar},${Ar},${Nc}\\)$`),RD=new RegExp(`^hsl\\(${Nc},${Ar},${Ar}\\)$`),PD=new RegExp(`^hsla\\(${Nc},${Ar},${Ar},${Nc}\\)$`),K_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};C0(ru,Dc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:G_,formatHex:G_,formatHex8:ND,formatHsl:DD,formatRgb:W_,toString:W_});function G_(){return this.rgb().formatHex()}function ND(){return this.rgb().formatHex8()}function DD(){return vI(this).formatHsl()}function W_(){return this.rgb().formatRgb()}function Dc(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=TD.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Q_(e):n===3?new hn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ku(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ku(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=SD.exec(t))?new hn(e[1],e[2],e[3],1):(e=CD.exec(t))?new hn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=AD.exec(t))?Ku(e[1],e[2],e[3],e[4]):(e=kD.exec(t))?Ku(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=RD.exec(t))?J_(e[1],e[2]/100,e[3]/100,1):(e=PD.exec(t))?J_(e[1],e[2]/100,e[3]/100,e[4]):K_.hasOwnProperty(t)?Q_(K_[t]):t==="transparent"?new hn(NaN,NaN,NaN,0):null}function Q_(t){return new hn(t>>16&255,t>>8&255,t&255,1)}function Ku(t,e,n,r){return r<=0&&(t=e=n=NaN),new hn(t,e,n,r)}function VD(t){return t instanceof ru||(t=Dc(t)),t?(t=t.rgb(),new hn(t.r,t.g,t.b,t.opacity)):new hn}function jm(t,e,n,r){return arguments.length===1?VD(t):new hn(t,e,n,r??1)}function hn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}C0(hn,jm,yI(ru,{brighter(t){return t=t==null?uh:Math.pow(uh,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Pc:Math.pow(Pc,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new hn(qs(this.r),qs(this.g),qs(this.b),dh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Y_,formatHex:Y_,formatHex8:OD,formatRgb:X_,toString:X_}));function Y_(){return`#${js(this.r)}${js(this.g)}${js(this.b)}`}function OD(){return`#${js(this.r)}${js(this.g)}${js(this.b)}${js((isNaN(this.opacity)?1:this.opacity)*255)}`}function X_(){const t=dh(this.opacity);return`${t===1?"rgb(":"rgba("}${qs(this.r)}, ${qs(this.g)}, ${qs(this.b)}${t===1?")":`, ${t})`}`}function dh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function qs(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function js(t){return t=qs(t),(t<16?"0":"")+t.toString(16)}function J_(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new lr(t,e,n,r)}function vI(t){if(t instanceof lr)return new lr(t.h,t.s,t.l,t.opacity);if(t instanceof ru||(t=Dc(t)),!t)return new lr;if(t instanceof lr)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new lr(o,a,l,t.opacity)}function zD(t,e,n,r){return arguments.length===1?vI(t):new lr(t,e,n,r??1)}function lr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}C0(lr,zD,yI(ru,{brighter(t){return t=t==null?uh:Math.pow(uh,t),new lr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Pc:Math.pow(Pc,t),new lr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new hn(gp(t>=240?t-240:t+120,i,r),gp(t,i,r),gp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new lr(Z_(this.h),Gu(this.s),Gu(this.l),dh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=dh(this.opacity);return`${t===1?"hsl(":"hsla("}${Z_(this.h)}, ${Gu(this.s)*100}%, ${Gu(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Z_(t){return t=(t||0)%360,t<0?t+360:t}function Gu(t){return Math.max(0,Math.min(1,t||0))}function gp(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const _I=t=>()=>t;function LD(t,e){return function(n){return t+n*e}}function MD(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function jD(t){return(t=+t)==1?wI:function(e,n){return n-e?MD(e,n,t):_I(isNaN(e)?n:e)}}function wI(t,e){var n=e-t;return n?LD(t,n):_I(isNaN(t)?e:t)}const ew=function t(e){var n=jD(e);function r(i,s){var o=n((i=jm(i)).r,(s=jm(s)).r),a=n(i.g,s.g),l=n(i.b,s.b),c=wI(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=a(d),i.b=l(d),i.opacity=c(d),i+""}}return r.gamma=t,r}(1);function Oi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Fm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,yp=new RegExp(Fm.source,"g");function FD(t){return function(){return t}}function $D(t){return function(e){return t(e)+""}}function UD(t,e){var n=Fm.lastIndex=yp.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=Fm.exec(t))&&(i=yp.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:Oi(r,i)})),n=yp.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?$D(l[0].x):FD(e):(e=l.length,function(c){for(var d=0,h;d<e;++d)a[(h=l[d]).i]=h.x(c);return a.join("")})}var tw=180/Math.PI,$m={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function xI(t,e,n,r,i,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*tw,skewX:Math.atan(l)*tw,scaleX:o,scaleY:a}}var Wu;function BD(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?$m:xI(e.a,e.b,e.c,e.d,e.e,e.f)}function HD(t){return t==null||(Wu||(Wu=document.createElementNS("http://www.w3.org/2000/svg","g")),Wu.setAttribute("transform",t),!(t=Wu.transform.baseVal.consolidate()))?$m:(t=t.matrix,xI(t.a,t.b,t.c,t.d,t.e,t.f))}function EI(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,d,h,f,m,b){if(c!==h||d!==f){var x=m.push("translate(",null,e,null,n);b.push({i:x-4,x:Oi(c,h)},{i:x-2,x:Oi(d,f)})}else(h||f)&&m.push("translate("+h+e+f+n)}function o(c,d,h,f){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:Oi(c,d)})):d&&h.push(i(h)+"rotate("+d+r)}function a(c,d,h,f){c!==d?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:Oi(c,d)}):d&&h.push(i(h)+"skewX("+d+r)}function l(c,d,h,f,m,b){if(c!==h||d!==f){var x=m.push(i(m)+"scale(",null,",",null,")");b.push({i:x-4,x:Oi(c,h)},{i:x-2,x:Oi(d,f)})}else(h!==1||f!==1)&&m.push(i(m)+"scale("+h+","+f+")")}return function(c,d){var h=[],f=[];return c=t(c),d=t(d),s(c.translateX,c.translateY,d.translateX,d.translateY,h,f),o(c.rotate,d.rotate,h,f),a(c.skewX,d.skewX,h,f),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,h,f),c=d=null,function(m){for(var b=-1,x=f.length,R;++b<x;)h[(R=f[b]).i]=R.x(m);return h.join("")}}}var qD=EI(BD,"px, ","px)","deg)"),KD=EI(HD,", ",")",")"),GD=1e-12;function nw(t){return((t=Math.exp(t))+1/t)/2}function WD(t){return((t=Math.exp(t))-1/t)/2}function QD(t){return((t=Math.exp(2*t))-1)/(t+1)}const YD=function t(e,n,r){function i(s,o){var a=s[0],l=s[1],c=s[2],d=o[0],h=o[1],f=o[2],m=d-a,b=h-l,x=m*m+b*b,R,y;if(x<GD)y=Math.log(f/c)/e,R=function(S){return[a+S*m,l+S*b,c*Math.exp(e*S*y)]};else{var v=Math.sqrt(x),T=(f*f-c*c+r*x)/(2*c*n*v),A=(f*f-c*c-r*x)/(2*f*n*v),O=Math.log(Math.sqrt(T*T+1)-T),L=Math.log(Math.sqrt(A*A+1)-A);y=(L-O)/e,R=function(S){var I=S*y,w=nw(O),E=c/(n*v)*(w*QD(e*I+O)-WD(O));return[a+E*m,l+E*b,c*w/nw(e*I+O)]}}return R.duration=y*1e3*e/Math.SQRT2,R}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return t(o,a,l)},i}(Math.SQRT2,2,4);var ka=0,jl=0,Tl=0,bI=1e3,hh,Fl,fh=0,eo=0,lf=0,Vc=typeof performance=="object"&&performance.now?performance:Date,II=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function A0(){return eo||(II(XD),eo=Vc.now()+lf)}function XD(){eo=0}function ph(){this._call=this._time=this._next=null}ph.prototype=TI.prototype={constructor:ph,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?A0():+n)+(e==null?0:+e),!this._next&&Fl!==this&&(Fl?Fl._next=this:hh=this,Fl=this),this._call=t,this._time=n,Um()},stop:function(){this._call&&(this._call=null,this._time=1/0,Um())}};function TI(t,e,n){var r=new ph;return r.restart(t,e,n),r}function JD(){A0(),++ka;for(var t=hh,e;t;)(e=eo-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ka}function rw(){eo=(fh=Vc.now())+lf,ka=jl=0;try{JD()}finally{ka=0,eV(),eo=0}}function ZD(){var t=Vc.now(),e=t-fh;e>bI&&(lf-=e,fh=t)}function eV(){for(var t,e=hh,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:hh=n);Fl=t,Um(r)}function Um(t){if(!ka){jl&&(jl=clearTimeout(jl));var e=t-eo;e>24?(t<1/0&&(jl=setTimeout(rw,t-Vc.now()-lf)),Tl&&(Tl=clearInterval(Tl))):(Tl||(fh=Vc.now(),Tl=setInterval(ZD,bI)),ka=1,II(rw))}}function iw(t,e,n){var r=new ph;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var tV=of("start","end","cancel","interrupt"),nV=[],SI=0,sw=1,Bm=2,bd=3,ow=4,Hm=5,Id=6;function cf(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;rV(t,n,{name:e,index:r,group:i,on:tV,tween:nV,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:SI})}function k0(t,e){var n=gr(t,e);if(n.state>SI)throw new Error("too late; already scheduled");return n}function Dr(t,e){var n=gr(t,e);if(n.state>bd)throw new Error("too late; already running");return n}function gr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function rV(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=TI(s,0,n.time);function s(c){n.state=sw,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var d,h,f,m;if(n.state!==sw)return l();for(d in r)if(m=r[d],m.name===n.name){if(m.state===bd)return iw(o);m.state===ow?(m.state=Id,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[d]):+d<e&&(m.state=Id,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[d])}if(iw(function(){n.state===bd&&(n.state=ow,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=Bm,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Bm){for(n.state=bd,i=new Array(f=n.tween.length),d=0,h=-1;d<f;++d)(m=n.tween[d].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=m);i.length=h+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Hm,1),h=-1,f=i.length;++h<f;)i[h].call(t,d);n.state===Hm&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Id,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function Td(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>Bm&&r.state<Hm,r.state=Id,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function iV(t){return this.each(function(){Td(this,t)})}function sV(t,e){var n,r;return function(){var i=Dr(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function oV(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Dr(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}s.tween=i}}function aV(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=gr(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?sV:oV)(n,t,e))}function R0(t,e,n){var r=t._id;return t.each(function(){var i=Dr(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return gr(i,r).value[e]}}function CI(t,e){var n;return(typeof e=="number"?Oi:e instanceof Dc?ew:(n=Dc(e))?(e=n,ew):UD)(t,e)}function lV(t){return function(){this.removeAttribute(t)}}function cV(t){return function(){this.removeAttributeNS(t.space,t.local)}}function uV(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function dV(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function hV(t,e,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function fV(t,e,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function pV(t,e){var n=af(t),r=n==="transform"?KD:CI;return this.attrTween(t,typeof e=="function"?(n.local?fV:hV)(n,r,R0(this,"attr."+t,e)):e==null?(n.local?cV:lV)(n):(n.local?dV:uV)(n,r,e))}function mV(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function gV(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function yV(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&gV(t,s)),n}return i._value=e,i}function vV(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&mV(t,s)),n}return i._value=e,i}function _V(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=af(t);return this.tween(n,(r.local?yV:vV)(r,e))}function wV(t,e){return function(){k0(this,t).delay=+e.apply(this,arguments)}}function xV(t,e){return e=+e,function(){k0(this,t).delay=e}}function EV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?wV:xV)(e,t)):gr(this.node(),e).delay}function bV(t,e){return function(){Dr(this,t).duration=+e.apply(this,arguments)}}function IV(t,e){return e=+e,function(){Dr(this,t).duration=e}}function TV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?bV:IV)(e,t)):gr(this.node(),e).duration}function SV(t,e){if(typeof e!="function")throw new Error;return function(){Dr(this,t).ease=e}}function CV(t){var e=this._id;return arguments.length?this.each(SV(e,t)):gr(this.node(),e).ease}function AV(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Dr(this,t).ease=n}}function kV(t){if(typeof t!="function")throw new Error;return this.each(AV(this._id,t))}function RV(t){typeof t!="function"&&(t=iI(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new di(r,this._parents,this._name,this._id)}function PV(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var l=e[a],c=n[a],d=l.length,h=o[a]=new Array(d),f,m=0;m<d;++m)(f=l[m]||c[m])&&(h[m]=f);for(;a<r;++a)o[a]=e[a];return new di(o,this._parents,this._name,this._id)}function NV(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function DV(t,e,n){var r,i,s=NV(e)?k0:Dr;return function(){var o=s(this,t),a=o.on;a!==r&&(i=(r=a).copy()).on(e,n),o.on=i}}function VV(t,e){var n=this._id;return arguments.length<2?gr(this.node(),n).on.on(t):this.each(DV(n,t,e))}function OV(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function zV(){return this.on("end.remove",OV(this._id))}function LV(t){var e=this._name,n=this._id;typeof t!="function"&&(t=T0(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],l=a.length,c=s[o]=new Array(l),d,h,f=0;f<l;++f)(d=a[f])&&(h=t.call(d,d.__data__,f,a))&&("__data__"in d&&(h.__data__=d.__data__),c[f]=h,cf(c[f],e,n,f,c,gr(d,n)));return new di(s,this._parents,e,n)}function MV(t){var e=this._name,n=this._id;typeof t!="function"&&(t=rI(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l=r[a],c=l.length,d,h=0;h<c;++h)if(d=l[h]){for(var f=t.call(d,d.__data__,h,l),m,b=gr(d,n),x=0,R=f.length;x<R;++x)(m=f[x])&&cf(m,e,n,x,f,b);s.push(f),o.push(d)}return new di(s,o,e,n)}var jV=nu.prototype.constructor;function FV(){return new jV(this._groups,this._parents)}function $V(t,e){var n,r,i;return function(){var s=Aa(this,t),o=(this.style.removeProperty(t),Aa(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function AI(t){return function(){this.style.removeProperty(t)}}function UV(t,e,n){var r,i=n+"",s;return function(){var o=Aa(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function BV(t,e,n){var r,i,s;return function(){var o=Aa(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),Aa(this,t))),o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a))}}function HV(t,e){var n,r,i,s="style."+e,o="end."+s,a;return function(){var l=Dr(this,t),c=l.on,d=l.value[s]==null?a||(a=AI(e)):void 0;(c!==n||i!==d)&&(r=(n=c).copy()).on(o,i=d),l.on=r}}function qV(t,e,n){var r=(t+="")=="transform"?qD:CI;return e==null?this.styleTween(t,$V(t,r)).on("end.style."+t,AI(t)):typeof e=="function"?this.styleTween(t,BV(t,r,R0(this,"style."+t,e))).each(HV(this._id,t)):this.styleTween(t,UV(t,r,e),n).on("end.style."+t,null)}function KV(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function GV(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&KV(t,o,n)),r}return s._value=e,s}function WV(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,GV(t,e,n??""))}function QV(t){return function(){this.textContent=t}}function YV(t){return function(){var e=t(this);this.textContent=e??""}}function XV(t){return this.tween("text",typeof t=="function"?YV(R0(this,"text",t)):QV(t==null?"":t+""))}function JV(t){return function(e){this.textContent=t.call(this,e)}}function ZV(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&JV(i)),e}return r._value=t,r}function e4(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,ZV(t))}function t4(){for(var t=this._name,e=this._id,n=kI(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var d=gr(l,e);cf(l,t,n,c,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new di(r,this._parents,t,n)}function n4(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--i===0&&s()}};n.each(function(){var c=Dr(this,r),d=c.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),i===0&&s()})}var r4=0;function di(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function kI(){return++r4}var Kr=nu.prototype;di.prototype={constructor:di,select:LV,selectAll:MV,selectChild:Kr.selectChild,selectChildren:Kr.selectChildren,filter:RV,merge:PV,selection:FV,transition:t4,call:Kr.call,nodes:Kr.nodes,node:Kr.node,size:Kr.size,empty:Kr.empty,each:Kr.each,on:VV,attr:pV,attrTween:_V,style:qV,styleTween:WV,text:XV,textTween:e4,remove:zV,tween:aV,delay:EV,duration:TV,ease:CV,easeVarying:kV,end:n4,[Symbol.iterator]:Kr[Symbol.iterator]};function i4(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var s4={time:null,delay:0,duration:250,ease:i4};function o4(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function a4(t){var e,n;t instanceof di?(e=t._id,t=t._name):(e=kI(),(n=s4).time=A0(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&cf(l,t,e,c,o,n||o4(l,e));return new di(r,this._parents,t,e)}nu.prototype.interrupt=iV;nu.prototype.transition=a4;const Qu=t=>()=>t;function l4(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Zr(t,e,n){this.k=t,this.x=e,this.y=n}Zr.prototype={constructor:Zr,scale:function(t){return t===1?this:new Zr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Zr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var si=new Zr(1,0,0);Zr.prototype;function vp(t){t.stopImmediatePropagation()}function Sl(t){t.preventDefault(),t.stopImmediatePropagation()}function c4(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function u4(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function aw(){return this.__zoom||si}function d4(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function h4(){return navigator.maxTouchPoints||"ontouchstart"in this}function f4(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function RI(){var t=c4,e=u4,n=f4,r=d4,i=h4,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=YD,c=of("start","zoom","end"),d,h,f,m=500,b=150,x=0,R=10;function y(N){N.property("__zoom",aw).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",E).filter(i).on("touchstart.zoom",C).on("touchmove.zoom",P).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(N,j,z,B){var F=N.selection?N.selection():N;F.property("__zoom",aw),N!==F?O(N,j,z,B):F.interrupt().each(function(){L(this,arguments).event(B).start().zoom(null,typeof j=="function"?j.apply(this,arguments):j).end()})},y.scaleBy=function(N,j,z,B){y.scaleTo(N,function(){var F=this.__zoom.k,M=typeof j=="function"?j.apply(this,arguments):j;return F*M},z,B)},y.scaleTo=function(N,j,z,B){y.transform(N,function(){var F=e.apply(this,arguments),M=this.__zoom,U=z==null?A(F):typeof z=="function"?z.apply(this,arguments):z,G=M.invert(U),$=typeof j=="function"?j.apply(this,arguments):j;return n(T(v(M,$),U,G),F,o)},z,B)},y.translateBy=function(N,j,z,B){y.transform(N,function(){return n(this.__zoom.translate(typeof j=="function"?j.apply(this,arguments):j,typeof z=="function"?z.apply(this,arguments):z),e.apply(this,arguments),o)},null,B)},y.translateTo=function(N,j,z,B,F){y.transform(N,function(){var M=e.apply(this,arguments),U=this.__zoom,G=B==null?A(M):typeof B=="function"?B.apply(this,arguments):B;return n(si.translate(G[0],G[1]).scale(U.k).translate(typeof j=="function"?-j.apply(this,arguments):-j,typeof z=="function"?-z.apply(this,arguments):-z),M,o)},B,F)};function v(N,j){return j=Math.max(s[0],Math.min(s[1],j)),j===N.k?N:new Zr(j,N.x,N.y)}function T(N,j,z){var B=j[0]-z[0]*N.k,F=j[1]-z[1]*N.k;return B===N.x&&F===N.y?N:new Zr(N.k,B,F)}function A(N){return[(+N[0][0]+ +N[1][0])/2,(+N[0][1]+ +N[1][1])/2]}function O(N,j,z,B){N.on("start.zoom",function(){L(this,arguments).event(B).start()}).on("interrupt.zoom end.zoom",function(){L(this,arguments).event(B).end()}).tween("zoom",function(){var F=this,M=arguments,U=L(F,M).event(B),G=e.apply(F,M),$=z==null?A(G):typeof z=="function"?z.apply(F,M):z,X=Math.max(G[1][0]-G[0][0],G[1][1]-G[0][1]),Y=F.__zoom,ee=typeof j=="function"?j.apply(F,M):j,ne=l(Y.invert($).concat(X/Y.k),ee.invert($).concat(X/ee.k));return function(fe){if(fe===1)fe=ee;else{var ce=ne(fe),xe=X/ce[2];fe=new Zr(xe,$[0]-ce[0]*xe,$[1]-ce[1]*xe)}U.zoom(null,fe)}})}function L(N,j,z){return!z&&N.__zooming||new S(N,j)}function S(N,j){this.that=N,this.args=j,this.active=0,this.sourceEvent=null,this.extent=e.apply(N,j),this.taps=0}S.prototype={event:function(N){return N&&(this.sourceEvent=N),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(N,j){return this.mouse&&N!=="mouse"&&(this.mouse[1]=j.invert(this.mouse[0])),this.touch0&&N!=="touch"&&(this.touch0[1]=j.invert(this.touch0[0])),this.touch1&&N!=="touch"&&(this.touch1[1]=j.invert(this.touch1[0])),this.that.__zoom=j,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(N){var j=An(this.that).datum();c.call(N,this.that,new l4(N,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:c}),j)}};function I(N,...j){if(!t.apply(this,arguments))return;var z=L(this,j).event(N),B=this.__zoom,F=Math.max(s[0],Math.min(s[1],B.k*Math.pow(2,r.apply(this,arguments)))),M=or(N);if(z.wheel)(z.mouse[0][0]!==M[0]||z.mouse[0][1]!==M[1])&&(z.mouse[1]=B.invert(z.mouse[0]=M)),clearTimeout(z.wheel);else{if(B.k===F)return;z.mouse=[M,B.invert(M)],Td(this),z.start()}Sl(N),z.wheel=setTimeout(U,b),z.zoom("mouse",n(T(v(B,F),z.mouse[0],z.mouse[1]),z.extent,o));function U(){z.wheel=null,z.end()}}function w(N,...j){if(f||!t.apply(this,arguments))return;var z=N.currentTarget,B=L(this,j,!0).event(N),F=An(N.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",X,!0),M=or(N,z),U=N.clientX,G=N.clientY;pI(N.view),vp(N),B.mouse=[M,this.__zoom.invert(M)],Td(this),B.start();function $(Y){if(Sl(Y),!B.moved){var ee=Y.clientX-U,ne=Y.clientY-G;B.moved=ee*ee+ne*ne>x}B.event(Y).zoom("mouse",n(T(B.that.__zoom,B.mouse[0]=or(Y,z),B.mouse[1]),B.extent,o))}function X(Y){F.on("mousemove.zoom mouseup.zoom",null),mI(Y.view,B.moved),Sl(Y),B.event(Y).end()}}function E(N,...j){if(t.apply(this,arguments)){var z=this.__zoom,B=or(N.changedTouches?N.changedTouches[0]:N,this),F=z.invert(B),M=z.k*(N.shiftKey?.5:2),U=n(T(v(z,M),B,F),e.apply(this,j),o);Sl(N),a>0?An(this).transition().duration(a).call(O,U,B,N):An(this).call(y.transform,U,B,N)}}function C(N,...j){if(t.apply(this,arguments)){var z=N.touches,B=z.length,F=L(this,j,N.changedTouches.length===B).event(N),M,U,G,$;for(vp(N),U=0;U<B;++U)G=z[U],$=or(G,this),$=[$,this.__zoom.invert($),G.identifier],F.touch0?!F.touch1&&F.touch0[2]!==$[2]&&(F.touch1=$,F.taps=0):(F.touch0=$,M=!0,F.taps=1+!!d);d&&(d=clearTimeout(d)),M&&(F.taps<2&&(h=$[0],d=setTimeout(function(){d=null},m)),Td(this),F.start())}}function P(N,...j){if(this.__zooming){var z=L(this,j).event(N),B=N.changedTouches,F=B.length,M,U,G,$;for(Sl(N),M=0;M<F;++M)U=B[M],G=or(U,this),z.touch0&&z.touch0[2]===U.identifier?z.touch0[0]=G:z.touch1&&z.touch1[2]===U.identifier&&(z.touch1[0]=G);if(U=z.that.__zoom,z.touch1){var X=z.touch0[0],Y=z.touch0[1],ee=z.touch1[0],ne=z.touch1[1],fe=(fe=ee[0]-X[0])*fe+(fe=ee[1]-X[1])*fe,ce=(ce=ne[0]-Y[0])*ce+(ce=ne[1]-Y[1])*ce;U=v(U,Math.sqrt(fe/ce)),G=[(X[0]+ee[0])/2,(X[1]+ee[1])/2],$=[(Y[0]+ne[0])/2,(Y[1]+ne[1])/2]}else if(z.touch0)G=z.touch0[0],$=z.touch0[1];else return;z.zoom("touch",n(T(U,G,$),z.extent,o))}}function k(N,...j){if(this.__zooming){var z=L(this,j).event(N),B=N.changedTouches,F=B.length,M,U;for(vp(N),f&&clearTimeout(f),f=setTimeout(function(){f=null},m),M=0;M<F;++M)U=B[M],z.touch0&&z.touch0[2]===U.identifier?delete z.touch0:z.touch1&&z.touch1[2]===U.identifier&&delete z.touch1;if(z.touch1&&!z.touch0&&(z.touch0=z.touch1,delete z.touch1),z.touch0)z.touch0[1]=this.__zoom.invert(z.touch0[0]);else if(z.end(),z.taps===2&&(U=or(U,this),Math.hypot(h[0]-U[0],h[1]-U[1])<R)){var G=An(this).on("dblclick.zoom");G&&G.apply(this,arguments)}}}return y.wheelDelta=function(N){return arguments.length?(r=typeof N=="function"?N:Qu(+N),y):r},y.filter=function(N){return arguments.length?(t=typeof N=="function"?N:Qu(!!N),y):t},y.touchable=function(N){return arguments.length?(i=typeof N=="function"?N:Qu(!!N),y):i},y.extent=function(N){return arguments.length?(e=typeof N=="function"?N:Qu([[+N[0][0],+N[0][1]],[+N[1][0],+N[1][1]]]),y):e},y.scaleExtent=function(N){return arguments.length?(s[0]=+N[0],s[1]=+N[1],y):[s[0],s[1]]},y.translateExtent=function(N){return arguments.length?(o[0][0]=+N[0][0],o[1][0]=+N[1][0],o[0][1]=+N[0][1],o[1][1]=+N[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(N){return arguments.length?(n=N,y):n},y.duration=function(N){return arguments.length?(a=+N,y):a},y.interpolate=function(N){return arguments.length?(l=N,y):l},y.on=function(){var N=c.on.apply(c,arguments);return N===c?y:N},y.clickDistance=function(N){return arguments.length?(x=(N=+N)*N,y):Math.sqrt(x)},y.tapDistance=function(N){return arguments.length?(R=+N,y):R},y}const uf=D.createContext(null),p4=uf.Provider,hi={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,e)=>`Couldn't create edge for ${t?"target":"source"} handle id: "${t?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},PI=hi.error001();function Be(t,e){const n=D.useContext(uf);if(n===null)throw new Error(PI);return tI(n,t,e)}const vt=()=>{const t=D.useContext(uf);if(t===null)throw new Error(PI);return D.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},m4=t=>t.userSelectionActive?"none":"all";function P0({position:t,children:e,className:n,style:r,...i}){const s=Be(m4),o=`${t}`.split("-");return K.createElement("div",{className:Dt(["react-flow__panel",n,...o]),style:{...r,pointerEvents:s},...i},e)}function g4({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:K.createElement(P0,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},K.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const y4=({x:t,y:e,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d})=>{const h=D.useRef(null),[f,m]=D.useState({x:0,y:0,width:0,height:0}),b=Dt(["react-flow__edge-textwrapper",c]);return D.useEffect(()=>{if(h.current){const x=h.current.getBBox();m({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),typeof n>"u"||!n?null:K.createElement("g",{transform:`translate(${t-f.width/2} ${e-f.height/2})`,className:b,visibility:f.width?"visible":"hidden",...d},i&&K.createElement("rect",{width:f.width+2*o[0],x:-o[0],y:-o[1],height:f.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),K.createElement("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:h,style:r},n),l)};var v4=D.memo(y4);const N0=t=>({width:t.offsetWidth,height:t.offsetHeight}),cs=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),D0=(t={x:0,y:0},e)=>({x:cs(t.x,e[0][0],e[1][0]),y:cs(t.y,e[0][1],e[1][1])}),lw=(t,e,n)=>t<e?cs(Math.abs(t-e),1,50)/50:t>n?-cs(Math.abs(t-n),1,50)/50:0,NI=(t,e)=>{const n=lw(t.x,35,e.width-35)*20,r=lw(t.y,35,e.height-35)*20;return[n,r]},DI=t=>{var e;return((e=t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},VI=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Oc=({x:t,y:e,width:n,height:r})=>({x:t,y:e,x2:t+n,y2:e+r}),OI=({x:t,y:e,x2:n,y2:r})=>({x:t,y:e,width:n-t,height:r-e}),cw=t=>({...t.positionAbsolute||{x:0,y:0},width:t.width||0,height:t.height||0}),_4=(t,e)=>OI(VI(Oc(t),Oc(e))),qm=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),r=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*r)},w4=t=>Bn(t.width)&&Bn(t.height)&&Bn(t.x)&&Bn(t.y),Bn=t=>!isNaN(t)&&isFinite(t),ct=Symbol.for("internals"),zI=["Enter"," ","Escape"],x4=(t,e)=>{},E4=t=>"nativeEvent"in t;function Km(t){var i,s;const e=E4(t)?t.nativeEvent:t,n=((s=(i=e.composedPath)==null?void 0:i.call(e))==null?void 0:s[0])||t.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const LI=t=>"clientX"in t,ts=(t,e)=>{var s,o;const n=LI(t),r=n?t.clientX:(s=t.touches)==null?void 0:s[0].clientX,i=n?t.clientY:(o=t.touches)==null?void 0:o[0].clientY;return{x:r-((e==null?void 0:e.left)??0),y:i-((e==null?void 0:e.top)??0)}},mh=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0},Ka=({id:t,path:e,labelX:n,labelY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m=20})=>K.createElement(K.Fragment,null,K.createElement("path",{id:t,style:d,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:h,markerStart:f}),m&&K.createElement("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),i&&Bn(n)&&Bn(r)?K.createElement(v4,{x:n,y:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c}):null);Ka.displayName="BaseEdge";function Cl(t,e,n){return n===void 0?n:r=>{const i=e().edges.find(s=>s.id===t);i&&n(r,{...i})}}function MI({sourceX:t,sourceY:e,targetX:n,targetY:r}){const i=Math.abs(n-t)/2,s=n<t?n+i:n-i,o=Math.abs(r-e)/2,a=r<e?r+o:r-o;return[s,a,i,o]}function jI({sourceX:t,sourceY:e,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const l=t*.125+i*.375+o*.375+n*.125,c=e*.125+s*.375+a*.375+r*.125,d=Math.abs(l-t),h=Math.abs(c-e);return[l,c,d,h]}var to;(function(t){t.Strict="strict",t.Loose="loose"})(to||(to={}));var Fs;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(Fs||(Fs={}));var zc;(function(t){t.Partial="partial",t.Full="full"})(zc||(zc={}));var ji;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(ji||(ji={}));var gh;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(gh||(gh={}));var le;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(le||(le={}));function uw({pos:t,x1:e,y1:n,x2:r,y2:i}){return t===le.Left||t===le.Right?[.5*(e+r),n]:[e,.5*(n+i)]}function FI({sourceX:t,sourceY:e,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top}){const[o,a]=uw({pos:n,x1:t,y1:e,x2:r,y2:i}),[l,c]=uw({pos:s,x1:r,y1:i,x2:t,y2:e}),[d,h,f,m]=jI({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${t},${e} C${o},${a} ${l},${c} ${r},${i}`,d,h,f,m]}const V0=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:i=le.Bottom,targetPosition:s=le.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:b,interactionWidth:x})=>{const[R,y,v]=FI({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:r,targetPosition:s});return K.createElement(Ka,{path:R,labelX:y,labelY:v,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:b,interactionWidth:x})});V0.displayName="SimpleBezierEdge";const dw={[le.Left]:{x:-1,y:0},[le.Right]:{x:1,y:0},[le.Top]:{x:0,y:-1},[le.Bottom]:{x:0,y:1}},b4=({source:t,sourcePosition:e=le.Bottom,target:n})=>e===le.Left||e===le.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},hw=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function I4({source:t,sourcePosition:e=le.Bottom,target:n,targetPosition:r=le.Top,center:i,offset:s}){const o=dw[e],a=dw[r],l={x:t.x+o.x*s,y:t.y+o.y*s},c={x:n.x+a.x*s,y:n.y+a.y*s},d=b4({source:l,sourcePosition:e,target:c}),h=d.x!==0?"x":"y",f=d[h];let m=[],b,x;const R={x:0,y:0},y={x:0,y:0},[v,T,A,O]=MI({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(o[h]*a[h]===-1){b=i.x??v,x=i.y??T;const S=[{x:b,y:l.y},{x:b,y:c.y}],I=[{x:l.x,y:x},{x:c.x,y:x}];o[h]===f?m=h==="x"?S:I:m=h==="x"?I:S}else{const S=[{x:l.x,y:c.y}],I=[{x:c.x,y:l.y}];if(h==="x"?m=o.x===f?I:S:m=o.y===f?S:I,e===r){const k=Math.abs(t[h]-n[h]);if(k<=s){const N=Math.min(s-1,s-k);o[h]===f?R[h]=(l[h]>t[h]?-1:1)*N:y[h]=(c[h]>n[h]?-1:1)*N}}if(e!==r){const k=h==="x"?"y":"x",N=o[h]===a[k],j=l[k]>c[k],z=l[k]<c[k];(o[h]===1&&(!N&&j||N&&z)||o[h]!==1&&(!N&&z||N&&j))&&(m=h==="x"?S:I)}const w={x:l.x+R.x,y:l.y+R.y},E={x:c.x+y.x,y:c.y+y.y},C=Math.max(Math.abs(w.x-m[0].x),Math.abs(E.x-m[0].x)),P=Math.max(Math.abs(w.y-m[0].y),Math.abs(E.y-m[0].y));C>=P?(b=(w.x+E.x)/2,x=m[0].y):(b=m[0].x,x=(w.y+E.y)/2)}return[[t,{x:l.x+R.x,y:l.y+R.y},...m,{x:c.x+y.x,y:c.y+y.y},n],b,x,A,O]}function T4(t,e,n,r){const i=Math.min(hw(t,e)/2,hw(e,n)/2,r),{x:s,y:o}=e;if(t.x===s&&s===n.x||t.y===o&&o===n.y)return`L${s} ${o}`;if(t.y===o){const c=t.x<n.x?-1:1,d=t.y<n.y?1:-1;return`L ${s+i*c},${o}Q ${s},${o} ${s},${o+i*d}`}const a=t.x<n.x?1:-1,l=t.y<n.y?-1:1;return`L ${s},${o+i*l}Q ${s},${o} ${s+i*a},${o}`}function Lc({sourceX:t,sourceY:e,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top,borderRadius:o=5,centerX:a,centerY:l,offset:c=20}){const[d,h,f,m,b]=I4({source:{x:t,y:e},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:l},offset:c});return[d.reduce((R,y,v)=>{let T="";return v>0&&v<d.length-1?T=T4(d[v-1],y,d[v+1],o):T=`${v===0?"M":"L"}${y.x} ${y.y}`,R+=T,R},""),h,f,m,b]}const df=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,sourcePosition:h=le.Bottom,targetPosition:f=le.Top,markerEnd:m,markerStart:b,pathOptions:x,interactionWidth:R})=>{const[y,v,T]=Lc({sourceX:t,sourceY:e,sourcePosition:h,targetX:n,targetY:r,targetPosition:f,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset});return K.createElement(Ka,{path:y,labelX:v,labelY:T,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:m,markerStart:b,interactionWidth:R})});df.displayName="SmoothStepEdge";const O0=D.memo(t=>{var e;return K.createElement(df,{...t,pathOptions:D.useMemo(()=>{var n;return{borderRadius:0,offset:(n=t.pathOptions)==null?void 0:n.offset}},[(e=t.pathOptions)==null?void 0:e.offset])})});O0.displayName="StepEdge";function $I({sourceX:t,sourceY:e,targetX:n,targetY:r}){const[i,s,o,a]=MI({sourceX:t,sourceY:e,targetX:n,targetY:r});return[`M ${t},${e}L ${n},${r}`,i,s,o,a]}const z0=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m})=>{const[b,x,R]=$I({sourceX:t,sourceY:e,targetX:n,targetY:r});return K.createElement(Ka,{path:b,labelX:x,labelY:R,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m})});z0.displayName="StraightEdge";function Yu(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function fw({pos:t,x1:e,y1:n,x2:r,y2:i,c:s}){switch(t){case le.Left:return[e-Yu(e-r,s),n];case le.Right:return[e+Yu(r-e,s),n];case le.Top:return[e,n-Yu(n-i,s)];case le.Bottom:return[e,n+Yu(i-n,s)]}}function L0({sourceX:t,sourceY:e,sourcePosition:n=le.Bottom,targetX:r,targetY:i,targetPosition:s=le.Top,curvature:o=.25}){const[a,l]=fw({pos:n,x1:t,y1:e,x2:r,y2:i,c:o}),[c,d]=fw({pos:s,x1:r,y1:i,x2:t,y2:e,c:o}),[h,f,m,b]=jI({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${t},${e} C${a},${l} ${c},${d} ${r},${i}`,h,f,m,b]}const yh=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:i=le.Bottom,targetPosition:s=le.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:b,pathOptions:x,interactionWidth:R})=>{const[y,v,T]=L0({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:r,targetPosition:s,curvature:x==null?void 0:x.curvature});return K.createElement(Ka,{path:y,labelX:v,labelY:T,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:b,interactionWidth:R})});yh.displayName="BezierEdge";const M0=D.createContext(null),S4=M0.Provider;M0.Consumer;const UI=()=>D.useContext(M0),C4=t=>"id"in t&&"source"in t&&"target"in t,A4=({source:t,sourceHandle:e,target:n,targetHandle:r})=>`reactflow__edge-${t}${e||""}-${n}${r||""}`,Gm=(t,e)=>typeof t>"u"?"":typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(r=>`${r}=${t[r]}`).join("&")}`,k4=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),BI=(t,e)=>{if(!t.source||!t.target)return e;let n;return C4(t)?n={...t}:n={...t,id:A4(t)},k4(n,e)?e:e.concat(n)},Wm=({x:t,y:e},[n,r,i],s,[o,a])=>{const l={x:(t-n)/i,y:(e-r)/i};return s?{x:o*Math.round(l.x/o),y:a*Math.round(l.y/a)}:l},HI=({x:t,y:e},[n,r,i])=>({x:t*i+n,y:e*i+r}),Ks=(t,e=[0,0])=>{if(!t)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(t.width??0)*e[0],r=(t.height??0)*e[1],i={x:t.position.x-n,y:t.position.y-r};return{...i,positionAbsolute:t.positionAbsolute?{x:t.positionAbsolute.x-n,y:t.positionAbsolute.y-r}:i}},iu=(t,e=[0,0])=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((r,i)=>{const{x:s,y:o}=Ks(i,e).positionAbsolute;return VI(r,Oc({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return OI(n)},qI=(t,e,[n,r,i]=[0,0,1],s=!1,o=!1,a=[0,0])=>{const l={x:(e.x-n)/i,y:(e.y-r)/i,width:e.width/i,height:e.height/i},c=[];return t.forEach(d=>{const{width:h,height:f,selectable:m=!0,hidden:b=!1}=d;if(o&&!m||b)return!1;const{positionAbsolute:x}=Ks(d,a),R={x:x.x,y:x.y,width:h||0,height:f||0},y=qm(l,R),v=typeof h>"u"||typeof f>"u"||h===null||f===null,T=s&&y>0,A=(h||0)*(f||0);(v||T||y>=A||d.dragging)&&c.push(d)}),c},KI=(t,e)=>{const n=t.map(r=>r.id);return e.filter(r=>n.includes(r.source)||n.includes(r.target))},GI=(t,e,n,r,i,s=.1)=>{const o=e/(t.width*(1+s)),a=n/(t.height*(1+s)),l=Math.min(o,a),c=cs(l,r,i),d=t.x+t.width/2,h=t.y+t.height/2,f=e/2-d*c,m=n/2-h*c;return{x:f,y:m,zoom:c}},ks=(t,e=0)=>t.transition().duration(e);function pw(t,e,n,r){return(e[n]||[]).reduce((i,s)=>{var o,a;return`${t.id}-${s.id}-${n}`!==r&&i.push({id:s.id||null,type:n,nodeId:t.id,x:(((o=t.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((a=t.positionAbsolute)==null?void 0:a.y)??0)+s.y+s.height/2}),i},[])}function R4(t,e,n,r,i,s){const{x:o,y:a}=ts(t),c=e.elementsFromPoint(o,a).find(b=>b.classList.contains("react-flow__handle"));if(c){const b=c.getAttribute("data-nodeid");if(b){const x=j0(void 0,c),R=c.getAttribute("data-handleid"),y=s({nodeId:b,id:R,type:x});if(y){const v=i.find(T=>T.nodeId===b&&T.type===x&&T.id===R);return{handle:{id:R,type:x,nodeId:b,x:(v==null?void 0:v.x)||n.x,y:(v==null?void 0:v.y)||n.y},validHandleResult:y}}}}let d=[],h=1/0;if(i.forEach(b=>{const x=Math.sqrt((b.x-n.x)**2+(b.y-n.y)**2);if(x<=r){const R=s(b);x<=h&&(x<h?d=[{handle:b,validHandleResult:R}]:x===h&&d.push({handle:b,validHandleResult:R}),h=x)}}),!d.length)return{handle:null,validHandleResult:WI()};if(d.length===1)return d[0];const f=d.some(({validHandleResult:b})=>b.isValid),m=d.some(({handle:b})=>b.type==="target");return d.find(({handle:b,validHandleResult:x})=>m?b.type==="target":f?x.isValid:!0)||d[0]}const P4={source:null,target:null,sourceHandle:null,targetHandle:null},WI=()=>({handleDomNode:null,isValid:!1,connection:P4,endHandle:null});function QI(t,e,n,r,i,s,o){const a=i==="target",l=o.querySelector(`.react-flow__handle[data-id="${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`),c={...WI(),handleDomNode:l};if(l){const d=j0(void 0,l),h=l.getAttribute("data-nodeid"),f=l.getAttribute("data-handleid"),m=l.classList.contains("connectable"),b=l.classList.contains("connectableend"),x={source:a?h:n,sourceHandle:a?f:r,target:a?n:h,targetHandle:a?r:f};c.connection=x,m&&b&&(e===to.Strict?a&&d==="source"||!a&&d==="target":h!==n||f!==r)&&(c.endHandle={nodeId:h,handleId:f,type:d},c.isValid=s(x))}return c}function N4({nodes:t,nodeId:e,handleId:n,handleType:r}){return t.reduce((i,s)=>{if(s[ct]){const{handleBounds:o}=s[ct];let a=[],l=[];o&&(a=pw(s,o,"source",`${e}-${n}-${r}`),l=pw(s,o,"target",`${e}-${n}-${r}`)),i.push(...a,...l)}return i},[])}function j0(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function _p(t){t==null||t.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function D4(t,e){let n=null;return e?n="valid":t&&!e&&(n="invalid"),n}function YI({event:t,handleId:e,nodeId:n,onConnect:r,isTarget:i,getState:s,setState:o,isValidConnection:a,edgeUpdaterType:l,onReconnectEnd:c}){const d=DI(t.target),{connectionMode:h,domNode:f,autoPanOnConnect:m,connectionRadius:b,onConnectStart:x,panBy:R,getNodes:y,cancelConnection:v}=s();let T=0,A;const{x:O,y:L}=ts(t),S=d==null?void 0:d.elementFromPoint(O,L),I=j0(l,S),w=f==null?void 0:f.getBoundingClientRect();if(!w||!I)return;let E,C=ts(t,w),P=!1,k=null,N=!1,j=null;const z=N4({nodes:y(),nodeId:n,handleId:e,handleType:I}),B=()=>{if(!m)return;const[U,G]=NI(C,w);R({x:U,y:G}),T=requestAnimationFrame(B)};o({connectionPosition:C,connectionStatus:null,connectionNodeId:n,connectionHandleId:e,connectionHandleType:I,connectionStartHandle:{nodeId:n,handleId:e,type:I},connectionEndHandle:null}),x==null||x(t,{nodeId:n,handleId:e,handleType:I});function F(U){const{transform:G}=s();C=ts(U,w);const{handle:$,validHandleResult:X}=R4(U,d,Wm(C,G,!1,[1,1]),b,z,Y=>QI(Y,h,n,e,i?"target":"source",a,d));if(A=$,P||(B(),P=!0),j=X.handleDomNode,k=X.connection,N=X.isValid,o({connectionPosition:A&&N?HI({x:A.x,y:A.y},G):C,connectionStatus:D4(!!A,N),connectionEndHandle:X.endHandle}),!A&&!N&&!j)return _p(E);k.source!==k.target&&j&&(_p(E),E=j,j.classList.add("connecting","react-flow__handle-connecting"),j.classList.toggle("valid",N),j.classList.toggle("react-flow__handle-valid",N))}function M(U){var G,$;(A||j)&&k&&N&&(r==null||r(k)),($=(G=s()).onConnectEnd)==null||$.call(G,U),l&&(c==null||c(U)),_p(E),v(),cancelAnimationFrame(T),P=!1,N=!1,k=null,j=null,d.removeEventListener("mousemove",F),d.removeEventListener("mouseup",M),d.removeEventListener("touchmove",F),d.removeEventListener("touchend",M)}d.addEventListener("mousemove",F),d.addEventListener("mouseup",M),d.addEventListener("touchmove",F),d.addEventListener("touchend",M)}const mw=()=>!0,V4=t=>({connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName}),O4=(t,e,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=r;return{connecting:(i==null?void 0:i.nodeId)===t&&(i==null?void 0:i.handleId)===e&&(i==null?void 0:i.type)===n||(s==null?void 0:s.nodeId)===t&&(s==null?void 0:s.handleId)===e&&(s==null?void 0:s.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===t&&(o==null?void 0:o.handleId)===e&&(o==null?void 0:o.type)===n}},XI=D.forwardRef(({type:t="source",position:e=le.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:h,...f},m)=>{var w,E;const b=o||null,x=t==="target",R=vt(),y=UI(),{connectOnClick:v,noPanClassName:T}=Be(V4,Pt),{connecting:A,clickConnecting:O}=Be(O4(y,b,t),Pt);y||(E=(w=R.getState()).onError)==null||E.call(w,"010",hi.error010());const L=C=>{const{defaultEdgeOptions:P,onConnect:k,hasDefaultEdges:N}=R.getState(),j={...P,...C};if(N){const{edges:z,setEdges:B}=R.getState();B(BI(j,z))}k==null||k(j),a==null||a(j)},S=C=>{if(!y)return;const P=LI(C);i&&(P&&C.button===0||!P)&&YI({event:C,handleId:b,nodeId:y,onConnect:L,isTarget:x,getState:R.getState,setState:R.setState,isValidConnection:n||R.getState().isValidConnection||mw}),P?d==null||d(C):h==null||h(C)},I=C=>{const{onClickConnectStart:P,onClickConnectEnd:k,connectionClickStartHandle:N,connectionMode:j,isValidConnection:z}=R.getState();if(!y||!N&&!i)return;if(!N){P==null||P(C,{nodeId:y,handleId:b,handleType:t}),R.setState({connectionClickStartHandle:{nodeId:y,type:t,handleId:b}});return}const B=DI(C.target),F=n||z||mw,{connection:M,isValid:U}=QI({nodeId:y,id:b,type:t},j,N.nodeId,N.handleId||null,N.type,F,B);U&&L(M),k==null||k(C),R.setState({connectionClickStartHandle:null})};return K.createElement("div",{"data-handleid":b,"data-nodeid":y,"data-handlepos":e,"data-id":`${y}-${b}-${t}`,className:Dt(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",T,c,{source:!x,target:x,connectable:r,connectablestart:i,connectableend:s,connecting:O,connectionindicator:r&&(i&&!A||s&&A)}]),onMouseDown:S,onTouchStart:S,onClick:v?I:void 0,ref:m,...f},l)});XI.displayName="Handle";var wn=D.memo(XI);const JI=({data:t,isConnectable:e,targetPosition:n=le.Top,sourcePosition:r=le.Bottom})=>K.createElement(K.Fragment,null,K.createElement(wn,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label,K.createElement(wn,{type:"source",position:r,isConnectable:e}));JI.displayName="DefaultNode";var Qm=D.memo(JI);const ZI=({data:t,isConnectable:e,sourcePosition:n=le.Bottom})=>K.createElement(K.Fragment,null,t==null?void 0:t.label,K.createElement(wn,{type:"source",position:n,isConnectable:e}));ZI.displayName="InputNode";var eT=D.memo(ZI);const tT=({data:t,isConnectable:e,targetPosition:n=le.Top})=>K.createElement(K.Fragment,null,K.createElement(wn,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label);tT.displayName="OutputNode";var nT=D.memo(tT);const F0=()=>null;F0.displayName="GroupNode";const z4=t=>({selectedNodes:t.getNodes().filter(e=>e.selected),selectedEdges:t.edges.filter(e=>e.selected).map(e=>({...e}))}),Xu=t=>t.id;function L4(t,e){return Pt(t.selectedNodes.map(Xu),e.selectedNodes.map(Xu))&&Pt(t.selectedEdges.map(Xu),e.selectedEdges.map(Xu))}const rT=D.memo(({onSelectionChange:t})=>{const e=vt(),{selectedNodes:n,selectedEdges:r}=Be(z4,L4);return D.useEffect(()=>{const i={nodes:n,edges:r};t==null||t(i),e.getState().onSelectionChange.forEach(s=>s(i))},[n,r,t]),null});rT.displayName="SelectionListener";const M4=t=>!!t.onSelectionChange;function j4({onSelectionChange:t}){const e=Be(M4);return t||e?K.createElement(rT,{onSelectionChange:t}):null}const F4=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset});function Po(t,e){D.useEffect(()=>{typeof t<"u"&&e(t)},[t])}function Ee(t,e,n){D.useEffect(()=>{typeof e<"u"&&n({[t]:e})},[e])}const $4=({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:c,nodesConnectable:d,nodesFocusable:h,edgesFocusable:f,edgesUpdatable:m,elevateNodesOnSelect:b,minZoom:x,maxZoom:R,nodeExtent:y,onNodesChange:v,onEdgesChange:T,elementsSelectable:A,connectionMode:O,snapGrid:L,snapToGrid:S,translateExtent:I,connectOnClick:w,defaultEdgeOptions:E,fitView:C,fitViewOptions:P,onNodesDelete:k,onEdgesDelete:N,onNodeDrag:j,onNodeDragStart:z,onNodeDragStop:B,onSelectionDrag:F,onSelectionDragStart:M,onSelectionDragStop:U,noPanClassName:G,nodeOrigin:$,rfId:X,autoPanOnConnect:Y,autoPanOnNodeDrag:ee,onError:ne,connectionRadius:fe,isValidConnection:ce,nodeDragThreshold:xe})=>{const{setNodes:ye,setEdges:ke,setDefaultNodesAndEdges:Re,setMinZoom:He,setMaxZoom:Oe,setTranslateExtent:Pe,setNodeExtent:ut,reset:Se}=Be(F4,Pt),se=vt();return D.useEffect(()=>{const Ce=r==null?void 0:r.map(Tt=>({...Tt,...E}));return Re(n,Ce),()=>{Se()}},[]),Ee("defaultEdgeOptions",E,se.setState),Ee("connectionMode",O,se.setState),Ee("onConnect",i,se.setState),Ee("onConnectStart",s,se.setState),Ee("onConnectEnd",o,se.setState),Ee("onClickConnectStart",a,se.setState),Ee("onClickConnectEnd",l,se.setState),Ee("nodesDraggable",c,se.setState),Ee("nodesConnectable",d,se.setState),Ee("nodesFocusable",h,se.setState),Ee("edgesFocusable",f,se.setState),Ee("edgesUpdatable",m,se.setState),Ee("elementsSelectable",A,se.setState),Ee("elevateNodesOnSelect",b,se.setState),Ee("snapToGrid",S,se.setState),Ee("snapGrid",L,se.setState),Ee("onNodesChange",v,se.setState),Ee("onEdgesChange",T,se.setState),Ee("connectOnClick",w,se.setState),Ee("fitViewOnInit",C,se.setState),Ee("fitViewOnInitOptions",P,se.setState),Ee("onNodesDelete",k,se.setState),Ee("onEdgesDelete",N,se.setState),Ee("onNodeDrag",j,se.setState),Ee("onNodeDragStart",z,se.setState),Ee("onNodeDragStop",B,se.setState),Ee("onSelectionDrag",F,se.setState),Ee("onSelectionDragStart",M,se.setState),Ee("onSelectionDragStop",U,se.setState),Ee("noPanClassName",G,se.setState),Ee("nodeOrigin",$,se.setState),Ee("rfId",X,se.setState),Ee("autoPanOnConnect",Y,se.setState),Ee("autoPanOnNodeDrag",ee,se.setState),Ee("onError",ne,se.setState),Ee("connectionRadius",fe,se.setState),Ee("isValidConnection",ce,se.setState),Ee("nodeDragThreshold",xe,se.setState),Po(t,ye),Po(e,ke),Po(x,He),Po(R,Oe),Po(I,Pe),Po(y,ut),null},gw={display:"none"},U4={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},iT="react-flow__node-desc",sT="react-flow__edge-desc",B4="react-flow__aria-live",H4=t=>t.ariaLiveMessage;function q4({rfId:t}){const e=Be(H4);return K.createElement("div",{id:`${B4}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:U4},e)}function K4({rfId:t,disableKeyboardA11y:e}){return K.createElement(K.Fragment,null,K.createElement("div",{id:`${iT}-${t}`,style:gw},"Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),K.createElement("div",{id:`${sT}-${t}`,style:gw},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!e&&K.createElement(q4,{rfId:t}))}var Mc=(t=null,e={actInsideInputWithModifier:!0})=>{const[n,r]=D.useState(!1),i=D.useRef(!1),s=D.useRef(new Set([])),[o,a]=D.useMemo(()=>{if(t!==null){const c=(Array.isArray(t)?t:[t]).filter(h=>typeof h=="string").map(h=>h.split("+")),d=c.reduce((h,f)=>h.concat(...f),[]);return[c,d]}return[[],[]]},[t]);return D.useEffect(()=>{const l=typeof document<"u"?document:null,c=(e==null?void 0:e.target)||l;if(t!==null){const d=m=>{if(i.current=m.ctrlKey||m.metaKey||m.shiftKey,(!i.current||i.current&&!e.actInsideInputWithModifier)&&Km(m))return!1;const x=vw(m.code,a);s.current.add(m[x]),yw(o,s.current,!1)&&(m.preventDefault(),r(!0))},h=m=>{if((!i.current||i.current&&!e.actInsideInputWithModifier)&&Km(m))return!1;const x=vw(m.code,a);yw(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(m[x]),m.key==="Meta"&&s.current.clear(),i.current=!1},f=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",d),c==null||c.addEventListener("keyup",h),window.addEventListener("blur",f),()=>{c==null||c.removeEventListener("keydown",d),c==null||c.removeEventListener("keyup",h),window.removeEventListener("blur",f)}}},[t,r]),n};function yw(t,e,n){return t.filter(r=>n||r.length===e.size).some(r=>r.every(i=>e.has(i)))}function vw(t,e){return e.includes(t)?"code":"key"}function oT(t,e,n,r){var a,l;const i=t.parentNode||t.parentId;if(!i)return n;const s=e.get(i),o=Ks(s,r);return oT(s,e,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((a=s[ct])==null?void 0:a.z)??0)>(n.z??0)?((l=s[ct])==null?void 0:l.z)??0:n.z??0},r)}function aT(t,e,n){t.forEach(r=>{var s;const i=r.parentNode||r.parentId;if(i&&!t.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:o,y:a,z:l}=oT(r,t,{...r.position,z:((s=r[ct])==null?void 0:s.z)??0},e);r.positionAbsolute={x:o,y:a},r[ct].z=l,n!=null&&n[r.id]&&(r[ct].isParent=!0)}})}function wp(t,e,n,r){const i=new Map,s={},o=r?1e3:0;return t.forEach(a=>{var m;const l=(Bn(a.zIndex)?a.zIndex:0)+(a.selected?o:0),c=e.get(a.id),d={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},h=a.parentNode||a.parentId;h&&(s[h]=!0);const f=(c==null?void 0:c.type)&&(c==null?void 0:c.type)!==a.type;Object.defineProperty(d,ct,{enumerable:!1,value:{handleBounds:f||(m=c==null?void 0:c[ct])==null?void 0:m.handleBounds,z:l}}),i.set(a.id,d)}),aT(i,n,s),i}function lT(t,e={}){const{getNodes:n,width:r,height:i,minZoom:s,maxZoom:o,d3Zoom:a,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:h}=t(),f=e.initial&&!c&&d;if(a&&l&&(f||!e.initial)){const b=n().filter(R=>{var v;const y=e.includeHiddenNodes?R.width&&R.height:!R.hidden;return(v=e.nodes)!=null&&v.length?y&&e.nodes.some(T=>T.id===R.id):y}),x=b.every(R=>R.width&&R.height);if(b.length>0&&x){const R=iu(b,h),{x:y,y:v,zoom:T}=GI(R,r,i,e.minZoom??s,e.maxZoom??o,e.padding??.1),A=si.translate(y,v).scale(T);return typeof e.duration=="number"&&e.duration>0?a.transform(ks(l,e.duration),A):a.transform(l,A),!0}}return!1}function G4(t,e){return t.forEach(n=>{const r=e.get(n.id);r&&e.set(r.id,{...r,[ct]:r[ct],selected:n.selected})}),new Map(e)}function W4(t,e){return e.map(n=>{const r=t.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function Ju({changedNodes:t,changedEdges:e,get:n,set:r}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:c}=n();t!=null&&t.length&&(l&&r({nodeInternals:G4(t,i)}),o==null||o(t)),e!=null&&e.length&&(c&&r({edges:W4(e,s)}),a==null||a(e))}const No=()=>{},Q4={zoomIn:No,zoomOut:No,zoomTo:No,getZoom:()=>1,setViewport:No,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:No,fitBounds:No,project:t=>t,screenToFlowPosition:t=>t,flowToScreenPosition:t=>t,viewportInitialized:!1},Y4=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}),X4=()=>{const t=vt(),{d3Zoom:e,d3Selection:n}=Be(Y4,Pt);return D.useMemo(()=>n&&e?{zoomIn:i=>e.scaleBy(ks(n,i==null?void 0:i.duration),1.2),zoomOut:i=>e.scaleBy(ks(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>e.scaleTo(ks(n,s==null?void 0:s.duration),i),getZoom:()=>t.getState().transform[2],setViewport:(i,s)=>{const[o,a,l]=t.getState().transform,c=si.translate(i.x??o,i.y??a).scale(i.zoom??l);e.transform(ks(n,s==null?void 0:s.duration),c)},getViewport:()=>{const[i,s,o]=t.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>lT(t.getState,i),setCenter:(i,s,o)=>{const{width:a,height:l,maxZoom:c}=t.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:c,h=a/2-i*d,f=l/2-s*d,m=si.translate(h,f).scale(d);e.transform(ks(n,o==null?void 0:o.duration),m)},fitBounds:(i,s)=>{const{width:o,height:a,minZoom:l,maxZoom:c}=t.getState(),{x:d,y:h,zoom:f}=GI(i,o,a,l,c,(s==null?void 0:s.padding)??.1),m=si.translate(d,h).scale(f);e.transform(ks(n,s==null?void 0:s.duration),m)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:a}=t.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Wm(i,s,o,a)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:a,domNode:l}=t.getState();if(!l)return i;const{x:c,y:d}=l.getBoundingClientRect(),h={x:i.x-c,y:i.y-d};return Wm(h,s,o,a)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=t.getState();if(!o)return i;const{x:a,y:l}=o.getBoundingClientRect(),c=HI(i,s);return{x:c.x+a,y:c.y+l}},viewportInitialized:!0}:Q4,[e,n])};function Vr(){const t=X4(),e=vt(),n=D.useCallback(()=>e.getState().getNodes().map(x=>({...x})),[]),r=D.useCallback(x=>e.getState().nodeInternals.get(x),[]),i=D.useCallback(()=>{const{edges:x=[]}=e.getState();return x.map(R=>({...R}))},[]),s=D.useCallback(x=>{const{edges:R=[]}=e.getState();return R.find(y=>y.id===x)},[]),o=D.useCallback(x=>{const{getNodes:R,setNodes:y,hasDefaultNodes:v,onNodesChange:T}=e.getState(),A=R(),O=typeof x=="function"?x(A):x;if(v)y(O);else if(T){const L=O.length===0?A.map(S=>({type:"remove",id:S.id})):O.map(S=>({item:S,type:"reset"}));T(L)}},[]),a=D.useCallback(x=>{const{edges:R=[],setEdges:y,hasDefaultEdges:v,onEdgesChange:T}=e.getState(),A=typeof x=="function"?x(R):x;if(v)y(A);else if(T){const O=A.length===0?R.map(L=>({type:"remove",id:L.id})):A.map(L=>({item:L,type:"reset"}));T(O)}},[]),l=D.useCallback(x=>{const R=Array.isArray(x)?x:[x],{getNodes:y,setNodes:v,hasDefaultNodes:T,onNodesChange:A}=e.getState();if(T){const L=[...y(),...R];v(L)}else if(A){const O=R.map(L=>({item:L,type:"add"}));A(O)}},[]),c=D.useCallback(x=>{const R=Array.isArray(x)?x:[x],{edges:y=[],setEdges:v,hasDefaultEdges:T,onEdgesChange:A}=e.getState();if(T)v([...y,...R]);else if(A){const O=R.map(L=>({item:L,type:"add"}));A(O)}},[]),d=D.useCallback(()=>{const{getNodes:x,edges:R=[],transform:y}=e.getState(),[v,T,A]=y;return{nodes:x().map(O=>({...O})),edges:R.map(O=>({...O})),viewport:{x:v,y:T,zoom:A}}},[]),h=D.useCallback(({nodes:x,edges:R})=>{const{nodeInternals:y,getNodes:v,edges:T,hasDefaultNodes:A,hasDefaultEdges:O,onNodesDelete:L,onEdgesDelete:S,onNodesChange:I,onEdgesChange:w}=e.getState(),E=(x||[]).map(j=>j.id),C=(R||[]).map(j=>j.id),P=v().reduce((j,z)=>{const B=z.parentNode||z.parentId,F=!E.includes(z.id)&&B&&j.find(U=>U.id===B);return(typeof z.deletable=="boolean"?z.deletable:!0)&&(E.includes(z.id)||F)&&j.push(z),j},[]),k=T.filter(j=>typeof j.deletable=="boolean"?j.deletable:!0),N=k.filter(j=>C.includes(j.id));if(P||N){const j=KI(P,k),z=[...N,...j],B=z.reduce((F,M)=>(F.includes(M.id)||F.push(M.id),F),[]);if((O||A)&&(O&&e.setState({edges:T.filter(F=>!B.includes(F.id))}),A&&(P.forEach(F=>{y.delete(F.id)}),e.setState({nodeInternals:new Map(y)}))),B.length>0&&(S==null||S(z),w&&w(B.map(F=>({id:F,type:"remove"})))),P.length>0&&(L==null||L(P),I)){const F=P.map(M=>({id:M.id,type:"remove"}));I(F)}}},[]),f=D.useCallback(x=>{const R=w4(x),y=R?null:e.getState().nodeInternals.get(x.id);return!R&&!y?[null,null,R]:[R?x:cw(y),y,R]},[]),m=D.useCallback((x,R=!0,y)=>{const[v,T,A]=f(x);return v?(y||e.getState().getNodes()).filter(O=>{if(!A&&(O.id===T.id||!O.positionAbsolute))return!1;const L=cw(O),S=qm(L,v);return R&&S>0||S>=v.width*v.height}):[]},[]),b=D.useCallback((x,R,y=!0)=>{const[v]=f(x);if(!v)return!1;const T=qm(v,R);return y&&T>0||T>=v.width*v.height},[]);return D.useMemo(()=>({...t,getNodes:n,getNode:r,getEdges:i,getEdge:s,setNodes:o,setEdges:a,addNodes:l,addEdges:c,toObject:d,deleteElements:h,getIntersectingNodes:m,isNodeIntersecting:b}),[t,n,r,i,s,o,a,l,c,d,h,m,b])}const J4={actInsideInputWithModifier:!1};var Z4=({deleteKeyCode:t,multiSelectionKeyCode:e})=>{const n=vt(),{deleteElements:r}=Vr(),i=Mc(t,J4),s=Mc(e);D.useEffect(()=>{if(i){const{edges:o,getNodes:a}=n.getState(),l=a().filter(d=>d.selected),c=o.filter(d=>d.selected);r({nodes:l,edges:c}),n.setState({nodesSelectionActive:!1})}},[i]),D.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function e5(t){const e=vt();D.useEffect(()=>{let n;const r=()=>{var s,o;if(!t.current)return;const i=N0(t.current);(i.height===0||i.width===0)&&((o=(s=e.getState()).onError)==null||o.call(s,"004",hi.error004())),e.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),t.current&&(n=new ResizeObserver(()=>r()),n.observe(t.current)),()=>{window.removeEventListener("resize",r),n&&t.current&&n.unobserve(t.current)}},[])}const $0={position:"absolute",width:"100%",height:"100%",top:0,left:0},t5=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,Zu=t=>({x:t.x,y:t.y,zoom:t.k}),Do=(t,e)=>t.target.closest(`.${e}`),_w=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),ww=t=>{const e=t.ctrlKey&&mh()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e},n5=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler,userSelectionActive:t.userSelectionActive}),r5=({onMove:t,onMoveStart:e,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=Fs.Free,zoomOnDoubleClick:c=!0,elementsSelectable:d,panOnDrag:h=!0,defaultViewport:f,translateExtent:m,minZoom:b,maxZoom:x,zoomActivationKeyCode:R,preventScrolling:y=!0,children:v,noWheelClassName:T,noPanClassName:A})=>{const O=D.useRef(),L=vt(),S=D.useRef(!1),I=D.useRef(!1),w=D.useRef(null),E=D.useRef({x:0,y:0,zoom:0}),{d3Zoom:C,d3Selection:P,d3ZoomHandler:k,userSelectionActive:N}=Be(n5,Pt),j=Mc(R),z=D.useRef(0),B=D.useRef(!1),F=D.useRef();return e5(w),D.useEffect(()=>{if(w.current){const M=w.current.getBoundingClientRect(),U=RI().scaleExtent([b,x]).translateExtent(m),G=An(w.current).call(U),$=si.translate(f.x,f.y).scale(cs(f.zoom,b,x)),X=[[0,0],[M.width,M.height]],Y=U.constrain()($,X,m);U.transform(G,Y),U.wheelDelta(ww),L.setState({d3Zoom:U,d3Selection:G,d3ZoomHandler:G.on("wheel.zoom"),transform:[Y.x,Y.y,Y.k],domNode:w.current.closest(".react-flow")})}},[]),D.useEffect(()=>{P&&C&&(o&&!j&&!N?P.on("wheel.zoom",M=>{if(Do(M,T))return!1;M.preventDefault(),M.stopImmediatePropagation();const U=P.property("__zoom").k||1;if(M.ctrlKey&&s){const ce=or(M),xe=ww(M),ye=U*Math.pow(2,xe);C.scaleTo(P,ye,ce,M);return}const G=M.deltaMode===1?20:1;let $=l===Fs.Vertical?0:M.deltaX*G,X=l===Fs.Horizontal?0:M.deltaY*G;!mh()&&M.shiftKey&&l!==Fs.Vertical&&($=M.deltaY*G,X=0),C.translateBy(P,-($/U)*a,-(X/U)*a,{internal:!0});const Y=Zu(P.property("__zoom")),{onViewportChangeStart:ee,onViewportChange:ne,onViewportChangeEnd:fe}=L.getState();clearTimeout(F.current),B.current||(B.current=!0,e==null||e(M,Y),ee==null||ee(Y)),B.current&&(t==null||t(M,Y),ne==null||ne(Y),F.current=setTimeout(()=>{n==null||n(M,Y),fe==null||fe(Y),B.current=!1},150))},{passive:!1}):typeof k<"u"&&P.on("wheel.zoom",function(M,U){if(!y&&M.type==="wheel"&&!M.ctrlKey||Do(M,T))return null;M.preventDefault(),k.call(this,M,U)},{passive:!1}))},[N,o,l,P,C,k,j,s,y,T,e,t,n]),D.useEffect(()=>{C&&C.on("start",M=>{var $,X;if(!M.sourceEvent||M.sourceEvent.internal)return null;z.current=($=M.sourceEvent)==null?void 0:$.button;const{onViewportChangeStart:U}=L.getState(),G=Zu(M.transform);S.current=!0,E.current=G,((X=M.sourceEvent)==null?void 0:X.type)==="mousedown"&&L.setState({paneDragging:!0}),U==null||U(G),e==null||e(M.sourceEvent,G)})},[C,e]),D.useEffect(()=>{C&&(N&&!S.current?C.on("zoom",null):N||C.on("zoom",M=>{var G;const{onViewportChange:U}=L.getState();if(L.setState({transform:[M.transform.x,M.transform.y,M.transform.k]}),I.current=!!(r&&_w(h,z.current??0)),(t||U)&&!((G=M.sourceEvent)!=null&&G.internal)){const $=Zu(M.transform);U==null||U($),t==null||t(M.sourceEvent,$)}}))},[N,C,t,h,r]),D.useEffect(()=>{C&&C.on("end",M=>{if(!M.sourceEvent||M.sourceEvent.internal)return null;const{onViewportChangeEnd:U}=L.getState();if(S.current=!1,L.setState({paneDragging:!1}),r&&_w(h,z.current??0)&&!I.current&&r(M.sourceEvent),I.current=!1,(n||U)&&t5(E.current,M.transform)){const G=Zu(M.transform);E.current=G,clearTimeout(O.current),O.current=setTimeout(()=>{U==null||U(G),n==null||n(M.sourceEvent,G)},o?150:0)}})},[C,o,h,n,r]),D.useEffect(()=>{C&&C.filter(M=>{const U=j||i,G=s&&M.ctrlKey;if((h===!0||Array.isArray(h)&&h.includes(1))&&M.button===1&&M.type==="mousedown"&&(Do(M,"react-flow__node")||Do(M,"react-flow__edge")))return!0;if(!h&&!U&&!o&&!c&&!s||N||!c&&M.type==="dblclick"||Do(M,T)&&M.type==="wheel"||Do(M,A)&&(M.type!=="wheel"||o&&M.type==="wheel"&&!j)||!s&&M.ctrlKey&&M.type==="wheel"||!U&&!o&&!G&&M.type==="wheel"||!h&&(M.type==="mousedown"||M.type==="touchstart")||Array.isArray(h)&&!h.includes(M.button)&&M.type==="mousedown")return!1;const $=Array.isArray(h)&&h.includes(M.button)||!M.button||M.button<=1;return(!M.ctrlKey||M.type==="wheel")&&$})},[N,C,i,s,o,c,h,d,j]),K.createElement("div",{className:"react-flow__renderer",ref:w,style:$0},v)},i5=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function s5(){const{userSelectionActive:t,userSelectionRect:e}=Be(i5,Pt);return t&&e?K.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function xw(t,e){const n=e.parentNode||e.parentId,r=t.find(i=>i.id===n);if(r){const i=e.position.x+e.width-r.width,s=e.position.y+e.height-r.height;if(i>0||s>0||e.position.x<0||e.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),s>0&&(r.style.height+=s),e.position.x<0){const o=Math.abs(e.position.x);r.position.x=r.position.x-o,r.style.width+=o,e.position.x=0}if(e.position.y<0){const o=Math.abs(e.position.y);r.position.y=r.position.y-o,r.style.height+=o,e.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function cT(t,e){if(t.some(r=>r.type==="reset"))return t.filter(r=>r.type==="reset").map(r=>r.item);const n=t.filter(r=>r.type==="add").map(r=>r.item);return e.reduce((r,i)=>{const s=t.filter(a=>a.id===i.id);if(s.length===0)return r.push(i),r;const o={...i};for(const a of s)if(a)switch(a.type){case"select":{o.selected=a.selected;break}case"position":{typeof a.position<"u"&&(o.position=a.position),typeof a.positionAbsolute<"u"&&(o.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(o.dragging=a.dragging),o.expandParent&&xw(r,o);break}case"dimensions":{typeof a.dimensions<"u"&&(o.width=a.dimensions.width,o.height=a.dimensions.height),typeof a.updateStyle<"u"&&(o.style={...o.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(o.resizing=a.resizing),o.expandParent&&xw(r,o);break}case"remove":return r}return r.push(o),r},n)}function uT(t,e){return cT(t,e)}function o5(t,e){return cT(t,e)}const zi=(t,e)=>({id:t,type:"select",selected:e});function sa(t,e){return t.reduce((n,r)=>{const i=e.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(zi(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(zi(r.id,!1))),n},[])}const xp=(t,e)=>n=>{n.target===e.current&&(t==null||t(n))},a5=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,dragging:t.paneDragging}),dT=D.memo(({isSelecting:t,selectionMode:e=zc.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:c,onPaneMouseLeave:d,children:h})=>{const f=D.useRef(null),m=vt(),b=D.useRef(0),x=D.useRef(0),R=D.useRef(),{userSelectionActive:y,elementsSelectable:v,dragging:T}=Be(a5,Pt),A=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),b.current=0,x.current=0},O=k=>{s==null||s(k),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},L=k=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){k.preventDefault();return}o==null||o(k)},S=a?k=>a(k):void 0,I=k=>{const{resetSelectedElements:N,domNode:j}=m.getState();if(R.current=j==null?void 0:j.getBoundingClientRect(),!v||!t||k.button!==0||k.target!==f.current||!R.current)return;const{x:z,y:B}=ts(k,R.current);N(),m.setState({userSelectionRect:{width:0,height:0,startX:z,startY:B,x:z,y:B}}),r==null||r(k)},w=k=>{const{userSelectionRect:N,nodeInternals:j,edges:z,transform:B,onNodesChange:F,onEdgesChange:M,nodeOrigin:U,getNodes:G}=m.getState();if(!t||!R.current||!N)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const $=ts(k,R.current),X=N.startX??0,Y=N.startY??0,ee={...N,x:$.x<X?$.x:X,y:$.y<Y?$.y:Y,width:Math.abs($.x-X),height:Math.abs($.y-Y)},ne=G(),fe=qI(j,ee,B,e===zc.Partial,!0,U),ce=KI(fe,z).map(ye=>ye.id),xe=fe.map(ye=>ye.id);if(b.current!==xe.length){b.current=xe.length;const ye=sa(ne,xe);ye.length&&(F==null||F(ye))}if(x.current!==ce.length){x.current=ce.length;const ye=sa(z,ce);ye.length&&(M==null||M(ye))}m.setState({userSelectionRect:ee})},E=k=>{if(k.button!==0)return;const{userSelectionRect:N}=m.getState();!y&&N&&k.target===f.current&&(O==null||O(k)),m.setState({nodesSelectionActive:b.current>0}),A(),i==null||i(k)},C=k=>{y&&(m.setState({nodesSelectionActive:b.current>0}),i==null||i(k)),A()},P=v&&(t||y);return K.createElement("div",{className:Dt(["react-flow__pane",{dragging:T,selection:t}]),onClick:P?void 0:xp(O,f),onContextMenu:xp(L,f),onWheel:xp(S,f),onMouseEnter:P?void 0:l,onMouseDown:P?I:void 0,onMouseMove:P?w:c,onMouseUp:P?E:void 0,onMouseLeave:P?C:d,ref:f,style:$0},h,K.createElement(s5,null))});dT.displayName="Pane";function hT(t,e){const n=t.parentNode||t.parentId;if(!n)return!1;const r=e.get(n);return r?r.selected?!0:hT(r,e):!1}function Ew(t,e,n){let r=t;do{if(r!=null&&r.matches(e))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function l5(t,e,n,r){return Array.from(t.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!hT(i,t))&&(i.draggable||e&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function c5(t,e){return!e||e==="parent"?e:[e[0],[e[1][0]-(t.width||0),e[1][1]-(t.height||0)]]}function fT(t,e,n,r,i=[0,0],s){const o=c5(t,t.extent||r);let a=o;const l=t.parentNode||t.parentId;if(t.extent==="parent"&&!t.expandParent)if(l&&t.width&&t.height){const h=n.get(l),{x:f,y:m}=Ks(h,i).positionAbsolute;a=h&&Bn(f)&&Bn(m)&&Bn(h.width)&&Bn(h.height)?[[f+t.width*i[0],m+t.height*i[1]],[f+h.width-t.width+t.width*i[0],m+h.height-t.height+t.height*i[1]]]:a}else s==null||s("005",hi.error005()),a=o;else if(t.extent&&l&&t.extent!=="parent"){const h=n.get(l),{x:f,y:m}=Ks(h,i).positionAbsolute;a=[[t.extent[0][0]+f,t.extent[0][1]+m],[t.extent[1][0]+f,t.extent[1][1]+m]]}let c={x:0,y:0};if(l){const h=n.get(l);c=Ks(h,i).positionAbsolute}const d=a&&a!=="parent"?D0(e,a):e;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function Ep({nodeId:t,dragItems:e,nodeInternals:n}){const r=e.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[t?r.find(i=>i.id===t):r[0],r]}const bw=(t,e,n,r)=>{const i=e.querySelectorAll(t);if(!i||!i.length)return null;const s=Array.from(i),o=e.getBoundingClientRect(),a={x:o.width*r[0],y:o.height*r[1]};return s.map(l=>{const c=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(c.left-o.left-a.x)/n,y:(c.top-o.top-a.y)/n,...N0(l)}})};function Al(t,e,n){return n===void 0?n:r=>{const i=e().nodeInternals.get(t);i&&n(r,{...i})}}function Ym({id:t,store:e,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:a,onError:l}=e.getState(),c=a.get(t);if(!c){l==null||l("012",hi.error012(t));return}e.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&o)&&(s({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):i([t])}function pT(){const t=vt();return D.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:s}=t.getState(),o=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,l={x:(o-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:s?i[0]*Math.round(l.x/i[0]):l.x,ySnapped:s?i[1]*Math.round(l.y/i[1]):l.y,...l}},[])}function bp(t){return(e,n,r)=>t==null?void 0:t(e,r)}function mT({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const a=vt(),[l,c]=D.useState(!1),d=D.useRef([]),h=D.useRef({x:null,y:null}),f=D.useRef(0),m=D.useRef(null),b=D.useRef({x:0,y:0}),x=D.useRef(null),R=D.useRef(!1),y=D.useRef(!1),v=D.useRef(!1),T=pT();return D.useEffect(()=>{if(t!=null&&t.current){const A=An(t.current),O=({x:I,y:w})=>{const{nodeInternals:E,onNodeDrag:C,onSelectionDrag:P,updateNodePositions:k,nodeExtent:N,snapGrid:j,snapToGrid:z,nodeOrigin:B,onError:F}=a.getState();h.current={x:I,y:w};let M=!1,U={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&N){const $=iu(d.current,B);U=Oc($)}if(d.current=d.current.map($=>{const X={x:I-$.distance.x,y:w-$.distance.y};z&&(X.x=j[0]*Math.round(X.x/j[0]),X.y=j[1]*Math.round(X.y/j[1]));const Y=[[N[0][0],N[0][1]],[N[1][0],N[1][1]]];d.current.length>1&&N&&!$.extent&&(Y[0][0]=$.positionAbsolute.x-U.x+N[0][0],Y[1][0]=$.positionAbsolute.x+($.width??0)-U.x2+N[1][0],Y[0][1]=$.positionAbsolute.y-U.y+N[0][1],Y[1][1]=$.positionAbsolute.y+($.height??0)-U.y2+N[1][1]);const ee=fT($,X,E,Y,B,F);return M=M||$.position.x!==ee.position.x||$.position.y!==ee.position.y,$.position=ee.position,$.positionAbsolute=ee.positionAbsolute,$}),!M)return;k(d.current,!0,!0),c(!0);const G=i?C:bp(P);if(G&&x.current){const[$,X]=Ep({nodeId:i,dragItems:d.current,nodeInternals:E});G(x.current,$,X)}},L=()=>{if(!m.current)return;const[I,w]=NI(b.current,m.current);if(I!==0||w!==0){const{transform:E,panBy:C}=a.getState();h.current.x=(h.current.x??0)-I/E[2],h.current.y=(h.current.y??0)-w/E[2],C({x:I,y:w})&&O(h.current)}f.current=requestAnimationFrame(L)},S=I=>{var B;const{nodeInternals:w,multiSelectionActive:E,nodesDraggable:C,unselectNodesAndEdges:P,onNodeDragStart:k,onSelectionDragStart:N}=a.getState();y.current=!0;const j=i?k:bp(N);(!o||!s)&&!E&&i&&((B=w.get(i))!=null&&B.selected||P()),i&&s&&o&&Ym({id:i,store:a,nodeRef:t});const z=T(I);if(h.current=z,d.current=l5(w,C,z,i),j&&d.current){const[F,M]=Ep({nodeId:i,dragItems:d.current,nodeInternals:w});j(I.sourceEvent,F,M)}};if(e)A.on(".drag",null);else{const I=gI().on("start",w=>{const{domNode:E,nodeDragThreshold:C}=a.getState();C===0&&S(w),v.current=!1;const P=T(w);h.current=P,m.current=(E==null?void 0:E.getBoundingClientRect())||null,b.current=ts(w.sourceEvent,m.current)}).on("drag",w=>{var k,N;const E=T(w),{autoPanOnNodeDrag:C,nodeDragThreshold:P}=a.getState();if(w.sourceEvent.type==="touchmove"&&w.sourceEvent.touches.length>1&&(v.current=!0),!v.current){if(!R.current&&y.current&&C&&(R.current=!0,L()),!y.current){const j=E.xSnapped-(((k=h==null?void 0:h.current)==null?void 0:k.x)??0),z=E.ySnapped-(((N=h==null?void 0:h.current)==null?void 0:N.y)??0);Math.sqrt(j*j+z*z)>P&&S(w)}(h.current.x!==E.xSnapped||h.current.y!==E.ySnapped)&&d.current&&y.current&&(x.current=w.sourceEvent,b.current=ts(w.sourceEvent,m.current),O(E))}}).on("end",w=>{if(!(!y.current||v.current)&&(c(!1),R.current=!1,y.current=!1,cancelAnimationFrame(f.current),d.current)){const{updateNodePositions:E,nodeInternals:C,onNodeDragStop:P,onSelectionDragStop:k}=a.getState(),N=i?P:bp(k);if(E(d.current,!1,!1),N){const[j,z]=Ep({nodeId:i,dragItems:d.current,nodeInternals:C});N(w.sourceEvent,j,z)}}}).filter(w=>{const E=w.target;return!w.button&&(!n||!Ew(E,`.${n}`,t))&&(!r||Ew(E,r,t))});return A.call(I),()=>{A.on(".drag",null)}}}},[t,e,n,r,s,a,i,o,T]),l}function gT(){const t=vt();return D.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:a,snapGrid:l,onError:c,nodesDraggable:d}=t.getState(),h=o().filter(v=>v.selected&&(v.draggable||d&&typeof v.draggable>"u")),f=a?l[0]:5,m=a?l[1]:5,b=n.isShiftPressed?4:1,x=n.x*f*b,R=n.y*m*b,y=h.map(v=>{if(v.positionAbsolute){const T={x:v.positionAbsolute.x+x,y:v.positionAbsolute.y+R};a&&(T.x=l[0]*Math.round(T.x/l[0]),T.y=l[1]*Math.round(T.y/l[1]));const{positionAbsolute:A,position:O}=fT(v,T,r,i,void 0,c);v.position=O,v.positionAbsolute=A}return v});s(y,!0,!1)},[])}const pa={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var kl=t=>{const e=({id:n,type:r,data:i,xPos:s,yPos:o,xPosOrigin:a,yPosOrigin:l,selected:c,onClick:d,onMouseEnter:h,onMouseMove:f,onMouseLeave:m,onContextMenu:b,onDoubleClick:x,style:R,className:y,isDraggable:v,isSelectable:T,isConnectable:A,isFocusable:O,selectNodesOnDrag:L,sourcePosition:S,targetPosition:I,hidden:w,resizeObserver:E,dragHandle:C,zIndex:P,isParent:k,noDragClassName:N,noPanClassName:j,initialized:z,disableKeyboardA11y:B,ariaLabel:F,rfId:M,hasHandleBounds:U})=>{const G=vt(),$=D.useRef(null),X=D.useRef(null),Y=D.useRef(S),ee=D.useRef(I),ne=D.useRef(r),fe=T||v||d||h||f||m,ce=gT(),xe=Al(n,G.getState,h),ye=Al(n,G.getState,f),ke=Al(n,G.getState,m),Re=Al(n,G.getState,b),He=Al(n,G.getState,x),Oe=Se=>{const{nodeDragThreshold:se}=G.getState();if(T&&(!L||!v||se>0)&&Ym({id:n,store:G,nodeRef:$}),d){const Ce=G.getState().nodeInternals.get(n);Ce&&d(Se,{...Ce})}},Pe=Se=>{if(!Km(Se)&&!B)if(zI.includes(Se.key)&&T){const se=Se.key==="Escape";Ym({id:n,store:G,unselect:se,nodeRef:$})}else v&&c&&Object.prototype.hasOwnProperty.call(pa,Se.key)&&(G.setState({ariaLiveMessage:`Moved selected node ${Se.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),ce({x:pa[Se.key].x,y:pa[Se.key].y,isShiftPressed:Se.shiftKey}))};D.useEffect(()=>()=>{X.current&&(E==null||E.unobserve(X.current),X.current=null)},[]),D.useEffect(()=>{if($.current&&!w){const Se=$.current;(!z||!U||X.current!==Se)&&(X.current&&(E==null||E.unobserve(X.current)),E==null||E.observe(Se),X.current=Se)}},[w,z,U]),D.useEffect(()=>{const Se=ne.current!==r,se=Y.current!==S,Ce=ee.current!==I;$.current&&(Se||se||Ce)&&(Se&&(ne.current=r),se&&(Y.current=S),Ce&&(ee.current=I),G.getState().updateNodeDimensions([{id:n,nodeElement:$.current,forceUpdate:!0}]))},[n,r,S,I]);const ut=mT({nodeRef:$,disabled:w||!v,noDragClassName:N,handleSelector:C,nodeId:n,isSelectable:T,selectNodesOnDrag:L});return w?null:K.createElement("div",{className:Dt(["react-flow__node",`react-flow__node-${r}`,{[j]:v},y,{selected:c,selectable:T,parent:k,dragging:ut}]),ref:$,style:{zIndex:P,transform:`translate(${a}px,${l}px)`,pointerEvents:fe?"all":"none",visibility:z?"visible":"hidden",...R},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:xe,onMouseMove:ye,onMouseLeave:ke,onContextMenu:Re,onClick:Oe,onDoubleClick:He,onKeyDown:O?Pe:void 0,tabIndex:O?0:void 0,role:O?"button":void 0,"aria-describedby":B?void 0:`${iT}-${M}`,"aria-label":F},K.createElement(S4,{value:n},K.createElement(t,{id:n,data:i,type:r,xPos:s,yPos:o,selected:c,isConnectable:A,sourcePosition:S,targetPosition:I,dragging:ut,dragHandle:C,zIndex:P})))};return e.displayName="NodeWrapper",D.memo(e)};const u5=t=>{const e=t.getNodes().filter(n=>n.selected);return{...iu(e,t.nodeOrigin),transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`,userSelectionActive:t.userSelectionActive}};function d5({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const r=vt(),{width:i,height:s,x:o,y:a,transformString:l,userSelectionActive:c}=Be(u5,Pt),d=gT(),h=D.useRef(null);if(D.useEffect(()=>{var b;n||(b=h.current)==null||b.focus({preventScroll:!0})},[n]),mT({nodeRef:h}),c||!i||!s)return null;const f=t?b=>{const x=r.getState().getNodes().filter(R=>R.selected);t(b,x)}:void 0,m=b=>{Object.prototype.hasOwnProperty.call(pa,b.key)&&d({x:pa[b.key].x,y:pa[b.key].y,isShiftPressed:b.shiftKey})};return K.createElement("div",{className:Dt(["react-flow__nodesselection","react-flow__container",e]),style:{transform:l}},K.createElement("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:i,height:s,top:a,left:o}}))}var h5=D.memo(d5);const f5=t=>t.nodesSelectionActive,yT=({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:a,onMove:l,onMoveStart:c,onMoveEnd:d,selectionKeyCode:h,selectionOnDrag:f,selectionMode:m,onSelectionStart:b,onSelectionEnd:x,multiSelectionKeyCode:R,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:T,zoomOnScroll:A,zoomOnPinch:O,panOnScroll:L,panOnScrollSpeed:S,panOnScrollMode:I,zoomOnDoubleClick:w,panOnDrag:E,defaultViewport:C,translateExtent:P,minZoom:k,maxZoom:N,preventScrolling:j,onSelectionContextMenu:z,noWheelClassName:B,noPanClassName:F,disableKeyboardA11y:M})=>{const U=Be(f5),G=Mc(h),$=Mc(y),X=$||E,Y=$||L,ee=G||f&&X!==!0;return Z4({deleteKeyCode:a,multiSelectionKeyCode:R}),K.createElement(r5,{onMove:l,onMoveStart:c,onMoveEnd:d,onPaneContextMenu:s,elementsSelectable:T,zoomOnScroll:A,zoomOnPinch:O,panOnScroll:Y,panOnScrollSpeed:S,panOnScrollMode:I,zoomOnDoubleClick:w,panOnDrag:!G&&X,defaultViewport:C,translateExtent:P,minZoom:k,maxZoom:N,zoomActivationKeyCode:v,preventScrolling:j,noWheelClassName:B,noPanClassName:F},K.createElement(dT,{onSelectionStart:b,onSelectionEnd:x,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:X,isSelecting:!!ee,selectionMode:m},t,U&&K.createElement(h5,{onSelectionContextMenu:z,noPanClassName:F,disableKeyboardA11y:M})))};yT.displayName="FlowRenderer";var p5=D.memo(yT);function m5(t){return Be(D.useCallback(n=>t?qI(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[t]))}function g5(t){const e={input:kl(t.input||eT),default:kl(t.default||Qm),output:kl(t.output||nT),group:kl(t.group||F0)},n={},r=Object.keys(t).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=kl(t[s]||Qm),i),n);return{...e,...r}}const y5=({x:t,y:e,width:n,height:r,origin:i})=>!n||!r?{x:t,y:e}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:t,y:e}:{x:t-n*i[0],y:e-r*i[1]},v5=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions,onError:t.onError}),vT=t=>{const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Be(v5,Pt),a=m5(t.onlyRenderVisibleElements),l=D.useRef(),c=D.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(h=>{const f=h.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));s(f)});return l.current=d,d},[]);return D.useEffect(()=>()=>{var d;(d=l==null?void 0:l.current)==null||d.disconnect()},[]),K.createElement("div",{className:"react-flow__nodes",style:$0},a.map(d=>{var O,L,S;let h=d.type||"default";t.nodeTypes[h]||(o==null||o("003",hi.error003(h)),h="default");const f=t.nodeTypes[h]||t.nodeTypes.default,m=!!(d.draggable||e&&typeof d.draggable>"u"),b=!!(d.selectable||i&&typeof d.selectable>"u"),x=!!(d.connectable||n&&typeof d.connectable>"u"),R=!!(d.focusable||r&&typeof d.focusable>"u"),y=t.nodeExtent?D0(d.positionAbsolute,t.nodeExtent):d.positionAbsolute,v=(y==null?void 0:y.x)??0,T=(y==null?void 0:y.y)??0,A=y5({x:v,y:T,width:d.width??0,height:d.height??0,origin:t.nodeOrigin});return K.createElement(f,{key:d.id,id:d.id,className:d.className,style:d.style,type:h,data:d.data,sourcePosition:d.sourcePosition||le.Bottom,targetPosition:d.targetPosition||le.Top,hidden:d.hidden,xPos:v,yPos:T,xPosOrigin:A.x,yPosOrigin:A.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!d.selected,isDraggable:m,isSelectable:b,isConnectable:x,isFocusable:R,resizeObserver:c,dragHandle:d.dragHandle,zIndex:((O=d[ct])==null?void 0:O.z)??0,isParent:!!((L=d[ct])!=null&&L.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!d.width&&!!d.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((S=d[ct])!=null&&S.handleBounds)})}))};vT.displayName="NodeRenderer";var _5=D.memo(vT);const w5=(t,e,n)=>n===le.Left?t-e:n===le.Right?t+e:t,x5=(t,e,n)=>n===le.Top?t-e:n===le.Bottom?t+e:t,Iw="react-flow__edgeupdater",Tw=({position:t,centerX:e,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a})=>K.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Dt([Iw,`${Iw}-${a}`]),cx:w5(e,r,t),cy:x5(n,r,t),r,stroke:"transparent",fill:"transparent"}),E5=()=>!0;var Vo=t=>{const e=({id:n,className:r,type:i,data:s,onClick:o,onEdgeDoubleClick:a,selected:l,animated:c,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:m,labelBgPadding:b,labelBgBorderRadius:x,style:R,source:y,target:v,sourceX:T,sourceY:A,targetX:O,targetY:L,sourcePosition:S,targetPosition:I,elementsSelectable:w,hidden:E,sourceHandleId:C,targetHandleId:P,onContextMenu:k,onMouseEnter:N,onMouseMove:j,onMouseLeave:z,reconnectRadius:B,onReconnect:F,onReconnectStart:M,onReconnectEnd:U,markerEnd:G,markerStart:$,rfId:X,ariaLabel:Y,isFocusable:ee,isReconnectable:ne,pathOptions:fe,interactionWidth:ce,disableKeyboardA11y:xe})=>{const ye=D.useRef(null),[ke,Re]=D.useState(!1),[He,Oe]=D.useState(!1),Pe=vt(),ut=D.useMemo(()=>`url('#${Gm($,X)}')`,[$,X]),Se=D.useMemo(()=>`url('#${Gm(G,X)}')`,[G,X]);if(E)return null;const se=st=>{var an;const{edges:_t,addSelectedEdges:Ye,unselectNodesAndEdges:En,multiSelectionActive:on}=Pe.getState(),bn=_t.find(Jn=>Jn.id===n);bn&&(w&&(Pe.setState({nodesSelectionActive:!1}),bn.selected&&on?(En({nodes:[],edges:[bn]}),(an=ye.current)==null||an.blur()):Ye([n])),o&&o(st,bn))},Ce=Cl(n,Pe.getState,a),Tt=Cl(n,Pe.getState,k),xn=Cl(n,Pe.getState,N),dt=Cl(n,Pe.getState,j),Ut=Cl(n,Pe.getState,z),Vt=(st,_t)=>{if(st.button!==0)return;const{edges:Ye,isValidConnection:En}=Pe.getState(),on=_t?v:y,bn=(_t?P:C)||null,an=_t?"target":"source",Jn=En||E5,wi=_t,vr=Ye.find(In=>In.id===n);Oe(!0),M==null||M(st,vr,an);const Zn=In=>{Oe(!1),U==null||U(In,vr,an)};YI({event:st,handleId:bn,nodeId:on,onConnect:In=>F==null?void 0:F(vr,In),isTarget:wi,getState:Pe.getState,setState:Pe.setState,isValidConnection:Jn,edgeUpdaterType:an,onReconnectEnd:Zn})},pt=st=>Vt(st,!0),De=st=>Vt(st,!1),Le=()=>Re(!0),St=()=>Re(!1),Yt=!w&&!o,Xt=st=>{var _t;if(!xe&&zI.includes(st.key)&&w){const{unselectNodesAndEdges:Ye,addSelectedEdges:En,edges:on}=Pe.getState();st.key==="Escape"?((_t=ye.current)==null||_t.blur(),Ye({edges:[on.find(an=>an.id===n)]})):En([n])}};return K.createElement("g",{className:Dt(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:l,animated:c,inactive:Yt,updating:ke}]),onClick:se,onDoubleClick:Ce,onContextMenu:Tt,onMouseEnter:xn,onMouseMove:dt,onMouseLeave:Ut,onKeyDown:ee?Xt:void 0,tabIndex:ee?0:void 0,role:ee?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":Y===null?void 0:Y||`Edge from ${y} to ${v}`,"aria-describedby":ee?`${sT}-${X}`:void 0,ref:ye},!He&&K.createElement(t,{id:n,source:y,target:v,selected:l,animated:c,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:m,labelBgPadding:b,labelBgBorderRadius:x,data:s,style:R,sourceX:T,sourceY:A,targetX:O,targetY:L,sourcePosition:S,targetPosition:I,sourceHandleId:C,targetHandleId:P,markerStart:ut,markerEnd:Se,pathOptions:fe,interactionWidth:ce}),ne&&K.createElement(K.Fragment,null,(ne==="source"||ne===!0)&&K.createElement(Tw,{position:S,centerX:T,centerY:A,radius:B,onMouseDown:pt,onMouseEnter:Le,onMouseOut:St,type:"source"}),(ne==="target"||ne===!0)&&K.createElement(Tw,{position:I,centerX:O,centerY:L,radius:B,onMouseDown:De,onMouseEnter:Le,onMouseOut:St,type:"target"})))};return e.displayName="EdgeWrapper",D.memo(e)};function b5(t){const e={default:Vo(t.default||yh),straight:Vo(t.bezier||z0),step:Vo(t.step||O0),smoothstep:Vo(t.step||df),simplebezier:Vo(t.simplebezier||V0)},n={},r=Object.keys(t).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Vo(t[s]||yh),i),n);return{...e,...r}}function Sw(t,e,n=null){const r=((n==null?void 0:n.x)||0)+e.x,i=((n==null?void 0:n.y)||0)+e.y,s=(n==null?void 0:n.width)||e.width,o=(n==null?void 0:n.height)||e.height;switch(t){case le.Top:return{x:r+s/2,y:i};case le.Right:return{x:r+s,y:i+o/2};case le.Bottom:return{x:r+s/2,y:i+o};case le.Left:return{x:r,y:i+o/2}}}function Cw(t,e){return t?t.length===1||!e?t[0]:e&&t.find(n=>n.id===e)||null:null}const I5=(t,e,n,r,i,s)=>{const o=Sw(n,t,e),a=Sw(s,r,i);return{sourceX:o.x,sourceY:o.y,targetX:a.x,targetY:a.y}};function T5({sourcePos:t,targetPos:e,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:s,width:o,height:a,transform:l}){const c={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x+n,e.x+i),y2:Math.max(t.y+r,e.y+s)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=Oc({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:o/l[2],height:a/l[2]}),h=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),f=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(h*f)>0}function Aw(t){var r,i,s,o,a;const e=((r=t==null?void 0:t[ct])==null?void 0:r.handleBounds)||null,n=e&&(t==null?void 0:t.width)&&(t==null?void 0:t.height)&&typeof((i=t==null?void 0:t.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=t==null?void 0:t.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=t==null?void 0:t.positionAbsolute)==null?void 0:o.x)||0,y:((a=t==null?void 0:t.positionAbsolute)==null?void 0:a.y)||0,width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0},e,!!n]}const S5=[{level:0,isMaxLevel:!0,edges:[]}];function C5(t,e,n=!1){let r=-1;const i=t.reduce((o,a)=>{var d,h;const l=Bn(a.zIndex);let c=l?a.zIndex:0;if(n){const f=e.get(a.target),m=e.get(a.source),b=a.selected||(f==null?void 0:f.selected)||(m==null?void 0:m.selected),x=Math.max(((d=m==null?void 0:m[ct])==null?void 0:d.z)||0,((h=f==null?void 0:f[ct])==null?void 0:h.z)||0,1e3);c=(l?a.zIndex:0)+(b?x:0)}return o[c]?o[c].push(a):o[c]=[a],r=c>r?c:r,o},{}),s=Object.entries(i).map(([o,a])=>{const l=+o;return{edges:a,level:l,isMaxLevel:l===r}});return s.length===0?S5:s}function A5(t,e,n){const r=Be(D.useCallback(i=>t?i.edges.filter(s=>{const o=e.get(s.source),a=e.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&T5({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:a.width,targetHeight:a.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[t,e]));return C5(r,e,n)}const k5=({color:t="none",strokeWidth:e=1})=>K.createElement("polyline",{style:{stroke:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),R5=({color:t="none",strokeWidth:e=1})=>K.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),kw={[gh.Arrow]:k5,[gh.ArrowClosed]:R5};function P5(t){const e=vt();return D.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(kw,t)?kw[t]:((s=(i=e.getState()).onError)==null||s.call(i,"009",hi.error009(t)),null)},[t])}const N5=({id:t,type:e,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const l=P5(e);return l?K.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0"},K.createElement(l,{color:n,strokeWidth:o})):null},D5=({defaultColor:t,rfId:e})=>n=>{const r=[];return n.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const a=Gm(o,e);r.includes(a)||(i.push({id:a,color:o.color||t,...o}),r.push(a))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},_T=({defaultColor:t,rfId:e})=>{const n=Be(D.useCallback(D5({defaultColor:t,rfId:e}),[t,e]),(r,i)=>!(r.length!==i.length||r.some((s,o)=>s.id!==i[o].id)));return K.createElement("defs",null,n.map(r=>K.createElement(N5,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};_T.displayName="MarkerDefinitions";var V5=D.memo(_T);const O5=t=>({nodesConnectable:t.nodesConnectable,edgesFocusable:t.edgesFocusable,edgesUpdatable:t.edgesUpdatable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals,onError:t.onError}),wT=({defaultMarkerColor:t,onlyRenderVisibleElements:e,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,onEdgeDoubleClick:h,onReconnect:f,onReconnectStart:m,onReconnectEnd:b,reconnectRadius:x,children:R,disableKeyboardA11y:y})=>{const{edgesFocusable:v,edgesUpdatable:T,elementsSelectable:A,width:O,height:L,connectionMode:S,nodeInternals:I,onError:w}=Be(O5,Pt),E=A5(e,I,n);return O?K.createElement(K.Fragment,null,E.map(({level:C,edges:P,isMaxLevel:k})=>K.createElement("svg",{key:C,style:{zIndex:C},width:O,height:L,className:"react-flow__edges react-flow__container"},k&&K.createElement(V5,{defaultColor:t,rfId:r}),K.createElement("g",null,P.map(N=>{const[j,z,B]=Aw(I.get(N.source)),[F,M,U]=Aw(I.get(N.target));if(!B||!U)return null;let G=N.type||"default";i[G]||(w==null||w("011",hi.error011(G)),G="default");const $=i[G]||i.default,X=S===to.Strict?M.target:(M.target??[]).concat(M.source??[]),Y=Cw(z.source,N.sourceHandle),ee=Cw(X,N.targetHandle),ne=(Y==null?void 0:Y.position)||le.Bottom,fe=(ee==null?void 0:ee.position)||le.Top,ce=!!(N.focusable||v&&typeof N.focusable>"u"),xe=N.reconnectable||N.updatable,ye=typeof f<"u"&&(xe||T&&typeof xe>"u");if(!Y||!ee)return w==null||w("008",hi.error008(Y,N)),null;const{sourceX:ke,sourceY:Re,targetX:He,targetY:Oe}=I5(j,Y,ne,F,ee,fe);return K.createElement($,{key:N.id,id:N.id,className:Dt([N.className,s]),type:G,data:N.data,selected:!!N.selected,animated:!!N.animated,hidden:!!N.hidden,label:N.label,labelStyle:N.labelStyle,labelShowBg:N.labelShowBg,labelBgStyle:N.labelBgStyle,labelBgPadding:N.labelBgPadding,labelBgBorderRadius:N.labelBgBorderRadius,style:N.style,source:N.source,target:N.target,sourceHandleId:N.sourceHandle,targetHandleId:N.targetHandle,markerEnd:N.markerEnd,markerStart:N.markerStart,sourceX:ke,sourceY:Re,targetX:He,targetY:Oe,sourcePosition:ne,targetPosition:fe,elementsSelectable:A,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,onEdgeDoubleClick:h,onReconnect:f,onReconnectStart:m,onReconnectEnd:b,reconnectRadius:x,rfId:r,ariaLabel:N.ariaLabel,isFocusable:ce,isReconnectable:ye,pathOptions:"pathOptions"in N?N.pathOptions:void 0,interactionWidth:N.interactionWidth,disableKeyboardA11y:y})})))),R):null};wT.displayName="EdgeRenderer";var z5=D.memo(wT);const L5=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function M5({children:t}){const e=Be(L5);return K.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:e}},t)}function j5(t){const e=Vr(),n=D.useRef(!1);D.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const F5={[le.Left]:le.Right,[le.Right]:le.Left,[le.Top]:le.Bottom,[le.Bottom]:le.Top},xT=({nodeId:t,handleType:e,style:n,type:r=ji.Bezier,CustomComponent:i,connectionStatus:s})=>{var L,S,I;const{fromNode:o,handleId:a,toX:l,toY:c,connectionMode:d}=Be(D.useCallback(w=>({fromNode:w.nodeInternals.get(t),handleId:w.connectionHandleId,toX:(w.connectionPosition.x-w.transform[0])/w.transform[2],toY:(w.connectionPosition.y-w.transform[1])/w.transform[2],connectionMode:w.connectionMode}),[t]),Pt),h=(L=o==null?void 0:o[ct])==null?void 0:L.handleBounds;let f=h==null?void 0:h[e];if(d===to.Loose&&(f=f||(h==null?void 0:h[e==="source"?"target":"source"])),!o||!f)return null;const m=a?f.find(w=>w.id===a):f[0],b=m?m.x+m.width/2:(o.width??0)/2,x=m?m.y+m.height/2:o.height??0,R=(((S=o.positionAbsolute)==null?void 0:S.x)??0)+b,y=(((I=o.positionAbsolute)==null?void 0:I.y)??0)+x,v=m==null?void 0:m.position,T=v?F5[v]:null;if(!v||!T)return null;if(i)return K.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:m,fromX:R,fromY:y,toX:l,toY:c,fromPosition:v,toPosition:T,connectionStatus:s});let A="";const O={sourceX:R,sourceY:y,sourcePosition:v,targetX:l,targetY:c,targetPosition:T};return r===ji.Bezier?[A]=L0(O):r===ji.Step?[A]=Lc({...O,borderRadius:0}):r===ji.SmoothStep?[A]=Lc(O):r===ji.SimpleBezier?[A]=FI(O):A=`M${R},${y} ${l},${c}`,K.createElement("path",{d:A,fill:"none",className:"react-flow__connection-path",style:n})};xT.displayName="ConnectionLine";const $5=t=>({nodeId:t.connectionNodeId,handleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,connectionStatus:t.connectionStatus,width:t.width,height:t.height});function U5({containerStyle:t,style:e,type:n,component:r}){const{nodeId:i,handleType:s,nodesConnectable:o,width:a,height:l,connectionStatus:c}=Be($5,Pt);return!(i&&s&&a&&o)?null:K.createElement("svg",{style:t,width:a,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},K.createElement("g",{className:Dt(["react-flow__connection",c])},K.createElement(xT,{nodeId:i,handleType:s,style:e,type:n,CustomComponent:r,connectionStatus:c})))}function Rw(t,e){return D.useRef(null),vt(),D.useMemo(()=>e(t),[t])}const ET=({nodeTypes:t,edgeTypes:e,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:m,onSelectionContextMenu:b,onSelectionStart:x,onSelectionEnd:R,connectionLineType:y,connectionLineStyle:v,connectionLineComponent:T,connectionLineContainerStyle:A,selectionKeyCode:O,selectionOnDrag:L,selectionMode:S,multiSelectionKeyCode:I,panActivationKeyCode:w,zoomActivationKeyCode:E,deleteKeyCode:C,onlyRenderVisibleElements:P,elementsSelectable:k,selectNodesOnDrag:N,defaultViewport:j,translateExtent:z,minZoom:B,maxZoom:F,preventScrolling:M,defaultMarkerColor:U,zoomOnScroll:G,zoomOnPinch:$,panOnScroll:X,panOnScrollSpeed:Y,panOnScrollMode:ee,zoomOnDoubleClick:ne,panOnDrag:fe,onPaneClick:ce,onPaneMouseEnter:xe,onPaneMouseMove:ye,onPaneMouseLeave:ke,onPaneScroll:Re,onPaneContextMenu:He,onEdgeContextMenu:Oe,onEdgeMouseEnter:Pe,onEdgeMouseMove:ut,onEdgeMouseLeave:Se,onReconnect:se,onReconnectStart:Ce,onReconnectEnd:Tt,reconnectRadius:xn,noDragClassName:dt,noWheelClassName:Ut,noPanClassName:Vt,elevateEdgesOnSelect:pt,disableKeyboardA11y:De,nodeOrigin:Le,nodeExtent:St,rfId:Yt})=>{const Xt=Rw(t,g5),st=Rw(e,b5);return j5(s),K.createElement(p5,{onPaneClick:ce,onPaneMouseEnter:xe,onPaneMouseMove:ye,onPaneMouseLeave:ke,onPaneContextMenu:He,onPaneScroll:Re,deleteKeyCode:C,selectionKeyCode:O,selectionOnDrag:L,selectionMode:S,onSelectionStart:x,onSelectionEnd:R,multiSelectionKeyCode:I,panActivationKeyCode:w,zoomActivationKeyCode:E,elementsSelectable:k,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:G,zoomOnPinch:$,zoomOnDoubleClick:ne,panOnScroll:X,panOnScrollSpeed:Y,panOnScrollMode:ee,panOnDrag:fe,defaultViewport:j,translateExtent:z,minZoom:B,maxZoom:F,onSelectionContextMenu:b,preventScrolling:M,noDragClassName:dt,noWheelClassName:Ut,noPanClassName:Vt,disableKeyboardA11y:De},K.createElement(M5,null,K.createElement(z5,{edgeTypes:st,onEdgeClick:a,onEdgeDoubleClick:c,onlyRenderVisibleElements:P,onEdgeContextMenu:Oe,onEdgeMouseEnter:Pe,onEdgeMouseMove:ut,onEdgeMouseLeave:Se,onReconnect:se,onReconnectStart:Ce,onReconnectEnd:Tt,reconnectRadius:xn,defaultMarkerColor:U,noPanClassName:Vt,elevateEdgesOnSelect:!!pt,disableKeyboardA11y:De,rfId:Yt},K.createElement(U5,{style:v,type:y,component:T,containerStyle:A})),K.createElement("div",{className:"react-flow__edgelabel-renderer"}),K.createElement(_5,{nodeTypes:Xt,onNodeClick:o,onNodeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:m,selectNodesOnDrag:N,onlyRenderVisibleElements:P,noPanClassName:Vt,noDragClassName:dt,disableKeyboardA11y:De,nodeOrigin:Le,nodeExtent:St,rfId:Yt})))};ET.displayName="GraphView";var B5=D.memo(ET);const Xm=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],ki={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Xm,nodeExtent:Xm,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:to.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:x4,isValidConnection:void 0},H5=()=>LP((t,e)=>({...ki,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:s}=e();t({nodeInternals:wp(n,r,i,s)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=e();t({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",s=typeof r<"u",o=i?wp(n,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map;t({nodeInternals:o,edges:s?r:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:a,domNode:l,nodeOrigin:c}=e(),d=l==null?void 0:l.querySelector(".react-flow__viewport");if(!d)return;const h=window.getComputedStyle(d),{m22:f}=new window.DOMMatrixReadOnly(h.transform),m=n.reduce((x,R)=>{const y=i.get(R.id);if(y!=null&&y.hidden)i.set(y.id,{...y,[ct]:{...y[ct],handleBounds:void 0}});else if(y){const v=N0(R.nodeElement);!!(v.width&&v.height&&(y.width!==v.width||y.height!==v.height||R.forceUpdate))&&(i.set(y.id,{...y,[ct]:{...y[ct],handleBounds:{source:bw(".source",R.nodeElement,f,c),target:bw(".target",R.nodeElement,f,c)}},...v}),x.push({id:y.id,type:"dimensions",dimensions:v}))}return x},[]);aT(i,c);const b=o||s&&!o&&lT(e,{initial:!0,...a});t({nodeInternals:new Map(i),fitViewOnInitDone:b}),(m==null?void 0:m.length)>0&&(r==null||r(m))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:s}=e(),o=n.map(a=>{const l={id:a.id,type:"position",dragging:i};return r&&(l.positionAbsolute=a.positionAbsolute,l.position=a.position),l});s(o)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:a,elevateNodesOnSelect:l}=e();if(n!=null&&n.length){if(s){const c=uT(n,a()),d=wp(c,i,o,l);t({nodeInternals:d})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=e();let o,a=null;r?o=n.map(l=>zi(l,!0)):(o=sa(s(),n),a=sa(i,[])),Ju({changedNodes:o,changedEdges:a,get:e,set:t})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=e();let o,a=null;r?o=n.map(l=>zi(l,!0)):(o=sa(i,n),a=sa(s(),[])),Ju({changedNodes:a,changedEdges:o,get:e,set:t})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:s}=e(),o=n||s(),a=r||i,l=o.map(d=>(d.selected=!1,zi(d.id,!1))),c=a.map(d=>zi(d.id,!1));Ju({changedNodes:l,changedEdges:c,get:e,set:t})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=e();r==null||r.scaleExtent([n,i]),t({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=e();r==null||r.scaleExtent([i,n]),t({maxZoom:n})},setTranslateExtent:n=>{var r;(r=e().d3Zoom)==null||r.translateExtent(n),t({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=e(),s=r().filter(a=>a.selected).map(a=>zi(a.id,!1)),o=n.filter(a=>a.selected).map(a=>zi(a.id,!1));Ju({changedNodes:s,changedEdges:o,get:e,set:t})},setNodeExtent:n=>{const{nodeInternals:r}=e();r.forEach(i=>{i.positionAbsolute=D0(i.position,n)}),t({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:s,d3Zoom:o,d3Selection:a,translateExtent:l}=e();if(!o||!a||!n.x&&!n.y)return!1;const c=si.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),d=[[0,0],[i,s]],h=o==null?void 0:o.constrain()(c,d,l);return o.transform(a,h),r[0]!==h.x||r[1]!==h.y||r[2]!==h.k},cancelConnection:()=>t({connectionNodeId:ki.connectionNodeId,connectionHandleId:ki.connectionHandleId,connectionHandleType:ki.connectionHandleType,connectionStatus:ki.connectionStatus,connectionStartHandle:ki.connectionStartHandle,connectionEndHandle:ki.connectionEndHandle}),reset:()=>t({...ki})}),Object.is),U0=({children:t})=>{const e=D.useRef(null);return e.current||(e.current=H5()),K.createElement(p4,{value:e.current},t)};U0.displayName="ReactFlowProvider";const bT=({children:t})=>D.useContext(uf)?K.createElement(K.Fragment,null,t):K.createElement(U0,null,t);bT.displayName="ReactFlowWrapper";const q5={input:eT,default:Qm,output:nT,group:F0},K5={default:yh,straight:z0,step:O0,smoothstep:df,simplebezier:V0},G5=[0,0],W5=[15,15],Q5={x:0,y:0,zoom:1},Y5={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},IT=D.forwardRef(({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s=q5,edgeTypes:o=K5,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:h,onMoveEnd:f,onConnect:m,onConnectStart:b,onConnectEnd:x,onClickConnectStart:R,onClickConnectEnd:y,onNodeMouseEnter:v,onNodeMouseMove:T,onNodeMouseLeave:A,onNodeContextMenu:O,onNodeDoubleClick:L,onNodeDragStart:S,onNodeDrag:I,onNodeDragStop:w,onNodesDelete:E,onEdgesDelete:C,onSelectionChange:P,onSelectionDragStart:k,onSelectionDrag:N,onSelectionDragStop:j,onSelectionContextMenu:z,onSelectionStart:B,onSelectionEnd:F,connectionMode:M=to.Strict,connectionLineType:U=ji.Bezier,connectionLineStyle:G,connectionLineComponent:$,connectionLineContainerStyle:X,deleteKeyCode:Y="Backspace",selectionKeyCode:ee="Shift",selectionOnDrag:ne=!1,selectionMode:fe=zc.Full,panActivationKeyCode:ce="Space",multiSelectionKeyCode:xe=mh()?"Meta":"Control",zoomActivationKeyCode:ye=mh()?"Meta":"Control",snapToGrid:ke=!1,snapGrid:Re=W5,onlyRenderVisibleElements:He=!1,selectNodesOnDrag:Oe=!0,nodesDraggable:Pe,nodesConnectable:ut,nodesFocusable:Se,nodeOrigin:se=G5,edgesFocusable:Ce,edgesUpdatable:Tt,elementsSelectable:xn,defaultViewport:dt=Q5,minZoom:Ut=.5,maxZoom:Vt=2,translateExtent:pt=Xm,preventScrolling:De=!0,nodeExtent:Le,defaultMarkerColor:St="#b1b1b7",zoomOnScroll:Yt=!0,zoomOnPinch:Xt=!0,panOnScroll:st=!1,panOnScrollSpeed:_t=.5,panOnScrollMode:Ye=Fs.Free,zoomOnDoubleClick:En=!0,panOnDrag:on=!0,onPaneClick:bn,onPaneMouseEnter:an,onPaneMouseMove:Jn,onPaneMouseLeave:wi,onPaneScroll:vr,onPaneContextMenu:Zn,children:xi,onEdgeContextMenu:In,onEdgeDoubleClick:er,onEdgeMouseEnter:xo,onEdgeMouseMove:zr,onEdgeMouseLeave:Eo,onEdgeUpdate:Lr,onEdgeUpdateStart:bo,onEdgeUpdateEnd:wt,onReconnect:tr,onReconnectStart:Mr,onReconnectEnd:jr,reconnectRadius:il=10,edgeUpdaterRadius:sl=10,onNodesChange:_r,onEdgesChange:ol,noDragClassName:al="nodrag",noWheelClassName:Ei="nowheel",noPanClassName:ws="nopan",fitView:xs=!1,fitViewOptions:Fr,connectOnClick:jn=!0,attributionPosition:Io,proOptions:bi,defaultEdgeOptions:Ii,elevateNodesOnSelect:Es=!0,elevateEdgesOnSelect:To=!1,disableKeyboardA11y:$r=!1,autoPanOnConnect:ll=!0,autoPanOnNodeDrag:Ur=!0,connectionRadius:bs=20,isValidConnection:Ti,onError:_e,style:de,id:qe,nodeDragThreshold:ze,...ht},wr)=>{const Br=qe||"1";return K.createElement("div",{...ht,style:{...de,...Y5},ref:wr,className:Dt(["react-flow",i]),"data-testid":"rf__wrapper",id:qe},K.createElement(bT,null,K.createElement(B5,{onInit:c,onMove:d,onMoveStart:h,onMoveEnd:f,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:v,onNodeMouseMove:T,onNodeMouseLeave:A,onNodeContextMenu:O,onNodeDoubleClick:L,nodeTypes:s,edgeTypes:o,connectionLineType:U,connectionLineStyle:G,connectionLineComponent:$,connectionLineContainerStyle:X,selectionKeyCode:ee,selectionOnDrag:ne,selectionMode:fe,deleteKeyCode:Y,multiSelectionKeyCode:xe,panActivationKeyCode:ce,zoomActivationKeyCode:ye,onlyRenderVisibleElements:He,selectNodesOnDrag:Oe,defaultViewport:dt,translateExtent:pt,minZoom:Ut,maxZoom:Vt,preventScrolling:De,zoomOnScroll:Yt,zoomOnPinch:Xt,zoomOnDoubleClick:En,panOnScroll:st,panOnScrollSpeed:_t,panOnScrollMode:Ye,panOnDrag:on,onPaneClick:bn,onPaneMouseEnter:an,onPaneMouseMove:Jn,onPaneMouseLeave:wi,onPaneScroll:vr,onPaneContextMenu:Zn,onSelectionContextMenu:z,onSelectionStart:B,onSelectionEnd:F,onEdgeContextMenu:In,onEdgeDoubleClick:er,onEdgeMouseEnter:xo,onEdgeMouseMove:zr,onEdgeMouseLeave:Eo,onReconnect:tr??Lr,onReconnectStart:Mr??bo,onReconnectEnd:jr??wt,reconnectRadius:il??sl,defaultMarkerColor:St,noDragClassName:al,noWheelClassName:Ei,noPanClassName:ws,elevateEdgesOnSelect:To,rfId:Br,disableKeyboardA11y:$r,nodeOrigin:se,nodeExtent:Le}),K.createElement($4,{nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:b,onConnectEnd:x,onClickConnectStart:R,onClickConnectEnd:y,nodesDraggable:Pe,nodesConnectable:ut,nodesFocusable:Se,edgesFocusable:Ce,edgesUpdatable:Tt,elementsSelectable:xn,elevateNodesOnSelect:Es,minZoom:Ut,maxZoom:Vt,nodeExtent:Le,onNodesChange:_r,onEdgesChange:ol,snapToGrid:ke,snapGrid:Re,connectionMode:M,translateExtent:pt,connectOnClick:jn,defaultEdgeOptions:Ii,fitView:xs,fitViewOptions:Fr,onNodesDelete:E,onEdgesDelete:C,onNodeDragStart:S,onNodeDrag:I,onNodeDragStop:w,onSelectionDrag:N,onSelectionDragStart:k,onSelectionDragStop:j,noPanClassName:ws,nodeOrigin:se,rfId:Br,autoPanOnConnect:ll,autoPanOnNodeDrag:Ur,onError:_e,connectionRadius:bs,isValidConnection:Ti,nodeDragThreshold:ze}),K.createElement(j4,{onSelectionChange:P}),xi,K.createElement(g4,{proOptions:bi,position:Io}),K.createElement(K4,{rfId:Br,disableKeyboardA11y:$r})))});IT.displayName="ReactFlow";const X5=t=>{var e;return(e=t.domNode)==null?void 0:e.querySelector(".react-flow__edgelabel-renderer")};function J5({children:t}){const e=Be(X5);return e?kc.createPortal(t,e):null}function TT(t){return e=>{const[n,r]=D.useState(e),i=D.useCallback(s=>r(o=>t(s,o)),[]);return[n,r,i]}}const Z5=TT(uT),eO=TT(o5),ST=({id:t,x:e,y:n,width:r,height:i,style:s,color:o,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:h,onClick:f,selected:m})=>{const{background:b,backgroundColor:x}=s||{},R=o||b||x;return K.createElement("rect",{className:Dt(["react-flow__minimap-node",{selected:m},c]),x:e,y:n,rx:d,ry:d,width:r,height:i,fill:R,stroke:a,strokeWidth:l,shapeRendering:h,onClick:f?y=>f(y,t):void 0})};ST.displayName="MiniMapNode";var tO=D.memo(ST);const nO=t=>t.nodeOrigin,rO=t=>t.getNodes().filter(e=>!e.hidden&&e.width&&e.height),Ip=t=>t instanceof Function?t:()=>t;function iO({nodeStrokeColor:t="transparent",nodeColor:e="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i=2,nodeComponent:s=tO,onClick:o}){const a=Be(rO,Pt),l=Be(nO),c=Ip(e),d=Ip(t),h=Ip(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return K.createElement(K.Fragment,null,a.map(m=>{const{x:b,y:x}=Ks(m,l).positionAbsolute;return K.createElement(s,{key:m.id,x:b,y:x,width:m.width,height:m.height,style:m.style,selected:m.selected,className:h(m),color:c(m),borderRadius:r,strokeColor:d(m),strokeWidth:i,shapeRendering:f,onClick:o,id:m.id})}))}var sO=D.memo(iO);const oO=200,aO=150,lO=t=>{const e=t.getNodes(),n={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:n,boundingRect:e.length>0?_4(iu(e,t.nodeOrigin),n):n,rfId:t.rfId}},cO="react-flow__minimap-desc";function CT({style:t,className:e,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:a,maskColor:l="rgb(240, 240, 240, 0.6)",maskStrokeColor:c="none",maskStrokeWidth:d=1,position:h="bottom-right",onClick:f,onNodeClick:m,pannable:b=!1,zoomable:x=!1,ariaLabel:R="React Flow mini map",inversePan:y=!1,zoomStep:v=10,offsetScale:T=5}){const A=vt(),O=D.useRef(null),{boundingRect:L,viewBB:S,rfId:I}=Be(lO,Pt),w=(t==null?void 0:t.width)??oO,E=(t==null?void 0:t.height)??aO,C=L.width/w,P=L.height/E,k=Math.max(C,P),N=k*w,j=k*E,z=T*k,B=L.x-(N-L.width)/2-z,F=L.y-(j-L.height)/2-z,M=N+z*2,U=j+z*2,G=`${cO}-${I}`,$=D.useRef(0);$.current=k,D.useEffect(()=>{if(O.current){const ee=An(O.current),ne=xe=>{const{transform:ye,d3Selection:ke,d3Zoom:Re}=A.getState();if(xe.sourceEvent.type!=="wheel"||!ke||!Re)return;const He=-xe.sourceEvent.deltaY*(xe.sourceEvent.deltaMode===1?.05:xe.sourceEvent.deltaMode?1:.002)*v,Oe=ye[2]*Math.pow(2,He);Re.scaleTo(ke,Oe)},fe=xe=>{const{transform:ye,d3Selection:ke,d3Zoom:Re,translateExtent:He,width:Oe,height:Pe}=A.getState();if(xe.sourceEvent.type!=="mousemove"||!ke||!Re)return;const ut=$.current*Math.max(1,ye[2])*(y?-1:1),Se={x:ye[0]-xe.sourceEvent.movementX*ut,y:ye[1]-xe.sourceEvent.movementY*ut},se=[[0,0],[Oe,Pe]],Ce=si.translate(Se.x,Se.y).scale(ye[2]),Tt=Re.constrain()(Ce,se,He);Re.transform(ke,Tt)},ce=RI().on("zoom",b?fe:null).on("zoom.wheel",x?ne:null);return ee.call(ce),()=>{ee.on("zoom",null)}}},[b,x,y,v]);const X=f?ee=>{const ne=or(ee);f(ee,{x:ne[0],y:ne[1]})}:void 0,Y=m?(ee,ne)=>{const fe=A.getState().nodeInternals.get(ne);m(ee,fe)}:void 0;return K.createElement(P0,{position:h,style:t,className:Dt(["react-flow__minimap",e]),"data-testid":"rf__minimap"},K.createElement("svg",{width:w,height:E,viewBox:`${B} ${F} ${M} ${U}`,role:"img","aria-labelledby":G,ref:O,onClick:X},R&&K.createElement("title",{id:G},R),K.createElement(sO,{onClick:Y,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:a}),K.createElement("path",{className:"react-flow__minimap-mask",d:`M${B-z},${F-z}h${M+z*2}v${U+z*2}h${-M-z*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fill:l,fillRule:"evenodd",stroke:c,strokeWidth:d,pointerEvents:"none"})))}CT.displayName="MiniMap";var uO=D.memo(CT);function dO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},K.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function hO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},K.createElement("path",{d:"M0 0h32v4.2H0z"}))}function fO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},K.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function pO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},K.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function mO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},K.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const $l=({children:t,className:e,...n})=>K.createElement("button",{type:"button",className:Dt(["react-flow__controls-button",e]),...n},t);$l.displayName="ControlButton";const gO=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom}),AT=({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:l,className:c,children:d,position:h="bottom-left"})=>{const f=vt(),[m,b]=D.useState(!1),{isInteractive:x,minZoomReached:R,maxZoomReached:y}=Be(gO,Pt),{zoomIn:v,zoomOut:T,fitView:A}=Vr();if(D.useEffect(()=>{b(!0)},[]),!m)return null;const O=()=>{v(),s==null||s()},L=()=>{T(),o==null||o()},S=()=>{A(i),a==null||a()},I=()=>{f.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),l==null||l(!x)};return K.createElement(P0,{className:Dt(["react-flow__controls",c]),position:h,style:t,"data-testid":"rf__controls"},e&&K.createElement(K.Fragment,null,K.createElement($l,{onClick:O,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y},K.createElement(dO,null)),K.createElement($l,{onClick:L,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:R},K.createElement(hO,null))),n&&K.createElement($l,{className:"react-flow__controls-fitview",onClick:S,title:"fit view","aria-label":"fit view"},K.createElement(fO,null)),r&&K.createElement($l,{className:"react-flow__controls-interactive",onClick:I,title:"toggle interactivity","aria-label":"toggle interactivity"},x?K.createElement(mO,null):K.createElement(pO,null)),d)};AT.displayName="Controls";var yO=D.memo(AT),hr;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(hr||(hr={}));function vO({color:t,dimensions:e,lineWidth:n}){return K.createElement("path",{stroke:t,strokeWidth:n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function _O({color:t,radius:e}){return K.createElement("circle",{cx:e,cy:e,r:e,fill:t})}const wO={[hr.Dots]:"#91919a",[hr.Lines]:"#eee",[hr.Cross]:"#e2e2e2"},xO={[hr.Dots]:1,[hr.Lines]:1,[hr.Cross]:6},EO=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function kT({id:t,variant:e=hr.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=2,color:o,style:a,className:l}){const c=D.useRef(null),{transform:d,patternId:h}=Be(EO,Pt),f=o||wO[e],m=r||xO[e],b=e===hr.Dots,x=e===hr.Cross,R=Array.isArray(n)?n:[n,n],y=[R[0]*d[2]||1,R[1]*d[2]||1],v=m*d[2],T=x?[v,v]:y,A=b?[v/s,v/s]:[T[0]/s,T[1]/s];return K.createElement("svg",{className:Dt(["react-flow__background",l]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:c,"data-testid":"rf__background"},K.createElement("pattern",{id:h+t,x:d[0]%y[0],y:d[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${A[0]},-${A[1]})`},b?K.createElement(_O,{color:f,radius:v/s}):K.createElement(vO,{dimensions:T,color:f,lineWidth:i})),K.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${h+t})`}))}kT.displayName="Background";var bO=D.memo(kT),ma;(function(t){t.Line="line",t.Handle="handle"})(ma||(ma={}));function IO({width:t,prevWidth:e,height:n,prevHeight:r,invertX:i,invertY:s}){const o=t-e,a=n-r,l=[o>0?1:o<0?-1:0,a>0?1:a<0?-1:0];return o&&i&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}const RT={width:0,height:0,x:0,y:0},TO={...RT,pointerX:0,pointerY:0,aspectRatio:1};function SO({nodeId:t,position:e,variant:n=ma.Handle,className:r,style:i={},children:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,shouldResize:f,onResizeStart:m,onResize:b,onResizeEnd:x}){const R=UI(),y=typeof t=="string"?t:R,v=vt(),T=D.useRef(null),A=D.useRef(TO),O=D.useRef(RT),L=pT(),S=n===ma.Line?"right":"bottom-right",I=e??S;D.useEffect(()=>{if(!T.current||!y)return;const P=An(T.current),k=I.includes("right")||I.includes("left"),N=I.includes("bottom")||I.includes("top"),j=I.includes("left"),z=I.includes("top"),B=gI().on("start",F=>{const M=v.getState().nodeInternals.get(y),{xSnapped:U,ySnapped:G}=L(F);O.current={width:(M==null?void 0:M.width)??0,height:(M==null?void 0:M.height)??0,x:(M==null?void 0:M.position.x)??0,y:(M==null?void 0:M.position.y)??0},A.current={...O.current,pointerX:U,pointerY:G,aspectRatio:O.current.width/O.current.height},m==null||m(F,{...O.current})}).on("drag",F=>{const{nodeInternals:M,triggerNodeChanges:U}=v.getState(),{xSnapped:G,ySnapped:$}=L(F),X=M.get(y);if(X){const Y=[],{pointerX:ee,pointerY:ne,width:fe,height:ce,x:xe,y:ye,aspectRatio:ke}=A.current,{x:Re,y:He,width:Oe,height:Pe}=O.current,ut=Math.floor(k?G-ee:0),Se=Math.floor(N?$-ne:0);let se=cs(fe+(j?-ut:ut),a,c),Ce=cs(ce+(z?-Se:Se),l,d);if(h){const pt=se/Ce,De=k&&N,Le=k&&!N,St=N&&!k;se=pt<=ke&&De||St?Ce*ke:se,Ce=pt>ke&&De||Le?se/ke:Ce,se>=c?(se=c,Ce=c/ke):se<=a&&(se=a,Ce=a/ke),Ce>=d?(Ce=d,se=d*ke):Ce<=l&&(Ce=l,se=l*ke)}const Tt=se!==Oe,xn=Ce!==Pe;if(j||z){const pt=j?xe-(se-fe):xe,De=z?ye-(Ce-ce):ye,Le=pt!==Re&&Tt,St=De!==He&&xn;if(Le||St){const Yt={id:X.id,type:"position",position:{x:Le?pt:Re,y:St?De:He}};Y.push(Yt),O.current.x=Yt.position.x,O.current.y=Yt.position.y}}if(Tt||xn){const pt={id:y,type:"dimensions",updateStyle:!0,resizing:!0,dimensions:{width:se,height:Ce}};Y.push(pt),O.current.width=se,O.current.height=Ce}if(Y.length===0)return;const dt=IO({width:O.current.width,prevWidth:Oe,height:O.current.height,prevHeight:Pe,invertX:j,invertY:z}),Ut={...O.current,direction:dt};if((f==null?void 0:f(F,Ut))===!1)return;b==null||b(F,Ut),U(Y)}}).on("end",F=>{const M={id:y,type:"dimensions",resizing:!1};x==null||x(F,{...O.current}),v.getState().triggerNodeChanges([M])});return P.call(B),()=>{P.on(".drag",null)}},[y,I,a,l,c,d,h,L,m,b,x]);const w=I.split("-"),E=n===ma.Line?"borderColor":"backgroundColor",C=o?{...i,[E]:o}:i;return K.createElement("div",{className:Dt(["react-flow__resize-control","nodrag",...w,n,r]),ref:T,style:C},s)}var Pw=D.memo(SO);const CO=["top-left","top-right","bottom-left","bottom-right"],AO=["top","right","bottom","left"];function Ga({nodeId:t,isVisible:e=!0,handleClassName:n,handleStyle:r,lineClassName:i,lineStyle:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,shouldResize:f,onResizeStart:m,onResize:b,onResizeEnd:x}){return e?K.createElement(K.Fragment,null,AO.map(R=>K.createElement(Pw,{key:R,className:i,style:s,nodeId:t,position:R,variant:ma.Line,color:o,minWidth:a,minHeight:l,maxWidth:c,maxHeight:d,onResizeStart:m,keepAspectRatio:h,shouldResize:f,onResize:b,onResizeEnd:x})),CO.map(R=>K.createElement(Pw,{key:R,className:n,style:r,nodeId:t,position:R,color:o,minWidth:a,minHeight:l,maxWidth:c,maxHeight:d,onResizeStart:m,keepAspectRatio:h,shouldResize:f,onResize:b,onResizeEnd:x}))):null}/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),PT=(...t)=>t.filter((e,n,r)=>!!e&&r.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var RO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=D.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>D.createElement("svg",{ref:l,...RO,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:PT("lucide",i),...a},[...o.map(([c,d])=>D.createElement(c,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=(t,e)=>{const n=D.forwardRef(({className:r,...i},s)=>D.createElement(PO,{ref:s,iconNode:e,className:PT(`lucide-${kO(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=oe("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NO=oe("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=oe("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=oe("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=oe("BoxSelect",[["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M21 14v1",key:"169vum"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NT=oe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DT=oe("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=oe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zO=oe("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=oe("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=oe("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=oe("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FO=oe("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=oe("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=oe("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UO=oe("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=oe("CornerDownRight",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=oe("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=oe("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=oe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B0=oe("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KO=oe("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OT=oe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=oe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GO=oe("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WO=oe("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dw=oe("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QO=oe("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YO=oe("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q0=oe("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gr=oe("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=oe("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K0=oe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=oe("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=oe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G0=oe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zT=oe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=oe("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=oe("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LT=oe("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=oe("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MT=oe("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tp=oe("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=oe("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=oe("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=oe("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=oe("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=oe("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wa=oe("PinOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V17h12",key:"13x2n8"}],["path",{d:"M15 9.34V6h1a2 2 0 0 0 0-4H7.89",key:"reo3ki"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qa=oe("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=oe("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vw=oe("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=oe("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jT=oe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=oe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=oe("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=oe("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FT=oe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $T=oe("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=oe("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=oe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UT=oe("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BT=oe("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=oe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=oe("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=oe("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=oe("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=oe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=oe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=oe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=oe("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=oe("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),vz=({connectionColor:t="#dc2626",setConnectionColor:e=()=>{},connectionLineType:n,setConnectionLineType:r,lastSaved:i,onSave:s,onLoad:o,onClear:a,onHelp:l,isDarkMode:c,toggleTheme:d,searchTerm:h,setSearchTerm:f,onExport:m,isOpen:b,onToggle:x,onOpenCaseManager:R,currentBoardName:y,onToggleZen:v,onNextMatch:T,onPrevMatch:A,onToggleBg:O,onLogout:L,currentUser:S,isSyncing:I})=>{const w=D.useRef(null),[E,C]=D.useState(()=>{try{const j=localStorage.getItem("sidebar-sections");return j?JSON.parse(j):{evidence:!0,connection:!0,extras:!0,zones:!0}}catch{return{evidence:!0,connection:!0,extras:!0,zones:!0}}});D.useEffect(()=>{localStorage.setItem("sidebar-sections",JSON.stringify(E))},[E]);const P=j=>{C(z=>({...z,[j]:!z[j]}))},k=()=>{const j=Object.values(E).some(z=>z);C(Object.keys(E).reduce((z,B)=>({...z,[B]:!j}),{}))},N=(j,z,B)=>{j.dataTransfer.setData("application/reactflow",z),j.dataTransfer.setData("application/category",B),j.dataTransfer.effectAllowed="move"};return p.jsxs("div",{className:`absolute top-0 left-0 h-full z-50 transition-transform duration-300 ease-in-out ${b?"translate-x-0":"-translate-x-full"}`,children:[p.jsxs("aside",{className:`h-full w-80 border-r flex flex-col shadow-2xl backdrop-blur-xl transition-colors duration-500 ease-in-out ${c?"bg-zinc-900/95 border-zinc-800":"bg-white/90 border-gray-200"}`,children:[p.jsxs("div",{className:`p-3 border-b transition-colors duration-500 ${c?"border-zinc-800":"border-gray-200"}`,children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("div",{children:p.jsxs("h1",{className:"text-lg font-bold text-red-500 tracking-widest uppercase leading-tight",children:["Detective",p.jsx("br",{}),"Board"]})}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:k,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:Object.values(E).some(j=>j)?"Colapsar todo":"Expandir todo",children:Object.values(E).some(j=>j)?p.jsx(jO,{size:16}):p.jsx(MO,{size:16})}),p.jsx("button",{onClick:v,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Modo Zen (Pantalla Completa)",children:p.jsx(ZO,{size:16})}),p.jsx("button",{onClick:O,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Cambiar Fondo (Corcho/Pizarra/Papel)",children:p.jsx(rz,{size:16})}),p.jsx("button",{onClick:d,className:`p-2 rounded-full ${c?"bg-zinc-800 text-yellow-400 hover:bg-zinc-700":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Cambiar tema",children:c?p.jsx(BT,{size:16}):p.jsx(MT,{size:16})})]})]}),y&&p.jsxs("div",{className:"mt-2 px-2 py-1 bg-zinc-100/5 rounded border border-zinc-500/20",children:[p.jsx("p",{className:"text-xs text-zinc-500 font-mono uppercase mb-0",children:"Expediente:"}),p.jsx("p",{className:`text-xs font-bold font-mono truncate w-full ${c?"text-yellow-500":"text-yellow-700"}`,title:y,children:y})]})]}),p.jsx("div",{className:"px-3 pt-2 pb-1",children:p.jsxs("div",{className:`flex items-center px-2 py-1.5 rounded border transition-colors duration-500 ${c?"bg-zinc-950 border-zinc-800":"bg-white border-gray-300"}`,children:[p.jsx(FT,{size:12,className:"text-zinc-500 mr-2"}),p.jsx("input",{type:"text",name:"search",placeholder:"Buscar pistas...",value:h,onChange:j=>f(j.target.value),className:`bg-transparent w-full text-xs outline-none font-mono ${c?"text-zinc-300 placeholder-zinc-600":"text-zinc-700 placeholder-zinc-400"}`}),h&&p.jsxs("div",{className:"flex gap-1 ml-1 border-l border-zinc-700 pl-1",children:[p.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),A()},className:"p-0.5 hover:text-white text-zinc-500 transition-colors",title:"Anterior",children:p.jsx(VO,{size:12})}),p.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),T()},className:"p-0.5 hover:text-white text-zinc-500 transition-colors",title:"Siguiente",children:p.jsx(NO,{size:12})})]})]})}),p.jsxs("div",{className:"p-3 space-y-2 overflow-y-auto",children:[p.jsx(ed,{title:"Evidencia",icon:GO,isDarkMode:c,isOpen:E.evidence,onToggle:()=>P("evidence"),children:p.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[p.jsx(Ct,{onDragStart:N,type:"evidence",category:"person",icon:W0,label:"Sospechoso",color:"border-blue-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"evidence",category:"place",icon:zT,label:"Lugar",color:"border-green-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"evidence",category:"clue",icon:H0,label:"Pista",color:"border-yellow-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"evidence",category:"event",icon:NT,label:"Evento",color:"border-red-500",isDarkMode:c,compact:!0})]})}),p.jsxs(ed,{title:"Configuracin de Hilo",icon:Jm,isDarkMode:c,isOpen:E.connection,onToggle:()=>P("connection"),children:[p.jsx("div",{className:"flex items-center justify-center gap-3 mb-2 px-1 py-0.5",children:[{color:"#dc2626",label:"Rojo"},{color:"#3b82f6",label:"Azul"},{color:"#22c55e",label:"Verde"},{color:"#eab308",label:"Amarillo"},{color:"#a855f7",label:"Morado"}].map(j=>p.jsx("button",{onClick:()=>e(j.color),className:`w-5 h-5 rounded-full border-2 transition-all ${t===j.color?"border-white scale-100 ring-1 ring-zinc-500":"border-transparent hover:scale-100"}`,style:{backgroundColor:j.color},title:j.label},j.color))}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:()=>r("straight"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="straight"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Recta",children:p.jsx(LT,{size:14})}),p.jsx("button",{onClick:()=>r("default"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="default"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Curva",children:p.jsx(Jm,{size:14})}),p.jsx("button",{onClick:()=>r("step"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="step"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Escalonada",children:p.jsx(VT,{size:14})})]})]}),p.jsx(ed,{title:"Extras",icon:XO,isDarkMode:c,isOpen:E.extras,onToggle:()=>P("extras"),children:p.jsxs("div",{className:"grid grid-cols-4 gap-1.5",children:[p.jsx(Ct,{onDragStart:N,type:"note",category:"note",icon:UT,label:"Nota",color:"border-yellow-400",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"text",category:"text",icon:qT,label:"Texto",color:"border-zinc-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"image",category:"image",icon:q0,label:"Imagen",color:"border-purple-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"url",category:"url",icon:K0,label:"URL",color:"border-blue-500",isDarkMode:c,compact:!0})]})}),p.jsx(ed,{title:"Zonas y Sellos",icon:Nw,isDarkMode:c,isOpen:E.zones,onToggle:()=>P("zones"),children:p.jsxs("div",{className:"space-y-2",children:[p.jsx(Ct,{onDragStart:N,type:"zone",category:"zone",icon:Nw,label:"Zona de Grupo",color:"border-zinc-600",isDarkMode:c}),p.jsxs("div",{className:"grid grid-cols-3 gap-1.5 pt-1",children:[p.jsx(Ct,{onDragStart:N,type:"stamp",category:"solved",icon:FO,label:"Resuelto",color:"border-green-600",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"stamp",category:"discarded",icon:$O,label:"Descartado",color:"border-red-600",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"stamp",category:"key",icon:fz,label:"Clave",color:"border-yellow-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"stamp",category:"question",icon:Zm,label:"?",color:"border-blue-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"stamp",category:"important",icon:HT,label:"!",color:"border-orange-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"stamp",category:"verify",icon:OT,label:"Ojo",color:"border-purple-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"stamp",category:"danger",icon:$T,label:"Peligro",color:"border-red-600",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"stamp",category:"confidential",icon:Ra,label:"Top",color:"border-zinc-500",isDarkMode:c,compact:!0}),p.jsx(Ct,{onDragStart:N,type:"stamp",category:"custom",icon:iz,label:"Personalizado",color:"border-zinc-400",isDarkMode:c,compact:!0})]})]})})]}),p.jsxs("div",{className:`mt-auto p-3 border-t space-y-2 transition-colors duration-500 ${c?"border-zinc-800":"border-gray-200"}`,children:[p.jsxs("button",{onClick:R,title:"Abrir gestor de expedientes",className:`w-full py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-yellow-900/20 text-yellow-500 border-yellow-900/50 hover:bg-yellow-900/40":"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100"}`,children:[p.jsx(WO,{size:14})," Gestionar Casos"]}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsxs("button",{onClick:s,className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Guardar (JSON)",children:[p.jsx(dz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Guardar"})]}),p.jsxs("button",{onClick:()=>w.current.click(),className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Cargar (JSON)",children:[p.jsx(mz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Cargar"})]}),p.jsxs("button",{onClick:m,className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Exportar (PNG)",children:[p.jsx(qO,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"PNG"})]})]}),p.jsx("input",{type:"file",name:"file-upload",ref:w,onChange:o,className:"hidden",accept:".json"}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("button",{onClick:a,title:"Borrar todo el contenido",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-red-900/20 text-red-500 border-red-900/50 hover:bg-red-900/40":"bg-red-50 text-red-600 border-red-200 hover:bg-red-100"}`,children:[p.jsx(eg,{size:14})," Limpiar"]}),p.jsxs("button",{onClick:l,title:"Ver atajos de teclado",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,children:[p.jsx(Zm,{size:14})," Ayuda"]})]}),i&&p.jsxs("div",{className:`text-[10px] text-center mt-2 font-mono ${c?"text-zinc-600":"text-gray-400"}`,children:["Guardado: ",i.toLocaleTimeString()]}),p.jsxs("button",{onClick:L,className:`w-full py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 mt-2 ${c?"bg-red-950/50 text-red-500 border-red-900/30 hover:bg-red-900/40":"bg-red-50 text-red-600 border-red-200 hover:bg-red-100"}`,children:[p.jsx(JO,{size:14})," Cerrar Sesin"]})]})]}),p.jsx("button",{onClick:x,className:`absolute top-6 -right-8 p-1.5 rounded-r-md shadow-md border-y border-r cursor-pointer flex items-center justify-center transition-colors duration-500 ${c?"bg-zinc-900 border-zinc-800 text-zinc-400 hover:text-white":"bg-white border-gray-200 text-zinc-600 hover:text-black"}`,title:b?"Ocultar barra lateral":"Mostrar barra lateral",children:b?p.jsx(zO,{size:16}):p.jsx(LO,{size:16})})]})},ed=({title:t,icon:e,isDarkMode:n,children:r,isOpen:i,onToggle:s})=>p.jsxs("div",{className:`p-2 rounded-lg border transition-all duration-200 ${n?"bg-zinc-950/50 border-zinc-800":"bg-white border-gray-200 shadow-sm"}`,children:[p.jsxs("button",{onClick:s,className:`w-full text-xs font-bold uppercase flex items-center justify-between gap-2 ${n?"text-zinc-500 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(e,{size:10})," ",t]}),p.jsx("div",{className:`transition-transform duration-300 ${i?"rotate-0":"-rotate-90"}`,children:p.jsx(OO,{size:12})})]}),p.jsx("div",{className:`grid transition-all duration-300 ease-in-out ${i?"grid-rows-[1fr] opacity-100 mt-2":"grid-rows-[0fr] opacity-0 mt-0"}`,children:p.jsx("div",{className:"overflow-hidden",children:r})})]}),Ct=({onDragStart:t,type:e,category:n,icon:r,label:i,color:s,isDarkMode:o,compact:a})=>p.jsxs("div",{className:`${a?"flex flex-col items-center justify-center p-2 gap-1 text-center":"flex items-center gap-3 p-3"} rounded cursor-grab border-l-4 ${s.replace("border-","border-l-")} transition-all ${a?"hover:scale-105":"hover:translate-x-2"} ${o?"bg-zinc-800/40 border-y border-r border-zinc-800 hover:bg-zinc-800":"bg-white border-y border-r border-gray-200 hover:bg-gray-50 shadow-sm"}`,onDragStart:l=>t(l,e,n),draggable:!0,title:i,children:[p.jsx(r,{size:a?16:18,className:s.replace("border-","text-")}),p.jsx("span",{className:`${a?"text-[10px]":"text-sm"} font-bold font-mono ${o?"text-zinc-300":"text-zinc-700"}`,children:i})]}),_z=({isOpen:t,onClose:e,node:n,onSave:r,onDelete:i,isDarkMode:s})=>{const[o,a]=D.useState(""),[l,c]=D.useState(""),[d,h]=D.useState(""),[f,m]=D.useState("clue"),[b,x]=D.useState(!1);if(D.useEffect(()=>{n&&(a(n.data.label||""),c(n.data.description||""),h(n.data.image||""),m(n.data.category||"clue"),x(!1))},[n]),!t)return null;if(b)return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm",children:p.jsxs("div",{className:`${s?"bg-zinc-900":"bg-white"} border border-red-900/50 p-6 rounded-lg w-96 shadow-2xl animate-in fade-in zoom-in duration-200 text-center`,children:[p.jsx("h2",{className:"text-xl font-bold text-red-500 font-mono tracking-wider mb-4",children:"ELIMINAR EVIDENCIA?"}),p.jsx("p",{className:`${s?"text-zinc-400":"text-gray-600"} text-sm font-mono mb-6`,children:"Esta accin es irreversible. Ests seguro?"}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsx("button",{onClick:()=>x(!1),className:`px-4 py-2 ${s?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:"Cancelar"}),p.jsx("button",{onClick:()=>i(n.id),className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Confirmar"})]})]})});const R=y=>{y.preventDefault(),r(n.id,{...n.data,label:o,description:l,image:d,category:f}),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm",children:p.jsxs("div",{className:`${s?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-96 shadow-2xl animate-in fade-in zoom-in duration-200`,children:[p.jsxs("div",{className:`flex justify-between items-center mb-4 border-b ${s?"border-zinc-800":"border-gray-200"} pb-2`,children:[p.jsx("h2",{className:"text-xl font-bold text-red-500 font-mono tracking-wider",children:"EDITAR EVIDENCIA"}),p.jsx("button",{onClick:e,className:`${s?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(gs,{size:20})})]}),p.jsxs("form",{onSubmit:R,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-category",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Categora"}),p.jsxs("select",{id:"evidence-category",name:"evidence-category",value:f,onChange:y=>m(y.target.value),className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all text-sm`,children:[p.jsx("option",{value:"person",children:"Sospechoso"}),p.jsx("option",{value:"place",children:"Lugar"}),p.jsx("option",{value:"clue",children:"Pista"}),p.jsx("option",{value:"event",children:"Evento"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-title",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Ttulo"}),p.jsx("input",{id:"evidence-title",type:"text",name:"evidence-title",value:o,onChange:y=>a(y.target.value),className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all`,autoFocus:!0})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-description",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Descripcin"}),p.jsx("textarea",{id:"evidence-description",name:"evidence-description",value:l,onChange:y=>c(y.target.value),rows:4,className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-300":"bg-gray-50 border-gray-300 text-gray-700"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono text-sm resize-none transition-all`})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-image-url",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Imagen (URL o Local)"}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("input",{id:"evidence-image-url",type:"text",name:"evidence-image-url",value:d,onChange:y=>h(y.target.value),placeholder:"https://...",className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-400":"bg-gray-50 border-gray-300 text-gray-600"} border p-2 rounded focus:border-red-900 outline-none font-mono text-xs`}),p.jsx("div",{className:`text-[10px] ${s?"text-zinc-600":"text-gray-400"} text-center font-mono uppercase tracking-widest`,children:"- O -"}),p.jsxs("label",{className:`flex items-center justify-center w-full p-2 ${s?"bg-zinc-950 border-zinc-800 hover:border-zinc-600 hover:text-zinc-200":"bg-gray-50 border-gray-300 hover:border-gray-400 hover:text-gray-800"} border border-dashed rounded cursor-pointer transition-colors group`,children:[p.jsx("span",{className:`text-xs ${s?"text-zinc-500 group-hover:text-zinc-300":"text-gray-500 group-hover:text-gray-700"} font-mono uppercase`,children:"Subir archivo local"}),p.jsx("input",{type:"file",name:"evidence-image-file",className:"hidden",accept:"image/*",onChange:y=>{const v=y.target.files[0];if(v){const T=new FileReader;T.onload=A=>h(A.target.result),T.readAsDataURL(v)}}})]})]})]}),n.data.status&&p.jsx("div",{className:`flex justify-end pt-2 border-t ${s?"border-zinc-800":"border-gray-200"}`,children:p.jsxs("button",{type:"button",onClick:()=>{r(n.id,{...n.data,status:null}),e()},className:"text-[10px] flex items-center gap-1 text-orange-500 hover:text-orange-400 uppercase font-bold tracking-wider",children:[p.jsx(B0,{size:12})," Quitar Sello"]})}),p.jsxs("div",{className:`flex justify-between items-center mt-6 pt-4 border-t ${s?"border-zinc-800":"border-gray-200"}`,children:[p.jsx("button",{type:"button",onClick:()=>x(!0),className:"text-red-600 hover:text-red-500 text-xs font-bold uppercase tracking-wider transition-colors",children:"Eliminar"}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:`px-4 py-2 ${s?"text-zinc-400 hover:text-white":"text-gray-500 hover:text-gray-800"} text-xs font-bold uppercase tracking-wider transition-colors`,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Guardar"})]})]})]})]})})};let td;const wz=new Uint8Array(16);function xz(){if(!td&&(td=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!td))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return td(wz)}const zt=[];for(let t=0;t<256;++t)zt.push((t+256).toString(16).slice(1));function Ez(t,e=0){return zt[t[e+0]]+zt[t[e+1]]+zt[t[e+2]]+zt[t[e+3]]+"-"+zt[t[e+4]]+zt[t[e+5]]+"-"+zt[t[e+6]]+zt[t[e+7]]+"-"+zt[t[e+8]]+zt[t[e+9]]+"-"+zt[t[e+10]]+zt[t[e+11]]+zt[t[e+12]]+zt[t[e+13]]+zt[t[e+14]]+zt[t[e+15]]}const bz=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ow={randomUUID:bz};function kn(t,e,n){if(Ow.randomUUID&&!t)return Ow.randomUUID();t=t||{};const r=t.random||(t.rng||xz)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Ez(r)}function Iz({top:t,left:e,right:n,bottom:r,clientX:i,clientY:s,onHide:o,takeSnapshot:a,setNodes:l}){const{screenToFlowPosition:c,setCenter:d,getZoom:h}=Vr(),f=b=>{b.stopPropagation();const{x,y:R}=c({x:i,y:s});d(x,R,{zoom:h(),duration:800}),o()},m=D.useCallback((b,x,R)=>{const y=c({x:i,y:s}),v={id:kn(),type:b,position:y,data:{label:R,category:x}};a(),l(T=>T.concat(v)),o()},[i,s,c,a,l,o]);return p.jsxs("div",{style:{top:t,left:e,right:n,bottom:r},className:"absolute z-50 bg-zinc-800 border border-zinc-700 shadow-xl rounded-md overflow-hidden min-w-[150px] flex flex-col animate-in fade-in zoom-in duration-100",children:[p.jsxs("button",{onClick:f,className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors border-b border-zinc-700",children:[p.jsx(HO,{size:14,className:"text-blue-400"})," Centrar Vista"]}),p.jsxs("button",{onClick:()=>m("note","note","Nota"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(UT,{size:14,className:"text-yellow-500"})," Aadir Nota"]}),p.jsxs("button",{onClick:()=>m("text","text","Texto"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(qT,{size:14,className:"text-zinc-400"})," Aadir Texto"]}),p.jsxs("button",{onClick:()=>m("image","image","Imagen"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(q0,{size:14,className:"text-purple-500"})," Aadir Imagen"]}),p.jsxs("button",{onClick:()=>m("url","url","Enlace"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(K0,{size:14,className:"text-blue-400"})," Aadir URL"]})]})}const Tz=({isOpen:t,onClose:e,onConfirm:n,title:r,message:i,confirmText:s="Confirmar",cancelText:o="Cancelar",isDanger:a=!1,isDarkMode:l})=>t?p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[300] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${l?"bg-zinc-900":"bg-white"} border ${a?"border-red-900/50":l?"border-zinc-700":"border-gray-200"} p-6 rounded-lg w-96 shadow-2xl animate-in zoom-in duration-200 text-center`,children:[p.jsx("h2",{className:`text-xl font-bold ${a?"text-red-500":l?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-4`,children:r}),p.jsx("p",{className:`${l?"text-zinc-400":"text-gray-600"} text-sm font-mono mb-6`,children:i}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsx("button",{onClick:e,className:`px-4 py-2 ${l?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:o}),p.jsx("button",{onClick:()=>{n&&n(),e()},className:`px-6 py-2 ${a?"bg-red-900/80 hover:bg-red-800 text-red-100 border-red-900":"bg-blue-900/80 hover:bg-blue-800 text-blue-100 border-blue-900"} text-xs font-bold uppercase tracking-wider rounded shadow-lg border transition-all`,children:s})]})]})}):null,Sz=({isOpen:t,onClose:e,isDarkMode:n})=>{if(!t)return null;const r=[{key:"Doble Clic (Nodo)",desc:"Editar contenido de la evidencia",icon:Tp},{key:"Doble Clic (Hilo)",desc:"Aadir/Editar etiqueta de relacin",icon:Tp},{key:"Clic (Hilo)",desc:"Cambiar estilo (Slido / Punteado)",icon:Tp},{key:"Backspace",desc:"Eliminar elementos seleccionados",icon:Gr},{key:"Ctrl + D",desc:"Duplicar nodos seleccionados",icon:Gr},{key:"Ctrl + Z",desc:"Deshacer accin",icon:Gr},{key:"Ctrl + Y",desc:"Rehacer accin",icon:Gr},{key:"Ctrl + S",desc:"Guardar tablero manualmente",icon:Gr},{key:"Ctrl + V",desc:"Pegar imagen del portapapeles",icon:Gr},{key:"F3 / Shift + F3",desc:"Navegar resultados de bsqueda",icon:Gr},{key:"Shift + C",desc:"Conectar nodos seleccionados",icon:Gr},{key:"Ctrl + Shift + L",desc:"Bloquear/Desbloquear seleccin",icon:Ra}];return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${n?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-[500px] shadow-2xl animate-in zoom-in duration-200 relative`,children:[p.jsx("button",{onClick:e,className:`absolute top-4 right-4 ${n?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(gs,{size:20})}),p.jsxs("h2",{className:`text-xl font-bold ${n?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-6 flex items-center gap-2`,children:[p.jsx(Gr,{className:"text-red-500"})," ATAJOS DE TECLADO"]}),p.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.map((i,s)=>p.jsxs("div",{className:`flex items-center justify-between p-2 rounded border transition-colors ${n?"bg-zinc-950/50 border-zinc-800/50 hover:border-zinc-700":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(i.icon,{size:14,className:n?"text-zinc-500":"text-gray-400"}),p.jsx("span",{className:`${n?"text-zinc-300":"text-gray-700"} text-sm font-mono`,children:i.desc})]}),p.jsx("span",{className:"text-xs font-bold text-red-400 bg-red-900/10 px-2 py-1 rounded border border-red-900/20 font-mono",children:i.key})]},s))})]})})},Cz=({isOpen:t,onClose:e,onConfirm:n,onDelete:r,title:i,initialValue:s="",initialColor:o="#dc2626",initialType:a,showTypeSelector:l=!1,colorLabel:c="Color",placeholder:d="Escribe una relacin...",isDarkMode:h})=>{const[f,m]=D.useState(s),[b,x]=D.useState(o),[R,y]=D.useState(a||"default");if(D.useEffect(()=>{t&&(m(s),x(o),a&&y(a))},[t,s,o,a]),!t)return null;const v=[{color:"#dc2626",label:"Rojo"},{color:"#3b82f6",label:"Azul"},{color:"#22c55e",label:"Verde"},{color:"#eab308",label:"Amarillo"},{color:"#a855f7",label:"Morado"}],T=A=>{A.preventDefault(),n(f,b,R),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${h?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-96 shadow-2xl animate-in zoom-in duration-200`,children:[p.jsx("h2",{className:`text-xl font-bold ${h?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-4`,children:i}),p.jsxs("form",{onSubmit:T,children:[p.jsx("input",{type:"text",name:"input-value",value:f,onChange:A=>m(A.target.value),className:`w-full ${h?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all mb-4`,autoFocus:!0,placeholder:d}),l&&p.jsxs("div",{className:"mb-4",children:[p.jsx("span",{className:`block text-xs font-bold ${h?"text-zinc-500":"text-gray-500"} uppercase mb-2 font-mono`,children:"Tipo de Conexin"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{type:"button",onClick:()=>y("straight"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="straight"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Recta",children:p.jsx(LT,{size:16})}),p.jsx("button",{type:"button",onClick:()=>y("default"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="default"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Curva",children:p.jsx(Jm,{size:16})}),p.jsx("button",{type:"button",onClick:()=>y("step"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="step"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Escalonada",children:p.jsx(VT,{size:16})})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("span",{className:`block text-xs font-bold ${h?"text-zinc-500":"text-gray-500"} uppercase mb-2 font-mono`,children:c}),p.jsx("div",{className:"flex gap-3",children:v.map(A=>p.jsx("button",{type:"button",onClick:()=>x(A.color),className:`w-6 h-6 rounded-full border-2 transition-all ${b===A.color?(h?"border-white ring-zinc-400":"border-gray-800 ring-gray-400")+" scale-110 ring-1":"border-transparent hover:scale-110"}`,style:{backgroundColor:A.color},title:A.label},A.color))})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[r?p.jsx("button",{type:"button",onClick:r,className:"text-red-600 hover:text-red-500 text-xs font-bold uppercase tracking-wider transition-colors",children:"Eliminar"}):p.jsx("div",{}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:`px-4 py-2 ${h?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Guardar"})]})]})]})]})})},Az=({isOpen:t,onClose:e,boards:n,currentBoardId:r,onSwitch:i,onCreate:s,onDelete:o,onRename:a,onClone:l,onReorder:c,trash:d,onRestore:h,onPermanentDelete:f,isDarkMode:m})=>{const[b,x]=D.useState(null),[R,y]=D.useState(""),[v,T]=D.useState(!1),[A,O]=D.useState(""),[L,S]=D.useState(null),[I,w]=D.useState(""),[E,C]=D.useState("manual"),[P,k]=D.useState(!1),N=D.useMemo(()=>{let X=(P?d:n).filter(Y=>Y.name.toLowerCase().includes(I.toLowerCase()));return E==="name"?X.sort((Y,ee)=>Y.name.localeCompare(ee.name)):E==="created"?X.sort((Y,ee)=>ee.createdAt-Y.createdAt):E==="modified"?X.sort((Y,ee)=>(ee.lastModified||0)-(Y.lastModified||0)):X},[n,d,I,E,P]),j=E==="manual"&&!I&&!P,z=($,X)=>{$.dataTransfer.setData("boardIndex",X),$.dataTransfer.effectAllowed="move"},B=$=>{$.preventDefault(),$.dataTransfer.dropEffect="move"},F=($,X)=>{$.preventDefault();const Y=parseInt($.dataTransfer.getData("boardIndex"));if(isNaN(Y)||Y===X)return;const ee=[...n],[ne]=ee.splice(Y,1);ee.splice(X,0,ne),c(ee)};if(!t)return null;const M=$=>{x($.id),y($.name)},U=()=>{R.trim()&&a(b,R),x(null)},G=()=>{A.trim()&&(s(A),O(""),T(!1))};return p.jsx("div",{className:"fixed inset-0 bg-black/90 z-[200] flex items-center justify-center backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${m?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border w-[900px] h-[600px] rounded-lg shadow-2xl flex flex-col overflow-hidden`,children:[p.jsxs("div",{className:`p-6 border-b ${m?"border-zinc-800 bg-zinc-950":"border-gray-200 bg-gray-50"} flex justify-between items-center z-50 relative`,children:[p.jsxs("div",{children:[p.jsxs("h2",{className:`text-2xl font-bold ${m?"text-zinc-100":"text-gray-800"} font-mono tracking-widest flex items-center gap-3 uppercase`,children:[P?p.jsx(Vw,{className:"text-red-500",size:28}):p.jsx(Dw,{className:"text-yellow-600",size:28}),P?"PAPELERA DE RECICLAJE":"ARCHIVOS DE CASO"]}),p.jsx("p",{className:`${m?"text-zinc-500":"text-gray-500"} text-xs font-mono mt-1`,children:P?"Restaura casos eliminados o brralos definitivamente":"Selecciona un expediente para investigar"})]}),p.jsx("button",{onClick:e,className:`${m?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(gs,{size:24})})]}),p.jsxs("div",{className:`px-6 py-3 border-b flex gap-4 items-center justify-between ${m?"border-zinc-800 bg-zinc-900/50":"border-gray-200 bg-gray-50/50"}`,children:[p.jsxs("div",{className:`flex-1 flex items-center px-3 py-1.5 rounded border ${m?"bg-zinc-950 border-zinc-700":"bg-white border-gray-300"}`,children:[p.jsx(FT,{size:14,className:m?"text-zinc-500":"text-gray-400"}),p.jsx("input",{type:"text",name:"case-search",placeholder:"Buscar expediente...",value:I,onChange:$=>w($.target.value),className:`ml-2 bg-transparent w-full text-xs outline-none font-mono ${m?"text-zinc-300 placeholder-zinc-600":"text-zinc-700 placeholder-zinc-400"}`})]}),p.jsxs("button",{onClick:()=>k(!P),className:`flex items-center gap-2 px-3 py-1.5 rounded border text-xs font-bold uppercase transition-colors ${P?m?"bg-red-900/30 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-600":m?"bg-zinc-900 border-zinc-700 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-600 hover:text-black"}`,children:[P?p.jsx(Dw,{size:14}):p.jsx(Vw,{size:14}),P?"Ver Archivos":"Papelera"]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(DO,{size:14,className:m?"text-zinc-500":"text-gray-400"}),p.jsxs("select",{name:"sort-cases",value:E,onChange:$=>C($.target.value),className:`text-xs font-mono p-1.5 rounded border outline-none cursor-pointer ${m?"bg-zinc-950 border-zinc-700 text-zinc-300":"bg-white border-gray-300 text-zinc-700"}`,children:[p.jsx("option",{value:"manual",children:"Manual (Arrastrar)"}),p.jsx("option",{value:"name",children:"Nombre (A-Z)"}),p.jsx("option",{value:"created",children:"Creado (Reciente)"}),p.jsx("option",{value:"modified",children:"Modificado (Reciente)"})]})]})]}),p.jsx("div",{className:`flex-1 p-8 overflow-y-auto overflow-x-hidden ${m?"bg-zinc-900/50":"bg-gray-100"}`,children:p.jsxs("div",{className:"flex flex-wrap justify-center items-start gap-y-12 pl-8 pb-12 pt-[2px]",children:[!I&&!P&&(v?p.jsx("div",{className:"relative w-56 h-40 -ml-12 first:ml-0 z-50 transition-all duration-300 shadow-2xl transform scale-105",children:p.jsxs("div",{className:`flex flex-col items-center justify-center h-full border-2 border-dashed border-yellow-600/50 bg-yellow-900/10 rounded-lg p-4 animate-in zoom-in duration-200 ${m?"bg-zinc-900":"bg-white"}`,children:[p.jsx("span",{className:"text-yellow-500 font-mono text-xs font-bold mb-2",children:"NOMBRE DEL CASO"}),p.jsx("input",{type:"text",name:"new-case-name",autoFocus:!0,value:A,onChange:$=>O($.target.value),onKeyDown:$=>{$.key==="Enter"&&G(),$.key==="Escape"&&T(!1)},placeholder:"Ej: El Robo del Siglo",className:`${m?"bg-zinc-950 border-zinc-700 text-white":"bg-white border-gray-300 text-gray-900"} border text-xs p-2 w-full rounded outline-none focus:border-yellow-600 font-mono text-center mb-2`}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>T(!1),className:`${m?"text-zinc-500 hover:text-white hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 hover:bg-gray-200"} text-[10px] uppercase font-bold px-2 py-1 rounded`,children:"Cancelar"}),p.jsx("button",{onClick:G,className:"text-zinc-900 bg-yellow-600 hover:bg-yellow-500 text-[10px] uppercase font-bold px-3 py-1 rounded",children:"Crear"})]})]})}):p.jsx("button",{onClick:()=>{T(!0),O(`Caso #${n.length+1}`)},className:"relative w-56 h-40 -ml-12 first:ml-0 transition-all duration-300 group",style:{zIndex:L==="new"?50:0,transform:L==="new"?"translateY(-1rem) scale(1.05) rotate(0deg)":"rotate(-3deg)"},onMouseEnter:()=>S("new"),onMouseLeave:()=>S(null),children:p.jsxs("div",{className:`flex flex-col items-center justify-center h-full border-2 border-dashed rounded-lg shadow-lg ${m?"border-zinc-700 hover:border-zinc-500 bg-zinc-800/50":"border-gray-300 hover:border-gray-400 bg-white"}`,children:[p.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 transition-all group-hover:scale-110 ${m?"bg-zinc-800 group-hover:bg-zinc-700":"bg-gray-200 group-hover:bg-gray-300"}`,children:p.jsx(az,{className:m?"text-zinc-400 group-hover:text-white":"text-gray-500 group-hover:text-gray-800"})}),p.jsx("span",{className:`${m?"text-zinc-400 group-hover:text-white":"text-gray-500 group-hover:text-gray-800"} font-mono text-sm font-bold`,children:"NUEVO CASO"})]})})),N.map(($,X)=>{const Y=L===$.id,ee=r===$.id,ne=$.isDeleting,fe=X%3===0?"2deg":X%3===1?"-1deg":"3deg";return p.jsx("div",{draggable:j,onDragStart:ce=>z(ce,X),onDragOver:B,onDrop:ce=>F(ce,X),className:"relative w-56 h-40 -ml-12 transition-all duration-300 ease-out cursor-pointer group",style:{zIndex:Y?50:X+1,transform:Y?"translateY(-1.5rem) scale(1.1) rotate(0deg)":`rotate(${fe})`,animation:ne?"delete-burn 0.5s ease-in-out forwards":"none",pointerEvents:ne?"none":"auto"},onMouseEnter:()=>S($.id),onMouseLeave:()=>S(null),onClick:()=>{b!==$.id&&!P&&i($.id)},children:p.jsxs("div",{className:`relative flex flex-col h-full border-2 rounded-lg overflow-hidden shadow-[0_5px_15px_rgba(0,0,0,0.5)] transition-colors duration-300
                    ${ee?m?"border-yellow-500 bg-yellow-900/40":"border-yellow-500 bg-yellow-100":m?P?"border-zinc-700 bg-zinc-900/50":"border-yellow-900/40 bg-yellow-950/30 hover:border-yellow-700 hover:bg-yellow-900/20":P?"border-gray-300 bg-gray-100":"border-yellow-200 bg-yellow-50 hover:border-yellow-300 hover:bg-yellow-100"}
                `,children:[j&&Y&&p.jsx("div",{className:"absolute top-2 right-2 text-yellow-600/50",children:p.jsx(YO,{size:16})}),p.jsx("div",{className:`absolute top-0 left-0 w-24 h-6 rounded-br-lg border-b-2 border-r-2 shadow-sm transition-colors duration-300
                        ${ee?"bg-yellow-500 border-yellow-500":m?P?"bg-zinc-800 border-zinc-700":"bg-yellow-900/40 border-yellow-900/40 group-hover:bg-yellow-800 group-hover:border-yellow-700":P?"bg-gray-300 border-gray-300":"bg-yellow-200 border-yellow-200 group-hover:bg-yellow-300 group-hover:border-yellow-300"}
                    `}),p.jsxs("div",{className:"flex-1 p-4 pt-8 flex flex-col items-center justify-between text-center",children:[p.jsxs("div",{children:[p.jsx(H0,{size:32,className:`mb-2 drop-shadow-md transition-colors duration-300 ${ee?m?"text-yellow-400":"text-yellow-600":m?"text-yellow-800/60 group-hover:text-yellow-600":"text-yellow-300 group-hover:text-yellow-500"}`}),b===$.id?p.jsxs("div",{className:"flex items-center gap-1 w-full",onClick:ce=>ce.stopPropagation(),children:[p.jsx("input",{type:"text",name:"edit-case-name",value:R,onChange:ce=>y(ce.target.value),className:`${m?"bg-zinc-950 border-zinc-600 text-white":"bg-white border-gray-300 text-gray-900"} border text-xs p-1 w-full rounded outline-none focus:border-yellow-600 font-mono`,autoFocus:!0,onKeyDown:ce=>ce.key==="Enter"&&U()}),p.jsx("button",{onClick:U,className:"text-green-500 hover:text-green-400",children:p.jsx(DT,{size:14})})]}):p.jsx("h3",{className:`font-mono font-bold text-sm line-clamp-2 ${r===$.id?m?"text-yellow-100":"text-yellow-800":m?P?"text-zinc-500 line-through":"text-zinc-300":P?"text-gray-400 line-through":"text-gray-700"}`,onDoubleClick:ce=>{P||(ce.stopPropagation(),M($))},children:$.name})]}),p.jsxs("div",{className:`text-[10px] ${m?"text-zinc-500":"text-gray-500"} font-mono w-full`,children:[$.lastModified&&p.jsxs("p",{children:["Modif: ",new Date($.lastModified).toLocaleString([],{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),p.jsxs("p",{className:`${m?"text-zinc-600":"text-gray-400"}`,children:["Creado: ",new Date($.createdAt).toLocaleDateString()]})]})]}),p.jsx("div",{className:`absolute bottom-2 right-2 flex gap-1 ${P?"opacity-100":"opacity-0 group-hover:opacity-100"} transition-opacity z-50`,onClick:ce=>ce.stopPropagation(),children:P?p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:ce=>{ce.stopPropagation(),h($.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-green-500 hover:text-green-400 hover:bg-zinc-950 border-zinc-700":"bg-white text-green-600 hover:text-green-700 hover:bg-gray-50 border-gray-200"}`,title:"Restaurar Caso",children:p.jsx(jT,{size:12})}),p.jsx("button",{onClick:ce=>{ce.stopPropagation(),f($.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-red-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-red-600 hover:bg-gray-50 border-gray-200"}`,title:"Eliminar Definitivamente",children:p.jsx(eg,{size:12})})]}):p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:ce=>{ce.preventDefault(),ce.stopPropagation(),l($.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-green-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-green-600 hover:bg-gray-50 border-gray-200"}`,title:"Clonar Caso",children:p.jsx(UO,{size:12})}),p.jsx("button",{onClick:ce=>{ce.stopPropagation(),M($)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-blue-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-blue-600 hover:bg-gray-50 border-gray-200"}`,title:"Renombrar Caso",children:p.jsx(oz,{size:12})}),n.length>1&&p.jsx("button",{onClick:ce=>{ce.stopPropagation(),o($.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-red-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-red-600 hover:bg-gray-50 border-gray-200"}`,title:"Mover a Papelera",children:p.jsx(eg,{size:12})})]})})]})},$.id)})]})}),p.jsx("div",{className:`p-4 border-t text-center z-50 relative ${m?"bg-zinc-950 border-zinc-800":"bg-gray-50 border-gray-200"}`,children:p.jsx("p",{className:`${m?"text-zinc-600":"text-gray-400"} text-[10px] font-mono`,children:"CONFIDENCIAL - SOLO PARA USO OFICIAL"})})]})})},kz=({isZenMode:t,setIsZenMode:e,undo:n,redo:r,isDarkMode:i})=>p.jsxs("div",{className:"absolute top-4 right-4 z-50 flex gap-2",children:[!t&&p.jsxs(p.Fragment,{children:[p.jsxs("button",{onClick:n,className:`px-4 py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 shadow-lg ${i?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-white text-zinc-600 border-gray-300 hover:bg-gray-100"}`,title:"Deshacer (Ctrl+Z)",children:[p.jsx(pz,{size:14})," Deshacer"]}),p.jsxs("button",{onClick:r,className:`px-4 py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 shadow-lg ${i?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-white text-zinc-600 border-gray-300 hover:bg-gray-100"}`,title:"Rehacer (Ctrl+Y)",children:[p.jsx(lz,{size:14})," Rehacer"]})]}),t&&p.jsxs("button",{onClick:()=>e(!1),className:"px-4 py-2 bg-black/50 hover:bg-black/80 text-white border border-white/20 rounded backdrop-blur-sm flex items-center gap-2 transition-all animate-in fade-in",title:"Salir de Modo Zen (Esc)",children:[p.jsx(ez,{size:14})," Salir"]})]}),Q0=(t,e)=>{if(!t||!t.type.startsWith("image/"))return;const n=new FileReader;n.onload=r=>{const i=new Image;i.onload=()=>{let o=i.width,a=i.height;if(o>400||a>400){const h=o/a;o>a?(o=400,a=400/h):(a=400,o=400*h)}const l=document.createElement("canvas");l.width=o,l.height=a,l.getContext("2d").drawImage(i,0,0,o,a);const d=l.toDataURL("image/jpeg",.7);e(d,o,a)},i.src=r.target.result},n.readAsDataURL(t)},Rz=({isInteractive:t,reactFlowInstance:e,takeSnapshot:n,setNodes:r})=>{D.useEffect(()=>{const i=s=>{if(!t||!e)return;const o=s.clipboardData.items;for(const a of o)if(a.type.indexOf("image")!==-1){const l=a.getAsFile();Q0(l,(c,d,h)=>{const f=e.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2}),m={id:kn(),type:"image",position:f,data:{label:"Imagen Pegada",image:c},style:{width:d,height:h}};n(),r(b=>b.concat(m))})}};return window.addEventListener("paste",i),()=>window.removeEventListener("paste",i)},[e,t,n,r])};function Pz(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),e&&(r.href=e),i.href=t,i.href}const Nz=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function ns(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let Oo=null;function KT(t={}){return Oo||(t.includeStyleProperties?(Oo=t.includeStyleProperties,Oo):(Oo=ns(window.getComputedStyle(document.documentElement)),Oo))}function vh(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function Dz(t){const e=vh(t,"border-left-width"),n=vh(t,"border-right-width");return t.clientWidth+e+n}function Vz(t){const e=vh(t,"border-top-width"),n=vh(t,"border-bottom-width");return t.clientHeight+e+n}function GT(t,e={}){const n=e.width||Dz(t),r=e.height||Vz(t);return{width:n,height:r}}function Oz(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Sn=16384;function zz(t){(t.width>Sn||t.height>Sn)&&(t.width>Sn&&t.height>Sn?t.width>t.height?(t.height*=Sn/t.width,t.width=Sn):(t.width*=Sn/t.height,t.height=Sn):t.width>Sn?(t.height*=Sn/t.width,t.width=Sn):(t.width*=Sn/t.height,t.height=Sn))}function _h(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function Lz(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function Mz(t,e,n){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${e}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${e} ${n}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),i.appendChild(s),s.appendChild(t),Lz(i)}const yn=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||yn(n,e)};function jz(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function Fz(t,e){return KT(e).map(n=>{const r=t.getPropertyValue(n),i=t.getPropertyPriority(n);return`${n}: ${r}${i?" !important":""};`}).join(" ")}function $z(t,e,n,r){const i=`.${t}:${e}`,s=n.cssText?jz(n):Fz(n,r);return document.createTextNode(`${i}{${s}}`)}function zw(t,e,n,r){const i=window.getComputedStyle(t,n),s=i.getPropertyValue("content");if(s===""||s==="none")return;const o=Nz();try{e.className=`${e.className} ${o}`}catch{return}const a=document.createElement("style");a.appendChild($z(o,n,i,r)),e.appendChild(a)}function Uz(t,e,n){zw(t,e,":before",n),zw(t,e,":after",n)}const Lw="application/font-woff",Mw="image/jpeg",Bz={woff:Lw,woff2:Lw,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Mw,jpeg:Mw,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function Hz(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function Y0(t){const e=Hz(t).toLowerCase();return Bz[e]||""}function qz(t){return t.split(/,/)[1]}function tg(t){return t.search(/^(data:)/)!==-1}function Kz(t,e){return`data:${e};base64,${t}`}async function WT(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const i=await r.blob();return new Promise((s,o)=>{const a=new FileReader;a.onerror=o,a.onloadend=()=>{try{s(n({res:r,result:a.result}))}catch(l){o(l)}},a.readAsDataURL(i)})}const Sp={};function Gz(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function X0(t,e,n){const r=Gz(t,e,n.includeQueryParams);if(Sp[r]!=null)return Sp[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let i;try{const s=await WT(t,n.fetchRequestInit,({res:o,result:a})=>(e||(e=o.headers.get("Content-Type")||""),qz(a)));i=Kz(s,e)}catch(s){i=n.imagePlaceholder||"";let o=`Failed to fetch resource: ${t}`;s&&(o=typeof s=="string"?s:s.message),o&&console.warn(o)}return Sp[r]=i,i}async function Wz(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):_h(e)}async function Qz(t,e){if(t.currentSrc){const s=document.createElement("canvas"),o=s.getContext("2d");s.width=t.clientWidth,s.height=t.clientHeight,o==null||o.drawImage(t,0,0,s.width,s.height);const a=s.toDataURL();return _h(a)}const n=t.poster,r=Y0(n),i=await X0(n,r,e);return _h(i)}async function Yz(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await hf(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function Xz(t,e){return yn(t,HTMLCanvasElement)?Wz(t):yn(t,HTMLVideoElement)?Qz(t,e):yn(t,HTMLIFrameElement)?Yz(t,e):t.cloneNode(QT(t))}const Jz=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",QT=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function Zz(t,e,n){var r,i;if(QT(e))return e;let s=[];return Jz(t)&&t.assignedNodes?s=ns(t.assignedNodes()):yn(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?s=ns(t.contentDocument.body.childNodes):s=ns(((i=t.shadowRoot)!==null&&i!==void 0?i:t).childNodes),s.length===0||yn(t,HTMLVideoElement)||await s.reduce((o,a)=>o.then(()=>hf(a,n)).then(l=>{l&&e.appendChild(l)}),Promise.resolve()),e}function eL(t,e,n){const r=e.style;if(!r)return;const i=window.getComputedStyle(t);i.cssText?(r.cssText=i.cssText,r.transformOrigin=i.transformOrigin):KT(n).forEach(s=>{let o=i.getPropertyValue(s);s==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),yn(t,HTMLIFrameElement)&&s==="display"&&o==="inline"&&(o="block"),s==="d"&&e.getAttribute("d")&&(o=`path(${e.getAttribute("d")})`),r.setProperty(s,o,i.getPropertyPriority(s))})}function tL(t,e){yn(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),yn(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function nL(t,e){if(yn(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(i=>t.value===i.getAttribute("value"));r&&r.setAttribute("selected","")}}function rL(t,e,n){return yn(e,Element)&&(eL(t,e,n),Uz(t,e,n),tL(t,e),nL(t,e)),e}async function iL(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let s=0;s<n.length;s++){const a=n[s].getAttribute("xlink:href");if(a){const l=t.querySelector(a),c=document.querySelector(a);!l&&c&&!r[a]&&(r[a]=await hf(c,e,!0))}}const i=Object.values(r);if(i.length){const s="http://www.w3.org/1999/xhtml",o=document.createElementNS(s,"svg");o.setAttribute("xmlns",s),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const a=document.createElementNS(s,"defs");o.appendChild(a);for(let l=0;l<i.length;l++)a.appendChild(i[l]);t.appendChild(o)}return t}async function hf(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>Xz(r,e)).then(r=>Zz(t,r,e)).then(r=>rL(t,r,e)).then(r=>iL(r,e))}const YT=/url\((['"]?)([^'"]+?)\1\)/g,sL=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,oL=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function aL(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function lL(t){const e=[];return t.replace(YT,(n,r,i)=>(e.push(i),n)),e.filter(n=>!tg(n))}async function cL(t,e,n,r,i){try{const s=n?Pz(e,n):e,o=Y0(e);let a;return i||(a=await X0(s,o,r)),t.replace(aL(e),`$1${a}$3`)}catch{}return t}function uL(t,{preferredFontFormat:e}){return e?t.replace(oL,n=>{for(;;){const[r,,i]=sL.exec(n)||[];if(!i)return"";if(i===e)return`src: ${r};`}}):t}function XT(t){return t.search(YT)!==-1}async function JT(t,e,n){if(!XT(t))return t;const r=uL(t,n);return lL(r).reduce((s,o)=>s.then(a=>cL(a,o,e,n)),Promise.resolve(r))}async function zo(t,e,n){var r;const i=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(i){const s=await JT(i,null,n);return e.style.setProperty(t,s,e.style.getPropertyPriority(t)),!0}return!1}async function dL(t,e){await zo("background",t,e)||await zo("background-image",t,e),await zo("mask",t,e)||await zo("-webkit-mask",t,e)||await zo("mask-image",t,e)||await zo("-webkit-mask-image",t,e)}async function hL(t,e){const n=yn(t,HTMLImageElement);if(!(n&&!tg(t.src))&&!(yn(t,SVGImageElement)&&!tg(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,i=await X0(r,Y0(r),e);await new Promise((s,o)=>{t.onload=s,t.onerror=e.onImageErrorHandler?(...l)=>{try{s(e.onImageErrorHandler(...l))}catch(c){o(c)}}:o;const a=t;a.decode&&(a.decode=s),a.loading==="lazy"&&(a.loading="eager"),n?(t.srcset="",t.src=i):t.href.baseVal=i})}async function fL(t,e){const r=ns(t.childNodes).map(i=>ZT(i,e));await Promise.all(r).then(()=>t)}async function ZT(t,e){yn(t,Element)&&(await dL(t,e),await hL(t,e),await fL(t,e))}function pL(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(i=>{n[i]=r[i]}),t}const jw={};async function Fw(t){let e=jw[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},jw[t]=e,e}async function $w(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,s=(n.match(/url\([^)]+\)/g)||[]).map(async o=>{let a=o.replace(r,"$1");return a.startsWith("https://")||(a=new URL(a,t.url).href),WT(a,e.fetchRequestInit,({result:l})=>(n=n.replace(o,`url(${l})`),[o,l]))});return Promise.all(s).then(()=>n)}function Uw(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const l=i.exec(r);if(l===null)break;e.push(l[0])}r=r.replace(i,"");const s=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(o,"gi");for(;;){let l=s.exec(r);if(l===null){if(l=a.exec(r),l===null)break;s.lastIndex=a.lastIndex}else a.lastIndex=s.lastIndex;e.push(l[0])}return e}async function mL(t,e){const n=[],r=[];return t.forEach(i=>{if("cssRules"in i)try{ns(i.cssRules||[]).forEach((s,o)=>{if(s.type===CSSRule.IMPORT_RULE){let a=o+1;const l=s.href,c=Fw(l).then(d=>$w(d,e)).then(d=>Uw(d).forEach(h=>{try{i.insertRule(h,h.startsWith("@import")?a+=1:i.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:h,error:f})}})).catch(d=>{console.error("Error loading remote css",d.toString())});r.push(c)}})}catch(s){const o=t.find(a=>a.href==null)||document.styleSheets[0];i.href!=null&&r.push(Fw(i.href).then(a=>$w(a,e)).then(a=>Uw(a).forEach(l=>{o.insertRule(l,o.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",s)}}),Promise.all(r).then(()=>(t.forEach(i=>{if("cssRules"in i)try{ns(i.cssRules||[]).forEach(s=>{n.push(s)})}catch(s){console.error(`Error while reading CSS rules from ${i.href}`,s)}}),n))}function gL(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>XT(e.style.getPropertyValue("src")))}async function yL(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=ns(t.ownerDocument.styleSheets),r=await mL(n,e);return gL(r)}function eS(t){return t.trim().replace(/["']/g,"")}function vL(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(s=>{e.add(eS(s))}),Array.from(r.children).forEach(s=>{s instanceof HTMLElement&&n(s)})}return n(t),e}async function _L(t,e){const n=await yL(t,e),r=vL(t);return(await Promise.all(n.filter(s=>r.has(eS(s.style.fontFamily))).map(s=>{const o=s.parentStyleSheet?s.parentStyleSheet.href:null;return JT(s.cssText,o,e)}))).join(`
`)}async function wL(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await _L(t,e);if(n){const r=document.createElement("style"),i=document.createTextNode(n);r.appendChild(i),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function xL(t,e={}){const{width:n,height:r}=GT(t,e),i=await hf(t,e,!0);return await wL(i,e),await ZT(i,e),pL(i,e),await Mz(i,n,r)}async function EL(t,e={}){const{width:n,height:r}=GT(t,e),i=await xL(t,e),s=await _h(i),o=document.createElement("canvas"),a=o.getContext("2d"),l=e.pixelRatio||Oz(),c=e.canvasWidth||n,d=e.canvasHeight||r;return o.width=c*l,o.height=d*l,e.skipAutoScale||zz(o),o.style.width=`${c}`,o.style.height=`${d}`,e.backgroundColor&&(a.fillStyle=e.backgroundColor,a.fillRect(0,0,o.width,o.height)),a.drawImage(s,0,0,o.width,o.height),o}async function Bw(t,e={}){return(await EL(t,e)).toDataURL()}const bL=({reactFlowWrapper:t,reactFlowInstance:e,boards:n,currentBoardId:r,bgType:i,isDarkMode:s,setNodes:o})=>{const[a,l]=D.useState(!1),c=D.useCallback(async()=>{if(t.current===null||!e||!o)return;l(!0),await new Promise(z=>setTimeout(z,100));const{x:d,y:h,zoom:f}=e.getViewport(),m=e.getNodes(),b=m.filter(z=>z.selected),x=b.map(z=>z.id);x.length>0&&(o(z=>z.map(B=>({...B,selected:!1}))),await new Promise(z=>setTimeout(z,50)));const R=b.length>0?b:m;if(R.length===0){l(!1),x.length>0&&o(z=>z.map(B=>({...B,selected:x.includes(B.id)})));return}const y=iu(R),v=100,T=y.width+v*2,A=y.height+v*2,O=-y.x+v,L=-y.y+v;e.setViewport({x:O,y:L,zoom:1}),await new Promise(z=>setTimeout(z,1e3)),document.fonts&&await document.fonts.ready;const I=t.current.querySelector(".react-flow");if(!I){l(!1),x.length>0&&o(z=>z.map(B=>({...B,selected:x.includes(B.id)})));return}const w=n.find(z=>z.id===r),C=(w?w.name:"Tablero sin nombre").toUpperCase(),P=Math.max(16,Math.min(72,T*.04)),k=P*.5;let N={};i==="cork"?N={backgroundColor:s?"#18181b":"#e5e5e5",backgroundImage:s?"radial-gradient(rgba(255,255,255,0.05) 1px, transparent 1px), radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px)":"radial-gradient(#999 1px, transparent 1px), radial-gradient(#999 1px, transparent 1px)",backgroundSize:"40px 40px",backgroundPosition:"0 0, 20px 20px"}:i==="blackboard"?N={backgroundColor:s?"#27272a":"#ffffff",backgroundImage:s?"linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px)":"radial-gradient(#e5e7eb 2px, transparent 2px)",backgroundSize:s?"100px 100px":"30px 30px"}:N={backgroundColor:s?"#1e293b":"#f0f9ff",backgroundImage:s?"linear-gradient(#334155 1px, transparent 1px), linear-gradient(90deg, #334155 1px, transparent 1px)":"linear-gradient(#cbd5e1 1px, transparent 1px), linear-gradient(90deg, #cbd5e1 1px, transparent 1px)",backgroundSize:"20px 20px"};const j={pixelRatio:2,skipAutoScale:!0,backgroundColor:N.backgroundColor,width:T,height:A,style:{width:`${T}px`,height:`${A}px`,overflow:"visible",fontFamily:"'Courier Prime', monospace",...N},imagePlaceholder:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",filter:z=>!(z.classList&&(z.classList.contains("react-flow__controls")||z.classList.contains("react-flow__minimap")||z.classList.contains("react-flow__attribution")))};try{let z;try{z=await Bw(I,{...j,useCORS:!0})}catch(ne){console.warn("Error exportando con CORS, reintentando sin CORS...",ne),await new Promise(fe=>setTimeout(fe,1e3)),z=await Bw(I,{...j,useCORS:!1})}const B=document.createElement("canvas"),F=j.pixelRatio||1;B.width=T*F,B.height=A*F;const M=B.getContext("2d"),U=new Image;await new Promise((ne,fe)=>{U.onload=ne,U.onerror=fe,U.src=z}),M.drawImage(U,0,0);const G=P*F;M.font=`bold ${G}px "Courier Prime", monospace`,M.fillStyle=s?"rgba(255, 255, 255, 0.4)":"rgba(0, 0, 0, 0.4)",M.shadowColor=s?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.2)",M.shadowBlur=3*F,M.shadowOffsetX=1*F,M.shadowOffsetY=1*F,M.textAlign="right",M.textBaseline="bottom";const $=k*F;M.fillText(C,B.width-$,B.height-$),z=B.toDataURL("image/png");const X=document.createElement("a"),Y=n.find(ne=>ne.id===r),ee=Y?Y.name.replace(/[^a-z0-9\u00C0-\u017F\s-_]/gi,""):"caso-detective";X.download=`${ee}.png`,X.href=z,X.click()}catch(z){console.error("Error al exportar",z),alert("Error al generar la imagen. Si utilizas imgenes externas (URL), es posible que tengan restricciones de seguridad (CORS).")}finally{e.setViewport({x:d,y:h,zoom:f}),x.length>0&&o(z=>z.map(B=>({...B,selected:x.includes(B.id)}))),l(!1)}},[t,s,e,n,r,i,o]);return{isExporting:a,onExport:c}},IL="default-case",Cp=(t,e=[])=>{let n=localStorage.getItem(`board-${t}-nodes`),r=localStorage.getItem(`board-${t}-edges`),i=localStorage.getItem(`board-${t}-bg`);return!n&&t===IL&&(n=localStorage.getItem("detective-board-nodes"),r=localStorage.getItem("detective-board-edges")),{nodes:n?JSON.parse(n):e,edges:r?JSON.parse(r):[],bgType:i||"cork"}},nd="default-case",TL=({nodes:t,edges:e,bgType:n,setNodes:r,setEdges:i,setBgType:s,reactFlowInstance:o,clearHistory:a,setCaseManagerOpen:l,setConfirmModal:c,lastSaved:d})=>{const[h,f]=D.useState(()=>{try{const w=localStorage.getItem("detective-boards-list");return w?JSON.parse(w):localStorage.getItem("detective-board-nodes")?[{id:nd,name:"Caso #001: Principal",createdAt:Date.now(),lastModified:Date.now()}]:[{id:nd,name:"Caso #001: Nuevo",createdAt:Date.now(),lastModified:Date.now()}]}catch{return[{id:nd,name:"Caso #001: Nuevo",createdAt:Date.now(),lastModified:Date.now()}]}}),[m,b]=D.useState(()=>{try{const w=localStorage.getItem("detective-boards-trash");return w?JSON.parse(w):[]}catch{return[]}}),[x,R]=D.useState(()=>localStorage.getItem("detective-current-board-id")||nd);D.useEffect(()=>{localStorage.setItem("detective-boards-list",JSON.stringify(h))},[h]),D.useEffect(()=>{localStorage.setItem("detective-boards-trash",JSON.stringify(m))},[m]),D.useEffect(()=>{localStorage.setItem("detective-current-board-id",x)},[x]),D.useEffect(()=>{d&&f(w=>w.map(E=>E.id===x?{...E,lastModified:d.getTime()}:E))},[d,x]),D.useEffect(()=>{const w=h.find(E=>E.id===x);w&&(document.title=`${w.name} | Detective Board`)},[x,h]);const y=D.useCallback(w=>{localStorage.setItem(`board-${x}-nodes`,JSON.stringify(t)),localStorage.setItem(`board-${x}-edges`,JSON.stringify(e)),localStorage.setItem(`board-${x}-bg`,n);const E=Cp(w);r(E.nodes),i(E.edges),s(E.bgType),R(w),a(),l(!1),o&&setTimeout(()=>{o.fitView({duration:800,padding:.2})},100)},[x,t,e,n,r,i,s,a,o,l]),v=w=>{if(!w)return;const E=kn(),C={id:E,name:w,createdAt:Date.now(),lastModified:Date.now()};f(P=>[...P,C]),y(E)},T=w=>{h.length<=1||c({isOpen:!0,title:"MOVER A PAPELERA?",message:"El caso se mover a la papelera. Podrs restaurarlo si lo necesitas.",isDanger:!0,confirmText:"Mover",onConfirm:()=>{f(E=>E.map(C=>C.id===w?{...C,isDeleting:!0}:C)),setTimeout(()=>{const E=h.find(P=>P.id===w),C=h.filter(P=>P.id!==w);if(E){const{isDeleting:P,...k}=E;b(N=>[{...k,deletedAt:Date.now()},...N])}if(f(C),x===w){const P=C[0].id,k=Cp(P);r(k.nodes),i(k.edges),s(k.bgType),R(P),a(),o&&setTimeout(()=>{o.fitView({duration:800,padding:.2})},100)}},500)}})},A=D.useCallback(w=>{const E=m.find(C=>C.id===w);E&&(b(C=>C.filter(P=>P.id!==w)),f(C=>[...C,{...E,isDeleting:!1}]))},[m]),O=D.useCallback(w=>{c({isOpen:!0,title:"ELIMINAR DEFINITIVAMENTE?",message:"Esta accin es irreversible. Los datos del caso se borrarn del disco para siempre.",isDanger:!0,confirmText:"Eliminar",onConfirm:()=>{b(E=>E.filter(C=>C.id!==w)),localStorage.removeItem(`board-${w}-nodes`),localStorage.removeItem(`board-${w}-edges`),localStorage.removeItem(`board-${w}-bg`)}})},[]),L=(w,E)=>{f(C=>C.map(P=>P.id===w?{...P,name:E}:P))},S=D.useCallback(w=>{f(w)},[]),I=D.useCallback(w=>{const E=h.find(C=>C.id===w);E&&c({isOpen:!0,title:"CLONAR CASO?",message:`Deseas crear una copia del expediente "${E.name}"?`,confirmText:"Clonar",onConfirm:()=>{let C,P,k;if(w===x)C=t,P=e,k=n;else{const z=Cp(w);C=z.nodes,P=z.edges,k=z.bgType}const N=kn(),j={id:N,name:`${E.name} (Copia)`,createdAt:Date.now(),lastModified:Date.now()};localStorage.setItem(`board-${N}-nodes`,JSON.stringify(C)),localStorage.setItem(`board-${N}-edges`,JSON.stringify(P)),localStorage.setItem(`board-${N}-bg`,k),f(z=>{const B=z.findIndex(M=>M.id===w),F=[...z];return F.splice(B+1,0,j),F}),y(N)}})},[h,y,x,t,e,n,c]);return D.useEffect(()=>{h.length>0&&!h.find(w=>w.id===x)&&y(h[0].id)},[h,x,y]),{boards:h,setBoards:f,trash:m,currentBoardId:x,setCurrentBoardId:R,handleSwitchBoard:y,handleCreateBoard:v,handleDeleteBoard:T,handleRestoreBoard:A,handlePermanentDelete:O,handleRenameBoard:L,handleReorderBoards:S,handleCloneBoard:I}},SL=({onSave:t,undo:e,redo:n,duplicateSelected:r,navigateSearch:i,reactFlowInstance:s,edges:o,setEdges:a,takeSnapshot:l,connectionLineType:c,connectionColor:d})=>{D.useEffect(()=>{const h=f=>{if((f.ctrlKey||f.metaKey)&&f.key==="s"&&(f.preventDefault(),t()),(f.ctrlKey||f.metaKey)&&f.key==="z"&&(f.preventDefault(),f.shiftKey?n():e()),(f.ctrlKey||f.metaKey)&&f.key==="y"&&(f.preventDefault(),n()),(f.ctrlKey||f.metaKey)&&f.key==="d"&&(f.preventDefault(),r()),f.key==="F3"&&(f.preventDefault(),f.shiftKey?i("prev"):i("next")),f.shiftKey&&f.key.toLowerCase()==="c"){if(f.preventDefault(),!s)return;const m=s.getNodes().filter(b=>b.selected);if(m.length>=2){m.sort((x,R)=>x.position.x-R.position.x);const b=[];for(let x=0;x<m.length-1;x++){const R=m[x],y=m[x+1];o.some(T=>T.source===R.id&&T.target===y.id||T.source===y.id&&T.target===R.id)||b.push({id:kn(),source:R.id,target:y.id,type:c,style:{stroke:d,strokeWidth:2},className:"quick-draw"})}b.length>0&&(l(),a(x=>x.concat(b)))}}};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,e,n,r,i,o,c,d,s,a,l])},CL=({isInteractive:t,reactFlowInstance:e,setNodes:n,takeSnapshot:r,setPendingStampNodeId:i,setInputModalOpen:s,setEditingEdge:o,setEditingNode:a})=>{const l=D.useCallback(d=>{if(d.preventDefault(),!t){d.dataTransfer.dropEffect="none";return}d.dataTransfer.dropEffect="move"},[t]),c=D.useCallback(d=>{if(d.preventDefault(),!t)return;if(d.dataTransfer.files&&d.dataTransfer.files.length>0){const R=d.dataTransfer.files[0];Q0(R,(y,v,T)=>{const A=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),O={id:kn(),type:"image",position:A,data:{label:"Imagen",image:y},style:{width:v,height:T}};r(),n(L=>L.concat(O))});return}const h=d.dataTransfer.getData("text/uri-list")||d.dataTransfer.getData("text/plain");if(h&&(h.startsWith("data:image")||h.startsWith("http"))){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:kn(),type:"image",position:R,data:{label:"Imagen Extrada",image:h},style:{width:300,height:300}};r(),n(v=>v.concat(y));return}const f=d.dataTransfer.getData("application/reactflow"),m=d.dataTransfer.getData("application/category");if(typeof f>"u"||!f)return;if(f==="stamp"){const R=d.dataTransfer.getData("application/category"),y=R==="custom",v=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),A=e.getIntersectingNodes({x:v.x,y:v.y,width:1,height:1}).slice().reverse().find(O=>O.type==="evidence"||O.type==="note"||O.type==="image");if(A){if(y){i(A.id),s(!0),o(null),a(null);return}r(),n(O=>O.map(L=>L.id===A.id?{...L,data:{...L.data,status:R}}:L))}return}if(f==="zone"){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:kn(),type:"zone",position:R,data:{label:"ZONA SEGURA"},style:{width:300,height:300,backgroundColor:"rgba(113, 113, 122, 0.05)",borderColor:"#71717a"}};r(),n(v=>[y,...v]);return}if(f==="url"){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:kn(),type:"url",position:R,data:{url:"",label:"Nuevo Enlace"},style:{width:300,height:250}};r(),n(v=>v.concat(y));return}const b=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),x={id:kn(),type:f,position:b,data:{label:`Nuevo ${m}`,category:m,description:"Doble click para editar..."}};r(),n(R=>R.concat(x))},[e,n,t,r,i,s,o,a]);return{onDragOver:l,onDrop:c}},J0=({status:t})=>{if(typeof t=="object"&&t.type==="custom")return p.jsx("div",{className:"border-4 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif",borderColor:t.color,color:t.color,backgroundColor:`${t.color}30`},children:t.label});switch(t){case"solved":return p.jsx("div",{className:"border-4 border-green-600 text-green-600 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-green-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"RESUELTO"});case"discarded":return p.jsx("div",{className:"border-4 border-red-600 text-red-600 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-red-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"DESCARTADO"});case"key":return p.jsx("div",{className:"border-4 border-yellow-500 text-yellow-500 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-yellow-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"CLAVE"});case"question":return p.jsx("div",{className:"border-4 border-blue-500 text-blue-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-blue-950/30",children:p.jsx(Zm,{size:40,strokeWidth:3})});case"important":return p.jsx("div",{className:"border-4 border-orange-500 text-orange-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-orange-950/30",children:p.jsx(HT,{size:40,strokeWidth:3})});case"verify":return p.jsx("div",{className:"border-4 border-purple-500 text-purple-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-purple-950/30",children:p.jsx(OT,{size:40,strokeWidth:3})});case"danger":return p.jsx("div",{className:"border-4 border-red-600 text-red-600 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-red-950/30",children:p.jsx($T,{size:40,strokeWidth:3})});case"confidential":return p.jsx("div",{className:"border-4 border-zinc-500 text-zinc-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-zinc-950/30",children:p.jsx(Ra,{size:40,strokeWidth:3})});default:return null}},Hw={person:{color:"border-blue-500",icon:W0,dark:{bg:"bg-gradient-to-br from-blue-900 to-blue-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-blue-50 to-blue-100",text:"text-blue-900/70",title:"text-blue-950",border:"border-black/10"}},place:{color:"border-green-500",icon:zT,dark:{bg:"bg-gradient-to-br from-green-900 to-green-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-green-50 to-green-100",text:"text-green-900/70",title:"text-green-950",border:"border-black/10"}},clue:{color:"border-orange-500",icon:H0,dark:{bg:"bg-gradient-to-br from-orange-900 to-orange-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-orange-50 to-orange-100",text:"text-orange-900/70",title:"text-orange-950",border:"border-black/10"}},event:{color:"border-red-500",icon:NT,dark:{bg:"bg-gradient-to-br from-red-900 to-red-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-red-50 to-red-100",text:"text-red-900/70",title:"text-red-950",border:"border-black/10"}}},AL=({id:t,data:e,selected:n,isDarkMode:r})=>{const i=Hw[e.category]||Hw.clue,s=r?i.dark:i.light,o=i.icon,{setNodes:a}=Vr(),l=!!e.locked,[c,d]=D.useState(!1),h=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]),f=m=>{m.stopPropagation(),a(b=>b.map(x=>{if(x.id===t){const R=!!x.data.locked;return{...x,draggable:!0,data:{...x.data,locked:!R}}}return x}))};return p.jsxs("div",{className:`
        relative h-full w-full shadow-[0_10px_20px_-5px_rgba(0,0,0,0.6)] rounded-sm border-l-4 transition-all duration-300 ease-out group
        ${i.color} ${s.bg}
        ${n?"ring-2 ring-white scale-105 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.9)] z-50":"hover:scale-105 hover:-translate-y-1 hover:shadow-[0_20px_40px_-5px_rgba(0,0,0,0.8)] hover:z-40"}
        ${l?"nodrag":""} ${e.isDeleting?"deleting-default":""}
      `,children:[p.jsx(Ga,{color:"#ef4444",isVisible:n&&!l,minWidth:250,minHeight:150,handleStyle:{width:15,height:15}}),(n||l)&&p.jsx("button",{onClick:f,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${l?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:l?p.jsx(Qa,{size:12}):p.jsx(Wa,{size:12})}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(wn,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(wn,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${h}deg)`},children:p.jsx(J0,{status:e.status},JSON.stringify(e.status))}),p.jsxs("div",{className:"p-3 flex flex-col gap-2 h-full w-full overflow-hidden",children:[p.jsxs("div",{className:`flex items-center justify-between border-b ${s.border} pb-2`,children:[p.jsx("span",{className:`text-xs uppercase tracking-widest ${s.text} font-bold`,children:e.category}),p.jsx(o,{size:16,className:s.text})]}),e.image&&p.jsx("div",{className:`nodrag w-full h-32 overflow-hidden rounded-sm border ${s.border} sepia-[.5] cursor-zoom-in hover:sepia-0 transition-all`,onClick:m=>{m.stopPropagation(),d(!0)},children:p.jsx("img",{src:e.image,alt:"evidence",className:"w-full h-full object-cover"})}),c&&kc.createPortal(p.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-8 cursor-zoom-out backdrop-blur-sm animate-in fade-in duration-200",onClick:m=>{m.stopPropagation(),d(!1)},children:p.jsx("img",{src:e.image,alt:"Evidence HD",className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm"})}),document.body),p.jsxs("div",{children:[p.jsx("h3",{className:`text-lg font-bold ${s.title} leading-tight font-mono`,children:e.label}),p.jsx("p",{className:`text-xs ${s.text} mt-1 font-mono leading-relaxed`,children:e.description})]})]})]})},kL=D.memo(AL),Ap={yellow:{bg:"from-yellow-100 to-yellow-300",btn:"bg-yellow-500"},green:{bg:"from-green-100 to-green-300",btn:"bg-green-500"},blue:{bg:"from-blue-100 to-blue-300",btn:"bg-blue-500"},red:{bg:"from-red-100 to-red-300",btn:"bg-red-500"},purple:{bg:"from-purple-100 to-purple-300",btn:"bg-purple-500"}},RL=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Vr(),o=!!e.locked,a=Ap[e.color]||Ap.yellow,l=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]),c=f=>{f.stopPropagation(),s(m=>m.map(b=>{if(b.id===t){const x=!!b.data.locked;return{...b,draggable:!0,data:{...b.data,locked:!x}}}return b}))},d=f=>{s(m=>m.map(b=>b.id===t?{...b,data:{...b.data,color:f}}:b))},h=()=>{s(f=>f.map(m=>m.id===t?{...m,data:{...m.data,status:null}}:m))};return p.jsxs(p.Fragment,{children:[p.jsx(Ga,{color:"#eab308",isVisible:n&&!o,minWidth:150,minHeight:150,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{i({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(gs,{size:12})}),(n||o)&&p.jsx("button",{onClick:c,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${o?"bg-red-900 border-red-700 text-red-200":"bg-yellow-500 border-yellow-700 text-white hover:bg-yellow-600"}`,children:o?p.jsx(Qa,{size:12}):p.jsx(Wa,{size:12})}),n&&!o&&p.jsxs("div",{className:`nodrag absolute -bottom-8 left-1/2 transform -translate-x-1/2 flex gap-1 p-1.5 rounded-full shadow-xl border z-50 backdrop-blur-sm ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[Object.entries(Ap).map(([f,m])=>p.jsx("button",{onClick:()=>d(f),className:`w-4 h-4 rounded-full ${m.btn} border border-white/20 hover:scale-125 transition-transform`},f)),e.status&&p.jsx("button",{onClick:h,className:`w-4 h-4 rounded-full flex items-center justify-center border border-white/20 hover:scale-125 transition-transform ml-1 ${r?"bg-zinc-700 text-zinc-400 hover:text-white":"bg-gray-200 text-gray-500 hover:text-black"}`,title:"Quitar Sello",children:p.jsx(B0,{size:10})})]}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(wn,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(wn,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${l}deg)`},children:p.jsx(J0,{status:e.status},JSON.stringify(e.status))}),p.jsxs("div",{className:`relative h-full w-full bg-gradient-to-br ${a.bg} shadow-[5px_5px_15px_rgba(0,0,0,0.5)] rotate-1 p-4 note-rough border-t border-l border-white/50 flex flex-col transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-1 hover:shadow-[10px_15px_25px_rgba(0,0,0,0.6)] overflow-hidden ${o?"nodrag":""} ${e.isDeleting?"deleting-note":""}`,children:[p.jsx("div",{className:"absolute inset-0 paper-texture pointer-events-none opacity-50 mix-blend-multiply"}),p.jsx("textarea",{name:"note-content",className:"nodrag relative z-10 w-full h-full bg-transparent resize-none outline-none text-gray-800 placeholder-yellow-600/50 text-lg leading-relaxed",placeholder:"Escribe una nota...",defaultValue:e.label,onChange:f=>e.label=f.target.value,style:{fontFamily:'"Comic Sans MS", "Chalkboard SE", sans-serif'}})]})]})},PL=D.memo(RL),NL=({isOpen:t,onClose:e,imageSrc:n,onCropComplete:r})=>{const[i,s]=D.useState(1),[o,a]=D.useState({x:0,y:0}),[l,c]=D.useState(!1),[d,h]=D.useState({x:0,y:0}),f=D.useRef(null),m=D.useRef(null);if(D.useEffect(()=>{t&&(s(1),a({x:0,y:0}))},[t,n]),!t||!n)return null;const b=v=>{c(!0),h({x:v.clientX-o.x,y:v.clientY-o.y})},x=v=>{l&&a({x:v.clientX-d.x,y:v.clientY-d.y})},R=()=>{c(!1)},y=()=>{const v=document.createElement("canvas"),T=v.getContext("2d"),A=m.current,O=f.current,L=A.clientWidth,S=A.clientHeight;v.width=L,v.height=S;const I=L/2,w=S/2;T.translate(I+o.x,w+o.y),T.scale(i,i),T.drawImage(O,-O.naturalWidth/2,-O.naturalHeight/2),r(v.toDataURL("image/jpeg",.9)),e()};return p.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center p-4 animate-in fade-in duration-200 select-none",onMouseUp:R,onMouseLeave:R,children:[p.jsxs("div",{className:"w-full max-w-lg flex justify-between items-center mb-4",children:[p.jsxs("h2",{className:"text-zinc-100 font-mono font-bold text-lg flex items-center gap-2",children:[p.jsx(nz,{size:18})," AJUSTAR RECORTE"]}),p.jsx("button",{onClick:e,className:"text-zinc-400 hover:text-white",children:p.jsx(gs,{})})]}),p.jsxs("div",{ref:m,className:"relative w-[400px] h-[400px] bg-zinc-900 overflow-hidden border-2 border-dashed border-zinc-500 cursor-move shadow-2xl rounded-sm",onMouseDown:b,onMouseMove:x,children:[p.jsx("img",{ref:f,src:n,alt:"Crop target",className:"absolute max-w-none origin-center pointer-events-none",style:{left:"50%",top:"50%",transform:`translate(-50%, -50%) translate(${o.x}px, ${o.y}px) scale(${i})`}}),p.jsxs("div",{className:"absolute inset-0 pointer-events-none opacity-30",children:[p.jsx("div",{className:"w-full h-1/3 border-b border-white/50 absolute top-0"}),p.jsx("div",{className:"w-full h-1/3 border-b border-white/50 absolute top-1/3"}),p.jsx("div",{className:"h-full w-1/3 border-r border-white/50 absolute left-0"}),p.jsx("div",{className:"h-full w-1/3 border-r border-white/50 absolute left-1/3"})]})]}),p.jsxs("div",{className:"mt-6 flex items-center gap-4 w-full max-w-md bg-zinc-900 p-4 rounded-lg border border-zinc-800",children:[p.jsx(yz,{size:20,className:"text-zinc-400"}),p.jsx("input",{type:"range",name:"crop-scale",min:"0.1",max:"3",step:"0.05",value:i,onChange:v=>s(parseFloat(v.target.value)),className:"w-full accent-red-600 h-1 bg-zinc-700 rounded-lg appearance-none cursor-pointer"}),p.jsx(gz,{size:20,className:"text-zinc-400"})]}),p.jsxs("div",{className:"mt-6 flex gap-4",children:[p.jsx("button",{onClick:e,className:"px-6 py-2 border border-zinc-600 text-zinc-300 hover:text-white rounded font-bold uppercase text-xs tracking-wider transition-colors",children:"Cancelar"}),p.jsxs("button",{onClick:y,className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold uppercase text-xs tracking-wider shadow-lg flex items-center gap-2 transition-colors",children:[p.jsx(DT,{size:16})," Aplicar"]})]})]})},DL=({id:t,data:e,selected:n,isDarkMode:r})=>{const[i,s]=D.useState(e.image),[o,a]=D.useState(!1),[l,c]=D.useState(!1),[d,h]=D.useState(!1),[f,m]=D.useState(e.filters||{brightness:100,contrast:100,grayscale:0,sepia:0}),{deleteElements:b,setNodes:x,getNode:R}=Vr(),y=!!e.locked,v=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]);D.useEffect(()=>{e.filters&&m(e.filters)},[e.filters]),D.useEffect(()=>{if(e.image&&e.image.startsWith("http")){const E=new Image;E.crossOrigin="Anonymous",E.src=e.image,E.onload=()=>{try{const C=document.createElement("canvas");C.width=E.width,C.height=E.height,C.getContext("2d").drawImage(E,0,0);const k=C.toDataURL("image/jpeg");k.length>100&&(s(k),x(N=>N.map(j=>j.id===t?{...j,data:{...j.data,image:k}}:j)))}catch{}}}},[]);const T=E=>{E.stopPropagation(),x(C=>C.map(P=>{if(P.id===t){const k=!!P.data.locked;return{...P,draggable:!0,data:{...P.data,locked:!k}}}return P}))},A=E=>{const C=E.target.files[0];C&&Q0(C,(P,k,N)=>{s(P),x(j=>j.map(z=>z.id===t?{...z,data:{...z.data,image:P},style:{...z.style,width:k,height:N}}:z))})},O=E=>{if(!i)return;const C=new Image;C.src=i,C.onload=()=>{var F,M;const P=document.createElement("canvas");P.width=C.height,P.height=C.width;const k=P.getContext("2d");k.translate(P.width/2,P.height/2),k.rotate(E==="right"?90*Math.PI/180:-90*Math.PI/180),k.drawImage(C,-C.width/2,-C.height/2);const N=P.toDataURL();s(N);const j=R(t),z=(F=j==null?void 0:j.style)==null?void 0:F.width,B=(M=j==null?void 0:j.style)==null?void 0:M.height;x(U=>U.map(G=>G.id===t?{...G,data:{...G.data,image:N},style:{...G.style,width:B,height:z}}:G))}},L=()=>{c(!0)},S=E=>{s(E),x(C=>C.map(P=>P.id===t?{...P,data:{...P.data,image:E},style:{...P.style,width:300,height:300}}:P))},I=()=>{x(E=>E.map(C=>C.id===t?{...C,data:{...C.data,status:null}}:C))},w=(E,C)=>{const P={...f,[E]:C};m(P),x(k=>k.map(N=>N.id===t?{...N,data:{...N.data,filters:P}}:N))};return p.jsxs(p.Fragment,{children:[p.jsx(Ga,{color:"#ef4444",isVisible:n&&!y,minWidth:100,minHeight:100,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{b({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(gs,{size:12})}),(n||y)&&p.jsx("button",{onClick:T,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${y?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:y?p.jsx(Qa,{size:12}):p.jsx(Wa,{size:12})}),n&&!y&&i&&p.jsxs("div",{className:`nodrag absolute -bottom-9 left-1/2 transform -translate-x-1/2 flex gap-1 p-1.5 rounded-full shadow-xl border z-50 backdrop-blur-sm items-center ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[p.jsx("button",{onClick:()=>h(!d),className:`p-1.5 rounded-full transition-colors ${d?"bg-blue-600 text-white":r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Filtros",children:p.jsx(hz,{size:14})}),p.jsx("div",{className:`w-px h-4 mx-0.5 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsx("button",{onClick:()=>O("left"),className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Rotar Izquierda",children:p.jsx(cz,{size:14})}),p.jsx("button",{onClick:L,className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Recortar",children:p.jsx(BO,{size:14})}),p.jsx("button",{onClick:()=>O("right"),className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Rotar Derecha",children:p.jsx(uz,{size:14})}),e.status&&p.jsx("button",{onClick:I,className:`p-1.5 text-red-500 hover:text-red-400 rounded-full transition-colors ${r?"hover:bg-zinc-700":"hover:bg-gray-200"}`,title:"Quitar Sello",children:p.jsx(B0,{size:14})})]}),d&&n&&!y&&p.jsxs("div",{className:`nodrag absolute -bottom-44 left-1/2 transform -translate-x-1/2 p-3 rounded-lg border z-50 w-48 backdrop-blur-sm flex flex-col gap-2 shadow-2xl animate-in fade-in slide-in-from-bottom-2 ${r?"bg-zinc-900/95 border-zinc-700":"bg-white/95 border-gray-200"}`,children:[p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Brillo"})," ",p.jsxs("span",{children:[f.brightness,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"200",value:f.brightness,onChange:E=>w("brightness",parseInt(E.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Contraste"})," ",p.jsxs("span",{children:[f.contrast,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"200",value:f.contrast,onChange:E=>w("contrast",parseInt(E.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"B/N"})," ",p.jsxs("span",{children:[f.grayscale,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"100",value:f.grayscale,onChange:E=>w("grayscale",parseInt(E.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Sepia"})," ",p.jsxs("span",{children:[f.sepia,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"100",value:f.sepia,onChange:E=>w("sepia",parseInt(E.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`})]}),p.jsx("div",{className:"tape-visual"}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(wn,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(wn,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${v}deg)`},children:p.jsx(J0,{status:e.status},JSON.stringify(e.status))}),p.jsx("div",{className:`h-full w-full ${i?"bg-zinc-100 p-2 pb-10 rotate-1 hover:rotate-0":r?"bg-zinc-900/50 border-zinc-700 hover:border-zinc-500":"bg-gray-200/50 border-gray-400 hover:border-gray-500"} shadow-[0_10px_20px_-5px_rgba(0,0,0,0.7)] flex items-center justify-center overflow-hidden rounded-sm relative group transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-1 hover:shadow-[0_25px_50px_-12px_rgba(0,0,0,0.9)] ${y?"nodrag":""} ${e.isDeleting?"deleting-image":""} border-2 border-dashed`,children:i?p.jsxs("div",{className:"w-full h-full cursor-zoom-in",onClick:E=>{E.stopPropagation(),a(!0)},children:[p.jsx("img",{src:i,alt:"evidence",className:"w-full h-full object-cover border border-zinc-200",style:{filter:`brightness(${f.brightness}%) contrast(${f.contrast}%) grayscale(${f.grayscale}%) sepia(${f.sepia}%)`}}),p.jsx("div",{className:"absolute bottom-0 left-0 w-full h-10 flex items-center justify-center px-2",children:p.jsx("input",{type:"text",name:"image-caption",className:"nodrag w-full bg-transparent text-center text-zinc-800 text-xs outline-none placeholder-zinc-400/50 border-none p-0",placeholder:"",defaultValue:e.caption,onChange:E=>e.caption=E.target.value,onClick:E=>E.stopPropagation(),style:{fontFamily:'"Comic Sans MS", "Chalkboard SE", cursive'}})})]}):p.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full p-2 gap-1",children:[p.jsxs("label",{className:`nodrag cursor-pointer flex flex-col items-center gap-1 transition-colors ${r?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,children:[p.jsx(q0,{size:24}),p.jsx("span",{className:"text-[10px] font-mono uppercase text-center",children:"Subir Local"}),p.jsx("input",{type:"file",name:"upload-image",className:"hidden",accept:"image/*",onChange:A})]}),p.jsx("div",{className:`text-[10px] font-mono ${r?"text-zinc-600":"text-zinc-400"}`,children:"- O -"}),p.jsx("input",{type:"text",name:"image-url",placeholder:"Pegar URL...",className:`nodrag w-full border text-[10px] p-1 rounded outline-none focus:border-purple-500 font-mono text-center ${r?"bg-zinc-950 border-zinc-700 text-zinc-300":"bg-white border-gray-300 text-zinc-700"}`,onKeyDown:E=>{if(E.key==="Enter"){const C=E.currentTarget.value;s(C),e.image=C;const P=new Image;P.crossOrigin="Anonymous",P.onload=()=>{try{const k=document.createElement("canvas");k.width=P.width,k.height=P.height,k.getContext("2d").drawImage(P,0,0);const j=k.toDataURL("image/jpeg");s(j),x(z=>z.map(B=>B.id===t?{...B,data:{...B.data,image:j}}:B))}catch(k){console.warn("CORS blocked",k)}},P.src=C}}})]})}),o&&kc.createPortal(p.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-8 cursor-zoom-out backdrop-blur-sm animate-in fade-in duration-200",onClick:E=>{E.stopPropagation(),a(!1)},children:p.jsx("img",{src:i,alt:"Evidence HD",className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm",style:{filter:`brightness(${f.brightness}%) contrast(${f.contrast}%) grayscale(${f.grayscale}%) sepia(${f.sepia}%)`}})}),document.body),l&&kc.createPortal(p.jsx(NL,{isOpen:l,onClose:()=>c(!1),imageSrc:i,onCropComplete:S}),document.body)]})},VL=D.memo(DL),OL=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Vr(),o=!!e.locked,a=h=>{h.stopPropagation(),s(f=>f.map(m=>{if(m.id===t){const b=!!m.data.locked;return{...m,draggable:!0,data:{...m.data,locked:!b}}}return m}))},l=(h,f)=>{s(m=>m.map(b=>b.id===t?{...b,data:{...b.data,[h]:f}}:b))},c=["#e5e5e5","#18181b","#ef4444","#3b82f6","#22c55e","#eab308"],d=[{label:"S",val:"14px"},{label:"M",val:"24px"},{label:"L",val:"36px"},{label:"XL",val:"48px"}];return p.jsxs(p.Fragment,{children:[p.jsx(Ga,{color:"#71717a",isVisible:n&&!o,minWidth:100,minHeight:30,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{i({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(gs,{size:12})}),(n||o)&&p.jsx("button",{onClick:a,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${o?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:o?p.jsx(Qa,{size:12}):p.jsx(Wa,{size:12})}),n&&!o&&p.jsxs("div",{className:`nodrag absolute -bottom-10 left-1/2 transform -translate-x-1/2 flex flex-col gap-1 p-1.5 rounded-lg shadow-xl border z-50 backdrop-blur-sm items-center ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[p.jsx("div",{className:"flex gap-1",children:c.map(h=>p.jsx("button",{onClick:()=>l("color",h),className:"w-4 h-4 rounded-full border border-white/20 hover:scale-125 transition-transform",style:{backgroundColor:h}},h))}),p.jsx("div",{className:`flex gap-1 border-t pt-1 mt-0.5 ${r?"border-white/10":"border-black/10"}`,children:d.map(h=>p.jsx("button",{onClick:()=>l("fontSize",h.val),className:`text-[8px] px-1 font-mono border rounded ${r?"text-zinc-300 hover:text-white border-zinc-700 bg-zinc-800 hover:bg-zinc-700":"text-zinc-600 hover:text-black border-gray-300 bg-gray-100 hover:bg-gray-200"}`,children:h.label},h.label))})]}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(wn,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(wn,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),p.jsx("div",{className:`h-full w-full p-2 flex items-center justify-center overflow-hidden border border-transparent hover:border-zinc-700/50 rounded transition-colors ${o?"nodrag":""} ${e.isDeleting?"deleting-default":""}`,children:p.jsx("textarea",{name:"text-content",className:`nodrag w-full h-full bg-transparent resize-none outline-none font-bold text-center p-2 ${e.color?"":"text-node-content text-gray-200"}`,placeholder:"Escribe un ttulo...",defaultValue:e.label,onChange:h=>e.label=h.target.value,style:{fontFamily:'"Courier Prime", monospace',color:e.color,fontSize:e.fontSize||"24px"}})})]})},zL=D.memo(OL),LL=({id:t,data:e,selected:n,style:r,isDarkMode:i})=>{const{setNodes:s}=Vr(),o=(r==null?void 0:r.borderColor)||"#71717a",a=(r==null?void 0:r.backgroundColor)||(i?"rgba(113, 113, 122, 0.05)":"rgba(100, 116, 139, 0.05)"),l=!!e.locked,c=d=>{d.stopPropagation(),s(h=>h.map(f=>{if(f.id===t){const m=!!f.data.locked;return{...f,draggable:m,data:{...f.data,locked:!m}}}return f}))};return p.jsxs(p.Fragment,{children:[p.jsx(Ga,{color:o,isVisible:n&&!l,minWidth:150,minHeight:150}),(n||l)&&p.jsx("button",{onClick:c,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${l?"bg-red-900 border-red-700 text-red-200":i?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:l?p.jsx(Qa,{size:12}):p.jsx(Wa,{size:12})}),p.jsx("div",{className:`h-full w-full border-2 border-dashed rounded-xl transition-colors ${l?"nodrag":""} ${e.isDeleting?"deleting-zone":""}`,style:{borderColor:o,backgroundColor:a},children:p.jsx("div",{className:`absolute -top-3 left-4 px-2 py-0.5 rounded text-[10px] font-mono uppercase tracking-widest select-none whitespace-nowrap shadow-sm ${i?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-white border border-gray-300 text-gray-600"}`,children:e.label})})]})},ML=D.memo(LL),jL=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Vr(),[o,a]=D.useState(e.url||""),[l,c]=D.useState(!e.url),d=!!e.showIframe,[h,f]=D.useState(!1),[m,b]=D.useState(0),[x,R]=D.useState(null),[y,v]=D.useState(!0),[T,A]=D.useState(!1),O=!!e.locked,L=D.useMemo(()=>{if(!e.url)return"";try{const N=new URL(e.url);if(N.hostname.includes("youtube.com")||N.hostname.includes("youtu.be")){let z=null;if(N.hostname.includes("youtu.be"))z=N.pathname.slice(1);else if(N.searchParams.has("v"))z=N.searchParams.get("v");else if(N.pathname.startsWith("/embed/"))return e.url;if(z)return`https://www.youtube-nocookie.com/embed/${z}?rel=0&modestbranding=1&iv_load_policy=3&controls=1&playsinline=1&loop=1&playlist=${z}`}}catch{}return e.url},[e.url]),S=e.url?`https://s.wordpress.com/mshots/v1/${encodeURIComponent(e.url)}?w=400&v=${m}`:null,I=S?`https://wsrv.nl/?url=${encodeURIComponent(S)}`:null;D.useEffect(()=>{if(R(null),!I)return;(j=>{const z=new Image;z.crossOrigin="Anonymous",z.referrerPolicy="no-referrer",z.src=j,z.onload=()=>{try{const B=document.createElement("canvas");B.width=z.width,B.height=z.height,B.getContext("2d").drawImage(z,0,0);const M=B.toDataURL("image/jpeg");R(M),v(!1)}catch{v(!1),A(!0)}},z.onerror=()=>{v(!1),A(!0)}})(I)},[I]);const w=N=>{N.stopPropagation(),s(j=>j.map(z=>{if(z.id===t){const B=!!z.data.locked;return{...z,draggable:B,data:{...z.data,locked:!B}}}return z}))},E=()=>{let N=o;N&&!N.startsWith("http")&&(N="https://"+N),s(j=>j.map(z=>z.id===t?{...z,data:{...z.data,url:N,showIframe:!1}}:z)),c(!1),f(!1),A(!1),v(!0)},C=()=>{c(!0),f(!1),A(!1),v(!0)},P=N=>{N.stopPropagation(),b(j=>j+1),f(!1),A(!1),v(!0)},k=()=>{const N=!d;f(!1),s(j=>j.map(z=>z.id===t?{...z,data:{...z.data,showIframe:N}}:z))};return p.jsxs(p.Fragment,{children:[p.jsx(Ga,{color:"#3b82f6",isVisible:n&&!O,minWidth:200,minHeight:100}),n&&p.jsx("button",{onClick:()=>i({nodes:[{id:t}]}),className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(gs,{size:12})}),(n||O)&&p.jsx("button",{onClick:w,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${O?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:O?p.jsx(Qa,{size:12}):p.jsx(Wa,{size:12})}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(wn,{type:"target",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(wn,{type:"source",position:le.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),p.jsxs("div",{className:`relative w-full h-full rounded-lg overflow-hidden border-2 transition-all shadow-lg flex flex-col ${r?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} ${O?"nodrag":""} ${e.isDeleting?"deleting-default":""}`,children:[p.jsxs("div",{className:`h-8 flex items-center px-2 gap-2 border-b ${r?"bg-zinc-800 border-zinc-700":"bg-gray-100 border-gray-200"}`,children:[p.jsx(QO,{size:14,className:"text-blue-500"}),p.jsx("span",{className:`text-[10px] font-mono truncate flex-1 ${r?"text-zinc-400":"text-gray-600"}`,children:e.url?new URL(e.url).hostname:"ENLACE WEB"}),!l&&p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:k,className:`text-zinc-500 transition-colors ${d?"text-blue-500":"hover:text-blue-500"}`,title:d?"Ver miniatura":"Ver interactivo",children:p.jsx(tz,{size:12})}),p.jsx("button",{onClick:P,className:"text-zinc-500 hover:text-green-500 transition-colors",title:"Actualizar miniatura",children:p.jsx(jT,{size:12})}),p.jsx("button",{onClick:C,className:"text-zinc-500 hover:text-blue-500 transition-colors",children:p.jsx(sz,{size:12})})]})]}),p.jsx("div",{className:"flex-1 relative bg-black/5 group",children:l?p.jsxs("div",{className:"p-4 flex flex-col gap-2 h-full justify-center",children:[p.jsx("input",{type:"text",name:"url-input",value:o,onChange:N=>a(N.target.value),placeholder:"https://ejemplo.com",className:`nodrag w-full text-xs p-2 rounded border outline-none font-mono ${r?"bg-zinc-950 border-zinc-700 text-white":"bg-white border-gray-300 text-black"}`,onKeyDown:N=>N.key==="Enter"&&E()}),p.jsx("button",{onClick:E,className:"bg-blue-600 text-white text-xs py-1 rounded hover:bg-blue-500 font-bold uppercase",children:"Guardar"})]}):p.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[p.jsx("div",{className:"flex-1 relative overflow-hidden bg-zinc-200 dark:bg-zinc-800 min-h-0",children:d?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:`absolute top-0 left-0 w-full py-1 px-2 flex flex-col gap-1 items-center justify-center z-20 ${r?"bg-zinc-950/80":"bg-white/80"} backdrop-blur-[2px]`,children:p.jsx("span",{className:`text-[9px] leading-tight text-center select-none ${r?"text-zinc-400":"text-zinc-600"}`,children:"Si no carga, el sitio bloquea la conexin."})}),p.jsx("iframe",{src:L,className:"w-full h-full border-none relative z-10 bg-white",title:"Embedded Content",loading:"lazy",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation allow-modals allow-popups-to-escape-sandbox",onError:N=>{console.warn("Error loading iframe:",e.url),N.target.style.display="none"}},m)]}):p.jsxs(p.Fragment,{children:[y&&e.url&&p.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-4 text-center z-20",children:p.jsx("div",{className:"w-6 h-6 border-2 border-zinc-400 border-t-transparent rounded-full animate-spin"})}),x&&!T&&p.jsx("img",{src:x,alt:"Preview",className:"w-full h-full object-cover opacity-90 hover:opacity-100 transition-opacity"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(!e.url||T)&&p.jsx(K0,{size:32,className:"text-zinc-400"})})]})}),p.jsxs("a",{href:e.url,target:"_blank",rel:"noopener",draggable:"false",onDragStart:N=>N.preventDefault(),className:`nodrag h-10 shrink-0 flex items-center justify-center gap-2 text-xs font-bold uppercase transition-colors z-10 relative ${r?"bg-zinc-800 hover:bg-zinc-700 text-blue-400":"bg-gray-200 hover:bg-gray-300 text-zinc-900"}`,children:[p.jsx(KO,{size:14})," Visitar Sitio"]})]})})]})]})},FL=D.memo(jL),ff=({id:t,sourceX:e,sourceY:n,targetX:r,targetY:i,sourcePosition:s,targetPosition:o,style:a={},markerEnd:l,label:c,type:d,className:h})=>{let f="",m=0,b=0;const x={sourceX:e,sourceY:n,targetX:r,targetY:i,sourcePosition:s,targetPosition:o};return d==="straight"?[f,m,b]=$I(x):d==="step"?[f,m,b]=Lc({...x,borderRadius:0}):d==="smoothstep"?[f,m,b]=Lc(x):[f,m,b]=L0(x),p.jsxs(p.Fragment,{children:[p.jsx(Ka,{path:f,markerEnd:l,style:a,className:h}),c&&p.jsx(J5,{children:p.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${m}px,${b}px)`,pointerEvents:"all"},className:"nodrag nopan",children:p.jsx("div",{className:"custom-edge-label",children:c})})})]})},$L=t=>p.jsx(ff,{...t,type:"straight"}),UL=t=>p.jsx(ff,{...t,type:"step"}),BL=t=>p.jsx(ff,{...t,type:"smoothstep"}),HL=t=>p.jsx(ff,{...t,type:"default"}),tS=D.createContext(!0),Lo=t=>e=>{const n=D.useContext(tS);return D.createElement(t,{...e,isDarkMode:n})},qL={evidence:Lo(kL),note:Lo(PL),image:Lo(VL),text:Lo(zL),zone:Lo(ML),url:Lo(FL)},KL={default:HL,straight:$L,step:UL,smoothstep:BL},GL=({connectionColor:t})=>{const e=D.useMemo(()=>({hideAttribution:!0}),[]),n=D.useMemo(()=>({stroke:t,strokeWidth:2}),[t]),r=D.useCallback(i=>{switch(i.type){case"evidence":switch(i.data.category){case"person":return"#3b82f6";case"place":return"#22c55e";case"clue":return"#f97316";case"event":return"#ef4444";default:return"#ef4444"}case"note":return"#eab308";case"image":return"#a855f7";case"text":return"#71717a";default:return"#ef4444"}},[]);return{nodeTypes:qL,edgeTypes:KL,proOptions:e,connectionLineStyle:n,nodeColor:r}},WL=(t,e,n,r)=>{const[i,s]=D.useState([]),[o,a]=D.useState([]),l=D.useCallback(()=>{s(f=>[...f,{nodes:t,edges:e}]),a([])},[t,e]),c=D.useCallback(()=>{if(i.length===0)return;const f=i[i.length-1],m=i.slice(0,i.length-1);a(b=>[{nodes:t,edges:e},...b]),s(m),n(f.nodes),r(f.edges)},[i,t,e,n,r]),d=D.useCallback(()=>{if(o.length===0)return;const f=o[0],m=o.slice(1);s(b=>[...b,{nodes:t,edges:e}]),a(m),n(f.nodes),r(f.edges)},[o,t,e,n,r]),h=D.useCallback(()=>{s([]),a([])},[]);return{takeSnapshot:l,undo:c,redo:d,clearHistory:h,canUndo:i.length>0,canRedo:o.length>0}},QL=({nodes:t,edges:e,setNodes:n,setEdges:r,onNodesChange:i,onEdgesChange:s})=>{const{takeSnapshot:o,undo:a,redo:l,clearHistory:c}=WL(t,e,n,r),d=D.useCallback(b=>{n(x=>{var y;const R=x.find(v=>v.id===b);return!R||(y=R.data)!=null&&y.isDeleting?x:(setTimeout(()=>{n(v=>{var A;const T=v.find(O=>O.id===b);return T&&((A=T.data)!=null&&A.isDeleting)?v.filter(O=>O.id!==b):v}),r(v=>v.filter(T=>T.source!==b&&T.target!==b))},500),x.map(v=>v.id===b?{...v,data:{...v.data,isDeleting:!0}}:v))})},[n,r]),h=D.useCallback(b=>{r(x=>{var y;const R=x.find(v=>v.id===b);return!R||(y=R.className)!=null&&y.includes("deleting-edge")?x:(setTimeout(()=>{r(v=>v.filter(T=>T.id!==b))},300),x.map(v=>v.id===b?{...v,className:`${v.className||""} deleting-edge`}:v))})},[r]),f=D.useCallback(b=>{const x=b.filter(y=>y.type!=="remove"),R=b.filter(y=>y.type==="remove");R.length>0&&(o(),R.forEach(y=>d(y.id))),x.length>0&&i(x)},[i,o,d]),m=D.useCallback(b=>{const x=b.filter(y=>y.type!=="remove"),R=b.filter(y=>y.type==="remove");R.length>0&&(o(),R.forEach(y=>h(y.id))),x.length>0&&s(x)},[s,o,h]);return{takeSnapshot:o,undo:a,redo:l,clearHistory:c,onNodesChangeWithHistory:f,onEdgesChangeWithHistory:m,animateAndRemoveNode:d,animateAndRemoveEdge:h}},YL=(t,e,n,r,i)=>{const[s,o]=D.useState(null),a=D.useRef(null),l=D.useCallback(c=>{if(c.button!==2||!n||c.target.closest(".react-flow__node")||c.target.closest(".react-flow__edge")||c.target.closest(".react-flow__controls")||c.target.closest(".react-flow__minimap"))return;c.preventDefault();const{left:d,top:h}=t.current.getBoundingClientRect(),f=c.clientX-d,m=c.clientY-h;a.current={startX:f,startY:m,x:f,y:m,width:0,height:0,isDragging:!1};const b=R=>{if(R.buttons===0){x(R);return}if(!a.current||!t.current)return;const y=t.current.getBoundingClientRect(),v=R.clientX-y.left,T=R.clientY-y.top,A=Math.min(a.current.startX,v),O=Math.min(a.current.startY,T),L=Math.abs(v-a.current.startX),S=Math.abs(T-a.current.startY);(L>5||S>5)&&(a.current={...a.current,x:A,y:O,width:L,height:S,isDragging:!0},o({...a.current}))},x=R=>{var T;window.removeEventListener("pointermove",b),window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",x);const y=(T=a.current)==null?void 0:T.isDragging,v=a.current;if(a.current=null,o(null),!y)r(R);else if(v&&e){const A=t.current.getBoundingClientRect(),O=e.screenToFlowPosition({x:A.left+v.x,y:A.top+v.y}),L=e.screenToFlowPosition({x:A.left+v.x+v.width,y:A.top+v.y+v.height}),S={x:Math.min(O.x,L.x),y:Math.min(O.y,L.y),width:Math.abs(L.x-O.x),height:Math.abs(L.y-O.y)},I=e.getNodes().filter(w=>{var N,j,z,B;const E=w.width??((N=w.measured)==null?void 0:N.width)??200,C=w.height??((j=w.measured)==null?void 0:j.height)??150,P=((z=w.positionAbsolute)==null?void 0:z.x)??w.position.x,k=((B=w.positionAbsolute)==null?void 0:B.y)??w.position.y;return S.x<P+E&&S.x+S.width>P&&S.y<k+C&&S.y+S.height>k});i(w=>w.map(E=>({...E,selected:I.some(C=>C.id===E.id)||R.shiftKey&&E.selected})))}};window.addEventListener("pointermove",b),window.addEventListener("pointerup",x),window.addEventListener("pointercancel",x)},[n,r,e,i,t]);return{selectionRect:s,handleRightPointerDown:l}},XL=({isInteractive:t,reactFlowInstance:e,reactFlowWrapper:n,setEdges:r,setNodes:i,connectionLineType:s,connectionColor:o,takeSnapshot:a,setEditingNode:l,setEditingEdge:c,setInputModalOpen:d,setEditModalOpen:h,setMenu:f})=>{const m=D.useCallback(I=>{a(),r(w=>BI({...I,type:s,style:{stroke:o,strokeWidth:2}},w))},[r,o,a,s]),b=D.useCallback((I,w)=>{I.preventDefault(),I.stopPropagation(),t&&(l(null),c(w),d(!0))},[t,l,c,d]),x=D.useCallback((I,w)=>{t&&(a(),r(E=>E.map(C=>{var P;if(C.id===w.id){const k=(P=C.style)==null?void 0:P.strokeDasharray;return{...C,style:{...C.style,strokeDasharray:k?void 0:"10,10"}}}return C})))},[r,t,a]),R=D.useCallback(()=>f(null),[f]),y=D.useCallback(I=>{if(I.preventDefault(),!t)return;const w=n.current.getBoundingClientRect();f({top:I.clientY<w.bottom-200?I.clientY-w.top:void 0,left:I.clientX<w.right-200?I.clientX-w.left:void 0,right:I.clientX>=w.right-200?w.width-(I.clientX-w.left):void 0,bottom:I.clientY>=w.bottom-200?w.height-(I.clientY-w.top):void 0,clientX:I.clientX,clientY:I.clientY})},[t,n,f]),{selectionRect:v,handleRightPointerDown:T}=YL(n,e,t,y,i),A=D.useCallback((I,w)=>{w.type==="evidence"?(l(w),h(!0)):w.type==="zone"&&(c(null),l(w),d(!0))},[l,h,c,d]),O=D.useCallback((I,w)=>{a(),w.type!=="zone"&&i(E=>{const C=E.findIndex(N=>N.id===w.id);if(C===E.length-1)return E;const P=[...E],[k]=P.splice(C,1);return P.push(k),P})},[a,i]),L=D.useCallback(()=>{n.current&&n.current.classList.add("is-moving")},[n]),S=D.useCallback(()=>{n.current&&n.current.classList.remove("is-moving")},[n]);return{onConnect:m,onEdgeContextMenu:b,onEdgeClick:x,onPaneClick:R,onPaneContextMenu:y,onNodeDoubleClick:A,onNodeDragStart:O,onMoveStart:L,onMoveEnd:S,selectionRect:v,handleRightPointerDown:T}},JL=({reactFlowInstance:t,boards:e,currentBoardId:n,bgType:r,setBoards:i,setNodes:s,setEdges:o,setBgType:a,handleSwitchBoard:l,clearHistory:c,takeSnapshot:d,setConfirmModal:h})=>{const f=D.useCallback(()=>{if(t){const R={...t.toObject(),bgType:r},y=new Blob([JSON.stringify(R,null,2)],{type:"application/json"}),v=URL.createObjectURL(y),T=document.createElement("a");T.href=v;const A=e.find(L=>L.id===n),O=A?A.name.replace(/[^a-z0-9\u00C0-\u017F\s-_]/gi,""):"caso-detective";T.download=`${O}.json`,T.click(),URL.revokeObjectURL(v)}},[t,e,n,r]),m=D.useCallback(x=>{const R=x.target.files[0];if(!R)return;const y=R.name.replace(/\.json$/i,""),v=new FileReader;v.onload=T=>{try{const A=JSON.parse(T.target.result);if(A&&(A.nodes||A.edges)){const O=A.nodes||[],L=A.edges||[],S=A.bgType||"cork",I=e.find(w=>w.name===y);if(I)h({isOpen:!0,title:"SOBRESCRIBIR CASO?",message:`Ya existe un caso llamado "${y}". Deseas sobrescribir sus datos con este archivo?`,confirmText:"Sobrescribir",cancelText:"Cancelar",isDanger:!0,onConfirm:()=>{localStorage.setItem(`board-${I.id}-nodes`,JSON.stringify(O)),localStorage.setItem(`board-${I.id}-edges`,JSON.stringify(L)),localStorage.setItem(`board-${I.id}-bg`,S),I.id===n?(s(O),o(L),a(S),c()):l(I.id)}});else{const w=kn(),E={id:w,name:y,createdAt:Date.now(),lastModified:Date.now()};localStorage.setItem(`board-${w}-nodes`,JSON.stringify(O)),localStorage.setItem(`board-${w}-edges`,JSON.stringify(L)),localStorage.setItem(`board-${w}-bg`,S),i(C=>[...C,E]),l(w)}}}catch(A){console.error("Error al cargar el caso",A),alert("El archivo no es vlido.")}},v.readAsText(R),x.target.value=""},[e,n,s,o,a,l,i,h,c]),b=D.useCallback(()=>{h({isOpen:!0,title:"LIMPIAR TABLERO?",message:"Ests seguro de que quieres eliminar todo el contenido del tablero? Esta accin no se puede deshacer.",onConfirm:()=>{d(),s([]),o([])},isDanger:!0})},[d,s,o,h]);return{onSave:f,onLoad:m,onClear:b}},ZL=({searchTerm:t,setNodes:e,reactFlowInstance:n})=>(D.useEffect(()=>{if(e(i=>i.map(s=>{var c,d;if(!t)return{...s,style:{...s.style,opacity:1}};const o=((c=s.data.label)==null?void 0:c.toLowerCase())||"",a=((d=s.data.description)==null?void 0:d.toLowerCase())||"",l=o.includes(t.toLowerCase())||a.includes(t.toLowerCase());return{...s,style:{...s.style,opacity:l?1:.1}}})),t&&t.length>1&&n){const s=n.getNodes().find(o=>{var c,d;const a=((c=o.data.label)==null?void 0:c.toLowerCase())||"",l=((d=o.data.description)==null?void 0:d.toLowerCase())||"";return a.includes(t.toLowerCase())||l.includes(t.toLowerCase())});s&&n.setCenter(s.position.x+(s.width||0)/2,s.position.y+(s.height||0)/2,{zoom:1.5,duration:800})}},[t,e,n]),{navigateSearch:D.useCallback(i=>{if(!t||!n)return;const o=n.getNodes().filter(f=>{var x,R;const m=((x=f.data.label)==null?void 0:x.toLowerCase())||"",b=((R=f.data.description)==null?void 0:R.toLowerCase())||"";return m.includes(t.toLowerCase())||b.includes(t.toLowerCase())});if(o.length===0)return;const a=o.findIndex(f=>f.selected);let l=i==="next"?a+1:a-1;l>=o.length&&(l=0),l<0&&(l=o.length-1);const c=o[l];e(f=>f.map(m=>({...m,selected:m.id===c.id})));const d=c.width||150,h=c.height||50;n.setCenter(c.position.x+d/2,c.position.y+h/2,{zoom:1.5,duration:600})},[t,n,e])}),eM=t=>{const[e,n]=D.useState("#dc2626"),[r,i]=D.useState("straight"),[s,o]=D.useState(!0),[a,l]=D.useState(!0),[c,d]=D.useState(""),[h,f]=D.useState(!0),[m,b]=D.useState(!1),[x,R]=D.useState(t),y=D.useCallback(()=>{const v=["cork","blackboard","paper"];R(T=>v[(v.indexOf(T)+1)%v.length])},[]);return{connectionColor:e,setConnectionColor:n,connectionLineType:r,setConnectionLineType:i,isInteractive:s,setIsInteractive:o,isDarkMode:a,setIsDarkMode:l,searchTerm:c,setSearchTerm:d,isSidebarOpen:h,setIsSidebarOpen:f,isZenMode:m,setIsZenMode:b,bgType:x,setBgType:R,toggleBackground:y}},tM=({reactFlowInstance:t,setNodes:e,setEdges:n,takeSnapshot:r,animateAndRemoveNode:i,animateAndRemoveEdge:s,setEditModalOpen:o,setEditingNode:a,setEditingEdge:l,setInputModalOpen:c,setConnectionColor:d,setConnectionLineType:h,setPendingStampNodeId:f})=>{const m=D.useCallback((O,L)=>{r(),e(S=>S.map(I=>I.id===O?{...I,data:L}:I))},[e,r]),b=D.useCallback(O=>{r(),i(O),o(!1),a(null)},[i,r,o,a]),x=D.useCallback(()=>{if(!t)return;const O=t.getNodes().filter(L=>L.selected);if(O.length>0){r();const L=new Map,S=O.map(E=>{const C=kn();return L.set(E.id,C),{...E,id:C,position:{x:E.position.x+50,y:E.position.y+50},selected:!0,data:{...E.data}}}),w=t.getEdges().filter(E=>L.has(E.source)&&L.has(E.target)).map(E=>({...E,id:kn(),source:L.get(E.source),target:L.get(E.target),selected:!0}));e(E=>E.map(C=>({...C,selected:!1})).concat(S)),n(E=>E.map(C=>({...C,selected:!1})).concat(w))}},[t,e,n,r]),R=D.useCallback(O=>{d(O),n(L=>L.map(S=>S.selected?{...S,style:{...S.style,stroke:O}}:S))},[n,d]),y=D.useCallback(O=>{h(O),n(L=>L.map(S=>S.selected?{...S,type:O}:S))},[n,h]),v=D.useCallback((O,L,S,I)=>{I&&(r(),n(w=>w.map(E=>E.id===I.id?{...E,label:O,type:S||E.type,style:{...E.style,stroke:L},labelStyle:void 0,labelBgStyle:void 0}:E)),l(null))},[n,r,l]),T=D.useCallback((O,L)=>{O?(r(),s(O.id),l(null),c(!1)):L&&L.type==="zone"&&(b(L.id),c(!1))},[s,b,r,l,c]),A=D.useCallback((O,L,S,I,w,E)=>{I?v(O,L,S,I):w&&w.type==="zone"?(r(),e(C=>C.map(P=>P.id===w.id?{...P,data:{...P.data,label:O},style:{...P.style,borderColor:L,backgroundColor:`${L}10`}}:P)),a(null),c(!1)):E&&(r(),e(C=>C.map(P=>P.id===E?{...P,data:{...P.data,status:{type:"custom",label:O||"SELLO",color:L}}}:P)),f(null),c(!1))},[v,e,r,a,c,f]);return{handleSaveNode:m,handleDeleteNode:b,duplicateSelected:x,handleConnectionColorChange:R,handleConnectionLineTypeChange:y,handleEdgeLabelSave:v,handleEdgeDelete:T,handleInputModalConfirm:A}};var qw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},nM=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},rS={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(nS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):nM(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new rM;const f=s<<2|a>>4;if(r.push(f),c!==64){const m=a<<4&240|c>>2;if(r.push(m),h!==64){const b=c<<6&192|h;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class rM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const iM=function(t){const e=nS(t);return rS.encodeByteArray(e,!0)},wh=function(t){return iM(t).replace(/\./g,"")},iS=function(t){try{return rS.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oM=()=>sM().__FIREBASE_DEFAULTS__,aM=()=>{if(typeof process>"u"||typeof qw>"u")return;const t=qw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},lM=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&iS(t[1]);return e&&JSON.parse(e)},pf=()=>{try{return oM()||aM()||lM()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},sS=t=>{var e,n;return(n=(e=pf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},cM=t=>{const e=sS(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},oS=()=>{var t;return(t=pf())===null||t===void 0?void 0:t.config},aS=t=>{var e;return(e=pf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dM(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",i=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t);return[wh(JSON.stringify(n)),wh(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function hM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bt())}function fM(){var t;const e=(t=pf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function pM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function mM(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function gM(){const t=bt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function cS(){return!fM()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function Z0(){try{return typeof indexedDB=="object"}catch{return!1}}function uS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function yM(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vM="FirebaseError";class yr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=vM,Object.setPrototypeOf(this,yr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yo.prototype.create)}}class yo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?_M(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new yr(i,a,r)}}function _M(t,e){return t.replace(wM,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const wM=/\{\$([^}]+)}/g;function xM(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function jc(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Kw(s)&&Kw(o)){if(!jc(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Kw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function su(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Ul(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Bl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function EM(t,e){const n=new bM(t,e);return n.subscribe.bind(n)}class bM{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");IM(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=kp),i.error===void 0&&(i.error=kp),i.complete===void 0&&(i.complete=kp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function IM(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function kp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TM=1e3,SM=2,CM=4*60*60*1e3,AM=.5;function Gw(t,e=TM,n=SM){const r=e*Math.pow(n,t),i=Math.round(AM*r*(Math.random()-.5)*2);return Math.min(CM,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nt(t){return t&&t._delegate?t._delegate:t}class mr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kM{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new uM;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(PM(e))try{this.getOrInitializeService({instanceIdentifier:Rs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Rs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Rs){return this.instances.has(e)}getOptions(e=Rs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:RM(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Rs){return this.component?this.component.multipleInstances?e:Rs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function RM(t){return t===Rs?void 0:t}function PM(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new kM(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ie;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ie||(Ie={}));const DM={debug:Ie.DEBUG,verbose:Ie.VERBOSE,info:Ie.INFO,warn:Ie.WARN,error:Ie.ERROR,silent:Ie.SILENT},VM=Ie.INFO,OM={[Ie.DEBUG]:"log",[Ie.VERBOSE]:"log",[Ie.INFO]:"info",[Ie.WARN]:"warn",[Ie.ERROR]:"error"},zM=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=OM[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class mf{constructor(e){this.name=e,this._logLevel=VM,this._logHandler=zM,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ie))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?DM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ie.DEBUG,...e),this._logHandler(this,Ie.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ie.VERBOSE,...e),this._logHandler(this,Ie.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ie.INFO,...e),this._logHandler(this,Ie.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ie.WARN,...e),this._logHandler(this,Ie.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ie.ERROR,...e),this._logHandler(this,Ie.ERROR,...e)}}const LM=(t,e)=>e.some(n=>t instanceof n);let Ww,Qw;function MM(){return Ww||(Ww=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function jM(){return Qw||(Qw=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const dS=new WeakMap,ng=new WeakMap,hS=new WeakMap,Rp=new WeakMap,ey=new WeakMap;function FM(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(rs(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&dS.set(n,t)}).catch(()=>{}),ey.set(e,t),e}function $M(t){if(ng.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});ng.set(t,e)}let rg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return ng.get(t);if(e==="objectStoreNames")return t.objectStoreNames||hS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return rs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function UM(t){rg=t(rg)}function BM(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Pp(this),e,...n);return hS.set(r,e.sort?e.sort():[e]),rs(r)}:jM().includes(t)?function(...e){return t.apply(Pp(this),e),rs(dS.get(this))}:function(...e){return rs(t.apply(Pp(this),e))}}function HM(t){return typeof t=="function"?BM(t):(t instanceof IDBTransaction&&$M(t),LM(t,MM())?new Proxy(t,rg):t)}function rs(t){if(t instanceof IDBRequest)return FM(t);if(Rp.has(t))return Rp.get(t);const e=HM(t);return e!==t&&(Rp.set(t,e),ey.set(e,t)),e}const Pp=t=>ey.get(t);function fS(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=rs(o);return r&&o.addEventListener("upgradeneeded",l=>{r(rs(o.result),l.oldVersion,l.newVersion,rs(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const qM=["get","getKey","getAll","getAllKeys","count"],KM=["put","add","delete","clear"],Np=new Map;function Yw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Np.get(e))return Np.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=KM.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||qM.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return Np.set(e,s),s}UM(t=>({...t,get:(e,n,r)=>Yw(e,n)||t.get(e,n,r),has:(e,n)=>!!Yw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(WM(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function WM(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const ig="@firebase/app",Xw="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fi=new mf("@firebase/app"),QM="@firebase/app-compat",YM="@firebase/analytics-compat",XM="@firebase/analytics",JM="@firebase/app-check-compat",ZM="@firebase/app-check",e3="@firebase/auth",t3="@firebase/auth-compat",n3="@firebase/database",r3="@firebase/data-connect",i3="@firebase/database-compat",s3="@firebase/functions",o3="@firebase/functions-compat",a3="@firebase/installations",l3="@firebase/installations-compat",c3="@firebase/messaging",u3="@firebase/messaging-compat",d3="@firebase/performance",h3="@firebase/performance-compat",f3="@firebase/remote-config",p3="@firebase/remote-config-compat",m3="@firebase/storage",g3="@firebase/storage-compat",y3="@firebase/firestore",v3="@firebase/vertexai-preview",_3="@firebase/firestore-compat",w3="firebase",x3="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sg="[DEFAULT]",E3={[ig]:"fire-core",[QM]:"fire-core-compat",[XM]:"fire-analytics",[YM]:"fire-analytics-compat",[ZM]:"fire-app-check",[JM]:"fire-app-check-compat",[e3]:"fire-auth",[t3]:"fire-auth-compat",[n3]:"fire-rtdb",[r3]:"fire-data-connect",[i3]:"fire-rtdb-compat",[s3]:"fire-fn",[o3]:"fire-fn-compat",[a3]:"fire-iid",[l3]:"fire-iid-compat",[c3]:"fire-fcm",[u3]:"fire-fcm-compat",[d3]:"fire-perf",[h3]:"fire-perf-compat",[f3]:"fire-rc",[p3]:"fire-rc-compat",[m3]:"fire-gcs",[g3]:"fire-gcs-compat",[y3]:"fire-fst",[_3]:"fire-fst-compat",[v3]:"fire-vertex","fire-js":"fire-js",[w3]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xh=new Map,b3=new Map,og=new Map;function Jw(t,e){try{t.container.addComponent(e)}catch(n){fi.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Pr(t){const e=t.name;if(og.has(e))return fi.debug(`There were multiple attempts to register component ${e}.`),!1;og.set(e,t);for(const n of xh.values())Jw(n,t);for(const n of b3.values())Jw(n,t);return!0}function vo(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function cr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I3={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},is=new yo("app","Firebase",I3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T3{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw is.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=x3;function pS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:sg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw is.create("bad-app-name",{appName:String(i)});if(n||(n=oS()),!n)throw is.create("no-options");const s=xh.get(i);if(s){if(jc(n,s.options)&&jc(r,s.config))return s;throw is.create("duplicate-app",{appName:i})}const o=new NM(i);for(const l of og.values())o.addComponent(l);const a=new T3(n,r,o);return xh.set(i,a),a}function ty(t=sg){const e=xh.get(t);if(!e&&t===sg&&oS())return pS();if(!e)throw is.create("no-app",{appName:t});return e}function Gn(t,e,n){var r;let i=(r=E3[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),fi.warn(a.join(" "));return}Pr(new mr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S3="firebase-heartbeat-database",C3=1,Fc="firebase-heartbeat-store";let Dp=null;function mS(){return Dp||(Dp=fS(S3,C3,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Fc)}catch(n){console.warn(n)}}}}).catch(t=>{throw is.create("idb-open",{originalErrorMessage:t.message})})),Dp}async function A3(t){try{const n=(await mS()).transaction(Fc),r=await n.objectStore(Fc).get(gS(t));return await n.done,r}catch(e){if(e instanceof yr)fi.warn(e.message);else{const n=is.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});fi.warn(n.message)}}}async function Zw(t,e){try{const r=(await mS()).transaction(Fc,"readwrite");await r.objectStore(Fc).put(e,gS(t)),await r.done}catch(n){if(n instanceof yr)fi.warn(n.message);else{const r=is.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});fi.warn(r.message)}}}function gS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k3=1024,R3=30*24*60*60*1e3;class P3{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new D3(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=ex();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=R3}),this._storage.overwrite(this._heartbeatsCache))}catch(r){fi.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=ex(),{heartbeatsToSend:r,unsentEntries:i}=N3(this._heartbeatsCache.heartbeats),s=wh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return fi.warn(n),""}}}function ex(){return new Date().toISOString().substring(0,10)}function N3(t,e=k3){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),tx(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),tx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class D3{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Z0()?uS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await A3(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return Zw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function tx(t){return wh(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V3(t){Pr(new mr("platform-logger",e=>new GM(e),"PRIVATE")),Pr(new mr("heartbeat",e=>new P3(e),"PRIVATE")),Gn(ig,Xw,t),Gn(ig,Xw,"esm2017"),Gn("fire-js","")}V3("");function ny(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function yS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const O3=yS,vS=new yo("auth","Firebase",yS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh=new mf("@firebase/auth");function z3(t,...e){Eh.logLevel<=Ie.WARN&&Eh.warn(`Auth (${Ya}): ${t}`,...e)}function Sd(t,...e){Eh.logLevel<=Ie.ERROR&&Eh.error(`Auth (${Ya}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xn(t,...e){throw iy(t,...e)}function fr(t,...e){return iy(t,...e)}function ry(t,e,n){const r=Object.assign(Object.assign({},O3()),{[e]:n});return new yo("auth","Firebase",r).create(e,{appName:t.name})}function oi(t){return ry(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function L3(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Xn(t,"argument-error"),ry(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function iy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return vS.create(t,...e)}function me(t,e,...n){if(!t)throw iy(e,...n)}function ei(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Sd(e),new Error(e)}function pi(t,e){t||ei(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ag(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function M3(){return nx()==="http:"||nx()==="https:"}function nx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j3(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(M3()||lS()||"connection"in navigator)?navigator.onLine:!0}function F3(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e,n){this.shortDelay=e,this.longDelay=n,pi(n>e,"Short delay should be less than long delay!"),this.isMobile=hM()||mM()}get(){return j3()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t,e){pi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $3={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U3=new ou(3e4,6e4);function vi(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Or(t,e,n,r,i={}){return wS(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=su(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return pM()||(c.referrerPolicy="no-referrer"),_S.fetch()(xS(t,t.config.apiHost,n,a),c)})}async function wS(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},$3),e);try{const i=new H3(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw rd(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw rd(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw rd(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw rd(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw ry(t,d,c);Xn(t,d)}}catch(i){if(i instanceof yr)throw i;Xn(t,"network-request-failed",{message:String(i)})}}async function au(t,e,n,r,i={}){const s=await Or(t,e,n,r,i);return"mfaPendingCredential"in s&&Xn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function xS(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?sy(t.config,i):`${t.config.apiScheme}://${i}`}function B3(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class H3{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(fr(this.auth,"network-request-failed")),U3.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function rd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=fr(t,e,r);return i.customData._tokenResponse=n,i}function rx(t){return t!==void 0&&t.enterprise!==void 0}class q3{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return B3(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function K3(t,e){return Or(t,"GET","/v2/recaptchaConfig",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G3(t,e){return Or(t,"POST","/v1/accounts:delete",e)}async function ES(t,e){return Or(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function W3(t,e=!1){const n=Nt(t),r=await n.getIdToken(e),i=oy(r);me(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:sc(Vp(i.auth_time)),issuedAtTime:sc(Vp(i.iat)),expirationTime:sc(Vp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Vp(t){return Number(t)*1e3}function oy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Sd("JWT malformed, contained fewer than 3 sections"),null;try{const i=iS(n);return i?JSON.parse(i):(Sd("Failed to decode base64 JWT payload"),null)}catch(i){return Sd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function ix(t){const e=oy(t);return me(e,"internal-error"),me(typeof e.exp<"u","internal-error"),me(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pa(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof yr&&Q3(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Q3({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y3{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lg{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=sc(this.lastLoginAt),this.creationTime=sc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Pa(t,ES(n,{idToken:r}));me(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?bS(s.providerUserInfo):[],a=J3(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new lg(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function X3(t){const e=Nt(t);await bh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function J3(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function bS(t){return t.map(e=>{var{providerId:n}=e,r=ny(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z3(t,e){const n=await wS(t,{},async()=>{const r=su({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=xS(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",_S.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function ej(t,e){return Or(t,"POST","/v2/accounts:revokeToken",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ga{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){me(e.idToken,"internal-error"),me(typeof e.idToken<"u","internal-error"),me(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):ix(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){me(e.length!==0,"internal-error");const n=ix(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(me(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await Z3(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new ga;return r&&(me(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(me(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(me(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ga,this.toJSON())}_performRefresh(){return ei("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ri(t,e){me(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class ti{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=ny(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Y3(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new lg(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Pa(this,this.stsTokenManager.getToken(this.auth,e));return me(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return W3(this,e)}reload(){return X3(this)}_assign(e){this!==e&&(me(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new ti(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){me(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await bh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cr(this.auth.app))return Promise.reject(oi(this.auth));const e=await this.getIdToken();return await Pa(this,G3(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,c,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(i=n.email)!==null&&i!==void 0?i:void 0,m=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,b=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,R=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=n.createdAt)!==null&&c!==void 0?c:void 0,v=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:T,emailVerified:A,isAnonymous:O,providerData:L,stsTokenManager:S}=n;me(T&&S,e,"internal-error");const I=ga.fromJSON(this.name,S);me(typeof T=="string",e,"internal-error"),Ri(h,e.name),Ri(f,e.name),me(typeof A=="boolean",e,"internal-error"),me(typeof O=="boolean",e,"internal-error"),Ri(m,e.name),Ri(b,e.name),Ri(x,e.name),Ri(R,e.name),Ri(y,e.name),Ri(v,e.name);const w=new ti({uid:T,auth:e,email:f,emailVerified:A,displayName:h,isAnonymous:O,photoURL:b,phoneNumber:m,tenantId:x,stsTokenManager:I,createdAt:y,lastLoginAt:v});return L&&Array.isArray(L)&&(w.providerData=L.map(E=>Object.assign({},E))),R&&(w._redirectEventId=R),w}static async _fromIdTokenResponse(e,n,r=!1){const i=new ga;i.updateFromServerResponse(n);const s=new ti({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await bh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];me(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?bS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new ga;a.updateFromIdToken(r);const l=new ti({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new lg(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx=new Map;function ni(t){pi(t instanceof Function,"Expected a class definition");let e=sx.get(t);return e?(pi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,sx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IS{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}IS.type="NONE";const ox=IS;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cd(t,e,n){return`firebase:${t}:${e}:${n}`}class ya{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Cd(this.userKey,i.apiKey,s),this.fullPersistenceKey=Cd("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ti._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new ya(ni(ox),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||ni(ox);const o=Cd(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const d=await c._get(o);if(d){const h=ti._fromJSON(e,d);c!==s&&(a=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new ya(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new ya(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(AS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(TS(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(RS(e))return"Blackberry";if(PS(e))return"Webos";if(SS(e))return"Safari";if((e.includes("chrome/")||CS(e))&&!e.includes("edge/"))return"Chrome";if(kS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function TS(t=bt()){return/firefox\//i.test(t)}function SS(t=bt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function CS(t=bt()){return/crios\//i.test(t)}function AS(t=bt()){return/iemobile/i.test(t)}function kS(t=bt()){return/android/i.test(t)}function RS(t=bt()){return/blackberry/i.test(t)}function PS(t=bt()){return/webos/i.test(t)}function ay(t=bt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function tj(t=bt()){var e;return ay(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function nj(){return gM()&&document.documentMode===10}function NS(t=bt()){return ay(t)||kS(t)||PS(t)||RS(t)||/windows phone/i.test(t)||AS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DS(t,e=[]){let n;switch(t){case"Browser":n=ax(bt());break;case"Worker":n=`${ax(bt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ya}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ij(t,e={}){return Or(t,"GET","/v2/passwordPolicy",vi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sj=6;class oj{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:sj,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lx(this),this.idTokenSubscription=new lx(this),this.beforeStateQueue=new rj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=vS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ni(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await ya.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ES(this,{idToken:e}),r=await ti._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(cr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return me(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await bh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=F3()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cr(this.app))return Promise.reject(oi(this));const n=e?Nt(e):null;return n&&me(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&me(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cr(this.app)?Promise.reject(oi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cr(this.app)?Promise.reject(oi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ni(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await ij(this),n=new oj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new yo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await ej(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ni(e)||this._popupRedirectResolver;me(n,this,"argument-error"),this.redirectPersistenceManager=await ya.create(this,[ni(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(me(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return me(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=DS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&z3(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function _i(t){return Nt(t)}class lx{constructor(e){this.auth=e,this.observer=null,this.addObserver=EM(n=>this.observer=n)}get next(){return me(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function lj(t){gf=t}function VS(t){return gf.loadJS(t)}function cj(){return gf.recaptchaEnterpriseScript}function uj(){return gf.gapiScript}function dj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const hj="recaptcha-enterprise",fj="NO_RECAPTCHA";class pj{constructor(e){this.type=hj,this.auth=_i(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{K3(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new q3(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;rx(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(fj)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&rx(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=cj();l.length!==0&&(l+=a),VS(l).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function cx(t,e,n,r=!1){const i=new pj(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Ih(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await cx(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await cx(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(t,e){const n=vo(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(jc(s,e??{}))return i;Xn(i,"already-initialized")}return n.initialize({options:e})}function gj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ni);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function yj(t,e,n){const r=_i(t);me(r._canInitEmulator,r,"emulator-config-failed"),me(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=OS(e),{host:o,port:a}=vj(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),_j()}function OS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function vj(t){const e=OS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:ux(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:ux(o)}}}function ux(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function _j(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ei("not implemented")}_getIdTokenResponse(e){return ei("not implemented")}_linkToIdToken(e,n){return ei("not implemented")}_getReauthenticationResolver(e){return ei("not implemented")}}async function wj(t,e){return Or(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xj(t,e){return au(t,"POST","/v1/accounts:signInWithPassword",vi(t,e))}async function Ej(t,e){return Or(t,"POST","/v1/accounts:sendOobCode",vi(t,e))}async function bj(t,e){return Ej(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ij(t,e){return au(t,"POST","/v1/accounts:signInWithEmailLink",vi(t,e))}async function Tj(t,e){return au(t,"POST","/v1/accounts:signInWithEmailLink",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $c extends ly{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new $c(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new $c(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,n,"signInWithPassword",xj);case"emailLink":return Ij(e,{email:this._email,oobCode:this._password});default:Xn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Ih(e,r,"signUpPassword",wj);case"emailLink":return Tj(e,{idToken:n,email:this._email,oobCode:this._password});default:Xn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function va(t,e){return au(t,"POST","/v1/accounts:signInWithIdp",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sj="http://localhost";class no extends ly{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new no(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Xn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=ny(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new no(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return va(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,va(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,va(e,n)}buildRequest(){const e={requestUri:Sj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=su(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Aj(t){const e=Ul(Bl(t)).link,n=e?Ul(Bl(e)).deep_link_id:null,r=Ul(Bl(t)).deep_link_id;return(r?Ul(Bl(r)).link:null)||r||n||e||t}class cy{constructor(e){var n,r,i,s,o,a;const l=Ul(Bl(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,h=Cj((i=l.mode)!==null&&i!==void 0?i:null);me(c&&d&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=Aj(e);try{return new cy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(){this.providerId=Xa.PROVIDER_ID}static credential(e,n){return $c._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=cy.parseLink(n);return me(r,"argument-error"),$c._fromEmailAndCode(e,r.code,r.tenantId)}}Xa.PROVIDER_ID="password";Xa.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Xa.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu extends uy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi extends lu{constructor(){super("facebook.com")}static credential(e){return no._fromParams({providerId:Fi.PROVIDER_ID,signInMethod:Fi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Fi.credentialFromTaggedObject(e)}static credentialFromError(e){return Fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Fi.credential(e.oauthAccessToken)}catch{return null}}}Fi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Fi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr extends lu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return no._fromParams({providerId:Yr.PROVIDER_ID,signInMethod:Yr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Yr.credentialFromTaggedObject(e)}static credentialFromError(e){return Yr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Yr.credential(n,r)}catch{return null}}}Yr.GOOGLE_SIGN_IN_METHOD="google.com";Yr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i extends lu{constructor(){super("github.com")}static credential(e){return no._fromParams({providerId:$i.PROVIDER_ID,signInMethod:$i.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return $i.credentialFromTaggedObject(e)}static credentialFromError(e){return $i.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return $i.credential(e.oauthAccessToken)}catch{return null}}}$i.GITHUB_SIGN_IN_METHOD="github.com";$i.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ui extends lu{constructor(){super("twitter.com")}static credential(e,n){return no._fromParams({providerId:Ui.PROVIDER_ID,signInMethod:Ui.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Ui.credentialFromTaggedObject(e)}static credentialFromError(e){return Ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Ui.credential(n,r)}catch{return null}}}Ui.TWITTER_SIGN_IN_METHOD="twitter.com";Ui.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kj(t,e){return au(t,"POST","/v1/accounts:signUp",vi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ro{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await ti._fromIdTokenResponse(e,r,i),o=dx(r);return new ro({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=dx(r);return new ro({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function dx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Th extends yr{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Th.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Th(e,n,r,i)}}function zS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Th._fromErrorAndOperation(t,s,e,r):s})}async function Rj(t,e,n=!1){const r=await Pa(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ro._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pj(t,e,n=!1){const{auth:r}=t;if(cr(r.app))return Promise.reject(oi(r));const i="reauthenticate";try{const s=await Pa(t,zS(r,i,e,t),n);me(s.idToken,r,"internal-error");const o=oy(s.idToken);me(o,r,"internal-error");const{sub:a}=o;return me(t.uid===a,r,"user-mismatch"),ro._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Xn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LS(t,e,n=!1){if(cr(t.app))return Promise.reject(oi(t));const r="signIn",i=await zS(t,r,e),s=await ro._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Nj(t,e){return LS(_i(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function MS(t){const e=_i(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Dj(t,e,n){const r=_i(t);await Ih(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",bj)}async function Vj(t,e,n){if(cr(t.app))return Promise.reject(oi(t));const r=_i(t),o=await Ih(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",kj).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&MS(t),l}),a=await ro._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function Oj(t,e,n){return cr(t.app)?Promise.reject(oi(t)):Nj(Nt(t),Xa.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&MS(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zj(t,e){return Or(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Lj(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Nt(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Pa(r,zj(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Mj(t,e,n,r){return Nt(t).onIdTokenChanged(e,n,r)}function jj(t,e,n){return Nt(t).beforeAuthStateChanged(e,n)}function Fj(t,e,n,r){return Nt(t).onAuthStateChanged(e,n,r)}function $j(t){return Nt(t).signOut()}const Sh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jS{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Sh,"1"),this.storage.removeItem(Sh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uj=1e3,Bj=10;class FS extends jS{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=NS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);nj()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Bj):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Uj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}FS.type="LOCAL";const Hj=FS;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S extends jS{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}$S.type="SESSION";const US=$S;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new yf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await qj(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}yf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dy(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=dy("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kr(){return window}function Gj(t){kr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(){return typeof kr().WorkerGlobalScope<"u"&&typeof kr().importScripts=="function"}async function Wj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Qj(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Yj(){return BS()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HS="firebaseLocalStorageDb",Xj=1,Ch="firebaseLocalStorage",qS="fbase_key";class cu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function vf(t,e){return t.transaction([Ch],e?"readwrite":"readonly").objectStore(Ch)}function Jj(){const t=indexedDB.deleteDatabase(HS);return new cu(t).toPromise()}function cg(){const t=indexedDB.open(HS,Xj);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Ch,{keyPath:qS})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Ch)?e(r):(r.close(),await Jj(),e(await cg()))})})}async function hx(t,e,n){const r=vf(t,!0).put({[qS]:e,value:n});return new cu(r).toPromise()}async function Zj(t,e){const n=vf(t,!1).get(e),r=await new cu(n).toPromise();return r===void 0?null:r.value}function fx(t,e){const n=vf(t,!0).delete(e);return new cu(n).toPromise()}const e6=800,t6=3;class KS{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await cg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>t6)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return BS()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=yf._getInstance(Yj()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Wj(),!this.activeServiceWorker)return;this.sender=new Kj(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Qj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await cg();return await hx(e,Sh,"1"),await fx(e,Sh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>hx(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Zj(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>fx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=vf(i,!1).getAll();return new cu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),e6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}KS.type="LOCAL";const n6=KS;new ou(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GS(t,e){return e?ni(e):(me(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy extends ly{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return va(e,this._buildIdpRequest())}_linkToIdToken(e,n){return va(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return va(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function r6(t){return LS(t.auth,new hy(t),t.bypassAuthState)}function i6(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),Pj(n,new hy(t),t.bypassAuthState)}async function s6(t){const{auth:e,user:n}=t;return me(n,e,"internal-error"),Rj(n,new hy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WS{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return r6;case"linkViaPopup":case"linkViaRedirect":return s6;case"reauthViaPopup":case"reauthViaRedirect":return i6;default:Xn(this.auth,"internal-error")}}resolve(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o6=new ou(2e3,1e4);async function a6(t,e,n){if(cr(t.app))return Promise.reject(fr(t,"operation-not-supported-in-this-environment"));const r=_i(t);L3(t,e,uy);const i=GS(r,n);return new $s(r,"signInViaPopup",e,i).executeNotNull()}class $s extends WS{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,$s.currentPopupAction&&$s.currentPopupAction.cancel(),$s.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return me(e,this.auth,"internal-error"),e}async onExecution(){pi(this.filter.length===1,"Popup operations only handle one event");const e=dy();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(fr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(fr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,$s.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,o6.get())};e()}}$s.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6="pendingRedirect",Ad=new Map;class c6 extends WS{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ad.get(this.auth._key());if(!e){try{const r=await u6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ad.set(this.auth._key(),e)}return this.bypassAuthState||Ad.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function u6(t,e){const n=f6(e),r=h6(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function d6(t,e){Ad.set(t._key(),e)}function h6(t){return ni(t._redirectPersistence)}function f6(t){return Cd(l6,t.config.apiKey,t.name)}async function p6(t,e,n=!1){if(cr(t.app))return Promise.reject(oi(t));const r=_i(t),i=GS(r,e),o=await new c6(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6=10*60*1e3;class g6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!y6(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!QS(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(fr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=m6&&this.cachedEventUids.clear(),this.cachedEventUids.has(px(e))}saveEventToCache(e){this.cachedEventUids.add(px(e)),this.lastProcessedEventTime=Date.now()}}function px(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function QS({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function y6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return QS(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v6(t,e={}){return Or(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,w6=/^https?/;async function x6(t){if(t.config.emulator)return;const{authorizedDomains:e}=await v6(t);for(const n of e)try{if(E6(n))return}catch{}Xn(t,"unauthorized-domain")}function E6(t){const e=ag(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!w6.test(n))return!1;if(_6.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b6=new ou(3e4,6e4);function mx(){const t=kr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function I6(t){return new Promise((e,n)=>{var r,i,s;function o(){mx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mx(),n(fr(t,"network-request-failed"))},timeout:b6.get()})}if(!((i=(r=kr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=kr().gapi)===null||s===void 0)&&s.load)o();else{const a=dj("iframefcb");return kr()[a]=()=>{gapi.load?o():n(fr(t,"network-request-failed"))},VS(`${uj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw kd=null,e})}let kd=null;function T6(t){return kd=kd||I6(t),kd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6=new ou(5e3,15e3),C6="__/auth/iframe",A6="emulator/auth/iframe",k6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},R6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function P6(t){const e=t.config;me(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?sy(e,A6):`https://${t.config.authDomain}/${C6}`,r={apiKey:e.apiKey,appName:t.name,v:Ya},i=R6.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${su(r).slice(1)}`}async function N6(t){const e=await T6(t),n=kr().gapi;return me(n,t,"internal-error"),e.open({where:document.body,url:P6(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:k6,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=fr(t,"network-request-failed"),a=kr().setTimeout(()=>{s(o)},S6.get());function l(){kr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},V6=500,O6=600,z6="_blank",L6="http://localhost";class gx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function M6(t,e,n,r=V6,i=O6){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},D6),{width:r.toString(),height:i.toString(),top:s,left:o}),c=bt().toLowerCase();n&&(a=CS(c)?z6:n),TS(c)&&(e=e||L6,l.scrollbars="yes");const d=Object.entries(l).reduce((f,[m,b])=>`${f}${m}=${b},`,"");if(tj(c)&&a!=="_self")return j6(e||"",a),new gx(null);const h=window.open(e||"",a,d);me(h,t,"popup-blocked");try{h.focus()}catch{}return new gx(h)}function j6(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6="__/auth/handler",$6="emulator/auth/handler",U6=encodeURIComponent("fac");async function yx(t,e,n,r,i,s){me(t.config.authDomain,t,"auth-domain-config-required"),me(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:Ya,eventId:i};if(e instanceof uy){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",xM(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))o[d]=h}if(e instanceof lu){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),c=l?`#${U6}=${encodeURIComponent(l)}`:"";return`${B6(t)}?${su(a).slice(1)}${c}`}function B6({config:t}){return t.emulator?sy(t,$6):`https://${t.authDomain}/${F6}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op="webStorageSupport";class H6{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=US,this._completeRedirectFn=p6,this._overrideRedirectResult=d6}async _openPopup(e,n,r,i){var s;pi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await yx(e,n,r,ag(),i);return M6(e,o,dy())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await yx(e,n,r,ag(),i);return Gj(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(pi(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await N6(e),r=new g6(e);return n.register("authEvent",i=>(me(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Op,{type:Op},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Op];o!==void 0&&n(!!o),Xn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=x6(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return NS()||SS()||ay()}}const q6=H6;var vx="@firebase/auth",_x="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){me(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G6(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function W6(t){Pr(new mr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;me(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:DS(t)},c=new aj(r,i,s,l);return gj(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Pr(new mr("auth-internal",e=>{const n=_i(e.getProvider("auth").getImmediate());return(r=>new K6(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Gn(vx,_x,G6(t)),Gn(vx,_x,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6=5*60,Y6=aS("authIdTokenMaxAge")||Q6;let wx=null;const X6=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Y6)return;const i=n==null?void 0:n.token;wx!==i&&(wx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function J6(t=ty()){const e=vo(t,"auth");if(e.isInitialized())return e.getImmediate();const n=mj(t,{popupRedirectResolver:q6,persistence:[n6,Hj,US]}),r=aS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=X6(s.toString());jj(n,o,()=>o(n.currentUser)),Mj(n,a=>o(a))}}const i=sS("auth");return i&&yj(n,`http://${i}`),n}function Z6(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}lj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=fr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",Z6().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});W6("Browser");var e9="firebase",t9="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gn(e9,t9,"app");var xx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Gs,YS;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,I){function w(){}w.prototype=I.prototype,S.D=I.prototype,S.prototype=new w,S.prototype.constructor=S,S.C=function(E,C,P){for(var k=Array(arguments.length-2),N=2;N<arguments.length;N++)k[N-2]=arguments[N];return I.prototype[C].apply(E,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,I,w){w||(w=0);var E=Array(16);if(typeof I=="string")for(var C=0;16>C;++C)E[C]=I.charCodeAt(w++)|I.charCodeAt(w++)<<8|I.charCodeAt(w++)<<16|I.charCodeAt(w++)<<24;else for(C=0;16>C;++C)E[C]=I[w++]|I[w++]<<8|I[w++]<<16|I[w++]<<24;I=S.g[0],w=S.g[1],C=S.g[2];var P=S.g[3],k=I+(P^w&(C^P))+E[0]+3614090360&4294967295;I=w+(k<<7&4294967295|k>>>25),k=P+(C^I&(w^C))+E[1]+3905402710&4294967295,P=I+(k<<12&4294967295|k>>>20),k=C+(w^P&(I^w))+E[2]+606105819&4294967295,C=P+(k<<17&4294967295|k>>>15),k=w+(I^C&(P^I))+E[3]+3250441966&4294967295,w=C+(k<<22&4294967295|k>>>10),k=I+(P^w&(C^P))+E[4]+4118548399&4294967295,I=w+(k<<7&4294967295|k>>>25),k=P+(C^I&(w^C))+E[5]+1200080426&4294967295,P=I+(k<<12&4294967295|k>>>20),k=C+(w^P&(I^w))+E[6]+2821735955&4294967295,C=P+(k<<17&4294967295|k>>>15),k=w+(I^C&(P^I))+E[7]+4249261313&4294967295,w=C+(k<<22&4294967295|k>>>10),k=I+(P^w&(C^P))+E[8]+1770035416&4294967295,I=w+(k<<7&4294967295|k>>>25),k=P+(C^I&(w^C))+E[9]+2336552879&4294967295,P=I+(k<<12&4294967295|k>>>20),k=C+(w^P&(I^w))+E[10]+4294925233&4294967295,C=P+(k<<17&4294967295|k>>>15),k=w+(I^C&(P^I))+E[11]+2304563134&4294967295,w=C+(k<<22&4294967295|k>>>10),k=I+(P^w&(C^P))+E[12]+1804603682&4294967295,I=w+(k<<7&4294967295|k>>>25),k=P+(C^I&(w^C))+E[13]+4254626195&4294967295,P=I+(k<<12&4294967295|k>>>20),k=C+(w^P&(I^w))+E[14]+2792965006&4294967295,C=P+(k<<17&4294967295|k>>>15),k=w+(I^C&(P^I))+E[15]+1236535329&4294967295,w=C+(k<<22&4294967295|k>>>10),k=I+(C^P&(w^C))+E[1]+4129170786&4294967295,I=w+(k<<5&4294967295|k>>>27),k=P+(w^C&(I^w))+E[6]+3225465664&4294967295,P=I+(k<<9&4294967295|k>>>23),k=C+(I^w&(P^I))+E[11]+643717713&4294967295,C=P+(k<<14&4294967295|k>>>18),k=w+(P^I&(C^P))+E[0]+3921069994&4294967295,w=C+(k<<20&4294967295|k>>>12),k=I+(C^P&(w^C))+E[5]+3593408605&4294967295,I=w+(k<<5&4294967295|k>>>27),k=P+(w^C&(I^w))+E[10]+38016083&4294967295,P=I+(k<<9&4294967295|k>>>23),k=C+(I^w&(P^I))+E[15]+3634488961&4294967295,C=P+(k<<14&4294967295|k>>>18),k=w+(P^I&(C^P))+E[4]+3889429448&4294967295,w=C+(k<<20&4294967295|k>>>12),k=I+(C^P&(w^C))+E[9]+568446438&4294967295,I=w+(k<<5&4294967295|k>>>27),k=P+(w^C&(I^w))+E[14]+3275163606&4294967295,P=I+(k<<9&4294967295|k>>>23),k=C+(I^w&(P^I))+E[3]+4107603335&4294967295,C=P+(k<<14&4294967295|k>>>18),k=w+(P^I&(C^P))+E[8]+1163531501&4294967295,w=C+(k<<20&4294967295|k>>>12),k=I+(C^P&(w^C))+E[13]+2850285829&4294967295,I=w+(k<<5&4294967295|k>>>27),k=P+(w^C&(I^w))+E[2]+4243563512&4294967295,P=I+(k<<9&4294967295|k>>>23),k=C+(I^w&(P^I))+E[7]+1735328473&4294967295,C=P+(k<<14&4294967295|k>>>18),k=w+(P^I&(C^P))+E[12]+2368359562&4294967295,w=C+(k<<20&4294967295|k>>>12),k=I+(w^C^P)+E[5]+4294588738&4294967295,I=w+(k<<4&4294967295|k>>>28),k=P+(I^w^C)+E[8]+2272392833&4294967295,P=I+(k<<11&4294967295|k>>>21),k=C+(P^I^w)+E[11]+1839030562&4294967295,C=P+(k<<16&4294967295|k>>>16),k=w+(C^P^I)+E[14]+4259657740&4294967295,w=C+(k<<23&4294967295|k>>>9),k=I+(w^C^P)+E[1]+2763975236&4294967295,I=w+(k<<4&4294967295|k>>>28),k=P+(I^w^C)+E[4]+1272893353&4294967295,P=I+(k<<11&4294967295|k>>>21),k=C+(P^I^w)+E[7]+4139469664&4294967295,C=P+(k<<16&4294967295|k>>>16),k=w+(C^P^I)+E[10]+3200236656&4294967295,w=C+(k<<23&4294967295|k>>>9),k=I+(w^C^P)+E[13]+681279174&4294967295,I=w+(k<<4&4294967295|k>>>28),k=P+(I^w^C)+E[0]+3936430074&4294967295,P=I+(k<<11&4294967295|k>>>21),k=C+(P^I^w)+E[3]+3572445317&4294967295,C=P+(k<<16&4294967295|k>>>16),k=w+(C^P^I)+E[6]+76029189&4294967295,w=C+(k<<23&4294967295|k>>>9),k=I+(w^C^P)+E[9]+3654602809&4294967295,I=w+(k<<4&4294967295|k>>>28),k=P+(I^w^C)+E[12]+3873151461&4294967295,P=I+(k<<11&4294967295|k>>>21),k=C+(P^I^w)+E[15]+530742520&4294967295,C=P+(k<<16&4294967295|k>>>16),k=w+(C^P^I)+E[2]+3299628645&4294967295,w=C+(k<<23&4294967295|k>>>9),k=I+(C^(w|~P))+E[0]+4096336452&4294967295,I=w+(k<<6&4294967295|k>>>26),k=P+(w^(I|~C))+E[7]+1126891415&4294967295,P=I+(k<<10&4294967295|k>>>22),k=C+(I^(P|~w))+E[14]+2878612391&4294967295,C=P+(k<<15&4294967295|k>>>17),k=w+(P^(C|~I))+E[5]+4237533241&4294967295,w=C+(k<<21&4294967295|k>>>11),k=I+(C^(w|~P))+E[12]+1700485571&4294967295,I=w+(k<<6&4294967295|k>>>26),k=P+(w^(I|~C))+E[3]+2399980690&4294967295,P=I+(k<<10&4294967295|k>>>22),k=C+(I^(P|~w))+E[10]+4293915773&4294967295,C=P+(k<<15&4294967295|k>>>17),k=w+(P^(C|~I))+E[1]+2240044497&4294967295,w=C+(k<<21&4294967295|k>>>11),k=I+(C^(w|~P))+E[8]+1873313359&4294967295,I=w+(k<<6&4294967295|k>>>26),k=P+(w^(I|~C))+E[15]+4264355552&4294967295,P=I+(k<<10&4294967295|k>>>22),k=C+(I^(P|~w))+E[6]+2734768916&4294967295,C=P+(k<<15&4294967295|k>>>17),k=w+(P^(C|~I))+E[13]+1309151649&4294967295,w=C+(k<<21&4294967295|k>>>11),k=I+(C^(w|~P))+E[4]+4149444226&4294967295,I=w+(k<<6&4294967295|k>>>26),k=P+(w^(I|~C))+E[11]+3174756917&4294967295,P=I+(k<<10&4294967295|k>>>22),k=C+(I^(P|~w))+E[2]+718787259&4294967295,C=P+(k<<15&4294967295|k>>>17),k=w+(P^(C|~I))+E[9]+3951481745&4294967295,S.g[0]=S.g[0]+I&4294967295,S.g[1]=S.g[1]+(C+(k<<21&4294967295|k>>>11))&4294967295,S.g[2]=S.g[2]+C&4294967295,S.g[3]=S.g[3]+P&4294967295}r.prototype.u=function(S,I){I===void 0&&(I=S.length);for(var w=I-this.blockSize,E=this.B,C=this.h,P=0;P<I;){if(C==0)for(;P<=w;)i(this,S,P),P+=this.blockSize;if(typeof S=="string"){for(;P<I;)if(E[C++]=S.charCodeAt(P++),C==this.blockSize){i(this,E),C=0;break}}else for(;P<I;)if(E[C++]=S[P++],C==this.blockSize){i(this,E),C=0;break}}this.h=C,this.o+=I},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var I=1;I<S.length-8;++I)S[I]=0;var w=8*this.o;for(I=S.length-8;I<S.length;++I)S[I]=w&255,w/=256;for(this.u(S),S=Array(16),I=w=0;4>I;++I)for(var E=0;32>E;E+=8)S[w++]=this.g[I]>>>E&255;return S};function s(S,I){var w=a;return Object.prototype.hasOwnProperty.call(w,S)?w[S]:w[S]=I(S)}function o(S,I){this.h=I;for(var w=[],E=!0,C=S.length-1;0<=C;C--){var P=S[C]|0;E&&P==I||(w[C]=P,E=!1)}this.g=w}var a={};function l(S){return-128<=S&&128>S?s(S,function(I){return new o([I|0],0>I?-1:0)}):new o([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return R(c(-S));for(var I=[],w=1,E=0;S>=w;E++)I[E]=S/w|0,w*=4294967296;return new o(I,0)}function d(S,I){if(S.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(S.charAt(0)=="-")return R(d(S.substring(1),I));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=c(Math.pow(I,8)),E=h,C=0;C<S.length;C+=8){var P=Math.min(8,S.length-C),k=parseInt(S.substring(C,C+P),I);8>P?(P=c(Math.pow(I,P)),E=E.j(P).add(c(k))):(E=E.j(w),E=E.add(c(k)))}return E}var h=l(0),f=l(1),m=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-R(this).m();for(var S=0,I=1,w=0;w<this.g.length;w++){var E=this.i(w);S+=(0<=E?E:4294967296+E)*I,I*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(b(this))return"0";if(x(this))return"-"+R(this).toString(S);for(var I=c(Math.pow(S,6)),w=this,E="";;){var C=A(w,I).g;w=y(w,C.j(I));var P=((0<w.g.length?w.g[0]:w.h)>>>0).toString(S);if(w=C,b(w))return P+E;for(;6>P.length;)P="0"+P;E=P+E}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function b(S){if(S.h!=0)return!1;for(var I=0;I<S.g.length;I++)if(S.g[I]!=0)return!1;return!0}function x(S){return S.h==-1}t.l=function(S){return S=y(this,S),x(S)?-1:b(S)?0:1};function R(S){for(var I=S.g.length,w=[],E=0;E<I;E++)w[E]=~S.g[E];return new o(w,~S.h).add(f)}t.abs=function(){return x(this)?R(this):this},t.add=function(S){for(var I=Math.max(this.g.length,S.g.length),w=[],E=0,C=0;C<=I;C++){var P=E+(this.i(C)&65535)+(S.i(C)&65535),k=(P>>>16)+(this.i(C)>>>16)+(S.i(C)>>>16);E=k>>>16,P&=65535,k&=65535,w[C]=k<<16|P}return new o(w,w[w.length-1]&-2147483648?-1:0)};function y(S,I){return S.add(R(I))}t.j=function(S){if(b(this)||b(S))return h;if(x(this))return x(S)?R(this).j(R(S)):R(R(this).j(S));if(x(S))return R(this.j(R(S)));if(0>this.l(m)&&0>S.l(m))return c(this.m()*S.m());for(var I=this.g.length+S.g.length,w=[],E=0;E<2*I;E++)w[E]=0;for(E=0;E<this.g.length;E++)for(var C=0;C<S.g.length;C++){var P=this.i(E)>>>16,k=this.i(E)&65535,N=S.i(C)>>>16,j=S.i(C)&65535;w[2*E+2*C]+=k*j,v(w,2*E+2*C),w[2*E+2*C+1]+=P*j,v(w,2*E+2*C+1),w[2*E+2*C+1]+=k*N,v(w,2*E+2*C+1),w[2*E+2*C+2]+=P*N,v(w,2*E+2*C+2)}for(E=0;E<I;E++)w[E]=w[2*E+1]<<16|w[2*E];for(E=I;E<2*I;E++)w[E]=0;return new o(w,0)};function v(S,I){for(;(S[I]&65535)!=S[I];)S[I+1]+=S[I]>>>16,S[I]&=65535,I++}function T(S,I){this.g=S,this.h=I}function A(S,I){if(b(I))throw Error("division by zero");if(b(S))return new T(h,h);if(x(S))return I=A(R(S),I),new T(R(I.g),R(I.h));if(x(I))return I=A(S,R(I)),new T(R(I.g),I.h);if(30<S.g.length){if(x(S)||x(I))throw Error("slowDivide_ only works with positive integers.");for(var w=f,E=I;0>=E.l(S);)w=O(w),E=O(E);var C=L(w,1),P=L(E,1);for(E=L(E,2),w=L(w,2);!b(E);){var k=P.add(E);0>=k.l(S)&&(C=C.add(w),P=k),E=L(E,1),w=L(w,1)}return I=y(S,C.j(I)),new T(C,I)}for(C=h;0<=S.l(I);){for(w=Math.max(1,Math.floor(S.m()/I.m())),E=Math.ceil(Math.log(w)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),P=c(w),k=P.j(I);x(k)||0<k.l(S);)w-=E,P=c(w),k=P.j(I);b(P)&&(P=f),C=C.add(P),S=y(S,k)}return new T(C,S)}t.A=function(S){return A(this,S).h},t.and=function(S){for(var I=Math.max(this.g.length,S.g.length),w=[],E=0;E<I;E++)w[E]=this.i(E)&S.i(E);return new o(w,this.h&S.h)},t.or=function(S){for(var I=Math.max(this.g.length,S.g.length),w=[],E=0;E<I;E++)w[E]=this.i(E)|S.i(E);return new o(w,this.h|S.h)},t.xor=function(S){for(var I=Math.max(this.g.length,S.g.length),w=[],E=0;E<I;E++)w[E]=this.i(E)^S.i(E);return new o(w,this.h^S.h)};function O(S){for(var I=S.g.length+1,w=[],E=0;E<I;E++)w[E]=S.i(E)<<1|S.i(E-1)>>>31;return new o(w,S.h)}function L(S,I){var w=I>>5;I%=32;for(var E=S.g.length-w,C=[],P=0;P<E;P++)C[P]=0<I?S.i(P+w)>>>I|S.i(P+w+1)<<32-I:S.i(P+w);return new o(C,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,YS=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Gs=o}).apply(typeof xx<"u"?xx:typeof self<"u"?self:typeof window<"u"?window:{});var id=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var XS,Hl,JS,Rd,ug,ZS,e2,t2;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof id=="object"&&id];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=n(this);function i(u,g){if(g)e:{var _=r;u=u.split(".");for(var V=0;V<u.length-1;V++){var H=u[V];if(!(H in _))break e;_=_[H]}u=u[u.length-1],V=_[u],g=g(V),g!=V&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var _=0,V=!1,H={next:function(){if(!V&&_<u.length){var W=_++;return{value:g(W,u[W]),done:!1}}return V=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}i("Array.prototype.values",function(u){return u||function(){return s(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function c(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function d(u,g,_){return u.call.apply(u.bind,arguments)}function h(u,g,_){if(!u)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var H=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(H,V),u.apply(g,H)}}return function(){return u.apply(g,arguments)}}function f(u,g,_){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var V=_.slice();return V.push.apply(V,arguments),u.apply(this,V)}}function b(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(V,H,W){for(var te=Array(arguments.length-2),Ue=2;Ue<arguments.length;Ue++)te[Ue-2]=arguments[Ue];return g.prototype[H].apply(V,te)}}function x(u){const g=u.length;if(0<g){const _=Array(g);for(let V=0;V<g;V++)_[V]=u[V];return _}return[]}function R(u,g){for(let _=1;_<arguments.length;_++){const V=arguments[_];if(l(V)){const H=u.length||0,W=V.length||0;u.length=H+W;for(let te=0;te<W;te++)u[H+te]=V[te]}else u.push(V)}}class y{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function v(u){return/^[\s\xa0]*$/.test(u)}function T(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function A(u){return A[" "](u),u}A[" "]=function(){};var O=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function L(u,g,_){for(const V in u)g.call(_,u[V],V,u)}function S(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function I(u){const g={};for(const _ in u)g[_]=u[_];return g}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(u,g){let _,V;for(let H=1;H<arguments.length;H++){V=arguments[H];for(_ in V)u[_]=V[_];for(let W=0;W<w.length;W++)_=w[W],Object.prototype.hasOwnProperty.call(V,_)&&(u[_]=V[_])}}function C(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function P(u){a.setTimeout(()=>{throw u},0)}function k(){var u=M;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class N{constructor(){this.h=this.g=null}add(g,_){const V=j.get();V.set(g,_),this.h?this.h.next=V:this.g=V,this.h=V}}var j=new y(()=>new z,u=>u.reset());class z{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let B,F=!1,M=new N,U=()=>{const u=a.Promise.resolve(void 0);B=()=>{u.then(G)}};var G=()=>{for(var u;u=k();){try{u.h.call(u.g)}catch(_){P(_)}var g=j;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}F=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var Y=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};a.addEventListener("test",_,g),a.removeEventListener("test",_,g)}catch{}return u}();function ee(u,g){if(X.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,V=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(O){e:{try{A(g.nodeName);var H=!0;break e}catch{}H=!1}H||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ne[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&ee.aa.h.call(this)}}b(ee,X);var ne={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var fe="closure_listenable_"+(1e6*Math.random()|0),ce=0;function xe(u,g,_,V,H){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!V,this.ha=H,this.key=++ce,this.da=this.fa=!1}function ye(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ke(u){this.src=u,this.g={},this.h=0}ke.prototype.add=function(u,g,_,V,H){var W=u.toString();u=this.g[W],u||(u=this.g[W]=[],this.h++);var te=He(u,g,V,H);return-1<te?(g=u[te],_||(g.fa=!1)):(g=new xe(g,this.src,W,!!V,H),g.fa=_,u.push(g)),g};function Re(u,g){var _=g.type;if(_ in u.g){var V=u.g[_],H=Array.prototype.indexOf.call(V,g,void 0),W;(W=0<=H)&&Array.prototype.splice.call(V,H,1),W&&(ye(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function He(u,g,_,V){for(var H=0;H<u.length;++H){var W=u[H];if(!W.da&&W.listener==g&&W.capture==!!_&&W.ha==V)return H}return-1}var Oe="closure_lm_"+(1e6*Math.random()|0),Pe={};function ut(u,g,_,V,H){if(Array.isArray(g)){for(var W=0;W<g.length;W++)ut(u,g[W],_,V,H);return null}return _=pt(_),u&&u[fe]?u.K(g,_,c(V)?!!V.capture:!1,H):Se(u,g,_,!1,V,H)}function Se(u,g,_,V,H,W){if(!g)throw Error("Invalid event type");var te=c(H)?!!H.capture:!!H,Ue=Ut(u);if(Ue||(u[Oe]=Ue=new ke(u)),_=Ue.add(g,_,V,te,W),_.proxy)return _;if(V=se(),_.proxy=V,V.src=u,V.listener=_,u.addEventListener)Y||(H=te),H===void 0&&(H=!1),u.addEventListener(g.toString(),V,H);else if(u.attachEvent)u.attachEvent(xn(g.toString()),V);else if(u.addListener&&u.removeListener)u.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return _}function se(){function u(_){return g.call(u.src,u.listener,_)}const g=dt;return u}function Ce(u,g,_,V,H){if(Array.isArray(g))for(var W=0;W<g.length;W++)Ce(u,g[W],_,V,H);else V=c(V)?!!V.capture:!!V,_=pt(_),u&&u[fe]?(u=u.i,g=String(g).toString(),g in u.g&&(W=u.g[g],_=He(W,_,V,H),-1<_&&(ye(W[_]),Array.prototype.splice.call(W,_,1),W.length==0&&(delete u.g[g],u.h--)))):u&&(u=Ut(u))&&(g=u.g[g.toString()],u=-1,g&&(u=He(g,_,V,H)),(_=-1<u?g[u]:null)&&Tt(_))}function Tt(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[fe])Re(g.i,u);else{var _=u.type,V=u.proxy;g.removeEventListener?g.removeEventListener(_,V,u.capture):g.detachEvent?g.detachEvent(xn(_),V):g.addListener&&g.removeListener&&g.removeListener(V),(_=Ut(g))?(Re(_,u),_.h==0&&(_.src=null,g[Oe]=null)):ye(u)}}}function xn(u){return u in Pe?Pe[u]:Pe[u]="on"+u}function dt(u,g){if(u.da)u=!0;else{g=new ee(g,this);var _=u.listener,V=u.ha||u.src;u.fa&&Tt(u),u=_.call(V,g)}return u}function Ut(u){return u=u[Oe],u instanceof ke?u:null}var Vt="__closure_events_fn_"+(1e9*Math.random()>>>0);function pt(u){return typeof u=="function"?u:(u[Vt]||(u[Vt]=function(g){return u.handleEvent(g)}),u[Vt])}function De(){$.call(this),this.i=new ke(this),this.M=this,this.F=null}b(De,$),De.prototype[fe]=!0,De.prototype.removeEventListener=function(u,g,_,V){Ce(this,u,g,_,V)};function Le(u,g){var _,V=u.F;if(V)for(_=[];V;V=V.F)_.push(V);if(u=u.M,V=g.type||g,typeof g=="string")g=new X(g,u);else if(g instanceof X)g.target=g.target||u;else{var H=g;g=new X(V,u),E(g,H)}if(H=!0,_)for(var W=_.length-1;0<=W;W--){var te=g.g=_[W];H=St(te,V,!0,g)&&H}if(te=g.g=u,H=St(te,V,!0,g)&&H,H=St(te,V,!1,g)&&H,_)for(W=0;W<_.length;W++)te=g.g=_[W],H=St(te,V,!1,g)&&H}De.prototype.N=function(){if(De.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],V=0;V<_.length;V++)ye(_[V]);delete u.g[g],u.h--}}this.F=null},De.prototype.K=function(u,g,_,V){return this.i.add(String(u),g,!1,_,V)},De.prototype.L=function(u,g,_,V){return this.i.add(String(u),g,!0,_,V)};function St(u,g,_,V){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var H=!0,W=0;W<g.length;++W){var te=g[W];if(te&&!te.da&&te.capture==_){var Ue=te.listener,Ot=te.ha||te.src;te.fa&&Re(u.i,te),H=Ue.call(Ot,V)!==!1&&H}}return H&&!V.defaultPrevented}function Yt(u,g,_){if(typeof u=="function")_&&(u=f(u,_));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(u,g||0)}function Xt(u){u.g=Yt(()=>{u.g=null,u.i&&(u.i=!1,Xt(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class st extends ${constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Xt(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _t(u){$.call(this),this.h=u,this.g={}}b(_t,$);var Ye=[];function En(u){L(u.g,function(g,_){this.g.hasOwnProperty(_)&&Tt(g)},u),u.g={}}_t.prototype.N=function(){_t.aa.N.call(this),En(this)},_t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var on=a.JSON.stringify,bn=a.JSON.parse,an=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Jn(){}Jn.prototype.h=null;function wi(u){return u.h||(u.h=u.i())}function vr(){}var Zn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function xi(){X.call(this,"d")}b(xi,X);function In(){X.call(this,"c")}b(In,X);var er={},xo=null;function zr(){return xo=xo||new De}er.La="serverreachability";function Eo(u){X.call(this,er.La,u)}b(Eo,X);function Lr(u){const g=zr();Le(g,new Eo(g))}er.STAT_EVENT="statevent";function bo(u,g){X.call(this,er.STAT_EVENT,u),this.stat=g}b(bo,X);function wt(u){const g=zr();Le(g,new bo(g,u))}er.Ma="timingevent";function tr(u,g){X.call(this,er.Ma,u),this.size=g}b(tr,X);function Mr(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},g)}function jr(){this.g=!0}jr.prototype.xa=function(){this.g=!1};function il(u,g,_,V,H,W){u.info(function(){if(u.g)if(W)for(var te="",Ue=W.split("&"),Ot=0;Ot<Ue.length;Ot++){var Ve=Ue[Ot].split("=");if(1<Ve.length){var Bt=Ve[0];Ve=Ve[1];var Ht=Bt.split("_");te=2<=Ht.length&&Ht[1]=="type"?te+(Bt+"="+Ve+"&"):te+(Bt+"=redacted&")}}else te=null;else te=W;return"XMLHTTP REQ ("+V+") [attempt "+H+"]: "+g+`
`+_+`
`+te})}function sl(u,g,_,V,H,W,te){u.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+H+"]: "+g+`
`+_+`
`+W+" "+te})}function _r(u,g,_,V){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+al(u,_)+(V?" "+V:"")})}function ol(u,g){u.info(function(){return"TIMEOUT: "+g})}jr.prototype.info=function(){};function al(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var V=_[u];if(!(2>V.length)){var H=V[1];if(Array.isArray(H)&&!(1>H.length)){var W=H[0];if(W!="noop"&&W!="stop"&&W!="close")for(var te=1;te<H.length;te++)H[te]=""}}}}return on(_)}catch{return g}}var Ei={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ws={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},xs;function Fr(){}b(Fr,Jn),Fr.prototype.g=function(){return new XMLHttpRequest},Fr.prototype.i=function(){return{}},xs=new Fr;function jn(u,g,_,V){this.j=u,this.i=g,this.l=_,this.R=V||1,this.U=new _t(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Io}function Io(){this.i=null,this.g="",this.h=!1}var bi={},Ii={};function Es(u,g,_){u.L=1,u.v=_u(Hr(g)),u.m=_,u.P=!0,To(u,null)}function To(u,g){u.F=Date.now(),Ur(u),u.A=Hr(u.v);var _=u.A,V=u.R;Array.isArray(V)||(V=[String(V)]),dv(_.i,"t",V),u.C=0,_=u.j.J,u.h=new Io,u.g=kv(u.j,_?g:null,!u.m),0<u.O&&(u.M=new st(f(u.Y,u,u.g),u.O)),g=u.U,_=u.g,V=u.ca;var H="readystatechange";Array.isArray(H)||(H&&(Ye[0]=H.toString()),H=Ye);for(var W=0;W<H.length;W++){var te=ut(_,H[W],V||g.handleEvent,!1,g.h||g);if(!te)break;g.g[te.key]=te}g=u.H?I(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),Lr(),il(u.i,u.u,u.A,u.l,u.R,u.m)}jn.prototype.ca=function(u){u=u.target;const g=this.M;g&&qr(u)==3?g.j():this.Y(u)},jn.prototype.Y=function(u){try{if(u==this.g)e:{const Ht=qr(this.g);var g=this.g.Ba();const ko=this.g.Z();if(!(3>Ht)&&(Ht!=3||this.g&&(this.h.h||this.g.oa()||vv(this.g)))){this.J||Ht!=4||g==7||(g==8||0>=ko?Lr(3):Lr(2)),Ti(this);var _=this.g.Z();this.X=_;t:if($r(this)){var V=vv(this.g);u="";var H=V.length,W=qr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){de(this),_e(this);var te="";break t}this.h.i=new a.TextDecoder}for(g=0;g<H;g++)this.h.h=!0,u+=this.h.i.decode(V[g],{stream:!(W&&g==H-1)});V.length=0,this.h.g+=u,this.C=0,te=this.h.g}else te=this.g.oa();if(this.o=_==200,sl(this.i,this.u,this.A,this.l,this.R,Ht,_),this.o){if(this.T&&!this.K){t:{if(this.g){var Ue,Ot=this.g;if((Ue=Ot.g?Ot.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(Ue)){var Ve=Ue;break t}}Ve=null}if(_=Ve)_r(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,qe(this,_);else{this.o=!1,this.s=3,wt(12),de(this),_e(this);break e}}if(this.P){_=!0;let nr;for(;!this.J&&this.C<te.length;)if(nr=ll(this,te),nr==Ii){Ht==4&&(this.s=4,wt(14),_=!1),_r(this.i,this.l,null,"[Incomplete Response]");break}else if(nr==bi){this.s=4,wt(15),_r(this.i,this.l,te,"[Invalid Chunk]"),_=!1;break}else _r(this.i,this.l,nr,null),qe(this,nr);if($r(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ht!=4||te.length!=0||this.h.h||(this.s=1,wt(16),_=!1),this.o=this.o&&_,!_)_r(this.i,this.l,te,"[Invalid Chunked Response]"),de(this),_e(this);else if(0<te.length&&!this.W){this.W=!0;var Bt=this.j;Bt.g==this&&Bt.ba&&!Bt.M&&(Bt.j.info("Great, no buffering proxy detected. Bytes received: "+te.length),Ff(Bt),Bt.M=!0,wt(11))}}else _r(this.i,this.l,te,null),qe(this,te);Ht==4&&de(this),this.o&&!this.J&&(Ht==4?Tv(this.j,this):(this.o=!1,Ur(this)))}else jA(this.g),_==400&&0<te.indexOf("Unknown SID")?(this.s=3,wt(12)):(this.s=0,wt(13)),de(this),_e(this)}}}catch{}finally{}};function $r(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function ll(u,g){var _=u.C,V=g.indexOf(`
`,_);return V==-1?Ii:(_=Number(g.substring(_,V)),isNaN(_)?bi:(V+=1,V+_>g.length?Ii:(g=g.slice(V,V+_),u.C=V+_,g)))}jn.prototype.cancel=function(){this.J=!0,de(this)};function Ur(u){u.S=Date.now()+u.I,bs(u,u.I)}function bs(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Mr(f(u.ba,u),g)}function Ti(u){u.B&&(a.clearTimeout(u.B),u.B=null)}jn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(ol(this.i,this.A),this.L!=2&&(Lr(),wt(17)),de(this),this.s=2,_e(this)):bs(this,this.S-u)};function _e(u){u.j.G==0||u.J||Tv(u.j,u)}function de(u){Ti(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,En(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function qe(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||So(_.h,u))){if(!u.K&&So(_.h,u)&&_.G==3){try{var V=_.Da.g.parse(g)}catch{V=null}if(Array.isArray(V)&&V.length==3){var H=V;if(H[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Tu(_),bu(_);else break e;jf(_),wt(18)}}else _.za=H[1],0<_.za-_.T&&37500>H[2]&&_.F&&_.v==0&&!_.C&&(_.C=Mr(f(_.Za,_),6e3));if(1>=Br(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Ts(_,11)}else if((u.K||_.g==u)&&Tu(_),!v(g))for(H=_.Da.g.parse(g),g=0;g<H.length;g++){let Ve=H[g];if(_.T=Ve[0],Ve=Ve[1],_.G==2)if(Ve[0]=="c"){_.K=Ve[1],_.ia=Ve[2];const Bt=Ve[3];Bt!=null&&(_.la=Bt,_.j.info("VER="+_.la));const Ht=Ve[4];Ht!=null&&(_.Aa=Ht,_.j.info("SVER="+_.Aa));const ko=Ve[5];ko!=null&&typeof ko=="number"&&0<ko&&(V=1.5*ko,_.L=V,_.j.info("backChannelRequestTimeoutMs_="+V)),V=_;const nr=u.g;if(nr){const Cu=nr.g?nr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Cu){var W=V.h;W.g||Cu.indexOf("spdy")==-1&&Cu.indexOf("quic")==-1&&Cu.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(cl(W,W.h),W.h=null))}if(V.D){const $f=nr.g?nr.g.getResponseHeader("X-HTTP-Session-Id"):null;$f&&(V.ya=$f,Ge(V.I,V.D,$f))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),V=_;var te=u;if(V.qa=Av(V,V.J?V.ia:null,V.W),te.K){rv(V.h,te);var Ue=te,Ot=V.L;Ot&&(Ue.I=Ot),Ue.B&&(Ti(Ue),Ur(Ue)),V.g=te}else bv(V);0<_.i.length&&Iu(_)}else Ve[0]!="stop"&&Ve[0]!="close"||Ts(_,7);else _.G==3&&(Ve[0]=="stop"||Ve[0]=="close"?Ve[0]=="stop"?Ts(_,7):Mf(_):Ve[0]!="noop"&&_.l&&_.l.ta(Ve),_.v=0)}}Lr(4)}catch{}}var ze=class{constructor(u,g){this.g=u,this.map=g}};function ht(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function wr(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Br(u){return u.h?1:u.g?u.g.size:0}function So(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function cl(u,g){u.g?u.g.add(g):u.h=g}function rv(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}ht.prototype.cancel=function(){if(this.i=iv(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function iv(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return x(u.i)}function IA(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var g=[],_=u.length,V=0;V<_;V++)g.push(u[V]);return g}g=[],_=0;for(V in u)g[_++]=u[V];return g}function TA(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const V in u)g[_++]=V;return g}}}function sv(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=TA(u),V=IA(u),H=V.length,W=0;W<H;W++)g.call(void 0,V[W],_&&_[W],u)}var ov=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function SA(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var V=u[_].indexOf("="),H=null;if(0<=V){var W=u[_].substring(0,V);H=u[_].substring(V+1)}else W=u[_];g(W,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Is(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Is){this.h=u.h,yu(this,u.j),this.o=u.o,this.g=u.g,vu(this,u.s),this.l=u.l;var g=u.i,_=new hl;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),av(this,_),this.m=u.m}else u&&(g=String(u).match(ov))?(this.h=!1,yu(this,g[1]||"",!0),this.o=ul(g[2]||""),this.g=ul(g[3]||"",!0),vu(this,g[4]),this.l=ul(g[5]||"",!0),av(this,g[6]||"",!0),this.m=ul(g[7]||"")):(this.h=!1,this.i=new hl(null,this.h))}Is.prototype.toString=function(){var u=[],g=this.j;g&&u.push(dl(g,lv,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(dl(g,lv,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(dl(_,_.charAt(0)=="/"?kA:AA,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",dl(_,PA)),u.join("")};function Hr(u){return new Is(u)}function yu(u,g,_){u.j=_?ul(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function vu(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function av(u,g,_){g instanceof hl?(u.i=g,NA(u.i,u.h)):(_||(g=dl(g,RA)),u.i=new hl(g,u.h))}function Ge(u,g,_){u.i.set(g,_)}function _u(u){return Ge(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ul(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function dl(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,CA),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function CA(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var lv=/[#\/\?@]/g,AA=/[#\?:]/g,kA=/[#\?]/g,RA=/[#\?@]/g,PA=/#/g;function hl(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Si(u){u.g||(u.g=new Map,u.h=0,u.i&&SA(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}t=hl.prototype,t.add=function(u,g){Si(this),this.i=null,u=Co(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function cv(u,g){Si(u),g=Co(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function uv(u,g){return Si(u),g=Co(u,g),u.g.has(g)}t.forEach=function(u,g){Si(this),this.g.forEach(function(_,V){_.forEach(function(H){u.call(g,H,V,this)},this)},this)},t.na=function(){Si(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let V=0;V<g.length;V++){const H=u[V];for(let W=0;W<H.length;W++)_.push(g[V])}return _},t.V=function(u){Si(this);let g=[];if(typeof u=="string")uv(this,u)&&(g=g.concat(this.g.get(Co(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},t.set=function(u,g){return Si(this),this.i=null,u=Co(this,u),uv(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function dv(u,g,_){cv(u,g),0<_.length&&(u.i=null,u.g.set(Co(u,g),x(_)),u.h+=_.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var V=g[_];const W=encodeURIComponent(String(V)),te=this.V(V);for(V=0;V<te.length;V++){var H=W;te[V]!==""&&(H+="="+encodeURIComponent(String(te[V]))),u.push(H)}}return this.i=u.join("&")};function Co(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function NA(u,g){g&&!u.j&&(Si(u),u.i=null,u.g.forEach(function(_,V){var H=V.toLowerCase();V!=H&&(cv(this,V),dv(this,H,_))},u)),u.j=g}function DA(u,g){const _=new jr;if(a.Image){const V=new Image;V.onload=m(Ci,_,"TestLoadImage: loaded",!0,g,V),V.onerror=m(Ci,_,"TestLoadImage: error",!1,g,V),V.onabort=m(Ci,_,"TestLoadImage: abort",!1,g,V),V.ontimeout=m(Ci,_,"TestLoadImage: timeout",!1,g,V),a.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=u}else g(!1)}function VA(u,g){const _=new jr,V=new AbortController,H=setTimeout(()=>{V.abort(),Ci(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:V.signal}).then(W=>{clearTimeout(H),W.ok?Ci(_,"TestPingServer: ok",!0,g):Ci(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(H),Ci(_,"TestPingServer: error",!1,g)})}function Ci(u,g,_,V,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),V(_)}catch{}}function OA(){this.g=new an}function zA(u,g,_){const V=_||"";try{sv(u,function(H,W){let te=H;c(H)&&(te=on(H)),g.push(V+W+"="+encodeURIComponent(te))})}catch(H){throw g.push(V+"type="+encodeURIComponent("_badmap")),H}}function wu(u){this.l=u.Ub||null,this.j=u.eb||!1}b(wu,Jn),wu.prototype.g=function(){return new xu(this.l,this.j)},wu.prototype.i=function(u){return function(){return u}}({});function xu(u,g){De.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(xu,De),t=xu.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,pl(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,fl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,pl(this)),this.g&&(this.readyState=3,pl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;hv(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function hv(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?fl(this):pl(this),this.readyState==3&&hv(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,fl(this))},t.Qa=function(u){this.g&&(this.response=u,fl(this))},t.ga=function(){this.g&&fl(this)};function fl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,pl(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function pl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(xu.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function fv(u){let g="";return L(u,function(_,V){g+=V,g+=":",g+=_,g+=`\r
`}),g}function Lf(u,g,_){e:{for(V in _){var V=!1;break e}V=!0}V||(_=fv(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):Ge(u,g,_))}function ot(u){De.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(ot,De);var LA=/^https?$/i,MA=["POST","PUT"];t=ot.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,_,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():xs.g(),this.v=this.o?wi(this.o):wi(xs),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(W){pv(this,W);return}if(u=_||"",_=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var H in V)_.set(H,V[H]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const W of V.keys())_.set(W,V.get(W));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(_.keys()).find(W=>W.toLowerCase()=="content-type"),H=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(MA,g,void 0))||V||H||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,te]of _)this.g.setRequestHeader(W,te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{yv(this),this.u=!0,this.g.send(u),this.u=!1}catch(W){pv(this,W)}};function pv(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,mv(u),Eu(u)}function mv(u){u.A||(u.A=!0,Le(u,"complete"),Le(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,Le(this,"complete"),Le(this,"abort"),Eu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Eu(this,!0)),ot.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?gv(this):this.bb())},t.bb=function(){gv(this)};function gv(u){if(u.h&&typeof o<"u"&&(!u.v[1]||qr(u)!=4||u.Z()!=2)){if(u.u&&qr(u)==4)Yt(u.Ea,0,u);else if(Le(u,"readystatechange"),qr(u)==4){u.h=!1;try{const te=u.Z();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var V;if(V=te===0){var H=String(u.D).match(ov)[1]||null;!H&&a.self&&a.self.location&&(H=a.self.location.protocol.slice(0,-1)),V=!LA.test(H?H.toLowerCase():"")}_=V}if(_)Le(u,"complete"),Le(u,"success");else{u.m=6;try{var W=2<qr(u)?u.g.statusText:""}catch{W=""}u.l=W+" ["+u.Z()+"]",mv(u)}}finally{Eu(u)}}}}function Eu(u,g){if(u.g){yv(u);const _=u.g,V=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||Le(u,"ready");try{_.onreadystatechange=V}catch{}}}function yv(u){u.I&&(a.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function qr(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<qr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),bn(g)}};function vv(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function jA(u){const g={};u=(u.g&&2<=qr(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<u.length;V++){if(v(u[V]))continue;var _=C(u[V]);const H=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const W=g[H]||[];g[H]=W,W.push(_)}S(g,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ml(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function _v(u){this.Aa=0,this.i=[],this.j=new jr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ml("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ml("baseRetryDelayMs",5e3,u),this.cb=ml("retryDelaySeedMs",1e4,u),this.Wa=ml("forwardChannelMaxRetries",2,u),this.wa=ml("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new ht(u&&u.concurrentRequestLimit),this.Da=new OA,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=_v.prototype,t.la=8,t.G=1,t.connect=function(u,g,_,V){wt(0),this.W=u,this.H=g||{},_&&V!==void 0&&(this.H.OSID=_,this.H.OAID=V),this.F=this.X,this.I=Av(this,null,this.W),Iu(this)};function Mf(u){if(wv(u),u.G==3){var g=u.U++,_=Hr(u.I);if(Ge(_,"SID",u.K),Ge(_,"RID",g),Ge(_,"TYPE","terminate"),gl(u,_),g=new jn(u,u.j,g),g.L=2,g.v=_u(Hr(_)),_=!1,a.navigator&&a.navigator.sendBeacon)try{_=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&a.Image&&(new Image().src=g.v,_=!0),_||(g.g=kv(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Ur(g)}Cv(u)}function bu(u){u.g&&(Ff(u),u.g.cancel(),u.g=null)}function wv(u){bu(u),u.u&&(a.clearTimeout(u.u),u.u=null),Tu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Iu(u){if(!wr(u.h)&&!u.s){u.s=!0;var g=u.Ga;B||U(),F||(B(),F=!0),M.add(g,u),u.B=0}}function FA(u,g){return Br(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Mr(f(u.Ga,u,g),Sv(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const H=new jn(this,this.j,u);let W=this.o;if(this.S&&(W?(W=I(W),E(W,this.S)):W=this.S),this.m!==null||this.O||(H.H=W,W=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var V=this.i[_];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(g+=V,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=Ev(this,H,g),_=Hr(this.I),Ge(_,"RID",u),Ge(_,"CVER",22),this.D&&Ge(_,"X-HTTP-Session-Id",this.D),gl(this,_),W&&(this.O?g="headers="+encodeURIComponent(String(fv(W)))+"&"+g:this.m&&Lf(_,this.m,W)),cl(this.h,H),this.Ua&&Ge(_,"TYPE","init"),this.P?(Ge(_,"$req",g),Ge(_,"SID","null"),H.T=!0,Es(H,_,null)):Es(H,_,g),this.G=2}}else this.G==3&&(u?xv(this,u):this.i.length==0||wr(this.h)||xv(this))};function xv(u,g){var _;g?_=g.l:_=u.U++;const V=Hr(u.I);Ge(V,"SID",u.K),Ge(V,"RID",_),Ge(V,"AID",u.T),gl(u,V),u.m&&u.o&&Lf(V,u.m,u.o),_=new jn(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Ev(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),cl(u.h,_),Es(_,V,g)}function gl(u,g){u.H&&L(u.H,function(_,V){Ge(g,V,_)}),u.l&&sv({},function(_,V){Ge(g,V,_)})}function Ev(u,g,_){_=Math.min(u.i.length,_);var V=u.l?f(u.l.Na,u.l,u):null;e:{var H=u.i;let W=-1;for(;;){const te=["count="+_];W==-1?0<_?(W=H[0].g,te.push("ofs="+W)):W=0:te.push("ofs="+W);let Ue=!0;for(let Ot=0;Ot<_;Ot++){let Ve=H[Ot].g;const Bt=H[Ot].map;if(Ve-=W,0>Ve)W=Math.max(0,H[Ot].g-100),Ue=!1;else try{zA(Bt,te,"req"+Ve+"_")}catch{V&&V(Bt)}}if(Ue){V=te.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,V}function bv(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;B||U(),F||(B(),F=!0),M.add(g,u),u.v=0}}function jf(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Mr(f(u.Fa,u),Sv(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Iv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Mr(f(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,wt(10),bu(this),Iv(this))};function Ff(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Iv(u){u.g=new jn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Hr(u.qa);Ge(g,"RID","rpc"),Ge(g,"SID",u.K),Ge(g,"AID",u.T),Ge(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ge(g,"TO",u.ja),Ge(g,"TYPE","xmlhttp"),gl(u,g),u.m&&u.o&&Lf(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=_u(Hr(g)),_.m=null,_.P=!0,To(_,u)}t.Za=function(){this.C!=null&&(this.C=null,bu(this),jf(this),wt(19))};function Tu(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Tv(u,g){var _=null;if(u.g==g){Tu(u),Ff(u),u.g=null;var V=2}else if(So(u.h,g))_=g.D,rv(u.h,g),V=1;else return;if(u.G!=0){if(g.o)if(V==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var H=u.B;V=zr(),Le(V,new tr(V,_)),Iu(u)}else bv(u);else if(H=g.s,H==3||H==0&&0<g.X||!(V==1&&FA(u,g)||V==2&&jf(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),H){case 1:Ts(u,5);break;case 4:Ts(u,10);break;case 3:Ts(u,6);break;default:Ts(u,2)}}}function Sv(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Ts(u,g){if(u.j.info("Error code "+g),g==2){var _=f(u.fb,u),V=u.Xa;const H=!V;V=new Is(V||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||yu(V,"https"),_u(V),H?DA(V.toString(),_):VA(V.toString(),_)}else wt(2);u.G=0,u.l&&u.l.sa(g),Cv(u),wv(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),wt(2)):(this.j.info("Failed to ping google.com"),wt(1))};function Cv(u){if(u.G=0,u.ka=[],u.l){const g=iv(u.h);(g.length!=0||u.i.length!=0)&&(R(u.ka,g),R(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function Av(u,g,_){var V=_ instanceof Is?Hr(_):new Is(_);if(V.g!="")g&&(V.g=g+"."+V.g),vu(V,V.s);else{var H=a.location;V=H.protocol,g=g?g+"."+H.hostname:H.hostname,H=+H.port;var W=new Is(null);V&&yu(W,V),g&&(W.g=g),H&&vu(W,H),_&&(W.l=_),V=W}return _=u.D,g=u.ya,_&&g&&Ge(V,_,g),Ge(V,"VER",u.la),gl(u,V),V}function kv(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new ot(new wu({eb:_})):new ot(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Rv(){}t=Rv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Su(){}Su.prototype.g=function(u,g){return new Tn(u,g)};function Tn(u,g){De.call(this),this.g=new _v(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!v(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!v(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Ao(this)}b(Tn,De),Tn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Tn.prototype.close=function(){Mf(this.g)},Tn.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=on(u),u=_);g.i.push(new ze(g.Ya++,u)),g.G==3&&Iu(g)},Tn.prototype.N=function(){this.g.l=null,delete this.j,Mf(this.g),delete this.g,Tn.aa.N.call(this)};function Pv(u){xi.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}b(Pv,xi);function Nv(){In.call(this),this.status=1}b(Nv,In);function Ao(u){this.g=u}b(Ao,Rv),Ao.prototype.ua=function(){Le(this.g,"a")},Ao.prototype.ta=function(u){Le(this.g,new Pv(u))},Ao.prototype.sa=function(u){Le(this.g,new Nv)},Ao.prototype.ra=function(){Le(this.g,"b")},Su.prototype.createWebChannel=Su.prototype.g,Tn.prototype.send=Tn.prototype.o,Tn.prototype.open=Tn.prototype.m,Tn.prototype.close=Tn.prototype.close,t2=function(){return new Su},e2=function(){return zr()},ZS=er,ug={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ei.NO_ERROR=0,Ei.TIMEOUT=8,Ei.HTTP_ERROR=6,Rd=Ei,ws.COMPLETE="complete",JS=ws,vr.EventType=Zn,Zn.OPEN="a",Zn.CLOSE="b",Zn.ERROR="c",Zn.MESSAGE="d",De.prototype.listen=De.prototype.K,Hl=vr,ot.prototype.listenOnce=ot.prototype.L,ot.prototype.getLastError=ot.prototype.Ka,ot.prototype.getLastErrorCode=ot.prototype.Ba,ot.prototype.getStatus=ot.prototype.Z,ot.prototype.getResponseJson=ot.prototype.Oa,ot.prototype.getResponseText=ot.prototype.oa,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Ha,XS=ot}).apply(typeof id<"u"?id:typeof self<"u"?self:typeof window<"u"?window:{});const Ex="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Mt.UNAUTHENTICATED=new Mt(null),Mt.GOOGLE_CREDENTIALS=new Mt("google-credentials-uid"),Mt.FIRST_PARTY=new Mt("first-party-uid"),Mt.MOCK_USER=new Mt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ja="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const io=new mf("@firebase/firestore");function Uo(){return io.logLevel}function J(t,...e){if(io.logLevel<=Ie.DEBUG){const n=e.map(fy);io.debug(`Firestore (${Ja}): ${t}`,...n)}}function Zt(t,...e){if(io.logLevel<=Ie.ERROR){const n=e.map(fy);io.error(`Firestore (${Ja}): ${t}`,...n)}}function so(t,...e){if(io.logLevel<=Ie.WARN){const n=e.map(fy);io.warn(`Firestore (${Ja}): ${t}`,...n)}}function fy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t="Unexpected state"){const e=`FIRESTORE (${Ja}) INTERNAL ASSERTION FAILED: `+t;throw Zt(e),new Error(e)}function he(t,e){t||ue()}function ge(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends yr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class n9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Mt.UNAUTHENTICATED))}shutdown(){}}class r9{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class i9{constructor(e){this.t=e,this.currentUser=Mt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){he(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Rr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Rr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Rr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(he(typeof r.accessToken=="string"),new n2(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string"),new Mt(e)}}class s9{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Mt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class o9{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new s9(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Mt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class a9{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class l9{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){he(this.o===void 0);const r=s=>{s.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,J("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string"),this.R=n.token,new a9(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c9(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=c9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function ve(t,e){return t<e?-1:t>e?1:0}function Na(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function i2(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new re(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return rt.fromMillis(Date.now())}static fromDate(e){return rt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new rt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ve(this.nanoseconds,e.nanoseconds):ve(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pe(e)}static min(){return new pe(new rt(0,0))}static max(){return new pe(new rt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(e,n,r){n===void 0?n=0:n>e.length&&ue(),r===void 0?r=e.length-n:r>e.length-n&&ue(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Uc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Uc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Me extends Uc{construct(e,n,r){return new Me(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(Q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new Me(n)}static emptyPath(){return new Me([])}}const u9=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class tt extends Uc{construct(e,n,r){return new tt(e,n,r)}static isValidIdentifier(e){return u9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),tt.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new tt(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new tt(n)}static emptyPath(){return new tt([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie(Me.fromString(e))}static fromName(e){return new ie(Me.fromString(e).popFirst(5))}static empty(){return new ie(Me.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Me.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Me.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new Me(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function dg(t){return t.fields.find(e=>e.kind===2)}function Ps(t){return t.fields.filter(e=>e.kind!==2)}Ah.UNKNOWN_ID=-1;class Pd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Bc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Bc(0,zn.min())}}function d9(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=pe.fromTimestamp(r===1e9?new rt(n+1,0):new rt(n,r));return new zn(i,ie.empty(),e)}function s2(t){return new zn(t.readTime,t.key,-1)}class zn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new zn(pe.min(),ie.empty(),-1)}static max(){return new zn(pe.max(),ie.empty(),-1)}}function py(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:ve(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class a2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _o(t){if(t.code!==Q.FAILED_PRECONDITION||t.message!==o2)throw t;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ue(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(i=>i?q.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new q((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(d=>{o[c]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new q((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _f{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Rr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new oc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=my(r.target.error);this.V.reject(new oc(e,i))}}static open(e,n,r,i){try{return new _f(n,e.transaction(i,r))}catch(s){throw new oc(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(J("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new f9(n)}}class ss{constructor(e,n,r){this.name=e,this.version=n,this.p=r,ss.S(bt())===12.2&&Zt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return J("SimpleDb","Removing database:",e),Ns(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!Z0())return!1;if(ss.v())return!0;const e=bt(),n=ss.S(e),r=0<n&&n<10,i=l2(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(J("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new oc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new oc(e,o))},i.onupgradeneeded=s=>{J("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{J("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=_f.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),q.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(J("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function l2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class h9{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ns(this.B.delete())}}class oc extends re{constructor(e,n){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ys(t){return t.name==="IndexedDbTransactionError"}class f9{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(J("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(J("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ns(r)}add(e){return J("SimpleDb","ADD",this.store.name,e,e),Ns(this.store.add(e))}get(e){return Ns(this.store.get(e)).next(n=>(n===void 0&&(n=null),J("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return J("SimpleDb","DELETE",this.store.name,e),Ns(this.store.delete(e))}count(){return J("SimpleDb","COUNT",this.store.name),Ns(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new q((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new q((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){J("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new q((r,i)=>{n.onerror=s=>{const o=my(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new q((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new h9(a),c=n(a.primaryKey,a.value,l);if(c instanceof q){const d=c.catch(h=>(l.done(),q.reject(h)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>q.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ns(t){return new q((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=my(r.target.error);n(i)}})}let bx=!1;function my(t){const e=ss.S(bt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return bx||(bx=!0,setTimeout(()=>{throw r},0)),r}}return t}class p9{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){J("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{J("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){ys(n)?J("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await _o(n)}await this.X(6e4)})}}class m9{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return q.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return J("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(J("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=s2(s);py(o,r)>0&&(r=o)}),new zn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Hn.oe=-1;function wf(t){return t==null}function Hc(t){return t===0&&1/t==-1/0}function g9(t){return typeof t=="number"&&Number.isInteger(t)&&!Hc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Ix(e)),e=y9(t.get(n),e);return Ix(e)}function y9(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function Ix(t){return t+""}function Ir(t){const e=t.length;if(he(e>=2),e===2)return he(t.charAt(0)===""&&t.charAt(1)===""),Me.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&ue(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:ue()}s=o+2}return new Me(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tx=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nd(t,e){return[t,tn(e)]}function c2(t,e,n){return[t,tn(e),n]}const v9={},_9=["prefixPath","collectionGroup","readTime","documentId"],w9=["prefixPath","collectionGroup","documentId"],x9=["collectionGroup","readTime","prefixPath","documentId"],E9=["canonicalId","targetId"],b9=["targetId","path"],I9=["path","targetId"],T9=["collectionId","parent"],S9=["indexId","uid"],C9=["uid","sequenceNumber"],A9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],k9=["indexId","uid","orderedDocumentKey"],R9=["userId","collectionPath","documentId"],P9=["userId","collectionPath","largestBatchId"],N9=["userId","collectionGroup","largestBatchId"],u2=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],D9=[...u2,"documentOverlays"],d2=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],h2=d2,gy=[...h2,"indexConfiguration","indexState","indexEntries"],V9=gy,O9=[...gy,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg extends a2{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function It(t,e){const n=ge(t);return ss.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sx(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Za(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function f2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ze{constructor(e,n){this.comparator=e,this.root=n||jt.EMPTY}insert(e,n){return new Ze(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,jt.BLACK,null,null))}remove(e){return new Ze(this.comparator,this.root.remove(e,this.comparator).copy(null,null,jt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new sd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new sd(this.root,e,this.comparator,!1)}getReverseIterator(){return new sd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new sd(this.root,e,this.comparator,!0)}}class sd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class jt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??jt.RED,this.left=i??jt.EMPTY,this.right=s??jt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new jt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return jt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return jt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,jt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,jt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ue();const e=this.left.check();if(e!==this.right.check())throw ue();return e+(this.isRed()?0:1)}}jt.EMPTY=null,jt.RED=!0,jt.BLACK=!1;jt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue()}get value(){throw ue()}get color(){throw ue()}get left(){throw ue()}get right(){throw ue()}copy(e,n,r,i,s){return this}insert(e,n,r){return new jt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.comparator=e,this.data=new Ze(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Cx(this.data.getIterator())}getIteratorFrom(e){return new Cx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof $e)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new $e(this.comparator);return n.data=e,n}}class Cx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Mo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qn{constructor(e){this.fields=e,e.sort(tt.comparator)}static empty(){return new qn([])}unionWith(e){let n=new $e(tt.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new qn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Na(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new p2("Invalid base64 string: "+s):s}}(e);return new yt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new yt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ve(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}yt.EMPTY_BYTE_STRING=new yt("");const z9=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function mi(t){if(he(!!t),typeof t=="string"){let e=0;const n=z9.exec(t);if(he(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Xe(t.seconds),nanos:Xe(t.nanos)}}function Xe(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function us(t){return typeof t=="string"?yt.fromBase64String(t):yt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function vy(t){const e=t.mapValue.fields.__previous_value__;return yy(e)?vy(e):e}function qc(t){const e=mi(t.mapValue.fields.__local_write_time__.timestampValue);return new rt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L9{constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class oo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new oo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof oo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ki={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},Dd={nullValue:"NULL_VALUE"};function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yy(t)?4:m2(t)?9007199254740991:xf(t)?10:11:ue()}function Nr(t,e){if(t===e)return!0;const n=ao(t);if(n!==ao(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return qc(t).isEqual(qc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=mi(i.timestampValue),a=mi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return us(i.bytesValue).isEqual(us(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return Xe(i.geoPointValue.latitude)===Xe(s.geoPointValue.latitude)&&Xe(i.geoPointValue.longitude)===Xe(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Xe(i.integerValue)===Xe(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Xe(i.doubleValue),a=Xe(s.doubleValue);return o===a?Hc(o)===Hc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Na(t.arrayValue.values||[],e.arrayValue.values||[],Nr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Sx(o)!==Sx(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Nr(o[l],a[l])))return!1;return!0}(t,e);default:return ue()}}function Kc(t,e){return(t.values||[]).find(n=>Nr(n,e))!==void 0}function ds(t,e){if(t===e)return 0;const n=ao(t),r=ao(e);if(n!==r)return ve(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ve(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Xe(s.integerValue||s.doubleValue),l=Xe(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return Ax(t.timestampValue,e.timestampValue);case 4:return Ax(qc(t),qc(e));case 5:return ve(t.stringValue,e.stringValue);case 6:return function(s,o){const a=us(s),l=us(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=ve(a[c],l[c]);if(d!==0)return d}return ve(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ve(Xe(s.latitude),Xe(o.latitude));return a!==0?a:ve(Xe(s.longitude),Xe(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return kx(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,d;const h=s.fields||{},f=o.fields||{},m=(a=h.value)===null||a===void 0?void 0:a.arrayValue,b=(l=f.value)===null||l===void 0?void 0:l.arrayValue,x=ve(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((d=b==null?void 0:b.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:kx(m,b)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ki.mapValue&&o===Ki.mapValue)return 0;if(s===Ki.mapValue)return 1;if(o===Ki.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const f=ve(l[h],d[h]);if(f!==0)return f;const m=ds(a[l[h]],c[d[h]]);if(m!==0)return m}return ve(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ue()}}function Ax(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ve(t,e);const n=mi(t),r=mi(e),i=ve(n.seconds,r.seconds);return i!==0?i:ve(n.nanos,r.nanos)}function kx(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ds(n[i],r[i]);if(s)return s}return ve(n.length,r.length)}function Da(t){return fg(t)}function fg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=mi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return us(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=fg(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${fg(n.fields[o])}`;return i+"}"}(t.mapValue):ue()}function Gc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function pg(t){return!!t&&"integerValue"in t}function Wc(t){return!!t&&"arrayValue"in t}function Rx(t){return!!t&&"nullValue"in t}function Px(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vd(t){return!!t&&"mapValue"in t}function xf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function ac(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Za(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ac(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ac(t.arrayValue.values[n]);return e}return Object.assign({},t)}function m2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const g2={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function M9(t){return"nullValue"in t?Dd:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Gc(oo.empty(),ie.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?xf(t)?g2:{mapValue:{}}:ue()}function j9(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Gc(oo.empty(),ie.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?g2:"mapValue"in t?xf(t)?{mapValue:{}}:Ki:ue()}function Nx(t,e){const n=ds(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Dx(t,e){const n=ds(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.value=e}static empty(){return new un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Vd(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ac(n)}setAll(e){let n=tt.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=ac(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Vd(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Nr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Vd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){Za(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new un(ac(this.value))}}function y2(t){const e=[];return Za(t.fields,(n,r)=>{const i=new tt([n]);if(Vd(r)){const s=y2(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new qn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new lt(e,0,pe.min(),pe.min(),pe.min(),un.empty(),0)}static newFoundDocument(e,n,r,i){return new lt(e,1,n,pe.min(),r,i,0)}static newNoDocument(e,n){return new lt(e,2,n,pe.min(),pe.min(),un.empty(),0)}static newUnknownDocument(e,n){return new lt(e,3,n,pe.min(),pe.min(),un.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof lt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new lt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,n){this.position=e,this.inclusive=n}}function Vx(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ie.comparator(ie.fromName(o.referenceValue),n.key):r=ds(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ox(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Nr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kh{constructor(e,n="asc"){this.field=e,this.dir=n}}function F9(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v2{}class Te extends v2{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new $9(e,n,r):n==="array-contains"?new H9(e,r):n==="in"?new I2(e,r):n==="not-in"?new q9(e,r):n==="array-contains-any"?new K9(e,r):new Te(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new U9(e,r):new B9(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ds(n,this.value)):n!==null&&ao(this.value)===ao(n)&&this.matchesComparison(ds(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class je extends v2{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new je(e,n)}matches(e){return Oa(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Oa(t){return t.op==="and"}function mg(t){return t.op==="or"}function _y(t){return _2(t)&&Oa(t)}function _2(t){for(const e of t.filters)if(e instanceof je)return!1;return!0}function gg(t){if(t instanceof Te)return t.field.canonicalString()+t.op.toString()+Da(t.value);if(_y(t))return t.filters.map(e=>gg(e)).join(",");{const e=t.filters.map(n=>gg(n)).join(",");return`${t.op}(${e})`}}function w2(t,e){return t instanceof Te?function(r,i){return i instanceof Te&&r.op===i.op&&r.field.isEqual(i.field)&&Nr(r.value,i.value)}(t,e):t instanceof je?function(r,i){return i instanceof je&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&w2(o,i.filters[a]),!0):!1}(t,e):void ue()}function x2(t,e){const n=t.filters.concat(e);return je.create(n,t.op)}function E2(t){return t instanceof Te?function(n){return`${n.field.canonicalString()} ${n.op} ${Da(n.value)}`}(t):t instanceof je?function(n){return n.op.toString()+" {"+n.getFilters().map(E2).join(" ,")+"}"}(t):"Filter"}class $9 extends Te{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class U9 extends Te{constructor(e,n){super(e,"in",n),this.keys=b2("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class B9 extends Te{constructor(e,n){super(e,"not-in",n),this.keys=b2("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function b2(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class H9 extends Te{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Wc(n)&&Kc(n.arrayValue,this.value)}}class I2 extends Te{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Kc(this.value.arrayValue,n)}}class q9 extends Te{constructor(e,n){super(e,"not-in",n)}matches(e){if(Kc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Kc(this.value.arrayValue,n)}}class K9 extends Te{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Wc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Kc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G9{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function yg(t,e=null,n=[],r=[],i=null,s=null,o=null){return new G9(t,e,n,r,i,s,o)}function lo(t){const e=ge(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>gg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),wf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Da(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Da(r)).join(",")),e.ue=n}return e.ue}function uu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!F9(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!w2(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ox(t.startAt,e.startAt)&&Ox(t.endAt,e.endAt)}function Rh(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Ph(t,e){return t.filters.filter(n=>n instanceof Te&&n.field.isEqual(e))}function zx(t,e,n){let r=Dd,i=!0;for(const s of Ph(t,e)){let o=Dd,a=!0;switch(s.op){case"<":case"<=":o=M9(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=Dd}Nx({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Nx({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function Lx(t,e,n){let r=Ki,i=!0;for(const s of Ph(t,e)){let o=Ki,a=!0;switch(s.op){case">=":case">":o=j9(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Ki}Dx({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Dx({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function W9(t,e,n,r,i,s,o,a){return new du(t,e,n,r,i,s,o,a)}function Ef(t){return new du(t)}function Mx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function T2(t){return t.collectionGroup!==null}function lc(t){const e=ge(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new $e(tt.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new kh(s,r))}),n.has(tt.keyField().canonicalString())||e.ce.push(new kh(tt.keyField(),r))}return e.ce}function Wn(t){const e=ge(t);return e.le||(e.le=Q9(e,lc(t))),e.le}function Q9(t,e){if(t.limitType==="F")return yg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new kh(i.field,s)});const n=t.endAt?new Va(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Va(t.startAt.position,t.startAt.inclusive):null;return yg(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function vg(t,e){const n=t.filters.concat([e]);return new du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function _g(t,e,n){return new du(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function bf(t,e){return uu(Wn(t),Wn(e))&&t.limitType===e.limitType}function S2(t){return`${lo(Wn(t))}|lt:${t.limitType}`}function Bo(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>E2(i)).join(", ")}]`),wf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Da(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Da(i)).join(",")),`Target(${r})`}(Wn(t))}; limitType=${t.limitType})`}function hu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ie.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of lc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=Vx(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,lc(r),i)||r.endAt&&!function(o,a,l){const c=Vx(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,lc(r),i))}(t,e)}function Y9(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function C2(t){return(e,n)=>{let r=!1;for(const i of lc(t)){const s=X9(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function X9(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ds(l,c):ue()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ue()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Za(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return f2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J9=new Ze(ie.comparator);function Pn(){return J9}const A2=new Ze(ie.comparator);function ql(...t){let e=A2;for(const n of t)e=e.insert(n.key,n);return e}function k2(t){let e=A2;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Tr(){return cc()}function R2(){return cc()}function cc(){return new vs(t=>t.toString(),(t,e)=>t.isEqual(e))}const Z9=new Ze(ie.comparator),eF=new $e(ie.comparator);function we(...t){let e=eF;for(const n of t)e=e.add(n);return e}const tF=new $e(ve);function nF(){return tF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Hc(e)?"-0":e}}function P2(t){return{integerValue:""+t}}function rF(t,e){return g9(e)?P2(e):wy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class If{constructor(){this._=void 0}}function iF(t,e,n){return t instanceof za?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&yy(s)&&(s=vy(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof La?D2(t,e):t instanceof Ma?V2(t,e):function(i,s){const o=N2(i,s),a=jx(o)+jx(i.Pe);return pg(o)&&pg(i.Pe)?P2(a):wy(i.serializer,a)}(t,e)}function sF(t,e,n){return t instanceof La?D2(t,e):t instanceof Ma?V2(t,e):n}function N2(t,e){return t instanceof Qc?function(r){return pg(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class za extends If{}class La extends If{constructor(e){super(),this.elements=e}}function D2(t,e){const n=O2(e);for(const r of t.elements)n.some(i=>Nr(i,r))||n.push(r);return{arrayValue:{values:n}}}class Ma extends If{constructor(e){super(),this.elements=e}}function V2(t,e){let n=O2(e);for(const r of t.elements)n=n.filter(i=>!Nr(i,r));return{arrayValue:{values:n}}}class Qc extends If{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function jx(t){return Xe(t.integerValue||t.doubleValue)}function O2(t){return Wc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{constructor(e,n){this.field=e,this.transform=n}}function oF(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof La&&i instanceof La||r instanceof Ma&&i instanceof Ma?Na(r.elements,i.elements,Nr):r instanceof Qc&&i instanceof Qc?Nr(r.Pe,i.Pe):r instanceof za&&i instanceof za}(t.transform,e.transform)}class aF{constructor(e,n){this.version=e,this.transformResults=n}}class fn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new fn}static exists(e){return new fn(void 0,e)}static updateTime(e){return new fn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Od(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Tf{}function L2(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Sf(t.key,fn.none()):new el(t.key,t.data,fn.none());{const n=t.data,r=un.empty();let i=new $e(tt.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new _s(t.key,r,new qn(i.toArray()),fn.none())}}function lF(t,e,n){t instanceof el?function(i,s,o){const a=i.value.clone(),l=$x(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof _s?function(i,s,o){if(!Od(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=$x(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(M2(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function uc(t,e,n,r){return t instanceof el?function(s,o,a,l){if(!Od(s.precondition,o))return a;const c=s.value.clone(),d=Ux(s.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof _s?function(s,o,a,l){if(!Od(s.precondition,o))return a;const c=Ux(s.fieldTransforms,l,o),d=o.data;return d.setAll(M2(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return Od(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function cF(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=N2(r.transform,i||null);s!=null&&(n===null&&(n=un.empty()),n.set(r.field,s))}return n||null}function Fx(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Na(r,i,(s,o)=>oF(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class el extends Tf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class _s extends Tf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function M2(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function $x(t,e,n){const r=new Map;he(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,sF(o,a,n[i]))}return r}function Ux(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,iF(s,o,e))}return r}class Sf extends Tf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class j2 extends Tf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xy{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&lF(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=uc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=uc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=R2();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=L2(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),we())}isEqual(e){return this.batchId===e.batchId&&Na(this.mutations,e.mutations,(n,r)=>Fx(n,r))&&Na(this.baseMutations,e.baseMutations,(n,r)=>Fx(n,r))}}class Ey{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){he(e.mutations.length===r.length);let i=function(){return Z9}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Ey(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class by{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uF{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt,Ae;function dF(t){switch(t){default:return ue();case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0}}function F2(t){if(t===void 0)return Zt("GRPC error has no .code"),Q.UNKNOWN;switch(t){case mt.OK:return Q.OK;case mt.CANCELLED:return Q.CANCELLED;case mt.UNKNOWN:return Q.UNKNOWN;case mt.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case mt.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case mt.INTERNAL:return Q.INTERNAL;case mt.UNAVAILABLE:return Q.UNAVAILABLE;case mt.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case mt.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case mt.NOT_FOUND:return Q.NOT_FOUND;case mt.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case mt.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case mt.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case mt.ABORTED:return Q.ABORTED;case mt.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case mt.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case mt.DATA_LOSS:return Q.DATA_LOSS;default:return ue()}}(Ae=mt||(mt={}))[Ae.OK=0]="OK",Ae[Ae.CANCELLED=1]="CANCELLED",Ae[Ae.UNKNOWN=2]="UNKNOWN",Ae[Ae.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ae[Ae.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ae[Ae.NOT_FOUND=5]="NOT_FOUND",Ae[Ae.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ae[Ae.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ae[Ae.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ae[Ae.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ae[Ae.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ae[Ae.ABORTED=10]="ABORTED",Ae[Ae.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ae[Ae.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ae[Ae.INTERNAL=13]="INTERNAL",Ae[Ae.UNAVAILABLE=14]="UNAVAILABLE",Ae[Ae.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fF=new Gs([4294967295,4294967295],0);function Bx(t){const e=hF().encode(t),n=new YS;return n.update(e),new Uint8Array(n.digest())}function Hx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Gs([n,r],0),new Gs([i,s],0)]}class Iy{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Kl(`Invalid padding: ${n}`);if(r<0)throw new Kl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Kl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Kl(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Gs.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Gs.fromNumber(r)));return i.compare(fF)===1&&(i=new Gs([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Bx(e),[r,i]=Hx(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Iy(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=Bx(e),[r,i]=Hx(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Kl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cf{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,fu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Cf(pe.min(),i,new Ze(ve),Pn(),we())}}class fu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new fu(r,n,we(),we(),we())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zd{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class $2{constructor(e,n){this.targetId=e,this.me=n}}class U2{constructor(e,n,r=yt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class qx{constructor(){this.fe=0,this.ge=Gx(),this.pe=yt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=we(),n=we(),r=we();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ue()}}),new fu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=Gx()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,he(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class pF{constructor(e){this.Le=e,this.Be=new Map,this.ke=Pn(),this.qe=Kx(),this.Qe=new Ze(ve)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ue()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Rh(s))if(r===0){const o=new ie(s.path);this.Ue(n,o,lt.newNoDocument(o,pe.min()))}else he(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=us(r).toUint8Array()}catch(l){if(l instanceof p2)return so("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Iy(o,i,s)}catch(l){return so(l instanceof Kl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&Rh(a.target)){const l=new ie(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,lt.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=we();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Cf(e,n,this.Qe,this.ke,r);return this.ke=Pn(),this.qe=Kx(),this.Qe=new Ze(ve),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new qx,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new $e(ve),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||J("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new qx),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Kx(){return new Ze(ie.comparator)}function Gx(){return new Ze(ie.comparator)}const mF={asc:"ASCENDING",desc:"DESCENDING"},gF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},yF={and:"AND",or:"OR"};class vF{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function wg(t,e){return t.useProto3Json||wf(e)?e:{value:e}}function ja(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function B2(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function _F(t,e){return ja(t,e.toTimestamp())}function nn(t){return he(!!t),pe.fromTimestamp(function(n){const r=mi(n);return new rt(r.seconds,r.nanos)}(t))}function Ty(t,e){return xg(t,e).canonicalString()}function xg(t,e){const n=function(i){return new Me(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function H2(t){const e=Me.fromString(t);return he(Z2(e)),e}function Nh(t,e){return Ty(t.databaseId,e.path)}function Ws(t,e){const n=H2(e);if(n.get(1)!==t.databaseId.projectId)throw new re(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(G2(n))}function q2(t,e){return Ty(t.databaseId,e)}function K2(t){const e=H2(t);return e.length===4?Me.emptyPath():G2(e)}function Eg(t){return new Me(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function G2(t){return he(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Wx(t,e,n){return{name:Nh(t,e),fields:n.value.mapValue.fields}}function wF(t,e,n){const r=Ws(t,e.name),i=nn(e.updateTime),s=e.createTime?nn(e.createTime):pe.min(),o=new un({mapValue:{fields:e.fields}}),a=lt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function xF(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ue()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(he(d===void 0||typeof d=="string"),yt.fromBase64String(d||"")):(he(d===void 0||d instanceof Buffer||d instanceof Uint8Array),yt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?Q.UNKNOWN:F2(c.code);return new re(d,c.message||"")}(o);n=new U2(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ws(t,r.document.name),s=nn(r.document.updateTime),o=r.document.createTime?nn(r.document.createTime):pe.min(),a=new un({mapValue:{fields:r.document.fields}}),l=lt.newFoundDocument(i,s,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new zd(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Ws(t,r.document),s=r.readTime?nn(r.readTime):pe.min(),o=lt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new zd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Ws(t,r.document),s=r.removedTargetIds||[];n=new zd([],s,i,null)}else{if(!("filter"in e))return ue();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new uF(i,s),a=r.targetId;n=new $2(a,o)}}return n}function Dh(t,e){let n;if(e instanceof el)n={update:Wx(t,e.key,e.value)};else if(e instanceof Sf)n={delete:Nh(t,e.key)};else if(e instanceof _s)n={update:Wx(t,e.key,e.data),updateMask:CF(e.fieldMask)};else{if(!(e instanceof j2))return ue();n={verify:Nh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof za)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof La)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ma)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof Qc)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ue()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:_F(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ue()}(t,e.precondition)),n}function bg(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?fn.updateTime(nn(s.updateTime)):s.exists!==void 0?fn.exists(s.exists):fn.none()}(e.currentDocument):fn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)he(a.setToServerValue==="REQUEST_TIME"),l=new za;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new La(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new Ma(d)}else"increment"in a?l=new Qc(o,a.increment):ue();const c=tt.fromServerFormat(a.fieldPath);return new z2(c,l)}(t,i)):[];if(e.update){e.update.name;const i=Ws(t,e.update.name),s=new un({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new qn(c.map(d=>tt.fromServerFormat(d)))}(e.updateMask);return new _s(i,s,o,n,r)}return new el(i,s,n,r)}if(e.delete){const i=Ws(t,e.delete);return new Sf(i,n)}if(e.verify){const i=Ws(t,e.verify);return new j2(i,n)}return ue()}function EF(t,e){return t&&t.length>0?(he(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?nn(i.updateTime):nn(s);return o.isEqual(pe.min())&&(o=nn(s)),new aF(o,i.transformResults||[])}(n,e))):[]}function W2(t,e){return{documents:[q2(t,e.path)]}}function Q2(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=q2(t,i);const s=function(c){if(c.length!==0)return J2(je.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(f){return{field:Ho(f.field),direction:IF(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=wg(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function Y2(t){let e=K2(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){he(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(h){const f=X2(h);return f instanceof je&&_y(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(b){return new kh(qo(b.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,wf(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(h){const f=!!h.before,m=h.values||[];return new Va(m,f)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const f=!h.before,m=h.values||[];return new Va(m,f)}(n.endAt)),W9(e,i,o,s,a,"F",l,c)}function bF(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function X2(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=qo(n.unaryFilter.field);return Te.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=qo(n.unaryFilter.field);return Te.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=qo(n.unaryFilter.field);return Te.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=qo(n.unaryFilter.field);return Te.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ue()}}(t):t.fieldFilter!==void 0?function(n){return Te.create(qo(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ue()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return je.create(n.compositeFilter.filters.map(r=>X2(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue()}}(n.compositeFilter.op))}(t):ue()}function IF(t){return mF[t]}function TF(t){return gF[t]}function SF(t){return yF[t]}function Ho(t){return{fieldPath:t.canonicalString()}}function qo(t){return tt.fromServerFormat(t.fieldPath)}function J2(t){return t instanceof Te?function(n){if(n.op==="=="){if(Px(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NAN"}};if(Rx(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Px(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NAN"}};if(Rx(n.value))return{unaryFilter:{field:Ho(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ho(n.field),op:TF(n.op),value:n.value}}}(t):t instanceof je?function(n){const r=n.getFilters().map(i=>J2(i));return r.length===1?r[0]:{compositeFilter:{op:SF(n.op),filters:r}}}(t):ue()}function CF(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Z2(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,n,r,i,s=pe.min(),o=pe.min(),a=yt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ri(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this.ct=e}}function AF(t,e){let n;if(e.document)n=wF(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ie.fromSegments(e.noDocument.path),i=uo(e.noDocument.readTime);n=lt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ue();{const r=ie.fromSegments(e.unknownDocument.path),i=uo(e.unknownDocument.version);n=lt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new rt(i[0],i[1]);return pe.fromTimestamp(s)}(e.readTime)),n}function Qx(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Vh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:Nh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ja(s,o.version.toTimestamp()),createTime:ja(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:co(e.version)};else{if(!e.isUnknownDocument())return ue();r.unknownDocument={path:n.path.toArray(),version:co(e.version)}}return r}function Vh(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function co(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function uo(t){const e=new rt(t.seconds,t.nanoseconds);return pe.fromTimestamp(e)}function Ds(t,e){const n=(e.baseMutations||[]).map(s=>bg(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>bg(t.ct,s)),i=rt.fromMillis(e.localWriteTimeMs);return new xy(e.batchId,i,n,r)}function Gl(t){const e=uo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?uo(t.lastLimboFreeSnapshotVersion):pe.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return he(s.documents.length===1),Wn(Ef(K2(s.documents[0])))}(t.query):function(s){return Wn(Y2(s))}(t.query),new ri(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,yt.fromBase64String(t.resumeToken))}function tC(t,e){const n=co(e.snapshotVersion),r=co(e.lastLimboFreeSnapshotVersion);let i;i=Rh(e.target)?W2(t.ct,e.target):Q2(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:lo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function nC(t){const e=Y2({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?_g(e,e.limit,"L"):e}function zp(t,e){return new by(e.largestBatchId,bg(t.ct,e.overlayMutation))}function Yx(t,e){const n=e.path.lastSegment();return[t,tn(e.path.popLast()),n]}function Xx(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:co(r.readTime),documentKey:tn(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kF{getBundleMetadata(e,n){return Jx(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:uo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return Jx(e).put(function(i){return{bundleId:i.id,createTime:co(nn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return Zx(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:nC(s.bundledQuery),readTime:uo(s.readTime)}}(r)})}saveNamedQuery(e,n){return Zx(e).put(function(i){return{name:i.name,readTime:co(nn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function Jx(t){return It(t,"bundles")}function Zx(t){return It(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new Af(e,r)}getOverlay(e,n){return Rl(e).get(Yx(this.userId,n)).next(r=>r?zp(this.serializer,r):null)}getOverlays(e,n){const r=Tr();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new by(n,o);i.push(this.ht(e,a))}),q.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(tn(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Rl(e).j("collectionPathOverlayIndex",a))}),q.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Tr(),s=tn(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Rl(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=zp(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Tr();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Rl(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{const h=zp(this.serializer,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,n){return Rl(e).put(function(i,s,o){const[a,l,c]=Yx(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Dh(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Rl(t){return It(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RF{Pt(e){return It(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?yt.fromUint8Array(r):yt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vs{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(Xe(e.integerValue));else if("doubleValue"in e){const r=Xe(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Hc(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=mi(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(us(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?m2(e)?this.dt(n,Number.MAX_SAFE_INTEGER):xf(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):ue()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(Xe(a)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),ie.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Vs.vt=new Vs;function PF(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function e1(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=PF(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class NF{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=e1(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=e1(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class DF{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class VF{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Pl{constructor(){this.jt=new NF,this.Ht=new DF(this.jt),this.Jt=new VF(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Os(this.indexId,this.documentKey,this.arrayValue,r)}}function Pi(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=t1(t.arrayValue,e.arrayValue),n!==0?n:(n=t1(t.directionalValue,e.directionalValue),n!==0?n:ie.comparator(t.documentKey,e.documentKey)))}function t1(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e){this.Xt=new $e((n,r)=>tt.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(he(e.collectionGroup===this.collectionId),this.nn)return!1;const n=dg(e);if(n!==void 0&&!this.sn(n))return!1;const r=Ps(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new $e(tt.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Pd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Pd(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Pd(r.field,r.dir==="asc"?0:1)));return new Ah(Ah.UNKNOWN_ID,this.collectionId,n,Bc.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rC(t){var e,n;if(he(t instanceof Te||t instanceof je),t instanceof Te){if(t instanceof I2){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>Te.create(t.field,"==",s)))||[];return je.create(i,"or")}return t}const r=t.filters.map(i=>rC(i));return je.create(r,t.op)}function OF(t){if(t.getFilters().length===0)return[];const e=Sg(rC(t));return he(iC(e)),Ig(e)||Tg(e)?[e]:e.getFilters()}function Ig(t){return t instanceof Te}function Tg(t){return t instanceof je&&_y(t)}function iC(t){return Ig(t)||Tg(t)||function(n){if(n instanceof je&&mg(n)){for(const r of n.getFilters())if(!Ig(r)&&!Tg(r))return!1;return!0}return!1}(t)}function Sg(t){if(he(t instanceof Te||t instanceof je),t instanceof Te)return t;if(t.filters.length===1)return Sg(t.filters[0]);const e=t.filters.map(r=>Sg(r));let n=je.create(e,t.op);return n=Oh(n),iC(n)?n:(he(n instanceof je),he(Oa(n)),he(n.filters.length>1),n.filters.reduce((r,i)=>Sy(r,i)))}function Sy(t,e){let n;return he(t instanceof Te||t instanceof je),he(e instanceof Te||e instanceof je),n=t instanceof Te?e instanceof Te?function(i,s){return je.create([i,s],"and")}(t,e):r1(t,e):e instanceof Te?r1(e,t):function(i,s){if(he(i.filters.length>0&&s.filters.length>0),Oa(i)&&Oa(s))return x2(i,s.getFilters());const o=mg(i)?i:s,a=mg(i)?s:i,l=o.filters.map(c=>Sy(c,a));return je.create(l,"or")}(t,e),Oh(n)}function r1(t,e){if(Oa(e))return x2(e,t.getFilters());{const n=e.filters.map(r=>Sy(t,r));return je.create(n,"or")}}function Oh(t){if(he(t instanceof Te||t instanceof je),t instanceof Te)return t;const e=t.getFilters();if(e.length===1)return Oh(e[0]);if(_2(t))return t;const n=e.map(i=>Oh(i)),r=[];return n.forEach(i=>{i instanceof Te?r.push(i):i instanceof je&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:je.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zF{constructor(){this.un=new Cy}addToCollectionParentIndex(e,n){return this.un.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(zn.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(zn.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class Cy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new $e(Me.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new $e(Me.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const od=new Uint8Array(0);class LF{constructor(e,n){this.databaseId=n,this.cn=new Cy,this.ln=new vs(r=>lo(r),(r,i)=>uu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:tn(i)};return i1(e).put(s)}return q.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[i2(n),""],!1,!0);return i1(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Ir(o.parent))}return r})}addFieldIndex(e,n){const r=Nl(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=Fo(e);return s.next(a=>{o.put(Xx(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Nl(e),i=Fo(e),s=jo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Nl(e),r=jo(e),i=Fo(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return q.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new n1(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=jo(e);let i=!0;const s=new Map;return q.forEach(this.hn(n),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=we();const a=[];return q.forEach(s,(l,c)=>{J("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(A=>`${A.fieldPath}:${A.kind}`).join(",")}`}(l)} to execute ${lo(n)}`);const d=function(T,A){const O=dg(A);if(O===void 0)return null;for(const L of Ph(T,O.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(c,l),h=function(T,A){const O=new Map;for(const L of Ps(A))for(const S of Ph(T,L.fieldPath))switch(S.op){case"==":case"in":O.set(L.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return O.set(L.fieldPath.canonicalString(),S.value),Array.from(O.values())}return null}(c,l),f=function(T,A){const O=[];let L=!0;for(const S of Ps(A)){const I=S.kind===0?zx(T,S.fieldPath,T.startAt):Lx(T,S.fieldPath,T.startAt);O.push(I.value),L&&(L=I.inclusive)}return new Va(O,L)}(c,l),m=function(T,A){const O=[];let L=!0;for(const S of Ps(A)){const I=S.kind===0?Lx(T,S.fieldPath,T.endAt):zx(T,S.fieldPath,T.endAt);O.push(I.value),L&&(L=I.inclusive)}return new Va(O,L)}(c,l),b=this.In(l,c,f),x=this.In(l,c,m),R=this.Tn(l,c,h),y=this.En(l.indexId,d,b,f.inclusive,x,m.inclusive,R);return q.forEach(y,v=>r.G(v,n.limit).next(T=>{T.forEach(A=>{const O=ie.fromSegments(A.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return q.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=OF(je.create(e.filters,"and")).map(r=>yg(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),d=[];for(let h=0;h<l;++h){const f=n?this.dn(n[h/c]):od,m=this.An(e,f,r[h%c],i),b=this.Rn(e,f,s[h%c],o),x=a.map(R=>this.An(e,f,R,!0));d.push(...this.createRange(m,b,x))}return d}An(e,n,r,i){const s=new Os(e,ie.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new Os(e,ie.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new n1(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.hn(n);return q.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new $e(tt.comparator),d=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new Pl;for(const i of Ps(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);Vs.vt.It(s,o)}return r.zt()}dn(e){const n=new Pl;return Vs.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new Pl;return Vs.vt.It(Gc(this.databaseId,n),r.Yt(function(s){const o=Ps(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new Pl);let s=0;for(const o of Ps(e)){const a=r[s++];for(const l of i)if(this.fn(n,o.fieldPath)&&Wc(a))i=this.gn(i,o,a);else{const c=l.Yt(o.kind);Vs.vt.It(a,c)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Pl;l.seed(a.zt()),Vs.vt.It(o,l.Yt(n.kind)),s.push(l)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof Te&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Nl(e),i=Fo(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return q.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,h){const f=h?new Bc(h.sequenceNumber,new zn(uo(h.readTime),new ie(Ir(h.documentKey)),h.largestBatchId)):Bc.empty(),m=d.fields.map(([b,x])=>new Pd(tt.fromServerFormat(b),x));return new Ah(d.indexId,d.collectionGroup,m,f)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ve(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Nl(e),s=Fo(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>q.forEach(a,l=>s.put(Xx(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return q.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),q.forEach(a,l=>this.wn(e,i,l).next(c=>{const d=this.Sn(s,l);return c.isEqual(d)?q.resolve():this.bn(e,s,l,c,d)}))))})}Dn(e,n,r,i){return jo(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return jo(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=jo(e);let s=new $e(Pi);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,a)=>{s=s.add(new Os(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,n){let r=new $e(Pi);const i=this.Vn(n,e);if(i==null)return r;const s=dg(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Wc(o))for(const a of o.arrayValue.values||[])r=r.add(new Os(n.indexId,e.key,this.dn(a),i))}else r=r.add(new Os(n.indexId,e.key,od,i));return r}bn(e,n,r,i,s){J("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,c,d,h,f){const m=l.getIterator(),b=c.getIterator();let x=Mo(m),R=Mo(b);for(;x||R;){let y=!1,v=!1;if(x&&R){const T=d(x,R);T<0?v=!0:T>0&&(y=!0)}else x!=null?v=!0:y=!0;y?(h(R),R=Mo(b)):v?(f(x),x=Mo(m)):(x=Mo(m),R=Mo(b))}}(i,s,Pi,a=>{o.push(this.Dn(e,n,r,a))},a=>{o.push(this.vn(e,n,r,a))}),q.waitFor(o)}yn(e){let n=1;return Fo(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Pi(o,a)).filter((o,a,l)=>!a||Pi(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Pi(o,e),l=Pi(o,n);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,od,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,od,[]];s.push(IDBKeyRange.bound(a,l))}return s}Cn(e,n){return Pi(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(s1)}getMinOffset(e,n){return q.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||ue())).next(s1)}}function i1(t){return It(t,"collectionParents")}function jo(t){return It(t,"indexEntries")}function Nl(t){return It(t,"indexConfiguration")}function Fo(t){return It(t,"indexState")}function s1(t){he(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;py(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new zn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ln{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ln(e,ln.DEFAULT_COLLECTION_PERCENTILE,ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sC(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(d,h,f)=>(a++,f.delete()));s.push(l.next(()=>{he(a===1)}));const c=[];for(const d of n.mutations){const h=c2(e,d.key.path,n.batchId);s.push(i.delete(h)),c.push(d.key)}return q.waitFor(s).next(()=>c)}function zh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ue();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ln.DEFAULT_COLLECTION_PERCENTILE=10,ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ln.DEFAULT=new ln(41943040,ln.DEFAULT_COLLECTION_PERCENTILE,ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ln.DISABLED=new ln(-1,0,0);class kf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){he(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new kf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ni(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Ko(e),o=Ni(e);return o.add({}).next(a=>{he(typeof a=="number");const l=new xy(a,n,r,i),c=function(m,b,x){const R=x.baseMutations.map(v=>Dh(m.ct,v)),y=x.mutations.map(v=>Dh(m.ct,v));return{userId:b,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:R,mutations:y}}(this.serializer,this.userId,l),d=[];let h=new $e((f,m)=>ve(f.canonicalString(),m.canonicalString()));for(const f of i){const m=c2(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),d.push(o.put(c)),d.push(s.put(m,v9))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),q.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return Ni(e).get(n).next(r=>r?(he(r.userId===this.userId),Ds(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?q.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Ni(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(he(a.batchId>=r),s=Ds(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Ni(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ni(e).U("userMutationsIndex",n).next(r=>r.map(i=>Ds(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Nd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Ko(e).J({range:i},(o,a,l)=>{const[c,d,h]=o,f=Ir(d);if(c===this.userId&&n.path.isEqual(f))return Ni(e).get(h).next(m=>{if(!m)throw ue();he(m.userId===this.userId),s.push(Ds(this.serializer,m))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $e(ve);const i=[];return n.forEach(s=>{const o=Nd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Ko(e).J({range:a},(c,d,h)=>{const[f,m,b]=c,x=Ir(m);f===this.userId&&s.path.isEqual(x)?r=r.add(b):h.done()});i.push(l)}),q.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Nd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new $e(ve);return Ko(e).J({range:o},(l,c,d)=>{const[h,f,m]=l,b=Ir(f);h===this.userId&&r.isPrefixOf(b)?b.length===i&&(a=a.add(m)):d.done()}).next(()=>this.xn(e,a))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Ni(e).get(s).next(o=>{if(o===null)throw ue();he(o.userId===this.userId),r.push(Ds(this.serializer,o))}))}),q.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return sC(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),q.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return q.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Ko(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Ir(s[1]);i.push(l)}else a.done()}).next(()=>{he(i.length===0)})})}containsKey(e,n){return oC(e,this.userId,n)}Nn(e){return aC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function oC(t,e,n){const r=Nd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Ko(t).J({range:s,H:!0},(a,l,c)=>{const[d,h,f]=a;d===e&&h===i&&(o=!0),c.done()}).next(()=>o)}function Ni(t){return It(t,"mutations")}function Ko(t){return It(t,"documentMutations")}function aC(t){return It(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ho(0)}static kn(){return new ho(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MF{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ho(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>pe.fromTimestamp(new rt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>$o(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(he(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return $o(e).J((o,a)=>{const l=Gl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>q.waitFor(s)).next(()=>i)}forEachTarget(e,n){return $o(e).J((r,i)=>{const s=Gl(i);n(s)})}qn(e){return a1(e).get("targetGlobalKey").next(n=>(he(n!==null),n))}Qn(e,n){return a1(e).put("targetGlobalKey",n)}Kn(e,n){return $o(e).put(tC(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=lo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return $o(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const c=Gl(a);uu(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Bi(e);return n.forEach(o=>{const a=tn(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),q.waitFor(i)}removeMatchingKeys(e,n,r){const i=Bi(e);return q.forEach(n,s=>{const o=tn(s.path);return q.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Bi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Bi(e);let s=we();return i.J({range:r,H:!0},(o,a,l)=>{const c=Ir(o[1]),d=new ie(c);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=tn(n.path),i=IDBKeyRange.bound([r],[i2(r)],!1,!0);let s=0;return Bi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return $o(e).get(n).next(r=>r?Gl(r):null)}}function $o(t){return It(t,"targets")}function a1(t){return It(t,"targetGlobal")}function Bi(t){return It(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l1([t,e],[n,r]){const i=ve(t,n);return i===0?ve(e,r):i}class jF{constructor(e){this.Un=e,this.buffer=new $e(l1),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();l1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class FF{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){J("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ys(n)?J("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await _o(n)}await this.Hn(3e5)})}}class $F{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(Hn.oe);const r=new jF(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(J("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(o1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(J("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),o1):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(J("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),Uo()<=Ie.DEBUG&&J("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function UF(t,e){return new $F(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BF{constructor(e,n){this.db=e,this.garbageCollector=UF(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return ad(e,r)}removeReference(e,n,r){return ad(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ad(e,n)}nr(e,n){return function(i,s){let o=!1;return aC(i).Y(a=>oC(i,a,s).next(l=>(l&&(o=!0),q.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=n){const l=this.nr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,pe.min()),Bi(e).delete(function(h){return[0,tn(h.path)]}(o))))});i.push(l)}}).next(()=>q.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ad(e,n)}tr(e,n){const r=Bi(e);let i,s=Hn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==Hn.oe&&n(new ie(Ir(i)),s),s=c,i=l):s=Hn.oe}).next(()=>{s!==Hn.oe&&n(new ie(Ir(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ad(t,e){return Bi(t).put(function(r,i){return{targetId:0,path:tn(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(){this.changes=new vs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,lt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ss(e).put(r)}removeEntry(e,n,r){return Ss(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],Vh(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=lt.newInvalidDocument(n);return Ss(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Dl(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:lt.newInvalidDocument(n)};return Ss(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Dl(n))},(i,s)=>{r={document:this.ir(n,s),size:zh(s)}}).next(()=>r)}getEntries(e,n){let r=Pn();return this._r(e,n,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,n){let r=Pn(),i=new Ze(ie.comparator);return this._r(e,n,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,zh(o))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return q.resolve();let i=new $e(d1);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Dl(i.first()),Dl(i.last())),o=i.getIterator();let a=o.getNext();return Ss(e).J({index:"documentKeyIndex",range:s},(l,c,d)=>{const h=ie.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&d1(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(Dl(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),Vh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ss(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let d=Pn();for(const h of c){const f=this.ir(ie.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(hu(n,f)||i.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=Pn();const o=u1(n,r),a=u1(n,zn.max());return Ss(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{const h=this.ir(ie.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new qF(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return c1(e).get("remoteDocumentGlobalKey").next(n=>(he(!!n),n))}rr(e,n){return c1(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=AF(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(pe.min())))return r}return lt.newInvalidDocument(e)}}function cC(t){return new HF(t)}class qF extends lC{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new vs(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new $e((s,o)=>ve(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=Qx(this.cr.serializer,o);i=i.add(s.path.popLast());const c=zh(l);r+=c-a.size,n.push(this.cr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=Qx(this.cr.serializer,o.convertToNoDocument(pe.min()));n.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),q.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function c1(t){return It(t,"remoteDocumentGlobal")}function Ss(t){return It(t,"remoteDocumentsV14")}function Dl(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function u1(t,e){const n=e.documentKey.path.toArray();return[t,Vh(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function d1(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ve(n[s],r[s]),i)return i;return i=ve(n.length,r.length),i||(i=ve(n[n.length-2],r[r.length-2]),i||ve(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KF{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&uc(r.mutation,i,qn.empty(),rt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,we()).next(()=>r))}getLocalViewOfDocuments(e,n,r=we()){const i=Tr();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=ql();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Tr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,we()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Pn();const o=cc(),a=function(){return cc()}();return n.forEach((l,c)=>{const d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof _s)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),uc(d.mutation,c,d.mutation.getFieldMask(),rt.now())):o.set(c.key,qn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var h;return a.set(c,new KF(d,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=cc();let i=new Ze((o,a)=>o-a),s=we();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=r.get(l)||qn.empty();d=a.applyToLocalView(c,d),r.set(l,d);const h=(i.get(a.batchId)||we()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,h=R2();d.forEach(f=>{if(!s.has(f)){const m=L2(n.get(f),r.get(f));m!==null&&h.set(f,m),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):T2(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):q.resolve(Tr());let a=-1,l=s;return o.next(c=>q.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?q.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,we())).next(d=>({batchId:a,changes:k2(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let i=ql();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=ql();return this.indexManager.getCollectionParents(e,s).next(a=>q.forEach(a,l=>{const c=function(h,f){return new du(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,lt.newInvalidDocument(d)))});let a=ql();return o.forEach((l,c)=>{const d=s.get(l);d!==void 0&&uc(d.mutation,c,qn.empty(),rt.now()),hu(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GF{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return q.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:nn(i.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:nC(i.bundledQuery),readTime:nn(i.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WF{constructor(){this.overlays=new Ze(ie.comparator),this.Ir=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Tr();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const i=Tr(),s=n.length+1,o=new ie(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return q.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ze((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=Tr(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Tr(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return q.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new by(n,r));let s=this.Ir.get(n);s===void 0&&(s=we(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QF{constructor(){this.sessionToken=yt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(){this.Tr=new $e(At.Er),this.dr=new $e(At.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new At(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new At(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ie(new Me([])),r=new At(n,e),i=new At(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ie(new Me([])),r=new At(n,e),i=new At(n,e+1);let s=we();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new At(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class At{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ie.comparator(e.key,n.key)||ve(e.wr,n.wr)}static Ar(e,n){return ve(e.wr,n.wr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new $e(At.Er)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new xy(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new At(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new At(n,0),i=new At(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new $e(ve);return n.forEach(i=>{const s=new At(i,0),o=new At(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),q.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ie.isDocumentKey(s)||(s=s.child(""));const o=new At(new ie(s),0);let a=new $e(ve);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.wr)),!0)},o),q.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){he(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return q.forEach(n.mutations,i=>{const s=new At(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new At(n,0),i=this.br.firstAfterOrEqual(r);return q.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(e){this.Mr=e,this.docs=function(){return new Ze(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():lt.newInvalidDocument(n))}getEntries(e,n){let r=Pn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():lt.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Pn();const o=n.path,a=new ie(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||py(s2(d),r)<=0||(i.has(d.key)||hu(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ue()}Or(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new JF(this)}getSize(e){return q.resolve(this.size)}}class JF extends lC{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e){this.persistence=e,this.Nr=new vs(n=>lo(n),uu),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Ay,this.targetCount=0,this.kr=ho.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),q.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ho(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Kn(n),q.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Hn(0),this.Kr=!1,this.Kr=!0,this.$r=new QF,this.referenceDelegate=e(this),this.Ur=new ZF(this),this.indexManager=new zF,this.remoteDocumentCache=function(i){return new XF(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new eC(n),this.Gr=new GF(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new WF,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new YF(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("MemoryPersistence","Starting transaction:",e);const i=new e$(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return q.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class e$ extends a2{constructor(e){super(),this.currentSequenceNumber=e}}class Rf{constructor(e){this.persistence=e,this.Jr=new Ay,this.Yr=null}static Zr(e){return new Rf(e)}get Xr(){if(this.Yr)return this.Yr;throw ue()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),q.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.Xr,r=>{const i=ie.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,pe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return q.or([()=>q.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t${constructor(e){this.serializer=e}O(e,n,r,i){const s=new _f("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Tx,{unique:!0}),l.createObjectStore("documentMutations")}(e),h1(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=q.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),h1(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pe.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",Tx,{unique:!0});const h=c.store("mutations"),f=d.map(m=>h.put(m));return q.waitFor(f)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:R9});c.createIndex("collectionPathOverlayIndex",P9,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",N9,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:_9});c.createIndex("documentKeyIndex",w9),c.createIndex("collectionGroupIndex",x9)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:S9}).createIndex("sequenceNumberIndex",C9,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:A9}).createIndex("documentKeyIndex",k9,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=zh(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>q.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>q.forEach(a,l=>{he(l.userId===s.userId);const c=Ds(this.serializer,l);return sC(e,s.userId,c).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new Me(o),c=function(h){return[0,tn(h)]}(l);s.push(n.get(c).next(d=>d?q.resolve():(h=>n.put({targetId:0,path:tn(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>q.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:T9});const r=n.store("collectionParents"),i=new Cy,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:tn(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new Me(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],c)=>{const d=Ir(a);return s(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=Gl(i),o=tC(this.serializer,s);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(h){return h.document?new ie(Me.fromString(h.document.name).popFirst(5)):h.noDocument?ie.fromSegments(h.noDocument.path):h.unknownDocument?ie.fromSegments(h.unknownDocument.path):ue()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>q.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=cC(this.serializer),s=new dC(Rf.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:we();Ds(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),q.forEach(a,(l,c)=>{const d=new Mt(c),h=Af.lt(this.serializer,d),f=s.getIndexManager(d),m=kf.lt(d,this.serializer,f,s.referenceDelegate);return new uC(i,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new hg(n,Hn.oe),l).next()})})}}function h1(t){t.createObjectStore("targetDocuments",{keyPath:b9}).createIndex("documentTargetsIndex",I9,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",E9,{unique:!0}),t.createObjectStore("targetGlobal")}const Lp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ky{constructor(e,n,r,i,s,o,a,l,c,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=f=>Promise.resolve(),!ky.D())throw new re(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new BF(this,i),this.Ai=n+"main",this.serializer=new eC(l),this.Ri=new ss(this.Ai,this.hi,new t$(this.serializer)),this.$r=new RF,this.Ur=new MF(this.referenceDelegate,this.serializer),this.remoteDocumentCache=cC(this.serializer),this.Gr=new kF,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&Zt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(Q.FAILED_PRECONDITION,Lp);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Hn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ld(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(ys(e))return J("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return J("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Vl(e).get("owner").next(n=>q.resolve(this.vi(n)))}Ci(e){return ld(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=It(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return q.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?q.resolve(!0):Vl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new re(Q.FAILED_PRECONDITION,Lp);return!1}}return!(!this.networkEnabled||!this.inForeground)||ld(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&J("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new hg(e,Hn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>ld(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return kf.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new LF(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Af.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===17?O9:l===16?V9:l===15?gy:l===14?h2:l===13?d2:l===12?D9:l===11?u2:void ue()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new hg(a,this.Qr?this.Qr.next():Hn.oe),n==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw Zt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new re(Q.FAILED_PRECONDITION,o2);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Vl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(Q.FAILED_PRECONDITION,Lp)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Vl(e).put("owner",n)}static D(){return ss.D()}bi(e){const n=Vl(e);return n.get("owner").next(r=>this.vi(r)?(J("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):q.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Zt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;cS()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return J("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Zt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){Zt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Vl(t){return It(t,"owner")}function ld(t){return It(t,"clientMetadata")}function n$(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ry{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=we(),i=we();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Ry(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r${constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return cS()?8:l2(bt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new r$;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Uo()<=Ie.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Bo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),q.resolve()):(Uo()<=Ie.DEBUG&&J("QueryEngine","Query:",Bo(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Uo()<=Ie.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Bo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Wn(n))):q.resolve())}Yi(e,n){if(Mx(n))return q.resolve(null);let r=Wn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=_g(n,null,"F"),r=Wn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=we(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(n,a);return this.ns(n,c,o,l.readTime)?this.Yi(e,_g(n,null,"F")):this.rs(e,c,n,l)}))})))}Zi(e,n,r,i){return Mx(n)||i.isEqual(pe.min())?q.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?q.resolve(null):(Uo()<=Ie.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Bo(n)),this.rs(e,o,n,d9(i,-1)).next(a=>a))})}ts(e,n){let r=new $e(C2(e));return n.forEach((i,s)=>{hu(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Uo()<=Ie.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Bo(n)),this.Ji.getDocumentsMatchingQuery(e,n,zn.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i${constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Ze(ve),this._s=new vs(s=>lo(s),uu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new uC(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function fC(t,e,n,r){return new i$(t,e,n,r)}async function pC(t,e){const n=ge(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=we();for(const c of i){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function s$(t,e){const n=ge(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const h=c.batch,f=h.keys();let m=q.resolve();return f.forEach(b=>{m=m.next(()=>d.getEntry(l,b)).next(x=>{const R=c.docVersions.get(b);he(R!==null),x.version.compareTo(R)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=we();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function mC(t){const e=ge(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function o$(t,e){const n=ge(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];e.targetChanges.forEach((d,h)=>{const f=i.get(h);if(!f)return;a.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,h)));let m=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(yt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),i=i.insert(h,m),function(x,R,y){return x.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(f,m,d)&&a.push(n.Ur.updateTargetData(s,m))});let l=Pn(),c=we();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(a$(s,o,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!r.isEqual(pe.min())){const d=n.Ur.getLastRemoteSnapshotVersion(s).next(h=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return q.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.os=i,s))}function a$(t,e,n){let r=we(),i=we();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Pn();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):J("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function l$(t,e){const n=ge(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function c$(t,e){const n=ge(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new ri(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Cg(t,e,n){const r=ge(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ys(o))throw o;J("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function f1(t,e,n){const r=ge(t);let i=pe.min(),s=we();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const h=ge(l),f=h._s.get(d);return f!==void 0?q.resolve(h.os.get(f)):h.Ur.getTargetData(c,d)}(r,o,Wn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:pe.min(),n?s:we())).next(a=>(u$(r,Y9(e),a),{documents:a,Ts:s})))}function u$(t,e,n){let r=t.us.get(e)||pe.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}class p1{constructor(){this.activeTargetIds=nF()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class gC{constructor(){this.so=new p1,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new p1,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d${_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){J("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){J("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cd=null;function Mp(){return cd===null?cd=function(){return 268435456+Math.round(2147483648*Math.random())}():cd++,"0x"+cd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f${constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gt="WebChannelConnection";class p$ extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const a=Mp(),l=this.xo(n,r.toUriEncodedString());J("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(n,l,c,i).then(d=>(J("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw so("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ja}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=h$[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Mp();return new Promise((o,a)=>{const l=new XS;l.setWithCredentials(!0),l.listenOnce(JS.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Rd.NO_ERROR:const d=l.getResponseJson();J(Gt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Rd.TIMEOUT:J(Gt,`RPC '${e}' ${s} timed out`),a(new re(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Rd.HTTP_ERROR:const h=l.getStatus();if(J(Gt,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const b=function(R){const y=R.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(y)>=0?y:Q.UNKNOWN}(m.status);a(new re(b,m.message))}else a(new re(Q.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new re(Q.UNAVAILABLE,"Connection failed."));break;default:ue()}}finally{J(Gt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);J(Gt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",c,r,15)})}Bo(e,n,r){const i=Mp(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=t2(),a=e2(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");J(Gt,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=o.createWebChannel(d,l);let f=!1,m=!1;const b=new f$({Io:R=>{m?J(Gt,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(f||(J(Gt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),J(Gt,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},To:()=>h.close()}),x=(R,y,v)=>{R.listen(y,T=>{try{v(T)}catch(A){setTimeout(()=>{throw A},0)}})};return x(h,Hl.EventType.OPEN,()=>{m||(J(Gt,`RPC '${e}' stream ${i} transport opened.`),b.yo())}),x(h,Hl.EventType.CLOSE,()=>{m||(m=!0,J(Gt,`RPC '${e}' stream ${i} transport closed`),b.So())}),x(h,Hl.EventType.ERROR,R=>{m||(m=!0,so(Gt,`RPC '${e}' stream ${i} transport errored:`,R),b.So(new re(Q.UNAVAILABLE,"The operation could not be completed")))}),x(h,Hl.EventType.MESSAGE,R=>{var y;if(!m){const v=R.data[0];he(!!v);const T=v,A=T.error||((y=T[0])===null||y===void 0?void 0:y.error);if(A){J(Gt,`RPC '${e}' stream ${i} received error:`,A);const O=A.status;let L=function(w){const E=mt[w];if(E!==void 0)return F2(E)}(O),S=A.message;L===void 0&&(L=Q.INTERNAL,S="Unknown error status: "+O+" with message "+A.message),m=!0,b.So(new re(L,S)),h.close()}else J(Gt,`RPC '${e}' stream ${i} received:`,v),b.bo(v)}}),x(a,ZS.STAT_EVENT,R=>{R.stat===ug.PROXY?J(Gt,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===ug.NOPROXY&&J(Gt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.wo()},0),b}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m$(){return typeof window<"u"?window:null}function Ld(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pf(t){return new vF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&J("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,n,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new yC(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Q.RESOURCE_EXHAUSTED?(Zt(n.toString()),Zt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new re(Q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return J("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(J("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class g$ extends vC{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=xF(this.serializer,e),r=function(s){if(!("targetChange"in s))return pe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?nn(o.readTime):pe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Eg(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Rh(l)?{documents:W2(s,l)}:{query:Q2(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=B2(s,o.resumeToken);const c=wg(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=ja(s,o.snapshotVersion.toTimestamp());const c=wg(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=bF(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Eg(this.serializer),n.removeTarget=e,this.a_(n)}}class y$ extends vC{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return he(!!e.streamToken),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){he(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=EF(e.writeResults,e.commitTime),r=nn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Eg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Dh(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v$ extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new re(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,xg(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(Q.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,xg(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(Q.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class _${constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Zt(n),this.D_=!1):J("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w${constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{wo(this)&&(J("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=ge(l);c.L_.add(4),await pu(c),c.q_.set("Unknown"),c.L_.delete(4),await Nf(c)}(this))})}),this.q_=new _$(r,i)}}async function Nf(t){if(wo(t))for(const e of t.B_)await e(!0)}async function pu(t){for(const e of t.B_)await e(!1)}function _C(t,e){const n=ge(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Vy(n)?Dy(n):tl(n).r_()&&Ny(n,e))}function Py(t,e){const n=ge(t),r=tl(n);n.N_.delete(e),r.r_()&&wC(n,e),n.N_.size===0&&(r.r_()?r.o_():wo(n)&&n.q_.set("Unknown"))}function Ny(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}tl(t).A_(e)}function wC(t,e){t.Q_.xe(e),tl(t).R_(e)}function Dy(t){t.Q_=new pF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),tl(t).start(),t.q_.v_()}function Vy(t){return wo(t)&&!tl(t).n_()&&t.N_.size>0}function wo(t){return ge(t).L_.size===0}function xC(t){t.Q_=void 0}async function x$(t){t.q_.set("Online")}async function E$(t){t.N_.forEach((e,n)=>{Ny(t,e)})}async function b$(t,e){xC(t),Vy(t)?(t.q_.M_(e),Dy(t)):t.q_.set("Unknown")}async function I$(t,e,n){if(t.q_.set("Online"),e instanceof U2&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(t,e)}catch(r){J("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Lh(t,r)}else if(e instanceof zd?t.Q_.Ke(e):e instanceof $2?t.Q_.He(e):t.Q_.We(e),!n.isEqual(pe.min()))try{const r=await mC(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(yt.EMPTY_BYTE_STRING,d.snapshotVersion)),wC(s,l);const h=new ri(d.target,l,c,d.sequenceNumber);Ny(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){J("RemoteStore","Failed to raise snapshot:",r),await Lh(t,r)}}async function Lh(t,e,n){if(!ys(e))throw e;t.L_.add(1),await pu(t),t.q_.set("Offline"),n||(n=()=>mC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{J("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Nf(t)})}function EC(t,e){return e().catch(n=>Lh(t,n,e))}async function mu(t){const e=ge(t),n=hs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;T$(e);)try{const i=await l$(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,S$(e,i)}catch(i){await Lh(e,i)}bC(e)&&IC(e)}function T$(t){return wo(t)&&t.O_.length<10}function S$(t,e){t.O_.push(e);const n=hs(t);n.r_()&&n.V_&&n.m_(e.mutations)}function bC(t){return wo(t)&&!hs(t).n_()&&t.O_.length>0}function IC(t){hs(t).start()}async function C$(t){hs(t).p_()}async function A$(t){const e=hs(t);for(const n of t.O_)e.m_(n.mutations)}async function k$(t,e,n){const r=t.O_.shift(),i=Ey.from(r,e,n);await EC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await mu(t)}async function R$(t,e){e&&hs(t).V_&&await async function(r,i){if(function(o){return dF(o)&&o!==Q.ABORTED}(i.code)){const s=r.O_.shift();hs(r).s_(),await EC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await mu(r)}}(t,e),bC(t)&&IC(t)}async function g1(t,e){const n=ge(t);n.asyncQueue.verifyOperationInProgress(),J("RemoteStore","RemoteStore received new credentials");const r=wo(n);n.L_.add(3),await pu(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Nf(n)}async function P$(t,e){const n=ge(t);e?(n.L_.delete(2),await Nf(n)):e||(n.L_.add(2),await pu(n),n.q_.set("Unknown"))}function tl(t){return t.K_||(t.K_=function(n,r,i){const s=ge(n);return s.w_(),new g$(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:x$.bind(null,t),Ro:E$.bind(null,t),mo:b$.bind(null,t),d_:I$.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Vy(t)?Dy(t):t.q_.set("Unknown")):(await t.K_.stop(),xC(t))})),t.K_}function hs(t){return t.U_||(t.U_=function(n,r,i){const s=ge(n);return s.w_(),new y$(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:C$.bind(null,t),mo:R$.bind(null,t),f_:A$.bind(null,t),g_:k$.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await mu(t)):(await t.U_.stop(),t.O_.length>0&&(J("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Rr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Oy(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zy(t,e){if(Zt("AsyncQueue",`${e}: ${t}`),ys(t))return new re(Q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=ql(),this.sortedSet=new Ze(this.comparator)}static emptySet(e){return new _a(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof _a)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new _a;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{constructor(){this.W_=new Ze(ie.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ue():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Fa{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Fa(e,n,_a.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&bf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N${constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class D${constructor(){this.queries=v1(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=ge(n),s=i.queries;i.queries=v1(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new re(Q.ABORTED,"Firestore shutting down"))}}function v1(){return new vs(t=>S2(t),bf)}async function TC(t,e){const n=ge(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new N$,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=zy(o,`Initialization of query '${Bo(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Ly(n)}async function SC(t,e){const n=ge(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function V$(t,e){const n=ge(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&Ly(n)}function O$(t,e,n){const r=ge(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Ly(t){t.Y_.forEach(e=>{e.next()})}var Ag,_1;(_1=Ag||(Ag={})).ea="default",_1.Cache="cache";class CC{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Fa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Fa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Ag.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e){this.key=e}}class kC{constructor(e){this.key=e}}class z${constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=we(),this.mutatedKeys=we(),this.Aa=C2(e),this.Ra=new _a(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new y1,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const f=i.get(d),m=hu(this.query,h)?h:null,b=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let R=!1;f&&m?f.data.isEqual(m.data)?b!==x&&(r.track({type:3,doc:m}),R=!0):this.ga(f,m)||(r.track({type:2,doc:m}),R=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),R=!0):f&&!m&&(r.track({type:1,doc:f}),R=!0,(l||c)&&(a=!0)),R&&(m?(o=o.add(m),s=x?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,h)=>function(m,b){const x=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue()}};return x(m)-x(b)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;const a=n&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new Fa(this.query,e.Ra,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new y1,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=we(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new kC(r))}),this.da.forEach(r=>{e.has(r)||n.push(new AC(r))}),n}ba(e){this.Ta=e.Ts,this.da=we();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Fa.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class L${constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class M${constructor(e){this.key=e,this.va=!1}}class j${constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new vs(a=>S2(a),bf),this.Ma=new Map,this.xa=new Set,this.Oa=new Ze(ie.comparator),this.Na=new Map,this.La=new Ay,this.Ba={},this.ka=new Map,this.qa=ho.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function F$(t,e,n=!0){const r=OC(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await RC(r,e,n,!0),i}async function $$(t,e){const n=OC(t);await RC(n,e,!0,!1)}async function RC(t,e,n,r){const i=await c$(t.localStore,Wn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await U$(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&_C(t.remoteStore,i),a}async function U$(t,e,n,r,i){t.Ka=(h,f,m)=>async function(x,R,y,v){let T=R.view.ma(y);T.ns&&(T=await f1(x.localStore,R.query,!1).then(({documents:S})=>R.view.ma(S,T)));const A=v&&v.targetChanges.get(R.targetId),O=v&&v.targetMismatches.get(R.targetId)!=null,L=R.view.applyChanges(T,x.isPrimaryClient,A,O);return x1(x,R.targetId,L.wa),L.snapshot}(t,h,f,m);const s=await f1(t.localStore,e,!0),o=new z$(e,s.Ts),a=o.ma(s.documents),l=fu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);x1(t,n,c.wa);const d=new L$(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function B$(t,e,n){const r=ge(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!bf(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Cg(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Py(r.remoteStore,i.targetId),kg(r,i.targetId)}).catch(_o)):(kg(r,i.targetId),await Cg(r.localStore,i.targetId,!0))}async function H$(t,e){const n=ge(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Py(n.remoteStore,r.targetId))}async function q$(t,e,n){const r=zC(t);try{const i=await function(o,a){const l=ge(o),c=rt.now(),d=a.reduce((m,b)=>m.add(b.key),we());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let b=Pn(),x=we();return l.cs.getEntries(m,d).next(R=>{b=R,b.forEach((y,v)=>{v.isValidDocument()||(x=x.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,b)).next(R=>{h=R;const y=[];for(const v of a){const T=cF(v,h.get(v.key).overlayedDocument);T!=null&&y.push(new _s(v.key,T,y2(T.value.mapValue),fn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,y,a)}).next(R=>{f=R;const y=R.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(m,R.batchId,y)})}).then(()=>({batchId:f.batchId,changes:k2(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new Ze(ve)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,n),await gu(r,i.changes),await mu(r.remoteStore)}catch(i){const s=zy(i,"Failed to persist write");n.reject(s)}}async function PC(t,e){const n=ge(t);try{const r=await o$(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(he(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?he(o.va):i.removedDocuments.size>0&&(he(o.va),o.va=!1))}),await gu(n,r,e)}catch(r){await _o(r)}}function w1(t,e,n){const r=ge(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=ge(o);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(const f of h.j_)f.Z_(a)&&(c=!0)}),c&&Ly(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function K$(t,e,n){const r=ge(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Ze(ie.comparator);o=o.insert(s,lt.newNoDocument(s,pe.min()));const a=we().add(s),l=new Cf(pe.min(),new Map,new Ze(ve),o,a);await PC(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),My(r)}else await Cg(r.localStore,e,!1).then(()=>kg(r,e,n)).catch(_o)}async function G$(t,e){const n=ge(t),r=e.batch.batchId;try{const i=await s$(n.localStore,e);DC(n,r,null),NC(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await gu(n,i)}catch(i){await _o(i)}}async function W$(t,e,n){const r=ge(t);try{const i=await function(o,a){const l=ge(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(he(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);DC(r,e,n),NC(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await gu(r,i)}catch(i){await _o(i)}}function NC(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function DC(t,e,n){const r=ge(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function kg(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||VC(t,r)})}function VC(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Py(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),My(t))}function x1(t,e,n){for(const r of n)r instanceof AC?(t.La.addReference(r.key,e),Q$(t,r)):r instanceof kC?(J("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||VC(t,r.key)):ue()}function Q$(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(J("SyncEngine","New document in limbo: "+n),t.xa.add(r),My(t))}function My(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ie(Me.fromString(e)),r=t.qa.next();t.Na.set(r,new M$(n)),t.Oa=t.Oa.insert(n,r),_C(t.remoteStore,new ri(Wn(Ef(n.path)),r,"TargetPurposeLimboResolution",Hn.oe))}}async function gu(t,e,n){const r=ge(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const h=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Ry.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,c){const d=ge(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>q.forEach(c,f=>q.forEach(f.$i,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>q.forEach(f.Ui,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!ys(h))throw h;J("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const m=d.os.get(f),b=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(b);d.os=d.os.insert(f,x)}}}(r.localStore,s))}async function Y$(t,e){const n=ge(t);if(!n.currentUser.isEqual(e)){J("SyncEngine","User change. New user:",e.toKey());const r=await pC(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new re(Q.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await gu(n,r.hs)}}function X$(t,e){const n=ge(t),r=n.Na.get(e);if(r&&r.va)return we().add(r.key);{let i=we();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function OC(t){const e=ge(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=PC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=X$.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=K$.bind(null,e),e.Ca.d_=V$.bind(null,e.eventManager),e.Ca.$a=O$.bind(null,e.eventManager),e}function zC(t){const e=ge(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=G$.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=W$.bind(null,e),e}class Yc{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Pf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return fC(this.persistence,new hC,e.initialUser,this.serializer)}Ga(e){return new dC(Rf.Zr,this.serializer)}Wa(e){return new gC}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Yc.provider={build:()=>new Yc};class J$ extends Yc{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await zC(this.Ja.syncEngine),await mu(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return fC(this.persistence,new hC,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new FF(r,e.asyncQueue,n)}Ha(e,n){const r=new m9(n,this.persistence);return new p9(e.asyncQueue,r)}Ga(e){const n=n$(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ln.withCacheSize(this.cacheSizeBytes):ln.DEFAULT;return new ky(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,m$(),Ld(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new gC}}class Mh{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>w1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Y$.bind(null,this.syncEngine),await P$(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new D$}()}createDatastore(e){const n=Pf(e.databaseInfo.databaseId),r=function(s){return new p$(s)}(e.databaseInfo);return function(s,o,a,l){return new v$(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new w$(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>w1(this.syncEngine,n,0),function(){return m1.D()?new m1:new d$}())}createSyncEngine(e,n){return function(i,s,o,a,l,c,d){const h=new j$(i,s,o,a,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=ge(i);J("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await pu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Mh.provider={build:()=>new Mh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LC{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Zt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z${constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Mt.UNAUTHENTICATED,this.clientId=r2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{J("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(J("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Rr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=zy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function jp(t,e){t.asyncQueue.verifyOperationInProgress(),J("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await pC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function E1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await eU(t);J("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>g1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>g1(e.remoteStore,i)),t._onlineComponents=e}async function eU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){J("FirestoreClient","Using user provided OfflineComponentProvider");try{await jp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Q.FAILED_PRECONDITION||i.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;so("Error using user provided cache. Falling back to memory cache: "+n),await jp(t,new Yc)}}else J("FirestoreClient","Using default OfflineComponentProvider"),await jp(t,new Yc);return t._offlineComponents}async function MC(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(J("FirestoreClient","Using user provided OnlineComponentProvider"),await E1(t,t._uninitializedComponentsProvider._online)):(J("FirestoreClient","Using default OnlineComponentProvider"),await E1(t,new Mh))),t._onlineComponents}function tU(t){return MC(t).then(e=>e.syncEngine)}async function jC(t){const e=await MC(t),n=e.eventManager;return n.onListen=F$.bind(null,e.syncEngine),n.onUnlisten=B$.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=$$.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=H$.bind(null,e.syncEngine),n}function nU(t,e,n={}){const r=new Rr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new LC({next:f=>{d.Za(),o.enqueueAndForget(()=>SC(s,h));const m=f.docs.has(a);!m&&f.fromCache?c.reject(new re(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&l&&l.source==="server"?c.reject(new re(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new CC(Ef(a.path),d,{includeMetadataChanges:!0,_a:!0});return TC(s,h)}(await jC(t),t.asyncQueue,e,n,r)),r.promise}function rU(t,e,n={}){const r=new Rr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new LC({next:f=>{d.Za(),o.enqueueAndForget(()=>SC(s,h)),f.fromCache&&l.source==="server"?c.reject(new re(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new CC(a,d,{includeMetadataChanges:!0,_a:!0});return TC(s,h)}(await jC(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(t,e,n){if(!n)throw new re(Q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function iU(t,e,n,r){if(e===!0&&r===!0)throw new re(Q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function I1(t){if(!ie.isDocumentKey(t))throw new re(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function T1(t){if(ie.isDocumentKey(t))throw new re(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Df(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue()}function gi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Df(t);throw new re(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S1{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new re(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new re(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=FC((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new re(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new re(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new re(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Vf{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new S1({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new S1(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new n9;switch(r.type){case"firstParty":return new o9(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=b1.get(n);r&&(J("ComponentProvider","Removing Datastore"),b1.delete(n),r.terminate())}(this),Promise.resolve()}}function sU(t,e,n,r={}){var i;const s=(t=gi(t,Vf))._getSettings(),o=`${e}:${n}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&so("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if(typeof r.mockUserToken=="string")a=r.mockUserToken,l=Mt.MOCK_USER;else{a=dM(r.mockUserToken,(i=t._app)===null||i===void 0?void 0:i.options.projectId);const c=r.mockUserToken.sub||r.mockUserToken.user_id;if(!c)throw new re(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Mt(c)}t._authCredentials=new r9(new n2(a,l))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new nl(this.firestore,e,this._query)}}class vn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new os(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}}class os extends nl{constructor(e,n,r){super(e,n,Ef(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new ie(e))}withConverter(e){return new os(this.firestore,e,this._path)}}function oU(t,e,...n){if(t=Nt(t),$C("collection","path",e),t instanceof Vf){const r=Me.fromString(e,...n);return T1(r),new os(t,null,r)}{if(!(t instanceof vn||t instanceof os))throw new re(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Me.fromString(e,...n));return T1(r),new os(t.firestore,null,r)}}function Fp(t,e,...n){if(t=Nt(t),arguments.length===1&&(e=r2.newId()),$C("doc","path",e),t instanceof Vf){const r=Me.fromString(e,...n);return I1(r),new vn(t,null,new ie(r))}{if(!(t instanceof vn||t instanceof os))throw new re(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Me.fromString(e,...n));return I1(r),new vn(t.firestore,t instanceof os?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C1{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new yC(this,"async_queue_retry"),this.Vu=()=>{const r=Ld();r&&J("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Ld();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Ld();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Rr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ys(e))throw e;J("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw Zt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Oy.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ue()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class rl extends Vf{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new C1,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new C1(e),this._firestoreClient=void 0,await e}}}function aU(t,e){const n=typeof t=="object"?t:ty(),r=typeof t=="string"?t:"(default)",i=vo(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=cM("firestore");s&&sU(i,...s)}return i}function jy(t){if(t._terminated)throw new re(Q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||UC(t),t._firestoreClient}function UC(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,c,d){return new L9(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,FC(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new Z$(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}function lU(t,e){so("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return cU(t,Mh.provider,{build:r=>new J$(r,n.cacheSizeBytes,void 0)}),Promise.resolve()}function cU(t,e,n){if((t=gi(t,rl))._firestoreClient||t._terminated)throw new re(Q.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new re(Q.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},UC(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this._byteString=e}static fromBase64String(e){try{return new $a(yt.fromBase64String(e))}catch(n){throw new re(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new $a(yt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new tt(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uy{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ve(this._lat,e._lat)||ve(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uU=/^__.*__$/;class dU{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new _s(e,this.data,this.fieldMask,n,this.fieldTransforms):new el(e,this.data,n,this.fieldTransforms)}}function BC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue()}}class Hy{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Hy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return jh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(BC(this.Cu)&&uU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class hU{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Pf(e)}Qu(e,n,r,i=!1){return new Hy({Cu:e,methodName:n,qu:r,path:tt.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function HC(t){const e=t._freezeSettings(),n=Pf(t._databaseId);return new hU(t._databaseId,!!e.ignoreUndefinedProperties,n)}function fU(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);GC("Data must be an object, but it was:",o,r);const a=qC(r,o);let l,c;if(s.merge)l=new qn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const f=mU(e,h,n);if(!o.contains(f))throw new re(Q.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);yU(d,f)||d.push(f)}l=new qn(d),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new dU(new un(a),l,c)}class qy extends $y{_toFieldTransform(e){return new z2(e.path,new za)}isEqual(e){return e instanceof qy}}function pU(t,e,n,r=!1){return Ky(n,t.Qu(r?4:3,e))}function Ky(t,e){if(KC(t=Nt(t)))return GC("Unsupported field value:",e,t),qC(t,e);if(t instanceof $y)return function(r,i){if(!BC(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Ky(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Nt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return rF(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=rt.fromDate(r);return{timestampValue:ja(i.serializer,s)}}if(r instanceof rt){const s=new rt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ja(i.serializer,s)}}if(r instanceof Uy)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof $a)return{bytesValue:B2(i.serializer,r._byteString)};if(r instanceof vn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ty(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof By)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return wy(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Df(r)}`)}(t,e)}function qC(t,e){const n={};return f2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Za(t,(r,i)=>{const s=Ky(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function KC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof rt||t instanceof Uy||t instanceof $a||t instanceof vn||t instanceof $y||t instanceof By)}function GC(t,e,n){if(!KC(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Df(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function mU(t,e,n){if((e=Nt(e))instanceof Fy)return e._internalPath;if(typeof e=="string")return WC(t,e);throw jh("Field path arguments must be of type string or ",t,!1,void 0,n)}const gU=new RegExp("[~\\*/\\[\\]]");function WC(t,e,n){if(e.search(gU)>=0)throw jh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Fy(...e.split("."))._internalPath}catch{throw jh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function jh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new re(Q.INVALID_ARGUMENT,a+t+l)}function yU(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new vU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(YC("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class vU extends QC{data(){return super.data()}}function YC(t,e){return typeof e=="string"?WC(t,e):e instanceof Fy?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _U(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gy{}class wU extends Gy{}function xU(t,e,...n){let r=[];e instanceof Gy&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof Qy).length,a=s.filter(l=>l instanceof Wy).length;if(o>1||o>0&&a>0)throw new re(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class Wy extends wU{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Wy(e,n,r)}_apply(e){const n=this._parse(e);return XC(e._query,n),new nl(e.firestore,e.converter,vg(e._query,n))}_parse(e){const n=HC(e.firestore);return function(s,o,a,l,c,d,h){let f;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new re(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){k1(h,d);const m=[];for(const b of h)m.push(A1(l,s,b));f={arrayValue:{values:m}}}else f=A1(l,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||k1(h,d),f=pU(a,o,h,d==="in"||d==="not-in");return Te.create(c,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Qy extends Gy{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Qy(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:je.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)XC(o,l),o=vg(o,l)}(e._query,n),new nl(e.firestore,e.converter,vg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function A1(t,e,n){if(typeof(n=Nt(n))=="string"){if(n==="")throw new re(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!T2(e)&&n.indexOf("/")!==-1)throw new re(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Me.fromString(n));if(!ie.isDocumentKey(r))throw new re(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Gc(t,new ie(r))}if(n instanceof vn)return Gc(t,n._key);throw new re(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Df(n)}.`)}function k1(t,e){if(!Array.isArray(t)||t.length===0)throw new re(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XC(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class EU{convertValue(e,n="none"){switch(ao(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Xe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(us(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ue()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Za(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Xe(o.doubleValue));return new By(s)}convertGeoPoint(e){return new Uy(Xe(e.latitude),Xe(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=vy(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(qc(e));default:return null}}convertTimestamp(e){const n=mi(e);return new rt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Me.fromString(e);he(Z2(r));const i=new oo(r.get(1),r.get(3)),s=new ie(r.popFirst(5));return i.isEqual(n)||Zt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bU(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class JC extends QC{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Md(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(YC("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Md extends JC{data(e={}){return super.data(e)}}class IU{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Wl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Md(this._firestore,this._userDataWriter,r.key,r,new Wl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Md(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Wl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Md(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Wl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:TU(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function TU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SU(t){t=gi(t,vn);const e=gi(t.firestore,rl);return nU(jy(e),t._key).then(n=>RU(e,t,n))}class ZC extends EU{constructor(e){super(),this.firestore=e}convertBytes(e){return new $a(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,n)}}function CU(t){t=gi(t,nl);const e=gi(t.firestore,rl),n=jy(e),r=new ZC(e);return _U(t._query),rU(n,t._query).then(i=>new IU(e,r,t,i))}function AU(t,e,n){t=gi(t,vn);const r=gi(t.firestore,rl),i=bU(t.converter,e,n);return eA(r,[fU(HC(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,fn.none())])}function kU(t){return eA(gi(t.firestore,rl),[new Sf(t._key,fn.none())])}function eA(t,e){return function(r,i){const s=new Rr;return r.asyncQueue.enqueueAndForget(async()=>q$(await tU(r),i,s)),s.promise}(jy(t),e)}function RU(t,e,n){const r=n.docs.get(e._key),i=new ZC(t);return new JC(t,i,e._key,r,new Wl(n.hasPendingWrites,n.fromCache),e.converter)}function PU(){return new qy("serverTimestamp")}(function(e,n=!0){(function(i){Ja=i})(Ya),Pr(new mr("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new rl(new i9(r.getProvider("auth-internal")),new l9(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new re(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oo(c.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Gn(Ex,"4.7.3",e),Gn(Ex,"4.7.3","esm2017")})();const tA="@firebase/installations",Yy="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nA=1e4,rA=`w:${Yy}`,iA="FIS_v2",NU="https://firebaseinstallations.googleapis.com/v1",DU=60*60*1e3,VU="installations",OU="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zU={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},fo=new yo(VU,OU,zU);function sA(t){return t instanceof yr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oA({projectId:t}){return`${NU}/projects/${t}/installations`}function aA(t){return{token:t.token,requestStatus:2,expiresIn:MU(t.expiresIn),creationTime:Date.now()}}async function lA(t,e){const r=(await e.json()).error;return fo.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function cA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function LU(t,{refreshToken:e}){const n=cA(t);return n.append("Authorization",jU(e)),n}async function uA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function MU(t){return Number(t.replace("s","000"))}function jU(t){return`${iA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FU({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=oA(t),i=cA(t),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={fid:n,authVersion:iA,appId:t.appId,sdkVersion:rA},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await uA(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:aA(c.authToken)}}else throw await lA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $U(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UU=/^[cdef][\w-]{21}$/,Rg="";function BU(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=HU(t);return UU.test(n)?n:Rg}catch{return Rg}}function HU(t){return $U(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Of(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA=new Map;function fA(t,e){const n=Of(t);pA(n,e),qU(n,e)}function pA(t,e){const n=hA.get(t);if(n)for(const r of n)r(e)}function qU(t,e){const n=KU();n&&n.postMessage({key:t,fid:e}),GU()}let Us=null;function KU(){return!Us&&"BroadcastChannel"in self&&(Us=new BroadcastChannel("[Firebase] FID Change"),Us.onmessage=t=>{pA(t.data.key,t.data.fid)}),Us}function GU(){hA.size===0&&Us&&(Us.close(),Us=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WU="firebase-installations-database",QU=1,po="firebase-installations-store";let $p=null;function Xy(){return $p||($p=fS(WU,QU,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(po)}}})),$p}async function Fh(t,e){const n=Of(t),i=(await Xy()).transaction(po,"readwrite"),s=i.objectStore(po),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&fA(t,e.fid),e}async function mA(t){const e=Of(t),r=(await Xy()).transaction(po,"readwrite");await r.objectStore(po).delete(e),await r.done}async function zf(t,e){const n=Of(t),i=(await Xy()).transaction(po,"readwrite"),s=i.objectStore(po),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&fA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jy(t){let e;const n=await zf(t.appConfig,r=>{const i=YU(r),s=XU(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Rg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function YU(t){const e=t||{fid:BU(),registrationStatus:0};return gA(e)}function XU(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(fo.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=JU(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:ZU(t)}:{installationEntry:e}}async function JU(t,e){try{const n=await FU(t,e);return Fh(t.appConfig,n)}catch(n){throw sA(n)&&n.customData.serverCode===409?await mA(t.appConfig):await Fh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function ZU(t){let e=await R1(t.appConfig);for(;e.registrationStatus===1;)await dA(100),e=await R1(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await Jy(t);return r||n}return e}function R1(t){return zf(t,e=>{if(!e)throw fo.create("installation-not-found");return gA(e)})}function gA(t){return e8(t)?{fid:t.fid,registrationStatus:0}:t}function e8(t){return t.registrationStatus===1&&t.registrationTime+nA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t8({appConfig:t,heartbeatServiceProvider:e},n){const r=n8(t,n),i=LU(t,n),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={installation:{sdkVersion:rA,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await uA(()=>fetch(r,a));if(l.ok){const c=await l.json();return aA(c)}else throw await lA("Generate Auth Token",l)}function n8(t,{fid:e}){return`${oA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zy(t,e=!1){let n;const r=await zf(t.appConfig,s=>{if(!yA(s))throw fo.create("not-registered");const o=s.authToken;if(!e&&s8(o))return s;if(o.requestStatus===1)return n=r8(t,e),s;{if(!navigator.onLine)throw fo.create("app-offline");const a=a8(s);return n=i8(t,a),a}});return n?await n:r.authToken}async function r8(t,e){let n=await P1(t.appConfig);for(;n.authToken.requestStatus===1;)await dA(100),n=await P1(t.appConfig);const r=n.authToken;return r.requestStatus===0?Zy(t,e):r}function P1(t){return zf(t,e=>{if(!yA(e))throw fo.create("not-registered");const n=e.authToken;return l8(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function i8(t,e){try{const n=await t8(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Fh(t.appConfig,r),n}catch(n){if(sA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await mA(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Fh(t.appConfig,r)}throw n}}function yA(t){return t!==void 0&&t.registrationStatus===2}function s8(t){return t.requestStatus===2&&!o8(t)}function o8(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+DU}function a8(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function l8(t){return t.requestStatus===1&&t.requestTime+nA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c8(t){const e=t,{installationEntry:n,registrationPromise:r}=await Jy(e);return r?r.catch(console.error):Zy(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u8(t,e=!1){const n=t;return await d8(n),(await Zy(n,e)).token}async function d8(t){const{registrationPromise:e}=await Jy(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h8(t){if(!t||!t.options)throw Up("App Configuration");if(!t.name)throw Up("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Up(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Up(t){return fo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vA="installations",f8="installations-internal",p8=t=>{const e=t.getProvider("app").getImmediate(),n=h8(e),r=vo(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},m8=t=>{const e=t.getProvider("app").getImmediate(),n=vo(e,vA).getImmediate();return{getId:()=>c8(n),getToken:i=>u8(n,i)}};function g8(){Pr(new mr(vA,p8,"PUBLIC")),Pr(new mr(f8,m8,"PRIVATE"))}g8();Gn(tA,Yy);Gn(tA,Yy,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $h="analytics",y8="firebase_id",v8="origin",_8=60*1e3,w8="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ev="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _n=new mf("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x8={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Dn=new yo("analytics","Analytics",x8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E8(t){if(!t.startsWith(ev)){const e=Dn.create("invalid-gtag-resource",{gtagURL:t});return _n.warn(e.message),""}return t}function _A(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function b8(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function I8(t,e){const n=b8("firebase-js-sdk-policy",{createScriptURL:E8}),r=document.createElement("script"),i=`${ev}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function T8(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function S8(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await _A(n)).find(c=>c.measurementId===i);l&&await e[l.appId]}}catch(a){_n.error(a)}t("config",i,s)}async function C8(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await _A(n);for(const l of o){const c=a.find(h=>h.measurementId===l),d=c&&e[c.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){_n.error(s)}}function A8(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await C8(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await S8(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,c]=o;t("get",a,l,c)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){_n.error(a)}}return i}function k8(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=A8(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function R8(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(ev)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P8=30,N8=1e3;class D8{constructor(e={},n=N8){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const wA=new D8;function V8(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function O8(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:V8(r)},s=w8.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Dn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function z8(t,e=wA,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Dn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Dn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new j8;return setTimeout(async()=>{a.abort()},_8),xA({appId:r,apiKey:i,measurementId:s},o,a,e)}async function xA(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=wA){var s;const{appId:o,measurementId:a}=t;try{await L8(r,e)}catch(l){if(a)return _n.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await O8(t);return i.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!M8(c)){if(i.deleteThrottleMetadata(o),a)return _n.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const d=Number((s=c==null?void 0:c.customData)===null||s===void 0?void 0:s.httpStatus)===503?Gw(n,i.intervalMillis,P8):Gw(n,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return i.setThrottleMetadata(o,h),_n.debug(`Calling attemptFetch again in ${d} millis`),xA(t,h,r,i)}}function L8(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Dn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function M8(t){if(!(t instanceof yr)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class j8{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function F8(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $8(){if(Z0())try{await uS()}catch(t){return _n.warn(Dn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return _n.warn(Dn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function U8(t,e,n,r,i,s,o){var a;const l=z8(t);l.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&_n.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>_n.error(m)),e.push(l);const c=$8().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([l,c]);R8(s)||I8(s,d.measurementId),i("js",new Date);const f=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return f[v8]="firebase",f.update=!0,h!=null&&(f[y8]=h),i("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B8{constructor(e){this.app=e}_delete(){return delete dc[this.app.options.appId],Promise.resolve()}}let dc={},N1=[];const D1={};let Bp="dataLayer",H8="gtag",V1,EA,O1=!1;function q8(){const t=[];if(lS()&&t.push("This is a browser extension environment."),yM()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Dn.create("invalid-analytics-context",{errorInfo:e});_n.warn(n.message)}}function K8(t,e,n){q8();const r=t.options.appId;if(!r)throw Dn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)_n.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Dn.create("no-api-key");if(dc[r]!=null)throw Dn.create("already-exists",{id:r});if(!O1){T8(Bp);const{wrappedGtag:s,gtagCore:o}=k8(dc,N1,D1,Bp,H8);EA=s,V1=o,O1=!0}return dc[r]=U8(t,N1,D1,e,V1,Bp,n),new B8(t)}function G8(t=ty()){t=Nt(t);const e=vo(t,$h);return e.isInitialized()?e.getImmediate():W8(t)}function W8(t,e={}){const n=vo(t,$h);if(n.isInitialized()){const i=n.getImmediate();if(jc(e,n.getOptions()))return i;throw Dn.create("already-initialized")}return n.initialize({options:e})}function Q8(t,e,n,r){t=Nt(t),F8(EA,dc[t.app.options.appId],e,n,r).catch(i=>_n.error(i))}const z1="@firebase/analytics",L1="0.10.8";function Y8(){Pr(new mr($h,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return K8(r,i,n)},"PUBLIC")),Pr(new mr("analytics-internal",t,"PRIVATE")),Gn(z1,L1),Gn(z1,L1,"esm2017");function t(e){try{const n=e.getProvider($h).getImmediate();return{logEvent:(r,i,s)=>Q8(n,r,i,s)}}catch(n){throw Dn.create("interop-component-reg-failed",{reason:n})}}}Y8();const X8={apiKey:"AIzaSyBRvglSh40aRJFOA9SNxoyBhNjslW_7p8k",authDomain:"detective-board-b108b.firebaseapp.com",projectId:"detective-board-b108b",storageBucket:"detective-board-b108b.firebasestorage.app",messagingSenderId:"140107009046",appId:"1:140107009046:web:49e3c650ea0e90a5f2b937",measurementId:"G-TBJ91VEM4Y"},tv=pS(X8);G8(tv);const Ua=J6(tv),Ql=aU(tv);lU(Ql).catch(t=>{t.code=="failed-precondition"?console.warn("Persistencia fallida: Mltiples pestaas abiertas."):t.code=="unimplemented"&&console.warn("Persistencia no soportada por el navegador.")});const J8=new Yr,bA=D.createContext();function nv(){return D.useContext(bA)}function Z8({children:t}){const[e,n]=D.useState(null),[r,i]=D.useState(!0);D.useEffect(()=>Fj(Ua,a=>{n(a),i(!1)}),[]);const s={currentUser:e};return p.jsx(bA.Provider,{value:s,children:!r&&t})}const eB=({onSwitchToSignUp:t,onForgotPassword:e,isDarkMode:n})=>{const[r,i]=D.useState(""),[s,o]=D.useState(""),[a,l]=D.useState(""),c=async h=>{h.preventDefault(),l("");try{await Oj(Ua,r,s)}catch(f){console.error(f),l("Error: "+f.message)}},d=async()=>{l("");try{await a6(Ua,J8)}catch(h){console.error(h),l("Error Google: "+h.message)}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:c,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${n?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${n?"text-white":"text-gray-800"}`,children:"INICIAR SESIN"}),a&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:a}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${n?"text-zinc-400":"text-gray-600"}`,htmlFor:"login-email",children:"Correo"}),p.jsxs("div",{className:"relative",children:[p.jsx(G0,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${n?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"login-email",type:"email",placeholder:"detective@agencia.com",value:r,onChange:h=>i(h.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${n?"text-zinc-400":"text-gray-600"}`,htmlFor:"login-password",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Ra,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${n?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"login-password",type:"password",placeholder:"",value:s,onChange:h=>o(h.target.value),required:!0})]})]}),p.jsxs("div",{className:"flex flex-col gap-4",children:[p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Entrar"}),p.jsxs("div",{className:"relative flex py-1 items-center",children:[p.jsx("div",{className:`flex-grow border-t ${n?"border-zinc-600":"border-gray-300"}`}),p.jsx("span",{className:`flex-shrink mx-2 text-xs ${n?"text-zinc-500":"text-gray-400"}`,children:"O"}),p.jsx("div",{className:`flex-grow border-t ${n?"border-zinc-600":"border-gray-300"}`})]}),p.jsxs("button",{onClick:d,type:"button",className:`flex items-center justify-center gap-3 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-all active:scale-95 ${n?"bg-white text-gray-700 hover:bg-gray-100":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[p.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),p.jsx("div",{className:"text-center mt-6",children:p.jsx("a",{onClick:e,className:"inline-block align-baseline font-bold text-sm text-blue-400 hover:text-blue-300 cursor-pointer",children:"Olvidaste tu contrasea?"})})]}),p.jsxs("p",{className:`text-center text-xs ${n?"text-zinc-500":"text-gray-500"}`,children:["No tienes cuenta?"," ",p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Regstrate aqu."})]})]})},tB=({onSwitchToLogin:t,isDarkMode:e})=>{const[n,r]=D.useState(""),[i,s]=D.useState(""),[o,a]=D.useState(""),[l,c]=D.useState(""),[d,h]=D.useState(""),f=async m=>{if(m.preventDefault(),o!==l)return h("Las contraseas no coinciden.");h("");try{const b=await Vj(Ua,i,o);await Lj(b.user,{displayName:n})}catch(b){console.error(b),b.code==="auth/email-already-in-use"?h("Este correo ya est en uso."):b.code==="auth/weak-password"?h("La contrasea es muy dbil (mnimo 6 caracteres)."):h("Error: "+b.message)}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:f,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${e?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${e?"text-white":"text-gray-800"}`,children:"CREAR CUENTA"}),d&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:d}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-name",children:"Nombre"}),p.jsxs("div",{className:"relative",children:[p.jsx(W0,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-name",type:"text",placeholder:"Sherlock Holmes",value:n,onChange:m=>r(m.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-email",children:"Correo"}),p.jsxs("div",{className:"relative",children:[p.jsx(G0,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-email",type:"email",placeholder:"detective@agencia.com",value:i,onChange:m=>s(m.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-password",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Ra,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-password",type:"password",placeholder:"",value:o,onChange:m=>a(m.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-confirm-password",children:"Confirmar Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Ra,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-confirm-password",type:"password",placeholder:"",value:l,onChange:m=>c(m.target.value),required:!0})]})]}),p.jsx("div",{className:"flex flex-col gap-4",children:p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Registrarse"})})]}),p.jsxs("p",{className:`text-center text-xs ${e?"text-zinc-500":"text-gray-500"}`,children:["Ya tienes una cuenta?"," ",p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Inicia sesin."})]})]})},nB=({onSwitchToLogin:t,isDarkMode:e})=>{const[n,r]=D.useState(""),[i,s]=D.useState(""),[o,a]=D.useState(""),l=async c=>{c.preventDefault(),a(""),s("");try{await Dj(Ua,n),s("Revisa tu correo! Se ha enviado un enlace para restablecer tu contrasea.")}catch{a("Error al enviar el correo. Verifica que la direccin sea correcta.")}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:l,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${e?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${e?"text-white":"text-gray-800"}`,children:"RECUPERAR CONTRASEA"}),o&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:o}),i&&p.jsx("p",{className:"bg-green-900/50 text-green-300 text-xs p-3 rounded mb-4",children:i}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"reset-email",children:"Correo Electrnico"}),p.jsxs("div",{className:"relative",children:[p.jsx(G0,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"reset-email",type:"email",placeholder:"detective@agencia.com",value:n,onChange:c=>r(c.target.value),required:!0})]})]}),p.jsx("div",{className:"flex flex-col gap-4",children:p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Enviar Enlace"})})]}),p.jsx("p",{className:`text-center text-xs ${e?"text-zinc-500":"text-gray-500"}`,children:p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Volver a Iniciar Sesin"})})]})},rB=()=>{const[t,e]=D.useState("login"),[n,r]=D.useState(!0),i=()=>{switch(t){case"signup":return p.jsx(tB,{onSwitchToLogin:()=>e("login"),isDarkMode:n});case"forgot":return p.jsx(nB,{onSwitchToLogin:()=>e("login"),isDarkMode:n});case"login":default:return p.jsx(eB,{onSwitchToSignUp:()=>e("signup"),onForgotPassword:()=>e("forgot"),isDarkMode:n})}};return p.jsxs("div",{className:`w-screen h-screen flex flex-col items-center justify-center p-4 transition-colors duration-500 ${n?"bg-zinc-900":"bg-gray-100"}`,children:[p.jsx("button",{onClick:()=>r(!n),className:`absolute top-4 right-4 p-2 rounded-full transition-colors ${n?"bg-zinc-800 text-yellow-400 hover:bg-zinc-700":"bg-white text-gray-600 hover:bg-gray-200 shadow-sm"}`,children:n?p.jsx(BT,{size:20}):p.jsx(MT,{size:20})}),p.jsx("h1",{className:`text-5xl font-black font-mono mb-8 tracking-[0.2em] uppercase text-center ${n?"text-zinc-500":"text-zinc-400"}`,children:"DETECTIVE BOARD"}),p.jsx("div",{className:"w-full flex justify-center animate-in fade-in slide-in-from-bottom-8 duration-500",children:i()},t)]})},iB=()=>{const{currentUser:t}=nv(),e=D.useCallback(async(s,o)=>{if(!(!t||!s))try{const a=Fp(Ql,"users",t.uid,"boards",s),l=JSON.parse(JSON.stringify(o));await AU(a,{...l,updatedAt:PU(),ownerId:t.uid},{merge:!0})}catch(a){console.error("Error al guardar en Firestore:",a)}},[t]),n=D.useCallback(async s=>{if(!t||!s)return null;try{const o=Fp(Ql,"users",t.uid,"boards",s),a=await SU(o);return a.exists()?a.data():null}catch(o){throw console.error("Error al cargar de Firestore:",o),o}},[t]),r=D.useCallback(async()=>{if(!t)return[];try{const s=oU(Ql,"users",t.uid,"boards"),o=xU(s);return(await CU(o)).docs.map(l=>({id:l.id,...l.data()}))}catch(s){throw console.error("Error al obtener tableros:",s),s}},[t]),i=D.useCallback(async s=>{t&&await kU(Fp(Ql,"users",t.uid,"boards",s))},[t]);return{saveBoard:e,loadBoard:n,getBoards:r,deleteBoard:i}},sB=()=>{var Ur,bs,Ti;const t=D.useRef(null),{currentUser:e}=nv(),[n,r]=D.useState(!1),[i,s,o]=Z5([]),[a,l,c]=eO([]),[d,h]=D.useState(null),[f,m]=D.useState(!1),[b,x]=D.useState(null),[R,y]=D.useState(null),[v,T]=D.useState(null),[A,O]=D.useState({isOpen:!1,title:"",message:"",onConfirm:null,isDanger:!1}),[L,S]=D.useState(!1),[I,w]=D.useState(!1),[E,C]=D.useState(null),[P,k]=D.useState(null),[N,j]=D.useState(!1),z=D.useRef(!1),{saveBoard:B,loadBoard:F,getBoards:M}=iB(),{connectionColor:U,setConnectionColor:G,connectionLineType:$,setConnectionLineType:X,isInteractive:Y,setIsInteractive:ee,isDarkMode:ne,setIsDarkMode:fe,searchTerm:ce,setSearchTerm:xe,isSidebarOpen:ye,setIsSidebarOpen:ke,isZenMode:Re,setIsZenMode:He,bgType:Oe,setBgType:Pe,toggleBackground:ut}=eM("cork"),{nodeTypes:Se,edgeTypes:se,proOptions:Ce,connectionLineStyle:Tt,nodeColor:xn}=GL({connectionColor:U}),{takeSnapshot:dt,undo:Ut,redo:Vt,clearHistory:pt,onNodesChangeWithHistory:De,onEdgesChangeWithHistory:Le,animateAndRemoveNode:St,animateAndRemoveEdge:Yt}=QL({nodes:i,edges:a,setNodes:s,setEdges:l,onNodesChange:o,onEdgesChange:c}),{boards:Xt,setBoards:st,trash:_t,currentBoardId:Ye,setCurrentBoardId:En,handleSwitchBoard:on,handleCreateBoard:bn,handleDeleteBoard:an,handleRestoreBoard:Jn,handlePermanentDelete:wi,handleRenameBoard:vr,handleReorderBoards:Zn,handleCloneBoard:xi}=TL({nodes:i,edges:a,bgType:Oe,setNodes:s,setEdges:l,setBgType:Pe,reactFlowInstance:d,clearHistory:pt,setCaseManagerOpen:r,setConfirmModal:O,lastSaved:R});D.useEffect(()=>{(async()=>{if(e)try{const de=await M();if(de.length>0){const qe=de.map(ze=>{var ht,wr;return{...ze,createdAt:(ht=ze.createdAt)!=null&&ht.toMillis?ze.createdAt.toMillis():ze.createdAt||Date.now(),lastModified:(wr=ze.updatedAt)!=null&&wr.toMillis?ze.updatedAt.toMillis():ze.updatedAt||Date.now()}}).sort((ze,ht)=>ht.lastModified-ze.lastModified);st(qe),(!Ye||!qe.find(ze=>ze.id===Ye))&&En(qe[0].id)}else console.log("No se encontraron tableros remotos.")}catch(de){console.error("Error sincronizando tableros:",de)}})()},[e,M,st,En]),D.useEffect(()=>{(async()=>{if(Ye){j(!0),z.current=!1;try{const de=await F(Ye);de?(s(de.nodes||[]),l(de.edges||[]),de.bgType&&Pe(de.bgType),z.current=!0):(s([]),l([]),z.current=!0)}catch(de){console.error("Error cargando tablero:",de)}finally{j(!1)}}})()},[Ye,F,s,l,Pe]),D.useEffect(()=>{if(N||!z.current)return;const _e=setTimeout(()=>{var de;Ye&&(B(Ye,{nodes:i,edges:a,bgType:Oe,name:((de=Xt.find(qe=>qe.id===Ye))==null?void 0:de.name)||"Caso Sin Nombre"}),y(new Date))},2e3);return()=>clearTimeout(_e)},[i,a,Oe,Ye,B,Xt,N]),D.useEffect(()=>{const _e=de=>{de.preventDefault(),de.returnValue=""};return window.addEventListener("beforeunload",_e),()=>window.removeEventListener("beforeunload",_e)},[]),Rz({isInteractive:Y,reactFlowInstance:d,takeSnapshot:dt,setNodes:s});const{onConnect:In,onEdgeContextMenu:er,onEdgeClick:xo,onPaneClick:zr,onNodeDoubleClick:Eo,onNodeDragStart:Lr,onMoveStart:bo,onMoveEnd:wt,selectionRect:tr,handleRightPointerDown:Mr}=XL({isInteractive:Y,reactFlowInstance:d,reactFlowWrapper:t,setEdges:l,setNodes:s,connectionLineType:$,connectionColor:U,takeSnapshot:dt,setEditingNode:x,setEditingEdge:C,setInputModalOpen:w,setEditModalOpen:m,setMenu:T});D.useEffect(()=>{const _e=de=>{de.key==="Escape"&&Re&&He(!1)};return window.addEventListener("keydown",_e),()=>window.removeEventListener("keydown",_e)},[Re]);const{handleSaveNode:jr,handleDeleteNode:il,duplicateSelected:sl,handleConnectionColorChange:_r,handleConnectionLineTypeChange:ol,handleEdgeDelete:al,handleInputModalConfirm:Ei}=tM({reactFlowInstance:d,setNodes:s,setEdges:l,takeSnapshot:dt,animateAndRemoveNode:St,animateAndRemoveEdge:Yt,setEditModalOpen:m,setEditingNode:x,setEditingEdge:C,setInputModalOpen:w,setConnectionColor:G,setConnectionLineType:X,setPendingStampNodeId:k}),{onDragOver:ws,onDrop:xs}=CL({isInteractive:Y,reactFlowInstance:d,setNodes:s,takeSnapshot:dt,setPendingStampNodeId:k,setInputModalOpen:w,setEditingEdge:C,setEditingNode:x}),{onSave:Fr,onLoad:jn,onClear:Io}=JL({reactFlowInstance:d,boards:Xt,currentBoardId:Ye,bgType:Oe,setBoards:st,setNodes:s,setEdges:l,setBgType:Pe,handleSwitchBoard:on,clearHistory:pt,takeSnapshot:dt,setConfirmModal:O}),{navigateSearch:bi}=ZL({searchTerm:ce,setNodes:s,reactFlowInstance:d}),Ii=K.useCallback(()=>{dt(),s(_e=>{const de=_e.filter(ze=>ze.selected);if(de.length===0)return _e;const qe=de.some(ze=>!ze.data.locked);return _e.map(ze=>ze.selected?{...ze,data:{...ze.data,locked:qe},draggable:!qe}:ze)})},[s,dt]);D.useEffect(()=>{const _e=de=>{["INPUT","TEXTAREA","SELECT"].includes(de.target.tagName)||de.target.isContentEditable||(de.ctrlKey||de.metaKey)&&de.shiftKey&&de.key.toLowerCase()==="l"&&(de.preventDefault(),Ii())};return window.addEventListener("keydown",_e),()=>window.removeEventListener("keydown",_e)},[Ii]),D.useEffect(()=>{const _e=i.filter(de=>de.selected).map(de=>de.id);l(de=>{let qe=!1;const ze=de.map(ht=>{var So;const wr=_e.includes(ht.source)||_e.includes(ht.target),Br=(So=ht.className)==null?void 0:So.includes("animated-flow");if(wr&&!Br){qe=!0;const cl=(ht.className||"").replace("quick-draw","").trim();return{...ht,className:`${cl} animated-flow`.trim()}}else if(!wr&&Br)return qe=!0,{...ht,className:(ht.className||"").replace("animated-flow","").trim()};return ht});return qe?ze:de})},[i,l]),D.useEffect(()=>{if(a.some(de=>{var qe;return(qe=de.className)==null?void 0:qe.includes("quick-draw")})){const de=setTimeout(()=>{l(qe=>qe.map(ze=>{var ht;return(ht=ze.className)!=null&&ht.includes("quick-draw")?{...ze,className:ze.className.replace("quick-draw","").trim()}:ze}))},1e3);return()=>clearTimeout(de)}},[a,l]);const{isExporting:Es,onExport:To}=bL({reactFlowWrapper:t,reactFlowInstance:d,boards:Xt,currentBoardId:Ye,bgType:Oe,isDarkMode:ne,setNodes:s});SL({onSave:Fr,undo:Ut,redo:Vt,duplicateSelected:sl,navigateSearch:bi,reactFlowInstance:d,edges:a,setEdges:l,takeSnapshot:dt,connectionLineType:$,connectionColor:U});const $r=Xt.find(_e=>_e.id===Ye),ll=async()=>{try{await $j(Ua)}catch(_e){console.error("Error al cerrar sesin",_e)}};return p.jsx("div",{className:`flex h-screen w-screen transition-colors duration-500 ease-in-out ${ne?"bg-[#1a1a1a]":"bg-gray-50 light-mode"}`,children:p.jsx(tS.Provider,{value:ne,children:p.jsxs(U0,{children:[!Re&&p.jsx(vz,{connectionColor:U,setConnectionColor:_r,connectionLineType:$,setConnectionLineType:ol,lastSaved:R,onSave:Fr,onLoad:jn,onClear:Io,onHelp:()=>S(!0),isDarkMode:ne,toggleTheme:()=>fe(!ne),searchTerm:ce,setSearchTerm:xe,onExport:To,isOpen:ye,onToggle:()=>ke(!ye),onOpenCaseManager:()=>r(!0),currentBoardName:$r==null?void 0:$r.name,onToggleZen:()=>He(!0),onNextMatch:()=>bi("next"),onPrevMatch:()=>bi("prev"),onToggleBg:ut,onLogout:ll,currentUser:e,isSyncing:N}),p.jsxs("div",{className:"flex-grow h-full relative overflow-hidden",ref:t,style:{"--connection-color":U},onPointerDown:Mr,onContextMenu:_e=>_e.preventDefault(),children:[p.jsx(kz,{isZenMode:Re,setIsZenMode:He,undo:Ut,redo:Vt,isDarkMode:ne}),p.jsxs(IT,{nodes:i,edges:a,onNodesChange:De,onEdgesChange:Le,onConnect:In,onInit:h,onDrop:xs,onDragOver:ws,onNodeDoubleClick:Eo,onEdgeClick:xo,onEdgeContextMenu:er,onPaneClick:zr,nodeTypes:Se,edgeTypes:se,fitView:!0,className:`${Oe==="cork"?"cork-pattern":Oe==="blackboard"?"blackboard-pattern":"graph-paper-pattern"} ${Y?"":"board-locked"} ${ne?"":"light-mode"}`,connectionLineType:$,connectionLineStyle:Tt,nodesDraggable:Y,proOptions:Ce,elevateNodesOnSelect:!1,nodesConnectable:Y,elementsSelectable:Y,panOnDrag:Y,zoomOnScroll:Y,zoomOnPinch:Y,panOnScroll:Y,zoomOnDoubleClick:Y,onNodeDragStart:Lr,onMoveStart:bo,onMoveEnd:wt,connectionRadius:30,children:[!Re&&p.jsx(yO,{showInteractive:!0,onInteractiveChange:ee,fitViewOptions:{duration:800,padding:.2},style:{left:ye?"340px":"10px",transition:"left 0.2s ease-in-out"}}),!Re&&p.jsx(uO,{nodeColor:xn,maskColor:ne?"rgba(0, 0, 0, 0.6)":"rgba(0, 0, 0, 0.1)",className:ne?"bg-zinc-900 border border-zinc-800":"bg-white border border-gray-200 shadow-md"}),p.jsx(bO,{gap:20,size:1,color:ne?"#444":"#aaa",variant:"dots",className:"opacity-20"}),v&&p.jsx(Iz,{onClick:zr,...v,onHide:()=>T(null),takeSnapshot:dt,setNodes:s}),i.length===0&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-10 select-none",children:p.jsxs("div",{className:`text-center ${ne?"opacity-10":"opacity-20"}`,children:[p.jsx("h1",{className:"text-5xl md:text-7xl font-black text-zinc-500 font-mono mb-4 tracking-[0.2em] uppercase",children:"CONFIDENCIAL"}),p.jsx("p",{className:"text-sm text-zinc-500 font-mono uppercase tracking-widest",children:"Arrastra evidencia o haz doble clic"})]})}),p.jsx("svg",{style:{position:"absolute",top:0,left:0,width:0,height:0,pointerEvents:"none"},children:p.jsx("defs",{children:p.jsxs("filter",{id:"yarn-texture",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[p.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.8",numOctaves:"3",result:"noise"}),p.jsx("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"1.5"})]})})})]}),p.jsx("div",{className:"absolute inset-0 pointer-events-none z-[5] bg-[radial-gradient(circle_at_center,transparent_40%,rgba(0,0,0,0.6)_100%)]"}),Es&&p.jsxs("div",{className:"absolute inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center backdrop-blur-sm animate-in fade-in duration-200 cursor-wait",children:[p.jsx("div",{className:"w-16 h-16 border-4 border-red-600 border-t-transparent rounded-full animate-spin mb-4"}),p.jsx("h2",{className:"text-xl font-bold text-white font-mono tracking-widest animate-pulse",children:"REVELANDO EVIDENCIA..."}),p.jsx("p",{className:"text-zinc-400 text-xs font-mono mt-2",children:"Procesando fotografa del tablero completo."})]}),tr&&tr.isDragging&&p.jsx("div",{className:"absolute z-50 pointer-events-none",style:{left:`${tr.x}px`,top:`${tr.y}px`,width:`${tr.width}px`,height:`${tr.height}px`,border:"2px dashed #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)"}})]}),p.jsx(_z,{isOpen:f,onClose:()=>m(!1),node:b,onSave:jr,onDelete:il,isDarkMode:ne}),p.jsx(Tz,{isOpen:A.isOpen,onClose:()=>O(_e=>({..._e,isOpen:!1})),onConfirm:A.onConfirm,title:A.title,message:A.message,isDanger:A.isDanger,confirmText:A.confirmText,cancelText:A.cancelText,isDarkMode:ne}),p.jsx(Sz,{isOpen:L,onClose:()=>S(!1),isDarkMode:ne}),p.jsx(Cz,{isOpen:I,onClose:()=>{w(!1),C(null),x(null),k(null)},onConfirm:(_e,de,qe)=>Ei(_e,de,qe,E,b,P),onDelete:()=>{P?(dt(),s(_e=>_e.map(de=>de.id===P?{...de,data:{...de.data,status:null}}:de)),w(!1),k(null)):al(E,b)},title:E?"EDITAR CONEXIN":P?"CREAR SELLO":"EDITAR ZONA",initialValue:E?E.label||"":P?"":((Ur=b==null?void 0:b.data)==null?void 0:Ur.label)||"",initialColor:E?((bs=E.style)==null?void 0:bs.stroke)||"#dc2626":P?"#dc2626":((Ti=b==null?void 0:b.style)==null?void 0:Ti.borderColor)||"#71717a",initialType:E==null?void 0:E.type,showTypeSelector:!!E,colorLabel:E?"Color del Hilo":P?"Color del Sello":"Color de Zona",placeholder:P?"Texto del sello (ej: CONFIRMADO)":"Escribe una etiqueta...",isDarkMode:ne}),p.jsx(Az,{isOpen:n,onClose:()=>r(!1),boards:Xt,currentBoardId:Ye,onSwitch:on,onCreate:bn,onDelete:an,onRename:vr,onClone:xi,onReorder:Zn,trash:_t,onRestore:Jn,onPermanentDelete:wi,isDarkMode:ne})]})})})},oB=()=>{const{currentUser:t}=nv();return D.useEffect(()=>{document.title="Detective Board";const e="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%23dc2626%22%20stroke-width%3D%222.5%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Ccircle%20cx%3D%2211%22%20cy%3D%2211%22%20r%3D%228%22%3E%3C%2Fcircle%3E%3Cline%20x1%3D%2221%22%20y1%3D%2221%22%20x2%3D%2216.65%22%20y2%3D%2216.65%22%3E%3C%2Fline%3E%3C%2Fsvg%3E";let n=document.querySelector("link[rel~='icon']");n||(n=document.createElement("link"),n.rel="icon",document.head.appendChild(n)),n.href=e},[]),t?p.jsx(sB,{}):p.jsx(rB,{})};Hp.createRoot(document.getElementById("root")).render(p.jsx(K.StrictMode,{children:p.jsx(Z8,{children:p.jsx(oB,{})})}));
