(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function aE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var lE={exports:{}},Af={},cE={exports:{}},Re={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Su=Symbol.for("react.element"),Vk=Symbol.for("react.portal"),Ok=Symbol.for("react.fragment"),Lk=Symbol.for("react.strict_mode"),zk=Symbol.for("react.profiler"),Mk=Symbol.for("react.provider"),jk=Symbol.for("react.context"),Fk=Symbol.for("react.forward_ref"),$k=Symbol.for("react.suspense"),Uk=Symbol.for("react.memo"),Bk=Symbol.for("react.lazy"),Fw=Symbol.iterator;function qk(t){return t===null||typeof t!="object"?null:(t=Fw&&t[Fw]||t["@@iterator"],typeof t=="function"?t:null)}var uE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},dE=Object.assign,hE={};function fl(t,e,n){this.props=t,this.context=e,this.refs=hE,this.updater=n||uE}fl.prototype.isReactComponent={};fl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};fl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function fE(){}fE.prototype=fl.prototype;function N0(t,e,n){this.props=t,this.context=e,this.refs=hE,this.updater=n||uE}var P0=N0.prototype=new fE;P0.constructor=N0;dE(P0,fl.prototype);P0.isPureReactComponent=!0;var $w=Array.isArray,pE=Object.prototype.hasOwnProperty,D0={current:null},mE={key:!0,ref:!0,__self:!0,__source:!0};function gE(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)pE.call(e,r)&&!mE.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Su,type:t,key:s,ref:o,props:i,_owner:D0.current}}function Hk(t,e){return{$$typeof:Su,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function V0(t){return typeof t=="object"&&t!==null&&t.$$typeof===Su}function Kk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Uw=/\/+/g;function Np(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Kk(""+t.key):e.toString(36)}function Bd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Su:case Vk:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Np(o,0):r,$w(i)?(n="",t!=null&&(n=t.replace(Uw,"$&/")+"/"),Bd(i,e,n,"",function(c){return c})):i!=null&&(V0(i)&&(i=Hk(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Uw,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",$w(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Np(s,a);o+=Bd(s,e,n,l,i)}else if(l=qk(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Np(s,a++),o+=Bd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function sd(t,e,n){if(t==null)return t;var r=[],i=0;return Bd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function Wk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var un={current:null},qd={transition:null},Gk={ReactCurrentDispatcher:un,ReactCurrentBatchConfig:qd,ReactCurrentOwner:D0};function yE(){throw Error("act(...) is not supported in production builds of React.")}Re.Children={map:sd,forEach:function(t,e,n){sd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return sd(t,function(){e++}),e},toArray:function(t){return sd(t,function(e){return e})||[]},only:function(t){if(!V0(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Re.Component=fl;Re.Fragment=Ok;Re.Profiler=zk;Re.PureComponent=N0;Re.StrictMode=Lk;Re.Suspense=$k;Re.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Gk;Re.act=yE;Re.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=dE({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=D0.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)pE.call(e,l)&&!mE.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Su,type:t.type,key:i,ref:s,props:r,_owner:o}};Re.createContext=function(t){return t={$$typeof:jk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Mk,_context:t},t.Consumer=t};Re.createElement=gE;Re.createFactory=function(t){var e=gE.bind(null,t);return e.type=t,e};Re.createRef=function(){return{current:null}};Re.forwardRef=function(t){return{$$typeof:Fk,render:t}};Re.isValidElement=V0;Re.lazy=function(t){return{$$typeof:Bk,_payload:{_status:-1,_result:t},_init:Wk}};Re.memo=function(t,e){return{$$typeof:Uk,type:t,compare:e===void 0?null:e}};Re.startTransition=function(t){var e=qd.transition;qd.transition={};try{t()}finally{qd.transition=e}};Re.unstable_act=yE;Re.useCallback=function(t,e){return un.current.useCallback(t,e)};Re.useContext=function(t){return un.current.useContext(t)};Re.useDebugValue=function(){};Re.useDeferredValue=function(t){return un.current.useDeferredValue(t)};Re.useEffect=function(t,e){return un.current.useEffect(t,e)};Re.useId=function(){return un.current.useId()};Re.useImperativeHandle=function(t,e,n){return un.current.useImperativeHandle(t,e,n)};Re.useInsertionEffect=function(t,e){return un.current.useInsertionEffect(t,e)};Re.useLayoutEffect=function(t,e){return un.current.useLayoutEffect(t,e)};Re.useMemo=function(t,e){return un.current.useMemo(t,e)};Re.useReducer=function(t,e,n){return un.current.useReducer(t,e,n)};Re.useRef=function(t){return un.current.useRef(t)};Re.useState=function(t){return un.current.useState(t)};Re.useSyncExternalStore=function(t,e,n){return un.current.useSyncExternalStore(t,e,n)};Re.useTransition=function(){return un.current.useTransition()};Re.version="18.3.1";cE.exports=Re;var D=cE.exports;const G=aE(D);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qk=D,Yk=Symbol.for("react.element"),Xk=Symbol.for("react.fragment"),Jk=Object.prototype.hasOwnProperty,Zk=Qk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,eN={key:!0,ref:!0,__self:!0,__source:!0};function vE(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Jk.call(e,r)&&!eN.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Yk,type:t,key:s,ref:o,props:i,_owner:Zk.current}}Af.Fragment=Xk;Af.jsx=vE;Af.jsxs=vE;lE.exports=Af;var p=lE.exports,Mm={},wE={exports:{}},Qn={},_E={exports:{}},xE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(j,M){var B=j.length;j.push(M);e:for(;0<B;){var K=B-1>>>1,U=j[K];if(0<i(U,M))j[K]=M,j[B]=U,B=K;else break e}}function n(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var M=j[0],B=j.pop();if(B!==M){j[0]=B;e:for(var K=0,U=j.length,X=U>>>1;K<X;){var J=2*(K+1)-1,te=j[J],ae=J+1,pe=j[ae];if(0>i(te,B))ae<U&&0>i(pe,te)?(j[K]=pe,j[ae]=B,K=ae):(j[K]=te,j[J]=B,K=J);else if(ae<U&&0>i(pe,B))j[K]=pe,j[ae]=B,K=ae;else break e}}return M}function i(j,M){var B=j.sortIndex-M.sortIndex;return B!==0?B:j.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,h=null,f=3,m=!1,v=!1,w=!1,T=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(j){for(var M=n(c);M!==null;){if(M.callback===null)r(c);else if(M.startTime<=j)r(c),M.sortIndex=M.expirationTime,e(l,M);else break;M=n(c)}}function C(j){if(w=!1,S(j),!v)if(n(l)!==null)v=!0,L(O);else{var M=n(c);M!==null&&$(C,M.startTime-j)}}function O(j,M){v=!1,w&&(w=!1,y(E),E=-1),m=!0;var B=f;try{for(S(M),h=n(l);h!==null&&(!(h.expirationTime>M)||j&&!k());){var K=h.callback;if(typeof K=="function"){h.callback=null,f=h.priorityLevel;var U=K(h.expirationTime<=M);M=t.unstable_now(),typeof U=="function"?h.callback=U:h===n(l)&&r(l),S(M)}else r(l);h=n(l)}if(h!==null)var X=!0;else{var J=n(c);J!==null&&$(C,J.startTime-M),X=!1}return X}finally{h=null,f=B,m=!1}}var z=!1,A=null,E=-1,b=5,I=-1;function k(){return!(t.unstable_now()-I<b)}function N(){if(A!==null){var j=t.unstable_now();I=j;var M=!0;try{M=A(!0,j)}finally{M?R():(z=!1,A=null)}}else z=!1}var R;if(typeof _=="function")R=function(){_(N)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,F=P.port2;P.port1.onmessage=N,R=function(){F.postMessage(null)}}else R=function(){T(N,0)};function L(j){A=j,z||(z=!0,R())}function $(j,M){E=T(function(){j(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(j){j.callback=null},t.unstable_continueExecution=function(){v||m||(v=!0,L(O))},t.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<j?Math.floor(1e3/j):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(j){switch(f){case 1:case 2:case 3:var M=3;break;default:M=f}var B=f;f=M;try{return j()}finally{f=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(j,M){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var B=f;f=j;try{return M()}finally{f=B}},t.unstable_scheduleCallback=function(j,M,B){var K=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?K+B:K):B=K,j){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=B+U,j={id:d++,callback:M,priorityLevel:j,startTime:B,expirationTime:U,sortIndex:-1},B>K?(j.sortIndex=B,e(c,j),n(l)===null&&j===n(c)&&(w?(y(E),E=-1):w=!0,$(C,B-K))):(j.sortIndex=U,e(l,j),v||m||(v=!0,L(O))),j},t.unstable_shouldYield=k,t.unstable_wrapCallback=function(j){var M=f;return function(){var B=f;f=M;try{return j.apply(this,arguments)}finally{f=B}}}})(xE);_E.exports=xE;var tN=_E.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nN=D,Kn=tN;function ee(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var bE=new Set,jc={};function Co(t,e){Fa(t,e),Fa(t+"Capture",e)}function Fa(t,e){for(jc[t]=e,t=0;t<e.length;t++)bE.add(e[t])}var vi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jm=Object.prototype.hasOwnProperty,rN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Bw={},qw={};function iN(t){return jm.call(qw,t)?!0:jm.call(Bw,t)?!1:rN.test(t)?qw[t]=!0:(Bw[t]=!0,!1)}function sN(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function oN(t,e,n,r){if(e===null||typeof e>"u"||sN(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function dn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Gt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Gt[t]=new dn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Gt[e]=new dn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Gt[t]=new dn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Gt[t]=new dn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Gt[t]=new dn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Gt[t]=new dn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Gt[t]=new dn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Gt[t]=new dn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Gt[t]=new dn(t,5,!1,t.toLowerCase(),null,!1,!1)});var O0=/[\-:]([a-z])/g;function L0(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(O0,L0);Gt[e]=new dn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(O0,L0);Gt[e]=new dn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(O0,L0);Gt[e]=new dn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Gt[t]=new dn(t,1,!1,t.toLowerCase(),null,!1,!1)});Gt.xlinkHref=new dn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Gt[t]=new dn(t,1,!1,t.toLowerCase(),null,!0,!0)});function z0(t,e,n,r){var i=Gt.hasOwnProperty(e)?Gt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(oN(e,n,i,r)&&(n=null),r||i===null?iN(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Ai=nN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,od=Symbol.for("react.element"),fa=Symbol.for("react.portal"),pa=Symbol.for("react.fragment"),M0=Symbol.for("react.strict_mode"),Fm=Symbol.for("react.profiler"),EE=Symbol.for("react.provider"),IE=Symbol.for("react.context"),j0=Symbol.for("react.forward_ref"),$m=Symbol.for("react.suspense"),Um=Symbol.for("react.suspense_list"),F0=Symbol.for("react.memo"),$i=Symbol.for("react.lazy"),SE=Symbol.for("react.offscreen"),Hw=Symbol.iterator;function Bl(t){return t===null||typeof t!="object"?null:(t=Hw&&t[Hw]||t["@@iterator"],typeof t=="function"?t:null)}var ct=Object.assign,Pp;function lc(t){if(Pp===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Pp=e&&e[1]||""}return`
`+Pp+t}var Dp=!1;function Vp(t,e){if(!t||Dp)return"";Dp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Dp=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?lc(t):""}function aN(t){switch(t.tag){case 5:return lc(t.type);case 16:return lc("Lazy");case 13:return lc("Suspense");case 19:return lc("SuspenseList");case 0:case 2:case 15:return t=Vp(t.type,!1),t;case 11:return t=Vp(t.type.render,!1),t;case 1:return t=Vp(t.type,!0),t;default:return""}}function Bm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case pa:return"Fragment";case fa:return"Portal";case Fm:return"Profiler";case M0:return"StrictMode";case $m:return"Suspense";case Um:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case IE:return(t.displayName||"Context")+".Consumer";case EE:return(t._context.displayName||"Context")+".Provider";case j0:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case F0:return e=t.displayName||null,e!==null?e:Bm(t.type)||"Memo";case $i:e=t._payload,t=t._init;try{return Bm(t(e))}catch{}}return null}function lN(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Bm(e);case 8:return e===M0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ms(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function TE(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function cN(t){var e=TE(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function ad(t){t._valueTracker||(t._valueTracker=cN(t))}function AE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=TE(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function xh(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function qm(t,e){var n=e.checked;return ct({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Kw(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=ms(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function CE(t,e){e=e.checked,e!=null&&z0(t,"checked",e,!1)}function Hm(t,e){CE(t,e);var n=ms(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Km(t,e.type,n):e.hasOwnProperty("defaultValue")&&Km(t,e.type,ms(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Ww(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Km(t,e,n){(e!=="number"||xh(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var cc=Array.isArray;function Ta(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+ms(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function Wm(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return ct({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Gw(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ee(92));if(cc(n)){if(1<n.length)throw Error(ee(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ms(n)}}function RE(t,e){var n=ms(e.value),r=ms(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Qw(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function kE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Gm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?kE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var ld,NE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(ld=ld||document.createElement("div"),ld.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=ld.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Fc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var bc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uN=["Webkit","ms","Moz","O"];Object.keys(bc).forEach(function(t){uN.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),bc[e]=bc[t]})});function PE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||bc.hasOwnProperty(t)&&bc[t]?(""+e).trim():e+"px"}function DE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=PE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var dN=ct({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Qm(t,e){if(e){if(dN[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function Ym(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xm=null;function $0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Jm=null,Aa=null,Ca=null;function Yw(t){if(t=Cu(t)){if(typeof Jm!="function")throw Error(ee(280));var e=t.stateNode;e&&(e=Pf(e),Jm(t.stateNode,t.type,e))}}function VE(t){Aa?Ca?Ca.push(t):Ca=[t]:Aa=t}function OE(){if(Aa){var t=Aa,e=Ca;if(Ca=Aa=null,Yw(t),e)for(t=0;t<e.length;t++)Yw(e[t])}}function LE(t,e){return t(e)}function zE(){}var Op=!1;function ME(t,e,n){if(Op)return t(e,n);Op=!0;try{return LE(t,e,n)}finally{Op=!1,(Aa!==null||Ca!==null)&&(zE(),OE())}}function $c(t,e){var n=t.stateNode;if(n===null)return null;var r=Pf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ee(231,e,typeof n));return n}var Zm=!1;if(vi)try{var ql={};Object.defineProperty(ql,"passive",{get:function(){Zm=!0}}),window.addEventListener("test",ql,ql),window.removeEventListener("test",ql,ql)}catch{Zm=!1}function hN(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Ec=!1,bh=null,Eh=!1,eg=null,fN={onError:function(t){Ec=!0,bh=t}};function pN(t,e,n,r,i,s,o,a,l){Ec=!1,bh=null,hN.apply(fN,arguments)}function mN(t,e,n,r,i,s,o,a,l){if(pN.apply(this,arguments),Ec){if(Ec){var c=bh;Ec=!1,bh=null}else throw Error(ee(198));Eh||(Eh=!0,eg=c)}}function Ro(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function jE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Xw(t){if(Ro(t)!==t)throw Error(ee(188))}function gN(t){var e=t.alternate;if(!e){if(e=Ro(t),e===null)throw Error(ee(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Xw(i),t;if(s===r)return Xw(i),e;s=s.sibling}throw Error(ee(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(ee(189))}}if(n.alternate!==r)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?t:e}function FE(t){return t=gN(t),t!==null?$E(t):null}function $E(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$E(t);if(e!==null)return e;t=t.sibling}return null}var UE=Kn.unstable_scheduleCallback,Jw=Kn.unstable_cancelCallback,yN=Kn.unstable_shouldYield,vN=Kn.unstable_requestPaint,gt=Kn.unstable_now,wN=Kn.unstable_getCurrentPriorityLevel,U0=Kn.unstable_ImmediatePriority,BE=Kn.unstable_UserBlockingPriority,Ih=Kn.unstable_NormalPriority,_N=Kn.unstable_LowPriority,qE=Kn.unstable_IdlePriority,Cf=null,Ur=null;function xN(t){if(Ur&&typeof Ur.onCommitFiberRoot=="function")try{Ur.onCommitFiberRoot(Cf,t,void 0,(t.current.flags&128)===128)}catch{}}var Er=Math.clz32?Math.clz32:IN,bN=Math.log,EN=Math.LN2;function IN(t){return t>>>=0,t===0?32:31-(bN(t)/EN|0)|0}var cd=64,ud=4194304;function uc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Sh(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=uc(a):(s&=o,s!==0&&(r=uc(s)))}else o=n&~i,o!==0?r=uc(o):s!==0&&(r=uc(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Er(e),i=1<<n,r|=t[n],e&=~i;return r}function SN(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TN(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-Er(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=SN(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function tg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function HE(){var t=cd;return cd<<=1,!(cd&4194240)&&(cd=64),t}function Lp(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Tu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Er(e),t[e]=n}function AN(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-Er(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function B0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Er(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var qe=0;function KE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var WE,q0,GE,QE,YE,ng=!1,dd=[],ts=null,ns=null,rs=null,Uc=new Map,Bc=new Map,Hi=[],CN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zw(t,e){switch(t){case"focusin":case"focusout":ts=null;break;case"dragenter":case"dragleave":ns=null;break;case"mouseover":case"mouseout":rs=null;break;case"pointerover":case"pointerout":Uc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bc.delete(e.pointerId)}}function Hl(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=Cu(e),e!==null&&q0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function RN(t,e,n,r,i){switch(e){case"focusin":return ts=Hl(ts,t,e,n,r,i),!0;case"dragenter":return ns=Hl(ns,t,e,n,r,i),!0;case"mouseover":return rs=Hl(rs,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return Uc.set(s,Hl(Uc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Bc.set(s,Hl(Bc.get(s)||null,t,e,n,r,i)),!0}return!1}function XE(t){var e=Ks(t.target);if(e!==null){var n=Ro(e);if(n!==null){if(e=n.tag,e===13){if(e=jE(n),e!==null){t.blockedOn=e,YE(t.priority,function(){GE(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Hd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=rg(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Xm=r,n.target.dispatchEvent(r),Xm=null}else return e=Cu(n),e!==null&&q0(e),t.blockedOn=n,!1;e.shift()}return!0}function e_(t,e,n){Hd(t)&&n.delete(e)}function kN(){ng=!1,ts!==null&&Hd(ts)&&(ts=null),ns!==null&&Hd(ns)&&(ns=null),rs!==null&&Hd(rs)&&(rs=null),Uc.forEach(e_),Bc.forEach(e_)}function Kl(t,e){t.blockedOn===e&&(t.blockedOn=null,ng||(ng=!0,Kn.unstable_scheduleCallback(Kn.unstable_NormalPriority,kN)))}function qc(t){function e(i){return Kl(i,t)}if(0<dd.length){Kl(dd[0],t);for(var n=1;n<dd.length;n++){var r=dd[n];r.blockedOn===t&&(r.blockedOn=null)}}for(ts!==null&&Kl(ts,t),ns!==null&&Kl(ns,t),rs!==null&&Kl(rs,t),Uc.forEach(e),Bc.forEach(e),n=0;n<Hi.length;n++)r=Hi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Hi.length&&(n=Hi[0],n.blockedOn===null);)XE(n),n.blockedOn===null&&Hi.shift()}var Ra=Ai.ReactCurrentBatchConfig,Th=!0;function NN(t,e,n,r){var i=qe,s=Ra.transition;Ra.transition=null;try{qe=1,H0(t,e,n,r)}finally{qe=i,Ra.transition=s}}function PN(t,e,n,r){var i=qe,s=Ra.transition;Ra.transition=null;try{qe=4,H0(t,e,n,r)}finally{qe=i,Ra.transition=s}}function H0(t,e,n,r){if(Th){var i=rg(t,e,n,r);if(i===null)Kp(t,e,r,Ah,n),Zw(t,r);else if(RN(i,t,e,n,r))r.stopPropagation();else if(Zw(t,r),e&4&&-1<CN.indexOf(t)){for(;i!==null;){var s=Cu(i);if(s!==null&&WE(s),s=rg(t,e,n,r),s===null&&Kp(t,e,r,Ah,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Kp(t,e,r,null,n)}}var Ah=null;function rg(t,e,n,r){if(Ah=null,t=$0(r),t=Ks(t),t!==null)if(e=Ro(t),e===null)t=null;else if(n=e.tag,n===13){if(t=jE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ah=t,null}function JE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wN()){case U0:return 1;case BE:return 4;case Ih:case _N:return 16;case qE:return 536870912;default:return 16}default:return 16}}var Ji=null,K0=null,Kd=null;function ZE(){if(Kd)return Kd;var t,e=K0,n=e.length,r,i="value"in Ji?Ji.value:Ji.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return Kd=i.slice(t,1<r?1-r:void 0)}function Wd(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function hd(){return!0}function t_(){return!1}function Yn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?hd:t_,this.isPropagationStopped=t_,this}return ct(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=hd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=hd)},persist:function(){},isPersistent:hd}),e}var pl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},W0=Yn(pl),Au=ct({},pl,{view:0,detail:0}),DN=Yn(Au),zp,Mp,Wl,Rf=ct({},Au,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:G0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Wl&&(Wl&&t.type==="mousemove"?(zp=t.screenX-Wl.screenX,Mp=t.screenY-Wl.screenY):Mp=zp=0,Wl=t),zp)},movementY:function(t){return"movementY"in t?t.movementY:Mp}}),n_=Yn(Rf),VN=ct({},Rf,{dataTransfer:0}),ON=Yn(VN),LN=ct({},Au,{relatedTarget:0}),jp=Yn(LN),zN=ct({},pl,{animationName:0,elapsedTime:0,pseudoElement:0}),MN=Yn(zN),jN=ct({},pl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),FN=Yn(jN),$N=ct({},pl,{data:0}),r_=Yn($N),UN={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},BN={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qN={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HN(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=qN[t])?!!e[t]:!1}function G0(){return HN}var KN=ct({},Au,{key:function(t){if(t.key){var e=UN[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Wd(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?BN[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:G0,charCode:function(t){return t.type==="keypress"?Wd(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Wd(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),WN=Yn(KN),GN=ct({},Rf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),i_=Yn(GN),QN=ct({},Au,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:G0}),YN=Yn(QN),XN=ct({},pl,{propertyName:0,elapsedTime:0,pseudoElement:0}),JN=Yn(XN),ZN=ct({},Rf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),eP=Yn(ZN),tP=[9,13,27,32],Q0=vi&&"CompositionEvent"in window,Ic=null;vi&&"documentMode"in document&&(Ic=document.documentMode);var nP=vi&&"TextEvent"in window&&!Ic,eI=vi&&(!Q0||Ic&&8<Ic&&11>=Ic),s_=" ",o_=!1;function tI(t,e){switch(t){case"keyup":return tP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nI(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var ma=!1;function rP(t,e){switch(t){case"compositionend":return nI(e);case"keypress":return e.which!==32?null:(o_=!0,s_);case"textInput":return t=e.data,t===s_&&o_?null:t;default:return null}}function iP(t,e){if(ma)return t==="compositionend"||!Q0&&tI(t,e)?(t=ZE(),Kd=K0=Ji=null,ma=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return eI&&e.locale!=="ko"?null:e.data;default:return null}}var sP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function a_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!sP[t.type]:e==="textarea"}function rI(t,e,n,r){VE(r),e=Ch(e,"onChange"),0<e.length&&(n=new W0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Sc=null,Hc=null;function oP(t){pI(t,0)}function kf(t){var e=va(t);if(AE(e))return t}function aP(t,e){if(t==="change")return e}var iI=!1;if(vi){var Fp;if(vi){var $p="oninput"in document;if(!$p){var l_=document.createElement("div");l_.setAttribute("oninput","return;"),$p=typeof l_.oninput=="function"}Fp=$p}else Fp=!1;iI=Fp&&(!document.documentMode||9<document.documentMode)}function c_(){Sc&&(Sc.detachEvent("onpropertychange",sI),Hc=Sc=null)}function sI(t){if(t.propertyName==="value"&&kf(Hc)){var e=[];rI(e,Hc,t,$0(t)),ME(oP,e)}}function lP(t,e,n){t==="focusin"?(c_(),Sc=e,Hc=n,Sc.attachEvent("onpropertychange",sI)):t==="focusout"&&c_()}function cP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return kf(Hc)}function uP(t,e){if(t==="click")return kf(e)}function dP(t,e){if(t==="input"||t==="change")return kf(e)}function hP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ar=typeof Object.is=="function"?Object.is:hP;function Kc(t,e){if(Ar(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!jm.call(e,i)||!Ar(t[i],e[i]))return!1}return!0}function u_(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function d_(t,e){var n=u_(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=u_(n)}}function oI(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?oI(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function aI(){for(var t=window,e=xh();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=xh(t.document)}return e}function Y0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function fP(t){var e=aI(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&oI(n.ownerDocument.documentElement,n)){if(r!==null&&Y0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=d_(n,s);var o=d_(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var pP=vi&&"documentMode"in document&&11>=document.documentMode,ga=null,ig=null,Tc=null,sg=!1;function h_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;sg||ga==null||ga!==xh(r)||(r=ga,"selectionStart"in r&&Y0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Tc&&Kc(Tc,r)||(Tc=r,r=Ch(ig,"onSelect"),0<r.length&&(e=new W0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ga)))}function fd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ya={animationend:fd("Animation","AnimationEnd"),animationiteration:fd("Animation","AnimationIteration"),animationstart:fd("Animation","AnimationStart"),transitionend:fd("Transition","TransitionEnd")},Up={},lI={};vi&&(lI=document.createElement("div").style,"AnimationEvent"in window||(delete ya.animationend.animation,delete ya.animationiteration.animation,delete ya.animationstart.animation),"TransitionEvent"in window||delete ya.transitionend.transition);function Nf(t){if(Up[t])return Up[t];if(!ya[t])return t;var e=ya[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in lI)return Up[t]=e[n];return t}var cI=Nf("animationend"),uI=Nf("animationiteration"),dI=Nf("animationstart"),hI=Nf("transitionend"),fI=new Map,f_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xs(t,e){fI.set(t,e),Co(e,[t])}for(var Bp=0;Bp<f_.length;Bp++){var qp=f_[Bp],mP=qp.toLowerCase(),gP=qp[0].toUpperCase()+qp.slice(1);xs(mP,"on"+gP)}xs(cI,"onAnimationEnd");xs(uI,"onAnimationIteration");xs(dI,"onAnimationStart");xs("dblclick","onDoubleClick");xs("focusin","onFocus");xs("focusout","onBlur");xs(hI,"onTransitionEnd");Fa("onMouseEnter",["mouseout","mouseover"]);Fa("onMouseLeave",["mouseout","mouseover"]);Fa("onPointerEnter",["pointerout","pointerover"]);Fa("onPointerLeave",["pointerout","pointerover"]);Co("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Co("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Co("onBeforeInput",["compositionend","keypress","textInput","paste"]);Co("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Co("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Co("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yP=new Set("cancel close invalid load scroll toggle".split(" ").concat(dc));function p_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,mN(r,e,void 0,t),t.currentTarget=null}function pI(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;p_(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;p_(i,a,c),s=l}}}if(Eh)throw t=eg,Eh=!1,eg=null,t}function et(t,e){var n=e[ug];n===void 0&&(n=e[ug]=new Set);var r=t+"__bubble";n.has(r)||(mI(e,t,2,!1),n.add(r))}function Hp(t,e,n){var r=0;e&&(r|=4),mI(n,t,r,e)}var pd="_reactListening"+Math.random().toString(36).slice(2);function Wc(t){if(!t[pd]){t[pd]=!0,bE.forEach(function(n){n!=="selectionchange"&&(yP.has(n)||Hp(n,!1,t),Hp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[pd]||(e[pd]=!0,Hp("selectionchange",!1,e))}}function mI(t,e,n,r){switch(JE(e)){case 1:var i=NN;break;case 4:i=PN;break;default:i=H0}n=i.bind(null,e,n,t),i=void 0,!Zm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function Kp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ks(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}ME(function(){var c=s,d=$0(n),h=[];e:{var f=fI.get(t);if(f!==void 0){var m=W0,v=t;switch(t){case"keypress":if(Wd(n)===0)break e;case"keydown":case"keyup":m=WN;break;case"focusin":v="focus",m=jp;break;case"focusout":v="blur",m=jp;break;case"beforeblur":case"afterblur":m=jp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=n_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=ON;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=YN;break;case cI:case uI:case dI:m=MN;break;case hI:m=JN;break;case"scroll":m=DN;break;case"wheel":m=eP;break;case"copy":case"cut":case"paste":m=FN;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=i_}var w=(e&4)!==0,T=!w&&t==="scroll",y=w?f!==null?f+"Capture":null:f;w=[];for(var _=c,S;_!==null;){S=_;var C=S.stateNode;if(S.tag===5&&C!==null&&(S=C,y!==null&&(C=$c(_,y),C!=null&&w.push(Gc(_,C,S)))),T)break;_=_.return}0<w.length&&(f=new m(f,v,null,n,d),h.push({event:f,listeners:w}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==Xm&&(v=n.relatedTarget||n.fromElement)&&(Ks(v)||v[wi]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(v=n.relatedTarget||n.toElement,m=c,v=v?Ks(v):null,v!==null&&(T=Ro(v),v!==T||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=c),m!==v)){if(w=n_,C="onMouseLeave",y="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(w=i_,C="onPointerLeave",y="onPointerEnter",_="pointer"),T=m==null?f:va(m),S=v==null?f:va(v),f=new w(C,_+"leave",m,n,d),f.target=T,f.relatedTarget=S,C=null,Ks(d)===c&&(w=new w(y,_+"enter",v,n,d),w.target=S,w.relatedTarget=T,C=w),T=C,m&&v)t:{for(w=m,y=v,_=0,S=w;S;S=Yo(S))_++;for(S=0,C=y;C;C=Yo(C))S++;for(;0<_-S;)w=Yo(w),_--;for(;0<S-_;)y=Yo(y),S--;for(;_--;){if(w===y||y!==null&&w===y.alternate)break t;w=Yo(w),y=Yo(y)}w=null}else w=null;m!==null&&m_(h,f,m,w,!1),v!==null&&T!==null&&m_(h,T,v,w,!0)}}e:{if(f=c?va(c):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var O=aP;else if(a_(f))if(iI)O=dP;else{O=cP;var z=lP}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=uP);if(O&&(O=O(t,c))){rI(h,O,n,d);break e}z&&z(t,f,c),t==="focusout"&&(z=f._wrapperState)&&z.controlled&&f.type==="number"&&Km(f,"number",f.value)}switch(z=c?va(c):window,t){case"focusin":(a_(z)||z.contentEditable==="true")&&(ga=z,ig=c,Tc=null);break;case"focusout":Tc=ig=ga=null;break;case"mousedown":sg=!0;break;case"contextmenu":case"mouseup":case"dragend":sg=!1,h_(h,n,d);break;case"selectionchange":if(pP)break;case"keydown":case"keyup":h_(h,n,d)}var A;if(Q0)e:{switch(t){case"compositionstart":var E="onCompositionStart";break e;case"compositionend":E="onCompositionEnd";break e;case"compositionupdate":E="onCompositionUpdate";break e}E=void 0}else ma?tI(t,n)&&(E="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(E="onCompositionStart");E&&(eI&&n.locale!=="ko"&&(ma||E!=="onCompositionStart"?E==="onCompositionEnd"&&ma&&(A=ZE()):(Ji=d,K0="value"in Ji?Ji.value:Ji.textContent,ma=!0)),z=Ch(c,E),0<z.length&&(E=new r_(E,t,null,n,d),h.push({event:E,listeners:z}),A?E.data=A:(A=nI(n),A!==null&&(E.data=A)))),(A=nP?rP(t,n):iP(t,n))&&(c=Ch(c,"onBeforeInput"),0<c.length&&(d=new r_("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=A))}pI(h,e)})}function Gc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Ch(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=$c(t,n),s!=null&&r.unshift(Gc(t,s,i)),s=$c(t,e),s!=null&&r.push(Gc(t,s,i))),t=t.return}return r}function Yo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function m_(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=$c(n,s),l!=null&&o.unshift(Gc(n,l,a))):i||(l=$c(n,s),l!=null&&o.push(Gc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var vP=/\r\n?/g,wP=/\u0000|\uFFFD/g;function g_(t){return(typeof t=="string"?t:""+t).replace(vP,`
`).replace(wP,"")}function md(t,e,n){if(e=g_(e),g_(t)!==e&&n)throw Error(ee(425))}function Rh(){}var og=null,ag=null;function lg(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var cg=typeof setTimeout=="function"?setTimeout:void 0,_P=typeof clearTimeout=="function"?clearTimeout:void 0,y_=typeof Promise=="function"?Promise:void 0,xP=typeof queueMicrotask=="function"?queueMicrotask:typeof y_<"u"?function(t){return y_.resolve(null).then(t).catch(bP)}:cg;function bP(t){setTimeout(function(){throw t})}function Wp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),qc(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);qc(e)}function is(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function v_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ml=Math.random().toString(36).slice(2),jr="__reactFiber$"+ml,Qc="__reactProps$"+ml,wi="__reactContainer$"+ml,ug="__reactEvents$"+ml,EP="__reactListeners$"+ml,IP="__reactHandles$"+ml;function Ks(t){var e=t[jr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[wi]||n[jr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=v_(t);t!==null;){if(n=t[jr])return n;t=v_(t)}return e}t=n,n=t.parentNode}return null}function Cu(t){return t=t[jr]||t[wi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function va(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ee(33))}function Pf(t){return t[Qc]||null}var dg=[],wa=-1;function bs(t){return{current:t}}function tt(t){0>wa||(t.current=dg[wa],dg[wa]=null,wa--)}function Qe(t,e){wa++,dg[wa]=t.current,t.current=e}var gs={},rn=bs(gs),bn=bs(!1),ao=gs;function $a(t,e){var n=t.type.contextTypes;if(!n)return gs;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function En(t){return t=t.childContextTypes,t!=null}function kh(){tt(bn),tt(rn)}function w_(t,e,n){if(rn.current!==gs)throw Error(ee(168));Qe(rn,e),Qe(bn,n)}function gI(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(ee(108,lN(t)||"Unknown",i));return ct({},n,r)}function Nh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||gs,ao=rn.current,Qe(rn,t),Qe(bn,bn.current),!0}function __(t,e,n){var r=t.stateNode;if(!r)throw Error(ee(169));n?(t=gI(t,e,ao),r.__reactInternalMemoizedMergedChildContext=t,tt(bn),tt(rn),Qe(rn,t)):tt(bn),Qe(bn,n)}var si=null,Df=!1,Gp=!1;function yI(t){si===null?si=[t]:si.push(t)}function SP(t){Df=!0,yI(t)}function Es(){if(!Gp&&si!==null){Gp=!0;var t=0,e=qe;try{var n=si;for(qe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}si=null,Df=!1}catch(i){throw si!==null&&(si=si.slice(t+1)),UE(U0,Es),i}finally{qe=e,Gp=!1}}return null}var _a=[],xa=0,Ph=null,Dh=0,tr=[],nr=0,lo=null,ai=1,li="";function zs(t,e){_a[xa++]=Dh,_a[xa++]=Ph,Ph=t,Dh=e}function vI(t,e,n){tr[nr++]=ai,tr[nr++]=li,tr[nr++]=lo,lo=t;var r=ai;t=li;var i=32-Er(r)-1;r&=~(1<<i),n+=1;var s=32-Er(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ai=1<<32-Er(e)+i|n<<i|r,li=s+t}else ai=1<<s|n<<i|r,li=t}function X0(t){t.return!==null&&(zs(t,1),vI(t,1,0))}function J0(t){for(;t===Ph;)Ph=_a[--xa],_a[xa]=null,Dh=_a[--xa],_a[xa]=null;for(;t===lo;)lo=tr[--nr],tr[nr]=null,li=tr[--nr],tr[nr]=null,ai=tr[--nr],tr[nr]=null}var Bn=null,$n=null,rt=!1,_r=null;function wI(t,e){var n=rr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function x_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bn=t,$n=is(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bn=t,$n=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=lo!==null?{id:ai,overflow:li}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=rr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bn=t,$n=null,!0):!1;default:return!1}}function hg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function fg(t){if(rt){var e=$n;if(e){var n=e;if(!x_(t,e)){if(hg(t))throw Error(ee(418));e=is(n.nextSibling);var r=Bn;e&&x_(t,e)?wI(r,n):(t.flags=t.flags&-4097|2,rt=!1,Bn=t)}}else{if(hg(t))throw Error(ee(418));t.flags=t.flags&-4097|2,rt=!1,Bn=t}}}function b_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bn=t}function gd(t){if(t!==Bn)return!1;if(!rt)return b_(t),rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!lg(t.type,t.memoizedProps)),e&&(e=$n)){if(hg(t))throw _I(),Error(ee(418));for(;e;)wI(t,e),e=is(e.nextSibling)}if(b_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ee(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$n=is(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$n=null}}else $n=Bn?is(t.stateNode.nextSibling):null;return!0}function _I(){for(var t=$n;t;)t=is(t.nextSibling)}function Ua(){$n=Bn=null,rt=!1}function Z0(t){_r===null?_r=[t]:_r.push(t)}var TP=Ai.ReactCurrentBatchConfig;function Gl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var r=n.stateNode}if(!r)throw Error(ee(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,t))}return t}function yd(t,e){throw t=Object.prototype.toString.call(e),Error(ee(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function E_(t){var e=t._init;return e(t._payload)}function xI(t){function e(y,_){if(t){var S=y.deletions;S===null?(y.deletions=[_],y.flags|=16):S.push(_)}}function n(y,_){if(!t)return null;for(;_!==null;)e(y,_),_=_.sibling;return null}function r(y,_){for(y=new Map;_!==null;)_.key!==null?y.set(_.key,_):y.set(_.index,_),_=_.sibling;return y}function i(y,_){return y=ls(y,_),y.index=0,y.sibling=null,y}function s(y,_,S){return y.index=S,t?(S=y.alternate,S!==null?(S=S.index,S<_?(y.flags|=2,_):S):(y.flags|=2,_)):(y.flags|=1048576,_)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,_,S,C){return _===null||_.tag!==6?(_=tm(S,y.mode,C),_.return=y,_):(_=i(_,S),_.return=y,_)}function l(y,_,S,C){var O=S.type;return O===pa?d(y,_,S.props.children,C,S.key):_!==null&&(_.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===$i&&E_(O)===_.type)?(C=i(_,S.props),C.ref=Gl(y,_,S),C.return=y,C):(C=eh(S.type,S.key,S.props,null,y.mode,C),C.ref=Gl(y,_,S),C.return=y,C)}function c(y,_,S,C){return _===null||_.tag!==4||_.stateNode.containerInfo!==S.containerInfo||_.stateNode.implementation!==S.implementation?(_=nm(S,y.mode,C),_.return=y,_):(_=i(_,S.children||[]),_.return=y,_)}function d(y,_,S,C,O){return _===null||_.tag!==7?(_=to(S,y.mode,C,O),_.return=y,_):(_=i(_,S),_.return=y,_)}function h(y,_,S){if(typeof _=="string"&&_!==""||typeof _=="number")return _=tm(""+_,y.mode,S),_.return=y,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case od:return S=eh(_.type,_.key,_.props,null,y.mode,S),S.ref=Gl(y,null,_),S.return=y,S;case fa:return _=nm(_,y.mode,S),_.return=y,_;case $i:var C=_._init;return h(y,C(_._payload),S)}if(cc(_)||Bl(_))return _=to(_,y.mode,S,null),_.return=y,_;yd(y,_)}return null}function f(y,_,S,C){var O=_!==null?_.key:null;if(typeof S=="string"&&S!==""||typeof S=="number")return O!==null?null:a(y,_,""+S,C);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case od:return S.key===O?l(y,_,S,C):null;case fa:return S.key===O?c(y,_,S,C):null;case $i:return O=S._init,f(y,_,O(S._payload),C)}if(cc(S)||Bl(S))return O!==null?null:d(y,_,S,C,null);yd(y,S)}return null}function m(y,_,S,C,O){if(typeof C=="string"&&C!==""||typeof C=="number")return y=y.get(S)||null,a(_,y,""+C,O);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case od:return y=y.get(C.key===null?S:C.key)||null,l(_,y,C,O);case fa:return y=y.get(C.key===null?S:C.key)||null,c(_,y,C,O);case $i:var z=C._init;return m(y,_,S,z(C._payload),O)}if(cc(C)||Bl(C))return y=y.get(S)||null,d(_,y,C,O,null);yd(_,C)}return null}function v(y,_,S,C){for(var O=null,z=null,A=_,E=_=0,b=null;A!==null&&E<S.length;E++){A.index>E?(b=A,A=null):b=A.sibling;var I=f(y,A,S[E],C);if(I===null){A===null&&(A=b);break}t&&A&&I.alternate===null&&e(y,A),_=s(I,_,E),z===null?O=I:z.sibling=I,z=I,A=b}if(E===S.length)return n(y,A),rt&&zs(y,E),O;if(A===null){for(;E<S.length;E++)A=h(y,S[E],C),A!==null&&(_=s(A,_,E),z===null?O=A:z.sibling=A,z=A);return rt&&zs(y,E),O}for(A=r(y,A);E<S.length;E++)b=m(A,y,E,S[E],C),b!==null&&(t&&b.alternate!==null&&A.delete(b.key===null?E:b.key),_=s(b,_,E),z===null?O=b:z.sibling=b,z=b);return t&&A.forEach(function(k){return e(y,k)}),rt&&zs(y,E),O}function w(y,_,S,C){var O=Bl(S);if(typeof O!="function")throw Error(ee(150));if(S=O.call(S),S==null)throw Error(ee(151));for(var z=O=null,A=_,E=_=0,b=null,I=S.next();A!==null&&!I.done;E++,I=S.next()){A.index>E?(b=A,A=null):b=A.sibling;var k=f(y,A,I.value,C);if(k===null){A===null&&(A=b);break}t&&A&&k.alternate===null&&e(y,A),_=s(k,_,E),z===null?O=k:z.sibling=k,z=k,A=b}if(I.done)return n(y,A),rt&&zs(y,E),O;if(A===null){for(;!I.done;E++,I=S.next())I=h(y,I.value,C),I!==null&&(_=s(I,_,E),z===null?O=I:z.sibling=I,z=I);return rt&&zs(y,E),O}for(A=r(y,A);!I.done;E++,I=S.next())I=m(A,y,E,I.value,C),I!==null&&(t&&I.alternate!==null&&A.delete(I.key===null?E:I.key),_=s(I,_,E),z===null?O=I:z.sibling=I,z=I);return t&&A.forEach(function(N){return e(y,N)}),rt&&zs(y,E),O}function T(y,_,S,C){if(typeof S=="object"&&S!==null&&S.type===pa&&S.key===null&&(S=S.props.children),typeof S=="object"&&S!==null){switch(S.$$typeof){case od:e:{for(var O=S.key,z=_;z!==null;){if(z.key===O){if(O=S.type,O===pa){if(z.tag===7){n(y,z.sibling),_=i(z,S.props.children),_.return=y,y=_;break e}}else if(z.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===$i&&E_(O)===z.type){n(y,z.sibling),_=i(z,S.props),_.ref=Gl(y,z,S),_.return=y,y=_;break e}n(y,z);break}else e(y,z);z=z.sibling}S.type===pa?(_=to(S.props.children,y.mode,C,S.key),_.return=y,y=_):(C=eh(S.type,S.key,S.props,null,y.mode,C),C.ref=Gl(y,_,S),C.return=y,y=C)}return o(y);case fa:e:{for(z=S.key;_!==null;){if(_.key===z)if(_.tag===4&&_.stateNode.containerInfo===S.containerInfo&&_.stateNode.implementation===S.implementation){n(y,_.sibling),_=i(_,S.children||[]),_.return=y,y=_;break e}else{n(y,_);break}else e(y,_);_=_.sibling}_=nm(S,y.mode,C),_.return=y,y=_}return o(y);case $i:return z=S._init,T(y,_,z(S._payload),C)}if(cc(S))return v(y,_,S,C);if(Bl(S))return w(y,_,S,C);yd(y,S)}return typeof S=="string"&&S!==""||typeof S=="number"?(S=""+S,_!==null&&_.tag===6?(n(y,_.sibling),_=i(_,S),_.return=y,y=_):(n(y,_),_=tm(S,y.mode,C),_.return=y,y=_),o(y)):n(y,_)}return T}var Ba=xI(!0),bI=xI(!1),Vh=bs(null),Oh=null,ba=null,ey=null;function ty(){ey=ba=Oh=null}function ny(t){var e=Vh.current;tt(Vh),t._currentValue=e}function pg(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function ka(t,e){Oh=t,ey=ba=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(vn=!0),t.firstContext=null)}function lr(t){var e=t._currentValue;if(ey!==t)if(t={context:t,memoizedValue:e,next:null},ba===null){if(Oh===null)throw Error(ee(308));ba=t,Oh.dependencies={lanes:0,firstContext:t}}else ba=ba.next=t;return e}var Ws=null;function ry(t){Ws===null?Ws=[t]:Ws.push(t)}function EI(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,ry(e)):(n.next=i.next,i.next=n),e.interleaved=n,_i(t,r)}function _i(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ui=!1;function iy(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function II(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function mi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function ss(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Le&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,_i(t,n)}return i=r.interleaved,i===null?(e.next=e,ry(r)):(e.next=i.next,i.next=e),r.interleaved=e,_i(t,n)}function Gd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,B0(t,n)}}function I_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Lh(t,e,n,r){var i=t.updateQueue;Ui=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,d=c=l=null,a=s;do{var f=a.lane,m=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=t,w=a;switch(f=e,m=n,w.tag){case 1:if(v=w.payload,typeof v=="function"){h=v.call(m,h,f);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=w.payload,f=typeof v=="function"?v.call(m,h,f):v,f==null)break e;h=ct({},h,f);break e;case 2:Ui=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else m={eventTime:m,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=m,l=h):d=d.next=m,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);uo|=o,t.lanes=o,t.memoizedState=h}}function S_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ee(191,i));i.call(r)}}}var Ru={},Br=bs(Ru),Yc=bs(Ru),Xc=bs(Ru);function Gs(t){if(t===Ru)throw Error(ee(174));return t}function sy(t,e){switch(Qe(Xc,e),Qe(Yc,t),Qe(Br,Ru),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Gm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Gm(e,t)}tt(Br),Qe(Br,e)}function qa(){tt(Br),tt(Yc),tt(Xc)}function SI(t){Gs(Xc.current);var e=Gs(Br.current),n=Gm(e,t.type);e!==n&&(Qe(Yc,t),Qe(Br,n))}function oy(t){Yc.current===t&&(tt(Br),tt(Yc))}var st=bs(0);function zh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Qp=[];function ay(){for(var t=0;t<Qp.length;t++)Qp[t]._workInProgressVersionPrimary=null;Qp.length=0}var Qd=Ai.ReactCurrentDispatcher,Yp=Ai.ReactCurrentBatchConfig,co=0,at=null,At=null,jt=null,Mh=!1,Ac=!1,Jc=0,AP=0;function Xt(){throw Error(ee(321))}function ly(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ar(t[n],e[n]))return!1;return!0}function cy(t,e,n,r,i,s){if(co=s,at=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Qd.current=t===null||t.memoizedState===null?NP:PP,t=n(r,i),Ac){s=0;do{if(Ac=!1,Jc=0,25<=s)throw Error(ee(301));s+=1,jt=At=null,e.updateQueue=null,Qd.current=DP,t=n(r,i)}while(Ac)}if(Qd.current=jh,e=At!==null&&At.next!==null,co=0,jt=At=at=null,Mh=!1,e)throw Error(ee(300));return t}function uy(){var t=Jc!==0;return Jc=0,t}function Mr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?at.memoizedState=jt=t:jt=jt.next=t,jt}function cr(){if(At===null){var t=at.alternate;t=t!==null?t.memoizedState:null}else t=At.next;var e=jt===null?at.memoizedState:jt.next;if(e!==null)jt=e,At=t;else{if(t===null)throw Error(ee(310));At=t,t={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},jt===null?at.memoizedState=jt=t:jt=jt.next=t}return jt}function Zc(t,e){return typeof e=="function"?e(t):e}function Xp(t){var e=cr(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=At,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((co&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,at.lanes|=d,uo|=d}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,Ar(r,e.memoizedState)||(vn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,at.lanes|=s,uo|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Jp(t){var e=cr(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);Ar(s,e.memoizedState)||(vn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function TI(){}function AI(t,e){var n=at,r=cr(),i=e(),s=!Ar(r.memoizedState,i);if(s&&(r.memoizedState=i,vn=!0),r=r.queue,dy(kI.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||jt!==null&&jt.memoizedState.tag&1){if(n.flags|=2048,eu(9,RI.bind(null,n,r,i,e),void 0,null),Ft===null)throw Error(ee(349));co&30||CI(n,e,i)}return i}function CI(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=at.updateQueue,e===null?(e={lastEffect:null,stores:null},at.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function RI(t,e,n,r){e.value=n,e.getSnapshot=r,NI(e)&&PI(t)}function kI(t,e,n){return n(function(){NI(e)&&PI(t)})}function NI(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ar(t,n)}catch{return!0}}function PI(t){var e=_i(t,1);e!==null&&Ir(e,t,1,-1)}function T_(t){var e=Mr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Zc,lastRenderedState:t},e.queue=t,t=t.dispatch=kP.bind(null,at,t),[e.memoizedState,t]}function eu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=at.updateQueue,e===null?(e={lastEffect:null,stores:null},at.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function DI(){return cr().memoizedState}function Yd(t,e,n,r){var i=Mr();at.flags|=t,i.memoizedState=eu(1|e,n,void 0,r===void 0?null:r)}function Vf(t,e,n,r){var i=cr();r=r===void 0?null:r;var s=void 0;if(At!==null){var o=At.memoizedState;if(s=o.destroy,r!==null&&ly(r,o.deps)){i.memoizedState=eu(e,n,s,r);return}}at.flags|=t,i.memoizedState=eu(1|e,n,s,r)}function A_(t,e){return Yd(8390656,8,t,e)}function dy(t,e){return Vf(2048,8,t,e)}function VI(t,e){return Vf(4,2,t,e)}function OI(t,e){return Vf(4,4,t,e)}function LI(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function zI(t,e,n){return n=n!=null?n.concat([t]):null,Vf(4,4,LI.bind(null,e,t),n)}function hy(){}function MI(t,e){var n=cr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ly(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function jI(t,e){var n=cr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&ly(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function FI(t,e,n){return co&21?(Ar(n,e)||(n=HE(),at.lanes|=n,uo|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,vn=!0),t.memoizedState=n)}function CP(t,e){var n=qe;qe=n!==0&&4>n?n:4,t(!0);var r=Yp.transition;Yp.transition={};try{t(!1),e()}finally{qe=n,Yp.transition=r}}function $I(){return cr().memoizedState}function RP(t,e,n){var r=as(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},UI(t))BI(e,n);else if(n=EI(t,e,n,r),n!==null){var i=an();Ir(n,t,r,i),qI(n,e,r)}}function kP(t,e,n){var r=as(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(UI(t))BI(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,Ar(a,o)){var l=e.interleaved;l===null?(i.next=i,ry(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=EI(t,e,i,r),n!==null&&(i=an(),Ir(n,t,r,i),qI(n,e,r))}}function UI(t){var e=t.alternate;return t===at||e!==null&&e===at}function BI(t,e){Ac=Mh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function qI(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,B0(t,n)}}var jh={readContext:lr,useCallback:Xt,useContext:Xt,useEffect:Xt,useImperativeHandle:Xt,useInsertionEffect:Xt,useLayoutEffect:Xt,useMemo:Xt,useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:Xt,useDeferredValue:Xt,useTransition:Xt,useMutableSource:Xt,useSyncExternalStore:Xt,useId:Xt,unstable_isNewReconciler:!1},NP={readContext:lr,useCallback:function(t,e){return Mr().memoizedState=[t,e===void 0?null:e],t},useContext:lr,useEffect:A_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Yd(4194308,4,LI.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Yd(4194308,4,t,e)},useInsertionEffect:function(t,e){return Yd(4,2,t,e)},useMemo:function(t,e){var n=Mr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Mr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=RP.bind(null,at,t),[r.memoizedState,t]},useRef:function(t){var e=Mr();return t={current:t},e.memoizedState=t},useState:T_,useDebugValue:hy,useDeferredValue:function(t){return Mr().memoizedState=t},useTransition:function(){var t=T_(!1),e=t[0];return t=CP.bind(null,t[1]),Mr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=at,i=Mr();if(rt){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=e(),Ft===null)throw Error(ee(349));co&30||CI(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,A_(kI.bind(null,r,s,t),[t]),r.flags|=2048,eu(9,RI.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Mr(),e=Ft.identifierPrefix;if(rt){var n=li,r=ai;n=(r&~(1<<32-Er(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Jc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=AP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},PP={readContext:lr,useCallback:MI,useContext:lr,useEffect:dy,useImperativeHandle:zI,useInsertionEffect:VI,useLayoutEffect:OI,useMemo:jI,useReducer:Xp,useRef:DI,useState:function(){return Xp(Zc)},useDebugValue:hy,useDeferredValue:function(t){var e=cr();return FI(e,At.memoizedState,t)},useTransition:function(){var t=Xp(Zc)[0],e=cr().memoizedState;return[t,e]},useMutableSource:TI,useSyncExternalStore:AI,useId:$I,unstable_isNewReconciler:!1},DP={readContext:lr,useCallback:MI,useContext:lr,useEffect:dy,useImperativeHandle:zI,useInsertionEffect:VI,useLayoutEffect:OI,useMemo:jI,useReducer:Jp,useRef:DI,useState:function(){return Jp(Zc)},useDebugValue:hy,useDeferredValue:function(t){var e=cr();return At===null?e.memoizedState=t:FI(e,At.memoizedState,t)},useTransition:function(){var t=Jp(Zc)[0],e=cr().memoizedState;return[t,e]},useMutableSource:TI,useSyncExternalStore:AI,useId:$I,unstable_isNewReconciler:!1};function yr(t,e){if(t&&t.defaultProps){e=ct({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function mg(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:ct({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Of={isMounted:function(t){return(t=t._reactInternals)?Ro(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=an(),i=as(t),s=mi(r,i);s.payload=e,n!=null&&(s.callback=n),e=ss(t,s,i),e!==null&&(Ir(e,t,i,r),Gd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=an(),i=as(t),s=mi(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=ss(t,s,i),e!==null&&(Ir(e,t,i,r),Gd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=an(),r=as(t),i=mi(n,r);i.tag=2,e!=null&&(i.callback=e),e=ss(t,i,r),e!==null&&(Ir(e,t,r,n),Gd(e,t,r))}};function C_(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Kc(n,r)||!Kc(i,s):!0}function HI(t,e,n){var r=!1,i=gs,s=e.contextType;return typeof s=="object"&&s!==null?s=lr(s):(i=En(e)?ao:rn.current,r=e.contextTypes,s=(r=r!=null)?$a(t,i):gs),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Of,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function R_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Of.enqueueReplaceState(e,e.state,null)}function gg(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},iy(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=lr(s):(s=En(e)?ao:rn.current,i.context=$a(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(mg(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&Of.enqueueReplaceState(i,i.state,null),Lh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Ha(t,e){try{var n="",r=e;do n+=aN(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function Zp(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function yg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var VP=typeof WeakMap=="function"?WeakMap:Map;function KI(t,e,n){n=mi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){$h||($h=!0,Ag=r),yg(t,e)},n}function WI(t,e,n){n=mi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){yg(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){yg(t,e),typeof r!="function"&&(os===null?os=new Set([this]):os.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function k_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new VP;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=GP.bind(null,t,e,n),e.then(t,t))}function N_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function P_(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=mi(-1,1),e.tag=2,ss(n,e,1))),n.lanes|=1),t)}var OP=Ai.ReactCurrentOwner,vn=!1;function on(t,e,n,r){e.child=t===null?bI(e,null,n,r):Ba(e,t.child,n,r)}function D_(t,e,n,r,i){n=n.render;var s=e.ref;return ka(e,i),r=cy(t,e,n,r,s,i),n=uy(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,xi(t,e,i)):(rt&&n&&X0(e),e.flags|=1,on(t,e,r,i),e.child)}function V_(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!_y(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,GI(t,e,s,r,i)):(t=eh(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Kc,n(o,r)&&t.ref===e.ref)return xi(t,e,i)}return e.flags|=1,t=ls(s,r),t.ref=e.ref,t.return=e,e.child=t}function GI(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Kc(s,r)&&t.ref===e.ref)if(vn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(vn=!0);else return e.lanes=t.lanes,xi(t,e,i)}return vg(t,e,n,r,i)}function QI(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Qe(Ia,Mn),Mn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Qe(Ia,Mn),Mn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Qe(Ia,Mn),Mn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,Qe(Ia,Mn),Mn|=r;return on(t,e,i,n),e.child}function YI(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function vg(t,e,n,r,i){var s=En(n)?ao:rn.current;return s=$a(e,s),ka(e,i),n=cy(t,e,n,r,s,i),r=uy(),t!==null&&!vn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,xi(t,e,i)):(rt&&r&&X0(e),e.flags|=1,on(t,e,n,i),e.child)}function O_(t,e,n,r,i){if(En(n)){var s=!0;Nh(e)}else s=!1;if(ka(e,i),e.stateNode===null)Xd(t,e),HI(e,n,r),gg(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=lr(c):(c=En(n)?ao:rn.current,c=$a(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&R_(e,o,r,c),Ui=!1;var f=e.memoizedState;o.state=f,Lh(e,r,o,i),l=e.memoizedState,a!==r||f!==l||bn.current||Ui?(typeof d=="function"&&(mg(e,n,d,r),l=e.memoizedState),(a=Ui||C_(e,n,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,II(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:yr(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=lr(l):(l=En(n)?ao:rn.current,l=$a(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&R_(e,o,r,l),Ui=!1,f=e.memoizedState,o.state=f,Lh(e,r,o,i);var v=e.memoizedState;a!==h||f!==v||bn.current||Ui?(typeof m=="function"&&(mg(e,n,m,r),v=e.memoizedState),(c=Ui||C_(e,n,c,r,f,v,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),o.props=r,o.state=v,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return wg(t,e,n,r,s,i)}function wg(t,e,n,r,i,s){YI(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&__(e,n,!1),xi(t,e,s);r=e.stateNode,OP.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ba(e,t.child,null,s),e.child=Ba(e,null,a,s)):on(t,e,a,s),e.memoizedState=r.state,i&&__(e,n,!0),e.child}function XI(t){var e=t.stateNode;e.pendingContext?w_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&w_(t,e.context,!1),sy(t,e.containerInfo)}function L_(t,e,n,r,i){return Ua(),Z0(i),e.flags|=256,on(t,e,n,r),e.child}var _g={dehydrated:null,treeContext:null,retryLane:0};function xg(t){return{baseLanes:t,cachePool:null,transitions:null}}function JI(t,e,n){var r=e.pendingProps,i=st.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),Qe(st,i&1),t===null)return fg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Mf(o,r,0,null),t=to(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=xg(n),e.memoizedState=_g,t):fy(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return LP(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=ls(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=ls(a,s):(s=to(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?xg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=_g,r}return s=t.child,t=s.sibling,r=ls(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function fy(t,e){return e=Mf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function vd(t,e,n,r){return r!==null&&Z0(r),Ba(e,t.child,null,n),t=fy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function LP(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=Zp(Error(ee(422))),vd(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=Mf({mode:"visible",children:r.children},i,0,null),s=to(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ba(e,t.child,null,o),e.child.memoizedState=xg(o),e.memoizedState=_g,s);if(!(e.mode&1))return vd(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(ee(419)),r=Zp(s,r,void 0),vd(t,e,o,r)}if(a=(o&t.childLanes)!==0,vn||a){if(r=Ft,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,_i(t,i),Ir(r,t,i,-1))}return wy(),r=Zp(Error(ee(421))),vd(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=QP.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,$n=is(i.nextSibling),Bn=e,rt=!0,_r=null,t!==null&&(tr[nr++]=ai,tr[nr++]=li,tr[nr++]=lo,ai=t.id,li=t.overflow,lo=e),e=fy(e,r.children),e.flags|=4096,e)}function z_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),pg(t.return,e,n)}function em(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function ZI(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(on(t,e,r.children,n),r=st.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&z_(t,n,e);else if(t.tag===19)z_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Qe(st,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&zh(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),em(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&zh(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}em(e,!0,n,null,s);break;case"together":em(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Xd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function xi(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),uo|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ee(153));if(e.child!==null){for(t=e.child,n=ls(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ls(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function zP(t,e,n){switch(e.tag){case 3:XI(e),Ua();break;case 5:SI(e);break;case 1:En(e.type)&&Nh(e);break;case 4:sy(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Qe(Vh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Qe(st,st.current&1),e.flags|=128,null):n&e.child.childLanes?JI(t,e,n):(Qe(st,st.current&1),t=xi(t,e,n),t!==null?t.sibling:null);Qe(st,st.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return ZI(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Qe(st,st.current),r)break;return null;case 22:case 23:return e.lanes=0,QI(t,e,n)}return xi(t,e,n)}var eS,bg,tS,nS;eS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};bg=function(){};tS=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,Gs(Br.current);var s=null;switch(n){case"input":i=qm(t,i),r=qm(t,r),s=[];break;case"select":i=ct({},i,{value:void 0}),r=ct({},r,{value:void 0}),s=[];break;case"textarea":i=Wm(t,i),r=Wm(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Rh)}Qm(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(jc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(jc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&et("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};nS=function(t,e,n,r){n!==r&&(e.flags|=4)};function Ql(t,e){if(!rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Jt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function MP(t,e,n){var r=e.pendingProps;switch(J0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(e),null;case 1:return En(e.type)&&kh(),Jt(e),null;case 3:return r=e.stateNode,qa(),tt(bn),tt(rn),ay(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(gd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,_r!==null&&(kg(_r),_r=null))),bg(t,e),Jt(e),null;case 5:oy(e);var i=Gs(Xc.current);if(n=e.type,t!==null&&e.stateNode!=null)tS(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(ee(166));return Jt(e),null}if(t=Gs(Br.current),gd(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[jr]=e,r[Qc]=s,t=(e.mode&1)!==0,n){case"dialog":et("cancel",r),et("close",r);break;case"iframe":case"object":case"embed":et("load",r);break;case"video":case"audio":for(i=0;i<dc.length;i++)et(dc[i],r);break;case"source":et("error",r);break;case"img":case"image":case"link":et("error",r),et("load",r);break;case"details":et("toggle",r);break;case"input":Kw(r,s),et("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},et("invalid",r);break;case"textarea":Gw(r,s),et("invalid",r)}Qm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&md(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&md(r.textContent,a,t),i=["children",""+a]):jc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&et("scroll",r)}switch(n){case"input":ad(r),Ww(r,s,!0);break;case"textarea":ad(r),Qw(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=Rh)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=kE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[jr]=e,t[Qc]=r,eS(t,e,!1,!1),e.stateNode=t;e:{switch(o=Ym(n,r),n){case"dialog":et("cancel",t),et("close",t),i=r;break;case"iframe":case"object":case"embed":et("load",t),i=r;break;case"video":case"audio":for(i=0;i<dc.length;i++)et(dc[i],t);i=r;break;case"source":et("error",t),i=r;break;case"img":case"image":case"link":et("error",t),et("load",t),i=r;break;case"details":et("toggle",t),i=r;break;case"input":Kw(t,r),i=qm(t,r),et("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=ct({},r,{value:void 0}),et("invalid",t);break;case"textarea":Gw(t,r),i=Wm(t,r),et("invalid",t);break;default:i=r}Qm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?DE(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&NE(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Fc(t,l):typeof l=="number"&&Fc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(jc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&et("scroll",t):l!=null&&z0(t,s,l,o))}switch(n){case"input":ad(t),Ww(t,r,!1);break;case"textarea":ad(t),Qw(t);break;case"option":r.value!=null&&t.setAttribute("value",""+ms(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?Ta(t,!!r.multiple,s,!1):r.defaultValue!=null&&Ta(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=Rh)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Jt(e),null;case 6:if(t&&e.stateNode!=null)nS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(ee(166));if(n=Gs(Xc.current),Gs(Br.current),gd(e)){if(r=e.stateNode,n=e.memoizedProps,r[jr]=e,(s=r.nodeValue!==n)&&(t=Bn,t!==null))switch(t.tag){case 3:md(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&md(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[jr]=e,e.stateNode=r}return Jt(e),null;case 13:if(tt(st),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rt&&$n!==null&&e.mode&1&&!(e.flags&128))_I(),Ua(),e.flags|=98560,s=!1;else if(s=gd(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(ee(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[jr]=e}else Ua(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Jt(e),s=!1}else _r!==null&&(kg(_r),_r=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||st.current&1?Ct===0&&(Ct=3):wy())),e.updateQueue!==null&&(e.flags|=4),Jt(e),null);case 4:return qa(),bg(t,e),t===null&&Wc(e.stateNode.containerInfo),Jt(e),null;case 10:return ny(e.type._context),Jt(e),null;case 17:return En(e.type)&&kh(),Jt(e),null;case 19:if(tt(st),s=e.memoizedState,s===null)return Jt(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Ql(s,!1);else{if(Ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=zh(t),o!==null){for(e.flags|=128,Ql(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Qe(st,st.current&1|2),e.child}t=t.sibling}s.tail!==null&&gt()>Ka&&(e.flags|=128,r=!0,Ql(s,!1),e.lanes=4194304)}else{if(!r)if(t=zh(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ql(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!rt)return Jt(e),null}else 2*gt()-s.renderingStartTime>Ka&&n!==1073741824&&(e.flags|=128,r=!0,Ql(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=gt(),e.sibling=null,n=st.current,Qe(st,r?n&1|2:n&1),e):(Jt(e),null);case 22:case 23:return vy(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Mn&1073741824&&(Jt(e),e.subtreeFlags&6&&(e.flags|=8192)):Jt(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function jP(t,e){switch(J0(e),e.tag){case 1:return En(e.type)&&kh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return qa(),tt(bn),tt(rn),ay(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return oy(e),null;case 13:if(tt(st),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));Ua()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return tt(st),null;case 4:return qa(),null;case 10:return ny(e.type._context),null;case 22:case 23:return vy(),null;case 24:return null;default:return null}}var wd=!1,tn=!1,FP=typeof WeakSet=="function"?WeakSet:Set,le=null;function Ea(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ht(t,e,r)}else n.current=null}function Eg(t,e,n){try{n()}catch(r){ht(t,e,r)}}var M_=!1;function $P(t,e){if(og=Th,t=aI(),Y0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++c===i&&(a=o),f===s&&++d===r&&(l=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(ag={focusedElem:t,selectionRange:n},Th=!1,le=e;le!==null;)if(e=le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,le=t;else for(;le!==null;){e=le;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var w=v.memoizedProps,T=v.memoizedState,y=e.stateNode,_=y.getSnapshotBeforeUpdate(e.elementType===e.type?w:yr(e.type,w),T);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var S=e.stateNode.containerInfo;S.nodeType===1?S.textContent="":S.nodeType===9&&S.documentElement&&S.removeChild(S.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(C){ht(e,e.return,C)}if(t=e.sibling,t!==null){t.return=e.return,le=t;break}le=e.return}return v=M_,M_=!1,v}function Cc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Eg(e,n,s)}i=i.next}while(i!==r)}}function Lf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Ig(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function rS(t){var e=t.alternate;e!==null&&(t.alternate=null,rS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[jr],delete e[Qc],delete e[ug],delete e[EP],delete e[IP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function iS(t){return t.tag===5||t.tag===3||t.tag===4}function j_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||iS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Sg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Rh));else if(r!==4&&(t=t.child,t!==null))for(Sg(t,e,n),t=t.sibling;t!==null;)Sg(t,e,n),t=t.sibling}function Tg(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Tg(t,e,n),t=t.sibling;t!==null;)Tg(t,e,n),t=t.sibling}var Ht=null,vr=!1;function Li(t,e,n){for(n=n.child;n!==null;)sS(t,e,n),n=n.sibling}function sS(t,e,n){if(Ur&&typeof Ur.onCommitFiberUnmount=="function")try{Ur.onCommitFiberUnmount(Cf,n)}catch{}switch(n.tag){case 5:tn||Ea(n,e);case 6:var r=Ht,i=vr;Ht=null,Li(t,e,n),Ht=r,vr=i,Ht!==null&&(vr?(t=Ht,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Ht.removeChild(n.stateNode));break;case 18:Ht!==null&&(vr?(t=Ht,n=n.stateNode,t.nodeType===8?Wp(t.parentNode,n):t.nodeType===1&&Wp(t,n),qc(t)):Wp(Ht,n.stateNode));break;case 4:r=Ht,i=vr,Ht=n.stateNode.containerInfo,vr=!0,Li(t,e,n),Ht=r,vr=i;break;case 0:case 11:case 14:case 15:if(!tn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Eg(n,e,o),i=i.next}while(i!==r)}Li(t,e,n);break;case 1:if(!tn&&(Ea(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ht(n,e,a)}Li(t,e,n);break;case 21:Li(t,e,n);break;case 22:n.mode&1?(tn=(r=tn)||n.memoizedState!==null,Li(t,e,n),tn=r):Li(t,e,n);break;default:Li(t,e,n)}}function F_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new FP),e.forEach(function(r){var i=YP.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function gr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Ht=a.stateNode,vr=!1;break e;case 3:Ht=a.stateNode.containerInfo,vr=!0;break e;case 4:Ht=a.stateNode.containerInfo,vr=!0;break e}a=a.return}if(Ht===null)throw Error(ee(160));sS(s,o,i),Ht=null,vr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){ht(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oS(e,t),e=e.sibling}function oS(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(gr(e,t),zr(t),r&4){try{Cc(3,t,t.return),Lf(3,t)}catch(w){ht(t,t.return,w)}try{Cc(5,t,t.return)}catch(w){ht(t,t.return,w)}}break;case 1:gr(e,t),zr(t),r&512&&n!==null&&Ea(n,n.return);break;case 5:if(gr(e,t),zr(t),r&512&&n!==null&&Ea(n,n.return),t.flags&32){var i=t.stateNode;try{Fc(i,"")}catch(w){ht(t,t.return,w)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&CE(i,s),Ym(a,o);var c=Ym(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?DE(i,h):d==="dangerouslySetInnerHTML"?NE(i,h):d==="children"?Fc(i,h):z0(i,d,h,c)}switch(a){case"input":Hm(i,s);break;case"textarea":RE(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Ta(i,!!s.multiple,m,!1):f!==!!s.multiple&&(s.defaultValue!=null?Ta(i,!!s.multiple,s.defaultValue,!0):Ta(i,!!s.multiple,s.multiple?[]:"",!1))}i[Qc]=s}catch(w){ht(t,t.return,w)}}break;case 6:if(gr(e,t),zr(t),r&4){if(t.stateNode===null)throw Error(ee(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(w){ht(t,t.return,w)}}break;case 3:if(gr(e,t),zr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{qc(e.containerInfo)}catch(w){ht(t,t.return,w)}break;case 4:gr(e,t),zr(t);break;case 13:gr(e,t),zr(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(gy=gt())),r&4&&F_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(tn=(c=tn)||d,gr(e,t),tn=c):gr(e,t),zr(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(le=t,d=t.child;d!==null;){for(h=le=d;le!==null;){switch(f=le,m=f.child,f.tag){case 0:case 11:case 14:case 15:Cc(4,f,f.return);break;case 1:Ea(f,f.return);var v=f.stateNode;if(typeof v.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(w){ht(r,n,w)}}break;case 5:Ea(f,f.return);break;case 22:if(f.memoizedState!==null){U_(h);continue}}m!==null?(m.return=f,le=m):U_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=PE("display",o))}catch(w){ht(t,t.return,w)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(w){ht(t,t.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:gr(e,t),zr(t),r&4&&F_(t);break;case 21:break;default:gr(e,t),zr(t)}}function zr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(iS(n)){var r=n;break e}n=n.return}throw Error(ee(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Fc(i,""),r.flags&=-33);var s=j_(t);Tg(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=j_(t);Sg(t,a,o);break;default:throw Error(ee(161))}}catch(l){ht(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function UP(t,e,n){le=t,aS(t)}function aS(t,e,n){for(var r=(t.mode&1)!==0;le!==null;){var i=le,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||wd;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||tn;a=wd;var c=tn;if(wd=o,(tn=l)&&!c)for(le=i;le!==null;)o=le,l=o.child,o.tag===22&&o.memoizedState!==null?B_(i):l!==null?(l.return=o,le=l):B_(i);for(;s!==null;)le=s,aS(s),s=s.sibling;le=i,wd=a,tn=c}$_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,le=s):$_(t)}}function $_(t){for(;le!==null;){var e=le;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:tn||Lf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!tn)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:yr(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&S_(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}S_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&qc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}tn||e.flags&512&&Ig(e)}catch(f){ht(e,e.return,f)}}if(e===t){le=null;break}if(n=e.sibling,n!==null){n.return=e.return,le=n;break}le=e.return}}function U_(t){for(;le!==null;){var e=le;if(e===t){le=null;break}var n=e.sibling;if(n!==null){n.return=e.return,le=n;break}le=e.return}}function B_(t){for(;le!==null;){var e=le;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Lf(4,e)}catch(l){ht(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ht(e,i,l)}}var s=e.return;try{Ig(e)}catch(l){ht(e,s,l)}break;case 5:var o=e.return;try{Ig(e)}catch(l){ht(e,o,l)}}}catch(l){ht(e,e.return,l)}if(e===t){le=null;break}var a=e.sibling;if(a!==null){a.return=e.return,le=a;break}le=e.return}}var BP=Math.ceil,Fh=Ai.ReactCurrentDispatcher,py=Ai.ReactCurrentOwner,or=Ai.ReactCurrentBatchConfig,Le=0,Ft=null,bt=null,Wt=0,Mn=0,Ia=bs(0),Ct=0,tu=null,uo=0,zf=0,my=0,Rc=null,gn=null,gy=0,Ka=1/0,ii=null,$h=!1,Ag=null,os=null,_d=!1,Zi=null,Uh=0,kc=0,Cg=null,Jd=-1,Zd=0;function an(){return Le&6?gt():Jd!==-1?Jd:Jd=gt()}function as(t){return t.mode&1?Le&2&&Wt!==0?Wt&-Wt:TP.transition!==null?(Zd===0&&(Zd=HE()),Zd):(t=qe,t!==0||(t=window.event,t=t===void 0?16:JE(t.type)),t):1}function Ir(t,e,n,r){if(50<kc)throw kc=0,Cg=null,Error(ee(185));Tu(t,n,r),(!(Le&2)||t!==Ft)&&(t===Ft&&(!(Le&2)&&(zf|=n),Ct===4&&Ki(t,Wt)),In(t,r),n===1&&Le===0&&!(e.mode&1)&&(Ka=gt()+500,Df&&Es()))}function In(t,e){var n=t.callbackNode;TN(t,e);var r=Sh(t,t===Ft?Wt:0);if(r===0)n!==null&&Jw(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Jw(n),e===1)t.tag===0?SP(q_.bind(null,t)):yI(q_.bind(null,t)),xP(function(){!(Le&6)&&Es()}),n=null;else{switch(KE(r)){case 1:n=U0;break;case 4:n=BE;break;case 16:n=Ih;break;case 536870912:n=qE;break;default:n=Ih}n=mS(n,lS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function lS(t,e){if(Jd=-1,Zd=0,Le&6)throw Error(ee(327));var n=t.callbackNode;if(Na()&&t.callbackNode!==n)return null;var r=Sh(t,t===Ft?Wt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Bh(t,r);else{e=r;var i=Le;Le|=2;var s=uS();(Ft!==t||Wt!==e)&&(ii=null,Ka=gt()+500,eo(t,e));do try{KP();break}catch(a){cS(t,a)}while(!0);ty(),Fh.current=s,Le=i,bt!==null?e=0:(Ft=null,Wt=0,e=Ct)}if(e!==0){if(e===2&&(i=tg(t),i!==0&&(r=i,e=Rg(t,i))),e===1)throw n=tu,eo(t,0),Ki(t,r),In(t,gt()),n;if(e===6)Ki(t,r);else{if(i=t.current.alternate,!(r&30)&&!qP(i)&&(e=Bh(t,r),e===2&&(s=tg(t),s!==0&&(r=s,e=Rg(t,s))),e===1))throw n=tu,eo(t,0),Ki(t,r),In(t,gt()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(ee(345));case 2:Ms(t,gn,ii);break;case 3:if(Ki(t,r),(r&130023424)===r&&(e=gy+500-gt(),10<e)){if(Sh(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){an(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=cg(Ms.bind(null,t,gn,ii),e);break}Ms(t,gn,ii);break;case 4:if(Ki(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-Er(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=gt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*BP(r/1960))-r,10<r){t.timeoutHandle=cg(Ms.bind(null,t,gn,ii),r);break}Ms(t,gn,ii);break;case 5:Ms(t,gn,ii);break;default:throw Error(ee(329))}}}return In(t,gt()),t.callbackNode===n?lS.bind(null,t):null}function Rg(t,e){var n=Rc;return t.current.memoizedState.isDehydrated&&(eo(t,e).flags|=256),t=Bh(t,e),t!==2&&(e=gn,gn=n,e!==null&&kg(e)),t}function kg(t){gn===null?gn=t:gn.push.apply(gn,t)}function qP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!Ar(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ki(t,e){for(e&=~my,e&=~zf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Er(e),r=1<<n;t[n]=-1,e&=~r}}function q_(t){if(Le&6)throw Error(ee(327));Na();var e=Sh(t,0);if(!(e&1))return In(t,gt()),null;var n=Bh(t,e);if(t.tag!==0&&n===2){var r=tg(t);r!==0&&(e=r,n=Rg(t,r))}if(n===1)throw n=tu,eo(t,0),Ki(t,e),In(t,gt()),n;if(n===6)throw Error(ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ms(t,gn,ii),In(t,gt()),null}function yy(t,e){var n=Le;Le|=1;try{return t(e)}finally{Le=n,Le===0&&(Ka=gt()+500,Df&&Es())}}function ho(t){Zi!==null&&Zi.tag===0&&!(Le&6)&&Na();var e=Le;Le|=1;var n=or.transition,r=qe;try{if(or.transition=null,qe=1,t)return t()}finally{qe=r,or.transition=n,Le=e,!(Le&6)&&Es()}}function vy(){Mn=Ia.current,tt(Ia)}function eo(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,_P(n)),bt!==null)for(n=bt.return;n!==null;){var r=n;switch(J0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&kh();break;case 3:qa(),tt(bn),tt(rn),ay();break;case 5:oy(r);break;case 4:qa();break;case 13:tt(st);break;case 19:tt(st);break;case 10:ny(r.type._context);break;case 22:case 23:vy()}n=n.return}if(Ft=t,bt=t=ls(t.current,null),Wt=Mn=e,Ct=0,tu=null,my=zf=uo=0,gn=Rc=null,Ws!==null){for(e=0;e<Ws.length;e++)if(n=Ws[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ws=null}return t}function cS(t,e){do{var n=bt;try{if(ty(),Qd.current=jh,Mh){for(var r=at.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Mh=!1}if(co=0,jt=At=at=null,Ac=!1,Jc=0,py.current=null,n===null||n.return===null){Ct=1,tu=e,bt=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=Wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=N_(o);if(m!==null){m.flags&=-257,P_(m,o,a,s,e),m.mode&1&&k_(s,c,e),e=m,l=c;var v=e.updateQueue;if(v===null){var w=new Set;w.add(l),e.updateQueue=w}else v.add(l);break e}else{if(!(e&1)){k_(s,c,e),wy();break e}l=Error(ee(426))}}else if(rt&&a.mode&1){var T=N_(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),P_(T,o,a,s,e),Z0(Ha(l,a));break e}}s=l=Ha(l,a),Ct!==4&&(Ct=2),Rc===null?Rc=[s]:Rc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=KI(s,l,e);I_(s,y);break e;case 1:a=l;var _=s.type,S=s.stateNode;if(!(s.flags&128)&&(typeof _.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(os===null||!os.has(S)))){s.flags|=65536,e&=-e,s.lanes|=e;var C=WI(s,a,e);I_(s,C);break e}}s=s.return}while(s!==null)}hS(n)}catch(O){e=O,bt===n&&n!==null&&(bt=n=n.return);continue}break}while(!0)}function uS(){var t=Fh.current;return Fh.current=jh,t===null?jh:t}function wy(){(Ct===0||Ct===3||Ct===2)&&(Ct=4),Ft===null||!(uo&268435455)&&!(zf&268435455)||Ki(Ft,Wt)}function Bh(t,e){var n=Le;Le|=2;var r=uS();(Ft!==t||Wt!==e)&&(ii=null,eo(t,e));do try{HP();break}catch(i){cS(t,i)}while(!0);if(ty(),Le=n,Fh.current=r,bt!==null)throw Error(ee(261));return Ft=null,Wt=0,Ct}function HP(){for(;bt!==null;)dS(bt)}function KP(){for(;bt!==null&&!yN();)dS(bt)}function dS(t){var e=pS(t.alternate,t,Mn);t.memoizedProps=t.pendingProps,e===null?hS(t):bt=e,py.current=null}function hS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=jP(n,e),n!==null){n.flags&=32767,bt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Ct=6,bt=null;return}}else if(n=MP(n,e,Mn),n!==null){bt=n;return}if(e=e.sibling,e!==null){bt=e;return}bt=e=t}while(e!==null);Ct===0&&(Ct=5)}function Ms(t,e,n){var r=qe,i=or.transition;try{or.transition=null,qe=1,WP(t,e,n,r)}finally{or.transition=i,qe=r}return null}function WP(t,e,n,r){do Na();while(Zi!==null);if(Le&6)throw Error(ee(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ee(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(AN(t,s),t===Ft&&(bt=Ft=null,Wt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_d||(_d=!0,mS(Ih,function(){return Na(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=or.transition,or.transition=null;var o=qe;qe=1;var a=Le;Le|=4,py.current=null,$P(t,n),oS(n,t),fP(ag),Th=!!og,ag=og=null,t.current=n,UP(n),vN(),Le=a,qe=o,or.transition=s}else t.current=n;if(_d&&(_d=!1,Zi=t,Uh=i),s=t.pendingLanes,s===0&&(os=null),xN(n.stateNode),In(t,gt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if($h)throw $h=!1,t=Ag,Ag=null,t;return Uh&1&&t.tag!==0&&Na(),s=t.pendingLanes,s&1?t===Cg?kc++:(kc=0,Cg=t):kc=0,Es(),null}function Na(){if(Zi!==null){var t=KE(Uh),e=or.transition,n=qe;try{if(or.transition=null,qe=16>t?16:t,Zi===null)var r=!1;else{if(t=Zi,Zi=null,Uh=0,Le&6)throw Error(ee(331));var i=Le;for(Le|=4,le=t.current;le!==null;){var s=le,o=s.child;if(le.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(le=c;le!==null;){var d=le;switch(d.tag){case 0:case 11:case 15:Cc(8,d,s)}var h=d.child;if(h!==null)h.return=d,le=h;else for(;le!==null;){d=le;var f=d.sibling,m=d.return;if(rS(d),d===c){le=null;break}if(f!==null){f.return=m,le=f;break}le=m}}}var v=s.alternate;if(v!==null){var w=v.child;if(w!==null){v.child=null;do{var T=w.sibling;w.sibling=null,w=T}while(w!==null)}}le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,le=o;else e:for(;le!==null;){if(s=le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Cc(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,le=y;break e}le=s.return}}var _=t.current;for(le=_;le!==null;){o=le;var S=o.child;if(o.subtreeFlags&2064&&S!==null)S.return=o,le=S;else e:for(o=_;le!==null;){if(a=le,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Lf(9,a)}}catch(O){ht(a,a.return,O)}if(a===o){le=null;break e}var C=a.sibling;if(C!==null){C.return=a.return,le=C;break e}le=a.return}}if(Le=i,Es(),Ur&&typeof Ur.onPostCommitFiberRoot=="function")try{Ur.onPostCommitFiberRoot(Cf,t)}catch{}r=!0}return r}finally{qe=n,or.transition=e}}return!1}function H_(t,e,n){e=Ha(n,e),e=KI(t,e,1),t=ss(t,e,1),e=an(),t!==null&&(Tu(t,1,e),In(t,e))}function ht(t,e,n){if(t.tag===3)H_(t,t,n);else for(;e!==null;){if(e.tag===3){H_(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(os===null||!os.has(r))){t=Ha(n,t),t=WI(e,t,1),e=ss(e,t,1),t=an(),e!==null&&(Tu(e,1,t),In(e,t));break}}e=e.return}}function GP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=an(),t.pingedLanes|=t.suspendedLanes&n,Ft===t&&(Wt&n)===n&&(Ct===4||Ct===3&&(Wt&130023424)===Wt&&500>gt()-gy?eo(t,0):my|=n),In(t,e)}function fS(t,e){e===0&&(t.mode&1?(e=ud,ud<<=1,!(ud&130023424)&&(ud=4194304)):e=1);var n=an();t=_i(t,e),t!==null&&(Tu(t,e,n),In(t,n))}function QP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),fS(t,n)}function YP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(ee(314))}r!==null&&r.delete(e),fS(t,n)}var pS;pS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||bn.current)vn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return vn=!1,zP(t,e,n);vn=!!(t.flags&131072)}else vn=!1,rt&&e.flags&1048576&&vI(e,Dh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Xd(t,e),t=e.pendingProps;var i=$a(e,rn.current);ka(e,n),i=cy(null,e,r,t,i,n);var s=uy();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,En(r)?(s=!0,Nh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,iy(e),i.updater=Of,e.stateNode=i,i._reactInternals=e,gg(e,r,t,n),e=wg(null,e,r,!0,s,n)):(e.tag=0,rt&&s&&X0(e),on(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Xd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=JP(r),t=yr(r,t),i){case 0:e=vg(null,e,r,t,n);break e;case 1:e=O_(null,e,r,t,n);break e;case 11:e=D_(null,e,r,t,n);break e;case 14:e=V_(null,e,r,yr(r.type,t),n);break e}throw Error(ee(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yr(r,i),vg(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yr(r,i),O_(t,e,r,i,n);case 3:e:{if(XI(e),t===null)throw Error(ee(387));r=e.pendingProps,s=e.memoizedState,i=s.element,II(t,e),Lh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Ha(Error(ee(423)),e),e=L_(t,e,r,n,i);break e}else if(r!==i){i=Ha(Error(ee(424)),e),e=L_(t,e,r,n,i);break e}else for($n=is(e.stateNode.containerInfo.firstChild),Bn=e,rt=!0,_r=null,n=bI(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ua(),r===i){e=xi(t,e,n);break e}on(t,e,r,n)}e=e.child}return e;case 5:return SI(e),t===null&&fg(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,lg(r,i)?o=null:s!==null&&lg(r,s)&&(e.flags|=32),YI(t,e),on(t,e,o,n),e.child;case 6:return t===null&&fg(e),null;case 13:return JI(t,e,n);case 4:return sy(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ba(e,null,r,n):on(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yr(r,i),D_(t,e,r,i,n);case 7:return on(t,e,e.pendingProps,n),e.child;case 8:return on(t,e,e.pendingProps.children,n),e.child;case 12:return on(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,Qe(Vh,r._currentValue),r._currentValue=o,s!==null)if(Ar(s.value,o)){if(s.children===i.children&&!bn.current){e=xi(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=mi(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),pg(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ee(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),pg(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}on(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,ka(e,n),i=lr(i),r=r(i),e.flags|=1,on(t,e,r,n),e.child;case 14:return r=e.type,i=yr(r,e.pendingProps),i=yr(r.type,i),V_(t,e,r,i,n);case 15:return GI(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:yr(r,i),Xd(t,e),e.tag=1,En(r)?(t=!0,Nh(e)):t=!1,ka(e,n),HI(e,r,i),gg(e,r,i,n),wg(null,e,r,!0,t,n);case 19:return ZI(t,e,n);case 22:return QI(t,e,n)}throw Error(ee(156,e.tag))};function mS(t,e){return UE(t,e)}function XP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function rr(t,e,n,r){return new XP(t,e,n,r)}function _y(t){return t=t.prototype,!(!t||!t.isReactComponent)}function JP(t){if(typeof t=="function")return _y(t)?1:0;if(t!=null){if(t=t.$$typeof,t===j0)return 11;if(t===F0)return 14}return 2}function ls(t,e){var n=t.alternate;return n===null?(n=rr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function eh(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")_y(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case pa:return to(n.children,i,s,e);case M0:o=8,i|=8;break;case Fm:return t=rr(12,n,e,i|2),t.elementType=Fm,t.lanes=s,t;case $m:return t=rr(13,n,e,i),t.elementType=$m,t.lanes=s,t;case Um:return t=rr(19,n,e,i),t.elementType=Um,t.lanes=s,t;case SE:return Mf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case EE:o=10;break e;case IE:o=9;break e;case j0:o=11;break e;case F0:o=14;break e;case $i:o=16,r=null;break e}throw Error(ee(130,t==null?t:typeof t,""))}return e=rr(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function to(t,e,n,r){return t=rr(7,t,r,e),t.lanes=n,t}function Mf(t,e,n,r){return t=rr(22,t,r,e),t.elementType=SE,t.lanes=n,t.stateNode={isHidden:!1},t}function tm(t,e,n){return t=rr(6,t,null,e),t.lanes=n,t}function nm(t,e,n){return e=rr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ZP(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Lp(0),this.expirationTimes=Lp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Lp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function xy(t,e,n,r,i,s,o,a,l){return t=new ZP(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=rr(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},iy(s),t}function eD(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fa,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function gS(t){if(!t)return gs;t=t._reactInternals;e:{if(Ro(t)!==t||t.tag!==1)throw Error(ee(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(En(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(t.tag===1){var n=t.type;if(En(n))return gI(t,n,e)}return e}function yS(t,e,n,r,i,s,o,a,l){return t=xy(n,r,!0,t,i,s,o,a,l),t.context=gS(null),n=t.current,r=an(),i=as(n),s=mi(r,i),s.callback=e??null,ss(n,s,i),t.current.lanes=i,Tu(t,i,r),In(t,r),t}function jf(t,e,n,r){var i=e.current,s=an(),o=as(i);return n=gS(n),e.context===null?e.context=n:e.pendingContext=n,e=mi(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=ss(i,e,o),t!==null&&(Ir(t,i,o,s),Gd(t,i,o)),o}function qh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function K_(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function by(t,e){K_(t,e),(t=t.alternate)&&K_(t,e)}function tD(){return null}var vS=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ey(t){this._internalRoot=t}Ff.prototype.render=Ey.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ee(409));jf(t,e,null,null)};Ff.prototype.unmount=Ey.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ho(function(){jf(null,t,null,null)}),e[wi]=null}};function Ff(t){this._internalRoot=t}Ff.prototype.unstable_scheduleHydration=function(t){if(t){var e=QE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Hi.length&&e!==0&&e<Hi[n].priority;n++);Hi.splice(n,0,t),n===0&&XE(t)}};function Iy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function $f(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function W_(){}function nD(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=qh(o);s.call(c)}}var o=yS(e,r,t,0,null,!1,!1,"",W_);return t._reactRootContainer=o,t[wi]=o.current,Wc(t.nodeType===8?t.parentNode:t),ho(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=qh(l);a.call(c)}}var l=xy(t,0,!1,null,null,!1,!1,"",W_);return t._reactRootContainer=l,t[wi]=l.current,Wc(t.nodeType===8?t.parentNode:t),ho(function(){jf(e,l,n,r)}),l}function Uf(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=qh(o);a.call(l)}}jf(e,o,t,i)}else o=nD(n,e,t,i,r);return qh(o)}WE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=uc(e.pendingLanes);n!==0&&(B0(e,n|1),In(e,gt()),!(Le&6)&&(Ka=gt()+500,Es()))}break;case 13:ho(function(){var r=_i(t,1);if(r!==null){var i=an();Ir(r,t,1,i)}}),by(t,1)}};q0=function(t){if(t.tag===13){var e=_i(t,134217728);if(e!==null){var n=an();Ir(e,t,134217728,n)}by(t,134217728)}};GE=function(t){if(t.tag===13){var e=as(t),n=_i(t,e);if(n!==null){var r=an();Ir(n,t,e,r)}by(t,e)}};QE=function(){return qe};YE=function(t,e){var n=qe;try{return qe=t,e()}finally{qe=n}};Jm=function(t,e,n){switch(e){case"input":if(Hm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=Pf(r);if(!i)throw Error(ee(90));AE(r),Hm(r,i)}}}break;case"textarea":RE(t,n);break;case"select":e=n.value,e!=null&&Ta(t,!!n.multiple,e,!1)}};LE=yy;zE=ho;var rD={usingClientEntryPoint:!1,Events:[Cu,va,Pf,VE,OE,yy]},Yl={findFiberByHostInstance:Ks,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iD={bundleType:Yl.bundleType,version:Yl.version,rendererPackageName:Yl.rendererPackageName,rendererConfig:Yl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ai.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=FE(t),t===null?null:t.stateNode},findFiberByHostInstance:Yl.findFiberByHostInstance||tD,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xd.isDisabled&&xd.supportsFiber)try{Cf=xd.inject(iD),Ur=xd}catch{}}Qn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rD;Qn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Iy(e))throw Error(ee(200));return eD(t,e,null,n)};Qn.createRoot=function(t,e){if(!Iy(t))throw Error(ee(299));var n=!1,r="",i=vS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=xy(t,1,!1,null,null,n,!1,r,i),t[wi]=e.current,Wc(t.nodeType===8?t.parentNode:t),new Ey(e)};Qn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ee(188)):(t=Object.keys(t).join(","),Error(ee(268,t)));return t=FE(e),t=t===null?null:t.stateNode,t};Qn.flushSync=function(t){return ho(t)};Qn.hydrate=function(t,e,n){if(!$f(e))throw Error(ee(200));return Uf(null,t,e,!0,n)};Qn.hydrateRoot=function(t,e,n){if(!Iy(t))throw Error(ee(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=vS;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=yS(e,null,t,1,n??null,i,!1,s,o),t[wi]=e.current,Wc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new Ff(e)};Qn.render=function(t,e,n){if(!$f(e))throw Error(ee(200));return Uf(null,t,e,!1,n)};Qn.unmountComponentAtNode=function(t){if(!$f(t))throw Error(ee(40));return t._reactRootContainer?(ho(function(){Uf(null,null,t,!1,function(){t._reactRootContainer=null,t[wi]=null})}),!0):!1};Qn.unstable_batchedUpdates=yy;Qn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!$f(n))throw Error(ee(200));if(t==null||t._reactInternals===void 0)throw Error(ee(38));return Uf(t,e,n,!1,r)};Qn.version="18.3.1-next-f1338f8080-20240426";function wS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wS)}catch(t){console.error(t)}}wS(),wE.exports=Qn;var nu=wE.exports,G_=nu;Mm.createRoot=G_.createRoot,Mm.hydrateRoot=G_.hydrateRoot;function Ut(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,r;n<t.length;n++)(r=Ut(t[n]))!==""&&(e+=(e&&" ")+r);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var _S={exports:{}},xS={},bS={exports:{}},ES={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Wa=D;function sD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var oD=typeof Object.is=="function"?Object.is:sD,aD=Wa.useState,lD=Wa.useEffect,cD=Wa.useLayoutEffect,uD=Wa.useDebugValue;function dD(t,e){var n=e(),r=aD({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return cD(function(){i.value=n,i.getSnapshot=e,rm(i)&&s({inst:i})},[t,n,e]),lD(function(){return rm(i)&&s({inst:i}),t(function(){rm(i)&&s({inst:i})})},[t]),uD(n),n}function rm(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!oD(t,n)}catch{return!0}}function hD(t,e){return e()}var fD=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?hD:dD;ES.useSyncExternalStore=Wa.useSyncExternalStore!==void 0?Wa.useSyncExternalStore:fD;bS.exports=ES;var pD=bS.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bf=D,mD=pD;function gD(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var yD=typeof Object.is=="function"?Object.is:gD,vD=mD.useSyncExternalStore,wD=Bf.useRef,_D=Bf.useEffect,xD=Bf.useMemo,bD=Bf.useDebugValue;xS.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=wD(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=xD(function(){function l(m){if(!c){if(c=!0,d=m,m=r(m),i!==void 0&&o.hasValue){var v=o.value;if(i(v,m))return h=v}return h=m}if(v=h,yD(d,m))return v;var w=r(m);return i!==void 0&&i(v,w)?(d=m,v):(d=m,h=w)}var c=!1,d,h,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,i]);var a=vD(t,s[0],s[1]);return _D(function(){o.hasValue=!0,o.value=a},[a]),bD(a),a};_S.exports=xS;var ED=_S.exports;const ID=aE(ED),SD={},Q_=t=>{let e;const n=new Set,r=(d,h)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const m=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(v=>v(e,m))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(SD?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},TD=t=>t?Q_(t):Q_,{useDebugValue:AD}=G,{useSyncExternalStoreWithSelector:CD}=ID,RD=t=>t;function IS(t,e=RD,n){const r=CD(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return AD(r),r}const Y_=(t,e)=>{const n=TD(t),r=(i,s=e)=>IS(n,i,s);return Object.assign(r,n),r},kD=(t,e)=>t?Y_(t,e):Y_;function $t(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,i]of t)if(!Object.is(i,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(t[r],e[r]))return!1;return!0}var ND={value:()=>{}};function qf(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new th(n)}function th(t){this._=t}function PD(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}th.prototype=qf.prototype={constructor:th,on:function(t,e){var n=this._,r=PD(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=DD(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=X_(n[i],t.name,e);else if(e==null)for(i in n)n[i]=X_(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new th(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function DD(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function X_(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=ND,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Ng="http://www.w3.org/1999/xhtml";const J_={svg:"http://www.w3.org/2000/svg",xhtml:Ng,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Hf(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),J_.hasOwnProperty(e)?{space:J_[e],local:t}:t}function VD(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Ng&&e.documentElement.namespaceURI===Ng?e.createElement(t):e.createElementNS(n,t)}}function OD(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function SS(t){var e=Hf(t);return(e.local?OD:VD)(e)}function LD(){}function Sy(t){return t==null?LD:function(){return this.querySelector(t)}}function zD(t){typeof t!="function"&&(t=Sy(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),l,c,d=0;d<o;++d)(l=s[d])&&(c=t.call(l,l.__data__,d,s))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new Wn(r,this._parents)}function MD(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function jD(){return[]}function TS(t){return t==null?jD:function(){return this.querySelectorAll(t)}}function FD(t){return function(){return MD(t.apply(this,arguments))}}function $D(t){typeof t=="function"?t=FD(t):t=TS(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(r.push(t.call(l,l.__data__,c,o)),i.push(l));return new Wn(r,i)}function AS(t){return function(){return this.matches(t)}}function CS(t){return function(e){return e.matches(t)}}var UD=Array.prototype.find;function BD(t){return function(){return UD.call(this.children,t)}}function qD(){return this.firstElementChild}function HD(t){return this.select(t==null?qD:BD(typeof t=="function"?t:CS(t)))}var KD=Array.prototype.filter;function WD(){return Array.from(this.children)}function GD(t){return function(){return KD.call(this.children,t)}}function QD(t){return this.selectAll(t==null?WD:GD(typeof t=="function"?t:CS(t)))}function YD(t){typeof t!="function"&&(t=AS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new Wn(r,this._parents)}function RS(t){return new Array(t.length)}function XD(){return new Wn(this._enter||this._groups.map(RS),this._parents)}function Hh(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Hh.prototype={constructor:Hh,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function JD(t){return function(){return t}}function ZD(t,e,n,r,i,s){for(var o=0,a,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new Hh(t,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function eV(t,e,n,r,i,s,o){var a,l,c=new Map,d=e.length,h=s.length,f=new Array(d),m;for(a=0;a<d;++a)(l=e[a])&&(f[a]=m=o.call(l,l.__data__,a,e)+"",c.has(m)?i[a]=l:c.set(m,l));for(a=0;a<h;++a)m=o.call(t,s[a],a,s)+"",(l=c.get(m))?(r[a]=l,l.__data__=s[a],c.delete(m)):n[a]=new Hh(t,s[a]);for(a=0;a<d;++a)(l=e[a])&&c.get(f[a])===l&&(i[a]=l)}function tV(t){return t.__data__}function nV(t,e){if(!arguments.length)return Array.from(this,tV);var n=e?eV:ZD,r=this._parents,i=this._groups;typeof t!="function"&&(t=JD(t));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var d=r[c],h=i[c],f=h.length,m=rV(t.call(d,d&&d.__data__,c,r)),v=m.length,w=a[c]=new Array(v),T=o[c]=new Array(v),y=l[c]=new Array(f);n(d,h,w,T,y,m,e);for(var _=0,S=0,C,O;_<v;++_)if(C=w[_]){for(_>=S&&(S=_+1);!(O=T[S])&&++S<v;);C._next=O||null}}return o=new Wn(o,r),o._enter=a,o._exit=l,o}function rV(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function iV(){return new Wn(this._exit||this._groups.map(RS),this._parents)}function sV(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function oV(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var c=n[l],d=r[l],h=c.length,f=a[l]=new Array(h),m,v=0;v<h;++v)(m=c[v]||d[v])&&(f[v]=m);for(;l<i;++l)a[l]=n[l];return new Wn(a,this._parents)}function aV(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function lV(t){t||(t=cV);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,l=i[s]=new Array(a),c,d=0;d<a;++d)(c=o[d])&&(l[d]=c);l.sort(e)}return new Wn(i,this._parents).order()}function cV(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function uV(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function dV(){return Array.from(this)}function hV(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function fV(){let t=0;for(const e of this)++t;return t}function pV(){return!this.node()}function mV(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function gV(t){return function(){this.removeAttribute(t)}}function yV(t){return function(){this.removeAttributeNS(t.space,t.local)}}function vV(t,e){return function(){this.setAttribute(t,e)}}function wV(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function _V(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function xV(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function bV(t,e){var n=Hf(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?yV:gV:typeof e=="function"?n.local?xV:_V:n.local?wV:vV)(n,e))}function kS(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function EV(t){return function(){this.style.removeProperty(t)}}function IV(t,e,n){return function(){this.style.setProperty(t,e,n)}}function SV(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function TV(t,e,n){return arguments.length>1?this.each((e==null?EV:typeof e=="function"?SV:IV)(t,e,n??"")):Ga(this.node(),t)}function Ga(t,e){return t.style.getPropertyValue(e)||kS(t).getComputedStyle(t,null).getPropertyValue(e)}function AV(t){return function(){delete this[t]}}function CV(t,e){return function(){this[t]=e}}function RV(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function kV(t,e){return arguments.length>1?this.each((e==null?AV:typeof e=="function"?RV:CV)(t,e)):this.node()[t]}function NS(t){return t.trim().split(/^|\s+/)}function Ty(t){return t.classList||new PS(t)}function PS(t){this._node=t,this._names=NS(t.getAttribute("class")||"")}PS.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function DS(t,e){for(var n=Ty(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function VS(t,e){for(var n=Ty(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function NV(t){return function(){DS(this,t)}}function PV(t){return function(){VS(this,t)}}function DV(t,e){return function(){(e.apply(this,arguments)?DS:VS)(this,t)}}function VV(t,e){var n=NS(t+"");if(arguments.length<2){for(var r=Ty(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?DV:e?NV:PV)(n,e))}function OV(){this.textContent=""}function LV(t){return function(){this.textContent=t}}function zV(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function MV(t){return arguments.length?this.each(t==null?OV:(typeof t=="function"?zV:LV)(t)):this.node().textContent}function jV(){this.innerHTML=""}function FV(t){return function(){this.innerHTML=t}}function $V(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function UV(t){return arguments.length?this.each(t==null?jV:(typeof t=="function"?$V:FV)(t)):this.node().innerHTML}function BV(){this.nextSibling&&this.parentNode.appendChild(this)}function qV(){return this.each(BV)}function HV(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function KV(){return this.each(HV)}function WV(t){var e=typeof t=="function"?t:SS(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function GV(){return null}function QV(t,e){var n=typeof t=="function"?t:SS(t),r=e==null?GV:typeof e=="function"?e:Sy(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function YV(){var t=this.parentNode;t&&t.removeChild(this)}function XV(){return this.each(YV)}function JV(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function ZV(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function eO(t){return this.select(t?ZV:JV)}function tO(t){return arguments.length?this.property("__data__",t):this.node().__data__}function nO(t){return function(e){t.call(this,e,this.__data__)}}function rO(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function iO(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function sO(t,e,n){return function(){var r=this.__on,i,s=nO(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function oO(t,e,n){var r=rO(t+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(i=0,d=a[l];i<s;++i)if((o=r[i]).type===d.type&&o.name===d.name)return d.value}return}for(a=e?sO:iO,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function OS(t,e,n){var r=kS(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function aO(t,e){return function(){return OS(this,t,e)}}function lO(t,e){return function(){return OS(this,t,e.apply(this,arguments))}}function cO(t,e){return this.each((typeof e=="function"?lO:aO)(t,e))}function*uO(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var LS=[null];function Wn(t,e){this._groups=t,this._parents=e}function ku(){return new Wn([[document.documentElement]],LS)}function dO(){return this}Wn.prototype=ku.prototype={constructor:Wn,select:zD,selectAll:$D,selectChild:HD,selectChildren:QD,filter:YD,data:nV,enter:XD,exit:iV,join:sV,merge:oV,selection:dO,order:aV,sort:lV,call:uV,nodes:dV,node:hV,size:fV,empty:pV,each:mV,attr:bV,style:TV,property:kV,classed:VV,text:MV,html:UV,raise:qV,lower:KV,append:WV,insert:QV,remove:XV,clone:eO,datum:tO,on:oO,dispatch:cO,[Symbol.iterator]:uO};function jn(t){return typeof t=="string"?new Wn([[document.querySelector(t)]],[document.documentElement]):new Wn([[t]],LS)}function hO(t){let e;for(;e=t.sourceEvent;)t=e;return t}function wr(t,e){if(t=hO(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const fO={passive:!1},ru={capture:!0,passive:!1};function im(t){t.stopImmediatePropagation()}function Pa(t){t.preventDefault(),t.stopImmediatePropagation()}function zS(t){var e=t.document.documentElement,n=jn(t).on("dragstart.drag",Pa,ru);"onselectstart"in e?n.on("selectstart.drag",Pa,ru):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function MS(t,e){var n=t.document.documentElement,r=jn(t).on("dragstart.drag",null);e&&(r.on("click.drag",Pa,ru),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const bd=t=>()=>t;function Pg(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}Pg.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function pO(t){return!t.ctrlKey&&!t.button}function mO(){return this.parentNode}function gO(t,e){return e??{x:t.x,y:t.y}}function yO(){return navigator.maxTouchPoints||"ontouchstart"in this}function jS(){var t=pO,e=mO,n=gO,r=yO,i={},s=qf("start","drag","end"),o=0,a,l,c,d,h=0;function f(C){C.on("mousedown.drag",m).filter(r).on("touchstart.drag",T).on("touchmove.drag",y,fO).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(C,O){if(!(d||!t.call(this,C,O))){var z=S(this,e.call(this,C,O),C,O,"mouse");z&&(jn(C.view).on("mousemove.drag",v,ru).on("mouseup.drag",w,ru),zS(C.view),im(C),c=!1,a=C.clientX,l=C.clientY,z("start",C))}}function v(C){if(Pa(C),!c){var O=C.clientX-a,z=C.clientY-l;c=O*O+z*z>h}i.mouse("drag",C)}function w(C){jn(C.view).on("mousemove.drag mouseup.drag",null),MS(C.view,c),Pa(C),i.mouse("end",C)}function T(C,O){if(t.call(this,C,O)){var z=C.changedTouches,A=e.call(this,C,O),E=z.length,b,I;for(b=0;b<E;++b)(I=S(this,A,C,O,z[b].identifier,z[b]))&&(im(C),I("start",C,z[b]))}}function y(C){var O=C.changedTouches,z=O.length,A,E;for(A=0;A<z;++A)(E=i[O[A].identifier])&&(Pa(C),E("drag",C,O[A]))}function _(C){var O=C.changedTouches,z=O.length,A,E;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),A=0;A<z;++A)(E=i[O[A].identifier])&&(im(C),E("end",C,O[A]))}function S(C,O,z,A,E,b){var I=s.copy(),k=wr(b||z,O),N,R,P;if((P=n.call(C,new Pg("beforestart",{sourceEvent:z,target:f,identifier:E,active:o,x:k[0],y:k[1],dx:0,dy:0,dispatch:I}),A))!=null)return N=P.x-k[0]||0,R=P.y-k[1]||0,function F(L,$,j){var M=k,B;switch(L){case"start":i[E]=F,B=o++;break;case"end":delete i[E],--o;case"drag":k=wr(j||$,O),B=o;break}I.call(L,C,new Pg(L,{sourceEvent:$,subject:P,target:f,identifier:E,active:B,x:k[0]+N,y:k[1]+R,dx:k[0]-M[0],dy:k[1]-M[1],dispatch:I}),A)}}return f.filter=function(C){return arguments.length?(t=typeof C=="function"?C:bd(!!C),f):t},f.container=function(C){return arguments.length?(e=typeof C=="function"?C:bd(C),f):e},f.subject=function(C){return arguments.length?(n=typeof C=="function"?C:bd(C),f):n},f.touchable=function(C){return arguments.length?(r=typeof C=="function"?C:bd(!!C),f):r},f.on=function(){var C=s.on.apply(s,arguments);return C===s?f:C},f.clickDistance=function(C){return arguments.length?(h=(C=+C)*C,f):Math.sqrt(h)},f}function Ay(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function FS(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Nu(){}var iu=.7,Kh=1/iu,Da="\\s*([+-]?\\d+)\\s*",su="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",qr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",vO=/^#([0-9a-f]{3,8})$/,wO=new RegExp(`^rgb\\(${Da},${Da},${Da}\\)$`),_O=new RegExp(`^rgb\\(${qr},${qr},${qr}\\)$`),xO=new RegExp(`^rgba\\(${Da},${Da},${Da},${su}\\)$`),bO=new RegExp(`^rgba\\(${qr},${qr},${qr},${su}\\)$`),EO=new RegExp(`^hsl\\(${su},${qr},${qr}\\)$`),IO=new RegExp(`^hsla\\(${su},${qr},${qr},${su}\\)$`),Z_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ay(Nu,ou,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:ex,formatHex:ex,formatHex8:SO,formatHsl:TO,formatRgb:tx,toString:tx});function ex(){return this.rgb().formatHex()}function SO(){return this.rgb().formatHex8()}function TO(){return $S(this).formatHsl()}function tx(){return this.rgb().formatRgb()}function ou(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=vO.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?nx(e):n===3?new wn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ed(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ed(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=wO.exec(t))?new wn(e[1],e[2],e[3],1):(e=_O.exec(t))?new wn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=xO.exec(t))?Ed(e[1],e[2],e[3],e[4]):(e=bO.exec(t))?Ed(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=EO.exec(t))?sx(e[1],e[2]/100,e[3]/100,1):(e=IO.exec(t))?sx(e[1],e[2]/100,e[3]/100,e[4]):Z_.hasOwnProperty(t)?nx(Z_[t]):t==="transparent"?new wn(NaN,NaN,NaN,0):null}function nx(t){return new wn(t>>16&255,t>>8&255,t&255,1)}function Ed(t,e,n,r){return r<=0&&(t=e=n=NaN),new wn(t,e,n,r)}function AO(t){return t instanceof Nu||(t=ou(t)),t?(t=t.rgb(),new wn(t.r,t.g,t.b,t.opacity)):new wn}function Dg(t,e,n,r){return arguments.length===1?AO(t):new wn(t,e,n,r??1)}function wn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}Ay(wn,Dg,FS(Nu,{brighter(t){return t=t==null?Kh:Math.pow(Kh,t),new wn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?iu:Math.pow(iu,t),new wn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new wn(no(this.r),no(this.g),no(this.b),Wh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rx,formatHex:rx,formatHex8:CO,formatRgb:ix,toString:ix}));function rx(){return`#${Qs(this.r)}${Qs(this.g)}${Qs(this.b)}`}function CO(){return`#${Qs(this.r)}${Qs(this.g)}${Qs(this.b)}${Qs((isNaN(this.opacity)?1:this.opacity)*255)}`}function ix(){const t=Wh(this.opacity);return`${t===1?"rgb(":"rgba("}${no(this.r)}, ${no(this.g)}, ${no(this.b)}${t===1?")":`, ${t})`}`}function Wh(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function no(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Qs(t){return t=no(t),(t<16?"0":"")+t.toString(16)}function sx(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new xr(t,e,n,r)}function $S(t){if(t instanceof xr)return new xr(t.h,t.s,t.l,t.opacity);if(t instanceof Nu||(t=ou(t)),!t)return new xr;if(t instanceof xr)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new xr(o,a,l,t.opacity)}function RO(t,e,n,r){return arguments.length===1?$S(t):new xr(t,e,n,r??1)}function xr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}Ay(xr,RO,FS(Nu,{brighter(t){return t=t==null?Kh:Math.pow(Kh,t),new xr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?iu:Math.pow(iu,t),new xr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new wn(sm(t>=240?t-240:t+120,i,r),sm(t,i,r),sm(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new xr(ox(this.h),Id(this.s),Id(this.l),Wh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Wh(this.opacity);return`${t===1?"hsl(":"hsla("}${ox(this.h)}, ${Id(this.s)*100}%, ${Id(this.l)*100}%${t===1?")":`, ${t})`}`}}));function ox(t){return t=(t||0)%360,t<0?t+360:t}function Id(t){return Math.max(0,Math.min(1,t||0))}function sm(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const US=t=>()=>t;function kO(t,e){return function(n){return t+n*e}}function NO(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function PO(t){return(t=+t)==1?BS:function(e,n){return n-e?NO(e,n,t):US(isNaN(e)?n:e)}}function BS(t,e){var n=e-t;return n?kO(t,n):US(isNaN(t)?e:t)}const ax=function t(e){var n=PO(e);function r(i,s){var o=n((i=Dg(i)).r,(s=Dg(s)).r),a=n(i.g,s.g),l=n(i.b,s.b),c=BS(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=a(d),i.b=l(d),i.opacity=c(d),i+""}}return r.gamma=t,r}(1);function Bi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Vg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,om=new RegExp(Vg.source,"g");function DO(t){return function(){return t}}function VO(t){return function(e){return t(e)+""}}function OO(t,e){var n=Vg.lastIndex=om.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=Vg.exec(t))&&(i=om.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:Bi(r,i)})),n=om.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?VO(l[0].x):DO(e):(e=l.length,function(c){for(var d=0,h;d<e;++d)a[(h=l[d]).i]=h.x(c);return a.join("")})}var lx=180/Math.PI,Og={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function qS(t,e,n,r,i,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*lx,skewX:Math.atan(l)*lx,scaleX:o,scaleY:a}}var Sd;function LO(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Og:qS(e.a,e.b,e.c,e.d,e.e,e.f)}function zO(t){return t==null||(Sd||(Sd=document.createElementNS("http://www.w3.org/2000/svg","g")),Sd.setAttribute("transform",t),!(t=Sd.transform.baseVal.consolidate()))?Og:(t=t.matrix,qS(t.a,t.b,t.c,t.d,t.e,t.f))}function HS(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,d,h,f,m,v){if(c!==h||d!==f){var w=m.push("translate(",null,e,null,n);v.push({i:w-4,x:Bi(c,h)},{i:w-2,x:Bi(d,f)})}else(h||f)&&m.push("translate("+h+e+f+n)}function o(c,d,h,f){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:Bi(c,d)})):d&&h.push(i(h)+"rotate("+d+r)}function a(c,d,h,f){c!==d?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:Bi(c,d)}):d&&h.push(i(h)+"skewX("+d+r)}function l(c,d,h,f,m,v){if(c!==h||d!==f){var w=m.push(i(m)+"scale(",null,",",null,")");v.push({i:w-4,x:Bi(c,h)},{i:w-2,x:Bi(d,f)})}else(h!==1||f!==1)&&m.push(i(m)+"scale("+h+","+f+")")}return function(c,d){var h=[],f=[];return c=t(c),d=t(d),s(c.translateX,c.translateY,d.translateX,d.translateY,h,f),o(c.rotate,d.rotate,h,f),a(c.skewX,d.skewX,h,f),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,h,f),c=d=null,function(m){for(var v=-1,w=f.length,T;++v<w;)h[(T=f[v]).i]=T.x(m);return h.join("")}}}var MO=HS(LO,"px, ","px)","deg)"),jO=HS(zO,", ",")",")"),FO=1e-12;function cx(t){return((t=Math.exp(t))+1/t)/2}function $O(t){return((t=Math.exp(t))-1/t)/2}function UO(t){return((t=Math.exp(2*t))-1)/(t+1)}const BO=function t(e,n,r){function i(s,o){var a=s[0],l=s[1],c=s[2],d=o[0],h=o[1],f=o[2],m=d-a,v=h-l,w=m*m+v*v,T,y;if(w<FO)y=Math.log(f/c)/e,T=function(A){return[a+A*m,l+A*v,c*Math.exp(e*A*y)]};else{var _=Math.sqrt(w),S=(f*f-c*c+r*w)/(2*c*n*_),C=(f*f-c*c-r*w)/(2*f*n*_),O=Math.log(Math.sqrt(S*S+1)-S),z=Math.log(Math.sqrt(C*C+1)-C);y=(z-O)/e,T=function(A){var E=A*y,b=cx(O),I=c/(n*_)*(b*UO(e*E+O)-$O(O));return[a+I*m,l+I*v,c*b/cx(e*E+O)]}}return T.duration=y*1e3*e/Math.SQRT2,T}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return t(o,a,l)},i}(Math.SQRT2,2,4);var Qa=0,hc=0,Xl=0,KS=1e3,Gh,fc,Qh=0,fo=0,Kf=0,au=typeof performance=="object"&&performance.now?performance:Date,WS=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Cy(){return fo||(WS(qO),fo=au.now()+Kf)}function qO(){fo=0}function Yh(){this._call=this._time=this._next=null}Yh.prototype=GS.prototype={constructor:Yh,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Cy():+n)+(e==null?0:+e),!this._next&&fc!==this&&(fc?fc._next=this:Gh=this,fc=this),this._call=t,this._time=n,Lg()},stop:function(){this._call&&(this._call=null,this._time=1/0,Lg())}};function GS(t,e,n){var r=new Yh;return r.restart(t,e,n),r}function HO(){Cy(),++Qa;for(var t=Gh,e;t;)(e=fo-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Qa}function ux(){fo=(Qh=au.now())+Kf,Qa=hc=0;try{HO()}finally{Qa=0,WO(),fo=0}}function KO(){var t=au.now(),e=t-Qh;e>KS&&(Kf-=e,Qh=t)}function WO(){for(var t,e=Gh,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:Gh=n);fc=t,Lg(r)}function Lg(t){if(!Qa){hc&&(hc=clearTimeout(hc));var e=t-fo;e>24?(t<1/0&&(hc=setTimeout(ux,t-au.now()-Kf)),Xl&&(Xl=clearInterval(Xl))):(Xl||(Qh=au.now(),Xl=setInterval(KO,KS)),Qa=1,WS(ux))}}function dx(t,e,n){var r=new Yh;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var GO=qf("start","end","cancel","interrupt"),QO=[],QS=0,hx=1,zg=2,nh=3,fx=4,Mg=5,rh=6;function Wf(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;YO(t,n,{name:e,index:r,group:i,on:GO,tween:QO,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:QS})}function Ry(t,e){var n=Rr(t,e);if(n.state>QS)throw new Error("too late; already scheduled");return n}function Qr(t,e){var n=Rr(t,e);if(n.state>nh)throw new Error("too late; already running");return n}function Rr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function YO(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=GS(s,0,n.time);function s(c){n.state=hx,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var d,h,f,m;if(n.state!==hx)return l();for(d in r)if(m=r[d],m.name===n.name){if(m.state===nh)return dx(o);m.state===fx?(m.state=rh,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[d]):+d<e&&(m.state=rh,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[d])}if(dx(function(){n.state===nh&&(n.state=fx,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=zg,n.on.call("start",t,t.__data__,n.index,n.group),n.state===zg){for(n.state=nh,i=new Array(f=n.tween.length),d=0,h=-1;d<f;++d)(m=n.tween[d].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=m);i.length=h+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Mg,1),h=-1,f=i.length;++h<f;)i[h].call(t,d);n.state===Mg&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=rh,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function ih(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>zg&&r.state<Mg,r.state=rh,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function XO(t){return this.each(function(){ih(this,t)})}function JO(t,e){var n,r;return function(){var i=Qr(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function ZO(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Qr(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}s.tween=i}}function e4(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=Rr(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?JO:ZO)(n,t,e))}function ky(t,e,n){var r=t._id;return t.each(function(){var i=Qr(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return Rr(i,r).value[e]}}function YS(t,e){var n;return(typeof e=="number"?Bi:e instanceof ou?ax:(n=ou(e))?(e=n,ax):OO)(t,e)}function t4(t){return function(){this.removeAttribute(t)}}function n4(t){return function(){this.removeAttributeNS(t.space,t.local)}}function r4(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function i4(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function s4(t,e,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function o4(t,e,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function a4(t,e){var n=Hf(t),r=n==="transform"?jO:YS;return this.attrTween(t,typeof e=="function"?(n.local?o4:s4)(n,r,ky(this,"attr."+t,e)):e==null?(n.local?n4:t4)(n):(n.local?i4:r4)(n,r,e))}function l4(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function c4(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function u4(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&c4(t,s)),n}return i._value=e,i}function d4(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&l4(t,s)),n}return i._value=e,i}function h4(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Hf(t);return this.tween(n,(r.local?u4:d4)(r,e))}function f4(t,e){return function(){Ry(this,t).delay=+e.apply(this,arguments)}}function p4(t,e){return e=+e,function(){Ry(this,t).delay=e}}function m4(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?f4:p4)(e,t)):Rr(this.node(),e).delay}function g4(t,e){return function(){Qr(this,t).duration=+e.apply(this,arguments)}}function y4(t,e){return e=+e,function(){Qr(this,t).duration=e}}function v4(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?g4:y4)(e,t)):Rr(this.node(),e).duration}function w4(t,e){if(typeof e!="function")throw new Error;return function(){Qr(this,t).ease=e}}function _4(t){var e=this._id;return arguments.length?this.each(w4(e,t)):Rr(this.node(),e).ease}function x4(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Qr(this,t).ease=n}}function b4(t){if(typeof t!="function")throw new Error;return this.each(x4(this._id,t))}function E4(t){typeof t!="function"&&(t=AS(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new bi(r,this._parents,this._name,this._id)}function I4(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var l=e[a],c=n[a],d=l.length,h=o[a]=new Array(d),f,m=0;m<d;++m)(f=l[m]||c[m])&&(h[m]=f);for(;a<r;++a)o[a]=e[a];return new bi(o,this._parents,this._name,this._id)}function S4(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function T4(t,e,n){var r,i,s=S4(e)?Ry:Qr;return function(){var o=s(this,t),a=o.on;a!==r&&(i=(r=a).copy()).on(e,n),o.on=i}}function A4(t,e){var n=this._id;return arguments.length<2?Rr(this.node(),n).on.on(t):this.each(T4(n,t,e))}function C4(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function R4(){return this.on("end.remove",C4(this._id))}function k4(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Sy(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],l=a.length,c=s[o]=new Array(l),d,h,f=0;f<l;++f)(d=a[f])&&(h=t.call(d,d.__data__,f,a))&&("__data__"in d&&(h.__data__=d.__data__),c[f]=h,Wf(c[f],e,n,f,c,Rr(d,n)));return new bi(s,this._parents,e,n)}function N4(t){var e=this._name,n=this._id;typeof t!="function"&&(t=TS(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l=r[a],c=l.length,d,h=0;h<c;++h)if(d=l[h]){for(var f=t.call(d,d.__data__,h,l),m,v=Rr(d,n),w=0,T=f.length;w<T;++w)(m=f[w])&&Wf(m,e,n,w,f,v);s.push(f),o.push(d)}return new bi(s,o,e,n)}var P4=ku.prototype.constructor;function D4(){return new P4(this._groups,this._parents)}function V4(t,e){var n,r,i;return function(){var s=Ga(this,t),o=(this.style.removeProperty(t),Ga(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function XS(t){return function(){this.style.removeProperty(t)}}function O4(t,e,n){var r,i=n+"",s;return function(){var o=Ga(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function L4(t,e,n){var r,i,s;return function(){var o=Ga(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),Ga(this,t))),o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a))}}function z4(t,e){var n,r,i,s="style."+e,o="end."+s,a;return function(){var l=Qr(this,t),c=l.on,d=l.value[s]==null?a||(a=XS(e)):void 0;(c!==n||i!==d)&&(r=(n=c).copy()).on(o,i=d),l.on=r}}function M4(t,e,n){var r=(t+="")=="transform"?MO:YS;return e==null?this.styleTween(t,V4(t,r)).on("end.style."+t,XS(t)):typeof e=="function"?this.styleTween(t,L4(t,r,ky(this,"style."+t,e))).each(z4(this._id,t)):this.styleTween(t,O4(t,r,e),n).on("end.style."+t,null)}function j4(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function F4(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&j4(t,o,n)),r}return s._value=e,s}function $4(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,F4(t,e,n??""))}function U4(t){return function(){this.textContent=t}}function B4(t){return function(){var e=t(this);this.textContent=e??""}}function q4(t){return this.tween("text",typeof t=="function"?B4(ky(this,"text",t)):U4(t==null?"":t+""))}function H4(t){return function(e){this.textContent=t.call(this,e)}}function K4(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&H4(i)),e}return r._value=t,r}function W4(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,K4(t))}function G4(){for(var t=this._name,e=this._id,n=JS(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var d=Rr(l,e);Wf(l,t,n,c,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new bi(r,this._parents,t,n)}function Q4(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--i===0&&s()}};n.each(function(){var c=Qr(this,r),d=c.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),i===0&&s()})}var Y4=0;function bi(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function JS(){return++Y4}var ni=ku.prototype;bi.prototype={constructor:bi,select:k4,selectAll:N4,selectChild:ni.selectChild,selectChildren:ni.selectChildren,filter:E4,merge:I4,selection:D4,transition:G4,call:ni.call,nodes:ni.nodes,node:ni.node,size:ni.size,empty:ni.empty,each:ni.each,on:A4,attr:a4,attrTween:h4,style:M4,styleTween:$4,text:q4,textTween:W4,remove:R4,tween:e4,delay:m4,duration:v4,ease:_4,easeVarying:b4,end:Q4,[Symbol.iterator]:ni[Symbol.iterator]};function X4(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var J4={time:null,delay:0,duration:250,ease:X4};function Z4(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function e5(t){var e,n;t instanceof bi?(e=t._id,t=t._name):(e=JS(),(n=J4).time=Cy(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&Wf(l,t,e,c,o,n||Z4(l,e));return new bi(r,this._parents,t,e)}ku.prototype.interrupt=XO;ku.prototype.transition=e5;const Td=t=>()=>t;function t5(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function ci(t,e,n){this.k=t,this.x=e,this.y=n}ci.prototype={constructor:ci,scale:function(t){return t===1?this:new ci(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new ci(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var gi=new ci(1,0,0);ci.prototype;function am(t){t.stopImmediatePropagation()}function Jl(t){t.preventDefault(),t.stopImmediatePropagation()}function n5(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function r5(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function px(){return this.__zoom||gi}function i5(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function s5(){return navigator.maxTouchPoints||"ontouchstart"in this}function o5(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function ZS(){var t=n5,e=r5,n=o5,r=i5,i=s5,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=BO,c=qf("start","zoom","end"),d,h,f,m=500,v=150,w=0,T=10;function y(P){P.property("__zoom",px).on("wheel.zoom",E,{passive:!1}).on("mousedown.zoom",b).on("dblclick.zoom",I).filter(i).on("touchstart.zoom",k).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(P,F,L,$){var j=P.selection?P.selection():P;j.property("__zoom",px),P!==j?O(P,F,L,$):j.interrupt().each(function(){z(this,arguments).event($).start().zoom(null,typeof F=="function"?F.apply(this,arguments):F).end()})},y.scaleBy=function(P,F,L,$){y.scaleTo(P,function(){var j=this.__zoom.k,M=typeof F=="function"?F.apply(this,arguments):F;return j*M},L,$)},y.scaleTo=function(P,F,L,$){y.transform(P,function(){var j=e.apply(this,arguments),M=this.__zoom,B=L==null?C(j):typeof L=="function"?L.apply(this,arguments):L,K=M.invert(B),U=typeof F=="function"?F.apply(this,arguments):F;return n(S(_(M,U),B,K),j,o)},L,$)},y.translateBy=function(P,F,L,$){y.transform(P,function(){return n(this.__zoom.translate(typeof F=="function"?F.apply(this,arguments):F,typeof L=="function"?L.apply(this,arguments):L),e.apply(this,arguments),o)},null,$)},y.translateTo=function(P,F,L,$,j){y.transform(P,function(){var M=e.apply(this,arguments),B=this.__zoom,K=$==null?C(M):typeof $=="function"?$.apply(this,arguments):$;return n(gi.translate(K[0],K[1]).scale(B.k).translate(typeof F=="function"?-F.apply(this,arguments):-F,typeof L=="function"?-L.apply(this,arguments):-L),M,o)},$,j)};function _(P,F){return F=Math.max(s[0],Math.min(s[1],F)),F===P.k?P:new ci(F,P.x,P.y)}function S(P,F,L){var $=F[0]-L[0]*P.k,j=F[1]-L[1]*P.k;return $===P.x&&j===P.y?P:new ci(P.k,$,j)}function C(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function O(P,F,L,$){P.on("start.zoom",function(){z(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){z(this,arguments).event($).end()}).tween("zoom",function(){var j=this,M=arguments,B=z(j,M).event($),K=e.apply(j,M),U=L==null?C(K):typeof L=="function"?L.apply(j,M):L,X=Math.max(K[1][0]-K[0][0],K[1][1]-K[0][1]),J=j.__zoom,te=typeof F=="function"?F.apply(j,M):F,ae=l(J.invert(U).concat(X/J.k),te.invert(U).concat(X/te.k));return function(pe){if(pe===1)pe=te;else{var de=ae(pe),xe=X/de[2];pe=new ci(xe,U[0]-de[0]*xe,U[1]-de[1]*xe)}B.zoom(null,pe)}})}function z(P,F,L){return!L&&P.__zooming||new A(P,F)}function A(P,F){this.that=P,this.args=F,this.active=0,this.sourceEvent=null,this.extent=e.apply(P,F),this.taps=0}A.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,F){return this.mouse&&P!=="mouse"&&(this.mouse[1]=F.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=F.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=F.invert(this.touch1[0])),this.that.__zoom=F,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var F=jn(this.that).datum();c.call(P,this.that,new t5(P,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:c}),F)}};function E(P,...F){if(!t.apply(this,arguments))return;var L=z(this,F).event(P),$=this.__zoom,j=Math.max(s[0],Math.min(s[1],$.k*Math.pow(2,r.apply(this,arguments)))),M=wr(P);if(L.wheel)(L.mouse[0][0]!==M[0]||L.mouse[0][1]!==M[1])&&(L.mouse[1]=$.invert(L.mouse[0]=M)),clearTimeout(L.wheel);else{if($.k===j)return;L.mouse=[M,$.invert(M)],ih(this),L.start()}Jl(P),L.wheel=setTimeout(B,v),L.zoom("mouse",n(S(_($,j),L.mouse[0],L.mouse[1]),L.extent,o));function B(){L.wheel=null,L.end()}}function b(P,...F){if(f||!t.apply(this,arguments))return;var L=P.currentTarget,$=z(this,F,!0).event(P),j=jn(P.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",X,!0),M=wr(P,L),B=P.clientX,K=P.clientY;zS(P.view),am(P),$.mouse=[M,this.__zoom.invert(M)],ih(this),$.start();function U(J){if(Jl(J),!$.moved){var te=J.clientX-B,ae=J.clientY-K;$.moved=te*te+ae*ae>w}$.event(J).zoom("mouse",n(S($.that.__zoom,$.mouse[0]=wr(J,L),$.mouse[1]),$.extent,o))}function X(J){j.on("mousemove.zoom mouseup.zoom",null),MS(J.view,$.moved),Jl(J),$.event(J).end()}}function I(P,...F){if(t.apply(this,arguments)){var L=this.__zoom,$=wr(P.changedTouches?P.changedTouches[0]:P,this),j=L.invert($),M=L.k*(P.shiftKey?.5:2),B=n(S(_(L,M),$,j),e.apply(this,F),o);Jl(P),a>0?jn(this).transition().duration(a).call(O,B,$,P):jn(this).call(y.transform,B,$,P)}}function k(P,...F){if(t.apply(this,arguments)){var L=P.touches,$=L.length,j=z(this,F,P.changedTouches.length===$).event(P),M,B,K,U;for(am(P),B=0;B<$;++B)K=L[B],U=wr(K,this),U=[U,this.__zoom.invert(U),K.identifier],j.touch0?!j.touch1&&j.touch0[2]!==U[2]&&(j.touch1=U,j.taps=0):(j.touch0=U,M=!0,j.taps=1+!!d);d&&(d=clearTimeout(d)),M&&(j.taps<2&&(h=U[0],d=setTimeout(function(){d=null},m)),ih(this),j.start())}}function N(P,...F){if(this.__zooming){var L=z(this,F).event(P),$=P.changedTouches,j=$.length,M,B,K,U;for(Jl(P),M=0;M<j;++M)B=$[M],K=wr(B,this),L.touch0&&L.touch0[2]===B.identifier?L.touch0[0]=K:L.touch1&&L.touch1[2]===B.identifier&&(L.touch1[0]=K);if(B=L.that.__zoom,L.touch1){var X=L.touch0[0],J=L.touch0[1],te=L.touch1[0],ae=L.touch1[1],pe=(pe=te[0]-X[0])*pe+(pe=te[1]-X[1])*pe,de=(de=ae[0]-J[0])*de+(de=ae[1]-J[1])*de;B=_(B,Math.sqrt(pe/de)),K=[(X[0]+te[0])/2,(X[1]+te[1])/2],U=[(J[0]+ae[0])/2,(J[1]+ae[1])/2]}else if(L.touch0)K=L.touch0[0],U=L.touch0[1];else return;L.zoom("touch",n(S(B,K,U),L.extent,o))}}function R(P,...F){if(this.__zooming){var L=z(this,F).event(P),$=P.changedTouches,j=$.length,M,B;for(am(P),f&&clearTimeout(f),f=setTimeout(function(){f=null},m),M=0;M<j;++M)B=$[M],L.touch0&&L.touch0[2]===B.identifier?delete L.touch0:L.touch1&&L.touch1[2]===B.identifier&&delete L.touch1;if(L.touch1&&!L.touch0&&(L.touch0=L.touch1,delete L.touch1),L.touch0)L.touch0[1]=this.__zoom.invert(L.touch0[0]);else if(L.end(),L.taps===2&&(B=wr(B,this),Math.hypot(h[0]-B[0],h[1]-B[1])<T)){var K=jn(this).on("dblclick.zoom");K&&K.apply(this,arguments)}}}return y.wheelDelta=function(P){return arguments.length?(r=typeof P=="function"?P:Td(+P),y):r},y.filter=function(P){return arguments.length?(t=typeof P=="function"?P:Td(!!P),y):t},y.touchable=function(P){return arguments.length?(i=typeof P=="function"?P:Td(!!P),y):i},y.extent=function(P){return arguments.length?(e=typeof P=="function"?P:Td([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),y):e},y.scaleExtent=function(P){return arguments.length?(s[0]=+P[0],s[1]=+P[1],y):[s[0],s[1]]},y.translateExtent=function(P){return arguments.length?(o[0][0]=+P[0][0],o[1][0]=+P[1][0],o[0][1]=+P[0][1],o[1][1]=+P[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(P){return arguments.length?(n=P,y):n},y.duration=function(P){return arguments.length?(a=+P,y):a},y.interpolate=function(P){return arguments.length?(l=P,y):l},y.on=function(){var P=c.on.apply(c,arguments);return P===c?y:P},y.clickDistance=function(P){return arguments.length?(w=(P=+P)*P,y):Math.sqrt(w)},y.tapDistance=function(P){return arguments.length?(T=+P,y):T},y}const Gf=D.createContext(null),a5=Gf.Provider,Ei={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,e)=>`Couldn't create edge for ${t?"target":"source"} handle id: "${t?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},eT=Ei.error001();function Ge(t,e){const n=D.useContext(Gf);if(n===null)throw new Error(eT);return IS(n,t,e)}const Et=()=>{const t=D.useContext(Gf);if(t===null)throw new Error(eT);return D.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},l5=t=>t.userSelectionActive?"none":"all";function Ny({position:t,children:e,className:n,style:r,...i}){const s=Ge(l5),o=`${t}`.split("-");return G.createElement("div",{className:Ut(["react-flow__panel",n,...o]),style:{...r,pointerEvents:s},...i},e)}function c5({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:G.createElement(Ny,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},G.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const u5=({x:t,y:e,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d})=>{const h=D.useRef(null),[f,m]=D.useState({x:0,y:0,width:0,height:0}),v=Ut(["react-flow__edge-textwrapper",c]);return D.useEffect(()=>{if(h.current){const w=h.current.getBBox();m({x:w.x,y:w.y,width:w.width,height:w.height})}},[n]),typeof n>"u"||!n?null:G.createElement("g",{transform:`translate(${t-f.width/2} ${e-f.height/2})`,className:v,visibility:f.width?"visible":"hidden",...d},i&&G.createElement("rect",{width:f.width+2*o[0],x:-o[0],y:-o[1],height:f.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),G.createElement("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:h,style:r},n),l)};var d5=D.memo(u5);const Py=t=>({width:t.offsetWidth,height:t.offsetHeight}),ys=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),Dy=(t={x:0,y:0},e)=>({x:ys(t.x,e[0][0],e[1][0]),y:ys(t.y,e[0][1],e[1][1])}),mx=(t,e,n)=>t<e?ys(Math.abs(t-e),1,50)/50:t>n?-ys(Math.abs(t-n),1,50)/50:0,tT=(t,e)=>{const n=mx(t.x,35,e.width-35)*20,r=mx(t.y,35,e.height-35)*20;return[n,r]},nT=t=>{var e;return((e=t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},rT=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),lu=({x:t,y:e,width:n,height:r})=>({x:t,y:e,x2:t+n,y2:e+r}),iT=({x:t,y:e,x2:n,y2:r})=>({x:t,y:e,width:n-t,height:r-e}),gx=t=>({...t.positionAbsolute||{x:0,y:0},width:t.width||0,height:t.height||0}),h5=(t,e)=>iT(rT(lu(t),lu(e))),jg=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),r=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*r)},f5=t=>ir(t.width)&&ir(t.height)&&ir(t.x)&&ir(t.y),ir=t=>!isNaN(t)&&isFinite(t),pt=Symbol.for("internals"),sT=["Enter"," ","Escape"],p5=(t,e)=>{},m5=t=>"nativeEvent"in t;function Fg(t){var i,s;const e=m5(t)?t.nativeEvent:t,n=((s=(i=e.composedPath)==null?void 0:i.call(e))==null?void 0:s[0])||t.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const oT=t=>"clientX"in t,cs=(t,e)=>{var s,o;const n=oT(t),r=n?t.clientX:(s=t.touches)==null?void 0:s[0].clientX,i=n?t.clientY:(o=t.touches)==null?void 0:o[0].clientY;return{x:r-((e==null?void 0:e.left)??0),y:i-((e==null?void 0:e.top)??0)}},Xh=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0},gl=({id:t,path:e,labelX:n,labelY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m=20})=>G.createElement(G.Fragment,null,G.createElement("path",{id:t,style:d,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:h,markerStart:f}),m&&G.createElement("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),i&&ir(n)&&ir(r)?G.createElement(d5,{x:n,y:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c}):null);gl.displayName="BaseEdge";function Zl(t,e,n){return n===void 0?n:r=>{const i=e().edges.find(s=>s.id===t);i&&n(r,{...i})}}function aT({sourceX:t,sourceY:e,targetX:n,targetY:r}){const i=Math.abs(n-t)/2,s=n<t?n+i:n-i,o=Math.abs(r-e)/2,a=r<e?r+o:r-o;return[s,a,i,o]}function lT({sourceX:t,sourceY:e,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const l=t*.125+i*.375+o*.375+n*.125,c=e*.125+s*.375+a*.375+r*.125,d=Math.abs(l-t),h=Math.abs(c-e);return[l,c,d,h]}var po;(function(t){t.Strict="strict",t.Loose="loose"})(po||(po={}));var Ys;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})(Ys||(Ys={}));var cu;(function(t){t.Partial="partial",t.Full="full"})(cu||(cu={}));var Wi;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(Wi||(Wi={}));var Jh;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Jh||(Jh={}));var ce;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(ce||(ce={}));function yx({pos:t,x1:e,y1:n,x2:r,y2:i}){return t===ce.Left||t===ce.Right?[.5*(e+r),n]:[e,.5*(n+i)]}function cT({sourceX:t,sourceY:e,sourcePosition:n=ce.Bottom,targetX:r,targetY:i,targetPosition:s=ce.Top}){const[o,a]=yx({pos:n,x1:t,y1:e,x2:r,y2:i}),[l,c]=yx({pos:s,x1:r,y1:i,x2:t,y2:e}),[d,h,f,m]=lT({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${t},${e} C${o},${a} ${l},${c} ${r},${i}`,d,h,f,m]}const Vy=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:i=ce.Bottom,targetPosition:s=ce.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:v,interactionWidth:w})=>{const[T,y,_]=cT({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:r,targetPosition:s});return G.createElement(gl,{path:T,labelX:y,labelY:_,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:v,interactionWidth:w})});Vy.displayName="SimpleBezierEdge";const vx={[ce.Left]:{x:-1,y:0},[ce.Right]:{x:1,y:0},[ce.Top]:{x:0,y:-1},[ce.Bottom]:{x:0,y:1}},g5=({source:t,sourcePosition:e=ce.Bottom,target:n})=>e===ce.Left||e===ce.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},wx=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function y5({source:t,sourcePosition:e=ce.Bottom,target:n,targetPosition:r=ce.Top,center:i,offset:s}){const o=vx[e],a=vx[r],l={x:t.x+o.x*s,y:t.y+o.y*s},c={x:n.x+a.x*s,y:n.y+a.y*s},d=g5({source:l,sourcePosition:e,target:c}),h=d.x!==0?"x":"y",f=d[h];let m=[],v,w;const T={x:0,y:0},y={x:0,y:0},[_,S,C,O]=aT({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(o[h]*a[h]===-1){v=i.x??_,w=i.y??S;const A=[{x:v,y:l.y},{x:v,y:c.y}],E=[{x:l.x,y:w},{x:c.x,y:w}];o[h]===f?m=h==="x"?A:E:m=h==="x"?E:A}else{const A=[{x:l.x,y:c.y}],E=[{x:c.x,y:l.y}];if(h==="x"?m=o.x===f?E:A:m=o.y===f?A:E,e===r){const R=Math.abs(t[h]-n[h]);if(R<=s){const P=Math.min(s-1,s-R);o[h]===f?T[h]=(l[h]>t[h]?-1:1)*P:y[h]=(c[h]>n[h]?-1:1)*P}}if(e!==r){const R=h==="x"?"y":"x",P=o[h]===a[R],F=l[R]>c[R],L=l[R]<c[R];(o[h]===1&&(!P&&F||P&&L)||o[h]!==1&&(!P&&L||P&&F))&&(m=h==="x"?A:E)}const b={x:l.x+T.x,y:l.y+T.y},I={x:c.x+y.x,y:c.y+y.y},k=Math.max(Math.abs(b.x-m[0].x),Math.abs(I.x-m[0].x)),N=Math.max(Math.abs(b.y-m[0].y),Math.abs(I.y-m[0].y));k>=N?(v=(b.x+I.x)/2,w=m[0].y):(v=m[0].x,w=(b.y+I.y)/2)}return[[t,{x:l.x+T.x,y:l.y+T.y},...m,{x:c.x+y.x,y:c.y+y.y},n],v,w,C,O]}function v5(t,e,n,r){const i=Math.min(wx(t,e)/2,wx(e,n)/2,r),{x:s,y:o}=e;if(t.x===s&&s===n.x||t.y===o&&o===n.y)return`L${s} ${o}`;if(t.y===o){const c=t.x<n.x?-1:1,d=t.y<n.y?1:-1;return`L ${s+i*c},${o}Q ${s},${o} ${s},${o+i*d}`}const a=t.x<n.x?1:-1,l=t.y<n.y?-1:1;return`L ${s},${o+i*l}Q ${s},${o} ${s+i*a},${o}`}function uu({sourceX:t,sourceY:e,sourcePosition:n=ce.Bottom,targetX:r,targetY:i,targetPosition:s=ce.Top,borderRadius:o=5,centerX:a,centerY:l,offset:c=20}){const[d,h,f,m,v]=y5({source:{x:t,y:e},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:l},offset:c});return[d.reduce((T,y,_)=>{let S="";return _>0&&_<d.length-1?S=v5(d[_-1],y,d[_+1],o):S=`${_===0?"M":"L"}${y.x} ${y.y}`,T+=S,T},""),h,f,m,v]}const Qf=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,sourcePosition:h=ce.Bottom,targetPosition:f=ce.Top,markerEnd:m,markerStart:v,pathOptions:w,interactionWidth:T})=>{const[y,_,S]=uu({sourceX:t,sourceY:e,sourcePosition:h,targetX:n,targetY:r,targetPosition:f,borderRadius:w==null?void 0:w.borderRadius,offset:w==null?void 0:w.offset});return G.createElement(gl,{path:y,labelX:_,labelY:S,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:m,markerStart:v,interactionWidth:T})});Qf.displayName="SmoothStepEdge";const Oy=D.memo(t=>{var e;return G.createElement(Qf,{...t,pathOptions:D.useMemo(()=>{var n;return{borderRadius:0,offset:(n=t.pathOptions)==null?void 0:n.offset}},[(e=t.pathOptions)==null?void 0:e.offset])})});Oy.displayName="StepEdge";function uT({sourceX:t,sourceY:e,targetX:n,targetY:r}){const[i,s,o,a]=aT({sourceX:t,sourceY:e,targetX:n,targetY:r});return[`M ${t},${e}L ${n},${r}`,i,s,o,a]}const Ly=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m})=>{const[v,w,T]=uT({sourceX:t,sourceY:e,targetX:n,targetY:r});return G.createElement(gl,{path:v,labelX:w,labelY:T,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m})});Ly.displayName="StraightEdge";function Ad(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function _x({pos:t,x1:e,y1:n,x2:r,y2:i,c:s}){switch(t){case ce.Left:return[e-Ad(e-r,s),n];case ce.Right:return[e+Ad(r-e,s),n];case ce.Top:return[e,n-Ad(n-i,s)];case ce.Bottom:return[e,n+Ad(i-n,s)]}}function zy({sourceX:t,sourceY:e,sourcePosition:n=ce.Bottom,targetX:r,targetY:i,targetPosition:s=ce.Top,curvature:o=.25}){const[a,l]=_x({pos:n,x1:t,y1:e,x2:r,y2:i,c:o}),[c,d]=_x({pos:s,x1:r,y1:i,x2:t,y2:e,c:o}),[h,f,m,v]=lT({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${t},${e} C${a},${l} ${c},${d} ${r},${i}`,h,f,m,v]}const Zh=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:i=ce.Bottom,targetPosition:s=ce.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:v,pathOptions:w,interactionWidth:T})=>{const[y,_,S]=zy({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:r,targetPosition:s,curvature:w==null?void 0:w.curvature});return G.createElement(gl,{path:y,labelX:_,labelY:S,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:v,interactionWidth:T})});Zh.displayName="BezierEdge";const My=D.createContext(null),w5=My.Provider;My.Consumer;const dT=()=>D.useContext(My),_5=t=>"id"in t&&"source"in t&&"target"in t,x5=({source:t,sourceHandle:e,target:n,targetHandle:r})=>`reactflow__edge-${t}${e||""}-${n}${r||""}`,$g=(t,e)=>typeof t>"u"?"":typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(r=>`${r}=${t[r]}`).join("&")}`,b5=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),hT=(t,e)=>{if(!t.source||!t.target)return e;let n;return _5(t)?n={...t}:n={...t,id:x5(t)},b5(n,e)?e:e.concat(n)},Ug=({x:t,y:e},[n,r,i],s,[o,a])=>{const l={x:(t-n)/i,y:(e-r)/i};return s?{x:o*Math.round(l.x/o),y:a*Math.round(l.y/a)}:l},fT=({x:t,y:e},[n,r,i])=>({x:t*i+n,y:e*i+r}),ro=(t,e=[0,0])=>{if(!t)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(t.width??0)*e[0],r=(t.height??0)*e[1],i={x:t.position.x-n,y:t.position.y-r};return{...i,positionAbsolute:t.positionAbsolute?{x:t.positionAbsolute.x-n,y:t.positionAbsolute.y-r}:i}},Pu=(t,e=[0,0])=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((r,i)=>{const{x:s,y:o}=ro(i,e).positionAbsolute;return rT(r,lu({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return iT(n)},pT=(t,e,[n,r,i]=[0,0,1],s=!1,o=!1,a=[0,0])=>{const l={x:(e.x-n)/i,y:(e.y-r)/i,width:e.width/i,height:e.height/i},c=[];return t.forEach(d=>{const{width:h,height:f,selectable:m=!0,hidden:v=!1}=d;if(o&&!m||v)return!1;const{positionAbsolute:w}=ro(d,a),T={x:w.x,y:w.y,width:h||0,height:f||0},y=jg(l,T),_=typeof h>"u"||typeof f>"u"||h===null||f===null,S=s&&y>0,C=(h||0)*(f||0);(_||S||y>=C||d.dragging)&&c.push(d)}),c},mT=(t,e)=>{const n=t.map(r=>r.id);return e.filter(r=>n.includes(r.source)||n.includes(r.target))},gT=(t,e,n,r,i,s=.1)=>{const o=e/(t.width*(1+s)),a=n/(t.height*(1+s)),l=Math.min(o,a),c=ys(l,r,i),d=t.x+t.width/2,h=t.y+t.height/2,f=e/2-d*c,m=n/2-h*c;return{x:f,y:m,zoom:c}},js=(t,e=0)=>t.transition().duration(e);function xx(t,e,n,r){return(e[n]||[]).reduce((i,s)=>{var o,a;return`${t.id}-${s.id}-${n}`!==r&&i.push({id:s.id||null,type:n,nodeId:t.id,x:(((o=t.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((a=t.positionAbsolute)==null?void 0:a.y)??0)+s.y+s.height/2}),i},[])}function E5(t,e,n,r,i,s){const{x:o,y:a}=cs(t),c=e.elementsFromPoint(o,a).find(v=>v.classList.contains("react-flow__handle"));if(c){const v=c.getAttribute("data-nodeid");if(v){const w=jy(void 0,c),T=c.getAttribute("data-handleid"),y=s({nodeId:v,id:T,type:w});if(y){const _=i.find(S=>S.nodeId===v&&S.type===w&&S.id===T);return{handle:{id:T,type:w,nodeId:v,x:(_==null?void 0:_.x)||n.x,y:(_==null?void 0:_.y)||n.y},validHandleResult:y}}}}let d=[],h=1/0;if(i.forEach(v=>{const w=Math.sqrt((v.x-n.x)**2+(v.y-n.y)**2);if(w<=r){const T=s(v);w<=h&&(w<h?d=[{handle:v,validHandleResult:T}]:w===h&&d.push({handle:v,validHandleResult:T}),h=w)}}),!d.length)return{handle:null,validHandleResult:yT()};if(d.length===1)return d[0];const f=d.some(({validHandleResult:v})=>v.isValid),m=d.some(({handle:v})=>v.type==="target");return d.find(({handle:v,validHandleResult:w})=>m?v.type==="target":f?w.isValid:!0)||d[0]}const I5={source:null,target:null,sourceHandle:null,targetHandle:null},yT=()=>({handleDomNode:null,isValid:!1,connection:I5,endHandle:null});function vT(t,e,n,r,i,s,o){const a=i==="target",l=o.querySelector(`.react-flow__handle[data-id="${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`),c={...yT(),handleDomNode:l};if(l){const d=jy(void 0,l),h=l.getAttribute("data-nodeid"),f=l.getAttribute("data-handleid"),m=l.classList.contains("connectable"),v=l.classList.contains("connectableend"),w={source:a?h:n,sourceHandle:a?f:r,target:a?n:h,targetHandle:a?r:f};c.connection=w,m&&v&&(e===po.Strict?a&&d==="source"||!a&&d==="target":h!==n||f!==r)&&(c.endHandle={nodeId:h,handleId:f,type:d},c.isValid=s(w))}return c}function S5({nodes:t,nodeId:e,handleId:n,handleType:r}){return t.reduce((i,s)=>{if(s[pt]){const{handleBounds:o}=s[pt];let a=[],l=[];o&&(a=xx(s,o,"source",`${e}-${n}-${r}`),l=xx(s,o,"target",`${e}-${n}-${r}`)),i.push(...a,...l)}return i},[])}function jy(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function lm(t){t==null||t.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function T5(t,e){let n=null;return e?n="valid":t&&!e&&(n="invalid"),n}function wT({event:t,handleId:e,nodeId:n,onConnect:r,isTarget:i,getState:s,setState:o,isValidConnection:a,edgeUpdaterType:l,onReconnectEnd:c}){const d=nT(t.target),{connectionMode:h,domNode:f,autoPanOnConnect:m,connectionRadius:v,onConnectStart:w,panBy:T,getNodes:y,cancelConnection:_}=s();let S=0,C;const{x:O,y:z}=cs(t),A=d==null?void 0:d.elementFromPoint(O,z),E=jy(l,A),b=f==null?void 0:f.getBoundingClientRect();if(!b||!E)return;let I,k=cs(t,b),N=!1,R=null,P=!1,F=null;const L=S5({nodes:y(),nodeId:n,handleId:e,handleType:E}),$=()=>{if(!m)return;const[B,K]=tT(k,b);T({x:B,y:K}),S=requestAnimationFrame($)};o({connectionPosition:k,connectionStatus:null,connectionNodeId:n,connectionHandleId:e,connectionHandleType:E,connectionStartHandle:{nodeId:n,handleId:e,type:E},connectionEndHandle:null}),w==null||w(t,{nodeId:n,handleId:e,handleType:E});function j(B){const{transform:K}=s();k=cs(B,b);const{handle:U,validHandleResult:X}=E5(B,d,Ug(k,K,!1,[1,1]),v,L,J=>vT(J,h,n,e,i?"target":"source",a,d));if(C=U,N||($(),N=!0),F=X.handleDomNode,R=X.connection,P=X.isValid,o({connectionPosition:C&&P?fT({x:C.x,y:C.y},K):k,connectionStatus:T5(!!C,P),connectionEndHandle:X.endHandle}),!C&&!P&&!F)return lm(I);R.source!==R.target&&F&&(lm(I),I=F,F.classList.add("connecting","react-flow__handle-connecting"),F.classList.toggle("valid",P),F.classList.toggle("react-flow__handle-valid",P))}function M(B){var K,U;(C||F)&&R&&P&&(r==null||r(R)),(U=(K=s()).onConnectEnd)==null||U.call(K,B),l&&(c==null||c(B)),lm(I),_(),cancelAnimationFrame(S),N=!1,P=!1,R=null,F=null,d.removeEventListener("mousemove",j),d.removeEventListener("mouseup",M),d.removeEventListener("touchmove",j),d.removeEventListener("touchend",M)}d.addEventListener("mousemove",j),d.addEventListener("mouseup",M),d.addEventListener("touchmove",j),d.addEventListener("touchend",M)}const bx=()=>!0,A5=t=>({connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName}),C5=(t,e,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=r;return{connecting:(i==null?void 0:i.nodeId)===t&&(i==null?void 0:i.handleId)===e&&(i==null?void 0:i.type)===n||(s==null?void 0:s.nodeId)===t&&(s==null?void 0:s.handleId)===e&&(s==null?void 0:s.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===t&&(o==null?void 0:o.handleId)===e&&(o==null?void 0:o.type)===n}},_T=D.forwardRef(({type:t="source",position:e=ce.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:h,...f},m)=>{var b,I;const v=o||null,w=t==="target",T=Et(),y=dT(),{connectOnClick:_,noPanClassName:S}=Ge(A5,$t),{connecting:C,clickConnecting:O}=Ge(C5(y,v,t),$t);y||(I=(b=T.getState()).onError)==null||I.call(b,"010",Ei.error010());const z=k=>{const{defaultEdgeOptions:N,onConnect:R,hasDefaultEdges:P}=T.getState(),F={...N,...k};if(P){const{edges:L,setEdges:$}=T.getState();$(hT(F,L))}R==null||R(F),a==null||a(F)},A=k=>{if(!y)return;const N=oT(k);i&&(N&&k.button===0||!N)&&wT({event:k,handleId:v,nodeId:y,onConnect:z,isTarget:w,getState:T.getState,setState:T.setState,isValidConnection:n||T.getState().isValidConnection||bx}),N?d==null||d(k):h==null||h(k)},E=k=>{const{onClickConnectStart:N,onClickConnectEnd:R,connectionClickStartHandle:P,connectionMode:F,isValidConnection:L}=T.getState();if(!y||!P&&!i)return;if(!P){N==null||N(k,{nodeId:y,handleId:v,handleType:t}),T.setState({connectionClickStartHandle:{nodeId:y,type:t,handleId:v}});return}const $=nT(k.target),j=n||L||bx,{connection:M,isValid:B}=vT({nodeId:y,id:v,type:t},F,P.nodeId,P.handleId||null,P.type,j,$);B&&z(M),R==null||R(k),T.setState({connectionClickStartHandle:null})};return G.createElement("div",{"data-handleid":v,"data-nodeid":y,"data-handlepos":e,"data-id":`${y}-${v}-${t}`,className:Ut(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",S,c,{source:!w,target:w,connectable:r,connectablestart:i,connectableend:s,connecting:O,connectionindicator:r&&(i&&!C||s&&C)}]),onMouseDown:A,onTouchStart:A,onClick:_?E:void 0,ref:m,...f},l)});_T.displayName="Handle";var kn=D.memo(_T);const xT=({data:t,isConnectable:e,targetPosition:n=ce.Top,sourcePosition:r=ce.Bottom})=>G.createElement(G.Fragment,null,G.createElement(kn,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label,G.createElement(kn,{type:"source",position:r,isConnectable:e}));xT.displayName="DefaultNode";var Bg=D.memo(xT);const bT=({data:t,isConnectable:e,sourcePosition:n=ce.Bottom})=>G.createElement(G.Fragment,null,t==null?void 0:t.label,G.createElement(kn,{type:"source",position:n,isConnectable:e}));bT.displayName="InputNode";var ET=D.memo(bT);const IT=({data:t,isConnectable:e,targetPosition:n=ce.Top})=>G.createElement(G.Fragment,null,G.createElement(kn,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label);IT.displayName="OutputNode";var ST=D.memo(IT);const Fy=()=>null;Fy.displayName="GroupNode";const R5=t=>({selectedNodes:t.getNodes().filter(e=>e.selected),selectedEdges:t.edges.filter(e=>e.selected).map(e=>({...e}))}),Cd=t=>t.id;function k5(t,e){return $t(t.selectedNodes.map(Cd),e.selectedNodes.map(Cd))&&$t(t.selectedEdges.map(Cd),e.selectedEdges.map(Cd))}const TT=D.memo(({onSelectionChange:t})=>{const e=Et(),{selectedNodes:n,selectedEdges:r}=Ge(R5,k5);return D.useEffect(()=>{const i={nodes:n,edges:r};t==null||t(i),e.getState().onSelectionChange.forEach(s=>s(i))},[n,r,t]),null});TT.displayName="SelectionListener";const N5=t=>!!t.onSelectionChange;function P5({onSelectionChange:t}){const e=Ge(N5);return t||e?G.createElement(TT,{onSelectionChange:t}):null}const D5=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset});function Xo(t,e){D.useEffect(()=>{typeof t<"u"&&e(t)},[t])}function Te(t,e,n){D.useEffect(()=>{typeof e<"u"&&n({[t]:e})},[e])}const V5=({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:c,nodesConnectable:d,nodesFocusable:h,edgesFocusable:f,edgesUpdatable:m,elevateNodesOnSelect:v,minZoom:w,maxZoom:T,nodeExtent:y,onNodesChange:_,onEdgesChange:S,elementsSelectable:C,connectionMode:O,snapGrid:z,snapToGrid:A,translateExtent:E,connectOnClick:b,defaultEdgeOptions:I,fitView:k,fitViewOptions:N,onNodesDelete:R,onEdgesDelete:P,onNodeDrag:F,onNodeDragStart:L,onNodeDragStop:$,onSelectionDrag:j,onSelectionDragStart:M,onSelectionDragStop:B,noPanClassName:K,nodeOrigin:U,rfId:X,autoPanOnConnect:J,autoPanOnNodeDrag:te,onError:ae,connectionRadius:pe,isValidConnection:de,nodeDragThreshold:xe})=>{const{setNodes:be,setEdges:ke,setDefaultNodesAndEdges:He,setMinZoom:Ve,setMaxZoom:Xe,setTranslateExtent:ve,setNodeExtent:mt,reset:Ne}=Ge(D5,$t),oe=Et();return D.useEffect(()=>{const Ae=r==null?void 0:r.map(Pt=>({...Pt,...I}));return He(n,Ae),()=>{Ne()}},[]),Te("defaultEdgeOptions",I,oe.setState),Te("connectionMode",O,oe.setState),Te("onConnect",i,oe.setState),Te("onConnectStart",s,oe.setState),Te("onConnectEnd",o,oe.setState),Te("onClickConnectStart",a,oe.setState),Te("onClickConnectEnd",l,oe.setState),Te("nodesDraggable",c,oe.setState),Te("nodesConnectable",d,oe.setState),Te("nodesFocusable",h,oe.setState),Te("edgesFocusable",f,oe.setState),Te("edgesUpdatable",m,oe.setState),Te("elementsSelectable",C,oe.setState),Te("elevateNodesOnSelect",v,oe.setState),Te("snapToGrid",A,oe.setState),Te("snapGrid",z,oe.setState),Te("onNodesChange",_,oe.setState),Te("onEdgesChange",S,oe.setState),Te("connectOnClick",b,oe.setState),Te("fitViewOnInit",k,oe.setState),Te("fitViewOnInitOptions",N,oe.setState),Te("onNodesDelete",R,oe.setState),Te("onEdgesDelete",P,oe.setState),Te("onNodeDrag",F,oe.setState),Te("onNodeDragStart",L,oe.setState),Te("onNodeDragStop",$,oe.setState),Te("onSelectionDrag",j,oe.setState),Te("onSelectionDragStart",M,oe.setState),Te("onSelectionDragStop",B,oe.setState),Te("noPanClassName",K,oe.setState),Te("nodeOrigin",U,oe.setState),Te("rfId",X,oe.setState),Te("autoPanOnConnect",J,oe.setState),Te("autoPanOnNodeDrag",te,oe.setState),Te("onError",ae,oe.setState),Te("connectionRadius",pe,oe.setState),Te("isValidConnection",de,oe.setState),Te("nodeDragThreshold",xe,oe.setState),Xo(t,be),Xo(e,ke),Xo(w,Ve),Xo(T,Xe),Xo(E,ve),Xo(y,mt),null},Ex={display:"none"},O5={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},AT="react-flow__node-desc",CT="react-flow__edge-desc",L5="react-flow__aria-live",z5=t=>t.ariaLiveMessage;function M5({rfId:t}){const e=Ge(z5);return G.createElement("div",{id:`${L5}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:O5},e)}function j5({rfId:t,disableKeyboardA11y:e}){return G.createElement(G.Fragment,null,G.createElement("div",{id:`${AT}-${t}`,style:Ex},"Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),G.createElement("div",{id:`${CT}-${t}`,style:Ex},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!e&&G.createElement(M5,{rfId:t}))}var du=(t=null,e={actInsideInputWithModifier:!0})=>{const[n,r]=D.useState(!1),i=D.useRef(!1),s=D.useRef(new Set([])),[o,a]=D.useMemo(()=>{if(t!==null){const c=(Array.isArray(t)?t:[t]).filter(h=>typeof h=="string").map(h=>h.split("+")),d=c.reduce((h,f)=>h.concat(...f),[]);return[c,d]}return[[],[]]},[t]);return D.useEffect(()=>{const l=typeof document<"u"?document:null,c=(e==null?void 0:e.target)||l;if(t!==null){const d=m=>{if(i.current=m.ctrlKey||m.metaKey||m.shiftKey,(!i.current||i.current&&!e.actInsideInputWithModifier)&&Fg(m))return!1;const w=Sx(m.code,a);s.current.add(m[w]),Ix(o,s.current,!1)&&(m.preventDefault(),r(!0))},h=m=>{if((!i.current||i.current&&!e.actInsideInputWithModifier)&&Fg(m))return!1;const w=Sx(m.code,a);Ix(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(m[w]),m.key==="Meta"&&s.current.clear(),i.current=!1},f=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",d),c==null||c.addEventListener("keyup",h),window.addEventListener("blur",f),()=>{c==null||c.removeEventListener("keydown",d),c==null||c.removeEventListener("keyup",h),window.removeEventListener("blur",f)}}},[t,r]),n};function Ix(t,e,n){return t.filter(r=>n||r.length===e.size).some(r=>r.every(i=>e.has(i)))}function Sx(t,e){return e.includes(t)?"code":"key"}function RT(t,e,n,r){var a,l;const i=t.parentNode||t.parentId;if(!i)return n;const s=e.get(i),o=ro(s,r);return RT(s,e,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((a=s[pt])==null?void 0:a.z)??0)>(n.z??0)?((l=s[pt])==null?void 0:l.z)??0:n.z??0},r)}function kT(t,e,n){t.forEach(r=>{var s;const i=r.parentNode||r.parentId;if(i&&!t.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:o,y:a,z:l}=RT(r,t,{...r.position,z:((s=r[pt])==null?void 0:s.z)??0},e);r.positionAbsolute={x:o,y:a},r[pt].z=l,n!=null&&n[r.id]&&(r[pt].isParent=!0)}})}function cm(t,e,n,r){const i=new Map,s={},o=r?1e3:0;return t.forEach(a=>{var m;const l=(ir(a.zIndex)?a.zIndex:0)+(a.selected?o:0),c=e.get(a.id),d={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},h=a.parentNode||a.parentId;h&&(s[h]=!0);const f=(c==null?void 0:c.type)&&(c==null?void 0:c.type)!==a.type;Object.defineProperty(d,pt,{enumerable:!1,value:{handleBounds:f||(m=c==null?void 0:c[pt])==null?void 0:m.handleBounds,z:l}}),i.set(a.id,d)}),kT(i,n,s),i}function NT(t,e={}){const{getNodes:n,width:r,height:i,minZoom:s,maxZoom:o,d3Zoom:a,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:h}=t(),f=e.initial&&!c&&d;if(a&&l&&(f||!e.initial)){const v=n().filter(T=>{var _;const y=e.includeHiddenNodes?T.width&&T.height:!T.hidden;return(_=e.nodes)!=null&&_.length?y&&e.nodes.some(S=>S.id===T.id):y}),w=v.every(T=>T.width&&T.height);if(v.length>0&&w){const T=Pu(v,h),{x:y,y:_,zoom:S}=gT(T,r,i,e.minZoom??s,e.maxZoom??o,e.padding??.1),C=gi.translate(y,_).scale(S);return typeof e.duration=="number"&&e.duration>0?a.transform(js(l,e.duration),C):a.transform(l,C),!0}}return!1}function F5(t,e){return t.forEach(n=>{const r=e.get(n.id);r&&e.set(r.id,{...r,[pt]:r[pt],selected:n.selected})}),new Map(e)}function $5(t,e){return e.map(n=>{const r=t.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function Rd({changedNodes:t,changedEdges:e,get:n,set:r}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:c}=n();t!=null&&t.length&&(l&&r({nodeInternals:F5(t,i)}),o==null||o(t)),e!=null&&e.length&&(c&&r({edges:$5(e,s)}),a==null||a(e))}const Jo=()=>{},U5={zoomIn:Jo,zoomOut:Jo,zoomTo:Jo,getZoom:()=>1,setViewport:Jo,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Jo,fitBounds:Jo,project:t=>t,screenToFlowPosition:t=>t,flowToScreenPosition:t=>t,viewportInitialized:!1},B5=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}),q5=()=>{const t=Et(),{d3Zoom:e,d3Selection:n}=Ge(B5,$t);return D.useMemo(()=>n&&e?{zoomIn:i=>e.scaleBy(js(n,i==null?void 0:i.duration),1.2),zoomOut:i=>e.scaleBy(js(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>e.scaleTo(js(n,s==null?void 0:s.duration),i),getZoom:()=>t.getState().transform[2],setViewport:(i,s)=>{const[o,a,l]=t.getState().transform,c=gi.translate(i.x??o,i.y??a).scale(i.zoom??l);e.transform(js(n,s==null?void 0:s.duration),c)},getViewport:()=>{const[i,s,o]=t.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>NT(t.getState,i),setCenter:(i,s,o)=>{const{width:a,height:l,maxZoom:c}=t.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:c,h=a/2-i*d,f=l/2-s*d,m=gi.translate(h,f).scale(d);e.transform(js(n,o==null?void 0:o.duration),m)},fitBounds:(i,s)=>{const{width:o,height:a,minZoom:l,maxZoom:c}=t.getState(),{x:d,y:h,zoom:f}=gT(i,o,a,l,c,(s==null?void 0:s.padding)??.1),m=gi.translate(d,h).scale(f);e.transform(js(n,s==null?void 0:s.duration),m)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:a}=t.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),Ug(i,s,o,a)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:a,domNode:l}=t.getState();if(!l)return i;const{x:c,y:d}=l.getBoundingClientRect(),h={x:i.x-c,y:i.y-d};return Ug(h,s,o,a)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=t.getState();if(!o)return i;const{x:a,y:l}=o.getBoundingClientRect(),c=fT(i,s);return{x:c.x+a,y:c.y+l}},viewportInitialized:!0}:U5,[e,n])};function Yr(){const t=q5(),e=Et(),n=D.useCallback(()=>e.getState().getNodes().map(w=>({...w})),[]),r=D.useCallback(w=>e.getState().nodeInternals.get(w),[]),i=D.useCallback(()=>{const{edges:w=[]}=e.getState();return w.map(T=>({...T}))},[]),s=D.useCallback(w=>{const{edges:T=[]}=e.getState();return T.find(y=>y.id===w)},[]),o=D.useCallback(w=>{const{getNodes:T,setNodes:y,hasDefaultNodes:_,onNodesChange:S}=e.getState(),C=T(),O=typeof w=="function"?w(C):w;if(_)y(O);else if(S){const z=O.length===0?C.map(A=>({type:"remove",id:A.id})):O.map(A=>({item:A,type:"reset"}));S(z)}},[]),a=D.useCallback(w=>{const{edges:T=[],setEdges:y,hasDefaultEdges:_,onEdgesChange:S}=e.getState(),C=typeof w=="function"?w(T):w;if(_)y(C);else if(S){const O=C.length===0?T.map(z=>({type:"remove",id:z.id})):C.map(z=>({item:z,type:"reset"}));S(O)}},[]),l=D.useCallback(w=>{const T=Array.isArray(w)?w:[w],{getNodes:y,setNodes:_,hasDefaultNodes:S,onNodesChange:C}=e.getState();if(S){const z=[...y(),...T];_(z)}else if(C){const O=T.map(z=>({item:z,type:"add"}));C(O)}},[]),c=D.useCallback(w=>{const T=Array.isArray(w)?w:[w],{edges:y=[],setEdges:_,hasDefaultEdges:S,onEdgesChange:C}=e.getState();if(S)_([...y,...T]);else if(C){const O=T.map(z=>({item:z,type:"add"}));C(O)}},[]),d=D.useCallback(()=>{const{getNodes:w,edges:T=[],transform:y}=e.getState(),[_,S,C]=y;return{nodes:w().map(O=>({...O})),edges:T.map(O=>({...O})),viewport:{x:_,y:S,zoom:C}}},[]),h=D.useCallback(({nodes:w,edges:T})=>{const{nodeInternals:y,getNodes:_,edges:S,hasDefaultNodes:C,hasDefaultEdges:O,onNodesDelete:z,onEdgesDelete:A,onNodesChange:E,onEdgesChange:b}=e.getState(),I=(w||[]).map(F=>F.id),k=(T||[]).map(F=>F.id),N=_().reduce((F,L)=>{const $=L.parentNode||L.parentId,j=!I.includes(L.id)&&$&&F.find(B=>B.id===$);return(typeof L.deletable=="boolean"?L.deletable:!0)&&(I.includes(L.id)||j)&&F.push(L),F},[]),R=S.filter(F=>typeof F.deletable=="boolean"?F.deletable:!0),P=R.filter(F=>k.includes(F.id));if(N||P){const F=mT(N,R),L=[...P,...F],$=L.reduce((j,M)=>(j.includes(M.id)||j.push(M.id),j),[]);if((O||C)&&(O&&e.setState({edges:S.filter(j=>!$.includes(j.id))}),C&&(N.forEach(j=>{y.delete(j.id)}),e.setState({nodeInternals:new Map(y)}))),$.length>0&&(A==null||A(L),b&&b($.map(j=>({id:j,type:"remove"})))),N.length>0&&(z==null||z(N),E)){const j=N.map(M=>({id:M.id,type:"remove"}));E(j)}}},[]),f=D.useCallback(w=>{const T=f5(w),y=T?null:e.getState().nodeInternals.get(w.id);return!T&&!y?[null,null,T]:[T?w:gx(y),y,T]},[]),m=D.useCallback((w,T=!0,y)=>{const[_,S,C]=f(w);return _?(y||e.getState().getNodes()).filter(O=>{if(!C&&(O.id===S.id||!O.positionAbsolute))return!1;const z=gx(O),A=jg(z,_);return T&&A>0||A>=_.width*_.height}):[]},[]),v=D.useCallback((w,T,y=!0)=>{const[_]=f(w);if(!_)return!1;const S=jg(_,T);return y&&S>0||S>=_.width*_.height},[]);return D.useMemo(()=>({...t,getNodes:n,getNode:r,getEdges:i,getEdge:s,setNodes:o,setEdges:a,addNodes:l,addEdges:c,toObject:d,deleteElements:h,getIntersectingNodes:m,isNodeIntersecting:v}),[t,n,r,i,s,o,a,l,c,d,h,m,v])}const H5={actInsideInputWithModifier:!1};var K5=({deleteKeyCode:t,multiSelectionKeyCode:e})=>{const n=Et(),{deleteElements:r}=Yr(),i=du(t,H5),s=du(e);D.useEffect(()=>{if(i){const{edges:o,getNodes:a}=n.getState(),l=a().filter(d=>d.selected),c=o.filter(d=>d.selected);r({nodes:l,edges:c}),n.setState({nodesSelectionActive:!1})}},[i]),D.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function W5(t){const e=Et();D.useEffect(()=>{let n;const r=()=>{var s,o;if(!t.current)return;const i=Py(t.current);(i.height===0||i.width===0)&&((o=(s=e.getState()).onError)==null||o.call(s,"004",Ei.error004())),e.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),t.current&&(n=new ResizeObserver(()=>r()),n.observe(t.current)),()=>{window.removeEventListener("resize",r),n&&t.current&&n.unobserve(t.current)}},[])}const $y={position:"absolute",width:"100%",height:"100%",top:0,left:0},G5=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,kd=t=>({x:t.x,y:t.y,zoom:t.k}),Zo=(t,e)=>t.target.closest(`.${e}`),Tx=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),Ax=t=>{const e=t.ctrlKey&&Xh()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e},Q5=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler,userSelectionActive:t.userSelectionActive}),Y5=({onMove:t,onMoveStart:e,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=Ys.Free,zoomOnDoubleClick:c=!0,elementsSelectable:d,panOnDrag:h=!0,defaultViewport:f,translateExtent:m,minZoom:v,maxZoom:w,zoomActivationKeyCode:T,preventScrolling:y=!0,children:_,noWheelClassName:S,noPanClassName:C})=>{const O=D.useRef(),z=Et(),A=D.useRef(!1),E=D.useRef(!1),b=D.useRef(null),I=D.useRef({x:0,y:0,zoom:0}),{d3Zoom:k,d3Selection:N,d3ZoomHandler:R,userSelectionActive:P}=Ge(Q5,$t),F=du(T),L=D.useRef(0),$=D.useRef(!1),j=D.useRef();return W5(b),D.useEffect(()=>{if(b.current){const M=b.current.getBoundingClientRect(),B=ZS().scaleExtent([v,w]).translateExtent(m),K=jn(b.current).call(B),U=gi.translate(f.x,f.y).scale(ys(f.zoom,v,w)),X=[[0,0],[M.width,M.height]],J=B.constrain()(U,X,m);B.transform(K,J),B.wheelDelta(Ax),z.setState({d3Zoom:B,d3Selection:K,d3ZoomHandler:K.on("wheel.zoom"),transform:[J.x,J.y,J.k],domNode:b.current.closest(".react-flow")})}},[]),D.useEffect(()=>{N&&k&&(o&&!F&&!P?N.on("wheel.zoom",M=>{if(Zo(M,S))return!1;M.preventDefault(),M.stopImmediatePropagation();const B=N.property("__zoom").k||1;if(M.ctrlKey&&s){const de=wr(M),xe=Ax(M),be=B*Math.pow(2,xe);k.scaleTo(N,be,de,M);return}const K=M.deltaMode===1?20:1;let U=l===Ys.Vertical?0:M.deltaX*K,X=l===Ys.Horizontal?0:M.deltaY*K;!Xh()&&M.shiftKey&&l!==Ys.Vertical&&(U=M.deltaY*K,X=0),k.translateBy(N,-(U/B)*a,-(X/B)*a,{internal:!0});const J=kd(N.property("__zoom")),{onViewportChangeStart:te,onViewportChange:ae,onViewportChangeEnd:pe}=z.getState();clearTimeout(j.current),$.current||($.current=!0,e==null||e(M,J),te==null||te(J)),$.current&&(t==null||t(M,J),ae==null||ae(J),j.current=setTimeout(()=>{n==null||n(M,J),pe==null||pe(J),$.current=!1},150))},{passive:!1}):typeof R<"u"&&N.on("wheel.zoom",function(M,B){if(!y&&M.type==="wheel"&&!M.ctrlKey||Zo(M,S))return null;M.preventDefault(),R.call(this,M,B)},{passive:!1}))},[P,o,l,N,k,R,F,s,y,S,e,t,n]),D.useEffect(()=>{k&&k.on("start",M=>{var U,X;if(!M.sourceEvent||M.sourceEvent.internal)return null;L.current=(U=M.sourceEvent)==null?void 0:U.button;const{onViewportChangeStart:B}=z.getState(),K=kd(M.transform);A.current=!0,I.current=K,((X=M.sourceEvent)==null?void 0:X.type)==="mousedown"&&z.setState({paneDragging:!0}),B==null||B(K),e==null||e(M.sourceEvent,K)})},[k,e]),D.useEffect(()=>{k&&(P&&!A.current?k.on("zoom",null):P||k.on("zoom",M=>{var K;const{onViewportChange:B}=z.getState();if(z.setState({transform:[M.transform.x,M.transform.y,M.transform.k]}),E.current=!!(r&&Tx(h,L.current??0)),(t||B)&&!((K=M.sourceEvent)!=null&&K.internal)){const U=kd(M.transform);B==null||B(U),t==null||t(M.sourceEvent,U)}}))},[P,k,t,h,r]),D.useEffect(()=>{k&&k.on("end",M=>{if(!M.sourceEvent||M.sourceEvent.internal)return null;const{onViewportChangeEnd:B}=z.getState();if(A.current=!1,z.setState({paneDragging:!1}),r&&Tx(h,L.current??0)&&!E.current&&r(M.sourceEvent),E.current=!1,(n||B)&&G5(I.current,M.transform)){const K=kd(M.transform);I.current=K,clearTimeout(O.current),O.current=setTimeout(()=>{B==null||B(K),n==null||n(M.sourceEvent,K)},o?150:0)}})},[k,o,h,n,r]),D.useEffect(()=>{k&&k.filter(M=>{const B=F||i,K=s&&M.ctrlKey;if((h===!0||Array.isArray(h)&&h.includes(1))&&M.button===1&&M.type==="mousedown"&&(Zo(M,"react-flow__node")||Zo(M,"react-flow__edge")))return!0;if(!h&&!B&&!o&&!c&&!s||P||!c&&M.type==="dblclick"||Zo(M,S)&&M.type==="wheel"||Zo(M,C)&&(M.type!=="wheel"||o&&M.type==="wheel"&&!F)||!s&&M.ctrlKey&&M.type==="wheel"||!B&&!o&&!K&&M.type==="wheel"||!h&&(M.type==="mousedown"||M.type==="touchstart")||Array.isArray(h)&&!h.includes(M.button)&&M.type==="mousedown")return!1;const U=Array.isArray(h)&&h.includes(M.button)||!M.button||M.button<=1;return(!M.ctrlKey||M.type==="wheel")&&U})},[P,k,i,s,o,c,h,d,F]),G.createElement("div",{className:"react-flow__renderer",ref:b,style:$y},_)},X5=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function J5(){const{userSelectionActive:t,userSelectionRect:e}=Ge(X5,$t);return t&&e?G.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function Cx(t,e){const n=e.parentNode||e.parentId,r=t.find(i=>i.id===n);if(r){const i=e.position.x+e.width-r.width,s=e.position.y+e.height-r.height;if(i>0||s>0||e.position.x<0||e.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),s>0&&(r.style.height+=s),e.position.x<0){const o=Math.abs(e.position.x);r.position.x=r.position.x-o,r.style.width+=o,e.position.x=0}if(e.position.y<0){const o=Math.abs(e.position.y);r.position.y=r.position.y-o,r.style.height+=o,e.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function PT(t,e){if(t.some(r=>r.type==="reset"))return t.filter(r=>r.type==="reset").map(r=>r.item);const n=t.filter(r=>r.type==="add").map(r=>r.item);return e.reduce((r,i)=>{const s=t.filter(a=>a.id===i.id);if(s.length===0)return r.push(i),r;const o={...i};for(const a of s)if(a)switch(a.type){case"select":{o.selected=a.selected;break}case"position":{typeof a.position<"u"&&(o.position=a.position),typeof a.positionAbsolute<"u"&&(o.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(o.dragging=a.dragging),o.expandParent&&Cx(r,o);break}case"dimensions":{typeof a.dimensions<"u"&&(o.width=a.dimensions.width,o.height=a.dimensions.height),typeof a.updateStyle<"u"&&(o.style={...o.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(o.resizing=a.resizing),o.expandParent&&Cx(r,o);break}case"remove":return r}return r.push(o),r},n)}function DT(t,e){return PT(t,e)}function Z5(t,e){return PT(t,e)}const qi=(t,e)=>({id:t,type:"select",selected:e});function Sa(t,e){return t.reduce((n,r)=>{const i=e.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(qi(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(qi(r.id,!1))),n},[])}const um=(t,e)=>n=>{n.target===e.current&&(t==null||t(n))},eL=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,dragging:t.paneDragging}),VT=D.memo(({isSelecting:t,selectionMode:e=cu.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:c,onPaneMouseLeave:d,children:h})=>{const f=D.useRef(null),m=Et(),v=D.useRef(0),w=D.useRef(0),T=D.useRef(),{userSelectionActive:y,elementsSelectable:_,dragging:S}=Ge(eL,$t),C=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),v.current=0,w.current=0},O=R=>{s==null||s(R),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},z=R=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){R.preventDefault();return}o==null||o(R)},A=a?R=>a(R):void 0,E=R=>{const{resetSelectedElements:P,domNode:F}=m.getState();if(T.current=F==null?void 0:F.getBoundingClientRect(),!_||!t||R.button!==0||R.target!==f.current||!T.current)return;const{x:L,y:$}=cs(R,T.current);P(),m.setState({userSelectionRect:{width:0,height:0,startX:L,startY:$,x:L,y:$}}),r==null||r(R)},b=R=>{const{userSelectionRect:P,nodeInternals:F,edges:L,transform:$,onNodesChange:j,onEdgesChange:M,nodeOrigin:B,getNodes:K}=m.getState();if(!t||!T.current||!P)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const U=cs(R,T.current),X=P.startX??0,J=P.startY??0,te={...P,x:U.x<X?U.x:X,y:U.y<J?U.y:J,width:Math.abs(U.x-X),height:Math.abs(U.y-J)},ae=K(),pe=pT(F,te,$,e===cu.Partial,!0,B),de=mT(pe,L).map(be=>be.id),xe=pe.map(be=>be.id);if(v.current!==xe.length){v.current=xe.length;const be=Sa(ae,xe);be.length&&(j==null||j(be))}if(w.current!==de.length){w.current=de.length;const be=Sa(L,de);be.length&&(M==null||M(be))}m.setState({userSelectionRect:te})},I=R=>{if(R.button!==0)return;const{userSelectionRect:P}=m.getState();!y&&P&&R.target===f.current&&(O==null||O(R)),m.setState({nodesSelectionActive:v.current>0}),C(),i==null||i(R)},k=R=>{y&&(m.setState({nodesSelectionActive:v.current>0}),i==null||i(R)),C()},N=_&&(t||y);return G.createElement("div",{className:Ut(["react-flow__pane",{dragging:S,selection:t}]),onClick:N?void 0:um(O,f),onContextMenu:um(z,f),onWheel:um(A,f),onMouseEnter:N?void 0:l,onMouseDown:N?E:void 0,onMouseMove:N?b:c,onMouseUp:N?I:void 0,onMouseLeave:N?k:d,ref:f,style:$y},h,G.createElement(J5,null))});VT.displayName="Pane";function OT(t,e){const n=t.parentNode||t.parentId;if(!n)return!1;const r=e.get(n);return r?r.selected?!0:OT(r,e):!1}function Rx(t,e,n){let r=t;do{if(r!=null&&r.matches(e))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function tL(t,e,n,r){return Array.from(t.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!OT(i,t))&&(i.draggable||e&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function nL(t,e){return!e||e==="parent"?e:[e[0],[e[1][0]-(t.width||0),e[1][1]-(t.height||0)]]}function LT(t,e,n,r,i=[0,0],s){const o=nL(t,t.extent||r);let a=o;const l=t.parentNode||t.parentId;if(t.extent==="parent"&&!t.expandParent)if(l&&t.width&&t.height){const h=n.get(l),{x:f,y:m}=ro(h,i).positionAbsolute;a=h&&ir(f)&&ir(m)&&ir(h.width)&&ir(h.height)?[[f+t.width*i[0],m+t.height*i[1]],[f+h.width-t.width+t.width*i[0],m+h.height-t.height+t.height*i[1]]]:a}else s==null||s("005",Ei.error005()),a=o;else if(t.extent&&l&&t.extent!=="parent"){const h=n.get(l),{x:f,y:m}=ro(h,i).positionAbsolute;a=[[t.extent[0][0]+f,t.extent[0][1]+m],[t.extent[1][0]+f,t.extent[1][1]+m]]}let c={x:0,y:0};if(l){const h=n.get(l);c=ro(h,i).positionAbsolute}const d=a&&a!=="parent"?Dy(e,a):e;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function dm({nodeId:t,dragItems:e,nodeInternals:n}){const r=e.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[t?r.find(i=>i.id===t):r[0],r]}const kx=(t,e,n,r)=>{const i=e.querySelectorAll(t);if(!i||!i.length)return null;const s=Array.from(i),o=e.getBoundingClientRect(),a={x:o.width*r[0],y:o.height*r[1]};return s.map(l=>{const c=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(c.left-o.left-a.x)/n,y:(c.top-o.top-a.y)/n,...Py(l)}})};function ec(t,e,n){return n===void 0?n:r=>{const i=e().nodeInternals.get(t);i&&n(r,{...i})}}function qg({id:t,store:e,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:a,onError:l}=e.getState(),c=a.get(t);if(!c){l==null||l("012",Ei.error012(t));return}e.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&o)&&(s({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):i([t])}function zT(){const t=Et();return D.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:s}=t.getState(),o=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,l={x:(o-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:s?i[0]*Math.round(l.x/i[0]):l.x,ySnapped:s?i[1]*Math.round(l.y/i[1]):l.y,...l}},[])}function hm(t){return(e,n,r)=>t==null?void 0:t(e,r)}function MT({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const a=Et(),[l,c]=D.useState(!1),d=D.useRef([]),h=D.useRef({x:null,y:null}),f=D.useRef(0),m=D.useRef(null),v=D.useRef({x:0,y:0}),w=D.useRef(null),T=D.useRef(!1),y=D.useRef(!1),_=D.useRef(!1),S=zT();return D.useEffect(()=>{if(t!=null&&t.current){const C=jn(t.current),O=({x:E,y:b})=>{const{nodeInternals:I,onNodeDrag:k,onSelectionDrag:N,updateNodePositions:R,nodeExtent:P,snapGrid:F,snapToGrid:L,nodeOrigin:$,onError:j}=a.getState();h.current={x:E,y:b};let M=!1,B={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&P){const U=Pu(d.current,$);B=lu(U)}if(d.current=d.current.map(U=>{const X={x:E-U.distance.x,y:b-U.distance.y};L&&(X.x=F[0]*Math.round(X.x/F[0]),X.y=F[1]*Math.round(X.y/F[1]));const J=[[P[0][0],P[0][1]],[P[1][0],P[1][1]]];d.current.length>1&&P&&!U.extent&&(J[0][0]=U.positionAbsolute.x-B.x+P[0][0],J[1][0]=U.positionAbsolute.x+(U.width??0)-B.x2+P[1][0],J[0][1]=U.positionAbsolute.y-B.y+P[0][1],J[1][1]=U.positionAbsolute.y+(U.height??0)-B.y2+P[1][1]);const te=LT(U,X,I,J,$,j);return M=M||U.position.x!==te.position.x||U.position.y!==te.position.y,U.position=te.position,U.positionAbsolute=te.positionAbsolute,U}),!M)return;R(d.current,!0,!0),c(!0);const K=i?k:hm(N);if(K&&w.current){const[U,X]=dm({nodeId:i,dragItems:d.current,nodeInternals:I});K(w.current,U,X)}},z=()=>{if(!m.current)return;const[E,b]=tT(v.current,m.current);if(E!==0||b!==0){const{transform:I,panBy:k}=a.getState();h.current.x=(h.current.x??0)-E/I[2],h.current.y=(h.current.y??0)-b/I[2],k({x:E,y:b})&&O(h.current)}f.current=requestAnimationFrame(z)},A=E=>{var $;const{nodeInternals:b,multiSelectionActive:I,nodesDraggable:k,unselectNodesAndEdges:N,onNodeDragStart:R,onSelectionDragStart:P}=a.getState();y.current=!0;const F=i?R:hm(P);(!o||!s)&&!I&&i&&(($=b.get(i))!=null&&$.selected||N()),i&&s&&o&&qg({id:i,store:a,nodeRef:t});const L=S(E);if(h.current=L,d.current=tL(b,k,L,i),F&&d.current){const[j,M]=dm({nodeId:i,dragItems:d.current,nodeInternals:b});F(E.sourceEvent,j,M)}};if(e)C.on(".drag",null);else{const E=jS().on("start",b=>{const{domNode:I,nodeDragThreshold:k}=a.getState();k===0&&A(b),_.current=!1;const N=S(b);h.current=N,m.current=(I==null?void 0:I.getBoundingClientRect())||null,v.current=cs(b.sourceEvent,m.current)}).on("drag",b=>{var R,P;const I=S(b),{autoPanOnNodeDrag:k,nodeDragThreshold:N}=a.getState();if(b.sourceEvent.type==="touchmove"&&b.sourceEvent.touches.length>1&&(_.current=!0),!_.current){if(!T.current&&y.current&&k&&(T.current=!0,z()),!y.current){const F=I.xSnapped-(((R=h==null?void 0:h.current)==null?void 0:R.x)??0),L=I.ySnapped-(((P=h==null?void 0:h.current)==null?void 0:P.y)??0);Math.sqrt(F*F+L*L)>N&&A(b)}(h.current.x!==I.xSnapped||h.current.y!==I.ySnapped)&&d.current&&y.current&&(w.current=b.sourceEvent,v.current=cs(b.sourceEvent,m.current),O(I))}}).on("end",b=>{if(!(!y.current||_.current)&&(c(!1),T.current=!1,y.current=!1,cancelAnimationFrame(f.current),d.current)){const{updateNodePositions:I,nodeInternals:k,onNodeDragStop:N,onSelectionDragStop:R}=a.getState(),P=i?N:hm(R);if(I(d.current,!1,!1),P){const[F,L]=dm({nodeId:i,dragItems:d.current,nodeInternals:k});P(b.sourceEvent,F,L)}}}).filter(b=>{const I=b.target;return!b.button&&(!n||!Rx(I,`.${n}`,t))&&(!r||Rx(I,r,t))});return C.call(E),()=>{C.on(".drag",null)}}}},[t,e,n,r,s,a,i,o,S]),l}function jT(){const t=Et();return D.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:a,snapGrid:l,onError:c,nodesDraggable:d}=t.getState(),h=o().filter(_=>_.selected&&(_.draggable||d&&typeof _.draggable>"u")),f=a?l[0]:5,m=a?l[1]:5,v=n.isShiftPressed?4:1,w=n.x*f*v,T=n.y*m*v,y=h.map(_=>{if(_.positionAbsolute){const S={x:_.positionAbsolute.x+w,y:_.positionAbsolute.y+T};a&&(S.x=l[0]*Math.round(S.x/l[0]),S.y=l[1]*Math.round(S.y/l[1]));const{positionAbsolute:C,position:O}=LT(_,S,r,i,void 0,c);_.position=O,_.positionAbsolute=C}return _});s(y,!0,!1)},[])}const Va={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var tc=t=>{const e=({id:n,type:r,data:i,xPos:s,yPos:o,xPosOrigin:a,yPosOrigin:l,selected:c,onClick:d,onMouseEnter:h,onMouseMove:f,onMouseLeave:m,onContextMenu:v,onDoubleClick:w,style:T,className:y,isDraggable:_,isSelectable:S,isConnectable:C,isFocusable:O,selectNodesOnDrag:z,sourcePosition:A,targetPosition:E,hidden:b,resizeObserver:I,dragHandle:k,zIndex:N,isParent:R,noDragClassName:P,noPanClassName:F,initialized:L,disableKeyboardA11y:$,ariaLabel:j,rfId:M,hasHandleBounds:B})=>{const K=Et(),U=D.useRef(null),X=D.useRef(null),J=D.useRef(A),te=D.useRef(E),ae=D.useRef(r),pe=S||_||d||h||f||m,de=jT(),xe=ec(n,K.getState,h),be=ec(n,K.getState,f),ke=ec(n,K.getState,m),He=ec(n,K.getState,v),Ve=ec(n,K.getState,w),Xe=Ne=>{const{nodeDragThreshold:oe}=K.getState();if(S&&(!z||!_||oe>0)&&qg({id:n,store:K,nodeRef:U}),d){const Ae=K.getState().nodeInternals.get(n);Ae&&d(Ne,{...Ae})}},ve=Ne=>{if(!Fg(Ne)&&!$)if(sT.includes(Ne.key)&&S){const oe=Ne.key==="Escape";qg({id:n,store:K,unselect:oe,nodeRef:U})}else _&&c&&Object.prototype.hasOwnProperty.call(Va,Ne.key)&&(K.setState({ariaLiveMessage:`Moved selected node ${Ne.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),de({x:Va[Ne.key].x,y:Va[Ne.key].y,isShiftPressed:Ne.shiftKey}))};D.useEffect(()=>()=>{X.current&&(I==null||I.unobserve(X.current),X.current=null)},[]),D.useEffect(()=>{if(U.current&&!b){const Ne=U.current;(!L||!B||X.current!==Ne)&&(X.current&&(I==null||I.unobserve(X.current)),I==null||I.observe(Ne),X.current=Ne)}},[b,L,B]),D.useEffect(()=>{const Ne=ae.current!==r,oe=J.current!==A,Ae=te.current!==E;U.current&&(Ne||oe||Ae)&&(Ne&&(ae.current=r),oe&&(J.current=A),Ae&&(te.current=E),K.getState().updateNodeDimensions([{id:n,nodeElement:U.current,forceUpdate:!0}]))},[n,r,A,E]);const mt=MT({nodeRef:U,disabled:b||!_,noDragClassName:P,handleSelector:k,nodeId:n,isSelectable:S,selectNodesOnDrag:z});return b?null:G.createElement("div",{className:Ut(["react-flow__node",`react-flow__node-${r}`,{[F]:_},y,{selected:c,selectable:S,parent:R,dragging:mt}]),ref:U,style:{zIndex:N,transform:`translate(${a}px,${l}px)`,pointerEvents:pe?"all":"none",visibility:L?"visible":"hidden",...T},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:xe,onMouseMove:be,onMouseLeave:ke,onContextMenu:He,onClick:Xe,onDoubleClick:Ve,onKeyDown:O?ve:void 0,tabIndex:O?0:void 0,role:O?"button":void 0,"aria-describedby":$?void 0:`${AT}-${M}`,"aria-label":j},G.createElement(w5,{value:n},G.createElement(t,{id:n,data:i,type:r,xPos:s,yPos:o,selected:c,isConnectable:C,sourcePosition:A,targetPosition:E,dragging:mt,dragHandle:k,zIndex:N})))};return e.displayName="NodeWrapper",D.memo(e)};const rL=t=>{const e=t.getNodes().filter(n=>n.selected);return{...Pu(e,t.nodeOrigin),transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`,userSelectionActive:t.userSelectionActive}};function iL({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const r=Et(),{width:i,height:s,x:o,y:a,transformString:l,userSelectionActive:c}=Ge(rL,$t),d=jT(),h=D.useRef(null);if(D.useEffect(()=>{var v;n||(v=h.current)==null||v.focus({preventScroll:!0})},[n]),MT({nodeRef:h}),c||!i||!s)return null;const f=t?v=>{const w=r.getState().getNodes().filter(T=>T.selected);t(v,w)}:void 0,m=v=>{Object.prototype.hasOwnProperty.call(Va,v.key)&&d({x:Va[v.key].x,y:Va[v.key].y,isShiftPressed:v.shiftKey})};return G.createElement("div",{className:Ut(["react-flow__nodesselection","react-flow__container",e]),style:{transform:l}},G.createElement("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:i,height:s,top:a,left:o}}))}var sL=D.memo(iL);const oL=t=>t.nodesSelectionActive,FT=({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:a,onMove:l,onMoveStart:c,onMoveEnd:d,selectionKeyCode:h,selectionOnDrag:f,selectionMode:m,onSelectionStart:v,onSelectionEnd:w,multiSelectionKeyCode:T,panActivationKeyCode:y,zoomActivationKeyCode:_,elementsSelectable:S,zoomOnScroll:C,zoomOnPinch:O,panOnScroll:z,panOnScrollSpeed:A,panOnScrollMode:E,zoomOnDoubleClick:b,panOnDrag:I,defaultViewport:k,translateExtent:N,minZoom:R,maxZoom:P,preventScrolling:F,onSelectionContextMenu:L,noWheelClassName:$,noPanClassName:j,disableKeyboardA11y:M})=>{const B=Ge(oL),K=du(h),U=du(y),X=U||I,J=U||z,te=K||f&&X!==!0;return K5({deleteKeyCode:a,multiSelectionKeyCode:T}),G.createElement(Y5,{onMove:l,onMoveStart:c,onMoveEnd:d,onPaneContextMenu:s,elementsSelectable:S,zoomOnScroll:C,zoomOnPinch:O,panOnScroll:J,panOnScrollSpeed:A,panOnScrollMode:E,zoomOnDoubleClick:b,panOnDrag:!K&&X,defaultViewport:k,translateExtent:N,minZoom:R,maxZoom:P,zoomActivationKeyCode:_,preventScrolling:F,noWheelClassName:$,noPanClassName:j},G.createElement(VT,{onSelectionStart:v,onSelectionEnd:w,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:X,isSelecting:!!te,selectionMode:m},t,B&&G.createElement(sL,{onSelectionContextMenu:L,noPanClassName:j,disableKeyboardA11y:M})))};FT.displayName="FlowRenderer";var aL=D.memo(FT);function lL(t){return Ge(D.useCallback(n=>t?pT(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[t]))}function cL(t){const e={input:tc(t.input||ET),default:tc(t.default||Bg),output:tc(t.output||ST),group:tc(t.group||Fy)},n={},r=Object.keys(t).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=tc(t[s]||Bg),i),n);return{...e,...r}}const uL=({x:t,y:e,width:n,height:r,origin:i})=>!n||!r?{x:t,y:e}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:t,y:e}:{x:t-n*i[0],y:e-r*i[1]},dL=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions,onError:t.onError}),$T=t=>{const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:s,onError:o}=Ge(dL,$t),a=lL(t.onlyRenderVisibleElements),l=D.useRef(),c=D.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(h=>{const f=h.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));s(f)});return l.current=d,d},[]);return D.useEffect(()=>()=>{var d;(d=l==null?void 0:l.current)==null||d.disconnect()},[]),G.createElement("div",{className:"react-flow__nodes",style:$y},a.map(d=>{var O,z,A;let h=d.type||"default";t.nodeTypes[h]||(o==null||o("003",Ei.error003(h)),h="default");const f=t.nodeTypes[h]||t.nodeTypes.default,m=!!(d.draggable||e&&typeof d.draggable>"u"),v=!!(d.selectable||i&&typeof d.selectable>"u"),w=!!(d.connectable||n&&typeof d.connectable>"u"),T=!!(d.focusable||r&&typeof d.focusable>"u"),y=t.nodeExtent?Dy(d.positionAbsolute,t.nodeExtent):d.positionAbsolute,_=(y==null?void 0:y.x)??0,S=(y==null?void 0:y.y)??0,C=uL({x:_,y:S,width:d.width??0,height:d.height??0,origin:t.nodeOrigin});return G.createElement(f,{key:d.id,id:d.id,className:d.className,style:d.style,type:h,data:d.data,sourcePosition:d.sourcePosition||ce.Bottom,targetPosition:d.targetPosition||ce.Top,hidden:d.hidden,xPos:_,yPos:S,xPosOrigin:C.x,yPosOrigin:C.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!d.selected,isDraggable:m,isSelectable:v,isConnectable:w,isFocusable:T,resizeObserver:c,dragHandle:d.dragHandle,zIndex:((O=d[pt])==null?void 0:O.z)??0,isParent:!!((z=d[pt])!=null&&z.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!d.width&&!!d.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((A=d[pt])!=null&&A.handleBounds)})}))};$T.displayName="NodeRenderer";var hL=D.memo($T);const fL=(t,e,n)=>n===ce.Left?t-e:n===ce.Right?t+e:t,pL=(t,e,n)=>n===ce.Top?t-e:n===ce.Bottom?t+e:t,Nx="react-flow__edgeupdater",Px=({position:t,centerX:e,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a})=>G.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Ut([Nx,`${Nx}-${a}`]),cx:fL(e,r,t),cy:pL(n,r,t),r,stroke:"transparent",fill:"transparent"}),mL=()=>!0;var ea=t=>{const e=({id:n,className:r,type:i,data:s,onClick:o,onEdgeDoubleClick:a,selected:l,animated:c,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:m,labelBgPadding:v,labelBgBorderRadius:w,style:T,source:y,target:_,sourceX:S,sourceY:C,targetX:O,targetY:z,sourcePosition:A,targetPosition:E,elementsSelectable:b,hidden:I,sourceHandleId:k,targetHandleId:N,onContextMenu:R,onMouseEnter:P,onMouseMove:F,onMouseLeave:L,reconnectRadius:$,onReconnect:j,onReconnectStart:M,onReconnectEnd:B,markerEnd:K,markerStart:U,rfId:X,ariaLabel:J,isFocusable:te,isReconnectable:ae,pathOptions:pe,interactionWidth:de,disableKeyboardA11y:xe})=>{const be=D.useRef(null),[ke,He]=D.useState(!1),[Ve,Xe]=D.useState(!1),ve=Et(),mt=D.useMemo(()=>`url('#${$g(U,X)}')`,[U,X]),Ne=D.useMemo(()=>`url('#${$g(K,X)}')`,[K,X]);if(I)return null;const oe=Ue=>{var fn;const{edges:_t,addSelectedEdges:Nn,unselectNodesAndEdges:Pn,multiSelectionActive:Dn}=ve.getState(),Vn=_t.find(dr=>dr.id===n);Vn&&(b&&(ve.setState({nodesSelectionActive:!1}),Vn.selected&&Dn?(Pn({nodes:[],edges:[Vn]}),(fn=be.current)==null||fn.blur()):Nn([n])),o&&o(Ue,Vn))},Ae=Zl(n,ve.getState,a),Pt=Zl(n,ve.getState,R),Dt=Zl(n,ve.getState,P),hn=Zl(n,ve.getState,F),it=Zl(n,ve.getState,L),It=(Ue,_t)=>{if(Ue.button!==0)return;const{edges:Nn,isValidConnection:Pn}=ve.getState(),Dn=_t?_:y,Vn=(_t?N:k)||null,fn=_t?"target":"source",dr=Pn||mL,Ot=_t,Xn=Nn.find(pn=>pn.id===n);Xe(!0),M==null||M(Ue,Xn,fn);const hr=pn=>{Xe(!1),B==null||B(pn,Xn,fn)};wT({event:Ue,handleId:Vn,nodeId:Dn,onConnect:pn=>j==null?void 0:j(Xn,pn),isTarget:Ot,getState:ve.getState,setState:ve.setState,isValidConnection:dr,edgeUpdaterType:fn,onReconnectEnd:hr})},St=Ue=>It(Ue,!0),ze=Ue=>It(Ue,!1),je=()=>He(!0),Vt=()=>He(!1),sn=!b&&!o,Pr=Ue=>{var _t;if(!xe&&sT.includes(Ue.key)&&b){const{unselectNodesAndEdges:Nn,addSelectedEdges:Pn,edges:Dn}=ve.getState();Ue.key==="Escape"?((_t=be.current)==null||_t.blur(),Nn({edges:[Dn.find(fn=>fn.id===n)]})):Pn([n])}};return G.createElement("g",{className:Ut(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:l,animated:c,inactive:sn,updating:ke}]),onClick:oe,onDoubleClick:Ae,onContextMenu:Pt,onMouseEnter:Dt,onMouseMove:hn,onMouseLeave:it,onKeyDown:te?Pr:void 0,tabIndex:te?0:void 0,role:te?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":J===null?void 0:J||`Edge from ${y} to ${_}`,"aria-describedby":te?`${CT}-${X}`:void 0,ref:be},!Ve&&G.createElement(t,{id:n,source:y,target:_,selected:l,animated:c,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:m,labelBgPadding:v,labelBgBorderRadius:w,data:s,style:T,sourceX:S,sourceY:C,targetX:O,targetY:z,sourcePosition:A,targetPosition:E,sourceHandleId:k,targetHandleId:N,markerStart:mt,markerEnd:Ne,pathOptions:pe,interactionWidth:de}),ae&&G.createElement(G.Fragment,null,(ae==="source"||ae===!0)&&G.createElement(Px,{position:A,centerX:S,centerY:C,radius:$,onMouseDown:St,onMouseEnter:je,onMouseOut:Vt,type:"source"}),(ae==="target"||ae===!0)&&G.createElement(Px,{position:E,centerX:O,centerY:z,radius:$,onMouseDown:ze,onMouseEnter:je,onMouseOut:Vt,type:"target"})))};return e.displayName="EdgeWrapper",D.memo(e)};function gL(t){const e={default:ea(t.default||Zh),straight:ea(t.bezier||Ly),step:ea(t.step||Oy),smoothstep:ea(t.step||Qf),simplebezier:ea(t.simplebezier||Vy)},n={},r=Object.keys(t).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=ea(t[s]||Zh),i),n);return{...e,...r}}function Dx(t,e,n=null){const r=((n==null?void 0:n.x)||0)+e.x,i=((n==null?void 0:n.y)||0)+e.y,s=(n==null?void 0:n.width)||e.width,o=(n==null?void 0:n.height)||e.height;switch(t){case ce.Top:return{x:r+s/2,y:i};case ce.Right:return{x:r+s,y:i+o/2};case ce.Bottom:return{x:r+s/2,y:i+o};case ce.Left:return{x:r,y:i+o/2}}}function Vx(t,e){return t?t.length===1||!e?t[0]:e&&t.find(n=>n.id===e)||null:null}const yL=(t,e,n,r,i,s)=>{const o=Dx(n,t,e),a=Dx(s,r,i);return{sourceX:o.x,sourceY:o.y,targetX:a.x,targetY:a.y}};function vL({sourcePos:t,targetPos:e,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:s,width:o,height:a,transform:l}){const c={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x+n,e.x+i),y2:Math.max(t.y+r,e.y+s)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=lu({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:o/l[2],height:a/l[2]}),h=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),f=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(h*f)>0}function Ox(t){var r,i,s,o,a;const e=((r=t==null?void 0:t[pt])==null?void 0:r.handleBounds)||null,n=e&&(t==null?void 0:t.width)&&(t==null?void 0:t.height)&&typeof((i=t==null?void 0:t.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=t==null?void 0:t.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=t==null?void 0:t.positionAbsolute)==null?void 0:o.x)||0,y:((a=t==null?void 0:t.positionAbsolute)==null?void 0:a.y)||0,width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0},e,!!n]}const wL=[{level:0,isMaxLevel:!0,edges:[]}];function _L(t,e,n=!1){let r=-1;const i=t.reduce((o,a)=>{var d,h;const l=ir(a.zIndex);let c=l?a.zIndex:0;if(n){const f=e.get(a.target),m=e.get(a.source),v=a.selected||(f==null?void 0:f.selected)||(m==null?void 0:m.selected),w=Math.max(((d=m==null?void 0:m[pt])==null?void 0:d.z)||0,((h=f==null?void 0:f[pt])==null?void 0:h.z)||0,1e3);c=(l?a.zIndex:0)+(v?w:0)}return o[c]?o[c].push(a):o[c]=[a],r=c>r?c:r,o},{}),s=Object.entries(i).map(([o,a])=>{const l=+o;return{edges:a,level:l,isMaxLevel:l===r}});return s.length===0?wL:s}function xL(t,e,n){const r=Ge(D.useCallback(i=>t?i.edges.filter(s=>{const o=e.get(s.source),a=e.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&vL({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:a.width,targetHeight:a.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[t,e]));return _L(r,e,n)}const bL=({color:t="none",strokeWidth:e=1})=>G.createElement("polyline",{style:{stroke:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),EL=({color:t="none",strokeWidth:e=1})=>G.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),Lx={[Jh.Arrow]:bL,[Jh.ArrowClosed]:EL};function IL(t){const e=Et();return D.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(Lx,t)?Lx[t]:((s=(i=e.getState()).onError)==null||s.call(i,"009",Ei.error009(t)),null)},[t])}const SL=({id:t,type:e,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const l=IL(e);return l?G.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0"},G.createElement(l,{color:n,strokeWidth:o})):null},TL=({defaultColor:t,rfId:e})=>n=>{const r=[];return n.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const a=$g(o,e);r.includes(a)||(i.push({id:a,color:o.color||t,...o}),r.push(a))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},UT=({defaultColor:t,rfId:e})=>{const n=Ge(D.useCallback(TL({defaultColor:t,rfId:e}),[t,e]),(r,i)=>!(r.length!==i.length||r.some((s,o)=>s.id!==i[o].id)));return G.createElement("defs",null,n.map(r=>G.createElement(SL,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};UT.displayName="MarkerDefinitions";var AL=D.memo(UT);const CL=t=>({nodesConnectable:t.nodesConnectable,edgesFocusable:t.edgesFocusable,edgesUpdatable:t.edgesUpdatable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals,onError:t.onError}),BT=({defaultMarkerColor:t,onlyRenderVisibleElements:e,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,onEdgeDoubleClick:h,onReconnect:f,onReconnectStart:m,onReconnectEnd:v,reconnectRadius:w,children:T,disableKeyboardA11y:y})=>{const{edgesFocusable:_,edgesUpdatable:S,elementsSelectable:C,width:O,height:z,connectionMode:A,nodeInternals:E,onError:b}=Ge(CL,$t),I=xL(e,E,n);return O?G.createElement(G.Fragment,null,I.map(({level:k,edges:N,isMaxLevel:R})=>G.createElement("svg",{key:k,style:{zIndex:k},width:O,height:z,className:"react-flow__edges react-flow__container"},R&&G.createElement(AL,{defaultColor:t,rfId:r}),G.createElement("g",null,N.map(P=>{const[F,L,$]=Ox(E.get(P.source)),[j,M,B]=Ox(E.get(P.target));if(!$||!B)return null;let K=P.type||"default";i[K]||(b==null||b("011",Ei.error011(K)),K="default");const U=i[K]||i.default,X=A===po.Strict?M.target:(M.target??[]).concat(M.source??[]),J=Vx(L.source,P.sourceHandle),te=Vx(X,P.targetHandle),ae=(J==null?void 0:J.position)||ce.Bottom,pe=(te==null?void 0:te.position)||ce.Top,de=!!(P.focusable||_&&typeof P.focusable>"u"),xe=P.reconnectable||P.updatable,be=typeof f<"u"&&(xe||S&&typeof xe>"u");if(!J||!te)return b==null||b("008",Ei.error008(J,P)),null;const{sourceX:ke,sourceY:He,targetX:Ve,targetY:Xe}=yL(F,J,ae,j,te,pe);return G.createElement(U,{key:P.id,id:P.id,className:Ut([P.className,s]),type:K,data:P.data,selected:!!P.selected,animated:!!P.animated,hidden:!!P.hidden,label:P.label,labelStyle:P.labelStyle,labelShowBg:P.labelShowBg,labelBgStyle:P.labelBgStyle,labelBgPadding:P.labelBgPadding,labelBgBorderRadius:P.labelBgBorderRadius,style:P.style,source:P.source,target:P.target,sourceHandleId:P.sourceHandle,targetHandleId:P.targetHandle,markerEnd:P.markerEnd,markerStart:P.markerStart,sourceX:ke,sourceY:He,targetX:Ve,targetY:Xe,sourcePosition:ae,targetPosition:pe,elementsSelectable:C,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,onEdgeDoubleClick:h,onReconnect:f,onReconnectStart:m,onReconnectEnd:v,reconnectRadius:w,rfId:r,ariaLabel:P.ariaLabel,isFocusable:de,isReconnectable:be,pathOptions:"pathOptions"in P?P.pathOptions:void 0,interactionWidth:P.interactionWidth,disableKeyboardA11y:y})})))),T):null};BT.displayName="EdgeRenderer";var RL=D.memo(BT);const kL=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function NL({children:t}){const e=Ge(kL);return G.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:e}},t)}function PL(t){const e=Yr(),n=D.useRef(!1);D.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const DL={[ce.Left]:ce.Right,[ce.Right]:ce.Left,[ce.Top]:ce.Bottom,[ce.Bottom]:ce.Top},qT=({nodeId:t,handleType:e,style:n,type:r=Wi.Bezier,CustomComponent:i,connectionStatus:s})=>{var z,A,E;const{fromNode:o,handleId:a,toX:l,toY:c,connectionMode:d}=Ge(D.useCallback(b=>({fromNode:b.nodeInternals.get(t),handleId:b.connectionHandleId,toX:(b.connectionPosition.x-b.transform[0])/b.transform[2],toY:(b.connectionPosition.y-b.transform[1])/b.transform[2],connectionMode:b.connectionMode}),[t]),$t),h=(z=o==null?void 0:o[pt])==null?void 0:z.handleBounds;let f=h==null?void 0:h[e];if(d===po.Loose&&(f=f||(h==null?void 0:h[e==="source"?"target":"source"])),!o||!f)return null;const m=a?f.find(b=>b.id===a):f[0],v=m?m.x+m.width/2:(o.width??0)/2,w=m?m.y+m.height/2:o.height??0,T=(((A=o.positionAbsolute)==null?void 0:A.x)??0)+v,y=(((E=o.positionAbsolute)==null?void 0:E.y)??0)+w,_=m==null?void 0:m.position,S=_?DL[_]:null;if(!_||!S)return null;if(i)return G.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:m,fromX:T,fromY:y,toX:l,toY:c,fromPosition:_,toPosition:S,connectionStatus:s});let C="";const O={sourceX:T,sourceY:y,sourcePosition:_,targetX:l,targetY:c,targetPosition:S};return r===Wi.Bezier?[C]=zy(O):r===Wi.Step?[C]=uu({...O,borderRadius:0}):r===Wi.SmoothStep?[C]=uu(O):r===Wi.SimpleBezier?[C]=cT(O):C=`M${T},${y} ${l},${c}`,G.createElement("path",{d:C,fill:"none",className:"react-flow__connection-path",style:n})};qT.displayName="ConnectionLine";const VL=t=>({nodeId:t.connectionNodeId,handleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,connectionStatus:t.connectionStatus,width:t.width,height:t.height});function OL({containerStyle:t,style:e,type:n,component:r}){const{nodeId:i,handleType:s,nodesConnectable:o,width:a,height:l,connectionStatus:c}=Ge(VL,$t);return!(i&&s&&a&&o)?null:G.createElement("svg",{style:t,width:a,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},G.createElement("g",{className:Ut(["react-flow__connection",c])},G.createElement(qT,{nodeId:i,handleType:s,style:e,type:n,CustomComponent:r,connectionStatus:c})))}function zx(t,e){return D.useRef(null),Et(),D.useMemo(()=>e(t),[t])}const HT=({nodeTypes:t,edgeTypes:e,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:m,onSelectionContextMenu:v,onSelectionStart:w,onSelectionEnd:T,connectionLineType:y,connectionLineStyle:_,connectionLineComponent:S,connectionLineContainerStyle:C,selectionKeyCode:O,selectionOnDrag:z,selectionMode:A,multiSelectionKeyCode:E,panActivationKeyCode:b,zoomActivationKeyCode:I,deleteKeyCode:k,onlyRenderVisibleElements:N,elementsSelectable:R,selectNodesOnDrag:P,defaultViewport:F,translateExtent:L,minZoom:$,maxZoom:j,preventScrolling:M,defaultMarkerColor:B,zoomOnScroll:K,zoomOnPinch:U,panOnScroll:X,panOnScrollSpeed:J,panOnScrollMode:te,zoomOnDoubleClick:ae,panOnDrag:pe,onPaneClick:de,onPaneMouseEnter:xe,onPaneMouseMove:be,onPaneMouseLeave:ke,onPaneScroll:He,onPaneContextMenu:Ve,onEdgeContextMenu:Xe,onEdgeMouseEnter:ve,onEdgeMouseMove:mt,onEdgeMouseLeave:Ne,onReconnect:oe,onReconnectStart:Ae,onReconnectEnd:Pt,reconnectRadius:Dt,noDragClassName:hn,noWheelClassName:it,noPanClassName:It,elevateEdgesOnSelect:St,disableKeyboardA11y:ze,nodeOrigin:je,nodeExtent:Vt,rfId:sn})=>{const Pr=zx(t,cL),Ue=zx(e,gL);return PL(s),G.createElement(aL,{onPaneClick:de,onPaneMouseEnter:xe,onPaneMouseMove:be,onPaneMouseLeave:ke,onPaneContextMenu:Ve,onPaneScroll:He,deleteKeyCode:k,selectionKeyCode:O,selectionOnDrag:z,selectionMode:A,onSelectionStart:w,onSelectionEnd:T,multiSelectionKeyCode:E,panActivationKeyCode:b,zoomActivationKeyCode:I,elementsSelectable:R,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:K,zoomOnPinch:U,zoomOnDoubleClick:ae,panOnScroll:X,panOnScrollSpeed:J,panOnScrollMode:te,panOnDrag:pe,defaultViewport:F,translateExtent:L,minZoom:$,maxZoom:j,onSelectionContextMenu:v,preventScrolling:M,noDragClassName:hn,noWheelClassName:it,noPanClassName:It,disableKeyboardA11y:ze},G.createElement(NL,null,G.createElement(RL,{edgeTypes:Ue,onEdgeClick:a,onEdgeDoubleClick:c,onlyRenderVisibleElements:N,onEdgeContextMenu:Xe,onEdgeMouseEnter:ve,onEdgeMouseMove:mt,onEdgeMouseLeave:Ne,onReconnect:oe,onReconnectStart:Ae,onReconnectEnd:Pt,reconnectRadius:Dt,defaultMarkerColor:B,noPanClassName:It,elevateEdgesOnSelect:!!St,disableKeyboardA11y:ze,rfId:sn},G.createElement(OL,{style:_,type:y,component:S,containerStyle:C})),G.createElement("div",{className:"react-flow__edgelabel-renderer"}),G.createElement(hL,{nodeTypes:Pr,onNodeClick:o,onNodeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:m,selectNodesOnDrag:P,onlyRenderVisibleElements:N,noPanClassName:It,noDragClassName:hn,disableKeyboardA11y:ze,nodeOrigin:je,nodeExtent:Vt,rfId:sn})))};HT.displayName="GraphView";var LL=D.memo(HT);const Hg=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],zi={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:Hg,nodeExtent:Hg,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:po.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:p5,isValidConnection:void 0},zL=()=>kD((t,e)=>({...zi,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:s}=e();t({nodeInternals:cm(n,r,i,s)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=e();t({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",s=typeof r<"u",o=i?cm(n,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map;t({nodeInternals:o,edges:s?r:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:a,domNode:l,nodeOrigin:c}=e(),d=l==null?void 0:l.querySelector(".react-flow__viewport");if(!d)return;const h=window.getComputedStyle(d),{m22:f}=new window.DOMMatrixReadOnly(h.transform),m=n.reduce((w,T)=>{const y=i.get(T.id);if(y!=null&&y.hidden)i.set(y.id,{...y,[pt]:{...y[pt],handleBounds:void 0}});else if(y){const _=Py(T.nodeElement);!!(_.width&&_.height&&(y.width!==_.width||y.height!==_.height||T.forceUpdate))&&(i.set(y.id,{...y,[pt]:{...y[pt],handleBounds:{source:kx(".source",T.nodeElement,f,c),target:kx(".target",T.nodeElement,f,c)}},..._}),w.push({id:y.id,type:"dimensions",dimensions:_}))}return w},[]);kT(i,c);const v=o||s&&!o&&NT(e,{initial:!0,...a});t({nodeInternals:new Map(i),fitViewOnInitDone:v}),(m==null?void 0:m.length)>0&&(r==null||r(m))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:s}=e(),o=n.map(a=>{const l={id:a.id,type:"position",dragging:i};return r&&(l.positionAbsolute=a.positionAbsolute,l.position=a.position),l});s(o)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:a,elevateNodesOnSelect:l}=e();if(n!=null&&n.length){if(s){const c=DT(n,a()),d=cm(c,i,o,l);t({nodeInternals:d})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=e();let o,a=null;r?o=n.map(l=>qi(l,!0)):(o=Sa(s(),n),a=Sa(i,[])),Rd({changedNodes:o,changedEdges:a,get:e,set:t})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=e();let o,a=null;r?o=n.map(l=>qi(l,!0)):(o=Sa(i,n),a=Sa(s(),[])),Rd({changedNodes:a,changedEdges:o,get:e,set:t})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:s}=e(),o=n||s(),a=r||i,l=o.map(d=>(d.selected=!1,qi(d.id,!1))),c=a.map(d=>qi(d.id,!1));Rd({changedNodes:l,changedEdges:c,get:e,set:t})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=e();r==null||r.scaleExtent([n,i]),t({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=e();r==null||r.scaleExtent([i,n]),t({maxZoom:n})},setTranslateExtent:n=>{var r;(r=e().d3Zoom)==null||r.translateExtent(n),t({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=e(),s=r().filter(a=>a.selected).map(a=>qi(a.id,!1)),o=n.filter(a=>a.selected).map(a=>qi(a.id,!1));Rd({changedNodes:s,changedEdges:o,get:e,set:t})},setNodeExtent:n=>{const{nodeInternals:r}=e();r.forEach(i=>{i.positionAbsolute=Dy(i.position,n)}),t({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:s,d3Zoom:o,d3Selection:a,translateExtent:l}=e();if(!o||!a||!n.x&&!n.y)return!1;const c=gi.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),d=[[0,0],[i,s]],h=o==null?void 0:o.constrain()(c,d,l);return o.transform(a,h),r[0]!==h.x||r[1]!==h.y||r[2]!==h.k},cancelConnection:()=>t({connectionNodeId:zi.connectionNodeId,connectionHandleId:zi.connectionHandleId,connectionHandleType:zi.connectionHandleType,connectionStatus:zi.connectionStatus,connectionStartHandle:zi.connectionStartHandle,connectionEndHandle:zi.connectionEndHandle}),reset:()=>t({...zi})}),Object.is),Uy=({children:t})=>{const e=D.useRef(null);return e.current||(e.current=zL()),G.createElement(a5,{value:e.current},t)};Uy.displayName="ReactFlowProvider";const KT=({children:t})=>D.useContext(Gf)?G.createElement(G.Fragment,null,t):G.createElement(Uy,null,t);KT.displayName="ReactFlowWrapper";const ML={input:ET,default:Bg,output:ST,group:Fy},jL={default:Zh,straight:Ly,step:Oy,smoothstep:Qf,simplebezier:Vy},FL=[0,0],$L=[15,15],UL={x:0,y:0,zoom:1},BL={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},WT=D.forwardRef(({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s=ML,edgeTypes:o=jL,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:h,onMoveEnd:f,onConnect:m,onConnectStart:v,onConnectEnd:w,onClickConnectStart:T,onClickConnectEnd:y,onNodeMouseEnter:_,onNodeMouseMove:S,onNodeMouseLeave:C,onNodeContextMenu:O,onNodeDoubleClick:z,onNodeDragStart:A,onNodeDrag:E,onNodeDragStop:b,onNodesDelete:I,onEdgesDelete:k,onSelectionChange:N,onSelectionDragStart:R,onSelectionDrag:P,onSelectionDragStop:F,onSelectionContextMenu:L,onSelectionStart:$,onSelectionEnd:j,connectionMode:M=po.Strict,connectionLineType:B=Wi.Bezier,connectionLineStyle:K,connectionLineComponent:U,connectionLineContainerStyle:X,deleteKeyCode:J="Backspace",selectionKeyCode:te="Shift",selectionOnDrag:ae=!1,selectionMode:pe=cu.Full,panActivationKeyCode:de="Space",multiSelectionKeyCode:xe=Xh()?"Meta":"Control",zoomActivationKeyCode:be=Xh()?"Meta":"Control",snapToGrid:ke=!1,snapGrid:He=$L,onlyRenderVisibleElements:Ve=!1,selectNodesOnDrag:Xe=!0,nodesDraggable:ve,nodesConnectable:mt,nodesFocusable:Ne,nodeOrigin:oe=FL,edgesFocusable:Ae,edgesUpdatable:Pt,elementsSelectable:Dt,defaultViewport:hn=UL,minZoom:it=.5,maxZoom:It=2,translateExtent:St=Hg,preventScrolling:ze=!0,nodeExtent:je,defaultMarkerColor:Vt="#b1b1b7",zoomOnScroll:sn=!0,zoomOnPinch:Pr=!0,panOnScroll:Ue=!1,panOnScrollSpeed:_t=.5,panOnScrollMode:Nn=Ys.Free,zoomOnDoubleClick:Pn=!0,panOnDrag:Dn=!0,onPaneClick:Vn,onPaneMouseEnter:fn,onPaneMouseMove:dr,onPaneMouseLeave:Ot,onPaneScroll:Xn,onPaneContextMenu:hr,children:Je,onEdgeContextMenu:pn,onEdgeDoubleClick:fr,onEdgeMouseEnter:Do,onEdgeMouseMove:ki,onEdgeMouseLeave:Vo,onEdgeUpdate:Jr,onEdgeUpdateStart:Oo,onEdgeUpdateEnd:Tt,onReconnect:Lo,onReconnectStart:Jn,onReconnectEnd:Dr,reconnectRadius:Rl=10,edgeUpdaterRadius:kl=10,onNodesChange:Vr,onEdgesChange:zo,noDragClassName:Nl="nodrag",noWheelClassName:Ni="nowheel",noPanClassName:ks="nopan",fitView:Ns=!1,fitViewOptions:On,connectOnClick:Zn=!0,attributionPosition:Mo,proOptions:jo,defaultEdgeOptions:Ps,elevateNodesOnSelect:Ds=!0,elevateEdgesOnSelect:Fo=!1,disableKeyboardA11y:Vs=!1,autoPanOnConnect:Pl=!0,autoPanOnNodeDrag:Pi=!0,connectionRadius:$o=20,isValidConnection:Di,onError:Zr,style:pr,id:Or,nodeDragThreshold:Uo,...Bo},qo)=>{const Lr=Or||"1";return G.createElement("div",{...Bo,style:{...pr,...BL},ref:qo,className:Ut(["react-flow",i]),"data-testid":"rf__wrapper",id:Or},G.createElement(KT,null,G.createElement(LL,{onInit:c,onMove:d,onMoveStart:h,onMoveEnd:f,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:_,onNodeMouseMove:S,onNodeMouseLeave:C,onNodeContextMenu:O,onNodeDoubleClick:z,nodeTypes:s,edgeTypes:o,connectionLineType:B,connectionLineStyle:K,connectionLineComponent:U,connectionLineContainerStyle:X,selectionKeyCode:te,selectionOnDrag:ae,selectionMode:pe,deleteKeyCode:J,multiSelectionKeyCode:xe,panActivationKeyCode:de,zoomActivationKeyCode:be,onlyRenderVisibleElements:Ve,selectNodesOnDrag:Xe,defaultViewport:hn,translateExtent:St,minZoom:it,maxZoom:It,preventScrolling:ze,zoomOnScroll:sn,zoomOnPinch:Pr,zoomOnDoubleClick:Pn,panOnScroll:Ue,panOnScrollSpeed:_t,panOnScrollMode:Nn,panOnDrag:Dn,onPaneClick:Vn,onPaneMouseEnter:fn,onPaneMouseMove:dr,onPaneMouseLeave:Ot,onPaneScroll:Xn,onPaneContextMenu:hr,onSelectionContextMenu:L,onSelectionStart:$,onSelectionEnd:j,onEdgeContextMenu:pn,onEdgeDoubleClick:fr,onEdgeMouseEnter:Do,onEdgeMouseMove:ki,onEdgeMouseLeave:Vo,onReconnect:Lo??Jr,onReconnectStart:Jn??Oo,onReconnectEnd:Dr??Tt,reconnectRadius:Rl??kl,defaultMarkerColor:Vt,noDragClassName:Nl,noWheelClassName:Ni,noPanClassName:ks,elevateEdgesOnSelect:Fo,rfId:Lr,disableKeyboardA11y:Vs,nodeOrigin:oe,nodeExtent:je}),G.createElement(V5,{nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:v,onConnectEnd:w,onClickConnectStart:T,onClickConnectEnd:y,nodesDraggable:ve,nodesConnectable:mt,nodesFocusable:Ne,edgesFocusable:Ae,edgesUpdatable:Pt,elementsSelectable:Dt,elevateNodesOnSelect:Ds,minZoom:it,maxZoom:It,nodeExtent:je,onNodesChange:Vr,onEdgesChange:zo,snapToGrid:ke,snapGrid:He,connectionMode:M,translateExtent:St,connectOnClick:Zn,defaultEdgeOptions:Ps,fitView:Ns,fitViewOptions:On,onNodesDelete:I,onEdgesDelete:k,onNodeDragStart:A,onNodeDrag:E,onNodeDragStop:b,onSelectionDrag:P,onSelectionDragStart:R,onSelectionDragStop:F,noPanClassName:ks,nodeOrigin:oe,rfId:Lr,autoPanOnConnect:Pl,autoPanOnNodeDrag:Pi,onError:Zr,connectionRadius:$o,isValidConnection:Di,nodeDragThreshold:Uo}),G.createElement(P5,{onSelectionChange:N}),Je,G.createElement(c5,{proOptions:jo,position:Mo}),G.createElement(j5,{rfId:Lr,disableKeyboardA11y:Vs})))});WT.displayName="ReactFlow";const qL=t=>{var e;return(e=t.domNode)==null?void 0:e.querySelector(".react-flow__edgelabel-renderer")};function HL({children:t}){const e=Ge(qL);return e?nu.createPortal(t,e):null}function GT(t){return e=>{const[n,r]=D.useState(e),i=D.useCallback(s=>r(o=>t(s,o)),[]);return[n,r,i]}}const KL=GT(DT),WL=GT(Z5),QT=({id:t,x:e,y:n,width:r,height:i,style:s,color:o,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:h,onClick:f,selected:m})=>{const{background:v,backgroundColor:w}=s||{},T=o||v||w;return G.createElement("rect",{className:Ut(["react-flow__minimap-node",{selected:m},c]),x:e,y:n,rx:d,ry:d,width:r,height:i,fill:T,stroke:a,strokeWidth:l,shapeRendering:h,onClick:f?y=>f(y,t):void 0})};QT.displayName="MiniMapNode";var GL=D.memo(QT);const QL=t=>t.nodeOrigin,YL=t=>t.getNodes().filter(e=>!e.hidden&&e.width&&e.height),fm=t=>t instanceof Function?t:()=>t;function XL({nodeStrokeColor:t="transparent",nodeColor:e="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i=2,nodeComponent:s=GL,onClick:o}){const a=Ge(YL,$t),l=Ge(QL),c=fm(e),d=fm(t),h=fm(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return G.createElement(G.Fragment,null,a.map(m=>{const{x:v,y:w}=ro(m,l).positionAbsolute;return G.createElement(s,{key:m.id,x:v,y:w,width:m.width,height:m.height,style:m.style,selected:m.selected,className:h(m),color:c(m),borderRadius:r,strokeColor:d(m),strokeWidth:i,shapeRendering:f,onClick:o,id:m.id})}))}var JL=D.memo(XL);const ZL=200,ez=150,tz=t=>{const e=t.getNodes(),n={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:n,boundingRect:e.length>0?h5(Pu(e,t.nodeOrigin),n):n,rfId:t.rfId}},nz="react-flow__minimap-desc";function YT({style:t,className:e,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:a,maskColor:l="rgb(240, 240, 240, 0.6)",maskStrokeColor:c="none",maskStrokeWidth:d=1,position:h="bottom-right",onClick:f,onNodeClick:m,pannable:v=!1,zoomable:w=!1,ariaLabel:T="React Flow mini map",inversePan:y=!1,zoomStep:_=10,offsetScale:S=5}){const C=Et(),O=D.useRef(null),{boundingRect:z,viewBB:A,rfId:E}=Ge(tz,$t),b=(t==null?void 0:t.width)??ZL,I=(t==null?void 0:t.height)??ez,k=z.width/b,N=z.height/I,R=Math.max(k,N),P=R*b,F=R*I,L=S*R,$=z.x-(P-z.width)/2-L,j=z.y-(F-z.height)/2-L,M=P+L*2,B=F+L*2,K=`${nz}-${E}`,U=D.useRef(0);U.current=R,D.useEffect(()=>{if(O.current){const te=jn(O.current),ae=xe=>{const{transform:be,d3Selection:ke,d3Zoom:He}=C.getState();if(xe.sourceEvent.type!=="wheel"||!ke||!He)return;const Ve=-xe.sourceEvent.deltaY*(xe.sourceEvent.deltaMode===1?.05:xe.sourceEvent.deltaMode?1:.002)*_,Xe=be[2]*Math.pow(2,Ve);He.scaleTo(ke,Xe)},pe=xe=>{const{transform:be,d3Selection:ke,d3Zoom:He,translateExtent:Ve,width:Xe,height:ve}=C.getState();if(xe.sourceEvent.type!=="mousemove"||!ke||!He)return;const mt=U.current*Math.max(1,be[2])*(y?-1:1),Ne={x:be[0]-xe.sourceEvent.movementX*mt,y:be[1]-xe.sourceEvent.movementY*mt},oe=[[0,0],[Xe,ve]],Ae=gi.translate(Ne.x,Ne.y).scale(be[2]),Pt=He.constrain()(Ae,oe,Ve);He.transform(ke,Pt)},de=ZS().on("zoom",v?pe:null).on("zoom.wheel",w?ae:null);return te.call(de),()=>{te.on("zoom",null)}}},[v,w,y,_]);const X=f?te=>{const ae=wr(te);f(te,{x:ae[0],y:ae[1]})}:void 0,J=m?(te,ae)=>{const pe=C.getState().nodeInternals.get(ae);m(te,pe)}:void 0;return G.createElement(Ny,{position:h,style:t,className:Ut(["react-flow__minimap",e]),"data-testid":"rf__minimap"},G.createElement("svg",{width:b,height:I,viewBox:`${$} ${j} ${M} ${B}`,role:"img","aria-labelledby":K,ref:O,onClick:X},T&&G.createElement("title",{id:K},T),G.createElement(JL,{onClick:J,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:a}),G.createElement("path",{className:"react-flow__minimap-mask",d:`M${$-L},${j-L}h${M+L*2}v${B+L*2}h${-M-L*2}z
        M${A.x},${A.y}h${A.width}v${A.height}h${-A.width}z`,fill:l,fillRule:"evenodd",stroke:c,strokeWidth:d,pointerEvents:"none"})))}YT.displayName="MiniMap";var rz=D.memo(YT);function iz(){return G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},G.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function sz(){return G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},G.createElement("path",{d:"M0 0h32v4.2H0z"}))}function oz(){return G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},G.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function az(){return G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},G.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function lz(){return G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},G.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const pc=({children:t,className:e,...n})=>G.createElement("button",{type:"button",className:Ut(["react-flow__controls-button",e]),...n},t);pc.displayName="ControlButton";const cz=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom}),XT=({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:l,className:c,children:d,position:h="bottom-left"})=>{const f=Et(),[m,v]=D.useState(!1),{isInteractive:w,minZoomReached:T,maxZoomReached:y}=Ge(cz,$t),{zoomIn:_,zoomOut:S,fitView:C}=Yr();if(D.useEffect(()=>{v(!0)},[]),!m)return null;const O=()=>{_(),s==null||s()},z=()=>{S(),o==null||o()},A=()=>{C(i),a==null||a()},E=()=>{f.setState({nodesDraggable:!w,nodesConnectable:!w,elementsSelectable:!w}),l==null||l(!w)};return G.createElement(Ny,{className:Ut(["react-flow__controls",c]),position:h,style:t,"data-testid":"rf__controls"},e&&G.createElement(G.Fragment,null,G.createElement(pc,{onClick:O,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y},G.createElement(iz,null)),G.createElement(pc,{onClick:z,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:T},G.createElement(sz,null))),n&&G.createElement(pc,{className:"react-flow__controls-fitview",onClick:A,title:"fit view","aria-label":"fit view"},G.createElement(oz,null)),r&&G.createElement(pc,{className:"react-flow__controls-interactive",onClick:E,title:"toggle interactivity","aria-label":"toggle interactivity"},w?G.createElement(lz,null):G.createElement(az,null)),d)};XT.displayName="Controls";var uz=D.memo(XT),Sr;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(Sr||(Sr={}));function dz({color:t,dimensions:e,lineWidth:n}){return G.createElement("path",{stroke:t,strokeWidth:n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function hz({color:t,radius:e}){return G.createElement("circle",{cx:e,cy:e,r:e,fill:t})}const fz={[Sr.Dots]:"#91919a",[Sr.Lines]:"#eee",[Sr.Cross]:"#e2e2e2"},pz={[Sr.Dots]:1,[Sr.Lines]:1,[Sr.Cross]:6},mz=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function JT({id:t,variant:e=Sr.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=2,color:o,style:a,className:l}){const c=D.useRef(null),{transform:d,patternId:h}=Ge(mz,$t),f=o||fz[e],m=r||pz[e],v=e===Sr.Dots,w=e===Sr.Cross,T=Array.isArray(n)?n:[n,n],y=[T[0]*d[2]||1,T[1]*d[2]||1],_=m*d[2],S=w?[_,_]:y,C=v?[_/s,_/s]:[S[0]/s,S[1]/s];return G.createElement("svg",{className:Ut(["react-flow__background",l]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:c,"data-testid":"rf__background"},G.createElement("pattern",{id:h+t,x:d[0]%y[0],y:d[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${C[0]},-${C[1]})`},v?G.createElement(hz,{color:f,radius:_/s}):G.createElement(dz,{dimensions:S,color:f,lineWidth:i})),G.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${h+t})`}))}JT.displayName="Background";var gz=D.memo(JT),Oa;(function(t){t.Line="line",t.Handle="handle"})(Oa||(Oa={}));function yz({width:t,prevWidth:e,height:n,prevHeight:r,invertX:i,invertY:s}){const o=t-e,a=n-r,l=[o>0?1:o<0?-1:0,a>0?1:a<0?-1:0];return o&&i&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}const ZT={width:0,height:0,x:0,y:0},vz={...ZT,pointerX:0,pointerY:0,aspectRatio:1};function wz({nodeId:t,position:e,variant:n=Oa.Handle,className:r,style:i={},children:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,shouldResize:f,onResizeStart:m,onResize:v,onResizeEnd:w}){const T=dT(),y=typeof t=="string"?t:T,_=Et(),S=D.useRef(null),C=D.useRef(vz),O=D.useRef(ZT),z=zT(),A=n===Oa.Line?"right":"bottom-right",E=e??A;D.useEffect(()=>{if(!S.current||!y)return;const N=jn(S.current),R=E.includes("right")||E.includes("left"),P=E.includes("bottom")||E.includes("top"),F=E.includes("left"),L=E.includes("top"),$=jS().on("start",j=>{const M=_.getState().nodeInternals.get(y),{xSnapped:B,ySnapped:K}=z(j);O.current={width:(M==null?void 0:M.width)??0,height:(M==null?void 0:M.height)??0,x:(M==null?void 0:M.position.x)??0,y:(M==null?void 0:M.position.y)??0},C.current={...O.current,pointerX:B,pointerY:K,aspectRatio:O.current.width/O.current.height},m==null||m(j,{...O.current})}).on("drag",j=>{const{nodeInternals:M,triggerNodeChanges:B}=_.getState(),{xSnapped:K,ySnapped:U}=z(j),X=M.get(y);if(X){const J=[],{pointerX:te,pointerY:ae,width:pe,height:de,x:xe,y:be,aspectRatio:ke}=C.current,{x:He,y:Ve,width:Xe,height:ve}=O.current,mt=Math.floor(R?K-te:0),Ne=Math.floor(P?U-ae:0);let oe=ys(pe+(F?-mt:mt),a,c),Ae=ys(de+(L?-Ne:Ne),l,d);if(h){const St=oe/Ae,ze=R&&P,je=R&&!P,Vt=P&&!R;oe=St<=ke&&ze||Vt?Ae*ke:oe,Ae=St>ke&&ze||je?oe/ke:Ae,oe>=c?(oe=c,Ae=c/ke):oe<=a&&(oe=a,Ae=a/ke),Ae>=d?(Ae=d,oe=d*ke):Ae<=l&&(Ae=l,oe=l*ke)}const Pt=oe!==Xe,Dt=Ae!==ve;if(F||L){const St=F?xe-(oe-pe):xe,ze=L?be-(Ae-de):be,je=St!==He&&Pt,Vt=ze!==Ve&&Dt;if(je||Vt){const sn={id:X.id,type:"position",position:{x:je?St:He,y:Vt?ze:Ve}};J.push(sn),O.current.x=sn.position.x,O.current.y=sn.position.y}}if(Pt||Dt){const St={id:y,type:"dimensions",updateStyle:!0,resizing:!0,dimensions:{width:oe,height:Ae}};J.push(St),O.current.width=oe,O.current.height=Ae}if(J.length===0)return;const hn=yz({width:O.current.width,prevWidth:Xe,height:O.current.height,prevHeight:ve,invertX:F,invertY:L}),it={...O.current,direction:hn};if((f==null?void 0:f(j,it))===!1)return;v==null||v(j,it),B(J)}}).on("end",j=>{const M={id:y,type:"dimensions",resizing:!1};w==null||w(j,{...O.current}),_.getState().triggerNodeChanges([M])});return N.call($),()=>{N.on(".drag",null)}},[y,E,a,l,c,d,h,z,m,v,w]);const b=E.split("-"),I=n===Oa.Line?"borderColor":"backgroundColor",k=o?{...i,[I]:o}:i;return G.createElement("div",{className:Ut(["react-flow__resize-control","nodrag",...b,n,r]),ref:S,style:k},s)}var Mx=D.memo(wz);const _z=["top-left","top-right","bottom-left","bottom-right"],xz=["top","right","bottom","left"];function yl({nodeId:t,isVisible:e=!0,handleClassName:n,handleStyle:r,lineClassName:i,lineStyle:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,shouldResize:f,onResizeStart:m,onResize:v,onResizeEnd:w}){return e?G.createElement(G.Fragment,null,xz.map(T=>G.createElement(Mx,{key:T,className:i,style:s,nodeId:t,position:T,variant:Oa.Line,color:o,minWidth:a,minHeight:l,maxWidth:c,maxHeight:d,onResizeStart:m,keepAspectRatio:h,shouldResize:f,onResize:v,onResizeEnd:w})),_z.map(T=>G.createElement(Mx,{key:T,className:n,style:r,nodeId:t,position:T,color:o,minWidth:a,minHeight:l,maxWidth:c,maxHeight:d,onResizeStart:m,keepAspectRatio:h,shouldResize:f,onResize:v,onResizeEnd:w}))):null}/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),e2=(...t)=>t.filter((e,n,r)=>!!e&&r.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Ez={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=D.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>D.createElement("svg",{ref:l,...Ez,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:e2("lucide",i),...a},[...o.map(([c,d])=>D.createElement(c,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=(t,e)=>{const n=D.forwardRef(({className:r,...i},s)=>D.createElement(Iz,{ref:s,iconNode:e,className:e2(`lucide-${bz(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=se("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=se("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=se("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=se("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jx=se("BoxSelect",[["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M21 14v1",key:"169vum"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t2=se("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=se("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=se("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=se("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=se("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=se("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pz=se("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=se("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=se("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=se("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=se("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r2=se("CornerDownRight",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=se("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=se("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=se("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=se("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jz=se("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i2=se("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fz=se("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=se("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $z=se("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uz=se("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fx=se("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bz=se("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qz=se("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hy=se("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ri=se("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hz=se("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ky=se("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ya=se("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kz=se("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wy=se("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s2=se("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wz=se("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gz=se("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o2=se("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qz=se("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a2=se("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pm=se("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yz=se("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xz=se("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jz=se("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zz=se("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eM=se("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vl=se("PinOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V17h12",key:"13x2n8"}],["path",{d:"M15 9.34V6h1a2 2 0 0 0 0-4H7.89",key:"reo3ki"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=se("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tM=se("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $x=se("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nM=se("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gy=se("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rM=se("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iM=se("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sM=se("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l2=se("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c2=se("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oM=se("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aM=se("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u2=se("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d2=se("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=se("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h2=se("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f2=se("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lM=se("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cM=se("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qy=se("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uM=se("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=se("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dM=se("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hM=se("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),fM=({connectionColor:t="#dc2626",setConnectionColor:e=()=>{},connectionLineType:n,setConnectionLineType:r,lastSaved:i,onSave:s,onLoad:o,onClear:a,onHelp:l,isDarkMode:c,toggleTheme:d,searchTerm:h,setSearchTerm:f,onExport:m,isOpen:v,onToggle:w,onOpenCaseManager:T,currentBoardName:y,onToggleZen:_,onNextMatch:S,onPrevMatch:C,onToggleBg:O,onLogout:z,currentUser:A,isSyncing:E,syncError:b,onRetry:I,onManualSave:k})=>{const N=D.useRef(null),[R,P]=D.useState(()=>{try{const j=localStorage.getItem("sidebar-sections");return j?JSON.parse(j):{evidence:!0,connection:!0,extras:!0,zones:!0}}catch{return{evidence:!0,connection:!0,extras:!0,zones:!0}}});D.useEffect(()=>{localStorage.setItem("sidebar-sections",JSON.stringify(R))},[R]);const F=j=>{P(M=>({...M,[j]:!M[j]}))},L=()=>{const j=Object.values(R).some(M=>M);P(Object.keys(R).reduce((M,B)=>({...M,[B]:!j}),{}))},$=(j,M,B)=>{j.dataTransfer.setData("application/reactflow",M),j.dataTransfer.setData("application/category",B),j.dataTransfer.effectAllowed="move"};return p.jsxs("div",{className:`fixed top-0 left-0 h-full z-50 transition-transform duration-300 ease-in-out ${v?"translate-x-0":"-translate-x-full"} w-80 md:relative md:translate-x-0`,children:[p.jsxs("aside",{className:`h-full w-80 border-r flex flex-col shadow-2xl backdrop-blur-xl transition-colors duration-500 ease-in-out ${c?"bg-zinc-900/95 border-zinc-800":"bg-white/90 border-gray-200"}`,children:[p.jsxs("div",{className:`p-3 border-b transition-colors duration-500 ${c?"border-zinc-800":"border-gray-200"}`,children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("div",{children:p.jsxs("h1",{className:"text-lg font-bold text-red-500 tracking-widest uppercase leading-tight",children:["Detective",p.jsx("br",{}),"Board"]})}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:L,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:Object.values(R).some(j=>j)?"Colapsar todo":"Expandir todo",children:Object.values(R).some(j=>j)?p.jsx(Pz,{size:16}):p.jsx(Nz,{size:16})}),p.jsx("button",{onClick:_,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Modo Zen (Pantalla Completa)",children:p.jsx(Wz,{size:16})}),p.jsx("button",{onClick:O,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Cambiar Fondo (Corcho/Pizarra/Papel)",children:p.jsx(Xz,{size:16})}),p.jsx("button",{onClick:d,className:`p-2 rounded-full ${c?"bg-zinc-800 text-yellow-400 hover:bg-zinc-700":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Cambiar tema",children:c?p.jsx(d2,{size:16}):p.jsx(a2,{size:16})})]})]}),y&&p.jsxs("div",{className:"mt-2 px-2 py-1 bg-zinc-100/5 rounded border border-zinc-500/20",children:[p.jsx("p",{className:"text-xs text-zinc-500 font-mono uppercase mb-0",children:"Expediente:"}),p.jsx("p",{className:`text-xs font-bold font-mono truncate w-full ${c?"text-yellow-500":"text-yellow-700"}`,title:y,children:y})]})]}),p.jsx("div",{className:"px-3 pt-2 pb-1",children:p.jsxs("div",{className:`flex items-center px-2 py-1.5 rounded border transition-colors duration-500 ${c?"bg-zinc-950 border-zinc-800":"bg-white border-gray-300"}`,children:[p.jsx(l2,{size:12,className:"text-zinc-500 mr-2"}),p.jsx("input",{type:"text",name:"search",placeholder:"Buscar pistas...",value:h,onChange:j=>f(j.target.value),className:`bg-transparent w-full text-xs outline-none font-mono ${c?"text-zinc-300 placeholder-zinc-600":"text-zinc-700 placeholder-zinc-400"}`}),h&&p.jsxs("div",{className:"flex gap-1 ml-1 border-l border-zinc-700 pl-1",children:[p.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),C()},className:"p-0.5 hover:text-white text-zinc-500 transition-colors",title:"Anterior",children:p.jsx(Az,{size:12})}),p.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),S()},className:"p-0.5 hover:text-white text-zinc-500 transition-colors",title:"Siguiente",children:p.jsx(Sz,{size:12})})]})]})}),p.jsxs("div",{className:"p-3 space-y-2 overflow-y-auto",children:[p.jsx(Nd,{title:"Evidencia",icon:$z,isDarkMode:c,isOpen:R.evidence,onToggle:()=>F("evidence"),children:p.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[p.jsx(zt,{onDragStart:$,type:"evidence",category:"person",icon:Qy,label:"Sospechoso",color:"border-blue-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"evidence",category:"place",icon:s2,label:"Lugar",color:"border-green-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"evidence",category:"clue",icon:qy,label:"Pista",color:"border-yellow-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"evidence",category:"event",icon:t2,label:"Evento",color:"border-red-500",isDarkMode:c,compact:!0})]})}),p.jsxs(Nd,{title:"Configuracin de Hilo",icon:Kg,isDarkMode:c,isOpen:R.connection,onToggle:()=>F("connection"),children:[p.jsx("div",{className:"flex items-center justify-center gap-3 mb-2 px-1 py-0.5",children:[{color:"#dc2626",label:"Rojo"},{color:"#3b82f6",label:"Azul"},{color:"#22c55e",label:"Verde"},{color:"#eab308",label:"Amarillo"},{color:"#a855f7",label:"Morado"}].map(j=>p.jsx("button",{onClick:()=>e(j.color),className:`w-5 h-5 rounded-full border-2 transition-all ${t===j.color?"border-white scale-100 ring-1 ring-zinc-500":"border-transparent hover:scale-100"}`,style:{backgroundColor:j.color},title:j.label},j.color))}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:()=>r("straight"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="straight"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Recta",children:p.jsx(o2,{size:14})}),p.jsx("button",{onClick:()=>r("default"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="default"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Curva",children:p.jsx(Kg,{size:14})}),p.jsx("button",{onClick:()=>r("step"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="step"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Escalonada",children:p.jsx(r2,{size:14})})]})]}),p.jsx(Nd,{title:"Extras",icon:Hz,isDarkMode:c,isOpen:R.extras,onToggle:()=>F("extras"),children:p.jsxs("div",{className:"grid grid-cols-4 gap-1.5",children:[p.jsx(zt,{onDragStart:$,type:"note",category:"note",icon:u2,label:"Nota",color:"border-yellow-400",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"text",category:"text",icon:f2,label:"Texto",color:"border-zinc-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"image",category:"image",icon:Hy,label:"Imagen",color:"border-purple-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"url",category:"url",icon:Ky,label:"URL",color:"border-blue-500",isDarkMode:c,compact:!0})]})}),p.jsx(Nd,{title:"Zonas y Sellos",icon:jx,isDarkMode:c,isOpen:R.zones,onToggle:()=>F("zones"),children:p.jsxs("div",{className:"space-y-2",children:[p.jsx(zt,{onDragStart:$,type:"zone",category:"zone",icon:jx,label:"Zona de Grupo",color:"border-zinc-600",isDarkMode:c}),p.jsxs("div",{className:"grid grid-cols-3 gap-1.5 pt-1",children:[p.jsx(zt,{onDragStart:$,type:"stamp",category:"solved",icon:Dz,label:"Resuelto",color:"border-green-600",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"stamp",category:"discarded",icon:Vz,label:"Descartado",color:"border-red-600",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"stamp",category:"key",icon:aM,label:"Clave",color:"border-yellow-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"stamp",category:"question",icon:Wg,label:"?",color:"border-blue-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"stamp",category:"important",icon:h2,label:"!",color:"border-orange-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"stamp",category:"verify",icon:i2,label:"Ojo",color:"border-purple-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"stamp",category:"danger",icon:c2,label:"Peligro",color:"border-red-600",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"stamp",category:"confidential",icon:Ya,label:"Top",color:"border-zinc-500",isDarkMode:c,compact:!0}),p.jsx(zt,{onDragStart:$,type:"stamp",category:"custom",icon:Jz,label:"Personalizado",color:"border-zinc-400",isDarkMode:c,compact:!0})]})]})})]}),p.jsxs("div",{className:`mt-auto p-3 border-t space-y-2 transition-colors duration-500 ${c?"border-zinc-800":"border-gray-200"}`,children:[p.jsxs("button",{onClick:T,title:"Abrir gestor de expedientes",className:`w-full py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-yellow-900/20 text-yellow-500 border-yellow-900/50 hover:bg-yellow-900/40":"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100"}`,children:[p.jsx(Uz,{size:14})," Gestionar Casos"]}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsxs("button",{onClick:s,className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Descargar (JSON)",children:[p.jsx(Fz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Descargar"})]}),p.jsxs("button",{onClick:()=>N.current.click(),className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Cargar (JSON)",children:[p.jsx(cM,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Cargar"})]}),p.jsxs("button",{onClick:m,className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Exportar (PNG)",children:[p.jsx(Mz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"PNG"})]})]}),p.jsx("input",{type:"file",name:"file-upload",ref:N,onChange:o,className:"hidden",accept:".json"}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsxs("button",{onClick:k,title:"Guardar cambios en la nube ahora",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,children:[p.jsx(sM,{size:14})," Guardar"]}),p.jsxs("button",{onClick:a,title:"Borrar todo el contenido",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-red-900/20 text-red-500 border-red-900/50 hover:bg-red-900/40":"bg-red-50 text-red-600 border-red-200 hover:bg-red-100"}`,children:[p.jsx(Gg,{size:14})," Limpiar"]}),p.jsxs("button",{onClick:l,title:"Ver atajos de teclado",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,children:[p.jsx(Wg,{size:14})," Ayuda"]})]}),i&&p.jsxs("div",{className:`text-[10px] text-center mt-2 font-mono ${c?"text-zinc-600":"text-gray-400"}`,children:["Guardado: ",i.toLocaleTimeString()]}),p.jsxs("button",{onClick:z,className:`w-full py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 mt-2 ${c?"bg-red-950/50 text-red-500 border-red-900/30 hover:bg-red-900/40":"bg-red-50 text-red-600 border-red-200 hover:bg-red-100"}`,children:[p.jsx(Kz,{size:14})," Cerrar Sesin"]})]})]}),p.jsx("button",{onClick:w,className:`absolute top-6 -right-8 p-1.5 rounded-r-md shadow-md border-y border-r cursor-pointer flex items-center justify-center transition-colors duration-500 ${c?"bg-zinc-900 border-zinc-800 text-zinc-400 hover:text-white":"bg-white border-gray-200 text-zinc-600 hover:text-black"}`,title:v?"Ocultar barra lateral":"Mostrar barra lateral",children:v?p.jsx(Rz,{size:16}):p.jsx(kz,{size:16})})]})},Nd=({title:t,icon:e,isDarkMode:n,children:r,isOpen:i,onToggle:s})=>p.jsxs("div",{className:`p-2 rounded-lg border transition-all duration-200 ${n?"bg-zinc-950/50 border-zinc-800":"bg-white border-gray-200 shadow-sm"}`,children:[p.jsxs("button",{onClick:s,className:`w-full text-xs font-bold uppercase flex items-center justify-between gap-2 ${n?"text-zinc-500 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(e,{size:10})," ",t]}),p.jsx("div",{className:`transition-transform duration-300 ${i?"rotate-0":"-rotate-90"}`,children:p.jsx(Cz,{size:12})})]}),p.jsx("div",{className:`grid transition-all duration-300 ease-in-out ${i?"grid-rows-[1fr] opacity-100 mt-2":"grid-rows-[0fr] opacity-0 mt-0"}`,children:p.jsx("div",{className:"overflow-hidden",children:r})})]}),zt=({onDragStart:t,type:e,category:n,icon:r,label:i,color:s,isDarkMode:o,compact:a})=>p.jsxs("div",{className:`${a?"flex flex-col items-center justify-center p-2 gap-1 text-center":"flex items-center gap-3 p-3"} rounded cursor-grab border-l-4 ${s.replace("border-","border-l-")} transition-all ${a?"hover:scale-105":"hover:translate-x-2"} ${o?"bg-zinc-800/40 border-y border-r border-zinc-800 hover:bg-zinc-800":"bg-white border-y border-r border-gray-200 hover:bg-gray-50 shadow-sm"}`,onDragStart:l=>t(l,e,n),draggable:!0,title:i,children:[p.jsx(r,{size:a?16:18,className:s.replace("border-","text-")}),p.jsx("span",{className:`${a?"text-[10px]":"text-sm"} font-bold font-mono ${o?"text-zinc-300":"text-zinc-700"}`,children:i})]}),pM=({isOpen:t,onClose:e,node:n,onSave:r,onDelete:i,isDarkMode:s})=>{const[o,a]=D.useState(""),[l,c]=D.useState(""),[d,h]=D.useState(""),[f,m]=D.useState("clue"),[v,w]=D.useState(!1);if(D.useEffect(()=>{n&&(a(n.data.label||""),c(n.data.description||""),h(n.data.image||""),m(n.data.category||"clue"),w(!1))},[n]),!t)return null;if(v)return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm",children:p.jsxs("div",{className:`${s?"bg-zinc-900":"bg-white"} border border-red-900/50 p-6 rounded-lg w-96 shadow-2xl animate-in fade-in zoom-in duration-200 text-center`,children:[p.jsx("h2",{className:"text-xl font-bold text-red-500 font-mono tracking-wider mb-4",children:"ELIMINAR EVIDENCIA?"}),p.jsx("p",{className:`${s?"text-zinc-400":"text-gray-600"} text-sm font-mono mb-6`,children:"Esta accin es irreversible. Ests seguro?"}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsx("button",{onClick:()=>w(!1),className:`px-4 py-2 ${s?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:"Cancelar"}),p.jsx("button",{onClick:()=>i(n.id),className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Confirmar"})]})]})});const T=y=>{y.preventDefault(),r(n.id,{...n.data,label:o,description:l,image:d,category:f}),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm",children:p.jsxs("div",{className:`${s?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-96 shadow-2xl animate-in fade-in zoom-in duration-200`,children:[p.jsxs("div",{className:`flex justify-between items-center mb-4 border-b ${s?"border-zinc-800":"border-gray-200"} pb-2`,children:[p.jsx("h2",{className:"text-xl font-bold text-red-500 font-mono tracking-wider",children:"EDITAR EVIDENCIA"}),p.jsx("button",{onClick:e,className:`${s?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(Is,{size:20})})]}),p.jsxs("form",{onSubmit:T,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-category",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Categora"}),p.jsxs("select",{id:"evidence-category",name:"evidence-category",value:f,onChange:y=>m(y.target.value),className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all text-sm`,children:[p.jsx("option",{value:"person",children:"Sospechoso"}),p.jsx("option",{value:"place",children:"Lugar"}),p.jsx("option",{value:"clue",children:"Pista"}),p.jsx("option",{value:"event",children:"Evento"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-title",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Ttulo"}),p.jsx("input",{id:"evidence-title",type:"text",name:"evidence-title",value:o,onChange:y=>a(y.target.value),className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all`,autoFocus:!0})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-description",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Descripcin"}),p.jsx("textarea",{id:"evidence-description",name:"evidence-description",value:l,onChange:y=>c(y.target.value),rows:4,className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-300":"bg-gray-50 border-gray-300 text-gray-700"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono text-sm resize-none transition-all`})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-image-url",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Imagen (URL o Local)"}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("input",{id:"evidence-image-url",type:"text",name:"evidence-image-url",value:d,onChange:y=>h(y.target.value),placeholder:"https://...",className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-400":"bg-gray-50 border-gray-300 text-gray-600"} border p-2 rounded focus:border-red-900 outline-none font-mono text-xs`}),p.jsx("div",{className:`text-[10px] ${s?"text-zinc-600":"text-gray-400"} text-center font-mono uppercase tracking-widest`,children:"- O -"}),p.jsxs("label",{className:`flex items-center justify-center w-full p-2 ${s?"bg-zinc-950 border-zinc-800 hover:border-zinc-600 hover:text-zinc-200":"bg-gray-50 border-gray-300 hover:border-gray-400 hover:text-gray-800"} border border-dashed rounded cursor-pointer transition-colors group`,children:[p.jsx("span",{className:`text-xs ${s?"text-zinc-500 group-hover:text-zinc-300":"text-gray-500 group-hover:text-gray-700"} font-mono uppercase`,children:"Subir archivo local"}),p.jsx("input",{type:"file",name:"evidence-image-file",className:"hidden",accept:"image/*",onChange:y=>{const _=y.target.files[0];if(_){const S=new FileReader;S.onload=C=>h(C.target.result),S.readAsDataURL(_)}}})]})]})]}),n.data.status&&p.jsx("div",{className:`flex justify-end pt-2 border-t ${s?"border-zinc-800":"border-gray-200"}`,children:p.jsxs("button",{type:"button",onClick:()=>{r(n.id,{...n.data,status:null}),e()},className:"text-[10px] flex items-center gap-1 text-orange-500 hover:text-orange-400 uppercase font-bold tracking-wider",children:[p.jsx(By,{size:12})," Quitar Sello"]})}),p.jsxs("div",{className:`flex justify-between items-center mt-6 pt-4 border-t ${s?"border-zinc-800":"border-gray-200"}`,children:[p.jsx("button",{type:"button",onClick:()=>w(!0),className:"text-red-600 hover:text-red-500 text-xs font-bold uppercase tracking-wider transition-colors",children:"Eliminar"}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:`px-4 py-2 ${s?"text-zinc-400 hover:text-white":"text-gray-500 hover:text-gray-800"} text-xs font-bold uppercase tracking-wider transition-colors`,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Guardar"})]})]})]})]})})};let Pd;const mM=new Uint8Array(16);function gM(){if(!Pd&&(Pd=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Pd))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Pd(mM)}const qt=[];for(let t=0;t<256;++t)qt.push((t+256).toString(16).slice(1));function yM(t,e=0){return qt[t[e+0]]+qt[t[e+1]]+qt[t[e+2]]+qt[t[e+3]]+"-"+qt[t[e+4]]+qt[t[e+5]]+"-"+qt[t[e+6]]+qt[t[e+7]]+"-"+qt[t[e+8]]+qt[t[e+9]]+"-"+qt[t[e+10]]+qt[t[e+11]]+qt[t[e+12]]+qt[t[e+13]]+qt[t[e+14]]+qt[t[e+15]]}const vM=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ux={randomUUID:vM};function Fn(t,e,n){if(Ux.randomUUID&&!t)return Ux.randomUUID();t=t||{};const r=t.random||(t.rng||gM)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,yM(r)}function wM({top:t,left:e,right:n,bottom:r,clientX:i,clientY:s,onHide:o,takeSnapshot:a,setNodes:l}){const{screenToFlowPosition:c,setCenter:d,getZoom:h}=Yr(),f=v=>{v.stopPropagation();const{x:w,y:T}=c({x:i,y:s});d(w,T,{zoom:h(),duration:800}),o()},m=D.useCallback((v,w,T)=>{const y=c({x:i,y:s}),_={id:Fn(),type:v,position:y,data:{label:T,category:w}};a(),l(S=>S.concat(_)),o()},[i,s,c,a,l,o]);return p.jsxs("div",{style:{top:t,left:e,right:n,bottom:r},className:"absolute z-50 bg-zinc-800 border border-zinc-700 shadow-xl rounded-md overflow-hidden min-w-[150px] flex flex-col animate-in fade-in zoom-in duration-100",children:[p.jsxs("button",{onClick:f,className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors border-b border-zinc-700",children:[p.jsx(zz,{size:14,className:"text-blue-400"})," Centrar Vista"]}),p.jsxs("button",{onClick:()=>m("note","note","Nota"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(u2,{size:14,className:"text-yellow-500"})," Aadir Nota"]}),p.jsxs("button",{onClick:()=>m("text","text","Texto"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(f2,{size:14,className:"text-zinc-400"})," Aadir Texto"]}),p.jsxs("button",{onClick:()=>m("image","image","Imagen"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(Hy,{size:14,className:"text-purple-500"})," Aadir Imagen"]}),p.jsxs("button",{onClick:()=>m("url","url","Enlace"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(Ky,{size:14,className:"text-blue-400"})," Aadir URL"]})]})}const _M=({isOpen:t,onClose:e,onConfirm:n,title:r,message:i,confirmText:s="Confirmar",cancelText:o="Cancelar",isDanger:a=!1,isDarkMode:l})=>t?p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[300] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${l?"bg-zinc-900":"bg-white"} border ${a?"border-red-900/50":l?"border-zinc-700":"border-gray-200"} p-6 rounded-lg w-96 shadow-2xl animate-in zoom-in duration-200 text-center`,children:[p.jsx("h2",{className:`text-xl font-bold ${a?"text-red-500":l?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-4`,children:r}),p.jsx("p",{className:`${l?"text-zinc-400":"text-gray-600"} text-sm font-mono mb-6`,children:i}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsx("button",{onClick:e,className:`px-4 py-2 ${l?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:o}),p.jsx("button",{onClick:()=>{n&&n(),e()},className:`px-6 py-2 ${a?"bg-red-900/80 hover:bg-red-800 text-red-100 border-red-900":"bg-blue-900/80 hover:bg-blue-800 text-blue-100 border-blue-900"} text-xs font-bold uppercase tracking-wider rounded shadow-lg border transition-all`,children:s})]})]})}):null,xM=({isOpen:t,onClose:e,isDarkMode:n})=>{if(!t)return null;const r=[{key:"Doble Clic (Nodo)",desc:"Editar contenido de la evidencia",icon:pm},{key:"Doble Clic (Hilo)",desc:"Aadir/Editar etiqueta de relacin",icon:pm},{key:"Clic (Hilo)",desc:"Cambiar estilo (Slido / Punteado)",icon:pm},{key:"Backspace",desc:"Eliminar elementos seleccionados",icon:ri},{key:"Ctrl + D",desc:"Duplicar nodos seleccionados",icon:ri},{key:"Ctrl + Z",desc:"Deshacer accin",icon:ri},{key:"Ctrl + Y",desc:"Rehacer accin",icon:ri},{key:"Ctrl + S",desc:"Guardar tablero manualmente",icon:ri},{key:"Ctrl + V",desc:"Pegar imagen del portapapeles",icon:ri},{key:"F3 / Shift + F3",desc:"Navegar resultados de bsqueda",icon:ri},{key:"Shift + C",desc:"Conectar nodos seleccionados",icon:ri},{key:"Ctrl + Shift + L",desc:"Bloquear/Desbloquear seleccin",icon:Ya}];return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${n?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-[500px] shadow-2xl animate-in zoom-in duration-200 relative`,children:[p.jsx("button",{onClick:e,className:`absolute top-4 right-4 ${n?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(Is,{size:20})}),p.jsxs("h2",{className:`text-xl font-bold ${n?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-6 flex items-center gap-2`,children:[p.jsx(ri,{className:"text-red-500"})," ATAJOS DE TECLADO"]}),p.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.map((i,s)=>p.jsxs("div",{className:`flex items-center justify-between p-2 rounded border transition-colors ${n?"bg-zinc-950/50 border-zinc-800/50 hover:border-zinc-700":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(i.icon,{size:14,className:n?"text-zinc-500":"text-gray-400"}),p.jsx("span",{className:`${n?"text-zinc-300":"text-gray-700"} text-sm font-mono`,children:i.desc})]}),p.jsx("span",{className:"text-xs font-bold text-red-400 bg-red-900/10 px-2 py-1 rounded border border-red-900/20 font-mono",children:i.key})]},s))})]})})},bM=({isOpen:t,onClose:e,onConfirm:n,onDelete:r,title:i,initialValue:s="",initialColor:o="#dc2626",initialType:a,showTypeSelector:l=!1,colorLabel:c="Color",placeholder:d="Escribe una relacin...",isDarkMode:h})=>{const[f,m]=D.useState(s),[v,w]=D.useState(o),[T,y]=D.useState(a||"default");if(D.useEffect(()=>{t&&(m(s),w(o),a&&y(a))},[t,s,o,a]),!t)return null;const _=[{color:"#dc2626",label:"Rojo"},{color:"#3b82f6",label:"Azul"},{color:"#22c55e",label:"Verde"},{color:"#eab308",label:"Amarillo"},{color:"#a855f7",label:"Morado"}],S=C=>{C.preventDefault(),n(f,v,T),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${h?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-96 shadow-2xl animate-in zoom-in duration-200`,children:[p.jsx("h2",{className:`text-xl font-bold ${h?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-4`,children:i}),p.jsxs("form",{onSubmit:S,children:[p.jsx("input",{type:"text",name:"input-value",value:f,onChange:C=>m(C.target.value),className:`w-full ${h?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all mb-4`,autoFocus:!0,placeholder:d}),l&&p.jsxs("div",{className:"mb-4",children:[p.jsx("span",{className:`block text-xs font-bold ${h?"text-zinc-500":"text-gray-500"} uppercase mb-2 font-mono`,children:"Tipo de Conexin"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{type:"button",onClick:()=>y("straight"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${T==="straight"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Recta",children:p.jsx(o2,{size:16})}),p.jsx("button",{type:"button",onClick:()=>y("default"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${T==="default"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Curva",children:p.jsx(Kg,{size:16})}),p.jsx("button",{type:"button",onClick:()=>y("step"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${T==="step"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Escalonada",children:p.jsx(r2,{size:16})})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("span",{className:`block text-xs font-bold ${h?"text-zinc-500":"text-gray-500"} uppercase mb-2 font-mono`,children:c}),p.jsx("div",{className:"flex gap-3",children:_.map(C=>p.jsx("button",{type:"button",onClick:()=>w(C.color),className:`w-6 h-6 rounded-full border-2 transition-all ${v===C.color?(h?"border-white ring-zinc-400":"border-gray-800 ring-gray-400")+" scale-110 ring-1":"border-transparent hover:scale-110"}`,style:{backgroundColor:C.color},title:C.label},C.color))})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[r?p.jsx("button",{type:"button",onClick:r,className:"text-red-600 hover:text-red-500 text-xs font-bold uppercase tracking-wider transition-colors",children:"Eliminar"}):p.jsx("div",{}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:`px-4 py-2 ${h?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Guardar"})]})]})]})]})})},EM=({isOpen:t,onClose:e,boards:n,currentBoardId:r,onSwitch:i,onCreate:s,onDelete:o,onRename:a,onClone:l,onReorder:c,trash:d,onRestore:h,onPermanentDelete:f,isDarkMode:m})=>{const[v,w]=D.useState(null),[T,y]=D.useState(""),[_,S]=D.useState(!1),[C,O]=D.useState(""),[z,A]=D.useState(null),[E,b]=D.useState(""),[I,k]=D.useState("manual"),[N,R]=D.useState(!1),P=D.useMemo(()=>{let X=(N?d:n).filter(J=>J.name.toLowerCase().includes(E.toLowerCase()));return I==="name"?X.sort((J,te)=>J.name.localeCompare(te.name)):I==="created"?X.sort((J,te)=>te.createdAt-J.createdAt):I==="modified"?X.sort((J,te)=>(te.lastModified||0)-(J.lastModified||0)):X},[n,d,E,I,N]),F=I==="manual"&&!E&&!N,L=(U,X)=>{U.dataTransfer.setData("boardIndex",X),U.dataTransfer.effectAllowed="move"},$=U=>{U.preventDefault(),U.dataTransfer.dropEffect="move"},j=(U,X)=>{U.preventDefault();const J=parseInt(U.dataTransfer.getData("boardIndex"));if(isNaN(J)||J===X)return;const te=[...n],[ae]=te.splice(J,1);te.splice(X,0,ae),c(te)};if(!t)return null;const M=U=>{w(U.id),y(U.name)},B=()=>{T.trim()&&a(v,T),w(null)},K=()=>{C.trim()&&(s(C),O(""),S(!1))};return p.jsx("div",{className:"fixed inset-0 bg-black/90 z-[200] flex items-center justify-center backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${m?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border w-[900px] h-[600px] rounded-lg shadow-2xl flex flex-col overflow-hidden`,children:[p.jsxs("div",{className:`p-6 border-b ${m?"border-zinc-800 bg-zinc-950":"border-gray-200 bg-gray-50"} flex justify-between items-center z-50 relative`,children:[p.jsxs("div",{children:[p.jsxs("h2",{className:`text-2xl font-bold ${m?"text-zinc-100":"text-gray-800"} font-mono tracking-widest flex items-center gap-3 uppercase`,children:[N?p.jsx($x,{className:"text-red-500",size:28}):p.jsx(Fx,{className:"text-yellow-600",size:28}),N?"PAPELERA DE RECICLAJE":"ARCHIVOS DE CASO"]}),p.jsx("p",{className:`${m?"text-zinc-500":"text-gray-500"} text-xs font-mono mt-1`,children:N?"Restaura casos eliminados o brralos definitivamente":"Selecciona un expediente para investigar"})]}),p.jsx("button",{onClick:e,className:`${m?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(Is,{size:24})})]}),p.jsxs("div",{className:`px-6 py-3 border-b flex gap-4 items-center justify-between ${m?"border-zinc-800 bg-zinc-900/50":"border-gray-200 bg-gray-50/50"}`,children:[p.jsxs("div",{className:`flex-1 flex items-center px-3 py-1.5 rounded border ${m?"bg-zinc-950 border-zinc-700":"bg-white border-gray-300"}`,children:[p.jsx(l2,{size:14,className:m?"text-zinc-500":"text-gray-400"}),p.jsx("input",{type:"text",name:"case-search",placeholder:"Buscar expediente...",value:E,onChange:U=>b(U.target.value),className:`ml-2 bg-transparent w-full text-xs outline-none font-mono ${m?"text-zinc-300 placeholder-zinc-600":"text-zinc-700 placeholder-zinc-400"}`})]}),p.jsxs("button",{onClick:()=>R(!N),className:`flex items-center gap-2 px-3 py-1.5 rounded border text-xs font-bold uppercase transition-colors ${N?m?"bg-red-900/30 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-600":m?"bg-zinc-900 border-zinc-700 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-600 hover:text-black"}`,children:[N?p.jsx(Fx,{size:14}):p.jsx($x,{size:14}),N?"Ver Archivos":"Papelera"]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(Tz,{size:14,className:m?"text-zinc-500":"text-gray-400"}),p.jsxs("select",{name:"sort-cases",value:I,onChange:U=>k(U.target.value),className:`text-xs font-mono p-1.5 rounded border outline-none cursor-pointer ${m?"bg-zinc-950 border-zinc-700 text-zinc-300":"bg-white border-gray-300 text-zinc-700"}`,children:[p.jsx("option",{value:"manual",children:"Manual (Arrastrar)"}),p.jsx("option",{value:"name",children:"Nombre (A-Z)"}),p.jsx("option",{value:"created",children:"Creado (Reciente)"}),p.jsx("option",{value:"modified",children:"Modificado (Reciente)"})]})]})]}),p.jsx("div",{className:`flex-1 p-8 overflow-y-auto overflow-x-hidden ${m?"bg-zinc-900/50":"bg-gray-100"}`,children:p.jsxs("div",{className:"flex flex-wrap justify-center items-start gap-y-12 pl-8 pb-12 pt-[2px]",children:[!E&&!N&&(_?p.jsx("div",{className:"relative w-56 h-40 -ml-12 first:ml-0 z-50 transition-all duration-300 shadow-2xl transform scale-105",children:p.jsxs("div",{className:`flex flex-col items-center justify-center h-full border-2 border-dashed border-yellow-600/50 bg-yellow-900/10 rounded-lg p-4 animate-in zoom-in duration-200 ${m?"bg-zinc-900":"bg-white"}`,children:[p.jsx("span",{className:"text-yellow-500 font-mono text-xs font-bold mb-2",children:"NOMBRE DEL CASO"}),p.jsx("input",{type:"text",name:"new-case-name",autoFocus:!0,value:C,onChange:U=>O(U.target.value),onKeyDown:U=>{U.key==="Enter"&&K(),U.key==="Escape"&&S(!1)},placeholder:"Ej: El Robo del Siglo",className:`${m?"bg-zinc-950 border-zinc-700 text-white":"bg-white border-gray-300 text-gray-900"} border text-xs p-2 w-full rounded outline-none focus:border-yellow-600 font-mono text-center mb-2`}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>S(!1),className:`${m?"text-zinc-500 hover:text-white hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 hover:bg-gray-200"} text-[10px] uppercase font-bold px-2 py-1 rounded`,children:"Cancelar"}),p.jsx("button",{onClick:K,className:"text-zinc-900 bg-yellow-600 hover:bg-yellow-500 text-[10px] uppercase font-bold px-3 py-1 rounded",children:"Crear"})]})]})}):p.jsx("button",{onClick:()=>{S(!0),O(`Caso #${n.length+1}`)},className:"relative w-56 h-40 -ml-12 first:ml-0 transition-all duration-300 group",style:{zIndex:z==="new"?50:0,transform:z==="new"?"translateY(-1rem) scale(1.05) rotate(0deg)":"rotate(-3deg)"},onMouseEnter:()=>A("new"),onMouseLeave:()=>A(null),children:p.jsxs("div",{className:`flex flex-col items-center justify-center h-full border-2 border-dashed rounded-lg shadow-lg ${m?"border-zinc-700 hover:border-zinc-500 bg-zinc-800/50":"border-gray-300 hover:border-gray-400 bg-white"}`,children:[p.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 transition-all group-hover:scale-110 ${m?"bg-zinc-800 group-hover:bg-zinc-700":"bg-gray-200 group-hover:bg-gray-300"}`,children:p.jsx(tM,{className:m?"text-zinc-400 group-hover:text-white":"text-gray-500 group-hover:text-gray-800"})}),p.jsx("span",{className:`${m?"text-zinc-400 group-hover:text-white":"text-gray-500 group-hover:text-gray-800"} font-mono text-sm font-bold`,children:"NUEVO CASO"})]})})),P.map((U,X)=>{const J=z===U.id,te=r===U.id,ae=U.isDeleting,pe=X%3===0?"2deg":X%3===1?"-1deg":"3deg";return p.jsx("div",{draggable:F,onDragStart:de=>L(de,X),onDragOver:$,onDrop:de=>j(de,X),className:"relative w-56 h-40 -ml-12 transition-all duration-300 ease-out cursor-pointer group",style:{zIndex:J?50:X+1,transform:J?"translateY(-1.5rem) scale(1.1) rotate(0deg)":`rotate(${pe})`,animation:ae?"delete-burn 0.5s ease-in-out forwards":"none",pointerEvents:ae?"none":"auto"},onMouseEnter:()=>A(U.id),onMouseLeave:()=>A(null),onClick:()=>{v!==U.id&&!N&&i(U.id)},children:p.jsxs("div",{className:`relative flex flex-col h-full border-2 rounded-lg overflow-hidden shadow-[0_5px_15px_rgba(0,0,0,0.5)] transition-colors duration-300
                    ${te?m?"border-yellow-500 bg-yellow-900/40":"border-yellow-500 bg-yellow-100":m?N?"border-zinc-700 bg-zinc-900/50":"border-yellow-900/40 bg-yellow-950/30 hover:border-yellow-700 hover:bg-yellow-900/20":N?"border-gray-300 bg-gray-100":"border-yellow-200 bg-yellow-50 hover:border-yellow-300 hover:bg-yellow-100"}
                `,children:[F&&J&&p.jsx("div",{className:"absolute top-2 right-2 text-yellow-600/50",children:p.jsx(qz,{size:16})}),p.jsx("div",{className:`absolute top-0 left-0 w-24 h-6 rounded-br-lg border-b-2 border-r-2 shadow-sm transition-colors duration-300
                        ${te?"bg-yellow-500 border-yellow-500":m?N?"bg-zinc-800 border-zinc-700":"bg-yellow-900/40 border-yellow-900/40 group-hover:bg-yellow-800 group-hover:border-yellow-700":N?"bg-gray-300 border-gray-300":"bg-yellow-200 border-yellow-200 group-hover:bg-yellow-300 group-hover:border-yellow-300"}
                    `}),p.jsxs("div",{className:"flex-1 p-4 pt-8 flex flex-col items-center justify-between text-center",children:[p.jsxs("div",{children:[p.jsx(qy,{size:32,className:`mb-2 drop-shadow-md transition-colors duration-300 ${te?m?"text-yellow-400":"text-yellow-600":m?"text-yellow-800/60 group-hover:text-yellow-600":"text-yellow-300 group-hover:text-yellow-500"}`}),v===U.id?p.jsxs("div",{className:"flex items-center gap-1 w-full",onClick:de=>de.stopPropagation(),children:[p.jsx("input",{type:"text",name:"edit-case-name",value:T,onChange:de=>y(de.target.value),className:`${m?"bg-zinc-950 border-zinc-600 text-white":"bg-white border-gray-300 text-gray-900"} border text-xs p-1 w-full rounded outline-none focus:border-yellow-600 font-mono`,autoFocus:!0,onKeyDown:de=>de.key==="Enter"&&B()}),p.jsx("button",{onClick:B,className:"text-green-500 hover:text-green-400",children:p.jsx(n2,{size:14})})]}):p.jsx("h3",{className:`font-mono font-bold text-sm line-clamp-2 ${r===U.id?m?"text-yellow-100":"text-yellow-800":m?N?"text-zinc-500 line-through":"text-zinc-300":N?"text-gray-400 line-through":"text-gray-700"}`,onDoubleClick:de=>{N||(de.stopPropagation(),M(U))},children:U.name})]}),p.jsxs("div",{className:`text-[10px] ${m?"text-zinc-500":"text-gray-500"} font-mono w-full`,children:[U.lastModified&&p.jsxs("p",{children:["Modif: ",new Date(U.lastModified).toLocaleString([],{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),p.jsxs("p",{className:`${m?"text-zinc-600":"text-gray-400"}`,children:["Creado: ",new Date(U.createdAt).toLocaleDateString()]})]})]}),p.jsx("div",{className:`absolute bottom-2 right-2 flex gap-1 ${N?"opacity-100":"opacity-0 group-hover:opacity-100"} transition-opacity z-50`,onClick:de=>de.stopPropagation(),children:N?p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:de=>{de.stopPropagation(),h(U.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-green-500 hover:text-green-400 hover:bg-zinc-950 border-zinc-700":"bg-white text-green-600 hover:text-green-700 hover:bg-gray-50 border-gray-200"}`,title:"Restaurar Caso",children:p.jsx(Gy,{size:12})}),p.jsx("button",{onClick:de=>{de.stopPropagation(),f(U.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-red-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-red-600 hover:bg-gray-50 border-gray-200"}`,title:"Eliminar Definitivamente",children:p.jsx(Gg,{size:12})})]}):p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:de=>{de.preventDefault(),de.stopPropagation(),l(U.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-green-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-green-600 hover:bg-gray-50 border-gray-200"}`,title:"Clonar Caso",children:p.jsx(Oz,{size:12})}),p.jsx("button",{onClick:de=>{de.stopPropagation(),M(U)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-blue-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-blue-600 hover:bg-gray-50 border-gray-200"}`,title:"Renombrar Caso",children:p.jsx(eM,{size:12})}),n.length>1&&p.jsx("button",{onClick:de=>{de.stopPropagation(),o(U.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-red-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-red-600 hover:bg-gray-50 border-gray-200"}`,title:"Mover a Papelera",children:p.jsx(Gg,{size:12})})]})})]})},U.id)})]})}),p.jsx("div",{className:`p-4 border-t text-center z-50 relative ${m?"bg-zinc-950 border-zinc-800":"bg-gray-50 border-gray-200"}`,children:p.jsx("p",{className:`${m?"text-zinc-600":"text-gray-400"} text-[10px] font-mono`,children:"CONFIDENCIAL - SOLO PARA USO OFICIAL"})})]})})},IM=({isZenMode:t,setIsZenMode:e,undo:n,redo:r,isDarkMode:i})=>p.jsxs("div",{className:"absolute top-4 right-4 z-50 flex gap-2",children:[!t&&p.jsxs(p.Fragment,{children:[p.jsxs("button",{onClick:n,className:`px-4 py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 shadow-lg ${i?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-white text-zinc-600 border-gray-300 hover:bg-gray-100"}`,title:"Deshacer (Ctrl+Z)",children:[p.jsx(lM,{size:14})," Deshacer"]}),p.jsxs("button",{onClick:r,className:`px-4 py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 shadow-lg ${i?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-white text-zinc-600 border-gray-300 hover:bg-gray-100"}`,title:"Rehacer (Ctrl+Y)",children:[p.jsx(nM,{size:14})," Rehacer"]})]}),t&&p.jsxs("button",{onClick:()=>e(!1),className:"px-4 py-2 bg-black/50 hover:bg-black/80 text-white border border-white/20 rounded backdrop-blur-sm flex items-center gap-2 transition-all animate-in fade-in",title:"Salir de Modo Zen (Esc)",children:[p.jsx(Gz,{size:14})," Salir"]})]}),Yy=(t,e)=>{if(!t||!t.type.startsWith("image/"))return;const n=new FileReader;n.onload=r=>{const i=new Image;i.onload=()=>{let o=i.width,a=i.height;if(o>400||a>400){const h=o/a;o>a?(o=400,a=400/h):(a=400,o=400*h)}const l=document.createElement("canvas");l.width=o,l.height=a,l.getContext("2d").drawImage(i,0,0,o,a);const d=l.toDataURL("image/jpeg",.7);e(d,o,a)},i.src=r.target.result},n.readAsDataURL(t)},SM=({isInteractive:t,reactFlowInstance:e,takeSnapshot:n,setNodes:r})=>{D.useEffect(()=>{const i=s=>{if(!t||!e)return;const o=s.clipboardData.items;for(const a of o)if(a.type.indexOf("image")!==-1){const l=a.getAsFile();Yy(l,(c,d,h)=>{const f=e.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2}),m={id:Fn(),type:"image",position:f,data:{label:"Imagen Pegada",image:c},style:{width:d,height:h}};n(),r(v=>v.concat(m))})}};return window.addEventListener("paste",i),()=>window.removeEventListener("paste",i)},[e,t,n,r])};function TM(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),e&&(r.href=e),i.href=t,i.href}const AM=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function us(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let ta=null;function p2(t={}){return ta||(t.includeStyleProperties?(ta=t.includeStyleProperties,ta):(ta=us(window.getComputedStyle(document.documentElement)),ta))}function ef(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function CM(t){const e=ef(t,"border-left-width"),n=ef(t,"border-right-width");return t.clientWidth+e+n}function RM(t){const e=ef(t,"border-top-width"),n=ef(t,"border-bottom-width");return t.clientHeight+e+n}function m2(t,e={}){const n=e.width||CM(t),r=e.height||RM(t);return{width:n,height:r}}function kM(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const zn=16384;function NM(t){(t.width>zn||t.height>zn)&&(t.width>zn&&t.height>zn?t.width>t.height?(t.height*=zn/t.width,t.width=zn):(t.width*=zn/t.height,t.height=zn):t.width>zn?(t.height*=zn/t.width,t.width=zn):(t.width*=zn/t.height,t.height=zn))}function tf(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function PM(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function DM(t,e,n){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${e}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${e} ${n}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),i.appendChild(s),s.appendChild(t),PM(i)}const Sn=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||Sn(n,e)};function VM(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function OM(t,e){return p2(e).map(n=>{const r=t.getPropertyValue(n),i=t.getPropertyPriority(n);return`${n}: ${r}${i?" !important":""};`}).join(" ")}function LM(t,e,n,r){const i=`.${t}:${e}`,s=n.cssText?VM(n):OM(n,r);return document.createTextNode(`${i}{${s}}`)}function Bx(t,e,n,r){const i=window.getComputedStyle(t,n),s=i.getPropertyValue("content");if(s===""||s==="none")return;const o=AM();try{e.className=`${e.className} ${o}`}catch{return}const a=document.createElement("style");a.appendChild(LM(o,n,i,r)),e.appendChild(a)}function zM(t,e,n){Bx(t,e,":before",n),Bx(t,e,":after",n)}const qx="application/font-woff",Hx="image/jpeg",MM={woff:qx,woff2:qx,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:Hx,jpeg:Hx,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function jM(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function Xy(t){const e=jM(t).toLowerCase();return MM[e]||""}function FM(t){return t.split(/,/)[1]}function Qg(t){return t.search(/^(data:)/)!==-1}function $M(t,e){return`data:${e};base64,${t}`}async function g2(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const i=await r.blob();return new Promise((s,o)=>{const a=new FileReader;a.onerror=o,a.onloadend=()=>{try{s(n({res:r,result:a.result}))}catch(l){o(l)}},a.readAsDataURL(i)})}const mm={};function UM(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function Jy(t,e,n){const r=UM(t,e,n.includeQueryParams);if(mm[r]!=null)return mm[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let i;try{const s=await g2(t,n.fetchRequestInit,({res:o,result:a})=>(e||(e=o.headers.get("Content-Type")||""),FM(a)));i=$M(s,e)}catch(s){i=n.imagePlaceholder||"";let o=`Failed to fetch resource: ${t}`;s&&(o=typeof s=="string"?s:s.message),o&&console.warn(o)}return mm[r]=i,i}async function BM(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):tf(e)}async function qM(t,e){if(t.currentSrc){const s=document.createElement("canvas"),o=s.getContext("2d");s.width=t.clientWidth,s.height=t.clientHeight,o==null||o.drawImage(t,0,0,s.width,s.height);const a=s.toDataURL();return tf(a)}const n=t.poster,r=Xy(n),i=await Jy(n,r,e);return tf(i)}async function HM(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await Yf(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function KM(t,e){return Sn(t,HTMLCanvasElement)?BM(t):Sn(t,HTMLVideoElement)?qM(t,e):Sn(t,HTMLIFrameElement)?HM(t,e):t.cloneNode(y2(t))}const WM=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",y2=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function GM(t,e,n){var r,i;if(y2(e))return e;let s=[];return WM(t)&&t.assignedNodes?s=us(t.assignedNodes()):Sn(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?s=us(t.contentDocument.body.childNodes):s=us(((i=t.shadowRoot)!==null&&i!==void 0?i:t).childNodes),s.length===0||Sn(t,HTMLVideoElement)||await s.reduce((o,a)=>o.then(()=>Yf(a,n)).then(l=>{l&&e.appendChild(l)}),Promise.resolve()),e}function QM(t,e,n){const r=e.style;if(!r)return;const i=window.getComputedStyle(t);i.cssText?(r.cssText=i.cssText,r.transformOrigin=i.transformOrigin):p2(n).forEach(s=>{let o=i.getPropertyValue(s);s==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),Sn(t,HTMLIFrameElement)&&s==="display"&&o==="inline"&&(o="block"),s==="d"&&e.getAttribute("d")&&(o=`path(${e.getAttribute("d")})`),r.setProperty(s,o,i.getPropertyPriority(s))})}function YM(t,e){Sn(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),Sn(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function XM(t,e){if(Sn(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(i=>t.value===i.getAttribute("value"));r&&r.setAttribute("selected","")}}function JM(t,e,n){return Sn(e,Element)&&(QM(t,e,n),zM(t,e,n),YM(t,e),XM(t,e)),e}async function ZM(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let s=0;s<n.length;s++){const a=n[s].getAttribute("xlink:href");if(a){const l=t.querySelector(a),c=document.querySelector(a);!l&&c&&!r[a]&&(r[a]=await Yf(c,e,!0))}}const i=Object.values(r);if(i.length){const s="http://www.w3.org/1999/xhtml",o=document.createElementNS(s,"svg");o.setAttribute("xmlns",s),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const a=document.createElementNS(s,"defs");o.appendChild(a);for(let l=0;l<i.length;l++)a.appendChild(i[l]);t.appendChild(o)}return t}async function Yf(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>KM(r,e)).then(r=>GM(t,r,e)).then(r=>JM(t,r,e)).then(r=>ZM(r,e))}const v2=/url\((['"]?)([^'"]+?)\1\)/g,e3=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,t3=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function n3(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function r3(t){const e=[];return t.replace(v2,(n,r,i)=>(e.push(i),n)),e.filter(n=>!Qg(n))}async function i3(t,e,n,r,i){try{const s=n?TM(e,n):e,o=Xy(e);let a;return i||(a=await Jy(s,o,r)),t.replace(n3(e),`$1${a}$3`)}catch{}return t}function s3(t,{preferredFontFormat:e}){return e?t.replace(t3,n=>{for(;;){const[r,,i]=e3.exec(n)||[];if(!i)return"";if(i===e)return`src: ${r};`}}):t}function w2(t){return t.search(v2)!==-1}async function _2(t,e,n){if(!w2(t))return t;const r=s3(t,n);return r3(r).reduce((s,o)=>s.then(a=>i3(a,o,e,n)),Promise.resolve(r))}async function na(t,e,n){var r;const i=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(i){const s=await _2(i,null,n);return e.style.setProperty(t,s,e.style.getPropertyPriority(t)),!0}return!1}async function o3(t,e){await na("background",t,e)||await na("background-image",t,e),await na("mask",t,e)||await na("-webkit-mask",t,e)||await na("mask-image",t,e)||await na("-webkit-mask-image",t,e)}async function a3(t,e){const n=Sn(t,HTMLImageElement);if(!(n&&!Qg(t.src))&&!(Sn(t,SVGImageElement)&&!Qg(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,i=await Jy(r,Xy(r),e);await new Promise((s,o)=>{t.onload=s,t.onerror=e.onImageErrorHandler?(...l)=>{try{s(e.onImageErrorHandler(...l))}catch(c){o(c)}}:o;const a=t;a.decode&&(a.decode=s),a.loading==="lazy"&&(a.loading="eager"),n?(t.srcset="",t.src=i):t.href.baseVal=i})}async function l3(t,e){const r=us(t.childNodes).map(i=>x2(i,e));await Promise.all(r).then(()=>t)}async function x2(t,e){Sn(t,Element)&&(await o3(t,e),await a3(t,e),await l3(t,e))}function c3(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(i=>{n[i]=r[i]}),t}const Kx={};async function Wx(t){let e=Kx[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},Kx[t]=e,e}async function Gx(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,s=(n.match(/url\([^)]+\)/g)||[]).map(async o=>{let a=o.replace(r,"$1");return a.startsWith("https://")||(a=new URL(a,t.url).href),g2(a,e.fetchRequestInit,({result:l})=>(n=n.replace(o,`url(${l})`),[o,l]))});return Promise.all(s).then(()=>n)}function Qx(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const l=i.exec(r);if(l===null)break;e.push(l[0])}r=r.replace(i,"");const s=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(o,"gi");for(;;){let l=s.exec(r);if(l===null){if(l=a.exec(r),l===null)break;s.lastIndex=a.lastIndex}else a.lastIndex=s.lastIndex;e.push(l[0])}return e}async function u3(t,e){const n=[],r=[];return t.forEach(i=>{if("cssRules"in i)try{us(i.cssRules||[]).forEach((s,o)=>{if(s.type===CSSRule.IMPORT_RULE){let a=o+1;const l=s.href,c=Wx(l).then(d=>Gx(d,e)).then(d=>Qx(d).forEach(h=>{try{i.insertRule(h,h.startsWith("@import")?a+=1:i.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:h,error:f})}})).catch(d=>{console.error("Error loading remote css",d.toString())});r.push(c)}})}catch(s){const o=t.find(a=>a.href==null)||document.styleSheets[0];i.href!=null&&r.push(Wx(i.href).then(a=>Gx(a,e)).then(a=>Qx(a).forEach(l=>{o.insertRule(l,o.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",s)}}),Promise.all(r).then(()=>(t.forEach(i=>{if("cssRules"in i)try{us(i.cssRules||[]).forEach(s=>{n.push(s)})}catch(s){console.error(`Error while reading CSS rules from ${i.href}`,s)}}),n))}function d3(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>w2(e.style.getPropertyValue("src")))}async function h3(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=us(t.ownerDocument.styleSheets),r=await u3(n,e);return d3(r)}function b2(t){return t.trim().replace(/["']/g,"")}function f3(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(s=>{e.add(b2(s))}),Array.from(r.children).forEach(s=>{s instanceof HTMLElement&&n(s)})}return n(t),e}async function p3(t,e){const n=await h3(t,e),r=f3(t);return(await Promise.all(n.filter(s=>r.has(b2(s.style.fontFamily))).map(s=>{const o=s.parentStyleSheet?s.parentStyleSheet.href:null;return _2(s.cssText,o,e)}))).join(`
`)}async function m3(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await p3(t,e);if(n){const r=document.createElement("style"),i=document.createTextNode(n);r.appendChild(i),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function g3(t,e={}){const{width:n,height:r}=m2(t,e),i=await Yf(t,e,!0);return await m3(i,e),await x2(i,e),c3(i,e),await DM(i,n,r)}async function y3(t,e={}){const{width:n,height:r}=m2(t,e),i=await g3(t,e),s=await tf(i),o=document.createElement("canvas"),a=o.getContext("2d"),l=e.pixelRatio||kM(),c=e.canvasWidth||n,d=e.canvasHeight||r;return o.width=c*l,o.height=d*l,e.skipAutoScale||NM(o),o.style.width=`${c}`,o.style.height=`${d}`,e.backgroundColor&&(a.fillStyle=e.backgroundColor,a.fillRect(0,0,o.width,o.height)),a.drawImage(s,0,0,o.width,o.height),o}async function Yx(t,e={}){return(await y3(t,e)).toDataURL()}const v3=({reactFlowWrapper:t,reactFlowInstance:e,boards:n,currentBoardId:r,bgType:i,isDarkMode:s,setNodes:o})=>{const[a,l]=D.useState(!1),c=D.useCallback(async()=>{if(t.current===null||!e||!o)return;l(!0),await new Promise(L=>setTimeout(L,100));const{x:d,y:h,zoom:f}=e.getViewport(),m=e.getNodes(),v=m.filter(L=>L.selected),w=v.map(L=>L.id);w.length>0&&(o(L=>L.map($=>({...$,selected:!1}))),await new Promise(L=>setTimeout(L,50)));const T=v.length>0?v:m;if(T.length===0){l(!1),w.length>0&&o(L=>L.map($=>({...$,selected:w.includes($.id)})));return}const y=Pu(T),_=100,S=y.width+_*2,C=y.height+_*2,O=-y.x+_,z=-y.y+_;e.setViewport({x:O,y:z,zoom:1}),await new Promise(L=>setTimeout(L,1e3)),document.fonts&&await document.fonts.ready;const E=t.current.querySelector(".react-flow");if(!E){l(!1),w.length>0&&o(L=>L.map($=>({...$,selected:w.includes($.id)})));return}const b=n.find(L=>L.id===r),k=(b?b.name:"Tablero sin nombre").toUpperCase(),N=Math.max(16,Math.min(72,S*.04)),R=N*.5;let P={};i==="cork"?P={backgroundColor:s?"#18181b":"#e5e5e5",backgroundImage:s?"radial-gradient(rgba(255,255,255,0.05) 1px, transparent 1px), radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px)":"radial-gradient(#999 1px, transparent 1px), radial-gradient(#999 1px, transparent 1px)",backgroundSize:"40px 40px",backgroundPosition:"0 0, 20px 20px"}:i==="blackboard"?P={backgroundColor:s?"#27272a":"#ffffff",backgroundImage:s?"linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px)":"radial-gradient(#e5e7eb 2px, transparent 2px)",backgroundSize:s?"100px 100px":"30px 30px"}:P={backgroundColor:s?"#1e293b":"#f0f9ff",backgroundImage:s?"linear-gradient(#334155 1px, transparent 1px), linear-gradient(90deg, #334155 1px, transparent 1px)":"linear-gradient(#cbd5e1 1px, transparent 1px), linear-gradient(90deg, #cbd5e1 1px, transparent 1px)",backgroundSize:"20px 20px"};const F={pixelRatio:2,skipAutoScale:!0,backgroundColor:P.backgroundColor,width:S,height:C,style:{width:`${S}px`,height:`${C}px`,overflow:"visible",fontFamily:"'Courier Prime', monospace",...P},imagePlaceholder:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",filter:L=>!(L.classList&&(L.classList.contains("react-flow__controls")||L.classList.contains("react-flow__minimap")||L.classList.contains("react-flow__attribution")))};try{let L;try{L=await Yx(E,{...F,useCORS:!0})}catch(ae){console.warn("Error exportando con CORS, reintentando sin CORS...",ae),await new Promise(pe=>setTimeout(pe,1e3)),L=await Yx(E,{...F,useCORS:!1})}const $=document.createElement("canvas"),j=F.pixelRatio||1;$.width=S*j,$.height=C*j;const M=$.getContext("2d"),B=new Image;await new Promise((ae,pe)=>{B.onload=ae,B.onerror=pe,B.src=L}),M.drawImage(B,0,0);const K=N*j;M.font=`bold ${K}px "Courier Prime", monospace`,M.fillStyle=s?"rgba(255, 255, 255, 0.4)":"rgba(0, 0, 0, 0.4)",M.shadowColor=s?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.2)",M.shadowBlur=3*j,M.shadowOffsetX=1*j,M.shadowOffsetY=1*j,M.textAlign="right",M.textBaseline="bottom";const U=R*j;M.fillText(k,$.width-U,$.height-U),L=$.toDataURL("image/png");const X=document.createElement("a"),J=n.find(ae=>ae.id===r),te=J?J.name.replace(/[^a-z0-9\u00C0-\u017F\s-_]/gi,""):"caso-detective";X.download=`${te}.png`,X.href=L,X.click()}catch(L){console.error("Error al exportar",L),alert("Error al generar la imagen. Si utilizas imgenes externas (URL), es posible que tengan restricciones de seguridad (CORS).")}finally{e.setViewport({x:d,y:h,zoom:f}),w.length>0&&o(L=>L.map($=>({...$,selected:w.includes($.id)}))),l(!1)}},[t,s,e,n,r,i,o]);return{isExporting:a,onExport:c}},w3="default-case",gm=(t,e=[])=>{let n=localStorage.getItem(`board-${t}-nodes`),r=localStorage.getItem(`board-${t}-edges`),i=localStorage.getItem(`board-${t}-bg`);return!n&&t===w3&&(n=localStorage.getItem("detective-board-nodes"),r=localStorage.getItem("detective-board-edges")),{nodes:n?JSON.parse(n):e,edges:r?JSON.parse(r):[],bgType:i||"cork"}},Dd="default-case",_3=({nodes:t,edges:e,bgType:n,setNodes:r,setEdges:i,setBgType:s,reactFlowInstance:o,clearHistory:a,setCaseManagerOpen:l,setConfirmModal:c,lastSaved:d})=>{const[h,f]=D.useState(()=>{try{const b=localStorage.getItem("detective-boards-list");return b?JSON.parse(b):localStorage.getItem("detective-board-nodes")?[{id:Dd,name:"Caso #001: Principal",createdAt:Date.now(),lastModified:Date.now()}]:[{id:Dd,name:"Caso #001: Nuevo",createdAt:Date.now(),lastModified:Date.now()}]}catch{return[{id:Dd,name:"Caso #001: Nuevo",createdAt:Date.now(),lastModified:Date.now()}]}}),[m,v]=D.useState(()=>{try{const b=localStorage.getItem("detective-boards-trash");return b?JSON.parse(b):[]}catch{return[]}}),[w,T]=D.useState(()=>localStorage.getItem("detective-current-board-id")||Dd);D.useEffect(()=>{localStorage.setItem("detective-boards-list",JSON.stringify(h))},[h]),D.useEffect(()=>{localStorage.setItem("detective-boards-trash",JSON.stringify(m))},[m]),D.useEffect(()=>{localStorage.setItem("detective-current-board-id",w)},[w]),D.useEffect(()=>{d&&f(b=>b.map(I=>I.id===w?{...I,lastModified:d.getTime()}:I))},[d,w]),D.useEffect(()=>{const b=h.find(I=>I.id===w);b&&(document.title=`${b.name} | Detective Board`)},[w,h]);const y=D.useCallback(b=>{localStorage.setItem(`board-${w}-nodes`,JSON.stringify(t)),localStorage.setItem(`board-${w}-edges`,JSON.stringify(e)),localStorage.setItem(`board-${w}-bg`,n);const I=gm(b);r(I.nodes),i(I.edges),s(I.bgType),T(b),a(),l(!1),o&&setTimeout(()=>{o.fitView({duration:800,padding:.2})},100)},[w,t,e,n,r,i,s,a,o,l]),_=b=>{if(!b)return;const I=Fn(),k={id:I,name:b,createdAt:Date.now(),lastModified:Date.now()};f(N=>[...N,k]),y(I)},S=b=>{h.length<=1||c({isOpen:!0,title:"MOVER A PAPELERA?",message:"El caso se mover a la papelera. Podrs restaurarlo si lo necesitas.",isDanger:!0,confirmText:"Mover",onConfirm:()=>{f(I=>I.map(k=>k.id===b?{...k,isDeleting:!0}:k)),setTimeout(()=>{const I=h.find(N=>N.id===b),k=h.filter(N=>N.id!==b);if(I){const{isDeleting:N,...R}=I;v(P=>[{...R,deletedAt:Date.now()},...P])}if(f(k),w===b){const N=k[0].id,R=gm(N);r(R.nodes),i(R.edges),s(R.bgType),T(N),a(),o&&setTimeout(()=>{o.fitView({duration:800,padding:.2})},100)}},500)}})},C=D.useCallback(b=>{const I=m.find(k=>k.id===b);I&&(v(k=>k.filter(N=>N.id!==b)),f(k=>[...k,{...I,isDeleting:!1}]))},[m]),O=D.useCallback(b=>{c({isOpen:!0,title:"ELIMINAR DEFINITIVAMENTE?",message:"Esta accin es irreversible. Los datos del caso se borrarn del disco para siempre.",isDanger:!0,confirmText:"Eliminar",onConfirm:()=>{v(I=>I.filter(k=>k.id!==b)),localStorage.removeItem(`board-${b}-nodes`),localStorage.removeItem(`board-${b}-edges`),localStorage.removeItem(`board-${b}-bg`)}})},[]),z=(b,I)=>{f(k=>k.map(N=>N.id===b?{...N,name:I}:N))},A=D.useCallback(b=>{f(b)},[]),E=D.useCallback(b=>{const I=h.find(k=>k.id===b);I&&c({isOpen:!0,title:"CLONAR CASO?",message:`Deseas crear una copia del expediente "${I.name}"?`,confirmText:"Clonar",onConfirm:()=>{let k,N,R;if(b===w)k=t,N=e,R=n;else{const L=gm(b);k=L.nodes,N=L.edges,R=L.bgType}const P=Fn(),F={id:P,name:`${I.name} (Copia)`,createdAt:Date.now(),lastModified:Date.now()};localStorage.setItem(`board-${P}-nodes`,JSON.stringify(k)),localStorage.setItem(`board-${P}-edges`,JSON.stringify(N)),localStorage.setItem(`board-${P}-bg`,R),f(L=>{const $=L.findIndex(M=>M.id===b),j=[...L];return j.splice($+1,0,F),j}),y(P)}})},[h,y,w,t,e,n,c]);return D.useEffect(()=>{h.length>0&&!h.find(b=>b.id===w)&&y(h[0].id)},[h,w,y]),{boards:h,setBoards:f,trash:m,currentBoardId:w,setCurrentBoardId:T,handleSwitchBoard:y,handleCreateBoard:_,handleDeleteBoard:S,handleRestoreBoard:C,handlePermanentDelete:O,handleRenameBoard:z,handleReorderBoards:A,handleCloneBoard:E}},x3=({onSave:t,undo:e,redo:n,duplicateSelected:r,navigateSearch:i,reactFlowInstance:s,edges:o,setEdges:a,takeSnapshot:l,connectionLineType:c,connectionColor:d})=>{D.useEffect(()=>{const h=f=>{if((f.ctrlKey||f.metaKey)&&f.key==="s"&&(f.preventDefault(),t()),(f.ctrlKey||f.metaKey)&&f.key==="z"&&(f.preventDefault(),f.shiftKey?n():e()),(f.ctrlKey||f.metaKey)&&f.key==="y"&&(f.preventDefault(),n()),(f.ctrlKey||f.metaKey)&&f.key==="d"&&(f.preventDefault(),r()),f.key==="F3"&&(f.preventDefault(),f.shiftKey?i("prev"):i("next")),f.shiftKey&&f.key.toLowerCase()==="c"){if(f.preventDefault(),!s)return;const m=s.getNodes().filter(v=>v.selected);if(m.length>=2){m.sort((w,T)=>w.position.x-T.position.x);const v=[];for(let w=0;w<m.length-1;w++){const T=m[w],y=m[w+1];o.some(S=>S.source===T.id&&S.target===y.id||S.source===y.id&&S.target===T.id)||v.push({id:Fn(),source:T.id,target:y.id,type:c,style:{stroke:d,strokeWidth:2},className:"quick-draw"})}v.length>0&&(l(),a(w=>w.concat(v)))}}};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,e,n,r,i,o,c,d,s,a,l])},b3=({isInteractive:t,reactFlowInstance:e,setNodes:n,takeSnapshot:r,setPendingStampNodeId:i,setInputModalOpen:s,setEditingEdge:o,setEditingNode:a})=>{const l=D.useCallback(d=>{if(d.preventDefault(),!t){d.dataTransfer.dropEffect="none";return}d.dataTransfer.dropEffect="move"},[t]),c=D.useCallback(d=>{if(d.preventDefault(),!t)return;if(d.dataTransfer.files&&d.dataTransfer.files.length>0){const T=d.dataTransfer.files[0];Yy(T,(y,_,S)=>{const C=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),O={id:Fn(),type:"image",position:C,data:{label:"Imagen",image:y},style:{width:_,height:S}};r(),n(z=>z.concat(O))});return}const h=d.dataTransfer.getData("text/uri-list")||d.dataTransfer.getData("text/plain");if(h&&(h.startsWith("data:image")||h.startsWith("http"))){const T=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:Fn(),type:"image",position:T,data:{label:"Imagen Extrada",image:h},style:{width:300,height:300}};r(),n(_=>_.concat(y));return}const f=d.dataTransfer.getData("application/reactflow"),m=d.dataTransfer.getData("application/category");if(typeof f>"u"||!f)return;if(f==="stamp"){const T=d.dataTransfer.getData("application/category"),y=T==="custom",_=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),C=e.getIntersectingNodes({x:_.x,y:_.y,width:1,height:1}).slice().reverse().find(O=>O.type==="evidence"||O.type==="note"||O.type==="image");if(C){if(y){i(C.id),s(!0),o(null),a(null);return}r(),n(O=>O.map(z=>z.id===C.id?{...z,data:{...z.data,status:T}}:z))}return}if(f==="zone"){const T=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:Fn(),type:"zone",position:T,data:{label:"ZONA SEGURA"},style:{width:300,height:300,backgroundColor:"rgba(113, 113, 122, 0.05)",borderColor:"#71717a"}};r(),n(_=>[y,..._]);return}if(f==="url"){const T=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:Fn(),type:"url",position:T,data:{url:"",label:"Nuevo Enlace"},style:{width:300,height:250}};r(),n(_=>_.concat(y));return}const v=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),w={id:Fn(),type:f,position:v,data:{label:`Nuevo ${m}`,category:m,description:"Doble click para editar..."}};r(),n(T=>T.concat(w))},[e,n,t,r,i,s,o,a]);return{onDragOver:l,onDrop:c}},Zy=({status:t})=>{if(typeof t=="object"&&t.type==="custom")return p.jsx("div",{className:"border-4 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif",borderColor:t.color,color:t.color,backgroundColor:`${t.color}30`},children:t.label});switch(t){case"solved":return p.jsx("div",{className:"border-4 border-green-600 text-green-600 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-green-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"RESUELTO"});case"discarded":return p.jsx("div",{className:"border-4 border-red-600 text-red-600 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-red-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"DESCARTADO"});case"key":return p.jsx("div",{className:"border-4 border-yellow-500 text-yellow-500 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-yellow-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"CLAVE"});case"question":return p.jsx("div",{className:"border-4 border-blue-500 text-blue-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-blue-950/30",children:p.jsx(Wg,{size:40,strokeWidth:3})});case"important":return p.jsx("div",{className:"border-4 border-orange-500 text-orange-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-orange-950/30",children:p.jsx(h2,{size:40,strokeWidth:3})});case"verify":return p.jsx("div",{className:"border-4 border-purple-500 text-purple-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-purple-950/30",children:p.jsx(i2,{size:40,strokeWidth:3})});case"danger":return p.jsx("div",{className:"border-4 border-red-600 text-red-600 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-red-950/30",children:p.jsx(c2,{size:40,strokeWidth:3})});case"confidential":return p.jsx("div",{className:"border-4 border-zinc-500 text-zinc-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-zinc-950/30",children:p.jsx(Ya,{size:40,strokeWidth:3})});default:return null}},Xx={person:{color:"border-blue-500",icon:Qy,dark:{bg:"bg-gradient-to-br from-blue-900 to-blue-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-blue-50 to-blue-100",text:"text-blue-900/70",title:"text-blue-950",border:"border-black/10"}},place:{color:"border-green-500",icon:s2,dark:{bg:"bg-gradient-to-br from-green-900 to-green-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-green-50 to-green-100",text:"text-green-900/70",title:"text-green-950",border:"border-black/10"}},clue:{color:"border-orange-500",icon:qy,dark:{bg:"bg-gradient-to-br from-orange-900 to-orange-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-orange-50 to-orange-100",text:"text-orange-900/70",title:"text-orange-950",border:"border-black/10"}},event:{color:"border-red-500",icon:t2,dark:{bg:"bg-gradient-to-br from-red-900 to-red-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-red-50 to-red-100",text:"text-red-900/70",title:"text-red-950",border:"border-black/10"}}},E3=({id:t,data:e,selected:n,isDarkMode:r})=>{const i=Xx[e.category]||Xx.clue,s=r?i.dark:i.light,o=i.icon,{setNodes:a}=Yr(),l=!!e.locked,[c,d]=D.useState(!1),h=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]),f=m=>{m.stopPropagation(),a(v=>v.map(w=>{if(w.id===t){const T=!!w.data.locked;return{...w,draggable:!0,data:{...w.data,locked:!T}}}return w}))};return p.jsxs("div",{className:`
        relative h-full w-full shadow-[0_10px_20px_-5px_rgba(0,0,0,0.6)] rounded-sm border-l-4 transition-all duration-300 ease-out group
        ${i.color} ${s.bg}
        ${n?"ring-2 ring-white scale-105 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.9)] z-50":"hover:scale-105 hover:-translate-y-1 hover:shadow-[0_20px_40px_-5px_rgba(0,0,0,0.8)] hover:z-40"}
        ${l?"nodrag":""} ${e.isDeleting?"deleting-default":""}
      `,children:[p.jsx(yl,{color:"#ef4444",isVisible:n&&!l,minWidth:250,minHeight:150,handleStyle:{width:15,height:15}}),(n||l)&&p.jsx("button",{onClick:f,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${l?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:l?p.jsx(wl,{size:12}):p.jsx(vl,{size:12})}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(kn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(kn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${h}deg)`},children:p.jsx(Zy,{status:e.status},JSON.stringify(e.status))}),p.jsxs("div",{className:"p-3 flex flex-col gap-2 h-full w-full overflow-hidden",children:[p.jsxs("div",{className:`flex items-center justify-between border-b ${s.border} pb-2`,children:[p.jsx("span",{className:`text-xs uppercase tracking-widest ${s.text} font-bold`,children:e.category}),p.jsx(o,{size:16,className:s.text})]}),e.image&&p.jsx("div",{className:`nodrag w-full h-32 overflow-hidden rounded-sm border ${s.border} sepia-[.5] cursor-zoom-in hover:sepia-0 transition-all`,onClick:m=>{m.stopPropagation(),d(!0)},children:p.jsx("img",{src:e.image,alt:"evidence",className:"w-full h-full object-cover"})}),c&&nu.createPortal(p.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-8 cursor-zoom-out backdrop-blur-sm animate-in fade-in duration-200",onClick:m=>{m.stopPropagation(),d(!1)},children:p.jsx("img",{src:e.image,alt:"Evidence HD",className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm"})}),document.body),p.jsxs("div",{children:[p.jsx("h3",{className:`text-lg font-bold ${s.title} leading-tight font-mono`,children:e.label}),p.jsx("p",{className:`text-xs ${s.text} mt-1 font-mono leading-relaxed`,children:e.description})]})]})]})},I3=D.memo(E3),ym={yellow:{bg:"from-yellow-100 to-yellow-300",btn:"bg-yellow-500"},green:{bg:"from-green-100 to-green-300",btn:"bg-green-500"},blue:{bg:"from-blue-100 to-blue-300",btn:"bg-blue-500"},red:{bg:"from-red-100 to-red-300",btn:"bg-red-500"},purple:{bg:"from-purple-100 to-purple-300",btn:"bg-purple-500"}},S3=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Yr(),o=!!e.locked,a=ym[e.color]||ym.yellow,l=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]),c=f=>{f.stopPropagation(),s(m=>m.map(v=>{if(v.id===t){const w=!!v.data.locked;return{...v,draggable:!0,data:{...v.data,locked:!w}}}return v}))},d=f=>{s(m=>m.map(v=>v.id===t?{...v,data:{...v.data,color:f}}:v))},h=()=>{s(f=>f.map(m=>m.id===t?{...m,data:{...m.data,status:null}}:m))};return p.jsxs(p.Fragment,{children:[p.jsx(yl,{color:"#eab308",isVisible:n&&!o,minWidth:150,minHeight:150,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{i({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(Is,{size:12})}),(n||o)&&p.jsx("button",{onClick:c,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${o?"bg-red-900 border-red-700 text-red-200":"bg-yellow-500 border-yellow-700 text-white hover:bg-yellow-600"}`,children:o?p.jsx(wl,{size:12}):p.jsx(vl,{size:12})}),n&&!o&&p.jsxs("div",{className:`nodrag absolute -bottom-8 left-1/2 transform -translate-x-1/2 flex gap-1 p-1.5 rounded-full shadow-xl border z-50 backdrop-blur-sm ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[Object.entries(ym).map(([f,m])=>p.jsx("button",{onClick:()=>d(f),className:`w-4 h-4 rounded-full ${m.btn} border border-white/20 hover:scale-125 transition-transform`},f)),e.status&&p.jsx("button",{onClick:h,className:`w-4 h-4 rounded-full flex items-center justify-center border border-white/20 hover:scale-125 transition-transform ml-1 ${r?"bg-zinc-700 text-zinc-400 hover:text-white":"bg-gray-200 text-gray-500 hover:text-black"}`,title:"Quitar Sello",children:p.jsx(By,{size:10})})]}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(kn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(kn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${l}deg)`},children:p.jsx(Zy,{status:e.status},JSON.stringify(e.status))}),p.jsxs("div",{className:`relative h-full w-full bg-gradient-to-br ${a.bg} shadow-[5px_5px_15px_rgba(0,0,0,0.5)] rotate-1 p-4 note-rough border-t border-l border-white/50 flex flex-col transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-1 hover:shadow-[10px_15px_25px_rgba(0,0,0,0.6)] overflow-hidden ${o?"nodrag":""} ${e.isDeleting?"deleting-note":""}`,children:[p.jsx("div",{className:"absolute inset-0 paper-texture pointer-events-none opacity-50 mix-blend-multiply"}),p.jsx("textarea",{name:"note-content",className:"nodrag relative z-10 w-full h-full bg-transparent resize-none outline-none text-gray-800 placeholder-yellow-600/50 text-lg leading-relaxed",placeholder:"Escribe una nota...",defaultValue:e.label,onChange:f=>e.label=f.target.value,style:{fontFamily:'"Comic Sans MS", "Chalkboard SE", sans-serif'}})]})]})},T3=D.memo(S3),A3=({isOpen:t,onClose:e,imageSrc:n,onCropComplete:r})=>{const[i,s]=D.useState(1),[o,a]=D.useState({x:0,y:0}),[l,c]=D.useState(!1),[d,h]=D.useState({x:0,y:0}),f=D.useRef(null),m=D.useRef(null);if(D.useEffect(()=>{t&&(s(1),a({x:0,y:0}))},[t,n]),!t||!n)return null;const v=_=>{c(!0),h({x:_.clientX-o.x,y:_.clientY-o.y})},w=_=>{l&&a({x:_.clientX-d.x,y:_.clientY-d.y})},T=()=>{c(!1)},y=()=>{const _=document.createElement("canvas"),S=_.getContext("2d"),C=m.current,O=f.current,z=C.clientWidth,A=C.clientHeight;_.width=z,_.height=A;const E=z/2,b=A/2;S.translate(E+o.x,b+o.y),S.scale(i,i),S.drawImage(O,-O.naturalWidth/2,-O.naturalHeight/2),r(_.toDataURL("image/jpeg",.9)),e()};return p.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center p-4 animate-in fade-in duration-200 select-none",onMouseUp:T,onMouseLeave:T,children:[p.jsxs("div",{className:"w-full max-w-lg flex justify-between items-center mb-4",children:[p.jsxs("h2",{className:"text-zinc-100 font-mono font-bold text-lg flex items-center gap-2",children:[p.jsx(Yz,{size:18})," AJUSTAR RECORTE"]}),p.jsx("button",{onClick:e,className:"text-zinc-400 hover:text-white",children:p.jsx(Is,{})})]}),p.jsxs("div",{ref:m,className:"relative w-[400px] h-[400px] bg-zinc-900 overflow-hidden border-2 border-dashed border-zinc-500 cursor-move shadow-2xl rounded-sm",onMouseDown:v,onMouseMove:w,children:[p.jsx("img",{ref:f,src:n,alt:"Crop target",className:"absolute max-w-none origin-center pointer-events-none",style:{left:"50%",top:"50%",transform:`translate(-50%, -50%) translate(${o.x}px, ${o.y}px) scale(${i})`}}),p.jsxs("div",{className:"absolute inset-0 pointer-events-none opacity-30",children:[p.jsx("div",{className:"w-full h-1/3 border-b border-white/50 absolute top-0"}),p.jsx("div",{className:"w-full h-1/3 border-b border-white/50 absolute top-1/3"}),p.jsx("div",{className:"h-full w-1/3 border-r border-white/50 absolute left-0"}),p.jsx("div",{className:"h-full w-1/3 border-r border-white/50 absolute left-1/3"})]})]}),p.jsxs("div",{className:"mt-6 flex items-center gap-4 w-full max-w-md bg-zinc-900 p-4 rounded-lg border border-zinc-800",children:[p.jsx(hM,{size:20,className:"text-zinc-400"}),p.jsx("input",{type:"range",name:"crop-scale",min:"0.1",max:"3",step:"0.05",value:i,onChange:_=>s(parseFloat(_.target.value)),className:"w-full accent-red-600 h-1 bg-zinc-700 rounded-lg appearance-none cursor-pointer"}),p.jsx(dM,{size:20,className:"text-zinc-400"})]}),p.jsxs("div",{className:"mt-6 flex gap-4",children:[p.jsx("button",{onClick:e,className:"px-6 py-2 border border-zinc-600 text-zinc-300 hover:text-white rounded font-bold uppercase text-xs tracking-wider transition-colors",children:"Cancelar"}),p.jsxs("button",{onClick:y,className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold uppercase text-xs tracking-wider shadow-lg flex items-center gap-2 transition-colors",children:[p.jsx(n2,{size:16})," Aplicar"]})]})]})},C3=({id:t,data:e,selected:n,isDarkMode:r})=>{const[i,s]=D.useState(e.image),[o,a]=D.useState(!1),[l,c]=D.useState(!1),[d,h]=D.useState(!1),[f,m]=D.useState(e.filters||{brightness:100,contrast:100,grayscale:0,sepia:0}),{deleteElements:v,setNodes:w,getNode:T}=Yr(),y=!!e.locked,_=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]);D.useEffect(()=>{e.filters&&m(e.filters)},[e.filters]),D.useEffect(()=>{if(e.image&&e.image.startsWith("http")){const I=new Image;I.crossOrigin="Anonymous",I.src=e.image,I.onload=()=>{try{const k=document.createElement("canvas");k.width=I.width,k.height=I.height,k.getContext("2d").drawImage(I,0,0);const R=k.toDataURL("image/jpeg");R.length>100&&(s(R),w(P=>P.map(F=>F.id===t?{...F,data:{...F.data,image:R}}:F)))}catch{}}}},[]);const S=I=>{I.stopPropagation(),w(k=>k.map(N=>{if(N.id===t){const R=!!N.data.locked;return{...N,draggable:!0,data:{...N.data,locked:!R}}}return N}))},C=I=>{const k=I.target.files[0];k&&Yy(k,(N,R,P)=>{s(N),w(F=>F.map(L=>L.id===t?{...L,data:{...L.data,image:N},style:{...L.style,width:R,height:P}}:L))})},O=I=>{if(!i)return;const k=new Image;k.src=i,k.onload=()=>{var j,M;const N=document.createElement("canvas");N.width=k.height,N.height=k.width;const R=N.getContext("2d");R.translate(N.width/2,N.height/2),R.rotate(I==="right"?90*Math.PI/180:-90*Math.PI/180),R.drawImage(k,-k.width/2,-k.height/2);const P=N.toDataURL();s(P);const F=T(t),L=(j=F==null?void 0:F.style)==null?void 0:j.width,$=(M=F==null?void 0:F.style)==null?void 0:M.height;w(B=>B.map(K=>K.id===t?{...K,data:{...K.data,image:P},style:{...K.style,width:$,height:L}}:K))}},z=()=>{c(!0)},A=I=>{s(I),w(k=>k.map(N=>N.id===t?{...N,data:{...N.data,image:I},style:{...N.style,width:300,height:300}}:N))},E=()=>{w(I=>I.map(k=>k.id===t?{...k,data:{...k.data,status:null}}:k))},b=(I,k)=>{const N={...f,[I]:k};m(N),w(R=>R.map(P=>P.id===t?{...P,data:{...P.data,filters:N}}:P))};return p.jsxs(p.Fragment,{children:[p.jsx(yl,{color:"#ef4444",isVisible:n&&!y,minWidth:100,minHeight:100,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{v({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(Is,{size:12})}),(n||y)&&p.jsx("button",{onClick:S,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${y?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:y?p.jsx(wl,{size:12}):p.jsx(vl,{size:12})}),n&&!y&&i&&p.jsxs("div",{className:`nodrag absolute -bottom-9 left-1/2 transform -translate-x-1/2 flex gap-1 p-1.5 rounded-full shadow-xl border z-50 backdrop-blur-sm items-center ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[p.jsx("button",{onClick:()=>h(!d),className:`p-1.5 rounded-full transition-colors ${d?"bg-blue-600 text-white":r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Filtros",children:p.jsx(oM,{size:14})}),p.jsx("div",{className:`w-px h-4 mx-0.5 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsx("button",{onClick:()=>O("left"),className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Rotar Izquierda",children:p.jsx(rM,{size:14})}),p.jsx("button",{onClick:z,className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Recortar",children:p.jsx(Lz,{size:14})}),p.jsx("button",{onClick:()=>O("right"),className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Rotar Derecha",children:p.jsx(iM,{size:14})}),e.status&&p.jsx("button",{onClick:E,className:`p-1.5 text-red-500 hover:text-red-400 rounded-full transition-colors ${r?"hover:bg-zinc-700":"hover:bg-gray-200"}`,title:"Quitar Sello",children:p.jsx(By,{size:14})})]}),d&&n&&!y&&p.jsxs("div",{className:`nodrag absolute -bottom-44 left-1/2 transform -translate-x-1/2 p-3 rounded-lg border z-50 w-48 backdrop-blur-sm flex flex-col gap-2 shadow-2xl animate-in fade-in slide-in-from-bottom-2 ${r?"bg-zinc-900/95 border-zinc-700":"bg-white/95 border-gray-200"}`,children:[p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Brillo"})," ",p.jsxs("span",{children:[f.brightness,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"200",value:f.brightness,onChange:I=>b("brightness",parseInt(I.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Contraste"})," ",p.jsxs("span",{children:[f.contrast,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"200",value:f.contrast,onChange:I=>b("contrast",parseInt(I.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"B/N"})," ",p.jsxs("span",{children:[f.grayscale,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"100",value:f.grayscale,onChange:I=>b("grayscale",parseInt(I.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Sepia"})," ",p.jsxs("span",{children:[f.sepia,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"100",value:f.sepia,onChange:I=>b("sepia",parseInt(I.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`})]}),p.jsx("div",{className:"tape-visual"}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(kn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(kn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${_}deg)`},children:p.jsx(Zy,{status:e.status},JSON.stringify(e.status))}),p.jsx("div",{className:`h-full w-full ${i?"bg-zinc-100 p-2 pb-10 rotate-1 hover:rotate-0":r?"bg-zinc-900/50 border-zinc-700 hover:border-zinc-500":"bg-gray-200/50 border-gray-400 hover:border-gray-500"} shadow-[0_10px_20px_-5px_rgba(0,0,0,0.7)] flex items-center justify-center overflow-hidden rounded-sm relative group transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-1 hover:shadow-[0_25px_50px_-12px_rgba(0,0,0,0.9)] ${y?"nodrag":""} ${e.isDeleting?"deleting-image":""} border-2 border-dashed`,children:i?p.jsxs("div",{className:"w-full h-full cursor-zoom-in",onClick:I=>{I.stopPropagation(),a(!0)},children:[p.jsx("img",{src:i,alt:"evidence",className:"w-full h-full object-cover border border-zinc-200",style:{filter:`brightness(${f.brightness}%) contrast(${f.contrast}%) grayscale(${f.grayscale}%) sepia(${f.sepia}%)`}}),p.jsx("div",{className:"absolute bottom-0 left-0 w-full h-10 flex items-center justify-center px-2",children:p.jsx("input",{type:"text",name:"image-caption",className:"nodrag w-full bg-transparent text-center text-zinc-800 text-xs outline-none placeholder-zinc-400/50 border-none p-0",placeholder:"",defaultValue:e.caption,onChange:I=>e.caption=I.target.value,onClick:I=>I.stopPropagation(),style:{fontFamily:'"Comic Sans MS", "Chalkboard SE", cursive'}})})]}):p.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full p-2 gap-1",children:[p.jsxs("label",{className:`nodrag cursor-pointer flex flex-col items-center gap-1 transition-colors ${r?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,children:[p.jsx(Hy,{size:24}),p.jsx("span",{className:"text-[10px] font-mono uppercase text-center",children:"Subir Local"}),p.jsx("input",{type:"file",name:"upload-image",className:"hidden",accept:"image/*",onChange:C})]}),p.jsx("div",{className:`text-[10px] font-mono ${r?"text-zinc-600":"text-zinc-400"}`,children:"- O -"}),p.jsx("input",{type:"text",name:"image-url",placeholder:"Pegar URL...",className:`nodrag w-full border text-[10px] p-1 rounded outline-none focus:border-purple-500 font-mono text-center ${r?"bg-zinc-950 border-zinc-700 text-zinc-300":"bg-white border-gray-300 text-zinc-700"}`,onKeyDown:I=>{if(I.key==="Enter"){const k=I.currentTarget.value;s(k),e.image=k;const N=new Image;N.crossOrigin="Anonymous",N.onload=()=>{try{const R=document.createElement("canvas");R.width=N.width,R.height=N.height,R.getContext("2d").drawImage(N,0,0);const F=R.toDataURL("image/jpeg");s(F),w(L=>L.map($=>$.id===t?{...$,data:{...$.data,image:F}}:$))}catch(R){console.warn("CORS blocked",R)}},N.src=k}}})]})}),o&&nu.createPortal(p.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-8 cursor-zoom-out backdrop-blur-sm animate-in fade-in duration-200",onClick:I=>{I.stopPropagation(),a(!1)},children:p.jsx("img",{src:i,alt:"Evidence HD",className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm",style:{filter:`brightness(${f.brightness}%) contrast(${f.contrast}%) grayscale(${f.grayscale}%) sepia(${f.sepia}%)`}})}),document.body),l&&nu.createPortal(p.jsx(A3,{isOpen:l,onClose:()=>c(!1),imageSrc:i,onCropComplete:A}),document.body)]})},R3=D.memo(C3),k3=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Yr(),o=!!e.locked,a=h=>{h.stopPropagation(),s(f=>f.map(m=>{if(m.id===t){const v=!!m.data.locked;return{...m,draggable:!0,data:{...m.data,locked:!v}}}return m}))},l=(h,f)=>{s(m=>m.map(v=>v.id===t?{...v,data:{...v.data,[h]:f}}:v))},c=["#e5e5e5","#18181b","#ef4444","#3b82f6","#22c55e","#eab308"],d=[{label:"S",val:"14px"},{label:"M",val:"24px"},{label:"L",val:"36px"},{label:"XL",val:"48px"}];return p.jsxs(p.Fragment,{children:[p.jsx(yl,{color:"#71717a",isVisible:n&&!o,minWidth:100,minHeight:30,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{i({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(Is,{size:12})}),(n||o)&&p.jsx("button",{onClick:a,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${o?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:o?p.jsx(wl,{size:12}):p.jsx(vl,{size:12})}),n&&!o&&p.jsxs("div",{className:`nodrag absolute -bottom-10 left-1/2 transform -translate-x-1/2 flex flex-col gap-1 p-1.5 rounded-lg shadow-xl border z-50 backdrop-blur-sm items-center ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[p.jsx("div",{className:"flex gap-1",children:c.map(h=>p.jsx("button",{onClick:()=>l("color",h),className:"w-4 h-4 rounded-full border border-white/20 hover:scale-125 transition-transform",style:{backgroundColor:h}},h))}),p.jsx("div",{className:`flex gap-1 border-t pt-1 mt-0.5 ${r?"border-white/10":"border-black/10"}`,children:d.map(h=>p.jsx("button",{onClick:()=>l("fontSize",h.val),className:`text-[8px] px-1 font-mono border rounded ${r?"text-zinc-300 hover:text-white border-zinc-700 bg-zinc-800 hover:bg-zinc-700":"text-zinc-600 hover:text-black border-gray-300 bg-gray-100 hover:bg-gray-200"}`,children:h.label},h.label))})]}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(kn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(kn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),p.jsx("div",{className:`h-full w-full p-2 flex items-center justify-center overflow-hidden border border-transparent hover:border-zinc-700/50 rounded transition-colors ${o?"nodrag":""} ${e.isDeleting?"deleting-default":""}`,children:p.jsx("textarea",{name:"text-content",className:`nodrag w-full h-full bg-transparent resize-none outline-none font-bold text-center p-2 ${e.color?"":"text-node-content text-gray-200"}`,placeholder:"Escribe un ttulo...",defaultValue:e.label,onChange:h=>e.label=h.target.value,style:{fontFamily:'"Courier Prime", monospace',color:e.color,fontSize:e.fontSize||"24px"}})})]})},N3=D.memo(k3),P3=({id:t,data:e,selected:n,style:r,isDarkMode:i})=>{const{setNodes:s}=Yr(),o=(r==null?void 0:r.borderColor)||"#71717a",a=(r==null?void 0:r.backgroundColor)||(i?"rgba(113, 113, 122, 0.05)":"rgba(100, 116, 139, 0.05)"),l=!!e.locked,c=d=>{d.stopPropagation(),s(h=>h.map(f=>{if(f.id===t){const m=!!f.data.locked;return{...f,draggable:m,data:{...f.data,locked:!m}}}return f}))};return p.jsxs(p.Fragment,{children:[p.jsx(yl,{color:o,isVisible:n&&!l,minWidth:150,minHeight:150}),(n||l)&&p.jsx("button",{onClick:c,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${l?"bg-red-900 border-red-700 text-red-200":i?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:l?p.jsx(wl,{size:12}):p.jsx(vl,{size:12})}),p.jsx("div",{className:`h-full w-full border-2 border-dashed rounded-xl transition-colors ${l?"nodrag":""} ${e.isDeleting?"deleting-zone":""}`,style:{borderColor:o,backgroundColor:a},children:p.jsx("div",{className:`absolute -top-3 left-4 px-2 py-0.5 rounded text-[10px] font-mono uppercase tracking-widest select-none whitespace-nowrap shadow-sm ${i?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-white border border-gray-300 text-gray-600"}`,children:e.label})})]})},D3=D.memo(P3),V3=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Yr(),[o,a]=D.useState(e.url||""),[l,c]=D.useState(!e.url),d=!!e.showIframe,[h,f]=D.useState(!1),[m,v]=D.useState(0),[w,T]=D.useState(null),[y,_]=D.useState(!0),[S,C]=D.useState(!1),O=!!e.locked,z=D.useMemo(()=>{if(!e.url)return"";try{const P=new URL(e.url);if(P.hostname.includes("youtube.com")||P.hostname.includes("youtu.be")){let L=null;if(P.hostname.includes("youtu.be"))L=P.pathname.slice(1);else if(P.searchParams.has("v"))L=P.searchParams.get("v");else if(P.pathname.startsWith("/embed/"))return e.url;if(L)return`https://www.youtube.com/embed/${L}?rel=0&modestbranding=1&iv_load_policy=3&controls=1&playsinline=1&loop=1&playlist=${L}`}}catch{}return e.url},[e.url]),A=e.url?`https://s.wordpress.com/mshots/v1/${encodeURIComponent(e.url)}?w=400&v=${m}`:null,E=A?`https://wsrv.nl/?url=${encodeURIComponent(A)}`:null;D.useEffect(()=>{if(T(null),!E)return;(F=>{const L=new Image;L.crossOrigin="Anonymous",L.referrerPolicy="no-referrer",L.src=F,L.onload=()=>{try{const $=document.createElement("canvas");$.width=L.width,$.height=L.height,$.getContext("2d").drawImage(L,0,0);const M=$.toDataURL("image/jpeg");T(M),_(!1)}catch{_(!1),C(!0)}},L.onerror=()=>{_(!1),C(!0)}})(E)},[E]);const b=P=>{P.stopPropagation(),s(F=>F.map(L=>{if(L.id===t){const $=!!L.data.locked;return{...L,draggable:$,data:{...L.data,locked:!$}}}return L}))},I=()=>{let P=o;P&&!P.startsWith("http")&&(P="https://"+P),s(F=>F.map(L=>L.id===t?{...L,data:{...L.data,url:P,showIframe:!1}}:L)),c(!1),f(!1),C(!1),_(!0)},k=()=>{c(!0),f(!1),C(!1),_(!0)},N=P=>{P.stopPropagation(),v(F=>F+1),f(!1),C(!1),_(!0)},R=()=>{const P=!d;f(!1),s(F=>F.map(L=>L.id===t?{...L,data:{...L.data,showIframe:P}}:L))};return p.jsxs(p.Fragment,{children:[p.jsx(yl,{color:"#3b82f6",isVisible:n&&!O,minWidth:200,minHeight:100}),n&&p.jsx("button",{onClick:()=>i({nodes:[{id:t}]}),className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(Is,{size:12})}),(n||O)&&p.jsx("button",{onClick:b,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${O?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:O?p.jsx(wl,{size:12}):p.jsx(vl,{size:12})}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(kn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(kn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),p.jsxs("div",{className:`relative w-full h-full rounded-lg overflow-hidden border-2 transition-all shadow-lg flex flex-col ${r?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} ${O?"nodrag":""} ${e.isDeleting?"deleting-default":""}`,children:[p.jsxs("div",{className:`h-8 flex items-center px-2 gap-2 border-b ${r?"bg-zinc-800 border-zinc-700":"bg-gray-100 border-gray-200"}`,children:[p.jsx(Bz,{size:14,className:"text-blue-500"}),p.jsx("span",{className:`text-[10px] font-mono truncate flex-1 ${r?"text-zinc-400":"text-gray-600"}`,children:e.url?new URL(e.url).hostname:"ENLACE WEB"}),!l&&p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:R,className:`text-zinc-500 transition-colors ${d?"text-blue-500":"hover:text-blue-500"}`,title:d?"Ver miniatura":"Ver interactivo",children:p.jsx(Qz,{size:12})}),p.jsx("button",{onClick:N,className:"text-zinc-500 hover:text-green-500 transition-colors",title:"Actualizar miniatura",children:p.jsx(Gy,{size:12})}),p.jsx("button",{onClick:k,className:"text-zinc-500 hover:text-blue-500 transition-colors",children:p.jsx(Zz,{size:12})})]})]}),p.jsx("div",{className:"flex-1 relative bg-black/5 group",children:l?p.jsxs("div",{className:"p-4 flex flex-col gap-2 h-full justify-center",children:[p.jsx("input",{type:"text",name:"url-input",value:o,onChange:P=>a(P.target.value),placeholder:"https://ejemplo.com",className:`nodrag w-full text-xs p-2 rounded border outline-none font-mono ${r?"bg-zinc-950 border-zinc-700 text-white":"bg-white border-gray-300 text-black"}`,onKeyDown:P=>P.key==="Enter"&&I()}),p.jsx("button",{onClick:I,className:"bg-blue-600 text-white text-xs py-1 rounded hover:bg-blue-500 font-bold uppercase",children:"Guardar"})]}):p.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[p.jsx("div",{className:"flex-1 relative overflow-hidden bg-zinc-200 dark:bg-zinc-800 min-h-0",children:d?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:`absolute top-0 left-0 w-full py-1 px-2 flex flex-col gap-1 items-center justify-center z-20 ${r?"bg-zinc-950/80":"bg-white/80"} backdrop-blur-[2px]`,children:p.jsx("span",{className:`text-[9px] leading-tight text-center select-none ${r?"text-zinc-400":"text-zinc-600"}`,children:"Si no carga, el sitio bloquea la conexin."})}),p.jsx("iframe",{src:z,className:"w-full h-full border-none relative z-10 bg-white",title:"Embedded Content",loading:"lazy",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation allow-modals allow-popups-to-escape-sandbox",onError:P=>{console.warn("Error loading iframe:",e.url),P.target.style.display="none"}},m)]}):p.jsxs(p.Fragment,{children:[y&&e.url&&p.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-4 text-center z-20",children:p.jsx("div",{className:"w-6 h-6 border-2 border-zinc-400 border-t-transparent rounded-full animate-spin"})}),w&&!S&&p.jsx("img",{src:w,alt:"Preview",className:"w-full h-full object-cover opacity-90 hover:opacity-100 transition-opacity"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(!e.url||S)&&p.jsx(Ky,{size:32,className:"text-zinc-400"})})]})}),p.jsxs("a",{href:e.url,target:"_blank",rel:"noopener",draggable:"false",onDragStart:P=>P.preventDefault(),className:`nodrag h-10 shrink-0 flex items-center justify-center gap-2 text-xs font-bold uppercase transition-colors z-10 relative ${r?"bg-zinc-800 hover:bg-zinc-700 text-blue-400":"bg-gray-200 hover:bg-gray-300 text-zinc-900"}`,children:[p.jsx(jz,{size:14})," Visitar Sitio"]})]})})]})]})},O3=D.memo(V3),Xf=({id:t,sourceX:e,sourceY:n,targetX:r,targetY:i,sourcePosition:s,targetPosition:o,style:a={},markerEnd:l,label:c,type:d,className:h})=>{let f="",m=0,v=0;const w={sourceX:e,sourceY:n,targetX:r,targetY:i,sourcePosition:s,targetPosition:o};return d==="straight"?[f,m,v]=uT(w):d==="step"?[f,m,v]=uu({...w,borderRadius:0}):d==="smoothstep"?[f,m,v]=uu(w):[f,m,v]=zy(w),p.jsxs(p.Fragment,{children:[p.jsx(gl,{path:f,markerEnd:l,style:a,className:h}),c&&p.jsx(HL,{children:p.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${m}px,${v}px)`,pointerEvents:"all"},className:"nodrag nopan",children:p.jsx("div",{className:"custom-edge-label",children:c})})})]})},L3=t=>p.jsx(Xf,{...t,type:"straight"}),z3=t=>p.jsx(Xf,{...t,type:"step"}),M3=t=>p.jsx(Xf,{...t,type:"smoothstep"}),j3=t=>p.jsx(Xf,{...t,type:"default"}),E2=D.createContext(!0),ra=t=>e=>{const n=D.useContext(E2);return D.createElement(t,{...e,isDarkMode:n})},F3={evidence:ra(I3),note:ra(T3),image:ra(R3),text:ra(N3),zone:ra(D3),url:ra(O3)},$3={default:j3,straight:L3,step:z3,smoothstep:M3},U3=({connectionColor:t})=>{const e=D.useMemo(()=>({hideAttribution:!0}),[]),n=D.useMemo(()=>({stroke:t,strokeWidth:2}),[t]),r=D.useCallback(i=>{switch(i.type){case"evidence":switch(i.data.category){case"person":return"#3b82f6";case"place":return"#22c55e";case"clue":return"#f97316";case"event":return"#ef4444";default:return"#ef4444"}case"note":return"#eab308";case"image":return"#a855f7";case"text":return"#71717a";default:return"#ef4444"}},[]);return{nodeTypes:F3,edgeTypes:$3,proOptions:e,connectionLineStyle:n,nodeColor:r}},B3=(t,e,n,r)=>{const[i,s]=D.useState([]),[o,a]=D.useState([]),l=D.useCallback(()=>{s(f=>[...f,{nodes:t,edges:e}]),a([])},[t,e]),c=D.useCallback(()=>{if(i.length===0)return;const f=i[i.length-1],m=i.slice(0,i.length-1);a(v=>[{nodes:t,edges:e},...v]),s(m),n(f.nodes),r(f.edges)},[i,t,e,n,r]),d=D.useCallback(()=>{if(o.length===0)return;const f=o[0],m=o.slice(1);s(v=>[...v,{nodes:t,edges:e}]),a(m),n(f.nodes),r(f.edges)},[o,t,e,n,r]),h=D.useCallback(()=>{s([]),a([])},[]);return{takeSnapshot:l,undo:c,redo:d,clearHistory:h,canUndo:i.length>0,canRedo:o.length>0}},q3=({nodes:t,edges:e,setNodes:n,setEdges:r,onNodesChange:i,onEdgesChange:s})=>{const{takeSnapshot:o,undo:a,redo:l,clearHistory:c}=B3(t,e,n,r),d=D.useCallback(v=>{n(w=>{var y;const T=w.find(_=>_.id===v);return!T||(y=T.data)!=null&&y.isDeleting?w:(setTimeout(()=>{n(_=>{var C;const S=_.find(O=>O.id===v);return S&&((C=S.data)!=null&&C.isDeleting)?_.filter(O=>O.id!==v):_}),r(_=>_.filter(S=>S.source!==v&&S.target!==v))},500),w.map(_=>_.id===v?{..._,data:{..._.data,isDeleting:!0}}:_))})},[n,r]),h=D.useCallback(v=>{r(w=>{var y;const T=w.find(_=>_.id===v);return!T||(y=T.className)!=null&&y.includes("deleting-edge")?w:(setTimeout(()=>{r(_=>_.filter(S=>S.id!==v))},300),w.map(_=>_.id===v?{..._,className:`${_.className||""} deleting-edge`}:_))})},[r]),f=D.useCallback(v=>{const w=v.filter(y=>y.type!=="remove"),T=v.filter(y=>y.type==="remove");T.length>0&&(o(),T.forEach(y=>d(y.id))),w.length>0&&i(w)},[i,o,d]),m=D.useCallback(v=>{const w=v.filter(y=>y.type!=="remove"),T=v.filter(y=>y.type==="remove");T.length>0&&(o(),T.forEach(y=>h(y.id))),w.length>0&&s(w)},[s,o,h]);return{takeSnapshot:o,undo:a,redo:l,clearHistory:c,onNodesChangeWithHistory:f,onEdgesChangeWithHistory:m,animateAndRemoveNode:d,animateAndRemoveEdge:h}},H3=(t,e,n,r,i)=>{const[s,o]=D.useState(null),a=D.useRef(null),l=D.useCallback(c=>{if(c.button!==2||!n||c.target.closest(".react-flow__node")||c.target.closest(".react-flow__edge")||c.target.closest(".react-flow__controls")||c.target.closest(".react-flow__minimap"))return;c.preventDefault();const{left:d,top:h}=t.current.getBoundingClientRect(),f=c.clientX-d,m=c.clientY-h;a.current={startX:f,startY:m,x:f,y:m,width:0,height:0,isDragging:!1};const v=T=>{if(T.buttons===0){w(T);return}if(!a.current||!t.current)return;const y=t.current.getBoundingClientRect(),_=T.clientX-y.left,S=T.clientY-y.top,C=Math.min(a.current.startX,_),O=Math.min(a.current.startY,S),z=Math.abs(_-a.current.startX),A=Math.abs(S-a.current.startY);(z>5||A>5)&&(a.current={...a.current,x:C,y:O,width:z,height:A,isDragging:!0},o({...a.current}))},w=T=>{var S;window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",w),window.removeEventListener("pointercancel",w);const y=(S=a.current)==null?void 0:S.isDragging,_=a.current;if(a.current=null,o(null),!y)r(T);else if(_&&e){const C=t.current.getBoundingClientRect(),O=e.screenToFlowPosition({x:C.left+_.x,y:C.top+_.y}),z=e.screenToFlowPosition({x:C.left+_.x+_.width,y:C.top+_.y+_.height}),A={x:Math.min(O.x,z.x),y:Math.min(O.y,z.y),width:Math.abs(z.x-O.x),height:Math.abs(z.y-O.y)},E=e.getNodes().filter(b=>{var P,F,L,$;const I=b.width??((P=b.measured)==null?void 0:P.width)??200,k=b.height??((F=b.measured)==null?void 0:F.height)??150,N=((L=b.positionAbsolute)==null?void 0:L.x)??b.position.x,R=(($=b.positionAbsolute)==null?void 0:$.y)??b.position.y;return A.x<N+I&&A.x+A.width>N&&A.y<R+k&&A.y+A.height>R});i(b=>b.map(I=>({...I,selected:E.some(k=>k.id===I.id)||T.shiftKey&&I.selected})))}};window.addEventListener("pointermove",v),window.addEventListener("pointerup",w),window.addEventListener("pointercancel",w)},[n,r,e,i,t]);return{selectionRect:s,handleRightPointerDown:l}},K3=({isInteractive:t,reactFlowInstance:e,reactFlowWrapper:n,setEdges:r,setNodes:i,connectionLineType:s,connectionColor:o,takeSnapshot:a,setEditingNode:l,setEditingEdge:c,setInputModalOpen:d,setEditModalOpen:h,setMenu:f})=>{const m=D.useCallback(E=>{a(),r(b=>hT({...E,type:s,style:{stroke:o,strokeWidth:2}},b))},[r,o,a,s]),v=D.useCallback((E,b)=>{E.preventDefault(),E.stopPropagation(),t&&(l(null),c(b),d(!0))},[t,l,c,d]),w=D.useCallback((E,b)=>{t&&(a(),r(I=>I.map(k=>{var N;if(k.id===b.id){const R=(N=k.style)==null?void 0:N.strokeDasharray;return{...k,style:{...k.style,strokeDasharray:R?void 0:"10,10"}}}return k})))},[r,t,a]),T=D.useCallback(()=>f(null),[f]),y=D.useCallback(E=>{if(E.preventDefault(),!t)return;const b=n.current.getBoundingClientRect();f({top:E.clientY<b.bottom-200?E.clientY-b.top:void 0,left:E.clientX<b.right-200?E.clientX-b.left:void 0,right:E.clientX>=b.right-200?b.width-(E.clientX-b.left):void 0,bottom:E.clientY>=b.bottom-200?b.height-(E.clientY-b.top):void 0,clientX:E.clientX,clientY:E.clientY})},[t,n,f]),{selectionRect:_,handleRightPointerDown:S}=H3(n,e,t,y,i),C=D.useCallback((E,b)=>{b.type==="evidence"?(l(b),h(!0)):b.type==="zone"&&(c(null),l(b),d(!0))},[l,h,c,d]),O=D.useCallback((E,b)=>{a(),b.type!=="zone"&&i(I=>{const k=I.findIndex(P=>P.id===b.id);if(k===I.length-1)return I;const N=[...I],[R]=N.splice(k,1);return N.push(R),N})},[a,i]),z=D.useCallback(()=>{n.current&&n.current.classList.add("is-moving")},[n]),A=D.useCallback(()=>{n.current&&n.current.classList.remove("is-moving")},[n]);return{onConnect:m,onEdgeContextMenu:v,onEdgeClick:w,onPaneClick:T,onPaneContextMenu:y,onNodeDoubleClick:C,onNodeDragStart:O,onMoveStart:z,onMoveEnd:A,selectionRect:_,handleRightPointerDown:S}},W3=({reactFlowInstance:t,boards:e,currentBoardId:n,bgType:r,setBoards:i,setNodes:s,setEdges:o,setBgType:a,handleSwitchBoard:l,clearHistory:c,takeSnapshot:d,setConfirmModal:h})=>{const f=D.useCallback(()=>{if(t){const T={...t.toObject(),bgType:r},y=new Blob([JSON.stringify(T,null,2)],{type:"application/json"}),_=URL.createObjectURL(y),S=document.createElement("a");S.href=_;const C=e.find(z=>z.id===n),O=C?C.name.replace(/[^a-z0-9\u00C0-\u017F\s-_]/gi,""):"caso-detective";S.download=`${O}.json`,S.click(),URL.revokeObjectURL(_)}},[t,e,n,r]),m=D.useCallback(w=>{const T=w.target.files[0];if(!T)return;const y=T.name.replace(/\.json$/i,""),_=new FileReader;_.onload=S=>{try{const C=JSON.parse(S.target.result);if(C&&(C.nodes||C.edges)){const O=C.nodes||[],z=C.edges||[],A=C.bgType||"cork",E=e.find(b=>b.name===y);if(E)h({isOpen:!0,title:"SOBRESCRIBIR CASO?",message:`Ya existe un caso llamado "${y}". Deseas sobrescribir sus datos con este archivo?`,confirmText:"Sobrescribir",cancelText:"Cancelar",isDanger:!0,onConfirm:()=>{localStorage.setItem(`board-${E.id}-nodes`,JSON.stringify(O)),localStorage.setItem(`board-${E.id}-edges`,JSON.stringify(z)),localStorage.setItem(`board-${E.id}-bg`,A),E.id===n?(s(O),o(z),a(A),c()):l(E.id)}});else{const b=Fn(),I={id:b,name:y,createdAt:Date.now(),lastModified:Date.now()};localStorage.setItem(`board-${b}-nodes`,JSON.stringify(O)),localStorage.setItem(`board-${b}-edges`,JSON.stringify(z)),localStorage.setItem(`board-${b}-bg`,A),i(k=>[...k,I]),l(b)}}}catch(C){console.error("Error al cargar el caso",C),alert("El archivo no es vlido.")}},_.readAsText(T),w.target.value=""},[e,n,s,o,a,l,i,h,c]),v=D.useCallback(()=>{h({isOpen:!0,title:"LIMPIAR TABLERO?",message:"Ests seguro de que quieres eliminar todo el contenido del tablero? Esta accin no se puede deshacer.",onConfirm:()=>{d(),s([]),o([])},isDanger:!0})},[d,s,o,h]);return{onSave:f,onLoad:m,onClear:v}},G3=({searchTerm:t,setNodes:e,reactFlowInstance:n})=>(D.useEffect(()=>{if(e(i=>i.map(s=>{var c,d;if(!t)return{...s,style:{...s.style,opacity:1}};const o=((c=s.data.label)==null?void 0:c.toLowerCase())||"",a=((d=s.data.description)==null?void 0:d.toLowerCase())||"",l=o.includes(t.toLowerCase())||a.includes(t.toLowerCase());return{...s,style:{...s.style,opacity:l?1:.1}}})),t&&t.length>1&&n){const s=n.getNodes().find(o=>{var c,d;const a=((c=o.data.label)==null?void 0:c.toLowerCase())||"",l=((d=o.data.description)==null?void 0:d.toLowerCase())||"";return a.includes(t.toLowerCase())||l.includes(t.toLowerCase())});s&&n.setCenter(s.position.x+(s.width||0)/2,s.position.y+(s.height||0)/2,{zoom:1.5,duration:800})}},[t,e,n]),{navigateSearch:D.useCallback(i=>{if(!t||!n)return;const o=n.getNodes().filter(f=>{var w,T;const m=((w=f.data.label)==null?void 0:w.toLowerCase())||"",v=((T=f.data.description)==null?void 0:T.toLowerCase())||"";return m.includes(t.toLowerCase())||v.includes(t.toLowerCase())});if(o.length===0)return;const a=o.findIndex(f=>f.selected);let l=i==="next"?a+1:a-1;l>=o.length&&(l=0),l<0&&(l=o.length-1);const c=o[l];e(f=>f.map(m=>({...m,selected:m.id===c.id})));const d=c.width||150,h=c.height||50;n.setCenter(c.position.x+d/2,c.position.y+h/2,{zoom:1.5,duration:600})},[t,n,e])}),Q3=t=>{const[e,n]=D.useState("#dc2626"),[r,i]=D.useState("straight"),[s,o]=D.useState(!0),[a,l]=D.useState(!0),[c,d]=D.useState(""),[h,f]=D.useState(!0),[m,v]=D.useState(!1),[w,T]=D.useState(t),y=D.useCallback(()=>{const _=["cork","blackboard","paper"];T(S=>_[(_.indexOf(S)+1)%_.length])},[]);return{connectionColor:e,setConnectionColor:n,connectionLineType:r,setConnectionLineType:i,isInteractive:s,setIsInteractive:o,isDarkMode:a,setIsDarkMode:l,searchTerm:c,setSearchTerm:d,isSidebarOpen:h,setIsSidebarOpen:f,isZenMode:m,setIsZenMode:v,bgType:w,setBgType:T,toggleBackground:y}},Y3=({reactFlowInstance:t,setNodes:e,setEdges:n,takeSnapshot:r,animateAndRemoveNode:i,animateAndRemoveEdge:s,setEditModalOpen:o,setEditingNode:a,setEditingEdge:l,setInputModalOpen:c,setConnectionColor:d,setConnectionLineType:h,setPendingStampNodeId:f})=>{const m=D.useCallback((O,z)=>{r(),e(A=>A.map(E=>E.id===O?{...E,data:z}:E))},[e,r]),v=D.useCallback(O=>{r(),i(O),o(!1),a(null)},[i,r,o,a]),w=D.useCallback(()=>{if(!t)return;const O=t.getNodes().filter(z=>z.selected);if(O.length>0){r();const z=new Map,A=O.map(I=>{const k=Fn();return z.set(I.id,k),{...I,id:k,position:{x:I.position.x+50,y:I.position.y+50},selected:!0,data:{...I.data}}}),b=t.getEdges().filter(I=>z.has(I.source)&&z.has(I.target)).map(I=>({...I,id:Fn(),source:z.get(I.source),target:z.get(I.target),selected:!0}));e(I=>I.map(k=>({...k,selected:!1})).concat(A)),n(I=>I.map(k=>({...k,selected:!1})).concat(b))}},[t,e,n,r]),T=D.useCallback(O=>{d(O),n(z=>z.map(A=>A.selected?{...A,style:{...A.style,stroke:O}}:A))},[n,d]),y=D.useCallback(O=>{h(O),n(z=>z.map(A=>A.selected?{...A,type:O}:A))},[n,h]),_=D.useCallback((O,z,A,E)=>{E&&(r(),n(b=>b.map(I=>I.id===E.id?{...I,label:O,type:A||I.type,style:{...I.style,stroke:z},labelStyle:void 0,labelBgStyle:void 0}:I)),l(null))},[n,r,l]),S=D.useCallback((O,z)=>{O?(r(),s(O.id),l(null),c(!1)):z&&z.type==="zone"&&(v(z.id),c(!1))},[s,v,r,l,c]),C=D.useCallback((O,z,A,E,b,I)=>{E?_(O,z,A,E):b&&b.type==="zone"?(r(),e(k=>k.map(N=>N.id===b.id?{...N,data:{...N.data,label:O},style:{...N.style,borderColor:z,backgroundColor:`${z}10`}}:N)),a(null),c(!1)):I&&(r(),e(k=>k.map(N=>N.id===I?{...N,data:{...N.data,status:{type:"custom",label:O||"SELLO",color:z}}}:N)),f(null),c(!1))},[_,e,r,a,c,f]);return{handleSaveNode:m,handleDeleteNode:v,duplicateSelected:w,handleConnectionColorChange:T,handleConnectionLineTypeChange:y,handleEdgeLabelSave:_,handleEdgeDelete:S,handleInputModalConfirm:C}};var Jx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I2=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},X3=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},S2={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(I2(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):X3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new J3;const f=s<<2|a>>4;if(r.push(f),c!==64){const m=a<<4&240|c>>2;if(r.push(m),h!==64){const v=c<<6&192|h;r.push(v)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class J3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Z3=function(t){const e=I2(t);return S2.encodeByteArray(e,!0)},T2=function(t){return Z3(t).replace(/\./g,"")},A2=function(t){try{return S2.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ej(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tj=()=>ej().__FIREBASE_DEFAULTS__,nj=()=>{if(typeof process>"u"||typeof Jx>"u")return;const t=Jx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},rj=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&A2(t[1]);return e&&JSON.parse(e)},Jf=()=>{try{return tj()||nj()||rj()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},ij=t=>{var e,n;return(n=(e=Jf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},C2=()=>{var t;return(t=Jf())===null||t===void 0?void 0:t.config},R2=t=>{var e;return(e=Jf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sj{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function oj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Rt())}function aj(){var t;const e=(t=Jf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function lj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function k2(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function cj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function uj(){const t=Rt();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function N2(){return!aj()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ev(){try{return typeof indexedDB=="object"}catch{return!1}}function P2(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function dj(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj="FirebaseError";class kr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=hj,Object.setPrototypeOf(this,kr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ko.prototype.create)}}class ko{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?fj(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new kr(i,a,r)}}function fj(t,e){return t.replace(pj,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const pj=/\{\$([^}]+)}/g;function mj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xa(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(Zx(s)&&Zx(o)){if(!Xa(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function Zx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Du(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function mc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function gc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function gj(t,e){const n=new yj(t,e);return n.subscribe.bind(n)}class yj{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");vj(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=vm),i.error===void 0&&(i.error=vm),i.complete===void 0&&(i.complete=vm);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function vj(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function vm(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj=1e3,_j=2,xj=4*60*60*1e3,bj=.5;function e1(t,e=wj,n=_j){const r=e*Math.pow(n,t),i=Math.round(bj*r*(Math.random()-.5)*2);return Math.min(xj,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kt(t){return t&&t._delegate?t._delegate:t}class Cr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ej{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new sj;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Sj(e))try{this.getOrInitializeService({instanceIdentifier:Fs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Fs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Fs){return this.instances.has(e)}getOptions(e=Fs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:Ij(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Fs){return this.component?this.component.multipleInstances?e:Fs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function Ij(t){return t===Fs?void 0:t}function Sj(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new Ej(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Pe||(Pe={}));const Aj={debug:Pe.DEBUG,verbose:Pe.VERBOSE,info:Pe.INFO,warn:Pe.WARN,error:Pe.ERROR,silent:Pe.SILENT},Cj=Pe.INFO,Rj={[Pe.DEBUG]:"log",[Pe.VERBOSE]:"log",[Pe.INFO]:"info",[Pe.WARN]:"warn",[Pe.ERROR]:"error"},kj=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=Rj[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Zf{constructor(e){this.name=e,this._logLevel=Cj,this._logHandler=kj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Pe))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Aj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Pe.DEBUG,...e),this._logHandler(this,Pe.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Pe.VERBOSE,...e),this._logHandler(this,Pe.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Pe.INFO,...e),this._logHandler(this,Pe.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Pe.WARN,...e),this._logHandler(this,Pe.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Pe.ERROR,...e),this._logHandler(this,Pe.ERROR,...e)}}const Nj=(t,e)=>e.some(n=>t instanceof n);let t1,n1;function Pj(){return t1||(t1=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Dj(){return n1||(n1=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const D2=new WeakMap,Yg=new WeakMap,V2=new WeakMap,wm=new WeakMap,tv=new WeakMap;function Vj(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(ds(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&D2.set(n,t)}).catch(()=>{}),tv.set(e,t),e}function Oj(t){if(Yg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});Yg.set(t,e)}let Xg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Yg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||V2.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ds(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Lj(t){Xg=t(Xg)}function zj(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(_m(this),e,...n);return V2.set(r,e.sort?e.sort():[e]),ds(r)}:Dj().includes(t)?function(...e){return t.apply(_m(this),e),ds(D2.get(this))}:function(...e){return ds(t.apply(_m(this),e))}}function Mj(t){return typeof t=="function"?zj(t):(t instanceof IDBTransaction&&Oj(t),Nj(t,Pj())?new Proxy(t,Xg):t)}function ds(t){if(t instanceof IDBRequest)return Vj(t);if(wm.has(t))return wm.get(t);const e=Mj(t);return e!==t&&(wm.set(t,e),tv.set(e,t)),e}const _m=t=>tv.get(t);function O2(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=ds(o);return r&&o.addEventListener("upgradeneeded",l=>{r(ds(o.result),l.oldVersion,l.newVersion,ds(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const jj=["get","getKey","getAll","getAllKeys","count"],Fj=["put","add","delete","clear"],xm=new Map;function r1(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(xm.get(e))return xm.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=Fj.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||jj.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return xm.set(e,s),s}Lj(t=>({...t,get:(e,n,r)=>r1(e,n)||t.get(e,n,r),has:(e,n)=>!!r1(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $j{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Uj(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Uj(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Jg="@firebase/app",i1="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ii=new Zf("@firebase/app"),Bj="@firebase/app-compat",qj="@firebase/analytics-compat",Hj="@firebase/analytics",Kj="@firebase/app-check-compat",Wj="@firebase/app-check",Gj="@firebase/auth",Qj="@firebase/auth-compat",Yj="@firebase/database",Xj="@firebase/data-connect",Jj="@firebase/database-compat",Zj="@firebase/functions",eF="@firebase/functions-compat",tF="@firebase/installations",nF="@firebase/installations-compat",rF="@firebase/messaging",iF="@firebase/messaging-compat",sF="@firebase/performance",oF="@firebase/performance-compat",aF="@firebase/remote-config",lF="@firebase/remote-config-compat",cF="@firebase/storage",uF="@firebase/storage-compat",dF="@firebase/firestore",hF="@firebase/vertexai-preview",fF="@firebase/firestore-compat",pF="firebase",mF="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zg="[DEFAULT]",gF={[Jg]:"fire-core",[Bj]:"fire-core-compat",[Hj]:"fire-analytics",[qj]:"fire-analytics-compat",[Wj]:"fire-app-check",[Kj]:"fire-app-check-compat",[Gj]:"fire-auth",[Qj]:"fire-auth-compat",[Yj]:"fire-rtdb",[Xj]:"fire-data-connect",[Jj]:"fire-rtdb-compat",[Zj]:"fire-fn",[eF]:"fire-fn-compat",[tF]:"fire-iid",[nF]:"fire-iid-compat",[rF]:"fire-fcm",[iF]:"fire-fcm-compat",[sF]:"fire-perf",[oF]:"fire-perf-compat",[aF]:"fire-rc",[lF]:"fire-rc-compat",[cF]:"fire-gcs",[uF]:"fire-gcs-compat",[dF]:"fire-fst",[fF]:"fire-fst-compat",[hF]:"fire-vertex","fire-js":"fire-js",[pF]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nf=new Map,yF=new Map,e0=new Map;function s1(t,e){try{t.container.addComponent(e)}catch(n){Ii.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Wr(t){const e=t.name;if(e0.has(e))return Ii.debug(`There were multiple attempts to register component ${e}.`),!1;e0.set(e,t);for(const n of nf.values())s1(n,t);for(const n of yF.values())s1(n,t);return!0}function No(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function br(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},hs=new ko("app","Firebase",vF);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wF{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Cr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hs.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _l=mF;function L2(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Zg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw hs.create("bad-app-name",{appName:String(i)});if(n||(n=C2()),!n)throw hs.create("no-options");const s=nf.get(i);if(s){if(Xa(n,s.options)&&Xa(r,s.config))return s;throw hs.create("duplicate-app",{appName:i})}const o=new Tj(i);for(const l of e0.values())o.addComponent(l);const a=new wF(n,r,o);return nf.set(i,a),a}function z2(t=Zg){const e=nf.get(t);if(!e&&t===Zg&&C2())return L2();if(!e)throw hs.create("no-app",{appName:t});return e}function ar(t,e,n){var r;let i=(r=gF[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ii.warn(a.join(" "));return}Wr(new Cr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _F="firebase-heartbeat-database",xF=1,hu="firebase-heartbeat-store";let bm=null;function M2(){return bm||(bm=O2(_F,xF,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(hu)}catch(n){console.warn(n)}}}}).catch(t=>{throw hs.create("idb-open",{originalErrorMessage:t.message})})),bm}async function bF(t){try{const n=(await M2()).transaction(hu),r=await n.objectStore(hu).get(j2(t));return await n.done,r}catch(e){if(e instanceof kr)Ii.warn(e.message);else{const n=hs.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ii.warn(n.message)}}}async function o1(t,e){try{const r=(await M2()).transaction(hu,"readwrite");await r.objectStore(hu).put(e,j2(t)),await r.done}catch(n){if(n instanceof kr)Ii.warn(n.message);else{const r=hs.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ii.warn(r.message)}}}function j2(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EF=1024,IF=30*24*60*60*1e3;class SF{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new AF(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=a1();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=IF}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ii.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=a1(),{heartbeatsToSend:r,unsentEntries:i}=TF(this._heartbeatsCache.heartbeats),s=T2(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return Ii.warn(n),""}}}function a1(){return new Date().toISOString().substring(0,10)}function TF(t,e=EF){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),l1(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),l1(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class AF{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ev()?P2().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await bF(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return o1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return o1(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function l1(t){return T2(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CF(t){Wr(new Cr("platform-logger",e=>new $j(e),"PRIVATE")),Wr(new Cr("heartbeat",e=>new SF(e),"PRIVATE")),ar(Jg,i1,t),ar(Jg,i1,"esm2017"),ar("fire-js","")}CF("");function nv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function F2(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const RF=F2,$2=new ko("auth","Firebase",F2());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rf=new Zf("@firebase/auth");function kF(t,...e){rf.logLevel<=Pe.WARN&&rf.warn(`Auth (${_l}): ${t}`,...e)}function sh(t,...e){rf.logLevel<=Pe.ERROR&&rf.error(`Auth (${_l}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ur(t,...e){throw iv(t,...e)}function Tr(t,...e){return iv(t,...e)}function rv(t,e,n){const r=Object.assign(Object.assign({},RF()),{[e]:n});return new ko("auth","Firebase",r).create(e,{appName:t.name})}function yi(t){return rv(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function NF(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&ur(t,"argument-error"),rv(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function iv(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return $2.create(t,...e)}function ye(t,e,...n){if(!t)throw iv(e,...n)}function ui(t){const e="INTERNAL ASSERTION FAILED: "+t;throw sh(e),new Error(e)}function Si(t,e){t||ui(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function PF(){return c1()==="http:"||c1()==="https:"}function c1(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DF(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(PF()||k2()||"connection"in navigator)?navigator.onLine:!0}function VF(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Si(n>e,"Short delay should be less than long delay!"),this.isMobile=oj()||cj()}get(){return DF()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(t,e){Si(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U2{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ui("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ui("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ui("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OF={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LF=new Vu(3e4,6e4);function Ci(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Xr(t,e,n,r,i={}){return B2(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=Du(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return lj()||(c.referrerPolicy="no-referrer"),U2.fetch()(q2(t,t.config.apiHost,n,a),c)})}async function B2(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},OF),e);try{const i=new MF(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Vd(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw Vd(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw Vd(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw Vd(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw rv(t,d,c);ur(t,d)}}catch(i){if(i instanceof kr)throw i;ur(t,"network-request-failed",{message:String(i)})}}async function Ou(t,e,n,r,i={}){const s=await Xr(t,e,n,r,i);return"mfaPendingCredential"in s&&ur(t,"multi-factor-auth-required",{_serverResponse:s}),s}function q2(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?sv(t.config,i):`${t.config.apiScheme}://${i}`}function zF(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class MF{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Tr(this.auth,"network-request-failed")),LF.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Vd(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=Tr(t,e,r);return i.customData._tokenResponse=n,i}function u1(t){return t!==void 0&&t.enterprise!==void 0}class jF{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return zF(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function FF(t,e){return Xr(t,"GET","/v2/recaptchaConfig",Ci(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $F(t,e){return Xr(t,"POST","/v1/accounts:delete",e)}async function H2(t,e){return Xr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function UF(t,e=!1){const n=kt(t),r=await n.getIdToken(e),i=ov(r);ye(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Nc(Em(i.auth_time)),issuedAtTime:Nc(Em(i.iat)),expirationTime:Nc(Em(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Em(t){return Number(t)*1e3}function ov(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return sh("JWT malformed, contained fewer than 3 sections"),null;try{const i=A2(n);return i?JSON.parse(i):(sh("Failed to decode base64 JWT payload"),null)}catch(i){return sh("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function d1(t){const e=ov(t);return ye(e,"internal-error"),ye(typeof e.exp<"u","internal-error"),ye(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ja(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof kr&&BF(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function BF({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Nc(this.lastLoginAt),this.creationTime=Nc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sf(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Ja(t,H2(n,{idToken:r}));ye(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?K2(s.providerUserInfo):[],a=KF(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new n0(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function HF(t){const e=kt(t);await sf(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function KF(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function K2(t){return t.map(e=>{var{providerId:n}=e,r=nv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function WF(t,e){const n=await B2(t,{},async()=>{const r=Du({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=q2(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",U2.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function GF(t,e){return Xr(t,"POST","/v2/accounts:revokeToken",Ci(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class La{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ye(e.idToken,"internal-error"),ye(typeof e.idToken<"u","internal-error"),ye(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):d1(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ye(e.length!==0,"internal-error");const n=d1(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ye(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await WF(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new La;return r&&(ye(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ye(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ye(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new La,this.toJSON())}_performRefresh(){return ui("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mi(t,e){ye(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class di{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=nv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new qF(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new n0(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Ja(this,this.stsTokenManager.getToken(this.auth,e));return ye(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return UF(this,e)}reload(){return HF(this)}_assign(e){this!==e&&(ye(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new di(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ye(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await sf(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(br(this.auth.app))return Promise.reject(yi(this.auth));const e=await this.getIdToken();return await Ja(this,$F(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,c,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(i=n.email)!==null&&i!==void 0?i:void 0,m=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,v=(o=n.photoURL)!==null&&o!==void 0?o:void 0,w=(a=n.tenantId)!==null&&a!==void 0?a:void 0,T=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=n.createdAt)!==null&&c!==void 0?c:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:S,emailVerified:C,isAnonymous:O,providerData:z,stsTokenManager:A}=n;ye(S&&A,e,"internal-error");const E=La.fromJSON(this.name,A);ye(typeof S=="string",e,"internal-error"),Mi(h,e.name),Mi(f,e.name),ye(typeof C=="boolean",e,"internal-error"),ye(typeof O=="boolean",e,"internal-error"),Mi(m,e.name),Mi(v,e.name),Mi(w,e.name),Mi(T,e.name),Mi(y,e.name),Mi(_,e.name);const b=new di({uid:S,auth:e,email:f,emailVerified:C,displayName:h,isAnonymous:O,photoURL:v,phoneNumber:m,tenantId:w,stsTokenManager:E,createdAt:y,lastLoginAt:_});return z&&Array.isArray(z)&&(b.providerData=z.map(I=>Object.assign({},I))),T&&(b._redirectEventId=T),b}static async _fromIdTokenResponse(e,n,r=!1){const i=new La;i.updateFromServerResponse(n);const s=new di({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await sf(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ye(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?K2(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new La;a.updateFromIdToken(r);const l=new di({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new n0(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const h1=new Map;function hi(t){Si(t instanceof Function,"Expected a class definition");let e=h1.get(t);return e?(Si(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,h1.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W2{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}W2.type="NONE";const f1=W2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oh(t,e,n){return`firebase:${t}:${e}:${n}`}class za{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=oh(this.userKey,i.apiKey,s),this.fullPersistenceKey=oh("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?di._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new za(hi(f1),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||hi(f1);const o=oh(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const d=await c._get(o);if(d){const h=di._fromJSON(e,d);c!==s&&(a=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new za(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new za(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p1(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(X2(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(G2(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Z2(e))return"Blackberry";if(eA(e))return"Webos";if(Q2(e))return"Safari";if((e.includes("chrome/")||Y2(e))&&!e.includes("edge/"))return"Chrome";if(J2(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function G2(t=Rt()){return/firefox\//i.test(t)}function Q2(t=Rt()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Y2(t=Rt()){return/crios\//i.test(t)}function X2(t=Rt()){return/iemobile/i.test(t)}function J2(t=Rt()){return/android/i.test(t)}function Z2(t=Rt()){return/blackberry/i.test(t)}function eA(t=Rt()){return/webos/i.test(t)}function av(t=Rt()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function QF(t=Rt()){var e;return av(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function YF(){return uj()&&document.documentMode===10}function tA(t=Rt()){return av(t)||J2(t)||eA(t)||Z2(t)||/windows phone/i.test(t)||X2(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nA(t,e=[]){let n;switch(t){case"Browser":n=p1(Rt());break;case"Worker":n=`${p1(Rt())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${_l}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JF(t,e={}){return Xr(t,"GET","/v2/passwordPolicy",Ci(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZF=6;class e6{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:ZF,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new m1(this),this.idTokenSubscription=new m1(this),this.beforeStateQueue=new XF(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$2,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=hi(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await za.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await H2(this,{idToken:e}),r=await di._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(br(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ye(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await sf(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=VF()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(br(this.app))return Promise.reject(yi(this));const n=e?kt(e):null;return n&&ye(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ye(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return br(this.app)?Promise.reject(yi(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return br(this.app)?Promise.reject(yi(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(hi(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await JF(this),n=new e6(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new ko("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await GF(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&hi(e)||this._popupRedirectResolver;ye(n,this,"argument-error"),this.redirectPersistenceManager=await za.create(this,[hi(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ye(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ye(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=nA(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&kF(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ri(t){return kt(t)}class m1{constructor(e){this.auth=e,this.observer=null,this.addObserver=gj(n=>this.observer=n)}get next(){return ye(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ep={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function n6(t){ep=t}function rA(t){return ep.loadJS(t)}function r6(){return ep.recaptchaEnterpriseScript}function i6(){return ep.gapiScript}function s6(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const o6="recaptcha-enterprise",a6="NO_RECAPTCHA";class l6{constructor(e){this.type=o6,this.auth=Ri(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{FF(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new jF(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;u1(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(a6)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&u1(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=r6();l.length!==0&&(l+=a),rA(l).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function g1(t,e,n,r=!1){const i=new l6(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function of(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await g1(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await g1(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c6(t,e){const n=No(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Xa(s,e??{}))return i;ur(i,"already-initialized")}return n.initialize({options:e})}function u6(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(hi);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function d6(t,e,n){const r=Ri(t);ye(r._canInitEmulator,r,"emulator-config-failed"),ye(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=iA(e),{host:o,port:a}=h6(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),f6()}function iA(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function h6(t){const e=iA(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:y1(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:y1(o)}}}function y1(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function f6(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lv{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ui("not implemented")}_getIdTokenResponse(e){return ui("not implemented")}_linkToIdToken(e,n){return ui("not implemented")}_getReauthenticationResolver(e){return ui("not implemented")}}async function p6(t,e){return Xr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m6(t,e){return Ou(t,"POST","/v1/accounts:signInWithPassword",Ci(t,e))}async function sA(t,e){return Xr(t,"POST","/v1/accounts:sendOobCode",Ci(t,e))}async function g6(t,e){return sA(t,e)}async function y6(t,e){return sA(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v6(t,e){return Ou(t,"POST","/v1/accounts:signInWithEmailLink",Ci(t,e))}async function w6(t,e){return Ou(t,"POST","/v1/accounts:signInWithEmailLink",Ci(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fu extends lv{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new fu(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new fu(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return of(e,n,"signInWithPassword",m6);case"emailLink":return v6(e,{email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return of(e,r,"signUpPassword",p6);case"emailLink":return w6(e,{idToken:n,email:this._email,oobCode:this._password});default:ur(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ma(t,e){return Ou(t,"POST","/v1/accounts:signInWithIdp",Ci(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6="http://localhost";class mo extends lv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new mo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ur("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=nv(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new mo(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ma(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ma(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ma(e,n)}buildRequest(){const e={requestUri:_6,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Du(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x6(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function b6(t){const e=mc(gc(t)).link,n=e?mc(gc(e)).deep_link_id:null,r=mc(gc(t)).deep_link_id;return(r?mc(gc(r)).link:null)||r||n||e||t}class cv{constructor(e){var n,r,i,s,o,a;const l=mc(gc(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,h=x6((i=l.mode)!==null&&i!==void 0?i:null);ye(c&&d&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=b6(e);try{return new cv(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xl{constructor(){this.providerId=xl.PROVIDER_ID}static credential(e,n){return fu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=cv.parseLink(n);return ye(r,"argument-error"),fu._fromEmailAndCode(e,r.code,r.tenantId)}}xl.PROVIDER_ID="password";xl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";xl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu extends uv{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gi extends Lu{constructor(){super("facebook.com")}static credential(e){return mo._fromParams({providerId:Gi.PROVIDER_ID,signInMethod:Gi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gi.credentialFromTaggedObject(e)}static credentialFromError(e){return Gi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gi.credential(e.oauthAccessToken)}catch{return null}}}Gi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oi extends Lu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return mo._fromParams({providerId:oi.PROVIDER_ID,signInMethod:oi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return oi.credentialFromTaggedObject(e)}static credentialFromError(e){return oi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return oi.credential(n,r)}catch{return null}}}oi.GOOGLE_SIGN_IN_METHOD="google.com";oi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends Lu{constructor(){super("github.com")}static credential(e){return mo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.GITHUB_SIGN_IN_METHOD="github.com";Qi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends Lu{constructor(){super("twitter.com")}static credential(e,n){return mo._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Yi.credential(n,r)}catch{return null}}}Yi.TWITTER_SIGN_IN_METHOD="twitter.com";Yi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E6(t,e){return Ou(t,"POST","/v1/accounts:signUp",Ci(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class go{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await di._fromIdTokenResponse(e,r,i),o=v1(r);return new go({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=v1(r);return new go({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function v1(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class af extends kr{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,af.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new af(e,n,r,i)}}function oA(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?af._fromErrorAndOperation(t,s,e,r):s})}async function I6(t,e,n=!1){const r=await Ja(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return go._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S6(t,e,n=!1){const{auth:r}=t;if(br(r.app))return Promise.reject(yi(r));const i="reauthenticate";try{const s=await Ja(t,oA(r,i,e,t),n);ye(s.idToken,r,"internal-error");const o=ov(s.idToken);ye(o,r,"internal-error");const{sub:a}=o;return ye(t.uid===a,r,"user-mismatch"),go._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ur(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aA(t,e,n=!1){if(br(t.app))return Promise.reject(yi(t));const r="signIn",i=await oA(t,r,e),s=await go._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function T6(t,e){return aA(Ri(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lA(t){const e=Ri(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function A6(t,e,n){const r=Ri(t);await of(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",y6)}async function C6(t,e,n){if(br(t.app))return Promise.reject(yi(t));const r=Ri(t),o=await of(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",E6).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&lA(t),l}),a=await go._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function R6(t,e,n){return br(t.app)?Promise.reject(yi(t)):T6(kt(t),xl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&lA(t),r})}async function k6(t,e){const n=kt(t),i={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:s}=await g6(n.auth,i);s!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N6(t,e){return Xr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=kt(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Ja(r,N6(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function D6(t,e,n,r){return kt(t).onIdTokenChanged(e,n,r)}function V6(t,e,n){return kt(t).beforeAuthStateChanged(e,n)}function O6(t,e,n,r){return kt(t).onAuthStateChanged(e,n,r)}function L6(t){return kt(t).signOut()}const lf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cA{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(lf,"1"),this.storage.removeItem(lf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z6=1e3,M6=10;class uA extends cA{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=tA(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);YF()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,M6):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},z6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}uA.type="LOCAL";const j6=uA;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA extends cA{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}dA.type="SESSION";const hA=dA;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tp{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new tp(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await F6(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tp.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=dv("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hr(){return window}function U6(t){Hr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fA(){return typeof Hr().WorkerGlobalScope<"u"&&typeof Hr().importScripts=="function"}async function B6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function q6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function H6(){return fA()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="firebaseLocalStorageDb",K6=1,cf="firebaseLocalStorage",mA="fbase_key";class zu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function np(t,e){return t.transaction([cf],e?"readwrite":"readonly").objectStore(cf)}function W6(){const t=indexedDB.deleteDatabase(pA);return new zu(t).toPromise()}function r0(){const t=indexedDB.open(pA,K6);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(cf,{keyPath:mA})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(cf)?e(r):(r.close(),await W6(),e(await r0()))})})}async function w1(t,e,n){const r=np(t,!0).put({[mA]:e,value:n});return new zu(r).toPromise()}async function G6(t,e){const n=np(t,!1).get(e),r=await new zu(n).toPromise();return r===void 0?null:r.value}function _1(t,e){const n=np(t,!0).delete(e);return new zu(n).toPromise()}const Q6=800,Y6=3;class gA{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await r0(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Y6)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return fA()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tp._getInstance(H6()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await B6(),!this.activeServiceWorker)return;this.sender=new $6(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||q6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await r0();return await w1(e,lf,"1"),await _1(e,lf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>w1(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>G6(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>_1(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=np(i,!1).getAll();return new zu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Q6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}gA.type="LOCAL";const X6=gA;new Vu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yA(t,e){return e?hi(e):(ye(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hv extends lv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ma(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ma(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ma(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function J6(t){return aA(t.auth,new hv(t),t.bypassAuthState)}function Z6(t){const{auth:e,user:n}=t;return ye(n,e,"internal-error"),S6(n,new hv(t),t.bypassAuthState)}async function e9(t){const{auth:e,user:n}=t;return ye(n,e,"internal-error"),I6(n,new hv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vA{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return J6;case"linkViaPopup":case"linkViaRedirect":return e9;case"reauthViaPopup":case"reauthViaRedirect":return Z6;default:ur(this.auth,"internal-error")}}resolve(e){Si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Si(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t9=new Vu(2e3,1e4);async function n9(t,e,n){if(br(t.app))return Promise.reject(Tr(t,"operation-not-supported-in-this-environment"));const r=Ri(t);NF(t,e,uv);const i=yA(r,n);return new Xs(r,"signInViaPopup",e,i).executeNotNull()}class Xs extends vA{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Xs.currentPopupAction&&Xs.currentPopupAction.cancel(),Xs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ye(e,this.auth,"internal-error"),e}async onExecution(){Si(this.filter.length===1,"Popup operations only handle one event");const e=dv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Tr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Tr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Tr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,t9.get())};e()}}Xs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r9="pendingRedirect",ah=new Map;class i9 extends vA{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ah.get(this.auth._key());if(!e){try{const r=await s9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ah.set(this.auth._key(),e)}return this.bypassAuthState||ah.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function s9(t,e){const n=l9(e),r=a9(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function o9(t,e){ah.set(t._key(),e)}function a9(t){return hi(t._redirectPersistence)}function l9(t){return oh(r9,t.config.apiKey,t.name)}async function c9(t,e,n=!1){if(br(t.app))return Promise.reject(yi(t));const r=Ri(t),i=yA(r,e),o=await new i9(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const u9=10*60*1e3;class d9{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!h9(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!wA(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Tr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=u9&&this.cachedEventUids.clear(),this.cachedEventUids.has(x1(e))}saveEventToCache(e){this.cachedEventUids.add(x1(e)),this.lastProcessedEventTime=Date.now()}}function x1(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function wA({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function h9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wA(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function f9(t,e={}){return Xr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,m9=/^https?/;async function g9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await f9(t);for(const n of e)try{if(y9(n))return}catch{}ur(t,"unauthorized-domain")}function y9(t){const e=t0(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!m9.test(n))return!1;if(p9.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v9=new Vu(3e4,6e4);function b1(){const t=Hr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function w9(t){return new Promise((e,n)=>{var r,i,s;function o(){b1(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{b1(),n(Tr(t,"network-request-failed"))},timeout:v9.get()})}if(!((i=(r=Hr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Hr().gapi)===null||s===void 0)&&s.load)o();else{const a=s6("iframefcb");return Hr()[a]=()=>{gapi.load?o():n(Tr(t,"network-request-failed"))},rA(`${i6()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw lh=null,e})}let lh=null;function _9(t){return lh=lh||w9(t),lh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const x9=new Vu(5e3,15e3),b9="__/auth/iframe",E9="emulator/auth/iframe",I9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},S9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function T9(t){const e=t.config;ye(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?sv(e,E9):`https://${t.config.authDomain}/${b9}`,r={apiKey:e.apiKey,appName:t.name,v:_l},i=S9.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${Du(r).slice(1)}`}async function A9(t){const e=await _9(t),n=Hr().gapi;return ye(n,t,"internal-error"),e.open({where:document.body,url:T9(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:I9,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=Tr(t,"network-request-failed"),a=Hr().setTimeout(()=>{s(o)},x9.get());function l(){Hr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},R9=500,k9=600,N9="_blank",P9="http://localhost";class E1{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function D9(t,e,n,r=R9,i=k9){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},C9),{width:r.toString(),height:i.toString(),top:s,left:o}),c=Rt().toLowerCase();n&&(a=Y2(c)?N9:n),G2(c)&&(e=e||P9,l.scrollbars="yes");const d=Object.entries(l).reduce((f,[m,v])=>`${f}${m}=${v},`,"");if(QF(c)&&a!=="_self")return V9(e||"",a),new E1(null);const h=window.open(e||"",a,d);ye(h,t,"popup-blocked");try{h.focus()}catch{}return new E1(h)}function V9(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O9="__/auth/handler",L9="emulator/auth/handler",z9=encodeURIComponent("fac");async function I1(t,e,n,r,i,s){ye(t.config.authDomain,t,"auth-domain-config-required"),ye(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:_l,eventId:i};if(e instanceof uv){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",mj(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))o[d]=h}if(e instanceof Lu){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),c=l?`#${z9}=${encodeURIComponent(l)}`:"";return`${M9(t)}?${Du(a).slice(1)}${c}`}function M9({config:t}){return t.emulator?sv(t,L9):`https://${t.authDomain}/${O9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Im="webStorageSupport";class j9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=hA,this._completeRedirectFn=c9,this._overrideRedirectResult=o9}async _openPopup(e,n,r,i){var s;Si((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await I1(e,n,r,t0(),i);return D9(e,o,dv())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await I1(e,n,r,t0(),i);return U6(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(Si(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await A9(e),r=new d9(e);return n.register("authEvent",i=>(ye(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Im,{type:Im},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Im];o!==void 0&&n(!!o),ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=g9(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return tA()||Q2()||av()}}const F9=j9;var S1="@firebase/auth",T1="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ye(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function B9(t){Wr(new Cr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ye(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:nA(t)},c=new t6(r,i,s,l);return u6(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Wr(new Cr("auth-internal",e=>{const n=Ri(e.getProvider("auth").getImmediate());return(r=>new $9(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ar(S1,T1,U9(t)),ar(S1,T1,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q9=5*60,H9=R2("authIdTokenMaxAge")||q9;let A1=null;const K9=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>H9)return;const i=n==null?void 0:n.token;A1!==i&&(A1=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function W9(t=z2()){const e=No(t,"auth");if(e.isInitialized())return e.getImmediate();const n=c6(t,{popupRedirectResolver:F9,persistence:[X6,j6,hA]}),r=R2("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=K9(s.toString());V6(n,o,()=>o(n.currentUser)),D6(n,a=>o(a))}}const i=ij("auth");return i&&d6(n,`http://${i}`),n}function G9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}n6({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=Tr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",G9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});B9("Browser");var Q9="firebase",Y9="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ar(Q9,Y9,"app");var C1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var io,_A;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,E){function b(){}b.prototype=E.prototype,A.D=E.prototype,A.prototype=new b,A.prototype.constructor=A,A.C=function(I,k,N){for(var R=Array(arguments.length-2),P=2;P<arguments.length;P++)R[P-2]=arguments[P];return E.prototype[k].apply(I,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(A,E,b){b||(b=0);var I=Array(16);if(typeof E=="string")for(var k=0;16>k;++k)I[k]=E.charCodeAt(b++)|E.charCodeAt(b++)<<8|E.charCodeAt(b++)<<16|E.charCodeAt(b++)<<24;else for(k=0;16>k;++k)I[k]=E[b++]|E[b++]<<8|E[b++]<<16|E[b++]<<24;E=A.g[0],b=A.g[1],k=A.g[2];var N=A.g[3],R=E+(N^b&(k^N))+I[0]+3614090360&4294967295;E=b+(R<<7&4294967295|R>>>25),R=N+(k^E&(b^k))+I[1]+3905402710&4294967295,N=E+(R<<12&4294967295|R>>>20),R=k+(b^N&(E^b))+I[2]+606105819&4294967295,k=N+(R<<17&4294967295|R>>>15),R=b+(E^k&(N^E))+I[3]+3250441966&4294967295,b=k+(R<<22&4294967295|R>>>10),R=E+(N^b&(k^N))+I[4]+4118548399&4294967295,E=b+(R<<7&4294967295|R>>>25),R=N+(k^E&(b^k))+I[5]+1200080426&4294967295,N=E+(R<<12&4294967295|R>>>20),R=k+(b^N&(E^b))+I[6]+2821735955&4294967295,k=N+(R<<17&4294967295|R>>>15),R=b+(E^k&(N^E))+I[7]+4249261313&4294967295,b=k+(R<<22&4294967295|R>>>10),R=E+(N^b&(k^N))+I[8]+1770035416&4294967295,E=b+(R<<7&4294967295|R>>>25),R=N+(k^E&(b^k))+I[9]+2336552879&4294967295,N=E+(R<<12&4294967295|R>>>20),R=k+(b^N&(E^b))+I[10]+4294925233&4294967295,k=N+(R<<17&4294967295|R>>>15),R=b+(E^k&(N^E))+I[11]+2304563134&4294967295,b=k+(R<<22&4294967295|R>>>10),R=E+(N^b&(k^N))+I[12]+1804603682&4294967295,E=b+(R<<7&4294967295|R>>>25),R=N+(k^E&(b^k))+I[13]+4254626195&4294967295,N=E+(R<<12&4294967295|R>>>20),R=k+(b^N&(E^b))+I[14]+2792965006&4294967295,k=N+(R<<17&4294967295|R>>>15),R=b+(E^k&(N^E))+I[15]+1236535329&4294967295,b=k+(R<<22&4294967295|R>>>10),R=E+(k^N&(b^k))+I[1]+4129170786&4294967295,E=b+(R<<5&4294967295|R>>>27),R=N+(b^k&(E^b))+I[6]+3225465664&4294967295,N=E+(R<<9&4294967295|R>>>23),R=k+(E^b&(N^E))+I[11]+643717713&4294967295,k=N+(R<<14&4294967295|R>>>18),R=b+(N^E&(k^N))+I[0]+3921069994&4294967295,b=k+(R<<20&4294967295|R>>>12),R=E+(k^N&(b^k))+I[5]+3593408605&4294967295,E=b+(R<<5&4294967295|R>>>27),R=N+(b^k&(E^b))+I[10]+38016083&4294967295,N=E+(R<<9&4294967295|R>>>23),R=k+(E^b&(N^E))+I[15]+3634488961&4294967295,k=N+(R<<14&4294967295|R>>>18),R=b+(N^E&(k^N))+I[4]+3889429448&4294967295,b=k+(R<<20&4294967295|R>>>12),R=E+(k^N&(b^k))+I[9]+568446438&4294967295,E=b+(R<<5&4294967295|R>>>27),R=N+(b^k&(E^b))+I[14]+3275163606&4294967295,N=E+(R<<9&4294967295|R>>>23),R=k+(E^b&(N^E))+I[3]+4107603335&4294967295,k=N+(R<<14&4294967295|R>>>18),R=b+(N^E&(k^N))+I[8]+1163531501&4294967295,b=k+(R<<20&4294967295|R>>>12),R=E+(k^N&(b^k))+I[13]+2850285829&4294967295,E=b+(R<<5&4294967295|R>>>27),R=N+(b^k&(E^b))+I[2]+4243563512&4294967295,N=E+(R<<9&4294967295|R>>>23),R=k+(E^b&(N^E))+I[7]+1735328473&4294967295,k=N+(R<<14&4294967295|R>>>18),R=b+(N^E&(k^N))+I[12]+2368359562&4294967295,b=k+(R<<20&4294967295|R>>>12),R=E+(b^k^N)+I[5]+4294588738&4294967295,E=b+(R<<4&4294967295|R>>>28),R=N+(E^b^k)+I[8]+2272392833&4294967295,N=E+(R<<11&4294967295|R>>>21),R=k+(N^E^b)+I[11]+1839030562&4294967295,k=N+(R<<16&4294967295|R>>>16),R=b+(k^N^E)+I[14]+4259657740&4294967295,b=k+(R<<23&4294967295|R>>>9),R=E+(b^k^N)+I[1]+2763975236&4294967295,E=b+(R<<4&4294967295|R>>>28),R=N+(E^b^k)+I[4]+1272893353&4294967295,N=E+(R<<11&4294967295|R>>>21),R=k+(N^E^b)+I[7]+4139469664&4294967295,k=N+(R<<16&4294967295|R>>>16),R=b+(k^N^E)+I[10]+3200236656&4294967295,b=k+(R<<23&4294967295|R>>>9),R=E+(b^k^N)+I[13]+681279174&4294967295,E=b+(R<<4&4294967295|R>>>28),R=N+(E^b^k)+I[0]+3936430074&4294967295,N=E+(R<<11&4294967295|R>>>21),R=k+(N^E^b)+I[3]+3572445317&4294967295,k=N+(R<<16&4294967295|R>>>16),R=b+(k^N^E)+I[6]+76029189&4294967295,b=k+(R<<23&4294967295|R>>>9),R=E+(b^k^N)+I[9]+3654602809&4294967295,E=b+(R<<4&4294967295|R>>>28),R=N+(E^b^k)+I[12]+3873151461&4294967295,N=E+(R<<11&4294967295|R>>>21),R=k+(N^E^b)+I[15]+530742520&4294967295,k=N+(R<<16&4294967295|R>>>16),R=b+(k^N^E)+I[2]+3299628645&4294967295,b=k+(R<<23&4294967295|R>>>9),R=E+(k^(b|~N))+I[0]+4096336452&4294967295,E=b+(R<<6&4294967295|R>>>26),R=N+(b^(E|~k))+I[7]+1126891415&4294967295,N=E+(R<<10&4294967295|R>>>22),R=k+(E^(N|~b))+I[14]+2878612391&4294967295,k=N+(R<<15&4294967295|R>>>17),R=b+(N^(k|~E))+I[5]+4237533241&4294967295,b=k+(R<<21&4294967295|R>>>11),R=E+(k^(b|~N))+I[12]+1700485571&4294967295,E=b+(R<<6&4294967295|R>>>26),R=N+(b^(E|~k))+I[3]+2399980690&4294967295,N=E+(R<<10&4294967295|R>>>22),R=k+(E^(N|~b))+I[10]+4293915773&4294967295,k=N+(R<<15&4294967295|R>>>17),R=b+(N^(k|~E))+I[1]+2240044497&4294967295,b=k+(R<<21&4294967295|R>>>11),R=E+(k^(b|~N))+I[8]+1873313359&4294967295,E=b+(R<<6&4294967295|R>>>26),R=N+(b^(E|~k))+I[15]+4264355552&4294967295,N=E+(R<<10&4294967295|R>>>22),R=k+(E^(N|~b))+I[6]+2734768916&4294967295,k=N+(R<<15&4294967295|R>>>17),R=b+(N^(k|~E))+I[13]+1309151649&4294967295,b=k+(R<<21&4294967295|R>>>11),R=E+(k^(b|~N))+I[4]+4149444226&4294967295,E=b+(R<<6&4294967295|R>>>26),R=N+(b^(E|~k))+I[11]+3174756917&4294967295,N=E+(R<<10&4294967295|R>>>22),R=k+(E^(N|~b))+I[2]+718787259&4294967295,k=N+(R<<15&4294967295|R>>>17),R=b+(N^(k|~E))+I[9]+3951481745&4294967295,A.g[0]=A.g[0]+E&4294967295,A.g[1]=A.g[1]+(k+(R<<21&4294967295|R>>>11))&4294967295,A.g[2]=A.g[2]+k&4294967295,A.g[3]=A.g[3]+N&4294967295}r.prototype.u=function(A,E){E===void 0&&(E=A.length);for(var b=E-this.blockSize,I=this.B,k=this.h,N=0;N<E;){if(k==0)for(;N<=b;)i(this,A,N),N+=this.blockSize;if(typeof A=="string"){for(;N<E;)if(I[k++]=A.charCodeAt(N++),k==this.blockSize){i(this,I),k=0;break}}else for(;N<E;)if(I[k++]=A[N++],k==this.blockSize){i(this,I),k=0;break}}this.h=k,this.o+=E},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var E=1;E<A.length-8;++E)A[E]=0;var b=8*this.o;for(E=A.length-8;E<A.length;++E)A[E]=b&255,b/=256;for(this.u(A),A=Array(16),E=b=0;4>E;++E)for(var I=0;32>I;I+=8)A[b++]=this.g[E]>>>I&255;return A};function s(A,E){var b=a;return Object.prototype.hasOwnProperty.call(b,A)?b[A]:b[A]=E(A)}function o(A,E){this.h=E;for(var b=[],I=!0,k=A.length-1;0<=k;k--){var N=A[k]|0;I&&N==E||(b[k]=N,I=!1)}this.g=b}var a={};function l(A){return-128<=A&&128>A?s(A,function(E){return new o([E|0],0>E?-1:0)}):new o([A|0],0>A?-1:0)}function c(A){if(isNaN(A)||!isFinite(A))return h;if(0>A)return T(c(-A));for(var E=[],b=1,I=0;A>=b;I++)E[I]=A/b|0,b*=4294967296;return new o(E,0)}function d(A,E){if(A.length==0)throw Error("number format error: empty string");if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(A.charAt(0)=="-")return T(d(A.substring(1),E));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var b=c(Math.pow(E,8)),I=h,k=0;k<A.length;k+=8){var N=Math.min(8,A.length-k),R=parseInt(A.substring(k,k+N),E);8>N?(N=c(Math.pow(E,N)),I=I.j(N).add(c(R))):(I=I.j(b),I=I.add(c(R)))}return I}var h=l(0),f=l(1),m=l(16777216);t=o.prototype,t.m=function(){if(w(this))return-T(this).m();for(var A=0,E=1,b=0;b<this.g.length;b++){var I=this.i(b);A+=(0<=I?I:4294967296+I)*E,E*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(v(this))return"0";if(w(this))return"-"+T(this).toString(A);for(var E=c(Math.pow(A,6)),b=this,I="";;){var k=C(b,E).g;b=y(b,k.j(E));var N=((0<b.g.length?b.g[0]:b.h)>>>0).toString(A);if(b=k,v(b))return N+I;for(;6>N.length;)N="0"+N;I=N+I}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function v(A){if(A.h!=0)return!1;for(var E=0;E<A.g.length;E++)if(A.g[E]!=0)return!1;return!0}function w(A){return A.h==-1}t.l=function(A){return A=y(this,A),w(A)?-1:v(A)?0:1};function T(A){for(var E=A.g.length,b=[],I=0;I<E;I++)b[I]=~A.g[I];return new o(b,~A.h).add(f)}t.abs=function(){return w(this)?T(this):this},t.add=function(A){for(var E=Math.max(this.g.length,A.g.length),b=[],I=0,k=0;k<=E;k++){var N=I+(this.i(k)&65535)+(A.i(k)&65535),R=(N>>>16)+(this.i(k)>>>16)+(A.i(k)>>>16);I=R>>>16,N&=65535,R&=65535,b[k]=R<<16|N}return new o(b,b[b.length-1]&-2147483648?-1:0)};function y(A,E){return A.add(T(E))}t.j=function(A){if(v(this)||v(A))return h;if(w(this))return w(A)?T(this).j(T(A)):T(T(this).j(A));if(w(A))return T(this.j(T(A)));if(0>this.l(m)&&0>A.l(m))return c(this.m()*A.m());for(var E=this.g.length+A.g.length,b=[],I=0;I<2*E;I++)b[I]=0;for(I=0;I<this.g.length;I++)for(var k=0;k<A.g.length;k++){var N=this.i(I)>>>16,R=this.i(I)&65535,P=A.i(k)>>>16,F=A.i(k)&65535;b[2*I+2*k]+=R*F,_(b,2*I+2*k),b[2*I+2*k+1]+=N*F,_(b,2*I+2*k+1),b[2*I+2*k+1]+=R*P,_(b,2*I+2*k+1),b[2*I+2*k+2]+=N*P,_(b,2*I+2*k+2)}for(I=0;I<E;I++)b[I]=b[2*I+1]<<16|b[2*I];for(I=E;I<2*E;I++)b[I]=0;return new o(b,0)};function _(A,E){for(;(A[E]&65535)!=A[E];)A[E+1]+=A[E]>>>16,A[E]&=65535,E++}function S(A,E){this.g=A,this.h=E}function C(A,E){if(v(E))throw Error("division by zero");if(v(A))return new S(h,h);if(w(A))return E=C(T(A),E),new S(T(E.g),T(E.h));if(w(E))return E=C(A,T(E)),new S(T(E.g),E.h);if(30<A.g.length){if(w(A)||w(E))throw Error("slowDivide_ only works with positive integers.");for(var b=f,I=E;0>=I.l(A);)b=O(b),I=O(I);var k=z(b,1),N=z(I,1);for(I=z(I,2),b=z(b,2);!v(I);){var R=N.add(I);0>=R.l(A)&&(k=k.add(b),N=R),I=z(I,1),b=z(b,1)}return E=y(A,k.j(E)),new S(k,E)}for(k=h;0<=A.l(E);){for(b=Math.max(1,Math.floor(A.m()/E.m())),I=Math.ceil(Math.log(b)/Math.LN2),I=48>=I?1:Math.pow(2,I-48),N=c(b),R=N.j(E);w(R)||0<R.l(A);)b-=I,N=c(b),R=N.j(E);v(N)&&(N=f),k=k.add(N),A=y(A,R)}return new S(k,A)}t.A=function(A){return C(this,A).h},t.and=function(A){for(var E=Math.max(this.g.length,A.g.length),b=[],I=0;I<E;I++)b[I]=this.i(I)&A.i(I);return new o(b,this.h&A.h)},t.or=function(A){for(var E=Math.max(this.g.length,A.g.length),b=[],I=0;I<E;I++)b[I]=this.i(I)|A.i(I);return new o(b,this.h|A.h)},t.xor=function(A){for(var E=Math.max(this.g.length,A.g.length),b=[],I=0;I<E;I++)b[I]=this.i(I)^A.i(I);return new o(b,this.h^A.h)};function O(A){for(var E=A.g.length+1,b=[],I=0;I<E;I++)b[I]=A.i(I)<<1|A.i(I-1)>>>31;return new o(b,A.h)}function z(A,E){var b=E>>5;E%=32;for(var I=A.g.length-b,k=[],N=0;N<I;N++)k[N]=0<E?A.i(N+b)>>>E|A.i(N+b+1)<<32-E:A.i(N+b);return new o(k,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,_A=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,io=o}).apply(typeof C1<"u"?C1:typeof self<"u"?self:typeof window<"u"?window:{});var Od=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var xA,yc,bA,ch,i0,EA,IA,SA;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,x){return u==Array.prototype||u==Object.prototype||(u[g]=x.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Od=="object"&&Od];for(var g=0;g<u.length;++g){var x=u[g];if(x&&x.Math==Math)return x}throw Error("Cannot find global object")}var r=n(this);function i(u,g){if(g)e:{var x=r;u=u.split(".");for(var V=0;V<u.length-1;V++){var q=u[V];if(!(q in x))break e;x=x[q]}u=u[u.length-1],V=x[u],g=g(V),g!=V&&g!=null&&e(x,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var x=0,V=!1,q={next:function(){if(!V&&x<u.length){var Q=x++;return{value:g(Q,u[Q]),done:!1}}return V=!0,{done:!0,value:void 0}}};return q[Symbol.iterator]=function(){return q},q}i("Array.prototype.values",function(u){return u||function(){return s(this,function(g,x){return x})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function c(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function d(u,g,x){return u.call.apply(u.bind,arguments)}function h(u,g,x){if(!u)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var q=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(q,V),u.apply(g,q)}}return function(){return u.apply(g,arguments)}}function f(u,g,x){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(u,g){var x=Array.prototype.slice.call(arguments,1);return function(){var V=x.slice();return V.push.apply(V,arguments),u.apply(this,V)}}function v(u,g){function x(){}x.prototype=g.prototype,u.aa=g.prototype,u.prototype=new x,u.prototype.constructor=u,u.Qb=function(V,q,Q){for(var ne=Array(arguments.length-2),We=2;We<arguments.length;We++)ne[We-2]=arguments[We];return g.prototype[q].apply(V,ne)}}function w(u){const g=u.length;if(0<g){const x=Array(g);for(let V=0;V<g;V++)x[V]=u[V];return x}return[]}function T(u,g){for(let x=1;x<arguments.length;x++){const V=arguments[x];if(l(V)){const q=u.length||0,Q=V.length||0;u.length=q+Q;for(let ne=0;ne<Q;ne++)u[q+ne]=V[ne]}else u.push(V)}}class y{constructor(g,x){this.i=g,this.j=x,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function _(u){return/^[\s\xa0]*$/.test(u)}function S(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function C(u){return C[" "](u),u}C[" "]=function(){};var O=S().indexOf("Gecko")!=-1&&!(S().toLowerCase().indexOf("webkit")!=-1&&S().indexOf("Edge")==-1)&&!(S().indexOf("Trident")!=-1||S().indexOf("MSIE")!=-1)&&S().indexOf("Edge")==-1;function z(u,g,x){for(const V in u)g.call(x,u[V],V,u)}function A(u,g){for(const x in u)g.call(void 0,u[x],x,u)}function E(u){const g={};for(const x in u)g[x]=u[x];return g}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function I(u,g){let x,V;for(let q=1;q<arguments.length;q++){V=arguments[q];for(x in V)u[x]=V[x];for(let Q=0;Q<b.length;Q++)x=b[Q],Object.prototype.hasOwnProperty.call(V,x)&&(u[x]=V[x])}}function k(u){var g=1;u=u.split(":");const x=[];for(;0<g&&u.length;)x.push(u.shift()),g--;return u.length&&x.push(u.join(":")),x}function N(u){a.setTimeout(()=>{throw u},0)}function R(){var u=M;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class P{constructor(){this.h=this.g=null}add(g,x){const V=F.get();V.set(g,x),this.h?this.h.next=V:this.g=V,this.h=V}}var F=new y(()=>new L,u=>u.reset());class L{constructor(){this.next=this.g=this.h=null}set(g,x){this.h=g,this.g=x,this.next=null}reset(){this.next=this.g=this.h=null}}let $,j=!1,M=new P,B=()=>{const u=a.Promise.resolve(void 0);$=()=>{u.then(K)}};var K=()=>{for(var u;u=R();){try{u.h.call(u.g)}catch(x){N(x)}var g=F;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}j=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var J=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const x=()=>{};a.addEventListener("test",x,g),a.removeEventListener("test",x,g)}catch{}return u}();function te(u,g){if(X.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var x=this.type=u.type,V=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(O){e:{try{C(g.nodeName);var q=!0;break e}catch{}q=!1}q||(g=null)}}else x=="mouseover"?g=u.fromElement:x=="mouseout"&&(g=u.toElement);this.relatedTarget=g,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:ae[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&te.aa.h.call(this)}}v(te,X);var ae={2:"touch",3:"pen",4:"mouse"};te.prototype.h=function(){te.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var pe="closure_listenable_"+(1e6*Math.random()|0),de=0;function xe(u,g,x,V,q){this.listener=u,this.proxy=null,this.src=g,this.type=x,this.capture=!!V,this.ha=q,this.key=++de,this.da=this.fa=!1}function be(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function ke(u){this.src=u,this.g={},this.h=0}ke.prototype.add=function(u,g,x,V,q){var Q=u.toString();u=this.g[Q],u||(u=this.g[Q]=[],this.h++);var ne=Ve(u,g,V,q);return-1<ne?(g=u[ne],x||(g.fa=!1)):(g=new xe(g,this.src,Q,!!V,q),g.fa=x,u.push(g)),g};function He(u,g){var x=g.type;if(x in u.g){var V=u.g[x],q=Array.prototype.indexOf.call(V,g,void 0),Q;(Q=0<=q)&&Array.prototype.splice.call(V,q,1),Q&&(be(g),u.g[x].length==0&&(delete u.g[x],u.h--))}}function Ve(u,g,x,V){for(var q=0;q<u.length;++q){var Q=u[q];if(!Q.da&&Q.listener==g&&Q.capture==!!x&&Q.ha==V)return q}return-1}var Xe="closure_lm_"+(1e6*Math.random()|0),ve={};function mt(u,g,x,V,q){if(Array.isArray(g)){for(var Q=0;Q<g.length;Q++)mt(u,g[Q],x,V,q);return null}return x=St(x),u&&u[pe]?u.K(g,x,c(V)?!!V.capture:!1,q):Ne(u,g,x,!1,V,q)}function Ne(u,g,x,V,q,Q){if(!g)throw Error("Invalid event type");var ne=c(q)?!!q.capture:!!q,We=it(u);if(We||(u[Xe]=We=new ke(u)),x=We.add(g,x,V,ne,Q),x.proxy)return x;if(V=oe(),x.proxy=V,V.src=u,V.listener=x,u.addEventListener)J||(q=ne),q===void 0&&(q=!1),u.addEventListener(g.toString(),V,q);else if(u.attachEvent)u.attachEvent(Dt(g.toString()),V);else if(u.addListener&&u.removeListener)u.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return x}function oe(){function u(x){return g.call(u.src,u.listener,x)}const g=hn;return u}function Ae(u,g,x,V,q){if(Array.isArray(g))for(var Q=0;Q<g.length;Q++)Ae(u,g[Q],x,V,q);else V=c(V)?!!V.capture:!!V,x=St(x),u&&u[pe]?(u=u.i,g=String(g).toString(),g in u.g&&(Q=u.g[g],x=Ve(Q,x,V,q),-1<x&&(be(Q[x]),Array.prototype.splice.call(Q,x,1),Q.length==0&&(delete u.g[g],u.h--)))):u&&(u=it(u))&&(g=u.g[g.toString()],u=-1,g&&(u=Ve(g,x,V,q)),(x=-1<u?g[u]:null)&&Pt(x))}function Pt(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[pe])He(g.i,u);else{var x=u.type,V=u.proxy;g.removeEventListener?g.removeEventListener(x,V,u.capture):g.detachEvent?g.detachEvent(Dt(x),V):g.addListener&&g.removeListener&&g.removeListener(V),(x=it(g))?(He(x,u),x.h==0&&(x.src=null,g[Xe]=null)):be(u)}}}function Dt(u){return u in ve?ve[u]:ve[u]="on"+u}function hn(u,g){if(u.da)u=!0;else{g=new te(g,this);var x=u.listener,V=u.ha||u.src;u.fa&&Pt(u),u=x.call(V,g)}return u}function it(u){return u=u[Xe],u instanceof ke?u:null}var It="__closure_events_fn_"+(1e9*Math.random()>>>0);function St(u){return typeof u=="function"?u:(u[It]||(u[It]=function(g){return u.handleEvent(g)}),u[It])}function ze(){U.call(this),this.i=new ke(this),this.M=this,this.F=null}v(ze,U),ze.prototype[pe]=!0,ze.prototype.removeEventListener=function(u,g,x,V){Ae(this,u,g,x,V)};function je(u,g){var x,V=u.F;if(V)for(x=[];V;V=V.F)x.push(V);if(u=u.M,V=g.type||g,typeof g=="string")g=new X(g,u);else if(g instanceof X)g.target=g.target||u;else{var q=g;g=new X(V,u),I(g,q)}if(q=!0,x)for(var Q=x.length-1;0<=Q;Q--){var ne=g.g=x[Q];q=Vt(ne,V,!0,g)&&q}if(ne=g.g=u,q=Vt(ne,V,!0,g)&&q,q=Vt(ne,V,!1,g)&&q,x)for(Q=0;Q<x.length;Q++)ne=g.g=x[Q],q=Vt(ne,V,!1,g)&&q}ze.prototype.N=function(){if(ze.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var x=u.g[g],V=0;V<x.length;V++)be(x[V]);delete u.g[g],u.h--}}this.F=null},ze.prototype.K=function(u,g,x,V){return this.i.add(String(u),g,!1,x,V)},ze.prototype.L=function(u,g,x,V){return this.i.add(String(u),g,!0,x,V)};function Vt(u,g,x,V){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var q=!0,Q=0;Q<g.length;++Q){var ne=g[Q];if(ne&&!ne.da&&ne.capture==x){var We=ne.listener,Bt=ne.ha||ne.src;ne.fa&&He(u.i,ne),q=We.call(Bt,V)!==!1&&q}}return q&&!V.defaultPrevented}function sn(u,g,x){if(typeof u=="function")x&&(u=f(u,x));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(u,g||0)}function Pr(u){u.g=sn(()=>{u.g=null,u.i&&(u.i=!1,Pr(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class Ue extends U{constructor(g,x){super(),this.m=g,this.l=x,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:Pr(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function _t(u){U.call(this),this.h=u,this.g={}}v(_t,U);var Nn=[];function Pn(u){z(u.g,function(g,x){this.g.hasOwnProperty(x)&&Pt(g)},u),u.g={}}_t.prototype.N=function(){_t.aa.N.call(this),Pn(this)},_t.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Dn=a.JSON.stringify,Vn=a.JSON.parse,fn=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function dr(){}dr.prototype.h=null;function Ot(u){return u.h||(u.h=u.i())}function Xn(){}var hr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Je(){X.call(this,"d")}v(Je,X);function pn(){X.call(this,"c")}v(pn,X);var fr={},Do=null;function ki(){return Do=Do||new ze}fr.La="serverreachability";function Vo(u){X.call(this,fr.La,u)}v(Vo,X);function Jr(u){const g=ki();je(g,new Vo(g))}fr.STAT_EVENT="statevent";function Oo(u,g){X.call(this,fr.STAT_EVENT,u),this.stat=g}v(Oo,X);function Tt(u){const g=ki();je(g,new Oo(g,u))}fr.Ma="timingevent";function Lo(u,g){X.call(this,fr.Ma,u),this.size=g}v(Lo,X);function Jn(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},g)}function Dr(){this.g=!0}Dr.prototype.xa=function(){this.g=!1};function Rl(u,g,x,V,q,Q){u.info(function(){if(u.g)if(Q)for(var ne="",We=Q.split("&"),Bt=0;Bt<We.length;Bt++){var Me=We[Bt].split("=");if(1<Me.length){var Qt=Me[0];Me=Me[1];var Yt=Qt.split("_");ne=2<=Yt.length&&Yt[1]=="type"?ne+(Qt+"="+Me+"&"):ne+(Qt+"=redacted&")}}else ne=null;else ne=Q;return"XMLHTTP REQ ("+V+") [attempt "+q+"]: "+g+`
`+x+`
`+ne})}function kl(u,g,x,V,q,Q,ne){u.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+q+"]: "+g+`
`+x+`
`+Q+" "+ne})}function Vr(u,g,x,V){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+Nl(u,x)+(V?" "+V:"")})}function zo(u,g){u.info(function(){return"TIMEOUT: "+g})}Dr.prototype.info=function(){};function Nl(u,g){if(!u.g)return g;if(!g)return null;try{var x=JSON.parse(g);if(x){for(u=0;u<x.length;u++)if(Array.isArray(x[u])){var V=x[u];if(!(2>V.length)){var q=V[1];if(Array.isArray(q)&&!(1>q.length)){var Q=q[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var ne=1;ne<q.length;ne++)q[ne]=""}}}}return Dn(x)}catch{return g}}var Ni={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},ks={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ns;function On(){}v(On,dr),On.prototype.g=function(){return new XMLHttpRequest},On.prototype.i=function(){return{}},Ns=new On;function Zn(u,g,x,V){this.j=u,this.i=g,this.l=x,this.R=V||1,this.U=new _t(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Mo}function Mo(){this.i=null,this.g="",this.h=!1}var jo={},Ps={};function Ds(u,g,x){u.L=1,u.v=Yu(Lt(g)),u.m=x,u.P=!0,Fo(u,null)}function Fo(u,g){u.F=Date.now(),Pi(u),u.A=Lt(u.v);var x=u.A,V=u.R;Array.isArray(V)||(V=[String(V)]),vw(x.i,"t",V),u.C=0,x=u.j.J,u.h=new Mo,u.g=Lw(u.j,x?g:null,!u.m),0<u.O&&(u.M=new Ue(f(u.Y,u,u.g),u.O)),g=u.U,x=u.g,V=u.ca;var q="readystatechange";Array.isArray(q)||(q&&(Nn[0]=q.toString()),q=Nn);for(var Q=0;Q<q.length;Q++){var ne=mt(x,q[Q],V||g.handleEvent,!1,g.h||g);if(!ne)break;g.g[ne.key]=ne}g=u.H?E(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),Jr(),Rl(u.i,u.u,u.A,u.l,u.R,u.m)}Zn.prototype.ca=function(u){u=u.target;const g=this.M;g&&ti(u)==3?g.j():this.Y(u)},Zn.prototype.Y=function(u){try{if(u==this.g)e:{const Yt=ti(this.g);var g=this.g.Ba();const Qo=this.g.Z();if(!(3>Yt)&&(Yt!=3||this.g&&(this.h.h||this.g.oa()||Sw(this.g)))){this.J||Yt!=4||g==7||(g==8||0>=Qo?Jr(3):Jr(2)),Di(this);var x=this.g.Z();this.X=x;t:if(Vs(this)){var V=Sw(this.g);u="";var q=V.length,Q=ti(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){pr(this),Zr(this);var ne="";break t}this.h.i=new a.TextDecoder}for(g=0;g<q;g++)this.h.h=!0,u+=this.h.i.decode(V[g],{stream:!(Q&&g==q-1)});V.length=0,this.h.g+=u,this.C=0,ne=this.h.g}else ne=this.g.oa();if(this.o=x==200,kl(this.i,this.u,this.A,this.l,this.R,Yt,x),this.o){if(this.T&&!this.K){t:{if(this.g){var We,Bt=this.g;if((We=Bt.g?Bt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(We)){var Me=We;break t}}Me=null}if(x=Me)Vr(this.i,this.l,x,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Or(this,x);else{this.o=!1,this.s=3,Tt(12),pr(this),Zr(this);break e}}if(this.P){x=!0;let mr;for(;!this.J&&this.C<ne.length;)if(mr=Pl(this,ne),mr==Ps){Yt==4&&(this.s=4,Tt(14),x=!1),Vr(this.i,this.l,null,"[Incomplete Response]");break}else if(mr==jo){this.s=4,Tt(15),Vr(this.i,this.l,ne,"[Invalid Chunk]"),x=!1;break}else Vr(this.i,this.l,mr,null),Or(this,mr);if(Vs(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Yt!=4||ne.length!=0||this.h.h||(this.s=1,Tt(16),x=!1),this.o=this.o&&x,!x)Vr(this.i,this.l,ne,"[Invalid Chunked Response]"),pr(this),Zr(this);else if(0<ne.length&&!this.W){this.W=!0;var Qt=this.j;Qt.g==this&&Qt.ba&&!Qt.M&&(Qt.j.info("Great, no buffering proxy detected. Bytes received: "+ne.length),Rp(Qt),Qt.M=!0,Tt(11))}}else Vr(this.i,this.l,ne,null),Or(this,ne);Yt==4&&pr(this),this.o&&!this.J&&(Yt==4?Pw(this.j,this):(this.o=!1,Pi(this)))}else Pk(this.g),x==400&&0<ne.indexOf("Unknown SID")?(this.s=3,Tt(12)):(this.s=0,Tt(13)),pr(this),Zr(this)}}}catch{}finally{}};function Vs(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function Pl(u,g){var x=u.C,V=g.indexOf(`
`,x);return V==-1?Ps:(x=Number(g.substring(x,V)),isNaN(x)?jo:(V+=1,V+x>g.length?Ps:(g=g.slice(V,V+x),u.C=V+x,g)))}Zn.prototype.cancel=function(){this.J=!0,pr(this)};function Pi(u){u.S=Date.now()+u.I,$o(u,u.I)}function $o(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Jn(f(u.ba,u),g)}function Di(u){u.B&&(a.clearTimeout(u.B),u.B=null)}Zn.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(zo(this.i,this.A),this.L!=2&&(Jr(),Tt(17)),pr(this),this.s=2,Zr(this)):$o(this,this.S-u)};function Zr(u){u.j.G==0||u.J||Pw(u.j,u)}function pr(u){Di(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Pn(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function Or(u,g){try{var x=u.j;if(x.G!=0&&(x.g==u||Dl(x.h,u))){if(!u.K&&Dl(x.h,u)&&x.G==3){try{var V=x.Da.g.parse(g)}catch{V=null}if(Array.isArray(V)&&V.length==3){var q=V;if(q[0]==0){e:if(!x.u){if(x.g)if(x.g.F+3e3<u.F)nd(x),ed(x);else break e;Cp(x),Tt(18)}}else x.za=q[1],0<x.za-x.T&&37500>q[2]&&x.F&&x.v==0&&!x.C&&(x.C=Jn(f(x.Za,x),6e3));if(1>=Lr(x.h)&&x.ca){try{x.ca()}catch{}x.ca=void 0}}else Os(x,11)}else if((u.K||x.g==u)&&nd(x),!_(g))for(q=x.Da.g.parse(g),g=0;g<q.length;g++){let Me=q[g];if(x.T=Me[0],Me=Me[1],x.G==2)if(Me[0]=="c"){x.K=Me[1],x.ia=Me[2];const Qt=Me[3];Qt!=null&&(x.la=Qt,x.j.info("VER="+x.la));const Yt=Me[4];Yt!=null&&(x.Aa=Yt,x.j.info("SVER="+x.Aa));const Qo=Me[5];Qo!=null&&typeof Qo=="number"&&0<Qo&&(V=1.5*Qo,x.L=V,x.j.info("backChannelRequestTimeoutMs_="+V)),V=x;const mr=u.g;if(mr){const id=mr.g?mr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(id){var Q=V.h;Q.g||id.indexOf("spdy")==-1&&id.indexOf("quic")==-1&&id.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(Ho(Q,Q.h),Q.h=null))}if(V.D){const kp=mr.g?mr.g.getResponseHeader("X-HTTP-Session-Id"):null;kp&&(V.ya=kp,Ze(V.I,V.D,kp))}}x.G=3,x.l&&x.l.ua(),x.ba&&(x.R=Date.now()-u.F,x.j.info("Handshake RTT: "+x.R+"ms")),V=x;var ne=u;if(V.qa=Ow(V,V.J?V.ia:null,V.W),ne.K){Vl(V.h,ne);var We=ne,Bt=V.L;Bt&&(We.I=Bt),We.B&&(Di(We),Pi(We)),V.g=ne}else kw(V);0<x.i.length&&td(x)}else Me[0]!="stop"&&Me[0]!="close"||Os(x,7);else x.G==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?Os(x,7):Ap(x):Me[0]!="noop"&&x.l&&x.l.ta(Me),x.v=0)}}Jr(4)}catch{}}var Uo=class{constructor(u,g){this.g=u,this.map=g}};function Bo(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function qo(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Lr(u){return u.h?1:u.g?u.g.size:0}function Dl(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Ho(u,g){u.g?u.g.add(g):u.h=g}function Vl(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}Bo.prototype.cancel=function(){if(this.i=Ol(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function Ol(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const x of u.g.values())g=g.concat(x.D);return g}return w(u.i)}function Ee(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var g=[],x=u.length,V=0;V<x;V++)g.push(u[V]);return g}g=[],x=0;for(V in u)g[x++]=u[V];return g}function we(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var g=[];u=u.length;for(var x=0;x<u;x++)g.push(x);return g}g=[],x=0;for(const V in u)g[x++]=V;return g}}}function Fe(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var x=we(u),V=Ee(u),q=V.length,Q=0;Q<q;Q++)g.call(void 0,V[Q],x&&x[Q],u)}var Se=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ce(u,g){if(u){u=u.split("&");for(var x=0;x<u.length;x++){var V=u[x].indexOf("="),q=null;if(0<=V){var Q=u[x].substring(0,V);q=u[x].substring(V+1)}else Q=u[x];g(Q,q?decodeURIComponent(q.replace(/\+/g," ")):"")}}}function ut(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof ut){this.h=u.h,ei(this,u.j),this.o=u.o,this.g=u.g,Ko(this,u.s),this.l=u.l;var g=u.i,x=new Ml;x.i=g.i,g.g&&(x.g=new Map(g.g),x.h=g.h),pw(this,x),this.m=u.m}else u&&(g=String(u).match(Se))?(this.h=!1,ei(this,g[1]||"",!0),this.o=Ll(g[2]||""),this.g=Ll(g[3]||"",!0),Ko(this,g[4]),this.l=Ll(g[5]||"",!0),pw(this,g[6]||"",!0),this.m=Ll(g[7]||"")):(this.h=!1,this.i=new Ml(null,this.h))}ut.prototype.toString=function(){var u=[],g=this.j;g&&u.push(zl(g,mw,!0),":");var x=this.g;return(x||g=="file")&&(u.push("//"),(g=this.o)&&u.push(zl(g,mw,!0),"@"),u.push(encodeURIComponent(String(x)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),x=this.s,x!=null&&u.push(":",String(x))),(x=this.l)&&(this.g&&x.charAt(0)!="/"&&u.push("/"),u.push(zl(x,x.charAt(0)=="/"?bk:xk,!0))),(x=this.i.toString())&&u.push("?",x),(x=this.m)&&u.push("#",zl(x,Ik)),u.join("")};function Lt(u){return new ut(u)}function ei(u,g,x){u.j=x?Ll(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Ko(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function pw(u,g,x){g instanceof Ml?(u.i=g,Sk(u.i,u.h)):(x||(g=zl(g,Ek)),u.i=new Ml(g,u.h))}function Ze(u,g,x){u.i.set(g,x)}function Yu(u){return Ze(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function Ll(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function zl(u,g,x){return typeof u=="string"?(u=encodeURI(u).replace(g,_k),x&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function _k(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var mw=/[#\/\?@]/g,xk=/[#\?:]/g,bk=/[#\?]/g,Ek=/[#\?@]/g,Ik=/#/g;function Ml(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function Vi(u){u.g||(u.g=new Map,u.h=0,u.i&&Ce(u.i,function(g,x){u.add(decodeURIComponent(g.replace(/\+/g," ")),x)}))}t=Ml.prototype,t.add=function(u,g){Vi(this),this.i=null,u=Wo(this,u);var x=this.g.get(u);return x||this.g.set(u,x=[]),x.push(g),this.h+=1,this};function gw(u,g){Vi(u),g=Wo(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function yw(u,g){return Vi(u),g=Wo(u,g),u.g.has(g)}t.forEach=function(u,g){Vi(this),this.g.forEach(function(x,V){x.forEach(function(q){u.call(g,q,V,this)},this)},this)},t.na=function(){Vi(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),x=[];for(let V=0;V<g.length;V++){const q=u[V];for(let Q=0;Q<q.length;Q++)x.push(g[V])}return x},t.V=function(u){Vi(this);let g=[];if(typeof u=="string")yw(this,u)&&(g=g.concat(this.g.get(Wo(this,u))));else{u=Array.from(this.g.values());for(let x=0;x<u.length;x++)g=g.concat(u[x])}return g},t.set=function(u,g){return Vi(this),this.i=null,u=Wo(this,u),yw(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function vw(u,g,x){gw(u,g),0<x.length&&(u.i=null,u.g.set(Wo(u,g),w(x)),u.h+=x.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var x=0;x<g.length;x++){var V=g[x];const Q=encodeURIComponent(String(V)),ne=this.V(V);for(V=0;V<ne.length;V++){var q=Q;ne[V]!==""&&(q+="="+encodeURIComponent(String(ne[V]))),u.push(q)}}return this.i=u.join("&")};function Wo(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function Sk(u,g){g&&!u.j&&(Vi(u),u.i=null,u.g.forEach(function(x,V){var q=V.toLowerCase();V!=q&&(gw(this,V),vw(this,q,x))},u)),u.j=g}function Tk(u,g){const x=new Dr;if(a.Image){const V=new Image;V.onload=m(Oi,x,"TestLoadImage: loaded",!0,g,V),V.onerror=m(Oi,x,"TestLoadImage: error",!1,g,V),V.onabort=m(Oi,x,"TestLoadImage: abort",!1,g,V),V.ontimeout=m(Oi,x,"TestLoadImage: timeout",!1,g,V),a.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=u}else g(!1)}function Ak(u,g){const x=new Dr,V=new AbortController,q=setTimeout(()=>{V.abort(),Oi(x,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:V.signal}).then(Q=>{clearTimeout(q),Q.ok?Oi(x,"TestPingServer: ok",!0,g):Oi(x,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(q),Oi(x,"TestPingServer: error",!1,g)})}function Oi(u,g,x,V,q){try{q&&(q.onload=null,q.onerror=null,q.onabort=null,q.ontimeout=null),V(x)}catch{}}function Ck(){this.g=new fn}function Rk(u,g,x){const V=x||"";try{Fe(u,function(q,Q){let ne=q;c(q)&&(ne=Dn(q)),g.push(V+Q+"="+encodeURIComponent(ne))})}catch(q){throw g.push(V+"type="+encodeURIComponent("_badmap")),q}}function Xu(u){this.l=u.Ub||null,this.j=u.eb||!1}v(Xu,dr),Xu.prototype.g=function(){return new Ju(this.l,this.j)},Xu.prototype.i=function(u){return function(){return u}}({});function Ju(u,g){ze.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}v(Ju,ze),t=Ju.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,Fl(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,jl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Fl(this)),this.g&&(this.readyState=3,Fl(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ww(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function ww(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?jl(this):Fl(this),this.readyState==3&&ww(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,jl(this))},t.Qa=function(u){this.g&&(this.response=u,jl(this))},t.ga=function(){this.g&&jl(this)};function jl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Fl(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var x=g.next();!x.done;)x=x.value,u.push(x[0]+": "+x[1]),x=g.next();return u.join(`\r
`)};function Fl(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Ju.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function _w(u){let g="";return z(u,function(x,V){g+=V,g+=":",g+=x,g+=`\r
`}),g}function Tp(u,g,x){e:{for(V in x){var V=!1;break e}V=!0}V||(x=_w(x),typeof u=="string"?x!=null&&encodeURIComponent(String(x)):Ze(u,g,x))}function dt(u){ze.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}v(dt,ze);var kk=/^https?$/i,Nk=["POST","PUT"];t=dt.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,x,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ns.g(),this.v=this.o?Ot(this.o):Ot(Ns),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(Q){xw(this,Q);return}if(u=x||"",x=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var q in V)x.set(q,V[q]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const Q of V.keys())x.set(Q,V.get(Q));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(x.keys()).find(Q=>Q.toLowerCase()=="content-type"),q=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(Nk,g,void 0))||V||q||x.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,ne]of x)this.g.setRequestHeader(Q,ne);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Iw(this),this.u=!0,this.g.send(u),this.u=!1}catch(Q){xw(this,Q)}};function xw(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,bw(u),Zu(u)}function bw(u){u.A||(u.A=!0,je(u,"complete"),je(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,je(this,"complete"),je(this,"abort"),Zu(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Zu(this,!0)),dt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Ew(this):this.bb())},t.bb=function(){Ew(this)};function Ew(u){if(u.h&&typeof o<"u"&&(!u.v[1]||ti(u)!=4||u.Z()!=2)){if(u.u&&ti(u)==4)sn(u.Ea,0,u);else if(je(u,"readystatechange"),ti(u)==4){u.h=!1;try{const ne=u.Z();e:switch(ne){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var x;if(!(x=g)){var V;if(V=ne===0){var q=String(u.D).match(Se)[1]||null;!q&&a.self&&a.self.location&&(q=a.self.location.protocol.slice(0,-1)),V=!kk.test(q?q.toLowerCase():"")}x=V}if(x)je(u,"complete"),je(u,"success");else{u.m=6;try{var Q=2<ti(u)?u.g.statusText:""}catch{Q=""}u.l=Q+" ["+u.Z()+"]",bw(u)}}finally{Zu(u)}}}}function Zu(u,g){if(u.g){Iw(u);const x=u.g,V=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||je(u,"ready");try{x.onreadystatechange=V}catch{}}}function Iw(u){u.I&&(a.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function ti(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<ti(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),Vn(g)}};function Sw(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function Pk(u){const g={};u=(u.g&&2<=ti(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<u.length;V++){if(_(u[V]))continue;var x=k(u[V]);const q=x[0];if(x=x[1],typeof x!="string")continue;x=x.trim();const Q=g[q]||[];g[q]=Q,Q.push(x)}A(g,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $l(u,g,x){return x&&x.internalChannelParams&&x.internalChannelParams[u]||g}function Tw(u){this.Aa=0,this.i=[],this.j=new Dr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$l("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$l("baseRetryDelayMs",5e3,u),this.cb=$l("retryDelaySeedMs",1e4,u),this.Wa=$l("forwardChannelMaxRetries",2,u),this.wa=$l("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Bo(u&&u.concurrentRequestLimit),this.Da=new Ck,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Tw.prototype,t.la=8,t.G=1,t.connect=function(u,g,x,V){Tt(0),this.W=u,this.H=g||{},x&&V!==void 0&&(this.H.OSID=x,this.H.OAID=V),this.F=this.X,this.I=Ow(this,null,this.W),td(this)};function Ap(u){if(Aw(u),u.G==3){var g=u.U++,x=Lt(u.I);if(Ze(x,"SID",u.K),Ze(x,"RID",g),Ze(x,"TYPE","terminate"),Ul(u,x),g=new Zn(u,u.j,g),g.L=2,g.v=Yu(Lt(x)),x=!1,a.navigator&&a.navigator.sendBeacon)try{x=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!x&&a.Image&&(new Image().src=g.v,x=!0),x||(g.g=Lw(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Pi(g)}Vw(u)}function ed(u){u.g&&(Rp(u),u.g.cancel(),u.g=null)}function Aw(u){ed(u),u.u&&(a.clearTimeout(u.u),u.u=null),nd(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function td(u){if(!qo(u.h)&&!u.s){u.s=!0;var g=u.Ga;$||B(),j||($(),j=!0),M.add(g,u),u.B=0}}function Dk(u,g){return Lr(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Jn(f(u.Ga,u,g),Dw(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const q=new Zn(this,this.j,u);let Q=this.o;if(this.S&&(Q?(Q=E(Q),I(Q,this.S)):Q=this.S),this.m!==null||this.O||(q.H=Q,Q=null),this.P)e:{for(var g=0,x=0;x<this.i.length;x++){t:{var V=this.i[x];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(g+=V,4096<g){g=x;break e}if(g===4096||x===this.i.length-1){g=x+1;break e}}g=1e3}else g=1e3;g=Rw(this,q,g),x=Lt(this.I),Ze(x,"RID",u),Ze(x,"CVER",22),this.D&&Ze(x,"X-HTTP-Session-Id",this.D),Ul(this,x),Q&&(this.O?g="headers="+encodeURIComponent(String(_w(Q)))+"&"+g:this.m&&Tp(x,this.m,Q)),Ho(this.h,q),this.Ua&&Ze(x,"TYPE","init"),this.P?(Ze(x,"$req",g),Ze(x,"SID","null"),q.T=!0,Ds(q,x,null)):Ds(q,x,g),this.G=2}}else this.G==3&&(u?Cw(this,u):this.i.length==0||qo(this.h)||Cw(this))};function Cw(u,g){var x;g?x=g.l:x=u.U++;const V=Lt(u.I);Ze(V,"SID",u.K),Ze(V,"RID",x),Ze(V,"AID",u.T),Ul(u,V),u.m&&u.o&&Tp(V,u.m,u.o),x=new Zn(u,u.j,x,u.B+1),u.m===null&&(x.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Rw(u,x,1e3),x.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Ho(u.h,x),Ds(x,V,g)}function Ul(u,g){u.H&&z(u.H,function(x,V){Ze(g,V,x)}),u.l&&Fe({},function(x,V){Ze(g,V,x)})}function Rw(u,g,x){x=Math.min(u.i.length,x);var V=u.l?f(u.l.Na,u.l,u):null;e:{var q=u.i;let Q=-1;for(;;){const ne=["count="+x];Q==-1?0<x?(Q=q[0].g,ne.push("ofs="+Q)):Q=0:ne.push("ofs="+Q);let We=!0;for(let Bt=0;Bt<x;Bt++){let Me=q[Bt].g;const Qt=q[Bt].map;if(Me-=Q,0>Me)Q=Math.max(0,q[Bt].g-100),We=!1;else try{Rk(Qt,ne,"req"+Me+"_")}catch{V&&V(Qt)}}if(We){V=ne.join("&");break e}}}return u=u.i.splice(0,x),g.D=u,V}function kw(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;$||B(),j||($(),j=!0),M.add(g,u),u.v=0}}function Cp(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Jn(f(u.Fa,u),Dw(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Nw(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Jn(f(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Tt(10),ed(this),Nw(this))};function Rp(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Nw(u){u.g=new Zn(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Lt(u.qa);Ze(g,"RID","rpc"),Ze(g,"SID",u.K),Ze(g,"AID",u.T),Ze(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Ze(g,"TO",u.ja),Ze(g,"TYPE","xmlhttp"),Ul(u,g),u.m&&u.o&&Tp(g,u.m,u.o),u.L&&(u.g.I=u.L);var x=u.g;u=u.ia,x.L=1,x.v=Yu(Lt(g)),x.m=null,x.P=!0,Fo(x,u)}t.Za=function(){this.C!=null&&(this.C=null,ed(this),Cp(this),Tt(19))};function nd(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Pw(u,g){var x=null;if(u.g==g){nd(u),Rp(u),u.g=null;var V=2}else if(Dl(u.h,g))x=g.D,Vl(u.h,g),V=1;else return;if(u.G!=0){if(g.o)if(V==1){x=g.m?g.m.length:0,g=Date.now()-g.F;var q=u.B;V=ki(),je(V,new Lo(V,x)),td(u)}else kw(u);else if(q=g.s,q==3||q==0&&0<g.X||!(V==1&&Dk(u,g)||V==2&&Cp(u)))switch(x&&0<x.length&&(g=u.h,g.i=g.i.concat(x)),q){case 1:Os(u,5);break;case 4:Os(u,10);break;case 3:Os(u,6);break;default:Os(u,2)}}}function Dw(u,g){let x=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(x*=2),x*g}function Os(u,g){if(u.j.info("Error code "+g),g==2){var x=f(u.fb,u),V=u.Xa;const q=!V;V=new ut(V||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||ei(V,"https"),Yu(V),q?Tk(V.toString(),x):Ak(V.toString(),x)}else Tt(2);u.G=0,u.l&&u.l.sa(g),Vw(u),Aw(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),Tt(2)):(this.j.info("Failed to ping google.com"),Tt(1))};function Vw(u){if(u.G=0,u.ka=[],u.l){const g=Ol(u.h);(g.length!=0||u.i.length!=0)&&(T(u.ka,g),T(u.ka,u.i),u.h.i.length=0,w(u.i),u.i.length=0),u.l.ra()}}function Ow(u,g,x){var V=x instanceof ut?Lt(x):new ut(x);if(V.g!="")g&&(V.g=g+"."+V.g),Ko(V,V.s);else{var q=a.location;V=q.protocol,g=g?g+"."+q.hostname:q.hostname,q=+q.port;var Q=new ut(null);V&&ei(Q,V),g&&(Q.g=g),q&&Ko(Q,q),x&&(Q.l=x),V=Q}return x=u.D,g=u.ya,x&&g&&Ze(V,x,g),Ze(V,"VER",u.la),Ul(u,V),V}function Lw(u,g,x){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new dt(new Xu({eb:x})):new dt(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function zw(){}t=zw.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function rd(){}rd.prototype.g=function(u,g){return new Ln(u,g)};function Ln(u,g){ze.call(this),this.g=new Tw(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!_(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!_(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new Go(this)}v(Ln,ze),Ln.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ln.prototype.close=function(){Ap(this.g)},Ln.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var x={};x.__data__=u,u=x}else this.u&&(x={},x.__data__=Dn(u),u=x);g.i.push(new Uo(g.Ya++,u)),g.G==3&&td(g)},Ln.prototype.N=function(){this.g.l=null,delete this.j,Ap(this.g),delete this.g,Ln.aa.N.call(this)};function Mw(u){Je.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const x in g){u=x;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}v(Mw,Je);function jw(){pn.call(this),this.status=1}v(jw,pn);function Go(u){this.g=u}v(Go,zw),Go.prototype.ua=function(){je(this.g,"a")},Go.prototype.ta=function(u){je(this.g,new Mw(u))},Go.prototype.sa=function(u){je(this.g,new jw)},Go.prototype.ra=function(){je(this.g,"b")},rd.prototype.createWebChannel=rd.prototype.g,Ln.prototype.send=Ln.prototype.o,Ln.prototype.open=Ln.prototype.m,Ln.prototype.close=Ln.prototype.close,SA=function(){return new rd},IA=function(){return ki()},EA=fr,i0={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ni.NO_ERROR=0,Ni.TIMEOUT=8,Ni.HTTP_ERROR=6,ch=Ni,ks.COMPLETE="complete",bA=ks,Xn.EventType=hr,hr.OPEN="a",hr.CLOSE="b",hr.ERROR="c",hr.MESSAGE="d",ze.prototype.listen=ze.prototype.K,yc=Xn,dt.prototype.listenOnce=dt.prototype.L,dt.prototype.getLastError=dt.prototype.Ka,dt.prototype.getLastErrorCode=dt.prototype.Ba,dt.prototype.getStatus=dt.prototype.Z,dt.prototype.getResponseJson=dt.prototype.Oa,dt.prototype.getResponseText=dt.prototype.oa,dt.prototype.send=dt.prototype.ea,dt.prototype.setWithCredentials=dt.prototype.Ha,xA=dt}).apply(typeof Od<"u"?Od:typeof self<"u"?self:typeof window<"u"?window:{});const R1="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class en{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}en.UNAUTHENTICATED=new en(null),en.GOOGLE_CREDENTIALS=new en("google-credentials-uid"),en.FIRST_PARTY=new en("first-party-uid"),en.MOCK_USER=new en("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yo=new Zf("@firebase/firestore");function la(){return yo.logLevel}function Z(t,...e){if(yo.logLevel<=Pe.DEBUG){const n=e.map(fv);yo.debug(`Firestore (${bl}): ${t}`,...n)}}function yt(t,...e){if(yo.logLevel<=Pe.ERROR){const n=e.map(fv);yo.error(`Firestore (${bl}): ${t}`,...n)}}function pu(t,...e){if(yo.logLevel<=Pe.WARN){const n=e.map(fv);yo.warn(`Firestore (${bl}): ${t}`,...n)}}function fv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t="Unexpected state"){const e=`FIRESTORE (${bl}) INTERNAL ASSERTION FAILED: `+t;throw yt(e),new Error(e)}function fe(t,e){t||ue()}function he(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class re extends kr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X9{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class J9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(en.UNAUTHENTICATED))}shutdown(){}}class Z9{constructor(e){this.t=e,this.currentUser=en.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){fe(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Kr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Kr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{Z("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(Z("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Kr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Z("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(fe(typeof r.accessToken=="string"),new X9(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return fe(e===null||typeof e=="string"),new en(e)}}class e${constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=en.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class t${constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new e$(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(en.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class n${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class r${constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){fe(this.o===void 0);const r=s=>{s.error!=null&&Z("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,Z("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Z("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):Z("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(fe(typeof n.token=="string"),this.R=n.token,new n$(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i$(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TA{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=i$(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function _e(t,e){return t<e?-1:t>e?1:0}function Za(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function AA(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new re(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new re(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new re(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new re(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return lt.fromMillis(Date.now())}static fromDate(e){return lt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new lt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?_e(this.nanoseconds,e.nanoseconds):_e(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.timestamp=e}static fromTimestamp(e){return new me(e)}static min(){return new me(new lt(0,0))}static max(){return new me(new lt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,n,r){n===void 0?n=0:n>e.length&&ue(),r===void 0?r=e.length-n:r>e.length-n&&ue(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return mu.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof mu?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class $e extends mu{construct(e,n,r){return new $e(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new re(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new $e(n)}static emptyPath(){return new $e([])}}const s$=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ot extends mu{construct(e,n,r){return new ot(e,n,r)}static isValidIdentifier(e){return s$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ot.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ot(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new re(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new re(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new re(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new re(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ot(n)}static emptyPath(){return new ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ie{constructor(e){this.path=e}static fromPath(e){return new ie($e.fromString(e))}static fromName(e){return new ie($e.fromString(e).popFirst(5))}static empty(){return new ie($e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return $e.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ie(new $e(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function s0(t){return t.fields.find(e=>e.kind===2)}function $s(t){return t.fields.filter(e=>e.kind!==2)}uf.UNKNOWN_ID=-1;class uh{constructor(e,n){this.fieldPath=e,this.kind=n}}class gu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new gu(0,Gn.min())}}function CA(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=me.fromTimestamp(r===1e9?new lt(n+1,0):new lt(n,r));return new Gn(i,ie.empty(),e)}function RA(t){return new Gn(t.readTime,t.key,-1)}class Gn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Gn(me.min(),ie.empty(),-1)}static max(){return new Gn(me.max(),ie.empty(),-1)}}function pv(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=ie.comparator(t.documentKey,e.documentKey),n!==0?n:_e(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kA="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class NA{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ss(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==kA)throw t;Z("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ue(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new H((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof H?n:H.resolve(n)}catch(n){return H.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):H.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):H.reject(n)}static resolve(e){return new H((n,r)=>{n(e)})}static reject(e){return new H((n,r)=>{r(e)})}static waitFor(e){return new H((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=H.resolve(!1);for(const r of e)n=n.next(i=>i?H.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new H((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(d=>{o[c]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new H((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rp{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Kr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Pc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=mv(r.target.error);this.V.reject(new Pc(e,i))}}static open(e,n,r,i){try{return new rp(n,e.transaction(i,r))}catch(s){throw new Pc(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Z("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new a$(n)}}class fs{constructor(e,n,r){this.name=e,this.version=n,this.p=r,fs.S(Rt())===12.2&&yt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Z("SimpleDb","Removing database:",e),Us(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!ev())return!1;if(fs.v())return!0;const e=Rt(),n=fs.S(e),r=0<n&&n<10,i=PA(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(Z("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new Pc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new re(Y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new re(Y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new Pc(e,o))},i.onupgradeneeded=s=>{Z("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{Z("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=rp.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),H.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(Z("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function PA(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class o${constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Us(this.B.delete())}}class Pc extends re{constructor(e,n){super(Y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Ts(t){return t.name==="IndexedDbTransactionError"}class a${constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Z("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(Z("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Us(r)}add(e){return Z("SimpleDb","ADD",this.store.name,e,e),Us(this.store.add(e))}get(e){return Us(this.store.get(e)).next(n=>(n===void 0&&(n=null),Z("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return Z("SimpleDb","DELETE",this.store.name,e),Us(this.store.delete(e))}count(){return Z("SimpleDb","COUNT",this.store.name),Us(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new H((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new H((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){Z("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new H((r,i)=>{n.onerror=s=>{const o=mv(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new H((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new o$(a),c=n(a.primaryKey,a.value,l);if(c instanceof H){const d=c.catch(h=>(l.done(),H.reject(h)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>H.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Us(t){return new H((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=mv(r.target.error);n(i)}})}let k1=!1;function mv(t){const e=fs.S(Rt());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new re("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return k1||(k1=!0,setTimeout(()=>{throw r},0)),r}}return t}class l${constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){Z("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{Z("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Ts(n)?Z("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Ss(n)}await this.X(6e4)})}}class c${constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return H.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Z("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(Z("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=RA(s);pv(o,r)>0&&(r=o)}),new Gn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _n{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}_n.oe=-1;function ip(t){return t==null}function yu(t){return t===0&&1/t==-1/0}function DA(t){return typeof t=="number"&&Number.isInteger(t)&&!yu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ln(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=N1(e)),e=u$(t.get(n),e);return N1(e)}function u$(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function N1(t){return t+""}function Fr(t){const e=t.length;if(fe(e>=2),e===2)return fe(t.charAt(0)===""&&t.charAt(1)===""),$e.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&ue(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:ue()}s=o+2}return new $e(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P1=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dh(t,e){return[t,ln(e)]}function VA(t,e,n){return[t,ln(e),n]}const d$={},h$=["prefixPath","collectionGroup","readTime","documentId"],f$=["prefixPath","collectionGroup","documentId"],p$=["collectionGroup","readTime","prefixPath","documentId"],m$=["canonicalId","targetId"],g$=["targetId","path"],y$=["path","targetId"],v$=["collectionId","parent"],w$=["indexId","uid"],_$=["uid","sequenceNumber"],x$=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],b$=["indexId","uid","orderedDocumentKey"],E$=["userId","collectionPath","documentId"],I$=["userId","collectionPath","largestBatchId"],S$=["userId","collectionGroup","largestBatchId"],OA=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],T$=[...OA,"documentOverlays"],LA=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],zA=LA,gv=[...zA,"indexConfiguration","indexState","indexEntries"],A$=gv,C$=[...gv,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0 extends NA{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Nt(t,e){const n=he(t);return fs.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D1(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function El(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function MA(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ye{constructor(e,n){this.comparator=e,this.root=n||Kt.EMPTY}insert(e,n){return new Ye(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Kt.BLACK,null,null))}remove(e){return new Ye(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Kt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ld(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ld(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ld(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ld(this.root,e,this.comparator,!0)}}class Ld{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Kt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Kt.RED,this.left=i??Kt.EMPTY,this.right=s??Kt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Kt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Kt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Kt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Kt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Kt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ue();const e=this.left.check();if(e!==this.right.check())throw ue();return e+(this.isRed()?0:1)}}Kt.EMPTY=null,Kt.RED=!0,Kt.BLACK=!1;Kt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue()}get value(){throw ue()}get color(){throw ue()}get left(){throw ue()}get right(){throw ue()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Kt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ke{constructor(e){this.comparator=e,this.data=new Ye(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new V1(this.data.getIterator())}getIteratorFrom(e){return new V1(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ke)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ke(this.comparator);return n.data=e,n}}class V1{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ia(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e){this.fields=e,e.sort(ot.comparator)}static empty(){return new sr([])}unionWith(e){let n=new Ke(ot.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new sr(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Za(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new jA("Invalid base64 string: "+s):s}}(e);return new vt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new vt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return _e(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vt.EMPTY_BYTE_STRING=new vt("");const R$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ti(t){if(fe(!!t),typeof t=="string"){let e=0;const n=R$.exec(t);if(fe(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function vs(t){return typeof t=="string"?vt.fromBase64String(t):vt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function vv(t){const e=t.mapValue.fields.__previous_value__;return yv(e)?vv(e):e}function vu(t){const e=Ti(t.mapValue.fields.__local_write_time__.timestampValue);return new lt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k${constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class vo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new vo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof vo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const es={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},hh={nullValue:"NULL_VALUE"};function wo(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?yv(t)?4:FA(t)?9007199254740991:sp(t)?10:11:ue()}function Gr(t,e){if(t===e)return!0;const n=wo(t);if(n!==wo(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return vu(t).isEqual(vu(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Ti(i.timestampValue),a=Ti(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return vs(i.bytesValue).isEqual(vs(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return nt(i.geoPointValue.latitude)===nt(s.geoPointValue.latitude)&&nt(i.geoPointValue.longitude)===nt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return nt(i.integerValue)===nt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=nt(i.doubleValue),a=nt(s.doubleValue);return o===a?yu(o)===yu(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Za(t.arrayValue.values||[],e.arrayValue.values||[],Gr);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(D1(o)!==D1(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Gr(o[l],a[l])))return!1;return!0}(t,e);default:return ue()}}function wu(t,e){return(t.values||[]).find(n=>Gr(n,e))!==void 0}function ws(t,e){if(t===e)return 0;const n=wo(t),r=wo(e);if(n!==r)return _e(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return _e(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=nt(s.integerValue||s.doubleValue),l=nt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return O1(t.timestampValue,e.timestampValue);case 4:return O1(vu(t),vu(e));case 5:return _e(t.stringValue,e.stringValue);case 6:return function(s,o){const a=vs(s),l=vs(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=_e(a[c],l[c]);if(d!==0)return d}return _e(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=_e(nt(s.latitude),nt(o.latitude));return a!==0?a:_e(nt(s.longitude),nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return L1(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,d;const h=s.fields||{},f=o.fields||{},m=(a=h.value)===null||a===void 0?void 0:a.arrayValue,v=(l=f.value)===null||l===void 0?void 0:l.arrayValue,w=_e(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((d=v==null?void 0:v.values)===null||d===void 0?void 0:d.length)||0);return w!==0?w:L1(m,v)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===es.mapValue&&o===es.mapValue)return 0;if(s===es.mapValue)return 1;if(o===es.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const f=_e(l[h],d[h]);if(f!==0)return f;const m=ws(a[l[h]],c[d[h]]);if(m!==0)return m}return _e(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ue()}}function O1(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return _e(t,e);const n=Ti(t),r=Ti(e),i=_e(n.seconds,r.seconds);return i!==0?i:_e(n.nanos,r.nanos)}function L1(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ws(n[i],r[i]);if(s)return s}return _e(n.length,r.length)}function el(t){return a0(t)}function a0(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ti(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return vs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return ie.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=a0(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${a0(n.fields[o])}`;return i+"}"}(t.mapValue):ue()}function _u(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function l0(t){return!!t&&"integerValue"in t}function xu(t){return!!t&&"arrayValue"in t}function z1(t){return!!t&&"nullValue"in t}function M1(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function fh(t){return!!t&&"mapValue"in t}function sp(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Dc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return El(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Dc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Dc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function FA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const $A={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function N$(t){return"nullValue"in t?hh:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?_u(vo.empty(),ie.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?sp(t)?$A:{mapValue:{}}:ue()}function P$(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?_u(vo.empty(),ie.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?$A:"mapValue"in t?sp(t)?{mapValue:{}}:es:ue()}function j1(t,e){const n=ws(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function F1(t,e){const n=ws(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yn{constructor(e){this.value=e}static empty(){return new yn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!fh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Dc(n)}setAll(e){let n=ot.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=Dc(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());fh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Gr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];fh(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){El(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new yn(Dc(this.value))}}function UA(t){const e=[];return El(t.fields,(n,r)=>{const i=new ot([n]);if(fh(r)){const s=UA(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new sr(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ft{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new ft(e,0,me.min(),me.min(),me.min(),yn.empty(),0)}static newFoundDocument(e,n,r,i){return new ft(e,1,n,me.min(),r,i,0)}static newNoDocument(e,n){return new ft(e,2,n,me.min(),me.min(),yn.empty(),0)}static newUnknownDocument(e,n){return new ft(e,3,n,me.min(),me.min(),yn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(me.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=yn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=yn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=me.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ft&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ft(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl{constructor(e,n){this.position=e,this.inclusive=n}}function $1(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=ie.comparator(ie.fromName(o.referenceValue),n.key):r=ws(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function U1(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Gr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class df{constructor(e,n="asc"){this.field=e,this.dir=n}}function D$(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BA{}class De extends BA{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new V$(e,n,r):n==="array-contains"?new z$(e,r):n==="in"?new QA(e,r):n==="not-in"?new M$(e,r):n==="array-contains-any"?new j$(e,r):new De(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new O$(e,r):new L$(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ws(n,this.value)):n!==null&&wo(this.value)===wo(n)&&this.matchesComparison(ws(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Be extends BA{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Be(e,n)}matches(e){return nl(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function nl(t){return t.op==="and"}function c0(t){return t.op==="or"}function wv(t){return qA(t)&&nl(t)}function qA(t){for(const e of t.filters)if(e instanceof Be)return!1;return!0}function u0(t){if(t instanceof De)return t.field.canonicalString()+t.op.toString()+el(t.value);if(wv(t))return t.filters.map(e=>u0(e)).join(",");{const e=t.filters.map(n=>u0(n)).join(",");return`${t.op}(${e})`}}function HA(t,e){return t instanceof De?function(r,i){return i instanceof De&&r.op===i.op&&r.field.isEqual(i.field)&&Gr(r.value,i.value)}(t,e):t instanceof Be?function(r,i){return i instanceof Be&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&HA(o,i.filters[a]),!0):!1}(t,e):void ue()}function KA(t,e){const n=t.filters.concat(e);return Be.create(n,t.op)}function WA(t){return t instanceof De?function(n){return`${n.field.canonicalString()} ${n.op} ${el(n.value)}`}(t):t instanceof Be?function(n){return n.op.toString()+" {"+n.getFilters().map(WA).join(" ,")+"}"}(t):"Filter"}class V$ extends De{constructor(e,n,r){super(e,n,r),this.key=ie.fromName(r.referenceValue)}matches(e){const n=ie.comparator(e.key,this.key);return this.matchesComparison(n)}}class O$ extends De{constructor(e,n){super(e,"in",n),this.keys=GA("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class L$ extends De{constructor(e,n){super(e,"not-in",n),this.keys=GA("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function GA(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>ie.fromName(r.referenceValue))}class z$ extends De{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return xu(n)&&wu(n.arrayValue,this.value)}}class QA extends De{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&wu(this.value.arrayValue,n)}}class M$ extends De{constructor(e,n){super(e,"not-in",n)}matches(e){if(wu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!wu(this.value.arrayValue,n)}}class j$ extends De{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!xu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>wu(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F${constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function d0(t,e=null,n=[],r=[],i=null,s=null,o=null){return new F$(t,e,n,r,i,s,o)}function _o(t){const e=he(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>u0(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),ip(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>el(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>el(r)).join(",")),e.ue=n}return e.ue}function Mu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!D$(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!HA(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!U1(t.startAt,e.startAt)&&U1(t.endAt,e.endAt)}function hf(t){return ie.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function ff(t,e){return t.filters.filter(n=>n instanceof De&&n.field.isEqual(e))}function B1(t,e,n){let r=hh,i=!0;for(const s of ff(t,e)){let o=hh,a=!0;switch(s.op){case"<":case"<=":o=N$(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=hh}j1({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];j1({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function q1(t,e,n){let r=es,i=!0;for(const s of ff(t,e)){let o=es,a=!0;switch(s.op){case">=":case">":o=P$(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=es}F1({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];F1({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function YA(t,e,n,r,i,s,o,a){return new ju(t,e,n,r,i,s,o,a)}function op(t){return new ju(t)}function H1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function XA(t){return t.collectionGroup!==null}function Vc(t){const e=he(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ke(ot.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new df(s,r))}),n.has(ot.keyField().canonicalString())||e.ce.push(new df(ot.keyField(),r))}return e.ce}function qn(t){const e=he(t);return e.le||(e.le=$$(e,Vc(t))),e.le}function $$(t,e){if(t.limitType==="F")return d0(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new df(i.field,s)});const n=t.endAt?new tl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new tl(t.startAt.position,t.startAt.inclusive):null;return d0(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function h0(t,e){const n=t.filters.concat([e]);return new ju(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function f0(t,e,n){return new ju(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function ap(t,e){return Mu(qn(t),qn(e))&&t.limitType===e.limitType}function JA(t){return`${_o(qn(t))}|lt:${t.limitType}`}function ca(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>WA(i)).join(", ")}]`),ip(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>el(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>el(i)).join(",")),`Target(${r})`}(qn(t))}; limitType=${t.limitType})`}function Fu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):ie.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of Vc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=$1(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,Vc(r),i)||r.endAt&&!function(o,a,l){const c=$1(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,Vc(r),i))}(t,e)}function ZA(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function eC(t){return(e,n)=>{let r=!1;for(const i of Vc(t)){const s=U$(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function U$(t,e,n){const r=t.field.isKeyField()?ie.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ws(l,c):ue()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ue()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class As{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){El(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return MA(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B$=new Ye(ie.comparator);function Un(){return B$}const tC=new Ye(ie.comparator);function vc(...t){let e=tC;for(const n of t)e=e.insert(n.key,n);return e}function nC(t){let e=tC;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function $r(){return Oc()}function rC(){return Oc()}function Oc(){return new As(t=>t.toString(),(t,e)=>t.isEqual(e))}const q$=new Ye(ie.comparator),H$=new Ke(ie.comparator);function Ie(...t){let e=H$;for(const n of t)e=e.add(n);return e}const K$=new Ke(_e);function _v(){return K$}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xv(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yu(e)?"-0":e}}function iC(t){return{integerValue:""+t}}function W$(t,e){return DA(e)?iC(e):xv(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lp{constructor(){this._=void 0}}function G$(t,e,n){return t instanceof rl?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&yv(s)&&(s=vv(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof il?oC(t,e):t instanceof sl?aC(t,e):function(i,s){const o=sC(i,s),a=K1(o)+K1(i.Pe);return l0(o)&&l0(i.Pe)?iC(a):xv(i.serializer,a)}(t,e)}function Q$(t,e,n){return t instanceof il?oC(t,e):t instanceof sl?aC(t,e):n}function sC(t,e){return t instanceof bu?function(r){return l0(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class rl extends lp{}class il extends lp{constructor(e){super(),this.elements=e}}function oC(t,e){const n=lC(e);for(const r of t.elements)n.some(i=>Gr(i,r))||n.push(r);return{arrayValue:{values:n}}}class sl extends lp{constructor(e){super(),this.elements=e}}function aC(t,e){let n=lC(e);for(const r of t.elements)n=n.filter(i=>!Gr(i,r));return{arrayValue:{values:n}}}class bu extends lp{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function K1(t){return nt(t.integerValue||t.doubleValue)}function lC(t){return xu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e,n){this.field=e,this.transform=n}}function Y$(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof il&&i instanceof il||r instanceof sl&&i instanceof sl?Za(r.elements,i.elements,Gr):r instanceof bu&&i instanceof bu?Gr(r.Pe,i.Pe):r instanceof rl&&i instanceof rl}(t.transform,e.transform)}class X${constructor(e,n){this.version=e,this.transformResults=n}}class xn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new xn}static exists(e){return new xn(void 0,e)}static updateTime(e){return new xn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ph(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class cp{}function uC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new up(t.key,xn.none()):new Il(t.key,t.data,xn.none());{const n=t.data,r=yn.empty();let i=new Ke(ot.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Cs(t.key,r,new sr(i.toArray()),xn.none())}}function J$(t,e,n){t instanceof Il?function(i,s,o){const a=i.value.clone(),l=G1(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof Cs?function(i,s,o){if(!ph(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=G1(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(dC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Lc(t,e,n,r){return t instanceof Il?function(s,o,a,l){if(!ph(s.precondition,o))return a;const c=s.value.clone(),d=Q1(s.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof Cs?function(s,o,a,l){if(!ph(s.precondition,o))return a;const c=Q1(s.fieldTransforms,l,o),d=o.data;return d.setAll(dC(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return ph(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function Z$(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=sC(r.transform,i||null);s!=null&&(n===null&&(n=yn.empty()),n.set(r.field,s))}return n||null}function W1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Za(r,i,(s,o)=>Y$(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Il extends cp{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Cs extends cp{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function dC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function G1(t,e,n){const r=new Map;fe(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,Q$(o,a,n[i]))}return r}function Q1(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,G$(s,o,e))}return r}class up extends cp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class hC extends cp{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bv{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&J$(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Lc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Lc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=rC();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=uC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(me.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Ie())}isEqual(e){return this.batchId===e.batchId&&Za(this.mutations,e.mutations,(n,r)=>W1(n,r))&&Za(this.baseMutations,e.baseMutations,(n,r)=>W1(n,r))}}class Ev{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){fe(e.mutations.length===r.length);let i=function(){return q$}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Ev(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eU{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xt,Oe;function tU(t){switch(t){default:return ue();case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0}}function fC(t){if(t===void 0)return yt("GRPC error has no .code"),Y.UNKNOWN;switch(t){case xt.OK:return Y.OK;case xt.CANCELLED:return Y.CANCELLED;case xt.UNKNOWN:return Y.UNKNOWN;case xt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case xt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case xt.INTERNAL:return Y.INTERNAL;case xt.UNAVAILABLE:return Y.UNAVAILABLE;case xt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case xt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case xt.NOT_FOUND:return Y.NOT_FOUND;case xt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case xt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case xt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case xt.ABORTED:return Y.ABORTED;case xt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case xt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case xt.DATA_LOSS:return Y.DATA_LOSS;default:return ue()}}(Oe=xt||(xt={}))[Oe.OK=0]="OK",Oe[Oe.CANCELLED=1]="CANCELLED",Oe[Oe.UNKNOWN=2]="UNKNOWN",Oe[Oe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Oe[Oe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Oe[Oe.NOT_FOUND=5]="NOT_FOUND",Oe[Oe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Oe[Oe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Oe[Oe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Oe[Oe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Oe[Oe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Oe[Oe.ABORTED=10]="ABORTED",Oe[Oe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Oe[Oe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Oe[Oe.INTERNAL=13]="INTERNAL",Oe[Oe.UNAVAILABLE=14]="UNAVAILABLE",Oe[Oe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nU(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rU=new io([4294967295,4294967295],0);function Y1(t){const e=nU().encode(t),n=new _A;return n.update(e),new Uint8Array(n.digest())}function X1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new io([n,r],0),new io([i,s],0)]}class Sv{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new wc(`Invalid padding: ${n}`);if(r<0)throw new wc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new wc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new wc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=io.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(io.fromNumber(r)));return i.compare(rU)===1&&(i=new io([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Y1(e),[r,i]=X1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Sv(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=Y1(e),[r,i]=X1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class wc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,Uu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new $u(me.min(),i,new Ye(_e),Un(),Ie())}}class Uu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Uu(r,n,Ie(),Ie(),Ie())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mh{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class pC{constructor(e,n){this.targetId=e,this.me=n}}class mC{constructor(e,n,r=vt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class J1{constructor(){this.fe=0,this.ge=eb(),this.pe=vt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ie(),n=Ie(),r=Ie();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ue()}}),new Uu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=eb()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,fe(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class iU{constructor(e){this.Le=e,this.Be=new Map,this.ke=Un(),this.qe=Z1(),this.Qe=new Ye(_e)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ue()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(hf(s))if(r===0){const o=new ie(s.path);this.Ue(n,o,ft.newNoDocument(o,me.min()))}else fe(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=vs(r).toUint8Array()}catch(l){if(l instanceof jA)return pu("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Sv(o,i,s)}catch(l){return pu(l instanceof wc?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&hf(a.target)){const l=new ie(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,ft.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=Ie();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new $u(e,n,this.Qe,this.ke,r);return this.ke=Un(),this.qe=Z1(),this.Qe=new Ye(_e),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new J1,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ke(_e),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||Z("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new J1),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function Z1(){return new Ye(ie.comparator)}function eb(){return new Ye(ie.comparator)}const sU={asc:"ASCENDING",desc:"DESCENDING"},oU={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},aU={and:"AND",or:"OR"};class lU{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function p0(t,e){return t.useProto3Json||ip(e)?e:{value:e}}function ol(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function gC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function cU(t,e){return ol(t,e.toTimestamp())}function cn(t){return fe(!!t),me.fromTimestamp(function(n){const r=Ti(n);return new lt(r.seconds,r.nanos)}(t))}function Tv(t,e){return m0(t,e).canonicalString()}function m0(t,e){const n=function(i){return new $e(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function yC(t){const e=$e.fromString(t);return fe(TC(e)),e}function pf(t,e){return Tv(t.databaseId,e.path)}function so(t,e){const n=yC(e);if(n.get(1)!==t.databaseId.projectId)throw new re(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new re(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new ie(_C(n))}function vC(t,e){return Tv(t.databaseId,e)}function wC(t){const e=yC(t);return e.length===4?$e.emptyPath():_C(e)}function g0(t){return new $e(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function _C(t){return fe(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function tb(t,e,n){return{name:pf(t,e),fields:n.value.mapValue.fields}}function uU(t,e,n){const r=so(t,e.name),i=cn(e.updateTime),s=e.createTime?cn(e.createTime):me.min(),o=new yn({mapValue:{fields:e.fields}}),a=ft.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function dU(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ue()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(fe(d===void 0||typeof d=="string"),vt.fromBase64String(d||"")):(fe(d===void 0||d instanceof Buffer||d instanceof Uint8Array),vt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?Y.UNKNOWN:fC(c.code);return new re(d,c.message||"")}(o);n=new mC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=so(t,r.document.name),s=cn(r.document.updateTime),o=r.document.createTime?cn(r.document.createTime):me.min(),a=new yn({mapValue:{fields:r.document.fields}}),l=ft.newFoundDocument(i,s,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new mh(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=so(t,r.document),s=r.readTime?cn(r.readTime):me.min(),o=ft.newNoDocument(i,s),a=r.removedTargetIds||[];n=new mh([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=so(t,r.document),s=r.removedTargetIds||[];n=new mh([],s,i,null)}else{if(!("filter"in e))return ue();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new eU(i,s),a=r.targetId;n=new pC(a,o)}}return n}function mf(t,e){let n;if(e instanceof Il)n={update:tb(t,e.key,e.value)};else if(e instanceof up)n={delete:pf(t,e.key)};else if(e instanceof Cs)n={update:tb(t,e.key,e.data),updateMask:yU(e.fieldMask)};else{if(!(e instanceof hC))return ue();n={verify:pf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof rl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof il)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof sl)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof bu)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ue()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:cU(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ue()}(t,e.precondition)),n}function y0(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?xn.updateTime(cn(s.updateTime)):s.exists!==void 0?xn.exists(s.exists):xn.none()}(e.currentDocument):xn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)fe(a.setToServerValue==="REQUEST_TIME"),l=new rl;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new il(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new sl(d)}else"increment"in a?l=new bu(o,a.increment):ue();const c=ot.fromServerFormat(a.fieldPath);return new cC(c,l)}(t,i)):[];if(e.update){e.update.name;const i=so(t,e.update.name),s=new yn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new sr(c.map(d=>ot.fromServerFormat(d)))}(e.updateMask);return new Cs(i,s,o,n,r)}return new Il(i,s,n,r)}if(e.delete){const i=so(t,e.delete);return new up(i,n)}if(e.verify){const i=so(t,e.verify);return new hC(i,n)}return ue()}function hU(t,e){return t&&t.length>0?(fe(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?cn(i.updateTime):cn(s);return o.isEqual(me.min())&&(o=cn(s)),new X$(o,i.transformResults||[])}(n,e))):[]}function xC(t,e){return{documents:[vC(t,e.path)]}}function bC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=vC(t,i);const s=function(c){if(c.length!==0)return SC(Be.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(f){return{field:ua(f.field),direction:pU(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=p0(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function EC(t){let e=wC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){fe(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(h){const f=IC(h);return f instanceof Be&&wv(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(v){return new df(da(v.field),function(T){switch(T){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(v.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,ip(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(h){const f=!!h.before,m=h.values||[];return new tl(m,f)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const f=!h.before,m=h.values||[];return new tl(m,f)}(n.endAt)),YA(e,i,o,s,a,"F",l,c)}function fU(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function IC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=da(n.unaryFilter.field);return De.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=da(n.unaryFilter.field);return De.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=da(n.unaryFilter.field);return De.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=da(n.unaryFilter.field);return De.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ue()}}(t):t.fieldFilter!==void 0?function(n){return De.create(da(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ue()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Be.create(n.compositeFilter.filters.map(r=>IC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue()}}(n.compositeFilter.op))}(t):ue()}function pU(t){return sU[t]}function mU(t){return oU[t]}function gU(t){return aU[t]}function ua(t){return{fieldPath:t.canonicalString()}}function da(t){return ot.fromServerFormat(t.fieldPath)}function SC(t){return t instanceof De?function(n){if(n.op==="=="){if(M1(n.value))return{unaryFilter:{field:ua(n.field),op:"IS_NAN"}};if(z1(n.value))return{unaryFilter:{field:ua(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(M1(n.value))return{unaryFilter:{field:ua(n.field),op:"IS_NOT_NAN"}};if(z1(n.value))return{unaryFilter:{field:ua(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:ua(n.field),op:mU(n.op),value:n.value}}}(t):t instanceof Be?function(n){const r=n.getFilters().map(i=>SC(i));return r.length===1?r[0]:{compositeFilter:{op:gU(n.op),filters:r}}}(t):ue()}function yU(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function TC(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi{constructor(e,n,r,i,s=me.min(),o=me.min(),a=vt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new fi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new fi(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e){this.ct=e}}function vU(t,e){let n;if(e.document)n=uU(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ie.fromSegments(e.noDocument.path),i=bo(e.noDocument.readTime);n=ft.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ue();{const r=ie.fromSegments(e.unknownDocument.path),i=bo(e.unknownDocument.version);n=ft.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new lt(i[0],i[1]);return me.fromTimestamp(s)}(e.readTime)),n}function nb(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:gf(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:pf(s,o.key),fields:o.data.value.mapValue.fields,updateTime:ol(s,o.version.toTimestamp()),createTime:ol(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:xo(e.version)};else{if(!e.isUnknownDocument())return ue();r.unknownDocument={path:n.path.toArray(),version:xo(e.version)}}return r}function gf(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function xo(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function bo(t){const e=new lt(t.seconds,t.nanoseconds);return me.fromTimestamp(e)}function Bs(t,e){const n=(e.baseMutations||[]).map(s=>y0(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>y0(t.ct,s)),i=lt.fromMillis(e.localWriteTimeMs);return new bv(e.batchId,i,n,r)}function _c(t){const e=bo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?bo(t.lastLimboFreeSnapshotVersion):me.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return fe(s.documents.length===1),qn(op(wC(s.documents[0])))}(t.query):function(s){return qn(EC(s))}(t.query),new fi(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,vt.fromBase64String(t.resumeToken))}function CC(t,e){const n=xo(e.snapshotVersion),r=xo(e.lastLimboFreeSnapshotVersion);let i;i=hf(e.target)?xC(t.ct,e.target):bC(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:_o(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function RC(t){const e=EC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?f0(e,e.limit,"L"):e}function Sm(t,e){return new Iv(e.largestBatchId,y0(t.ct,e.overlayMutation))}function rb(t,e){const n=e.path.lastSegment();return[t,ln(e.path.popLast()),n]}function ib(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:xo(r.readTime),documentKey:ln(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wU{getBundleMetadata(e,n){return sb(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:bo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return sb(e).put(function(i){return{bundleId:i.id,createTime:xo(cn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return ob(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:RC(s.bundledQuery),readTime:bo(s.readTime)}}(r)})}saveNamedQuery(e,n){return ob(e).put(function(i){return{name:i.name,readTime:xo(cn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function sb(t){return Nt(t,"bundles")}function ob(t){return Nt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dp{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new dp(e,r)}getOverlay(e,n){return nc(e).get(rb(this.userId,n)).next(r=>r?Sm(this.serializer,r):null)}getOverlays(e,n){const r=$r();return H.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new Iv(n,o);i.push(this.ht(e,a))}),H.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(ln(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(nc(e).j("collectionPathOverlayIndex",a))}),H.waitFor(s)}getOverlaysForCollection(e,n,r){const i=$r(),s=ln(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return nc(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=Sm(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=$r();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return nc(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{const h=Sm(this.serializer,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,n){return nc(e).put(function(i,s,o){const[a,l,c]=rb(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:mf(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function nc(t){return Nt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _U{Pt(e){return Nt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?vt.fromUint8Array(r):vt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qs{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(nt(e.integerValue));else if("doubleValue"in e){const r=nt(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),yu(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=Ti(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(vs(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?FA(e)?this.dt(n,Number.MAX_SAFE_INTEGER):sp(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):ue()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(nt(a)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),ie.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}qs.vt=new qs;function xU(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function ab(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=xU(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class bU{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=ab(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=ab(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class EU{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class IU{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class rc{constructor(){this.jt=new bU,this.Ht=new EU(this.jt),this.Jt=new IU(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hs{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new Hs(this.indexId,this.documentKey,this.arrayValue,r)}}function ji(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=lb(t.arrayValue,e.arrayValue),n!==0?n:(n=lb(t.directionalValue,e.directionalValue),n!==0?n:ie.comparator(t.documentKey,e.documentKey)))}function lb(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e){this.Xt=new Ke((n,r)=>ot.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(fe(e.collectionGroup===this.collectionId),this.nn)return!1;const n=s0(e);if(n!==void 0&&!this.sn(n))return!1;const r=$s(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ke(ot.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new uh(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new uh(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new uh(r.field,r.dir==="asc"?0:1)));return new uf(uf.UNKNOWN_ID,this.collectionId,n,gu.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(t){var e,n;if(fe(t instanceof De||t instanceof Be),t instanceof De){if(t instanceof QA){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>De.create(t.field,"==",s)))||[];return Be.create(i,"or")}return t}const r=t.filters.map(i=>kC(i));return Be.create(r,t.op)}function SU(t){if(t.getFilters().length===0)return[];const e=_0(kC(t));return fe(NC(e)),v0(e)||w0(e)?[e]:e.getFilters()}function v0(t){return t instanceof De}function w0(t){return t instanceof Be&&wv(t)}function NC(t){return v0(t)||w0(t)||function(n){if(n instanceof Be&&c0(n)){for(const r of n.getFilters())if(!v0(r)&&!w0(r))return!1;return!0}return!1}(t)}function _0(t){if(fe(t instanceof De||t instanceof Be),t instanceof De)return t;if(t.filters.length===1)return _0(t.filters[0]);const e=t.filters.map(r=>_0(r));let n=Be.create(e,t.op);return n=yf(n),NC(n)?n:(fe(n instanceof Be),fe(nl(n)),fe(n.filters.length>1),n.filters.reduce((r,i)=>Av(r,i)))}function Av(t,e){let n;return fe(t instanceof De||t instanceof Be),fe(e instanceof De||e instanceof Be),n=t instanceof De?e instanceof De?function(i,s){return Be.create([i,s],"and")}(t,e):ub(t,e):e instanceof De?ub(e,t):function(i,s){if(fe(i.filters.length>0&&s.filters.length>0),nl(i)&&nl(s))return KA(i,s.getFilters());const o=c0(i)?i:s,a=c0(i)?s:i,l=o.filters.map(c=>Av(c,a));return Be.create(l,"or")}(t,e),yf(n)}function ub(t,e){if(nl(e))return KA(e,t.getFilters());{const n=e.filters.map(r=>Av(t,r));return Be.create(n,"or")}}function yf(t){if(fe(t instanceof De||t instanceof Be),t instanceof De)return t;const e=t.getFilters();if(e.length===1)return yf(e[0]);if(qA(t))return t;const n=e.map(i=>yf(i)),r=[];return n.forEach(i=>{i instanceof De?r.push(i):i instanceof Be&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Be.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TU{constructor(){this.un=new Cv}addToCollectionParentIndex(e,n){return this.un.add(n),H.resolve()}getCollectionParents(e,n){return H.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return H.resolve()}deleteFieldIndex(e,n){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,n){return H.resolve()}getDocumentsMatchingTarget(e,n){return H.resolve(null)}getIndexType(e,n){return H.resolve(0)}getFieldIndexes(e,n){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,n){return H.resolve(Gn.min())}getMinOffsetFromCollectionGroup(e,n){return H.resolve(Gn.min())}updateCollectionGroup(e,n,r){return H.resolve()}updateIndexEntries(e,n){return H.resolve()}}class Cv{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ke($e.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ke($e.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zd=new Uint8Array(0);class AU{constructor(e,n){this.databaseId=n,this.cn=new Cv,this.ln=new As(r=>_o(r),(r,i)=>Mu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:ln(i)};return db(e).put(s)}return H.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[AA(n),""],!1,!0);return db(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Fr(o.parent))}return r})}addFieldIndex(e,n){const r=ic(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=oa(e);return s.next(a=>{o.put(ib(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=ic(e),i=oa(e),s=sa(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=ic(e),r=sa(e),i=oa(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return H.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new cb(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=sa(e);let i=!0;const s=new Map;return H.forEach(this.hn(n),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=Ie();const a=[];return H.forEach(s,(l,c)=>{Z("IndexedDbIndexManager",`Using index ${function(S){return`id=${S.indexId}|cg=${S.collectionGroup}|f=${S.fields.map(C=>`${C.fieldPath}:${C.kind}`).join(",")}`}(l)} to execute ${_o(n)}`);const d=function(S,C){const O=s0(C);if(O===void 0)return null;for(const z of ff(S,O.fieldPath))switch(z.op){case"array-contains-any":return z.value.arrayValue.values||[];case"array-contains":return[z.value]}return null}(c,l),h=function(S,C){const O=new Map;for(const z of $s(C))for(const A of ff(S,z.fieldPath))switch(A.op){case"==":case"in":O.set(z.fieldPath.canonicalString(),A.value);break;case"not-in":case"!=":return O.set(z.fieldPath.canonicalString(),A.value),Array.from(O.values())}return null}(c,l),f=function(S,C){const O=[];let z=!0;for(const A of $s(C)){const E=A.kind===0?B1(S,A.fieldPath,S.startAt):q1(S,A.fieldPath,S.startAt);O.push(E.value),z&&(z=E.inclusive)}return new tl(O,z)}(c,l),m=function(S,C){const O=[];let z=!0;for(const A of $s(C)){const E=A.kind===0?q1(S,A.fieldPath,S.endAt):B1(S,A.fieldPath,S.endAt);O.push(E.value),z&&(z=E.inclusive)}return new tl(O,z)}(c,l),v=this.In(l,c,f),w=this.In(l,c,m),T=this.Tn(l,c,h),y=this.En(l.indexId,d,v,f.inclusive,w,m.inclusive,T);return H.forEach(y,_=>r.G(_,n.limit).next(S=>{S.forEach(C=>{const O=ie.fromSegments(C.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return H.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=SU(Be.create(e.filters,"and")).map(r=>d0(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),d=[];for(let h=0;h<l;++h){const f=n?this.dn(n[h/c]):zd,m=this.An(e,f,r[h%c],i),v=this.Rn(e,f,s[h%c],o),w=a.map(T=>this.An(e,f,T,!0));d.push(...this.createRange(m,v,w))}return d}An(e,n,r,i){const s=new Hs(e,ie.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new Hs(e,ie.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new cb(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.hn(n);return H.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new Ke(ot.comparator),d=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new rc;for(const i of $s(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);qs.vt.It(s,o)}return r.zt()}dn(e){const n=new rc;return qs.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new rc;return qs.vt.It(_u(this.databaseId,n),r.Yt(function(s){const o=$s(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new rc);let s=0;for(const o of $s(e)){const a=r[s++];for(const l of i)if(this.fn(n,o.fieldPath)&&xu(a))i=this.gn(i,o,a);else{const c=l.Yt(o.kind);qs.vt.It(a,c)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new rc;l.seed(a.zt()),qs.vt.It(o,l.Yt(n.kind)),s.push(l)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof De&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=ic(e),i=oa(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return H.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,h){const f=h?new gu(h.sequenceNumber,new Gn(bo(h.readTime),new ie(Fr(h.documentKey)),h.largestBatchId)):gu.empty(),m=d.fields.map(([v,w])=>new uh(ot.fromServerFormat(v),w));return new uf(d.indexId,d.collectionGroup,m,f)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:_e(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=ic(e),s=oa(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>H.forEach(a,l=>s.put(ib(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return H.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?H.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),H.forEach(a,l=>this.wn(e,i,l).next(c=>{const d=this.Sn(s,l);return c.isEqual(d)?H.resolve():this.bn(e,s,l,c,d)}))))})}Dn(e,n,r,i){return sa(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return sa(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=sa(e);let s=new Ke(ji);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,a)=>{s=s.add(new Hs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,n){let r=new Ke(ji);const i=this.Vn(n,e);if(i==null)return r;const s=s0(n);if(s!=null){const o=e.data.field(s.fieldPath);if(xu(o))for(const a of o.arrayValue.values||[])r=r.add(new Hs(n.indexId,e.key,this.dn(a),i))}else r=r.add(new Hs(n.indexId,e.key,zd,i));return r}bn(e,n,r,i,s){Z("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,c,d,h,f){const m=l.getIterator(),v=c.getIterator();let w=ia(m),T=ia(v);for(;w||T;){let y=!1,_=!1;if(w&&T){const S=d(w,T);S<0?_=!0:S>0&&(y=!0)}else w!=null?_=!0:y=!0;y?(h(T),T=ia(v)):_?(f(w),w=ia(m)):(w=ia(m),T=ia(v))}}(i,s,ji,a=>{o.push(this.Dn(e,n,r,a))},a=>{o.push(this.vn(e,n,r,a))}),H.waitFor(o)}yn(e){let n=1;return oa(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>ji(o,a)).filter((o,a,l)=>!a||ji(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=ji(o,e),l=ji(o,n);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,zd,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,zd,[]];s.push(IDBKeyRange.bound(a,l))}return s}Cn(e,n){return ji(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(hb)}getMinOffset(e,n){return H.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||ue())).next(hb)}}function db(t){return Nt(t,"collectionParents")}function sa(t){return Nt(t,"indexEntries")}function ic(t){return Nt(t,"indexConfiguration")}function oa(t){return Nt(t,"indexState")}function hb(t){fe(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;pv(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Gn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class mn{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new mn(e,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PC(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(d,h,f)=>(a++,f.delete()));s.push(l.next(()=>{fe(a===1)}));const c=[];for(const d of n.mutations){const h=VA(e,d.key.path,n.batchId);s.push(i.delete(h)),c.push(d.key)}return H.waitFor(s).next(()=>c)}function vf(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ue();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mn.DEFAULT_COLLECTION_PERCENTILE=10,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,mn.DEFAULT=new mn(41943040,mn.DEFAULT_COLLECTION_PERCENTILE,mn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),mn.DISABLED=new mn(-1,0,0);class hp{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){fe(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new hp(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Fi(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=ha(e),o=Fi(e);return o.add({}).next(a=>{fe(typeof a=="number");const l=new bv(a,n,r,i),c=function(m,v,w){const T=w.baseMutations.map(_=>mf(m.ct,_)),y=w.mutations.map(_=>mf(m.ct,_));return{userId:v,batchId:w.batchId,localWriteTimeMs:w.localWriteTime.toMillis(),baseMutations:T,mutations:y}}(this.serializer,this.userId,l),d=[];let h=new Ke((f,m)=>_e(f.canonicalString(),m.canonicalString()));for(const f of i){const m=VA(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),d.push(o.put(c)),d.push(s.put(m,d$))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),H.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return Fi(e).get(n).next(r=>r?(fe(r.userId===this.userId),Bs(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?H.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return Fi(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(fe(a.batchId>=r),s=Bs(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return Fi(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Fi(e).U("userMutationsIndex",n).next(r=>r.map(i=>Bs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=dh(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return ha(e).J({range:i},(o,a,l)=>{const[c,d,h]=o,f=Fr(d);if(c===this.userId&&n.path.isEqual(f))return Fi(e).get(h).next(m=>{if(!m)throw ue();fe(m.userId===this.userId),s.push(Bs(this.serializer,m))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(_e);const i=[];return n.forEach(s=>{const o=dh(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=ha(e).J({range:a},(c,d,h)=>{const[f,m,v]=c,w=Fr(m);f===this.userId&&s.path.isEqual(w)?r=r.add(v):h.done()});i.push(l)}),H.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=dh(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ke(_e);return ha(e).J({range:o},(l,c,d)=>{const[h,f,m]=l,v=Fr(f);h===this.userId&&r.isPrefixOf(v)?v.length===i&&(a=a.add(m)):d.done()}).next(()=>this.xn(e,a))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(Fi(e).get(s).next(o=>{if(o===null)throw ue();fe(o.userId===this.userId),r.push(Bs(this.serializer,o))}))}),H.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return PC(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),H.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return H.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ha(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Fr(s[1]);i.push(l)}else a.done()}).next(()=>{fe(i.length===0)})})}containsKey(e,n){return DC(e,this.userId,n)}Nn(e){return VC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function DC(t,e,n){const r=dh(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return ha(t).J({range:s,H:!0},(a,l,c)=>{const[d,h,f]=a;d===e&&h===i&&(o=!0),c.done()}).next(()=>o)}function Fi(t){return Nt(t,"mutations")}function ha(t){return Nt(t,"documentMutations")}function VC(t){return Nt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eo{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Eo(0)}static kn(){return new Eo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CU{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new Eo(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>me.fromTimestamp(new lt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>aa(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(fe(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return aa(e).J((o,a)=>{const l=_c(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>H.waitFor(s)).next(()=>i)}forEachTarget(e,n){return aa(e).J((r,i)=>{const s=_c(i);n(s)})}qn(e){return pb(e).get("targetGlobalKey").next(n=>(fe(n!==null),n))}Qn(e,n){return pb(e).put("targetGlobalKey",n)}Kn(e,n){return aa(e).put(CC(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=_o(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return aa(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const c=_c(a);Mu(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Xi(e);return n.forEach(o=>{const a=ln(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),H.waitFor(i)}removeMatchingKeys(e,n,r){const i=Xi(e);return H.forEach(n,s=>{const o=ln(s.path);return H.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Xi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Xi(e);let s=Ie();return i.J({range:r,H:!0},(o,a,l)=>{const c=Fr(o[1]),d=new ie(c);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=ln(n.path),i=IDBKeyRange.bound([r],[AA(r)],!1,!0);let s=0;return Xi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return aa(e).get(n).next(r=>r?_c(r):null)}}function aa(t){return Nt(t,"targets")}function pb(t){return Nt(t,"targetGlobal")}function Xi(t){return Nt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mb([t,e],[n,r]){const i=_e(t,n);return i===0?_e(e,r):i}class RU{constructor(e){this.Un=e,this.buffer=new Ke(mb),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();mb(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class kU{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){Z("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Ts(n)?Z("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Ss(n)}await this.Hn(3e5)})}}class NU{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return H.resolve(_n.oe);const r=new RU(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Z("LruGarbageCollector","Garbage collection skipped; disabled"),H.resolve(fb)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Z("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fb):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Z("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),la()<=Pe.DEBUG&&Z("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),H.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function PU(t,e){return new NU(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DU{constructor(e,n){this.db=e,this.garbageCollector=PU(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return Md(e,r)}removeReference(e,n,r){return Md(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return Md(e,n)}nr(e,n){return function(i,s){let o=!1;return VC(i).Y(a=>DC(i,a,s).next(l=>(l&&(o=!0),H.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=n){const l=this.nr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,me.min()),Xi(e).delete(function(h){return[0,ln(h.path)]}(o))))});i.push(l)}}).next(()=>H.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return Md(e,n)}tr(e,n){const r=Xi(e);let i,s=_n.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==_n.oe&&n(new ie(Fr(i)),s),s=c,i=l):s=_n.oe}).next(()=>{s!==_n.oe&&n(new ie(Fr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Md(t,e){return Xi(t).put(function(r,i){return{targetId:0,path:ln(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OC{constructor(){this.changes=new As(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ft.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?H.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VU{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Ls(e).put(r)}removeEntry(e,n,r){return Ls(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],gf(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=ft.newInvalidDocument(n);return Ls(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(sc(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:ft.newInvalidDocument(n)};return Ls(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(sc(n))},(i,s)=>{r={document:this.ir(n,s),size:vf(s)}}).next(()=>r)}getEntries(e,n){let r=Un();return this._r(e,n,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,n){let r=Un(),i=new Ye(ie.comparator);return this._r(e,n,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,vf(o))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return H.resolve();let i=new Ke(vb);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(sc(i.first()),sc(i.last())),o=i.getIterator();let a=o.getNext();return Ls(e).J({index:"documentKeyIndex",range:s},(l,c,d)=>{const h=ie.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&vb(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(sc(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),gf(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Ls(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let d=Un();for(const h of c){const f=this.ir(ie.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(Fu(n,f)||i.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=Un();const o=yb(n,r),a=yb(n,Gn.max());return Ls(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{const h=this.ir(ie.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new OU(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return gb(e).get("remoteDocumentGlobalKey").next(n=>(fe(!!n),n))}rr(e,n){return gb(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=vU(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(me.min())))return r}return ft.newInvalidDocument(e)}}function LC(t){return new VU(t)}class OU extends OC{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new As(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ke((s,o)=>_e(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=nb(this.cr.serializer,o);i=i.add(s.path.popLast());const c=vf(l);r+=c-a.size,n.push(this.cr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=nb(this.cr.serializer,o.convertToNoDocument(me.min()));n.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),H.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function gb(t){return Nt(t,"remoteDocumentGlobal")}function Ls(t){return Nt(t,"remoteDocumentsV14")}function sc(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function yb(t,e){const n=e.documentKey.path.toArray();return[t,gf(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function vb(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=_e(n[s],r[s]),i)return i;return i=_e(n.length,r.length),i||(i=_e(n[n.length-2],r[r.length-2]),i||_e(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LU{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&Lc(r.mutation,i,sr.empty(),lt.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Ie()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Ie()){const i=$r();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=vc();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=$r();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Ie()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Un();const o=Oc(),a=function(){return Oc()}();return n.forEach((l,c)=>{const d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof Cs)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),Lc(d.mutation,c,d.mutation.getFieldMask(),lt.now())):o.set(c.key,sr.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var h;return a.set(c,new LU(d,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=Oc();let i=new Ye((o,a)=>o-a),s=Ie();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=r.get(l)||sr.empty();d=a.applyToLocalView(c,d),r.set(l,d);const h=(i.get(a.batchId)||Ie()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,h=rC();d.forEach(f=>{if(!s.has(f)){const m=uC(n.get(f),r.get(f));m!==null&&h.set(f,m),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return H.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return ie.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):XA(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):H.resolve($r());let a=-1,l=s;return o.next(c=>H.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?H.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,Ie())).next(d=>({batchId:a,changes:nC(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new ie(n)).next(r=>{let i=vc();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=vc();return this.indexManager.getCollectionParents(e,s).next(a=>H.forEach(a,l=>{const c=function(h,f){return new ju(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,ft.newInvalidDocument(d)))});let a=vc();return o.forEach((l,c)=>{const d=s.get(l);d!==void 0&&Lc(d.mutation,c,sr.empty(),lt.now()),Fu(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zU{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return H.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:cn(i.createTime)}}(n)),H.resolve()}getNamedQuery(e,n){return H.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:RC(i.bundledQuery),readTime:cn(i.readTime)}}(n)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(){this.overlays=new Ye(ie.comparator),this.Ir=new Map}getOverlay(e,n){return H.resolve(this.overlays.get(n))}getOverlays(e,n){const r=$r();return H.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),H.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),H.resolve()}getOverlaysForCollection(e,n,r){const i=$r(),s=n.length+1,o=new ie(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return H.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Ye((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=$r(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=$r(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return H.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new Iv(n,r));let s=this.Ir.get(n);s===void 0&&(s=Ie(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(){this.sessionToken=vt.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv{constructor(){this.Tr=new Ke(Mt.Er),this.dr=new Ke(Mt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new Mt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new Mt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new ie(new $e([])),r=new Mt(n,e),i=new Mt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new ie(new $e([])),r=new Mt(n,e),i=new Mt(n,e+1);let s=Ie();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new Mt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Mt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return ie.comparator(e.key,n.key)||_e(e.wr,n.wr)}static Ar(e,n){return _e(e.wr,n.wr)||ie.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FU{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ke(Mt.Er)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new bv(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new Mt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return H.resolve(o)}lookupMutationBatch(e,n){return H.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return H.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Mt(n,0),i=new Mt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),H.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ke(_e);return n.forEach(i=>{const s=new Mt(i,0),o=new Mt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),H.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;ie.isDocumentKey(s)||(s=s.child(""));const o=new Mt(new ie(s),0);let a=new Ke(_e);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.wr)),!0)},o),H.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){fe(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return H.forEach(n.mutations,i=>{const s=new Mt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new Mt(n,0),i=this.br.firstAfterOrEqual(r);return H.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $U{constructor(e){this.Mr=e,this.docs=function(){return new Ye(ie.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return H.resolve(r?r.document.mutableCopy():ft.newInvalidDocument(n))}getEntries(e,n){let r=Un();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():ft.newInvalidDocument(i))}),H.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Un();const o=n.path,a=new ie(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||pv(RA(d),r)<=0||(i.has(d.key)||Fu(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return H.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ue()}Or(e,n){return H.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new UU(this)}getSize(e){return H.resolve(this.size)}}class UU extends OC{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),H.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BU{constructor(e){this.persistence=e,this.Nr=new As(n=>_o(n),Mu),this.lastRemoteSnapshotVersion=me.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Rv,this.targetCount=0,this.kr=Eo.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),H.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Eo(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,H.resolve()}updateTargetData(e,n){return this.Kn(n),H.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),H.waitFor(s).next(()=>i)}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return H.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),H.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),H.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),H.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return H.resolve(r)}containsKey(e,n){return H.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e,n){this.qr={},this.overlays={},this.Qr=new _n(0),this.Kr=!1,this.Kr=!0,this.$r=new jU,this.referenceDelegate=e(this),this.Ur=new BU(this),this.indexManager=new TU,this.remoteDocumentCache=function(i){return new $U(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new AC(n),this.Gr=new zU(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new MU,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new FU(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){Z("MemoryPersistence","Starting transaction:",e);const i=new qU(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return H.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class qU extends NA{constructor(e){super(),this.currentSequenceNumber=e}}class fp{constructor(e){this.persistence=e,this.Jr=new Rv,this.Yr=null}static Zr(e){return new fp(e)}get Xr(){if(this.Yr)return this.Yr;throw ue()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),H.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),H.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),H.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.Xr,r=>{const i=ie.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,me.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return H.or([()=>H.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HU{constructor(e){this.serializer=e}O(e,n,r,i){const s=new rp("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",P1,{unique:!0}),l.createObjectStore("documentMutations")}(e),wb(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=H.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),wb(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:me.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",P1,{unique:!0});const h=c.store("mutations"),f=d.map(m=>h.put(m));return H.waitFor(f)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:E$});c.createIndex("collectionPathOverlayIndex",I$,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",S$,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:h$});c.createIndex("documentKeyIndex",f$),c.createIndex("collectionGroupIndex",p$)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:w$}).createIndex("sequenceNumberIndex",_$,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:x$}).createIndex("documentKeyIndex",b$,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=vf(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>H.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>H.forEach(a,l=>{fe(l.userId===s.userId);const c=Bs(this.serializer,l);return PC(e,s.userId,c).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new $e(o),c=function(h){return[0,ln(h)]}(l);s.push(n.get(c).next(d=>d?H.resolve():(h=>n.put({targetId:0,path:ln(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>H.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:v$});const r=n.store("collectionParents"),i=new Cv,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:ln(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new $e(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],c)=>{const d=Fr(a);return s(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=_c(i),o=CC(this.serializer,s);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(h){return h.document?new ie($e.fromString(h.document.name).popFirst(5)):h.noDocument?ie.fromSegments(h.noDocument.path):h.unknownDocument?ie.fromSegments(h.unknownDocument.path):ue()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>H.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=LC(this.serializer),s=new MC(fp.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:Ie();Bs(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),H.forEach(a,(l,c)=>{const d=new en(c),h=dp.lt(this.serializer,d),f=s.getIndexManager(d),m=hp.lt(d,this.serializer,f,s.referenceDelegate);return new zC(i,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new o0(n,_n.oe),l).next()})})}}function wb(t){t.createObjectStore("targetDocuments",{keyPath:g$}).createIndex("documentTargetsIndex",y$,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",m$,{unique:!0}),t.createObjectStore("targetGlobal")}const Tm="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class kv{constructor(e,n,r,i,s,o,a,l,c,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=f=>Promise.resolve(),!kv.D())throw new re(Y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new DU(this,i),this.Ai=n+"main",this.serializer=new AC(l),this.Ri=new fs(this.Ai,this.hi,new HU(this.serializer)),this.$r=new _U,this.Ur=new CU(this.referenceDelegate,this.serializer),this.remoteDocumentCache=LC(this.serializer),this.Gr=new wU,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&yt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new re(Y.FAILED_PRECONDITION,Tm);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new _n(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>jd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Ts(e))return Z("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Z("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return oc(e).get("owner").next(n=>H.resolve(this.vi(n)))}Ci(e){return jd(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Nt(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return H.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?H.resolve(!0):oc(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new re(Y.FAILED_PRECONDITION,Tm);return!1}}return!(!this.networkEnabled||!this.inForeground)||jd(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Z("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new o0(e,_n.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>jd(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return hp.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new AU(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return dp.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){Z("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===17?C$:l===16?A$:l===15?gv:l===14?zA:l===13?LA:l===12?T$:l===11?OA:void ue()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new o0(a,this.Qr?this.Qr.next():_n.oe),n==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw yt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new re(Y.FAILED_PRECONDITION,kA);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return oc(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new re(Y.FAILED_PRECONDITION,Tm)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return oc(e).put("owner",n)}static D(){return fs.D()}bi(e){const n=oc(e);return n.get("owner").next(r=>this.vi(r)?(Z("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):H.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(yt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;N2()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return Z("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return yt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){yt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function oc(t){return Nt(t,"owner")}function jd(t){return Nt(t,"clientMetadata")}function jC(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nv{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=Ie(),i=Ie();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Nv(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KU{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return N2()?8:PA(Rt())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new KU;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(la()<=Pe.DEBUG&&Z("QueryEngine","SDK will not create cache indexes for query:",ca(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),H.resolve()):(la()<=Pe.DEBUG&&Z("QueryEngine","Query:",ca(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(la()<=Pe.DEBUG&&Z("QueryEngine","The SDK decides to create cache indexes for query:",ca(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,qn(n))):H.resolve())}Yi(e,n){if(H1(n))return H.resolve(null);let r=qn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=f0(n,null,"F"),r=qn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ie(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(n,a);return this.ns(n,c,o,l.readTime)?this.Yi(e,f0(n,null,"F")):this.rs(e,c,n,l)}))})))}Zi(e,n,r,i){return H1(n)||i.isEqual(me.min())?H.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?H.resolve(null):(la()<=Pe.DEBUG&&Z("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ca(n)),this.rs(e,o,n,CA(i,-1)).next(a=>a))})}ts(e,n){let r=new Ke(eC(e));return n.forEach((i,s)=>{Fu(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return la()<=Pe.DEBUG&&Z("QueryEngine","Using full collection scan to execute query:",ca(n)),this.Ji.getDocumentsMatchingQuery(e,n,Gn.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WU{constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Ye(_e),this._s=new As(s=>_o(s),Mu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new zC(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function $C(t,e,n,r){return new WU(t,e,n,r)}async function UC(t,e){const n=he(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=Ie();for(const c of i){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function GU(t,e){const n=he(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const h=c.batch,f=h.keys();let m=H.resolve();return f.forEach(v=>{m=m.next(()=>d.getEntry(l,v)).next(w=>{const T=c.docVersions.get(v);fe(T!==null),w.version.compareTo(T)<0&&(h.applyToRemoteDocument(w,c),w.isValidDocument()&&(w.setReadTime(c.commitVersion),d.addEntry(w)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=Ie();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function BC(t){const e=he(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function QU(t,e){const n=he(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];e.targetChanges.forEach((d,h)=>{const f=i.get(h);if(!f)return;a.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,h)));let m=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(vt.EMPTY_BYTE_STRING,me.min()).withLastLimboFreeSnapshotVersion(me.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),i=i.insert(h,m),function(w,T,y){return w.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-w.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(f,m,d)&&a.push(n.Ur.updateTargetData(s,m))});let l=Un(),c=Ie();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(YU(s,o,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!r.isEqual(me.min())){const d=n.Ur.getLastRemoteSnapshotVersion(s).next(h=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return H.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.os=i,s))}function YU(t,e,n){let r=Ie(),i=Ie();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Un();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(me.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):Z("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function XU(t,e){const n=he(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function wf(t,e){const n=he(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,H.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new fi(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function al(t,e,n){const r=he(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!Ts(o))throw o;Z("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function x0(t,e,n){const r=he(t);let i=me.min(),s=Ie();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const h=he(l),f=h._s.get(d);return f!==void 0?H.resolve(h.os.get(f)):h.Ur.getTargetData(c,d)}(r,o,qn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:me.min(),n?s:Ie())).next(a=>(KC(r,ZA(e),a),{documents:a,Ts:s})))}function qC(t,e){const n=he(t),r=he(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function HC(t,e){const n=he(t),r=n.us.get(e)||me.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,CA(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(KC(n,e,i),i))}function KC(t,e,n){let r=t.us.get(e)||me.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}function _b(t,e){return`firestore_clients_${t}_${e}`}function xb(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Am(t,e){return`firestore_targets_${t}_${e}`}class _f{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new re(i.error.code,i.error.message))),o?new _f(e,n,i.state,s):(yt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class zc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new re(r.error.code,r.error.message))),s?new zc(e,r.state,i):(yt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class xf{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=_v();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=DA(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new xf(e,s):(yt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Pv{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Pv(n.clientId,n.onlineState):(yt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class b0{constructor(){this.activeTargetIds=_v()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Cm{constructor(e,n,r,i,s){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Ye(_e),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=_b(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new b0),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(_b(this.persistenceKey,r));if(i){const s=xf.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Am(this.persistenceKey,e));if(i){const s=zc.Rs(e,i);s&&(r=s.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Am(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return Z("SharedClientState","READ",e,n),n}setItem(e,n){Z("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){Z("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(Z("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void yt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(s){let o=_n.oe;if(s!=null)try{const a=JSON.parse(s);fe(typeof a=="number"),o=a}catch(a){yt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==_n.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new _f(this.currentUser,e,n,r),s=xb(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const n=xb(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=Am(this.persistenceKey,e),s=new zc(e,n,r);this.setItem(i,s.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return xf.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return _f.Rs(new en(s),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return zc.Rs(i,n)}Ls(e){return Pv.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);Z("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=_v();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class WC{constructor(){this.so=new b0,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new b0,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JU{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Z("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Z("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fd=null;function Rm(){return Fd===null?Fd=function(){return 268435456+Math.round(2147483648*Math.random())}():Fd++,"0x"+Fd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZU={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eB{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zt="WebChannelConnection";class tB extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const a=Rm(),l=this.xo(n,r.toUriEncodedString());Z("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(n,l,c,i).then(d=>(Z("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw pu("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+bl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=ZU[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Rm();return new Promise((o,a)=>{const l=new xA;l.setWithCredentials(!0),l.listenOnce(bA.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case ch.NO_ERROR:const d=l.getResponseJson();Z(Zt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case ch.TIMEOUT:Z(Zt,`RPC '${e}' ${s} timed out`),a(new re(Y.DEADLINE_EXCEEDED,"Request time out"));break;case ch.HTTP_ERROR:const h=l.getStatus();if(Z(Zt,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const v=function(T){const y=T.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(y)>=0?y:Y.UNKNOWN}(m.status);a(new re(v,m.message))}else a(new re(Y.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new re(Y.UNAVAILABLE,"Connection failed."));break;default:ue()}}finally{Z(Zt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);Z(Zt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",c,r,15)})}Bo(e,n,r){const i=Rm(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=SA(),a=IA(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");Z(Zt,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=o.createWebChannel(d,l);let f=!1,m=!1;const v=new eB({Io:T=>{m?Z(Zt,`Not sending because RPC '${e}' stream ${i} is closed:`,T):(f||(Z(Zt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),Z(Zt,`RPC '${e}' stream ${i} sending:`,T),h.send(T))},To:()=>h.close()}),w=(T,y,_)=>{T.listen(y,S=>{try{_(S)}catch(C){setTimeout(()=>{throw C},0)}})};return w(h,yc.EventType.OPEN,()=>{m||(Z(Zt,`RPC '${e}' stream ${i} transport opened.`),v.yo())}),w(h,yc.EventType.CLOSE,()=>{m||(m=!0,Z(Zt,`RPC '${e}' stream ${i} transport closed`),v.So())}),w(h,yc.EventType.ERROR,T=>{m||(m=!0,pu(Zt,`RPC '${e}' stream ${i} transport errored:`,T),v.So(new re(Y.UNAVAILABLE,"The operation could not be completed")))}),w(h,yc.EventType.MESSAGE,T=>{var y;if(!m){const _=T.data[0];fe(!!_);const S=_,C=S.error||((y=S[0])===null||y===void 0?void 0:y.error);if(C){Z(Zt,`RPC '${e}' stream ${i} received error:`,C);const O=C.status;let z=function(b){const I=xt[b];if(I!==void 0)return fC(I)}(O),A=C.message;z===void 0&&(z=Y.INTERNAL,A="Unknown error status: "+O+" with message "+C.message),m=!0,v.So(new re(z,A)),h.close()}else Z(Zt,`RPC '${e}' stream ${i} received:`,_),v.bo(_)}}),w(a,EA.STAT_EVENT,T=>{T.stat===i0.PROXY?Z(Zt,`RPC '${e}' stream ${i} detected buffering proxy`):T.stat===i0.NOPROXY&&Z(Zt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{v.wo()},0),v}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(){return typeof window<"u"?window:null}function gh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pp(t){return new lU(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&Z("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{constructor(e,n,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new QC(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?(yt(n.toString()),yt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new re(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return Z("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(Z("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class nB extends YC{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=dU(this.serializer,e),r=function(s){if(!("targetChange"in s))return me.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?me.min():o.readTime?cn(o.readTime):me.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=g0(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=hf(l)?{documents:xC(s,l)}:{query:bC(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=gC(s,o.resumeToken);const c=p0(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(me.min())>0){a.readTime=ol(s,o.snapshotVersion.toTimestamp());const c=p0(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=fU(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=g0(this.serializer),n.removeTarget=e,this.a_(n)}}class rB extends YC{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return fe(!!e.streamToken),this.lastStreamToken=e.streamToken,fe(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){fe(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=hU(e.writeResults,e.commitTime),r=cn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=g0(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>mf(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iB extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new re(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,m0(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new re(Y.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,m0(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new re(Y.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class sB{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(yt(n),this.D_=!1):Z("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oB{constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{Po(this)&&(Z("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=he(l);c.L_.add(4),await Bu(c),c.q_.set("Unknown"),c.L_.delete(4),await mp(c)}(this))})}),this.q_=new sB(r,i)}}async function mp(t){if(Po(t))for(const e of t.B_)await e(!0)}async function Bu(t){for(const e of t.B_)await e(!1)}function gp(t,e){const n=he(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Ov(n)?Vv(n):Tl(n).r_()&&Dv(n,e))}function ll(t,e){const n=he(t),r=Tl(n);n.N_.delete(e),r.r_()&&XC(n,e),n.N_.size===0&&(r.r_()?r.o_():Po(n)&&n.q_.set("Unknown"))}function Dv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(me.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Tl(t).A_(e)}function XC(t,e){t.Q_.xe(e),Tl(t).R_(e)}function Vv(t){t.Q_=new iU({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Tl(t).start(),t.q_.v_()}function Ov(t){return Po(t)&&!Tl(t).n_()&&t.N_.size>0}function Po(t){return he(t).L_.size===0}function JC(t){t.Q_=void 0}async function aB(t){t.q_.set("Online")}async function lB(t){t.N_.forEach((e,n)=>{Dv(t,e)})}async function cB(t,e){JC(t),Ov(t)?(t.q_.M_(e),Vv(t)):t.q_.set("Unknown")}async function uB(t,e,n){if(t.q_.set("Online"),e instanceof mC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(t,e)}catch(r){Z("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await bf(t,r)}else if(e instanceof mh?t.Q_.Ke(e):e instanceof pC?t.Q_.He(e):t.Q_.We(e),!n.isEqual(me.min()))try{const r=await BC(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(vt.EMPTY_BYTE_STRING,d.snapshotVersion)),XC(s,l);const h=new fi(d.target,l,c,d.sequenceNumber);Dv(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){Z("RemoteStore","Failed to raise snapshot:",r),await bf(t,r)}}async function bf(t,e,n){if(!Ts(e))throw e;t.L_.add(1),await Bu(t),t.q_.set("Offline"),n||(n=()=>BC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Z("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await mp(t)})}function ZC(t,e){return e().catch(n=>bf(t,n,e))}async function Sl(t){const e=he(t),n=_s(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;dB(e);)try{const i=await XU(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,hB(e,i)}catch(i){await bf(e,i)}eR(e)&&tR(e)}function dB(t){return Po(t)&&t.O_.length<10}function hB(t,e){t.O_.push(e);const n=_s(t);n.r_()&&n.V_&&n.m_(e.mutations)}function eR(t){return Po(t)&&!_s(t).n_()&&t.O_.length>0}function tR(t){_s(t).start()}async function fB(t){_s(t).p_()}async function pB(t){const e=_s(t);for(const n of t.O_)e.m_(n.mutations)}async function mB(t,e,n){const r=t.O_.shift(),i=Ev.from(r,e,n);await ZC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await Sl(t)}async function gB(t,e){e&&_s(t).V_&&await async function(r,i){if(function(o){return tU(o)&&o!==Y.ABORTED}(i.code)){const s=r.O_.shift();_s(r).s_(),await ZC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Sl(r)}}(t,e),eR(t)&&tR(t)}async function Eb(t,e){const n=he(t);n.asyncQueue.verifyOperationInProgress(),Z("RemoteStore","RemoteStore received new credentials");const r=Po(n);n.L_.add(3),await Bu(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await mp(n)}async function E0(t,e){const n=he(t);e?(n.L_.delete(2),await mp(n)):e||(n.L_.add(2),await Bu(n),n.q_.set("Unknown"))}function Tl(t){return t.K_||(t.K_=function(n,r,i){const s=he(n);return s.w_(),new nB(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:aB.bind(null,t),Ro:lB.bind(null,t),mo:cB.bind(null,t),d_:uB.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Ov(t)?Vv(t):t.q_.set("Unknown")):(await t.K_.stop(),JC(t))})),t.K_}function _s(t){return t.U_||(t.U_=function(n,r,i){const s=he(n);return s.w_(),new rB(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:fB.bind(null,t),mo:gB.bind(null,t),f_:pB.bind(null,t),g_:mB.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await Sl(t)):(await t.U_.stop(),t.O_.length>0&&(Z("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lv{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Kr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Lv(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new re(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zv(t,e){if(yt("AsyncQueue",`${e}: ${t}`),Ts(t))return new re(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e){this.comparator=e?(n,r)=>e(n,r)||ie.comparator(n.key,r.key):(n,r)=>ie.comparator(n.key,r.key),this.keyedMap=vc(),this.sortedSet=new Ye(this.comparator)}static emptySet(e){return new ja(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof ja)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new ja;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(){this.W_=new Ye(ie.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ue():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class cl{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new cl(e,n,ja.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ap(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yB{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class vB{constructor(){this.queries=Sb(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=he(n),s=i.queries;i.queries=Sb(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new re(Y.ABORTED,"Firestore shutting down"))}}function Sb(){return new As(t=>JA(t),ap)}async function nR(t,e){const n=he(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new yB,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=zv(o,`Initialization of query '${ca(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Mv(n)}async function rR(t,e){const n=he(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wB(t,e){const n=he(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&Mv(n)}function _B(t,e,n){const r=he(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Mv(t){t.Y_.forEach(e=>{e.next()})}var I0,Tb;(Tb=I0||(I0={})).ea="default",Tb.Cache="cache";class iR{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new cl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=cl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==I0.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sR{constructor(e){this.key=e}}class oR{constructor(e){this.key=e}}class xB{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ie(),this.mutatedKeys=Ie(),this.Aa=eC(e),this.Ra=new ja(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Ib,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const f=i.get(d),m=Fu(this.query,h)?h:null,v=!!f&&this.mutatedKeys.has(f.key),w=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let T=!1;f&&m?f.data.isEqual(m.data)?v!==w&&(r.track({type:3,doc:m}),T=!0):this.ga(f,m)||(r.track({type:2,doc:m}),T=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),T=!0):f&&!m&&(r.track({type:1,doc:f}),T=!0,(l||c)&&(a=!0)),T&&(m?(o=o.add(m),s=w?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,h)=>function(m,v){const w=T=>{switch(T){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue()}};return w(m)-w(v)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;const a=n&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new cl(this.query,e.Ra,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Ib,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ie(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new oR(r))}),this.da.forEach(r=>{e.has(r)||n.push(new sR(r))}),n}ba(e){this.Ta=e.Ts,this.da=Ie();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return cl.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class bB{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class EB{constructor(e){this.key=e,this.va=!1}}class IB{constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new As(a=>JA(a),ap),this.Ma=new Map,this.xa=new Set,this.Oa=new Ye(ie.comparator),this.Na=new Map,this.La=new Rv,this.Ba={},this.ka=new Map,this.qa=Eo.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function SB(t,e,n=!0){const r=yp(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await aR(r,e,n,!0),i}async function TB(t,e){const n=yp(t);await aR(n,e,!0,!1)}async function aR(t,e,n,r){const i=await wf(t.localStore,qn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await jv(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&gp(t.remoteStore,i),a}async function jv(t,e,n,r,i){t.Ka=(h,f,m)=>async function(w,T,y,_){let S=T.view.ma(y);S.ns&&(S=await x0(w.localStore,T.query,!1).then(({documents:A})=>T.view.ma(A,S)));const C=_&&_.targetChanges.get(T.targetId),O=_&&_.targetMismatches.get(T.targetId)!=null,z=T.view.applyChanges(S,w.isPrimaryClient,C,O);return S0(w,T.targetId,z.wa),z.snapshot}(t,h,f,m);const s=await x0(t.localStore,e,!0),o=new xB(e,s.Ts),a=o.ma(s.documents),l=Uu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);S0(t,n,c.wa);const d=new bB(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function AB(t,e,n){const r=he(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!ap(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await al(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&ll(r.remoteStore,i.targetId),ul(r,i.targetId)}).catch(Ss)):(ul(r,i.targetId),await al(r.localStore,i.targetId,!0))}async function CB(t,e){const n=he(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),ll(n.remoteStore,r.targetId))}async function RB(t,e,n){const r=Bv(t);try{const i=await function(o,a){const l=he(o),c=lt.now(),d=a.reduce((m,v)=>m.add(v.key),Ie());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let v=Un(),w=Ie();return l.cs.getEntries(m,d).next(T=>{v=T,v.forEach((y,_)=>{_.isValidDocument()||(w=w.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,v)).next(T=>{h=T;const y=[];for(const _ of a){const S=Z$(_,h.get(_.key).overlayedDocument);S!=null&&y.push(new Cs(_.key,S,UA(S.value.mapValue),xn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,y,a)}).next(T=>{f=T;const y=T.applyToLocalDocumentSet(h,w);return l.documentOverlayCache.saveOverlays(m,T.batchId,y)})}).then(()=>({batchId:f.batchId,changes:nC(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new Ye(_e)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,n),await Rs(r,i.changes),await Sl(r.remoteStore)}catch(i){const s=zv(i,"Failed to persist write");n.reject(s)}}async function lR(t,e){const n=he(t);try{const r=await QU(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(fe(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?fe(o.va):i.removedDocuments.size>0&&(fe(o.va),o.va=!1))}),await Rs(n,r,e)}catch(r){await Ss(r)}}function Ab(t,e,n){const r=he(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=he(o);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(const f of h.j_)f.Z_(a)&&(c=!0)}),c&&Mv(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function kB(t,e,n){const r=he(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Ye(ie.comparator);o=o.insert(s,ft.newNoDocument(s,me.min()));const a=Ie().add(s),l=new $u(me.min(),new Map,new Ye(_e),o,a);await lR(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),Uv(r)}else await al(r.localStore,e,!1).then(()=>ul(r,e,n)).catch(Ss)}async function NB(t,e){const n=he(t),r=e.batch.batchId;try{const i=await GU(n.localStore,e);$v(n,r,null),Fv(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Rs(n,i)}catch(i){await Ss(i)}}async function PB(t,e,n){const r=he(t);try{const i=await function(o,a){const l=he(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(fe(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);$v(r,e,n),Fv(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Rs(r,i)}catch(i){await Ss(i)}}function Fv(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function $v(t,e,n){const r=he(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function ul(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||cR(t,r)})}function cR(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(ll(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Uv(t))}function S0(t,e,n){for(const r of n)r instanceof sR?(t.La.addReference(r.key,e),DB(t,r)):r instanceof oR?(Z("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||cR(t,r.key)):ue()}function DB(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(Z("SyncEngine","New document in limbo: "+n),t.xa.add(r),Uv(t))}function Uv(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new ie($e.fromString(e)),r=t.qa.next();t.Na.set(r,new EB(n)),t.Oa=t.Oa.insert(n,r),gp(t.remoteStore,new fi(qn(op(n.path)),r,"TargetPurposeLimboResolution",_n.oe))}}async function Rs(t,e,n){const r=he(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const h=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=Nv.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,c){const d=he(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>H.forEach(c,f=>H.forEach(f.$i,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>H.forEach(f.Ui,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Ts(h))throw h;Z("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const m=d.os.get(f),v=m.snapshotVersion,w=m.withLastLimboFreeSnapshotVersion(v);d.os=d.os.insert(f,w)}}}(r.localStore,s))}async function VB(t,e){const n=he(t);if(!n.currentUser.isEqual(e)){Z("SyncEngine","User change. New user:",e.toKey());const r=await UC(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new re(Y.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Rs(n,r.hs)}}function OB(t,e){const n=he(t),r=n.Na.get(e);if(r&&r.va)return Ie().add(r.key);{let i=Ie();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}async function LB(t,e){const n=he(t),r=await x0(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&S0(n,e.targetId,i.wa),i}async function zB(t,e){const n=he(t);return HC(n.localStore,e).then(r=>Rs(n,r))}async function MB(t,e,n,r){const i=he(t),s=await function(a,l){const c=he(a),d=he(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.Mn(h,l).next(f=>f?c.localDocuments.getDocuments(h,f):H.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await Sl(i.remoteStore):n==="acknowledged"||n==="rejected"?($v(i,e,r||null),Fv(i,e),function(a,l){he(he(a).mutationQueue).On(l)}(i.localStore,e)):ue(),await Rs(i,s)):Z("SyncEngine","Cannot apply mutation batch with id: "+e)}async function jB(t,e){const n=he(t);if(yp(n),Bv(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await Cb(n,r.toArray());n.Qa=!0,await E0(n.remoteStore,!0);for(const s of i)gp(n.remoteStore,s)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(ul(n,o),al(n.localStore,o,!0))),ll(n.remoteStore,o)}),await i,await Cb(n,r),function(o){const a=he(o);a.Na.forEach((l,c)=>{ll(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new Ye(ie.comparator)}(n),n.Qa=!1,await E0(n.remoteStore,!1)}}async function Cb(t,e,n){const r=he(t),i=[],s=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await wf(r.localStore,qn(l[0]));for(const c of l){const d=r.Fa.get(c),h=await LB(r,d);h.snapshot&&s.push(h.snapshot)}}else{const c=await qC(r.localStore,o);a=await wf(r.localStore,c),await jv(r,uR(c),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i}function uR(t){return YA(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function FB(t){return function(n){return he(he(n).persistence).Qi()}(he(t).localStore)}async function $B(t,e,n,r){const i=he(t);if(i.Qa)return void Z("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await HC(i.localStore,ZA(s[0])),a=$u.createSynthesizedRemoteEventForCurrentChange(e,n==="current",vt.EMPTY_BYTE_STRING);await Rs(i,o,a);break}case"rejected":await al(i.localStore,e,!0),ul(i,e,r);break;default:ue()}}async function UB(t,e,n){const r=yp(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){Z("SyncEngine","Adding an already active target "+i);continue}const s=await qC(r.localStore,i),o=await wf(r.localStore,s);await jv(r,uR(s),o.targetId,!1,o.resumeToken),gp(r.remoteStore,o)}for(const i of n)r.Ma.has(i)&&await al(r.localStore,i,!1).then(()=>{ll(r.remoteStore,i),ul(r,i)}).catch(Ss)}}function yp(t){const e=he(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=lR.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=OB.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=kB.bind(null,e),e.Ca.d_=wB.bind(null,e.eventManager),e.Ca.$a=_B.bind(null,e.eventManager),e}function Bv(t){const e=he(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=NB.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PB.bind(null,e),e}class Eu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=pp(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return $C(this.persistence,new FC,e.initialUser,this.serializer)}Ga(e){return new MC(fp.Zr,this.serializer)}Wa(e){return new WC}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Eu.provider={build:()=>new Eu};class dR extends Eu{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Bv(this.Ja.syncEngine),await Sl(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return $C(this.persistence,new FC,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new kU(r,e.asyncQueue,n)}Ha(e,n){const r=new c$(n,this.persistence);return new l$(e.asyncQueue,r)}Ga(e){const n=jC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?mn.withCacheSize(this.cacheSizeBytes):mn.DEFAULT;return new kv(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,GC(),gh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new WC}}class BB extends dR{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof Cm&&(this.sharedClientState.syncEngine={no:MB.bind(null,n),ro:$B.bind(null,n),io:UB.bind(null,n),Qi:FB.bind(null,n),eo:zB.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await jB(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=GC();if(!Cm.D(n))throw new re(Y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=jC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Cm(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class Iu{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Ab(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=VB.bind(null,this.syncEngine),await E0(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new vB}()}createDatastore(e){const n=pp(e.databaseInfo.databaseId),r=function(s){return new tB(s)}(e.databaseInfo);return function(s,o,a,l){return new iB(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new oB(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>Ab(this.syncEngine,n,0),function(){return bb.D()?new bb:new JU}())}createSyncEngine(e,n){return function(i,s,o,a,l,c,d){const h=new IB(i,s,o,a,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=he(i);Z("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await Bu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Iu.provider={build:()=>new Iu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hR{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):yt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qB{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=en.UNAUTHENTICATED,this.clientId=TA.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Z("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Z("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Kr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=zv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function km(t,e){t.asyncQueue.verifyOperationInProgress(),Z("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await UC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function Rb(t,e){t.asyncQueue.verifyOperationInProgress();const n=await HB(t);Z("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Eb(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>Eb(e.remoteStore,i)),t._onlineComponents=e}async function HB(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Z("FirestoreClient","Using user provided OfflineComponentProvider");try{await km(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Y.FAILED_PRECONDITION||i.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;pu("Error using user provided cache. Falling back to memory cache: "+n),await km(t,new Eu)}}else Z("FirestoreClient","Using default OfflineComponentProvider"),await km(t,new Eu);return t._offlineComponents}async function fR(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Z("FirestoreClient","Using user provided OnlineComponentProvider"),await Rb(t,t._uninitializedComponentsProvider._online)):(Z("FirestoreClient","Using default OnlineComponentProvider"),await Rb(t,new Iu))),t._onlineComponents}function KB(t){return fR(t).then(e=>e.syncEngine)}async function pR(t){const e=await fR(t),n=e.eventManager;return n.onListen=SB.bind(null,e.syncEngine),n.onUnlisten=AB.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=TB.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=CB.bind(null,e.syncEngine),n}function WB(t,e,n={}){const r=new Kr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new hR({next:f=>{d.Za(),o.enqueueAndForget(()=>rR(s,h));const m=f.docs.has(a);!m&&f.fromCache?c.reject(new re(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&l&&l.source==="server"?c.reject(new re(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new iR(op(a.path),d,{includeMetadataChanges:!0,_a:!0});return nR(s,h)}(await pR(t),t.asyncQueue,e,n,r)),r.promise}function GB(t,e,n={}){const r=new Kr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new hR({next:f=>{d.Za(),o.enqueueAndForget(()=>rR(s,h)),f.fromCache&&l.source==="server"?c.reject(new re(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new iR(a,d,{includeMetadataChanges:!0,_a:!0});return nR(s,h)}(await pR(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mR(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kb=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gR(t,e,n){if(!n)throw new re(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function QB(t,e,n,r){if(e===!0&&r===!0)throw new re(Y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Nb(t){if(!ie.isDocumentKey(t))throw new re(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function Pb(t){if(ie.isDocumentKey(t))throw new re(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function vp(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue()}function Io(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new re(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=vp(t);throw new re(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new re(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new re(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QB("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=mR((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new re(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new re(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new re(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qv{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Db({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new re(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new re(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Db(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new J9;switch(r.type){case"firstParty":return new t$(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new re(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=kb.get(n);r&&(Z("ComponentProvider","Removing Datastore"),kb.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Al(this.firestore,e,this._query)}}class Tn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ps(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Tn(this.firestore,e,this._key)}}class ps extends Al{constructor(e,n,r){super(e,n,op(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Tn(this.firestore,null,new ie(e))}withConverter(e){return new ps(this.firestore,e,this._path)}}function YB(t,e,...n){if(t=kt(t),gR("collection","path",e),t instanceof qv){const r=$e.fromString(e,...n);return Pb(r),new ps(t,null,r)}{if(!(t instanceof Tn||t instanceof ps))throw new re(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child($e.fromString(e,...n));return Pb(r),new ps(t.firestore,null,r)}}function Nm(t,e,...n){if(t=kt(t),arguments.length===1&&(e=TA.newId()),gR("doc","path",e),t instanceof qv){const r=$e.fromString(e,...n);return Nb(r),new Tn(t,null,new ie(r))}{if(!(t instanceof Tn||t instanceof ps))throw new re(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child($e.fromString(e,...n));return Nb(r),new Tn(t.firestore,t instanceof ps?t.converter:null,new ie(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new QC(this,"async_queue_retry"),this.Vu=()=>{const r=gh();r&&Z("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=gh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=gh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Kr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Ts(e))throw e;Z("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw yt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Lv.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ue()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class qu extends qv{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new Vb,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Vb(e),this._firestoreClient=void 0,await e}}}function XB(t,e,n){n||(n="(default)");const r=No(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Xa(s,e))return i;throw new re(Y.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new re(Y.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new re(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function Hv(t){if(t._terminated)throw new re(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||JB(t),t._firestoreClient}function JB(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,c,d){return new k$(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,mR(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new qB(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new dl(vt.fromBase64String(e))}catch(n){throw new re(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new dl(vt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new re(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wv{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gv{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new re(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new re(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return _e(this._lat,e._lat)||_e(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qv{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZB=/^__.*__$/;class e8{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Cs(e,this.data,this.fieldMask,n,this.fieldTransforms):new Il(e,this.data,n,this.fieldTransforms)}}function yR(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue()}}class Yv{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Yv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Ef(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(yR(this.Cu)&&ZB.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class t8{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||pp(e)}Qu(e,n,r,i=!1){return new Yv({Cu:e,methodName:n,qu:r,path:ot.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function vR(t){const e=t._freezeSettings(),n=pp(t._databaseId);return new t8(t._databaseId,!!e.ignoreUndefinedProperties,n)}function n8(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);xR("Data must be an object, but it was:",o,r);const a=wR(r,o);let l,c;if(s.merge)l=new sr(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const f=i8(e,h,n);if(!o.contains(f))throw new re(Y.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);o8(d,f)||d.push(f)}l=new sr(d),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new e8(new yn(a),l,c)}class Xv extends Wv{_toFieldTransform(e){return new cC(e.path,new rl)}isEqual(e){return e instanceof Xv}}function r8(t,e,n,r=!1){return Jv(n,t.Qu(r?4:3,e))}function Jv(t,e){if(_R(t=kt(t)))return xR("Unsupported field value:",e,t),wR(t,e);if(t instanceof Wv)return function(r,i){if(!yR(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Jv(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=kt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return W$(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=lt.fromDate(r);return{timestampValue:ol(i.serializer,s)}}if(r instanceof lt){const s=new lt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:ol(i.serializer,s)}}if(r instanceof Gv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof dl)return{bytesValue:gC(i.serializer,r._byteString)};if(r instanceof Tn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Tv(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Qv)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return xv(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${vp(r)}`)}(t,e)}function wR(t,e){const n={};return MA(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):El(t,(r,i)=>{const s=Jv(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function _R(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof lt||t instanceof Gv||t instanceof dl||t instanceof Tn||t instanceof Wv||t instanceof Qv)}function xR(t,e,n){if(!_R(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=vp(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function i8(t,e,n){if((e=kt(e))instanceof Kv)return e._internalPath;if(typeof e=="string")return bR(t,e);throw Ef("Field path arguments must be of type string or ",t,!1,void 0,n)}const s8=new RegExp("[~\\*/\\[\\]]");function bR(t,e,n){if(e.search(s8)>=0)throw Ef(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Kv(...e.split("."))._internalPath}catch{throw Ef(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Ef(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new re(Y.INVALID_ARGUMENT,a+t+l)}function o8(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ER{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Tn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new a8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(IR("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class a8 extends ER{data(){return super.data()}}function IR(t,e){return typeof e=="string"?bR(t,e):e instanceof Kv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l8(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new re(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Zv{}class c8 extends Zv{}function u8(t,e,...n){let r=[];e instanceof Zv&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof tw).length,a=s.filter(l=>l instanceof ew).length;if(o>1||o>0&&a>0)throw new re(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class ew extends c8{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new ew(e,n,r)}_apply(e){const n=this._parse(e);return SR(e._query,n),new Al(e.firestore,e.converter,h0(e._query,n))}_parse(e){const n=vR(e.firestore);return function(s,o,a,l,c,d,h){let f;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new re(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){Lb(h,d);const m=[];for(const v of h)m.push(Ob(l,s,v));f={arrayValue:{values:m}}}else f=Ob(l,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||Lb(h,d),f=r8(a,o,h,d==="in"||d==="not-in");return De.create(c,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class tw extends Zv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new tw(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Be.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)SR(o,l),o=h0(o,l)}(e._query,n),new Al(e.firestore,e.converter,h0(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function Ob(t,e,n){if(typeof(n=kt(n))=="string"){if(n==="")throw new re(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!XA(e)&&n.indexOf("/")!==-1)throw new re(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child($e.fromString(n));if(!ie.isDocumentKey(r))throw new re(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return _u(t,new ie(r))}if(n instanceof Tn)return _u(t,n._key);throw new re(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vp(n)}.`)}function Lb(t,e){if(!Array.isArray(t)||t.length===0)throw new re(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function SR(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new re(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new re(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class d8{convertValue(e,n="none"){switch(wo(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(vs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ue()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return El(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>nt(o.doubleValue));return new Qv(s)}convertGeoPoint(e){return new Gv(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=vv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(vu(e));default:return null}}convertTimestamp(e){const n=Ti(e);return new lt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=$e.fromString(e);fe(TC(r));const i=new vo(r.get(1),r.get(3)),s=new ie(r.popFirst(5));return i.isEqual(n)||yt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h8(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class TR extends ER{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new yh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(IR("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class yh extends TR{data(e={}){return super.data(e)}}class f8{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new xc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new yh(this._firestore,this._userDataWriter,r.key,r,new xc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new re(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new yh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new xc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new yh(i._firestore,i._userDataWriter,a.doc.key,a.doc,new xc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:p8(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function p8(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m8(t){t=Io(t,Tn);const e=Io(t.firestore,qu);return WB(Hv(e),t._key).then(n=>w8(e,t,n))}class AR extends d8{constructor(e){super(),this.firestore=e}convertBytes(e){return new dl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Tn(this.firestore,null,n)}}function g8(t){t=Io(t,Al);const e=Io(t.firestore,qu),n=Hv(e),r=new AR(e);return l8(t._query),GB(n,t._query).then(i=>new f8(e,r,t,i))}function y8(t,e,n){t=Io(t,Tn);const r=Io(t.firestore,qu),i=h8(t.converter,e,n);return CR(r,[n8(vR(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,xn.none())])}function v8(t){return CR(Io(t.firestore,qu),[new up(t._key,xn.none())])}function CR(t,e){return function(r,i){const s=new Kr;return r.asyncQueue.enqueueAndForget(async()=>RB(await KB(r),i,s)),s.promise}(Hv(t),e)}function w8(t,e,n){const r=n.docs.get(e._key),i=new AR(t);return new TR(t,i,e._key,r,new xc(n.hasPendingWrites,n.fromCache),e.converter)}class _8{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=I8(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function x8(t){return new _8(t)}class b8{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Iu.provider,this._offlineComponentProvider={build:n=>new dR(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class E8{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=Iu.provider,this._offlineComponentProvider={build:n=>new BB(n,e==null?void 0:e.cacheSizeBytes)}}}function I8(t){return new b8(void 0)}function S8(){return new E8}function T8(){return new Xv("serverTimestamp")}(function(e,n=!0){(function(i){bl=i})(_l),Wr(new Cr("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new qu(new Z9(r.getProvider("auth-internal")),new r$(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new re(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new vo(c.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),ar(R1,"4.7.3",e),ar(R1,"4.7.3","esm2017")})();const RR="@firebase/installations",nw="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR=1e4,NR=`w:${nw}`,PR="FIS_v2",A8="https://firebaseinstallations.googleapis.com/v1",C8=60*60*1e3,R8="installations",k8="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N8={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},So=new ko(R8,k8,N8);function DR(t){return t instanceof kr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VR({projectId:t}){return`${A8}/projects/${t}/installations`}function OR(t){return{token:t.token,requestStatus:2,expiresIn:D8(t.expiresIn),creationTime:Date.now()}}async function LR(t,e){const r=(await e.json()).error;return So.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function zR({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function P8(t,{refreshToken:e}){const n=zR(t);return n.append("Authorization",V8(e)),n}async function MR(t){const e=await t();return e.status>=500&&e.status<600?t():e}function D8(t){return Number(t.replace("s","000"))}function V8(t){return`${PR} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function O8({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=VR(t),i=zR(t),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={fid:n,authVersion:PR,appId:t.appId,sdkVersion:NR},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await MR(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:OR(c.authToken)}}else throw await LR("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L8(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z8=/^[cdef][\w-]{21}$/,T0="";function M8(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=j8(t);return z8.test(n)?n:T0}catch{return T0}}function j8(t){return L8(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wp(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FR=new Map;function $R(t,e){const n=wp(t);UR(n,e),F8(n,e)}function UR(t,e){const n=FR.get(t);if(n)for(const r of n)r(e)}function F8(t,e){const n=$8();n&&n.postMessage({key:t,fid:e}),U8()}let Js=null;function $8(){return!Js&&"BroadcastChannel"in self&&(Js=new BroadcastChannel("[Firebase] FID Change"),Js.onmessage=t=>{UR(t.data.key,t.data.fid)}),Js}function U8(){FR.size===0&&Js&&(Js.close(),Js=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B8="firebase-installations-database",q8=1,To="firebase-installations-store";let Pm=null;function rw(){return Pm||(Pm=O2(B8,q8,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(To)}}})),Pm}async function If(t,e){const n=wp(t),i=(await rw()).transaction(To,"readwrite"),s=i.objectStore(To),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&$R(t,e.fid),e}async function BR(t){const e=wp(t),r=(await rw()).transaction(To,"readwrite");await r.objectStore(To).delete(e),await r.done}async function _p(t,e){const n=wp(t),i=(await rw()).transaction(To,"readwrite"),s=i.objectStore(To),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&$R(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iw(t){let e;const n=await _p(t.appConfig,r=>{const i=H8(r),s=K8(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===T0?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function H8(t){const e=t||{fid:M8(),registrationStatus:0};return qR(e)}function K8(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(So.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=W8(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:G8(t)}:{installationEntry:e}}async function W8(t,e){try{const n=await O8(t,e);return If(t.appConfig,n)}catch(n){throw DR(n)&&n.customData.serverCode===409?await BR(t.appConfig):await If(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function G8(t){let e=await zb(t.appConfig);for(;e.registrationStatus===1;)await jR(100),e=await zb(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await iw(t);return r||n}return e}function zb(t){return _p(t,e=>{if(!e)throw So.create("installation-not-found");return qR(e)})}function qR(t){return Q8(t)?{fid:t.fid,registrationStatus:0}:t}function Q8(t){return t.registrationStatus===1&&t.registrationTime+kR<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y8({appConfig:t,heartbeatServiceProvider:e},n){const r=X8(t,n),i=P8(t,n),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={installation:{sdkVersion:NR,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await MR(()=>fetch(r,a));if(l.ok){const c=await l.json();return OR(c)}else throw await LR("Generate Auth Token",l)}function X8(t,{fid:e}){return`${VR(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sw(t,e=!1){let n;const r=await _p(t.appConfig,s=>{if(!HR(s))throw So.create("not-registered");const o=s.authToken;if(!e&&e7(o))return s;if(o.requestStatus===1)return n=J8(t,e),s;{if(!navigator.onLine)throw So.create("app-offline");const a=n7(s);return n=Z8(t,a),a}});return n?await n:r.authToken}async function J8(t,e){let n=await Mb(t.appConfig);for(;n.authToken.requestStatus===1;)await jR(100),n=await Mb(t.appConfig);const r=n.authToken;return r.requestStatus===0?sw(t,e):r}function Mb(t){return _p(t,e=>{if(!HR(e))throw So.create("not-registered");const n=e.authToken;return r7(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function Z8(t,e){try{const n=await Y8(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await If(t.appConfig,r),n}catch(n){if(DR(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await BR(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await If(t.appConfig,r)}throw n}}function HR(t){return t!==void 0&&t.registrationStatus===2}function e7(t){return t.requestStatus===2&&!t7(t)}function t7(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+C8}function n7(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function r7(t){return t.requestStatus===1&&t.requestTime+kR<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function i7(t){const e=t,{installationEntry:n,registrationPromise:r}=await iw(e);return r?r.catch(console.error):sw(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s7(t,e=!1){const n=t;return await o7(n),(await sw(n,e)).token}async function o7(t){const{registrationPromise:e}=await iw(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a7(t){if(!t||!t.options)throw Dm("App Configuration");if(!t.name)throw Dm("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Dm(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Dm(t){return So.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KR="installations",l7="installations-internal",c7=t=>{const e=t.getProvider("app").getImmediate(),n=a7(e),r=No(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},u7=t=>{const e=t.getProvider("app").getImmediate(),n=No(e,KR).getImmediate();return{getId:()=>i7(n),getToken:i=>s7(n,i)}};function d7(){Wr(new Cr(KR,c7,"PUBLIC")),Wr(new Cr(l7,u7,"PRIVATE"))}d7();ar(RR,nw);ar(RR,nw,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sf="analytics",h7="firebase_id",f7="origin",p7=60*1e3,m7="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ow="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const An=new Zf("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g7={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Hn=new ko("analytics","Analytics",g7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y7(t){if(!t.startsWith(ow)){const e=Hn.create("invalid-gtag-resource",{gtagURL:t});return An.warn(e.message),""}return t}function WR(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function v7(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function w7(t,e){const n=v7("firebase-js-sdk-policy",{createScriptURL:y7}),r=document.createElement("script"),i=`${ow}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function _7(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function x7(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await WR(n)).find(c=>c.measurementId===i);l&&await e[l.appId]}}catch(a){An.error(a)}t("config",i,s)}async function b7(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await WR(n);for(const l of o){const c=a.find(h=>h.measurementId===l),d=c&&e[c.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){An.error(s)}}function E7(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await b7(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await x7(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,c]=o;t("get",a,l,c)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){An.error(a)}}return i}function I7(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=E7(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function S7(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(ow)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T7=30,A7=1e3;class C7{constructor(e={},n=A7){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const GR=new C7;function R7(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function k7(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:R7(r)},s=m7.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Hn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function N7(t,e=GR,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Hn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Hn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new V7;return setTimeout(async()=>{a.abort()},p7),QR({appId:r,apiKey:i,measurementId:s},o,a,e)}async function QR(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=GR){var s;const{appId:o,measurementId:a}=t;try{await P7(r,e)}catch(l){if(a)return An.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await k7(t);return i.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!D7(c)){if(i.deleteThrottleMetadata(o),a)return An.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const d=Number((s=c==null?void 0:c.customData)===null||s===void 0?void 0:s.httpStatus)===503?e1(n,i.intervalMillis,T7):e1(n,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return i.setThrottleMetadata(o,h),An.debug(`Calling attemptFetch again in ${d} millis`),QR(t,h,r,i)}}function P7(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Hn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function D7(t){if(!(t instanceof kr)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class V7{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function O7(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L7(){if(ev())try{await P2()}catch(t){return An.warn(Hn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return An.warn(Hn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function z7(t,e,n,r,i,s,o){var a;const l=N7(t);l.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&An.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>An.error(m)),e.push(l);const c=L7().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([l,c]);S7(s)||w7(s,d.measurementId),i("js",new Date);const f=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return f[f7]="firebase",f.update=!0,h!=null&&(f[h7]=h),i("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M7{constructor(e){this.app=e}_delete(){return delete Mc[this.app.options.appId],Promise.resolve()}}let Mc={},jb=[];const Fb={};let Vm="dataLayer",j7="gtag",$b,YR,Ub=!1;function F7(){const t=[];if(k2()&&t.push("This is a browser extension environment."),dj()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Hn.create("invalid-analytics-context",{errorInfo:e});An.warn(n.message)}}function $7(t,e,n){F7();const r=t.options.appId;if(!r)throw Hn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)An.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Hn.create("no-api-key");if(Mc[r]!=null)throw Hn.create("already-exists",{id:r});if(!Ub){_7(Vm);const{wrappedGtag:s,gtagCore:o}=I7(Mc,jb,Fb,Vm,j7);YR=s,$b=o,Ub=!0}return Mc[r]=z7(t,jb,Fb,e,$b,Vm,n),new M7(t)}function U7(t=z2()){t=kt(t);const e=No(t,Sf);return e.isInitialized()?e.getImmediate():B7(t)}function B7(t,e={}){const n=No(t,Sf);if(n.isInitialized()){const i=n.getImmediate();if(Xa(e,n.getOptions()))return i;throw Hn.create("already-initialized")}return n.initialize({options:e})}function q7(t,e,n,r){t=kt(t),O7(YR,Mc[t.app.options.appId],e,n,r).catch(i=>An.error(i))}const Bb="@firebase/analytics",qb="0.10.8";function H7(){Wr(new Cr(Sf,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return $7(r,i,n)},"PUBLIC")),Wr(new Cr("analytics-internal",t,"PRIVATE")),ar(Bb,qb),ar(Bb,qb,"esm2017");function t(e){try{const n=e.getProvider(Sf).getImmediate();return{logEvent:(r,i,s)=>q7(n,r,i,s)}}catch(n){throw Hn.create("interop-component-reg-failed",{reason:n})}}}H7();const K7={apiKey:"AIzaSyBRvglSh40aRJFOA9SNxoyBhNjslW_7p8k",authDomain:"detective-board-b108b.firebaseapp.com",projectId:"detective-board-b108b",storageBucket:"detective-board-b108b.firebasestorage.app",messagingSenderId:"140107009046",appId:"1:140107009046:web:49e3c650ea0e90a5f2b937",measurementId:"G-TBJ91VEM4Y"},aw=L2(K7);U7(aw);const pi=W9(aw),$d=XB(aw,{localCache:x8({tabManager:S8()}),experimentalForceLongPolling:!0}),W7=new oi,XR=D.createContext();function lw(){return D.useContext(XR)}function G7({children:t}){const[e,n]=D.useState(null),[r,i]=D.useState(!0);D.useEffect(()=>O6(pi,a=>{n(a),i(!1)}),[]);const s={currentUser:e};return p.jsx(XR.Provider,{value:s,children:!r&&t})}const Q7=({onSwitchToSignUp:t,onForgotPassword:e,isDarkMode:n})=>{const[r,i]=D.useState(""),[s,o]=D.useState(""),[a,l]=D.useState(""),c=async h=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r)){l("Por favor, introduce un correo electrnico vlido.");return}h.preventDefault(),l("");try{if(await R6(pi,r,s),!pi.currentUser.emailVerified){l("Por favor, verifica tu correo electrnico antes de iniciar sesin."),await pi.signOut();return}}catch(m){console.error(m),l("Error: "+m.message)}},d=async()=>{l("");try{await n9(pi,W7)}catch(h){console.error(h),h.code==="auth/cancelled-popup-request"?l(""):l("Error Google: "+h.message)}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:c,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${n?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${n?"text-white":"text-gray-800"}`,children:"INICIAR SESIN"}),a&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:a}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${n?"text-zinc-400":"text-gray-600"}`,htmlFor:"login-email",children:"Correo"}),p.jsxs("div",{className:"relative",children:[p.jsx(Wy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${n?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"login-email",type:"email",placeholder:"detective@agencia.com",value:r,onChange:h=>i(h.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${n?"text-zinc-400":"text-gray-600"}`,htmlFor:"login-password",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Ya,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${n?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"login-password",type:"password",placeholder:"",value:s,onChange:h=>o(h.target.value),required:!0})]})]}),p.jsxs("div",{className:"flex flex-col gap-4",children:[p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Entrar"}),p.jsxs("div",{className:"relative flex py-1 items-center",children:[p.jsx("div",{className:`flex-grow border-t ${n?"border-zinc-600":"border-gray-300"}`}),p.jsx("span",{className:`flex-shrink mx-2 text-xs ${n?"text-zinc-500":"text-gray-400"}`,children:"O"}),p.jsx("div",{className:`flex-grow border-t ${n?"border-zinc-600":"border-gray-300"}`})]}),p.jsxs("button",{onClick:d,type:"button",className:`flex items-center justify-center gap-3 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-all active:scale-95 ${n?"bg-white text-gray-700 hover:bg-gray-100":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[p.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),p.jsx("div",{className:"text-center mt-6",children:p.jsx("a",{onClick:e,className:"inline-block align-baseline font-bold text-sm text-blue-400 hover:text-blue-300 cursor-pointer",children:"Olvidaste tu contrasea?"})})]}),p.jsxs("p",{className:`text-center text-xs ${n?"text-zinc-500":"text-gray-500"}`,children:["No tienes cuenta?"," ",p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Regstrate aqu."})]})]})};function JR(t,e){return function(){return t.apply(e,arguments)}}const{toString:Y7}=Object.prototype,{getPrototypeOf:cw}=Object,{iterator:xp,toStringTag:ZR}=Symbol,bp=(t=>e=>{const n=Y7.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Nr=t=>(t=t.toLowerCase(),e=>bp(e)===t),Ep=t=>e=>typeof e===t,{isArray:Cl}=Array,hl=Ep("undefined");function Hu(t){return t!==null&&!hl(t)&&t.constructor!==null&&!hl(t.constructor)&&Cn(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const ek=Nr("ArrayBuffer");function X7(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&ek(t.buffer),e}const J7=Ep("string"),Cn=Ep("function"),tk=Ep("number"),Ku=t=>t!==null&&typeof t=="object",Z7=t=>t===!0||t===!1,vh=t=>{if(bp(t)!=="object")return!1;const e=cw(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(ZR in t)&&!(xp in t)},eq=t=>{if(!Ku(t)||Hu(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},tq=Nr("Date"),nq=Nr("File"),rq=Nr("Blob"),iq=Nr("FileList"),sq=t=>Ku(t)&&Cn(t.pipe),oq=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||Cn(t.append)&&((e=bp(t))==="formdata"||e==="object"&&Cn(t.toString)&&t.toString()==="[object FormData]"))},aq=Nr("URLSearchParams"),[lq,cq,uq,dq]=["ReadableStream","Request","Response","Headers"].map(Nr),hq=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wu(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let r,i;if(typeof t!="object"&&(t=[t]),Cl(t))for(r=0,i=t.length;r<i;r++)e.call(null,t[r],r,t);else{if(Hu(t))return;const s=n?Object.getOwnPropertyNames(t):Object.keys(t),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,t[a],a,t)}}function nk(t,e){if(Hu(t))return null;e=e.toLowerCase();const n=Object.keys(t);let r=n.length,i;for(;r-- >0;)if(i=n[r],e===i.toLowerCase())return i;return null}const Zs=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,rk=t=>!hl(t)&&t!==Zs;function A0(){const{caseless:t,skipUndefined:e}=rk(this)&&this||{},n={},r=(i,s)=>{if(s==="__proto__"||s==="constructor"||s==="prototype")return;const o=t&&nk(n,s)||s;vh(n[o])&&vh(i)?n[o]=A0(n[o],i):vh(i)?n[o]=A0({},i):Cl(i)?n[o]=i.slice():(!e||!hl(i))&&(n[o]=i)};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&Wu(arguments[i],r);return n}const fq=(t,e,n,{allOwnKeys:r}={})=>(Wu(e,(i,s)=>{n&&Cn(i)?Object.defineProperty(t,s,{value:JR(i,n),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(t,s,{value:i,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:r}),t),pq=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),mq=(t,e,n,r)=>{t.prototype=Object.create(e.prototype,r),Object.defineProperty(t.prototype,"constructor",{value:t,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},gq=(t,e,n,r)=>{let i,s,o;const a={};if(e=e||{},t==null)return e;do{for(i=Object.getOwnPropertyNames(t),s=i.length;s-- >0;)o=i[s],(!r||r(o,t,e))&&!a[o]&&(e[o]=t[o],a[o]=!0);t=n!==!1&&cw(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},yq=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const r=t.indexOf(e,n);return r!==-1&&r===n},vq=t=>{if(!t)return null;if(Cl(t))return t;let e=t.length;if(!tk(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},wq=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&cw(Uint8Array)),_q=(t,e)=>{const r=(t&&t[xp]).call(t);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(t,s[0],s[1])}},xq=(t,e)=>{let n;const r=[];for(;(n=t.exec(e))!==null;)r.push(n);return r},bq=Nr("HTMLFormElement"),Eq=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),Hb=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),Iq=Nr("RegExp"),ik=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),r={};Wu(n,(i,s)=>{let o;(o=e(i,s,t))!==!1&&(r[s]=o||i)}),Object.defineProperties(t,r)},Sq=t=>{ik(t,(e,n)=>{if(Cn(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=t[n];if(Cn(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},Tq=(t,e)=>{const n={},r=i=>{i.forEach(s=>{n[s]=!0})};return Cl(t)?r(t):r(String(t).split(e)),n},Aq=()=>{},Cq=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function Rq(t){return!!(t&&Cn(t.append)&&t[ZR]==="FormData"&&t[xp])}const kq=t=>{const e=new Array(10),n=(r,i)=>{if(Ku(r)){if(e.indexOf(r)>=0)return;if(Hu(r))return r;if(!("toJSON"in r)){e[i]=r;const s=Cl(r)?[]:{};return Wu(r,(o,a)=>{const l=n(o,i+1);!hl(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return n(t,0)},Nq=Nr("AsyncFunction"),Pq=t=>t&&(Ku(t)||Cn(t))&&Cn(t.then)&&Cn(t.catch),sk=((t,e)=>t?setImmediate:e?((n,r)=>(Zs.addEventListener("message",({source:i,data:s})=>{i===Zs&&s===n&&r.length&&r.shift()()},!1),i=>{r.push(i),Zs.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Cn(Zs.postMessage)),Dq=typeof queueMicrotask<"u"?queueMicrotask.bind(Zs):typeof process<"u"&&process.nextTick||sk,Vq=t=>t!=null&&Cn(t[xp]),W={isArray:Cl,isArrayBuffer:ek,isBuffer:Hu,isFormData:oq,isArrayBufferView:X7,isString:J7,isNumber:tk,isBoolean:Z7,isObject:Ku,isPlainObject:vh,isEmptyObject:eq,isReadableStream:lq,isRequest:cq,isResponse:uq,isHeaders:dq,isUndefined:hl,isDate:tq,isFile:nq,isBlob:rq,isRegExp:Iq,isFunction:Cn,isStream:sq,isURLSearchParams:aq,isTypedArray:wq,isFileList:iq,forEach:Wu,merge:A0,extend:fq,trim:hq,stripBOM:pq,inherits:mq,toFlatObject:gq,kindOf:bp,kindOfTest:Nr,endsWith:yq,toArray:vq,forEachEntry:_q,matchAll:xq,isHTMLForm:bq,hasOwnProperty:Hb,hasOwnProp:Hb,reduceDescriptors:ik,freezeMethods:Sq,toObjectSet:Tq,toCamelCase:Eq,noop:Aq,toFiniteNumber:Cq,findKey:nk,global:Zs,isContextDefined:rk,isSpecCompliantForm:Rq,toJSONObject:kq,isAsyncFn:Nq,isThenable:Pq,setImmediate:sk,asap:Dq,isIterable:Vq};let ge=class ok extends Error{static from(e,n,r,i,s,o){const a=new ok(e.message,n||e.code,r,i,s);return a.cause=e,a.name=e.name,o&&Object.assign(a,o),a}constructor(e,n,r,i,s){super(e),this.name="AxiosError",this.isAxiosError=!0,n&&(this.code=n),r&&(this.config=r),i&&(this.request=i),s&&(this.response=s,this.status=s.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:W.toJSONObject(this.config),code:this.code,status:this.status}}};ge.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";ge.ERR_BAD_OPTION="ERR_BAD_OPTION";ge.ECONNABORTED="ECONNABORTED";ge.ETIMEDOUT="ETIMEDOUT";ge.ERR_NETWORK="ERR_NETWORK";ge.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";ge.ERR_DEPRECATED="ERR_DEPRECATED";ge.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";ge.ERR_BAD_REQUEST="ERR_BAD_REQUEST";ge.ERR_CANCELED="ERR_CANCELED";ge.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";ge.ERR_INVALID_URL="ERR_INVALID_URL";const Oq=null;function C0(t){return W.isPlainObject(t)||W.isArray(t)}function ak(t){return W.endsWith(t,"[]")?t.slice(0,-2):t}function Kb(t,e,n){return t?t.concat(e).map(function(i,s){return i=ak(i),!n&&s?"["+i+"]":i}).join(n?".":""):e}function Lq(t){return W.isArray(t)&&!t.some(C0)}const zq=W.toFlatObject(W,{},null,function(e){return/^is[A-Z]/.test(e)});function Ip(t,e,n){if(!W.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=W.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,T){return!W.isUndefined(T[w])});const r=n.metaTokens,i=n.visitor||d,s=n.dots,o=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&W.isSpecCompliantForm(e);if(!W.isFunction(i))throw new TypeError("visitor must be a function");function c(v){if(v===null)return"";if(W.isDate(v))return v.toISOString();if(W.isBoolean(v))return v.toString();if(!l&&W.isBlob(v))throw new ge("Blob is not supported. Use a Buffer instead.");return W.isArrayBuffer(v)||W.isTypedArray(v)?l&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function d(v,w,T){let y=v;if(v&&!T&&typeof v=="object"){if(W.endsWith(w,"{}"))w=r?w:w.slice(0,-2),v=JSON.stringify(v);else if(W.isArray(v)&&Lq(v)||(W.isFileList(v)||W.endsWith(w,"[]"))&&(y=W.toArray(v)))return w=ak(w),y.forEach(function(S,C){!(W.isUndefined(S)||S===null)&&e.append(o===!0?Kb([w],C,s):o===null?w:w+"[]",c(S))}),!1}return C0(v)?!0:(e.append(Kb(T,w,s),c(v)),!1)}const h=[],f=Object.assign(zq,{defaultVisitor:d,convertValue:c,isVisitable:C0});function m(v,w){if(!W.isUndefined(v)){if(h.indexOf(v)!==-1)throw Error("Circular reference detected in "+w.join("."));h.push(v),W.forEach(v,function(y,_){(!(W.isUndefined(y)||y===null)&&i.call(e,y,W.isString(_)?_.trim():_,w,f))===!0&&m(y,w?w.concat(_):[_])}),h.pop()}}if(!W.isObject(t))throw new TypeError("data must be an object");return m(t),e}function Wb(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function uw(t,e){this._pairs=[],t&&Ip(t,this,e)}const lk=uw.prototype;lk.append=function(e,n){this._pairs.push([e,n])};lk.toString=function(e){const n=e?function(r){return e.call(this,r,Wb)}:Wb;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function Mq(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function ck(t,e,n){if(!e)return t;const r=n&&n.encode||Mq,i=W.isFunction(n)?{serialize:n}:n,s=i&&i.serialize;let o;if(s?o=s(e,i):o=W.isURLSearchParams(e)?e.toString():new uw(e,i).toString(r),o){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+o}return t}class Gb{constructor(){this.handlers=[]}use(e,n,r){return this.handlers.push({fulfilled:e,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){W.forEach(this.handlers,function(r){r!==null&&e(r)})}}const dw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1,legacyInterceptorReqResOrdering:!0},jq=typeof URLSearchParams<"u"?URLSearchParams:uw,Fq=typeof FormData<"u"?FormData:null,$q=typeof Blob<"u"?Blob:null,Uq={isBrowser:!0,classes:{URLSearchParams:jq,FormData:Fq,Blob:$q},protocols:["http","https","file","blob","url","data"]},hw=typeof window<"u"&&typeof document<"u",R0=typeof navigator=="object"&&navigator||void 0,Bq=hw&&(!R0||["ReactNative","NativeScript","NS"].indexOf(R0.product)<0),qq=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Hq=hw&&window.location.href||"http://localhost",Kq=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:hw,hasStandardBrowserEnv:Bq,hasStandardBrowserWebWorkerEnv:qq,navigator:R0,origin:Hq},Symbol.toStringTag,{value:"Module"})),nn={...Kq,...Uq};function Wq(t,e){return Ip(t,new nn.classes.URLSearchParams,{visitor:function(n,r,i,s){return nn.isNode&&W.isBuffer(n)?(this.append(r,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function Gq(t){return W.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Qq(t){const e={},n=Object.keys(t);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],e[s]=t[s];return e}function uk(t){function e(n,r,i,s){let o=n[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=n.length;return o=!o&&W.isArray(i)?i.length:o,l?(W.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!W.isObject(i[o]))&&(i[o]=[]),e(n,r,i[o],s)&&W.isArray(i[o])&&(i[o]=Qq(i[o])),!a)}if(W.isFormData(t)&&W.isFunction(t.entries)){const n={};return W.forEachEntry(t,(r,i)=>{e(Gq(r),i,n,0)}),n}return null}function Yq(t,e,n){if(W.isString(t))try{return(e||JSON.parse)(t),W.trim(t)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(t)}const Gu={transitional:dw,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,s=W.isObject(e);if(s&&W.isHTMLForm(e)&&(e=new FormData(e)),W.isFormData(e))return i?JSON.stringify(uk(e)):e;if(W.isArrayBuffer(e)||W.isBuffer(e)||W.isStream(e)||W.isFile(e)||W.isBlob(e)||W.isReadableStream(e))return e;if(W.isArrayBufferView(e))return e.buffer;if(W.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Wq(e,this.formSerializer).toString();if((a=W.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return Ip(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(n.setContentType("application/json",!1),Yq(e)):e}],transformResponse:[function(e){const n=this.transitional||Gu.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(W.isResponse(e)||W.isReadableStream(e))return e;if(e&&W.isString(e)&&(r&&!this.responseType||i)){const o=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(a){if(o)throw a.name==="SyntaxError"?ge.from(a,ge.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:nn.classes.FormData,Blob:nn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};W.forEach(["delete","get","head","post","put","patch"],t=>{Gu.headers[t]={}});const Xq=W.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Jq=t=>{const e={};let n,r,i;return t&&t.split(`
`).forEach(function(o){i=o.indexOf(":"),n=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!n||e[n]&&Xq[n])&&(n==="set-cookie"?e[n]?e[n].push(r):e[n]=[r]:e[n]=e[n]?e[n]+", "+r:r)}),e},Qb=Symbol("internals");function ac(t){return t&&String(t).trim().toLowerCase()}function wh(t){return t===!1||t==null?t:W.isArray(t)?t.map(wh):String(t)}function Zq(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(t);)e[r[1]]=r[2];return e}const eH=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Om(t,e,n,r,i){if(W.isFunction(r))return r.call(this,e,n);if(i&&(e=n),!!W.isString(e)){if(W.isString(r))return e.indexOf(r)!==-1;if(W.isRegExp(r))return r.test(e)}}function tH(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,r)=>n.toUpperCase()+r)}function nH(t,e){const n=W.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(t,r+n,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}let Rn=class{constructor(e){e&&this.set(e)}set(e,n,r){const i=this;function s(a,l,c){const d=ac(l);if(!d)throw new Error("header name must be a non-empty string");const h=W.findKey(i,d);(!h||i[h]===void 0||c===!0||c===void 0&&i[h]!==!1)&&(i[h||l]=wh(a))}const o=(a,l)=>W.forEach(a,(c,d)=>s(c,d,l));if(W.isPlainObject(e)||e instanceof this.constructor)o(e,n);else if(W.isString(e)&&(e=e.trim())&&!eH(e))o(Jq(e),n);else if(W.isObject(e)&&W.isIterable(e)){let a={},l,c;for(const d of e){if(!W.isArray(d))throw TypeError("Object iterator must return a key-value pair");a[c=d[0]]=(l=a[c])?W.isArray(l)?[...l,d[1]]:[l,d[1]]:d[1]}o(a,n)}else e!=null&&s(n,e,r);return this}get(e,n){if(e=ac(e),e){const r=W.findKey(this,e);if(r){const i=this[r];if(!n)return i;if(n===!0)return Zq(i);if(W.isFunction(n))return n.call(this,i,r);if(W.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=ac(e),e){const r=W.findKey(this,e);return!!(r&&this[r]!==void 0&&(!n||Om(this,this[r],r,n)))}return!1}delete(e,n){const r=this;let i=!1;function s(o){if(o=ac(o),o){const a=W.findKey(r,o);a&&(!n||Om(r,r[a],a,n))&&(delete r[a],i=!0)}}return W.isArray(e)?e.forEach(s):s(e),i}clear(e){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const s=n[r];(!e||Om(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const n=this,r={};return W.forEach(this,(i,s)=>{const o=W.findKey(r,s);if(o){n[o]=wh(i),delete n[s];return}const a=e?tH(s):String(s).trim();a!==s&&delete n[s],n[a]=wh(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return W.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=e&&W.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const r=new this(e);return n.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[Qb]=this[Qb]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=ac(o);r[a]||(nH(i,o),r[a]=!0)}return W.isArray(e)?e.forEach(s):s(e),this}};Rn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);W.reduceDescriptors(Rn.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(r){this[n]=r}}});W.freezeMethods(Rn);function Lm(t,e){const n=this||Gu,r=e||n,i=Rn.from(r.headers);let s=r.data;return W.forEach(t,function(a){s=a.call(n,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function dk(t){return!!(t&&t.__CANCEL__)}let Qu=class extends ge{constructor(e,n,r){super(e??"canceled",ge.ERR_CANCELED,n,r),this.name="CanceledError",this.__CANCEL__=!0}};function hk(t,e,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?t(n):e(new ge("Request failed with status code "+n.status,[ge.ERR_BAD_REQUEST,ge.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function rH(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function iH(t,e){t=t||10;const n=new Array(t),r=new Array(t);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),d=r[s];o||(o=c),n[i]=l,r[i]=c;let h=s,f=0;for(;h!==i;)f+=n[h++],h=h%t;if(i=(i+1)%t,i===s&&(s=(s+1)%t),c-o<e)return;const m=d&&c-d;return m?Math.round(f*1e3/m):void 0}}function sH(t,e){let n=0,r=1e3/e,i,s;const o=(c,d=Date.now())=>{n=d,i=null,s&&(clearTimeout(s),s=null),t(...c)};return[(...c)=>{const d=Date.now(),h=d-n;h>=r?o(c,d):(i=c,s||(s=setTimeout(()=>{s=null,o(i)},r-h)))},()=>i&&o(i)]}const Tf=(t,e,n=3)=>{let r=0;const i=iH(50,250);return sH(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-r,c=i(l),d=o<=a;r=o;const h={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&d?(a-o)/c:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};t(h)},n)},Yb=(t,e)=>{const n=t!=null;return[r=>e[0]({lengthComputable:n,total:t,loaded:r}),e[1]]},Xb=t=>(...e)=>W.asap(()=>t(...e)),oH=nn.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,nn.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(nn.origin),nn.navigator&&/(msie|trident)/i.test(nn.navigator.userAgent)):()=>!0,aH=nn.hasStandardBrowserEnv?{write(t,e,n,r,i,s,o){if(typeof document>"u")return;const a=[`${t}=${encodeURIComponent(e)}`];W.isNumber(n)&&a.push(`expires=${new Date(n).toUTCString()}`),W.isString(r)&&a.push(`path=${r}`),W.isString(i)&&a.push(`domain=${i}`),s===!0&&a.push("secure"),W.isString(o)&&a.push(`SameSite=${o}`),document.cookie=a.join("; ")},read(t){if(typeof document>"u")return null;const e=document.cookie.match(new RegExp("(?:^|; )"+t+"=([^;]*)"));return e?decodeURIComponent(e[1]):null},remove(t){this.write(t,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function lH(t){return typeof t!="string"?!1:/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function cH(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function fk(t,e,n){let r=!lH(e);return t&&(r||n==!1)?cH(t,e):e}const Jb=t=>t instanceof Rn?{...t}:t;function Ao(t,e){e=e||{};const n={};function r(c,d,h,f){return W.isPlainObject(c)&&W.isPlainObject(d)?W.merge.call({caseless:f},c,d):W.isPlainObject(d)?W.merge({},d):W.isArray(d)?d.slice():d}function i(c,d,h,f){if(W.isUndefined(d)){if(!W.isUndefined(c))return r(void 0,c,h,f)}else return r(c,d,h,f)}function s(c,d){if(!W.isUndefined(d))return r(void 0,d)}function o(c,d){if(W.isUndefined(d)){if(!W.isUndefined(c))return r(void 0,c)}else return r(void 0,d)}function a(c,d,h){if(h in e)return r(c,d);if(h in t)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,d,h)=>i(Jb(c),Jb(d),h,!0)};return W.forEach(Object.keys({...t,...e}),function(d){if(d==="__proto__"||d==="constructor"||d==="prototype")return;const h=W.hasOwnProp(l,d)?l[d]:i,f=h(t[d],e[d],d);W.isUndefined(f)&&h!==a||(n[d]=f)}),n}const pk=t=>{const e=Ao({},t);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:a}=e;if(e.headers=o=Rn.from(o),e.url=ck(fk(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):""))),W.isFormData(n)){if(nn.hasStandardBrowserEnv||nn.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if(W.isFunction(n.getHeaders)){const l=n.getHeaders(),c=["content-type","content-length"];Object.entries(l).forEach(([d,h])=>{c.includes(d.toLowerCase())&&o.set(d,h)})}}if(nn.hasStandardBrowserEnv&&(r&&W.isFunction(r)&&(r=r(e)),r||r!==!1&&oH(e.url))){const l=i&&s&&aH.read(s);l&&o.set(i,l)}return e},uH=typeof XMLHttpRequest<"u",dH=uH&&function(t){return new Promise(function(n,r){const i=pk(t);let s=i.data;const o=Rn.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=i,d,h,f,m,v;function w(){m&&m(),v&&v(),i.cancelToken&&i.cancelToken.unsubscribe(d),i.signal&&i.signal.removeEventListener("abort",d)}let T=new XMLHttpRequest;T.open(i.method.toUpperCase(),i.url,!0),T.timeout=i.timeout;function y(){if(!T)return;const S=Rn.from("getAllResponseHeaders"in T&&T.getAllResponseHeaders()),O={data:!a||a==="text"||a==="json"?T.responseText:T.response,status:T.status,statusText:T.statusText,headers:S,config:t,request:T};hk(function(A){n(A),w()},function(A){r(A),w()},O),T=null}"onloadend"in T?T.onloadend=y:T.onreadystatechange=function(){!T||T.readyState!==4||T.status===0&&!(T.responseURL&&T.responseURL.indexOf("file:")===0)||setTimeout(y)},T.onabort=function(){T&&(r(new ge("Request aborted",ge.ECONNABORTED,t,T)),T=null)},T.onerror=function(C){const O=C&&C.message?C.message:"Network Error",z=new ge(O,ge.ERR_NETWORK,t,T);z.event=C||null,r(z),T=null},T.ontimeout=function(){let C=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const O=i.transitional||dw;i.timeoutErrorMessage&&(C=i.timeoutErrorMessage),r(new ge(C,O.clarifyTimeoutError?ge.ETIMEDOUT:ge.ECONNABORTED,t,T)),T=null},s===void 0&&o.setContentType(null),"setRequestHeader"in T&&W.forEach(o.toJSON(),function(C,O){T.setRequestHeader(O,C)}),W.isUndefined(i.withCredentials)||(T.withCredentials=!!i.withCredentials),a&&a!=="json"&&(T.responseType=i.responseType),c&&([f,v]=Tf(c,!0),T.addEventListener("progress",f)),l&&T.upload&&([h,m]=Tf(l),T.upload.addEventListener("progress",h),T.upload.addEventListener("loadend",m)),(i.cancelToken||i.signal)&&(d=S=>{T&&(r(!S||S.type?new Qu(null,t,T):S),T.abort(),T=null)},i.cancelToken&&i.cancelToken.subscribe(d),i.signal&&(i.signal.aborted?d():i.signal.addEventListener("abort",d)));const _=rH(i.url);if(_&&nn.protocols.indexOf(_)===-1){r(new ge("Unsupported protocol "+_+":",ge.ERR_BAD_REQUEST,t));return}T.send(s||null)})},hH=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let r=new AbortController,i;const s=function(c){if(!i){i=!0,a();const d=c instanceof Error?c:this.reason;r.abort(d instanceof ge?d:new Qu(d instanceof Error?d.message:d))}};let o=e&&setTimeout(()=>{o=null,s(new ge(`timeout of ${e}ms exceeded`,ge.ETIMEDOUT))},e);const a=()=>{t&&(o&&clearTimeout(o),o=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),t=null)};t.forEach(c=>c.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>W.asap(a),l}},fH=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let r=0,i;for(;r<n;)i=r+e,yield t.slice(r,i),r=i},pH=async function*(t,e){for await(const n of mH(t))yield*fH(n,e)},mH=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:r}=await e.read();if(n)break;yield r}}finally{await e.cancel()}},Zb=(t,e,n,r)=>{const i=pH(t,e);let s=0,o,a=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:d}=await i.next();if(c){a(),l.close();return}let h=d.byteLength;if(n){let f=s+=h;n(f)}l.enqueue(new Uint8Array(d))}catch(c){throw a(c),c}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},eE=64*1024,{isFunction:Ud}=W,gH=(({Request:t,Response:e})=>({Request:t,Response:e}))(W.global),{ReadableStream:tE,TextEncoder:nE}=W.global,rE=(t,...e)=>{try{return!!t(...e)}catch{return!1}},yH=t=>{t=W.merge.call({skipUndefined:!0},gH,t);const{fetch:e,Request:n,Response:r}=t,i=e?Ud(e):typeof fetch=="function",s=Ud(n),o=Ud(r);if(!i)return!1;const a=i&&Ud(tE),l=i&&(typeof nE=="function"?(v=>w=>v.encode(w))(new nE):async v=>new Uint8Array(await new n(v).arrayBuffer())),c=s&&a&&rE(()=>{let v=!1;const w=new n(nn.origin,{body:new tE,method:"POST",get duplex(){return v=!0,"half"}}).headers.has("Content-Type");return v&&!w}),d=o&&a&&rE(()=>W.isReadableStream(new r("").body)),h={stream:d&&(v=>v.body)};i&&["text","arrayBuffer","blob","formData","stream"].forEach(v=>{!h[v]&&(h[v]=(w,T)=>{let y=w&&w[v];if(y)return y.call(w);throw new ge(`Response type '${v}' is not supported`,ge.ERR_NOT_SUPPORT,T)})});const f=async v=>{if(v==null)return 0;if(W.isBlob(v))return v.size;if(W.isSpecCompliantForm(v))return(await new n(nn.origin,{method:"POST",body:v}).arrayBuffer()).byteLength;if(W.isArrayBufferView(v)||W.isArrayBuffer(v))return v.byteLength;if(W.isURLSearchParams(v)&&(v=v+""),W.isString(v))return(await l(v)).byteLength},m=async(v,w)=>{const T=W.toFiniteNumber(v.getContentLength());return T??f(w)};return async v=>{let{url:w,method:T,data:y,signal:_,cancelToken:S,timeout:C,onDownloadProgress:O,onUploadProgress:z,responseType:A,headers:E,withCredentials:b="same-origin",fetchOptions:I}=pk(v),k=e||fetch;A=A?(A+"").toLowerCase():"text";let N=hH([_,S&&S.toAbortSignal()],C),R=null;const P=N&&N.unsubscribe&&(()=>{N.unsubscribe()});let F;try{if(z&&c&&T!=="get"&&T!=="head"&&(F=await m(E,y))!==0){let K=new n(w,{method:"POST",body:y,duplex:"half"}),U;if(W.isFormData(y)&&(U=K.headers.get("content-type"))&&E.setContentType(U),K.body){const[X,J]=Yb(F,Tf(Xb(z)));y=Zb(K.body,eE,X,J)}}W.isString(b)||(b=b?"include":"omit");const L=s&&"credentials"in n.prototype,$={...I,signal:N,method:T.toUpperCase(),headers:E.normalize().toJSON(),body:y,duplex:"half",credentials:L?b:void 0};R=s&&new n(w,$);let j=await(s?k(R,I):k(w,$));const M=d&&(A==="stream"||A==="response");if(d&&(O||M&&P)){const K={};["status","statusText","headers"].forEach(te=>{K[te]=j[te]});const U=W.toFiniteNumber(j.headers.get("content-length")),[X,J]=O&&Yb(U,Tf(Xb(O),!0))||[];j=new r(Zb(j.body,eE,X,()=>{J&&J(),P&&P()}),K)}A=A||"text";let B=await h[W.findKey(h,A)||"text"](j,v);return!M&&P&&P(),await new Promise((K,U)=>{hk(K,U,{data:B,headers:Rn.from(j.headers),status:j.status,statusText:j.statusText,config:v,request:R})})}catch(L){throw P&&P(),L&&L.name==="TypeError"&&/Load failed|fetch/i.test(L.message)?Object.assign(new ge("Network Error",ge.ERR_NETWORK,v,R,L&&L.response),{cause:L.cause||L}):ge.from(L,L&&L.code,v,R,L&&L.response)}}},vH=new Map,mk=t=>{let e=t&&t.env||{};const{fetch:n,Request:r,Response:i}=e,s=[r,i,n];let o=s.length,a=o,l,c,d=vH;for(;a--;)l=s[a],c=d.get(l),c===void 0&&d.set(l,c=a?new Map:yH(e)),d=c;return c};mk();const fw={http:Oq,xhr:dH,fetch:{get:mk}};W.forEach(fw,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const iE=t=>`- ${t}`,wH=t=>W.isFunction(t)||t===null||t===!1;function _H(t,e){t=W.isArray(t)?t:[t];const{length:n}=t;let r,i;const s={};for(let o=0;o<n;o++){r=t[o];let a;if(i=r,!wH(r)&&(i=fw[(a=String(r)).toLowerCase()],i===void 0))throw new ge(`Unknown adapter '${a}'`);if(i&&(W.isFunction(i)||(i=i.get(e))))break;s[a||"#"+o]=i}if(!i){const o=Object.entries(s).map(([l,c])=>`adapter ${l} `+(c===!1?"is not supported by the environment":"is not available in the build"));let a=n?o.length>1?`since :
`+o.map(iE).join(`
`):" "+iE(o[0]):"as no adapter specified";throw new ge("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return i}const gk={getAdapter:_H,adapters:fw};function zm(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new Qu(null,t)}function sE(t){return zm(t),t.headers=Rn.from(t.headers),t.data=Lm.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),gk.getAdapter(t.adapter||Gu.adapter,t)(t).then(function(r){return zm(t),r.data=Lm.call(t,t.transformResponse,r),r.headers=Rn.from(r.headers),r},function(r){return dk(r)||(zm(t),r&&r.response&&(r.response.data=Lm.call(t,t.transformResponse,r.response),r.response.headers=Rn.from(r.response.headers))),Promise.reject(r)})}const yk="1.13.5",Sp={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Sp[t]=function(r){return typeof r===t||"a"+(e<1?"n ":" ")+t}});const oE={};Sp.transitional=function(e,n,r){function i(s,o){return"[Axios v"+yk+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new ge(i(o," has been removed"+(n?" in "+n:"")),ge.ERR_DEPRECATED);return n&&!oE[o]&&(oE[o]=!0,console.warn(i(o," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,o,a):!0}};Sp.spelling=function(e){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function xH(t,e,n){if(typeof t!="object")throw new ge("options must be an object",ge.ERR_BAD_OPTION_VALUE);const r=Object.keys(t);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=t[s],l=a===void 0||o(a,s,t);if(l!==!0)throw new ge("option "+s+" must be "+l,ge.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new ge("Unknown option "+s,ge.ERR_BAD_OPTION)}}const _h={assertOptions:xH,validators:Sp},er=_h.validators;let oo=class{constructor(e){this.defaults=e||{},this.interceptors={request:new Gb,response:new Gb}}async request(e,n){try{return await this._request(e,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=Ao(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:s}=n;r!==void 0&&_h.assertOptions(r,{silentJSONParsing:er.transitional(er.boolean),forcedJSONParsing:er.transitional(er.boolean),clarifyTimeoutError:er.transitional(er.boolean),legacyInterceptorReqResOrdering:er.transitional(er.boolean)},!1),i!=null&&(W.isFunction(i)?n.paramsSerializer={serialize:i}:_h.assertOptions(i,{encode:er.function,serialize:er.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),_h.assertOptions(n,{baseUrl:er.spelling("baseURL"),withXsrfToken:er.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let o=s&&W.merge(s.common,s[n.method]);s&&W.forEach(["delete","get","head","post","put","patch","common"],v=>{delete s[v]}),n.headers=Rn.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(w){if(typeof w.runWhen=="function"&&w.runWhen(n)===!1)return;l=l&&w.synchronous;const T=n.transitional||dw;T&&T.legacyInterceptorReqResOrdering?a.unshift(w.fulfilled,w.rejected):a.push(w.fulfilled,w.rejected)});const c=[];this.interceptors.response.forEach(function(w){c.push(w.fulfilled,w.rejected)});let d,h=0,f;if(!l){const v=[sE.bind(this),void 0];for(v.unshift(...a),v.push(...c),f=v.length,d=Promise.resolve(n);h<f;)d=d.then(v[h++],v[h++]);return d}f=a.length;let m=n;for(;h<f;){const v=a[h++],w=a[h++];try{m=v(m)}catch(T){w.call(this,T);break}}try{d=sE.call(this,m)}catch(v){return Promise.reject(v)}for(h=0,f=c.length;h<f;)d=d.then(c[h++],c[h++]);return d}getUri(e){e=Ao(this.defaults,e);const n=fk(e.baseURL,e.url,e.allowAbsoluteUrls);return ck(n,e.params,e.paramsSerializer)}};W.forEach(["delete","get","head","options"],function(e){oo.prototype[e]=function(n,r){return this.request(Ao(r||{},{method:e,url:n,data:(r||{}).data}))}});W.forEach(["post","put","patch"],function(e){function n(r){return function(s,o,a){return this.request(Ao(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}oo.prototype[e]=n(),oo.prototype[e+"Form"]=n(!0)});let bH=class vk{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new Qu(s,o,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=r=>{e.abort(r)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new vk(function(i){e=i}),cancel:e}}};function EH(t){return function(n){return t.apply(null,n)}}function IH(t){return W.isObject(t)&&t.isAxiosError===!0}const k0={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(k0).forEach(([t,e])=>{k0[e]=t});function wk(t){const e=new oo(t),n=JR(oo.prototype.request,e);return W.extend(n,oo.prototype,e,{allOwnKeys:!0}),W.extend(n,e,null,{allOwnKeys:!0}),n.create=function(i){return wk(Ao(t,i))},n}const wt=wk(Gu);wt.Axios=oo;wt.CanceledError=Qu;wt.CancelToken=bH;wt.isCancel=dk;wt.VERSION=yk;wt.toFormData=Ip;wt.AxiosError=ge;wt.Cancel=wt.CanceledError;wt.all=function(e){return Promise.all(e)};wt.spread=EH;wt.isAxiosError=IH;wt.mergeConfig=Ao;wt.AxiosHeaders=Rn;wt.formToJSON=t=>uk(W.isHTMLForm(t)?new FormData(t):t);wt.getAdapter=gk.getAdapter;wt.HttpStatusCode=k0;wt.default=wt;const{Axios:zH,AxiosError:MH,CanceledError:jH,isCancel:FH,CancelToken:$H,VERSION:UH,all:BH,Cancel:qH,isAxiosError:HH,spread:KH,toFormData:WH,AxiosHeaders:GH,HttpStatusCode:QH,formToJSON:YH,getAdapter:XH,mergeConfig:JH}=wt,SH=({onSwitchToLogin:t,isDarkMode:e})=>{const[n,r]=D.useState(""),[i,s]=D.useState(""),[o,a]=D.useState(""),[l,c]=D.useState(""),[d,h]=D.useState(""),[f,m]=D.useState(""),v=async w=>{if(w.preventDefault(),!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(i))return h("Por favor, introduce un correo electrnico vlido.");try{const y=`https://api.mailcheck.ai/email/${i}`;if((await(await fetch(y)).json()).disposable)return h("No se permiten correos temporales.")}catch(y){return console.error("Error al validar el correo con MailCheck.ai:",y),h("Error al verificar el correo electrnico. Intntalo de nuevo.")}try{const _=`https://emailvalidation.abstractapi.com/v1/?api_key=YOUR_ABSTRACT_API_KEY&email=${i}`;if((await wt.get(_)).data.deliverability==="UNDELIVERABLE")return h("Por favor, introduce un correo electrnico vlido.")}catch(y){console.error("Error validating email domain:",y)}if(w.preventDefault(),o!==l)return h("Las contraseas no coinciden.");h("");try{const y=await C6(pi,i,o);await P6(y.user,{displayName:n}),await k6(y.user),await pi.signOut(),alert("Te hemos enviado un correo para verificar tu direccin! Por favor, verifica antes de iniciar sesin.")}catch(y){console.error(y),y.code==="auth/email-already-in-use"?h("Este correo ya est en uso."):y.code==="auth/weak-password"?h("La contrasea es muy dbil (mnimo 6 caracteres)."):h("Error: "+y.message)}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:v,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${e?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${e?"text-white":"text-gray-800"}`,children:"CREAR CUENTA"}),d&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:d}),f&&p.jsx("p",{className:"bg-green-900/50 text-green-300 text-xs p-3 rounded mb-4",children:f}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-name",children:"Nombre"}),p.jsxs("div",{className:"relative",children:[p.jsx(Qy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-name",type:"text",placeholder:"Sherlock Holmes",value:n,onChange:w=>r(w.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-email",children:"Correo"}),p.jsxs("div",{className:"relative",children:[p.jsx(Wy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-email",type:"email",placeholder:"detective@agencia.com",value:i,onChange:w=>s(w.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-password",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Ya,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-password",type:"password",placeholder:"",value:o,onChange:w=>a(w.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-confirm-password",children:"Confirmar Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Ya,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-confirm-password",type:"password",placeholder:"",value:l,onChange:w=>c(w.target.value),required:!0})]})]}),p.jsx("div",{className:"flex flex-col gap-4",children:p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Registrarse"})})]}),p.jsxs("p",{className:`text-center text-xs ${e?"text-zinc-500":"text-gray-500"}`,children:["Ya tienes una cuenta?"," ",p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Inicia sesin."})]})]})},TH=({onSwitchToLogin:t,isDarkMode:e})=>{const[n,r]=D.useState(""),[i,s]=D.useState(""),[o,a]=D.useState(""),l=async c=>{c.preventDefault(),a(""),s("");try{await A6(pi,n),s("Revisa tu correo! Se ha enviado un enlace para restablecer tu contrasea.")}catch{a("Error al enviar el correo. Verifica que la direccin sea correcta.")}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:l,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${e?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${e?"text-white":"text-gray-800"}`,children:"RECUPERAR CONTRASEA"}),o&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:o}),i&&p.jsx("p",{className:"bg-green-900/50 text-green-300 text-xs p-3 rounded mb-4",children:i}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"reset-email",children:"Correo Electrnico"}),p.jsxs("div",{className:"relative",children:[p.jsx(Wy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"reset-email",type:"email",placeholder:"detective@agencia.com",value:n,onChange:c=>r(c.target.value),required:!0})]})]}),p.jsx("div",{className:"flex flex-col gap-4",children:p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Enviar Enlace"})})]}),p.jsx("p",{className:`text-center text-xs ${e?"text-zinc-500":"text-gray-500"}`,children:p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Volver a Iniciar Sesin"})})]})},AH=()=>{const[t,e]=D.useState("login"),[n,r]=D.useState(!0),i=()=>{switch(t){case"signup":return p.jsx(SH,{onSwitchToLogin:()=>e("login"),isDarkMode:n});case"forgot":return p.jsx(TH,{onSwitchToLogin:()=>e("login"),isDarkMode:n});case"login":default:return p.jsx(Q7,{onSwitchToSignUp:()=>e("signup"),onForgotPassword:()=>e("forgot"),isDarkMode:n})}};return p.jsxs("div",{className:`w-screen h-screen flex flex-col items-center justify-center p-4 transition-colors duration-500 ${n?"bg-zinc-900":"bg-gray-100"}`,children:[p.jsx("button",{onClick:()=>r(!n),className:`absolute top-4 right-4 p-2 rounded-full transition-colors ${n?"bg-zinc-800 text-yellow-400 hover:bg-zinc-700":"bg-white text-gray-600 hover:bg-gray-200 shadow-sm"}`,children:n?p.jsx(d2,{size:20}):p.jsx(a2,{size:20})}),p.jsx("h1",{className:`text-5xl font-black font-mono mb-8 tracking-[0.2em] uppercase text-center ${n?"text-zinc-500":"text-zinc-400"}`,children:"DETECTIVE BOARD"}),p.jsx("div",{className:"w-full flex justify-center animate-in fade-in slide-in-from-bottom-8 duration-500",children:i()},t)]})},CH=()=>{const{currentUser:t}=lw(),e=D.useCallback(async(s,o)=>{if(!(!t||!s))try{console.log(`[NUBE]  Intentando guardar tablero ${s}...`);const a=Nm($d,"users",t.uid,"boards",s),l=JSON.parse(JSON.stringify(o));await y8(a,{...l,updatedAt:T8(),ownerId:t.uid},{merge:!0}),console.log(`[NUBE]  Guardado exitoso. Deberas ver la coleccin 'users' -> '${t.uid}' en Firestore.`)}catch(a){console.error(" ERROR CRTICO al guardar en Firestore (Revisa Reglas o Conexin):",a)}},[t]),n=D.useCallback(async s=>{if(!t||!s)return null;try{console.log(`[NUBE] Descargando tablero ${s}...`);const o=Nm($d,"users",t.uid,"boards",s),a=await m8(o);return a.exists()?a.data():null}catch(o){throw console.error("Error al cargar de Firestore:",o),o}},[t]),r=D.useCallback(async()=>{if(!t)return[];try{console.log("[NUBE] Sincronizando lista de casos...");const s=YB($d,"users",t.uid,"boards"),o=u8(s);return(await g8(o)).docs.map(l=>({id:l.id,...l.data()}))}catch(s){throw console.error("Error al obtener tableros:",s),s}},[t]),i=D.useCallback(async s=>{t&&await v8(Nm($d,"users",t.uid,"boards",s))},[t]);return{saveBoard:e,loadBoard:n,getBoards:r,deleteBoard:i}},RH=()=>{var Ho,Vl,Ol;const t=D.useRef(null),{currentUser:e}=lw(),[n,r]=D.useState(!1),[i,s,o]=KL([]),[a,l,c]=WL([]),[d,h]=D.useState(null),[f,m]=D.useState(!1),[v,w]=D.useState(null),[T,y]=D.useState(null),[_,S]=D.useState(null),[C,O]=D.useState({isOpen:!1,title:"",message:"",onConfirm:null,isDanger:!1}),[z,A]=D.useState(!1),[E,b]=D.useState(!1),[I,k]=D.useState(null),[N,R]=D.useState(null),[P,F]=D.useState(!1),[L,$]=D.useState(null),[j,M]=D.useState(0),[B,K]=D.useState(!1),[U,X]=D.useState(!1),J=D.useRef(!1),te=D.useRef(null),{saveBoard:ae,loadBoard:pe,getBoards:de}=CH(),{connectionColor:xe,setConnectionColor:be,connectionLineType:ke,setConnectionLineType:He,isInteractive:Ve,setIsInteractive:Xe,isDarkMode:ve,setIsDarkMode:mt,searchTerm:Ne,setSearchTerm:oe,isSidebarOpen:Ae,setIsSidebarOpen:Pt,isZenMode:Dt,setIsZenMode:hn,bgType:it,setBgType:It,toggleBackground:St}=Q3("cork"),{nodeTypes:ze,edgeTypes:je,proOptions:Vt,connectionLineStyle:sn,nodeColor:Pr}=U3({connectionColor:xe}),{takeSnapshot:Ue,undo:_t,redo:Nn,clearHistory:Pn,onNodesChangeWithHistory:Dn,onEdgesChangeWithHistory:Vn,animateAndRemoveNode:fn,animateAndRemoveEdge:dr}=q3({nodes:i,edges:a,setNodes:s,setEdges:l,onNodesChange:o,onEdgesChange:c}),{boards:Ot,setBoards:Xn,trash:hr,currentBoardId:Je,setCurrentBoardId:pn,handleSwitchBoard:fr,handleCreateBoard:Do,handleDeleteBoard:ki,handleRestoreBoard:Vo,handlePermanentDelete:Jr,handleRenameBoard:Oo,handleReorderBoards:Tt,handleCloneBoard:Lo}=_3({nodes:i,edges:a,bgType:it,setNodes:s,setEdges:l,setBgType:It,reactFlowInstance:d,clearHistory:Pn,setCaseManagerOpen:r,setConfirmModal:O,lastSaved:T});D.useEffect(()=>{(async()=>{if(e){X(!1);try{const Fe=(await de()).map(Se=>{var Ce,ut;return{...Se,createdAt:(Ce=Se.createdAt)!=null&&Ce.toMillis?Se.createdAt.toMillis():Se.createdAt||Date.now(),lastModified:(ut=Se.updatedAt)!=null&&ut.toMillis?Se.updatedAt.toMillis():Se.updatedAt||Date.now()}}).sort((Se,Ce)=>Ce.lastModified-Se.lastModified);Xn(Fe),Fe.length>0&&(!Je||!Fe.find(Se=>Se.id===Je))?pn(Fe[0].id):Fe.length===0&&console.log("No se encontraron tableros remotos.")}catch(we){console.error("Error sincronizando tableros:",we)}finally{X(!0)}}})()},[e,de,Xn,pn]),D.useEffect(()=>{(async()=>{var we,Fe,Se;if(U&&Je){F(!0),$(null),J.current=!1;try{const Ce=await pe(Je);if(Ce){s(Ce.nodes||[]),l(Ce.edges||[]),Ce.bgType&&It(Ce.bgType),J.current=!0;const ut=((we=Ot.find(Lt=>Lt.id===Je))==null?void 0:we.name)||"Caso Sin Nombre";te.current=JSON.stringify({nodes:Ce.nodes||[],edges:Ce.edges||[],bgType:Ce.bgType||"cork",name:ut})}else if(Ot.some(Lt=>Lt.id===Je)){s([]),l([]),J.current=!0;const Lt=((Fe=Ot.find(ei=>ei.id===Je))==null?void 0:Fe.name)||"Caso Sin Nombre";te.current=JSON.stringify({nodes:[],edges:[],bgType:"cork",name:Lt})}else console.warn("ID de tablero obsoleto detectado, omitiendo carga para evitar sobrescritura.")}catch(Ce){Ce.code==="unavailable"||(Se=Ce.message)!=null&&Se.includes("offline")?(console.warn("Modo offline: No se pudo sincronizar con la nube, usando cach local si existe."),$("offline")):(console.error("Error cargando tablero:",Ce),$("error"))}finally{F(!1)}}})()},[Je,pe,s,l,It,U,j]);const Jn=G.useCallback(async(Ee=!1)=>{var Ce;if(!Je||!J.current||P||L)return;const we=((Ce=Ot.find(ut=>ut.id===Je))==null?void 0:Ce.name)||"Caso Sin Nombre",Fe={nodes:i,edges:a,bgType:it,name:we},Se=JSON.stringify(Fe);if(!(!Ee&&te.current===Se)){K(!0);try{await ae(Je,Fe),te.current=Se,y(new Date),console.log("Guardado automtico completado."),K(!1)}catch(ut){console.error("Error al guardar:",ut)}}},[Je,i,a,it,Ot,ae,P,L]);D.useEffect(()=>{const Ee=setInterval(Jn,3e5);return()=>clearInterval(Ee)},[Jn]);const Dr=async Ee=>{await Jn(),fr(Ee)};D.useEffect(()=>{const Ee=we=>{var Ce;const Fe=((Ce=Ot.find(ut=>ut.id===Je))==null?void 0:Ce.name)||"Caso Sin Nombre",Se=JSON.stringify({nodes:i,edges:a,bgType:it,name:Fe});if(J.current&&te.current!==Se)return we.preventDefault(),we.returnValue="Tienes cambios sin guardar. Seguro que quieres salir?",we.returnValue};return window.addEventListener("beforeunload",Ee),()=>window.removeEventListener("beforeunload",Ee)},[i,a,it,Je,Ot]),SM({isInteractive:Ve,reactFlowInstance:d,takeSnapshot:Ue,setNodes:s});const{onConnect:Rl,onEdgeContextMenu:kl,onEdgeClick:Vr,onPaneClick:zo,onNodeDoubleClick:Nl,onNodeDragStart:Ni,onMoveStart:ks,onMoveEnd:Ns,selectionRect:On,handleRightPointerDown:Zn}=K3({isInteractive:Ve,reactFlowInstance:d,reactFlowWrapper:t,setEdges:l,setNodes:s,connectionLineType:ke,connectionColor:xe,takeSnapshot:Ue,setEditingNode:w,setEditingEdge:k,setInputModalOpen:b,setEditModalOpen:m,setMenu:S});D.useEffect(()=>{const Ee=we=>{we.key==="Escape"&&Dt&&hn(!1)};return window.addEventListener("keydown",Ee),()=>window.removeEventListener("keydown",Ee)},[Dt]);const{handleSaveNode:Mo,handleDeleteNode:jo,duplicateSelected:Ps,handleConnectionColorChange:Ds,handleConnectionLineTypeChange:Fo,handleEdgeDelete:Vs,handleInputModalConfirm:Pl}=Y3({reactFlowInstance:d,setNodes:s,setEdges:l,takeSnapshot:Ue,animateAndRemoveNode:fn,animateAndRemoveEdge:dr,setEditModalOpen:m,setEditingNode:w,setEditingEdge:k,setInputModalOpen:b,setConnectionColor:be,setConnectionLineType:He,setPendingStampNodeId:R}),{onDragOver:Pi,onDrop:$o}=b3({isInteractive:Ve,reactFlowInstance:d,setNodes:s,takeSnapshot:Ue,setPendingStampNodeId:R,setInputModalOpen:b,setEditingEdge:k,setEditingNode:w}),{onSave:Di,onLoad:Zr,onClear:pr}=W3({reactFlowInstance:d,boards:Ot,currentBoardId:Je,bgType:it,setBoards:Xn,setNodes:s,setEdges:l,setBgType:It,handleSwitchBoard:Dr,clearHistory:Pn,takeSnapshot:Ue,setConfirmModal:O}),{navigateSearch:Or}=G3({searchTerm:Ne,setNodes:s,reactFlowInstance:d}),Uo=G.useCallback(()=>{Ue(),s(Ee=>{const we=Ee.filter(Se=>Se.selected);if(we.length===0)return Ee;const Fe=we.some(Se=>!Se.data.locked);return Ee.map(Se=>Se.selected?{...Se,data:{...Se.data,locked:Fe},draggable:!Fe}:Se)})},[s,Ue]);D.useEffect(()=>{const Ee=we=>{["INPUT","TEXTAREA","SELECT"].includes(we.target.tagName)||we.target.isContentEditable||(we.ctrlKey||we.metaKey)&&we.shiftKey&&we.key.toLowerCase()==="l"&&(we.preventDefault(),Uo())};return window.addEventListener("keydown",Ee),()=>window.removeEventListener("keydown",Ee)},[Uo]),D.useEffect(()=>{const Ee=i.filter(we=>we.selected).map(we=>we.id);l(we=>{let Fe=!1;const Se=we.map(Ce=>{var ei;const ut=Ee.includes(Ce.source)||Ee.includes(Ce.target),Lt=(ei=Ce.className)==null?void 0:ei.includes("animated-flow");if(ut&&!Lt){Fe=!0;const Ko=(Ce.className||"").replace("quick-draw","").trim();return{...Ce,className:`${Ko} animated-flow`.trim()}}else if(!ut&&Lt)return Fe=!0,{...Ce,className:(Ce.className||"").replace("animated-flow","").trim()};return Ce});return Fe?Se:we})},[i,l]),D.useEffect(()=>{if(a.some(we=>{var Fe;return(Fe=we.className)==null?void 0:Fe.includes("quick-draw")})){const we=setTimeout(()=>{l(Fe=>Fe.map(Se=>{var Ce;return(Ce=Se.className)!=null&&Ce.includes("quick-draw")?{...Se,className:Se.className.replace("quick-draw","").trim()}:Se}))},1e3);return()=>clearTimeout(we)}},[a,l]);const{isExporting:Bo,onExport:qo}=v3({reactFlowWrapper:t,reactFlowInstance:d,boards:Ot,currentBoardId:Je,bgType:it,isDarkMode:ve,setNodes:s});x3({onSave:Di,undo:_t,redo:Nn,duplicateSelected:Ps,navigateSearch:Or,reactFlowInstance:d,edges:a,setEdges:l,takeSnapshot:Ue,connectionLineType:ke,connectionColor:xe});const Lr=Ot.find(Ee=>Ee.id===Je),Dl=async()=>{try{await L6(pi)}catch(Ee){console.error("Error al cerrar sesin",Ee)}};return p.jsx("div",{className:`flex h-screen w-screen transition-colors duration-500 ease-in-out ${ve?"bg-[#1a1a1a]":"bg-gray-50 light-mode"}`,children:p.jsx(E2.Provider,{value:ve,children:p.jsxs(Uy,{children:[!Dt&&p.jsx(fM,{connectionColor:xe,setConnectionColor:Ds,connectionLineType:ke,setConnectionLineType:Fo,lastSaved:T,onSave:Di,onLoad:Zr,onClear:pr,onHelp:()=>A(!0),isDarkMode:ve,toggleTheme:()=>mt(!ve),searchTerm:Ne,setSearchTerm:oe,onExport:qo,isOpen:Ae,onToggle:()=>Pt(!Ae),onOpenCaseManager:()=>r(!0),currentBoardName:Lr==null?void 0:Lr.name,onToggleZen:()=>hn(!0),onNextMatch:()=>Or("next"),onPrevMatch:()=>Or("prev"),onToggleBg:St,onLogout:Dl,currentUser:e,isSyncing:P||!U,syncError:L,onRetry:()=>M(Ee=>Ee+1),onManualSave:()=>Jn(!0)}),p.jsxs("div",{className:"flex-grow h-full relative overflow-hidden",ref:t,style:{"--connection-color":xe},onPointerDown:Zn,onContextMenu:Ee=>Ee.preventDefault(),children:[p.jsx(IM,{isZenMode:Dt,setIsZenMode:hn,undo:_t,redo:Nn,isDarkMode:ve}),p.jsxs(WT,{nodes:i,edges:a,onNodesChange:Dn,onEdgesChange:Vn,onConnect:Rl,onInit:h,onDrop:$o,onDragOver:Pi,onNodeDoubleClick:Nl,onEdgeClick:Vr,onEdgeContextMenu:kl,onPaneClick:zo,nodeTypes:ze,edgeTypes:je,fitView:!0,className:`${it==="cork"?"cork-pattern":it==="blackboard"?"blackboard-pattern":"graph-paper-pattern"} ${Ve?"":"board-locked"} ${ve?"":"light-mode"}`,connectionLineType:ke,connectionLineStyle:sn,nodesDraggable:Ve,proOptions:Vt,elevateNodesOnSelect:!1,nodesConnectable:Ve,elementsSelectable:Ve,panOnDrag:Ve,zoomOnScroll:Ve,zoomOnPinch:Ve,panOnScroll:Ve,zoomOnDoubleClick:Ve,onNodeDragStart:Ni,onMoveStart:ks,onMoveEnd:Ns,connectionRadius:30,children:[!Dt&&p.jsx(uz,{showInteractive:!0,onInteractiveChange:Xe,fitViewOptions:{duration:800,padding:.2},style:{left:Ae?"340px":"10px",transition:"left 0.2s ease-in-out"}}),!Dt&&p.jsx(rz,{nodeColor:Pr,maskColor:ve?"rgba(0, 0, 0, 0.6)":"rgba(0, 0, 0, 0.1)",className:ve?"bg-zinc-900 border border-zinc-800":"bg-white border border-gray-200 shadow-md"}),p.jsx(gz,{gap:20,size:1,color:ve?"#444":"#aaa",variant:"dots",className:"opacity-20"}),_&&p.jsx(wM,{onClick:zo,..._,onHide:()=>S(null),takeSnapshot:Ue,setNodes:s}),i.length===0&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-10 select-none",children:p.jsxs("div",{className:`text-center ${ve?"opacity-10":"opacity-20"}`,children:[p.jsx("h1",{className:"text-5xl md:text-7xl font-black text-zinc-500 font-mono mb-4 tracking-[0.2em] uppercase",children:"CONFIDENCIAL"}),p.jsx("p",{className:"text-sm text-zinc-500 font-mono uppercase tracking-widest",children:"Arrastra evidencia o haz doble clic"})]})}),p.jsx("svg",{style:{position:"absolute",top:0,left:0,width:0,height:0,pointerEvents:"none"},children:p.jsx("defs",{children:p.jsxs("filter",{id:"yarn-texture",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[p.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.8",numOctaves:"3",result:"noise"}),p.jsx("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"1.5"})]})})})]}),p.jsx("div",{className:"absolute inset-0 pointer-events-none z-[5] bg-[radial-gradient(circle_at_center,transparent_40%,rgba(0,0,0,0.6)_100%)]"}),Bo&&p.jsxs("div",{className:"absolute inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center backdrop-blur-sm animate-in fade-in duration-200 cursor-wait",children:[p.jsx("div",{className:"w-16 h-16 border-4 border-red-600 border-t-transparent rounded-full animate-spin mb-4"}),p.jsx("h2",{className:"text-xl font-bold text-white font-mono tracking-widest animate-pulse",children:"REVELANDO EVIDENCIA..."}),p.jsx("p",{className:"text-zinc-400 text-xs font-mono mt-2",children:"Procesando fotografa del tablero completo."})]}),On&&On.isDragging&&p.jsx("div",{className:"absolute z-50 pointer-events-none",style:{left:`${On.x}px`,top:`${On.y}px`,width:`${On.width}px`,height:`${On.height}px`,border:"2px dashed #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)"}}),L&&p.jsx("div",{className:"absolute inset-0 z-[60] bg-black/60 flex items-center justify-center backdrop-blur-sm animate-in fade-in duration-300",children:p.jsxs("div",{className:"bg-zinc-900 p-8 rounded-xl border border-red-500/30 text-center shadow-2xl max-w-md",children:[p.jsx(uM,{size:48,className:"mx-auto text-red-500 mb-4 animate-pulse"}),p.jsx("h2",{className:"text-xl font-bold text-white mb-2 font-mono tracking-wider",children:"CONEXIN INTERRUMPIDA"}),p.jsx("p",{className:"text-zinc-400 mb-6 text-sm",children:L==="offline"?"No se pudo sincronizar con la base de datos. Es posible que un firewall o configuracin de red est bloqueando la conexin.":"Hubo un error crtico al cargar el expediente."}),p.jsxs("button",{onClick:()=>M(Ee=>Ee+1),className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold uppercase tracking-wider transition-colors flex items-center gap-2 mx-auto shadow-lg",children:[p.jsx(Gy,{size:16})," Reintentar Conexin"]})]})})]}),p.jsx(pM,{isOpen:f,onClose:()=>m(!1),node:v,onSave:Mo,onDelete:jo,isDarkMode:ve}),p.jsx(_M,{isOpen:C.isOpen,onClose:()=>O(Ee=>({...Ee,isOpen:!1})),onConfirm:C.onConfirm,title:C.title,message:C.message,isDanger:C.isDanger,confirmText:C.confirmText,cancelText:C.cancelText,isDarkMode:ve}),p.jsx(xM,{isOpen:z,onClose:()=>A(!1),isDarkMode:ve}),p.jsx(bM,{isOpen:E,onClose:()=>{b(!1),k(null),w(null),R(null)},onConfirm:(Ee,we,Fe)=>Pl(Ee,we,Fe,I,v,N),onDelete:()=>{N?(Ue(),s(Ee=>Ee.map(we=>we.id===N?{...we,data:{...we.data,status:null}}:we)),b(!1),R(null)):Vs(I,v)},title:I?"EDITAR CONEXIN":N?"CREAR SELLO":"EDITAR ZONA",initialValue:I?I.label||"":N?"":((Ho=v==null?void 0:v.data)==null?void 0:Ho.label)||"",initialColor:I?((Vl=I.style)==null?void 0:Vl.stroke)||"#dc2626":N?"#dc2626":((Ol=v==null?void 0:v.style)==null?void 0:Ol.borderColor)||"#71717a",initialType:I==null?void 0:I.type,showTypeSelector:!!I,colorLabel:I?"Color del Hilo":N?"Color del Sello":"Color de Zona",placeholder:N?"Texto del sello (ej: CONFIRMADO)":"Escribe una etiqueta...",isDarkMode:ve}),p.jsx(EM,{isOpen:n,onClose:()=>r(!1),boards:Ot,currentBoardId:Je,onSwitch:Dr,onCreate:Do,onDelete:ki,onRename:Oo,onClone:Lo,onReorder:Tt,trash:hr,onRestore:Vo,onPermanentDelete:Jr,isDarkMode:ve})]})})})},kH=()=>{const{currentUser:t}=lw();return D.useEffect(()=>{document.title="Detective Board";const e="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%23dc2626%22%20stroke-width%3D%222.5%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Ccircle%20cx%3D%2211%22%20cy%3D%2211%22%20r%3D%228%22%3E%3C%2Fcircle%3E%3Cline%20x1%3D%2221%22%20y1%3D%2221%22%20x2%3D%2216.65%22%20y2%3D%2216.65%22%3E%3C%2Fline%3E%3C%2Fsvg%3E";let n=document.querySelector("link[rel~='icon']");n||(n=document.createElement("link"),n.rel="icon",document.head.appendChild(n)),n.href=e},[]),t?p.jsx(RH,{}):p.jsx(AH,{})};Mm.createRoot(document.getElementById("root")).render(p.jsx(G.StrictMode,{children:p.jsx(G7,{children:p.jsx(kH,{})})}));
