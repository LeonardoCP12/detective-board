(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function eE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var tE={exports:{}},Xh={},nE={exports:{}},Ie={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ru=Symbol.for("react.element"),lk=Symbol.for("react.portal"),ck=Symbol.for("react.fragment"),uk=Symbol.for("react.strict_mode"),dk=Symbol.for("react.profiler"),hk=Symbol.for("react.provider"),fk=Symbol.for("react.context"),pk=Symbol.for("react.forward_ref"),mk=Symbol.for("react.suspense"),gk=Symbol.for("react.memo"),yk=Symbol.for("react.lazy"),Qv=Symbol.iterator;function vk(t){return t===null||typeof t!="object"?null:(t=Qv&&t[Qv]||t["@@iterator"],typeof t=="function"?t:null)}var rE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},iE=Object.assign,sE={};function Wa(t,e,n){this.props=t,this.context=e,this.refs=sE,this.updater=n||rE}Wa.prototype.isReactComponent={};Wa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Wa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function oE(){}oE.prototype=Wa.prototype;function Hg(t,e,n){this.props=t,this.context=e,this.refs=sE,this.updater=n||rE}var qg=Hg.prototype=new oE;qg.constructor=Hg;iE(qg,Wa.prototype);qg.isPureReactComponent=!0;var Yv=Array.isArray,aE=Object.prototype.hasOwnProperty,Kg={current:null},lE={key:!0,ref:!0,__self:!0,__source:!0};function cE(t,e,n){var r,i={},s=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)aE.call(e,r)&&!lE.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:ru,type:t,key:s,ref:o,props:i,_owner:Kg.current}}function _k(t,e){return{$$typeof:ru,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Gg(t){return typeof t=="object"&&t!==null&&t.$$typeof===ru}function wk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Xv=/\/+/g;function Xf(t,e){return typeof t=="object"&&t!==null&&t.key!=null?wk(""+t.key):e.toString(36)}function vd(t,e,n,r,i){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ru:case lk:o=!0}}if(o)return o=t,i=i(o),t=r===""?"."+Xf(o,0):r,Yv(i)?(n="",t!=null&&(n=t.replace(Xv,"$&/")+"/"),vd(i,e,n,"",function(c){return c})):i!=null&&(Gg(i)&&(i=_k(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(Xv,"$&/")+"/")+t)),e.push(i)),1;if(o=0,r=r===""?".":r+":",Yv(t))for(var a=0;a<t.length;a++){s=t[a];var l=r+Xf(s,a);o+=vd(s,e,n,l,i)}else if(l=vk(t),typeof l=="function")for(t=l.call(t),a=0;!(s=t.next()).done;)s=s.value,l=r+Xf(s,a++),o+=vd(s,e,n,l,i);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ou(t,e,n){if(t==null)return t;var r=[],i=0;return vd(t,r,"","",function(s){return e.call(n,s,i++)}),r}function xk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var nn={current:null},_d={transition:null},Ek={ReactCurrentDispatcher:nn,ReactCurrentBatchConfig:_d,ReactCurrentOwner:Kg};function uE(){throw Error("act(...) is not supported in production builds of React.")}Ie.Children={map:Ou,forEach:function(t,e,n){Ou(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ou(t,function(){e++}),e},toArray:function(t){return Ou(t,function(e){return e})||[]},only:function(t){if(!Gg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ie.Component=Wa;Ie.Fragment=ck;Ie.Profiler=dk;Ie.PureComponent=Hg;Ie.StrictMode=uk;Ie.Suspense=mk;Ie.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ek;Ie.act=uE;Ie.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=iE({},t.props),i=t.key,s=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Kg.current),e.key!==void 0&&(i=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)aE.call(e,l)&&!lE.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:ru,type:t.type,key:i,ref:s,props:r,_owner:o}};Ie.createContext=function(t){return t={$$typeof:fk,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:hk,_context:t},t.Consumer=t};Ie.createElement=cE;Ie.createFactory=function(t){var e=cE.bind(null,t);return e.type=t,e};Ie.createRef=function(){return{current:null}};Ie.forwardRef=function(t){return{$$typeof:pk,render:t}};Ie.isValidElement=Gg;Ie.lazy=function(t){return{$$typeof:yk,_payload:{_status:-1,_result:t},_init:xk}};Ie.memo=function(t,e){return{$$typeof:gk,type:t,compare:e===void 0?null:e}};Ie.startTransition=function(t){var e=_d.transition;_d.transition={};try{t()}finally{_d.transition=e}};Ie.unstable_act=uE;Ie.useCallback=function(t,e){return nn.current.useCallback(t,e)};Ie.useContext=function(t){return nn.current.useContext(t)};Ie.useDebugValue=function(){};Ie.useDeferredValue=function(t){return nn.current.useDeferredValue(t)};Ie.useEffect=function(t,e){return nn.current.useEffect(t,e)};Ie.useId=function(){return nn.current.useId()};Ie.useImperativeHandle=function(t,e,n){return nn.current.useImperativeHandle(t,e,n)};Ie.useInsertionEffect=function(t,e){return nn.current.useInsertionEffect(t,e)};Ie.useLayoutEffect=function(t,e){return nn.current.useLayoutEffect(t,e)};Ie.useMemo=function(t,e){return nn.current.useMemo(t,e)};Ie.useReducer=function(t,e,n){return nn.current.useReducer(t,e,n)};Ie.useRef=function(t){return nn.current.useRef(t)};Ie.useState=function(t){return nn.current.useState(t)};Ie.useSyncExternalStore=function(t,e,n){return nn.current.useSyncExternalStore(t,e,n)};Ie.useTransition=function(){return nn.current.useTransition()};Ie.version="18.3.1";nE.exports=Ie;var D=nE.exports;const K=eE(D);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bk=D,Ik=Symbol.for("react.element"),Tk=Symbol.for("react.fragment"),Sk=Object.prototype.hasOwnProperty,Ck=bk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Ak={key:!0,ref:!0,__self:!0,__source:!0};function dE(t,e,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Sk.call(e,r)&&!Ak.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:Ik,type:t,key:s,ref:o,props:i,_owner:Ck.current}}Xh.Fragment=Tk;Xh.jsx=dE;Xh.jsxs=dE;tE.exports=Xh;var p=tE.exports,tm={},hE={exports:{}},Ln={},fE={exports:{}},pE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(F,M){var B=F.length;F.push(M);e:for(;0<B;){var G=B-1>>>1,$=F[G];if(0<i($,M))F[G]=M,F[B]=$,B=G;else break e}}function n(F){return F.length===0?null:F[0]}function r(F){if(F.length===0)return null;var M=F[0],B=F.pop();if(B!==M){F[0]=B;e:for(var G=0,$=F.length,Y=$>>>1;G<Y;){var X=2*(G+1)-1,ee=F[X],re=X+1,fe=F[re];if(0>i(ee,B))re<$&&0>i(fe,ee)?(F[G]=fe,F[re]=B,G=re):(F[G]=ee,F[X]=B,G=X);else if(re<$&&0>i(fe,B))F[G]=fe,F[re]=B,G=re;else break e}}return M}function i(F,M){var B=F.sortIndex-M.sortIndex;return B!==0?B:F.id-M.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],d=1,h=null,f=3,m=!1,b=!1,x=!1,R=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(F){for(var M=n(c);M!==null;){if(M.callback===null)r(c);else if(M.startTime<=F)r(c),M.sortIndex=M.expirationTime,e(l,M);else break;M=n(c)}}function A(F){if(x=!1,T(F),!b)if(n(l)!==null)b=!0,z(O);else{var M=n(c);M!==null&&U(A,M.startTime-F)}}function O(F,M){b=!1,x&&(x=!1,y(I),I=-1),m=!0;var B=f;try{for(T(M),h=n(l);h!==null&&(!(h.expirationTime>M)||F&&!C());){var G=h.callback;if(typeof G=="function"){h.callback=null,f=h.priorityLevel;var $=G(h.expirationTime<=M);M=t.unstable_now(),typeof $=="function"?h.callback=$:h===n(l)&&r(l),T(M)}else r(l);h=n(l)}if(h!==null)var Y=!0;else{var X=n(c);X!==null&&U(A,X.startTime-M),Y=!1}return Y}finally{h=null,f=B,m=!1}}var L=!1,S=null,I=-1,w=5,E=-1;function C(){return!(t.unstable_now()-E<w)}function N(){if(S!==null){var F=t.unstable_now();E=F;var M=!0;try{M=S(!0,F)}finally{M?k():(L=!1,S=null)}}else L=!1}var k;if(typeof v=="function")k=function(){v(N)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,j=P.port2;P.port1.onmessage=N,k=function(){j.postMessage(null)}}else k=function(){R(N,0)};function z(F){S=F,L||(L=!0,k())}function U(F,M){I=R(function(){F(t.unstable_now())},M)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(F){F.callback=null},t.unstable_continueExecution=function(){b||m||(b=!0,z(O))},t.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):w=0<F?Math.floor(1e3/F):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(F){switch(f){case 1:case 2:case 3:var M=3;break;default:M=f}var B=f;f=M;try{return F()}finally{f=B}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(F,M){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var B=f;f=F;try{return M()}finally{f=B}},t.unstable_scheduleCallback=function(F,M,B){var G=t.unstable_now();switch(typeof B=="object"&&B!==null?(B=B.delay,B=typeof B=="number"&&0<B?G+B:G):B=G,F){case 1:var $=-1;break;case 2:$=250;break;case 5:$=1073741823;break;case 4:$=1e4;break;default:$=5e3}return $=B+$,F={id:d++,callback:M,priorityLevel:F,startTime:B,expirationTime:$,sortIndex:-1},B>G?(F.sortIndex=B,e(c,F),n(l)===null&&F===n(c)&&(x?(y(I),I=-1):x=!0,U(A,B-G))):(F.sortIndex=$,e(l,F),b||m||(b=!0,z(O))),F},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(F){var M=f;return function(){var B=f;f=M;try{return F.apply(this,arguments)}finally{f=B}}}})(pE);fE.exports=pE;var kk=fE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rk=D,Vn=kk;function Z(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var mE=new Set,yc={};function go(t,e){xa(t,e),xa(t+"Capture",e)}function xa(t,e){for(yc[t]=e,t=0;t<e.length;t++)mE.add(e[t])}var si=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),nm=Object.prototype.hasOwnProperty,Nk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Jv={},Zv={};function Pk(t){return nm.call(Zv,t)?!0:nm.call(Jv,t)?!1:Nk.test(t)?Zv[t]=!0:(Jv[t]=!0,!1)}function Dk(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Vk(t,e,n,r){if(e===null||typeof e>"u"||Dk(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function rn(t,e,n,r,i,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ft[t]=new rn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ft[e]=new rn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ft[t]=new rn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ft[t]=new rn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ft[t]=new rn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ft[t]=new rn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ft[t]=new rn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ft[t]=new rn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ft[t]=new rn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Wg=/[\-:]([a-z])/g;function Qg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Wg,Qg);Ft[e]=new rn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Wg,Qg);Ft[e]=new rn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Wg,Qg);Ft[e]=new rn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ft[t]=new rn(t,1,!1,t.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new rn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ft[t]=new rn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Yg(t,e,n,r){var i=Ft.hasOwnProperty(e)?Ft[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Vk(e,n,i,r)&&(n=null),r||i===null?Pk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=n===null?i.type===3?!1:"":n:(e=i.attributeName,r=i.attributeNamespace,n===null?t.removeAttribute(e):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var pi=Rk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,zu=Symbol.for("react.element"),Wo=Symbol.for("react.portal"),Qo=Symbol.for("react.fragment"),Xg=Symbol.for("react.strict_mode"),rm=Symbol.for("react.profiler"),gE=Symbol.for("react.provider"),yE=Symbol.for("react.context"),Jg=Symbol.for("react.forward_ref"),im=Symbol.for("react.suspense"),sm=Symbol.for("react.suspense_list"),Zg=Symbol.for("react.memo"),Ri=Symbol.for("react.lazy"),vE=Symbol.for("react.offscreen"),e_=Symbol.iterator;function El(t){return t===null||typeof t!="object"?null:(t=e_&&t[e_]||t["@@iterator"],typeof t=="function"?t:null)}var lt=Object.assign,Jf;function Fl(t){if(Jf===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Jf=e&&e[1]||""}return`
`+Jf+t}var Zf=!1;function ep(t,e){if(!t||Zf)return"";Zf=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||i[o]!==s[a]){var l=`
`+i[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{Zf=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Fl(t):""}function Ok(t){switch(t.tag){case 5:return Fl(t.type);case 16:return Fl("Lazy");case 13:return Fl("Suspense");case 19:return Fl("SuspenseList");case 0:case 2:case 15:return t=ep(t.type,!1),t;case 11:return t=ep(t.type.render,!1),t;case 1:return t=ep(t.type,!0),t;default:return""}}function om(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Qo:return"Fragment";case Wo:return"Portal";case rm:return"Profiler";case Xg:return"StrictMode";case im:return"Suspense";case sm:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case yE:return(t.displayName||"Context")+".Consumer";case gE:return(t._context.displayName||"Context")+".Provider";case Jg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Zg:return e=t.displayName||null,e!==null?e:om(t.type)||"Memo";case Ri:e=t._payload,t=t._init;try{return om(t(e))}catch{}}return null}function zk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return om(e);case 8:return e===Xg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function is(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _E(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Lk(t){var e=_E(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Lu(t){t._valueTracker||(t._valueTracker=Lk(t))}function wE(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=_E(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Gd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function am(t,e){var n=e.checked;return lt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function t_(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=is(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function xE(t,e){e=e.checked,e!=null&&Yg(t,"checked",e,!1)}function lm(t,e){xE(t,e);var n=is(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?cm(t,e.type,n):e.hasOwnProperty("defaultValue")&&cm(t,e.type,is(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function n_(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function cm(t,e,n){(e!=="number"||Gd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var $l=Array.isArray;function aa(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+is(n),e=null,i=0;i<t.length;i++){if(t[i].value===n){t[i].selected=!0,r&&(t[i].defaultSelected=!0);return}e!==null||t[i].disabled||(e=t[i])}e!==null&&(e.selected=!0)}}function um(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Z(91));return lt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function r_(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Z(92));if($l(n)){if(1<n.length)throw Error(Z(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:is(n)}}function EE(t,e){var n=is(e.value),r=is(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function i_(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function bE(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function dm(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?bE(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Mu,IE=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,i)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Mu=Mu||document.createElement("div"),Mu.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Mu.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function vc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var ec={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Mk=["Webkit","ms","Moz","O"];Object.keys(ec).forEach(function(t){Mk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ec[e]=ec[t]})});function TE(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||ec.hasOwnProperty(t)&&ec[t]?(""+e).trim():e+"px"}function SE(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=TE(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}var jk=lt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hm(t,e){if(e){if(jk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Z(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Z(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Z(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Z(62))}}function fm(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pm=null;function e0(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var mm=null,la=null,ca=null;function s_(t){if(t=ou(t)){if(typeof mm!="function")throw Error(Z(280));var e=t.stateNode;e&&(e=nf(e),mm(t.stateNode,t.type,e))}}function CE(t){la?ca?ca.push(t):ca=[t]:la=t}function AE(){if(la){var t=la,e=ca;if(ca=la=null,s_(t),e)for(t=0;t<e.length;t++)s_(e[t])}}function kE(t,e){return t(e)}function RE(){}var tp=!1;function NE(t,e,n){if(tp)return t(e,n);tp=!0;try{return kE(t,e,n)}finally{tp=!1,(la!==null||ca!==null)&&(RE(),AE())}}function _c(t,e){var n=t.stateNode;if(n===null)return null;var r=nf(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Z(231,e,typeof n));return n}var gm=!1;if(si)try{var bl={};Object.defineProperty(bl,"passive",{get:function(){gm=!0}}),window.addEventListener("test",bl,bl),window.removeEventListener("test",bl,bl)}catch{gm=!1}function Fk(t,e,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var tc=!1,Wd=null,Qd=!1,ym=null,$k={onError:function(t){tc=!0,Wd=t}};function Uk(t,e,n,r,i,s,o,a,l){tc=!1,Wd=null,Fk.apply($k,arguments)}function Bk(t,e,n,r,i,s,o,a,l){if(Uk.apply(this,arguments),tc){if(tc){var c=Wd;tc=!1,Wd=null}else throw Error(Z(198));Qd||(Qd=!0,ym=c)}}function yo(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function PE(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function o_(t){if(yo(t)!==t)throw Error(Z(188))}function Hk(t){var e=t.alternate;if(!e){if(e=yo(t),e===null)throw Error(Z(188));return e!==t?null:t}for(var n=t,r=e;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return o_(i),t;if(s===r)return o_(i),e;s=s.sibling}throw Error(Z(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o)throw Error(Z(189))}}if(n.alternate!==r)throw Error(Z(190))}if(n.tag!==3)throw Error(Z(188));return n.stateNode.current===n?t:e}function DE(t){return t=Hk(t),t!==null?VE(t):null}function VE(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=VE(t);if(e!==null)return e;t=t.sibling}return null}var OE=Vn.unstable_scheduleCallback,a_=Vn.unstable_cancelCallback,qk=Vn.unstable_shouldYield,Kk=Vn.unstable_requestPaint,ft=Vn.unstable_now,Gk=Vn.unstable_getCurrentPriorityLevel,t0=Vn.unstable_ImmediatePriority,zE=Vn.unstable_UserBlockingPriority,Yd=Vn.unstable_NormalPriority,Wk=Vn.unstable_LowPriority,LE=Vn.unstable_IdlePriority,Jh=null,kr=null;function Qk(t){if(kr&&typeof kr.onCommitFiberRoot=="function")try{kr.onCommitFiberRoot(Jh,t,void 0,(t.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:Jk,Yk=Math.log,Xk=Math.LN2;function Jk(t){return t>>>=0,t===0?32:31-(Yk(t)/Xk|0)|0}var ju=64,Fu=4194304;function Ul(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Xd(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,i=t.suspendedLanes,s=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~i;a!==0?r=Ul(a):(s&=o,s!==0&&(r=Ul(s)))}else o=n&~i,o!==0?r=Ul(o):s!==0&&(r=Ul(s));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,s=e&-e,i>=s||i===16&&(s&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-ur(e),i=1<<n,r|=t[n],e&=~i;return r}function Zk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function eR(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,i=t.expirationTimes,s=t.pendingLanes;0<s;){var o=31-ur(s),a=1<<o,l=i[o];l===-1?(!(a&n)||a&r)&&(i[o]=Zk(a,e)):l<=e&&(t.expiredLanes|=a),s&=~a}}function vm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ME(){var t=ju;return ju<<=1,!(ju&4194240)&&(ju=64),t}function np(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function iu(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-ur(e),t[e]=n}function tR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var i=31-ur(n),s=1<<i;e[i]=0,r[i]=-1,t[i]=-1,n&=~s}}function n0(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-ur(n),i=1<<r;i&e|t[r]&e&&(t[r]|=e),n&=~i}}var $e=0;function jE(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var FE,r0,$E,UE,BE,_m=!1,$u=[],Hi=null,qi=null,Ki=null,wc=new Map,xc=new Map,Vi=[],nR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function l_(t,e){switch(t){case"focusin":case"focusout":Hi=null;break;case"dragenter":case"dragleave":qi=null;break;case"mouseover":case"mouseout":Ki=null;break;case"pointerover":case"pointerout":wc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":xc.delete(e.pointerId)}}function Il(t,e,n,r,i,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},e!==null&&(e=ou(e),e!==null&&r0(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),t)}function rR(t,e,n,r,i){switch(e){case"focusin":return Hi=Il(Hi,t,e,n,r,i),!0;case"dragenter":return qi=Il(qi,t,e,n,r,i),!0;case"mouseover":return Ki=Il(Ki,t,e,n,r,i),!0;case"pointerover":var s=i.pointerId;return wc.set(s,Il(wc.get(s)||null,t,e,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,xc.set(s,Il(xc.get(s)||null,t,e,n,r,i)),!0}return!1}function HE(t){var e=Ls(t.target);if(e!==null){var n=yo(e);if(n!==null){if(e=n.tag,e===13){if(e=PE(n),e!==null){t.blockedOn=e,BE(t.priority,function(){$E(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function wd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=wm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);pm=r,n.target.dispatchEvent(r),pm=null}else return e=ou(n),e!==null&&r0(e),t.blockedOn=n,!1;e.shift()}return!0}function c_(t,e,n){wd(t)&&n.delete(e)}function iR(){_m=!1,Hi!==null&&wd(Hi)&&(Hi=null),qi!==null&&wd(qi)&&(qi=null),Ki!==null&&wd(Ki)&&(Ki=null),wc.forEach(c_),xc.forEach(c_)}function Tl(t,e){t.blockedOn===e&&(t.blockedOn=null,_m||(_m=!0,Vn.unstable_scheduleCallback(Vn.unstable_NormalPriority,iR)))}function Ec(t){function e(i){return Tl(i,t)}if(0<$u.length){Tl($u[0],t);for(var n=1;n<$u.length;n++){var r=$u[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Hi!==null&&Tl(Hi,t),qi!==null&&Tl(qi,t),Ki!==null&&Tl(Ki,t),wc.forEach(e),xc.forEach(e),n=0;n<Vi.length;n++)r=Vi[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Vi.length&&(n=Vi[0],n.blockedOn===null);)HE(n),n.blockedOn===null&&Vi.shift()}var ua=pi.ReactCurrentBatchConfig,Jd=!0;function sR(t,e,n,r){var i=$e,s=ua.transition;ua.transition=null;try{$e=1,i0(t,e,n,r)}finally{$e=i,ua.transition=s}}function oR(t,e,n,r){var i=$e,s=ua.transition;ua.transition=null;try{$e=4,i0(t,e,n,r)}finally{$e=i,ua.transition=s}}function i0(t,e,n,r){if(Jd){var i=wm(t,e,n,r);if(i===null)hp(t,e,r,Zd,n),l_(t,r);else if(rR(i,t,e,n,r))r.stopPropagation();else if(l_(t,r),e&4&&-1<nR.indexOf(t)){for(;i!==null;){var s=ou(i);if(s!==null&&FE(s),s=wm(t,e,n,r),s===null&&hp(t,e,r,Zd,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else hp(t,e,r,null,n)}}var Zd=null;function wm(t,e,n,r){if(Zd=null,t=e0(r),t=Ls(t),t!==null)if(e=yo(t),e===null)t=null;else if(n=e.tag,n===13){if(t=PE(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Zd=t,null}function qE(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Gk()){case t0:return 1;case zE:return 4;case Yd:case Wk:return 16;case LE:return 536870912;default:return 16}default:return 16}}var $i=null,s0=null,xd=null;function KE(){if(xd)return xd;var t,e=s0,n=e.length,r,i="value"in $i?$i.value:$i.textContent,s=i.length;for(t=0;t<n&&e[t]===i[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===i[s-r];r++);return xd=i.slice(t,1<r?1-r:void 0)}function Ed(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Uu(){return!0}function u_(){return!1}function Mn(t){function e(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Uu:u_,this.isPropagationStopped=u_,this}return lt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Uu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Uu)},persist:function(){},isPersistent:Uu}),e}var Qa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},o0=Mn(Qa),su=lt({},Qa,{view:0,detail:0}),aR=Mn(su),rp,ip,Sl,Zh=lt({},su,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:a0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Sl&&(Sl&&t.type==="mousemove"?(rp=t.screenX-Sl.screenX,ip=t.screenY-Sl.screenY):ip=rp=0,Sl=t),rp)},movementY:function(t){return"movementY"in t?t.movementY:ip}}),d_=Mn(Zh),lR=lt({},Zh,{dataTransfer:0}),cR=Mn(lR),uR=lt({},su,{relatedTarget:0}),sp=Mn(uR),dR=lt({},Qa,{animationName:0,elapsedTime:0,pseudoElement:0}),hR=Mn(dR),fR=lt({},Qa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),pR=Mn(fR),mR=lt({},Qa,{data:0}),h_=Mn(mR),gR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},yR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},vR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _R(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=vR[t])?!!e[t]:!1}function a0(){return _R}var wR=lt({},su,{key:function(t){if(t.key){var e=gR[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ed(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?yR[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:a0,charCode:function(t){return t.type==="keypress"?Ed(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ed(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),xR=Mn(wR),ER=lt({},Zh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),f_=Mn(ER),bR=lt({},su,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:a0}),IR=Mn(bR),TR=lt({},Qa,{propertyName:0,elapsedTime:0,pseudoElement:0}),SR=Mn(TR),CR=lt({},Zh,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),AR=Mn(CR),kR=[9,13,27,32],l0=si&&"CompositionEvent"in window,nc=null;si&&"documentMode"in document&&(nc=document.documentMode);var RR=si&&"TextEvent"in window&&!nc,GE=si&&(!l0||nc&&8<nc&&11>=nc),p_=" ",m_=!1;function WE(t,e){switch(t){case"keyup":return kR.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function QE(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Yo=!1;function NR(t,e){switch(t){case"compositionend":return QE(e);case"keypress":return e.which!==32?null:(m_=!0,p_);case"textInput":return t=e.data,t===p_&&m_?null:t;default:return null}}function PR(t,e){if(Yo)return t==="compositionend"||!l0&&WE(t,e)?(t=KE(),xd=s0=$i=null,Yo=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return GE&&e.locale!=="ko"?null:e.data;default:return null}}var DR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function g_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!DR[t.type]:e==="textarea"}function YE(t,e,n,r){CE(r),e=eh(e,"onChange"),0<e.length&&(n=new o0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var rc=null,bc=null;function VR(t){ab(t,0)}function ef(t){var e=Zo(t);if(wE(e))return t}function OR(t,e){if(t==="change")return e}var XE=!1;if(si){var op;if(si){var ap="oninput"in document;if(!ap){var y_=document.createElement("div");y_.setAttribute("oninput","return;"),ap=typeof y_.oninput=="function"}op=ap}else op=!1;XE=op&&(!document.documentMode||9<document.documentMode)}function v_(){rc&&(rc.detachEvent("onpropertychange",JE),bc=rc=null)}function JE(t){if(t.propertyName==="value"&&ef(bc)){var e=[];YE(e,bc,t,e0(t)),NE(VR,e)}}function zR(t,e,n){t==="focusin"?(v_(),rc=e,bc=n,rc.attachEvent("onpropertychange",JE)):t==="focusout"&&v_()}function LR(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return ef(bc)}function MR(t,e){if(t==="click")return ef(e)}function jR(t,e){if(t==="input"||t==="change")return ef(e)}function FR(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var pr=typeof Object.is=="function"?Object.is:FR;function Ic(t,e){if(pr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!nm.call(e,i)||!pr(t[i],e[i]))return!1}return!0}function __(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function w_(t,e){var n=__(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=__(n)}}function ZE(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?ZE(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function eb(){for(var t=window,e=Gd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Gd(t.document)}return e}function c0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function $R(t){var e=eb(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&ZE(n.ownerDocument.documentElement,n)){if(r!==null&&c0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!t.extend&&s>r&&(i=r,r=s,s=i),i=w_(n,s);var o=w_(n,r);i&&o&&(t.rangeCount!==1||t.anchorNode!==i.node||t.anchorOffset!==i.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),t.removeAllRanges(),s>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var UR=si&&"documentMode"in document&&11>=document.documentMode,Xo=null,xm=null,ic=null,Em=!1;function x_(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Em||Xo==null||Xo!==Gd(r)||(r=Xo,"selectionStart"in r&&c0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ic&&Ic(ic,r)||(ic=r,r=eh(xm,"onSelect"),0<r.length&&(e=new o0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xo)))}function Bu(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Jo={animationend:Bu("Animation","AnimationEnd"),animationiteration:Bu("Animation","AnimationIteration"),animationstart:Bu("Animation","AnimationStart"),transitionend:Bu("Transition","TransitionEnd")},lp={},tb={};si&&(tb=document.createElement("div").style,"AnimationEvent"in window||(delete Jo.animationend.animation,delete Jo.animationiteration.animation,delete Jo.animationstart.animation),"TransitionEvent"in window||delete Jo.transitionend.transition);function tf(t){if(lp[t])return lp[t];if(!Jo[t])return t;var e=Jo[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in tb)return lp[t]=e[n];return t}var nb=tf("animationend"),rb=tf("animationiteration"),ib=tf("animationstart"),sb=tf("transitionend"),ob=new Map,E_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function us(t,e){ob.set(t,e),go(e,[t])}for(var cp=0;cp<E_.length;cp++){var up=E_[cp],BR=up.toLowerCase(),HR=up[0].toUpperCase()+up.slice(1);us(BR,"on"+HR)}us(nb,"onAnimationEnd");us(rb,"onAnimationIteration");us(ib,"onAnimationStart");us("dblclick","onDoubleClick");us("focusin","onFocus");us("focusout","onBlur");us(sb,"onTransitionEnd");xa("onMouseEnter",["mouseout","mouseover"]);xa("onMouseLeave",["mouseout","mouseover"]);xa("onPointerEnter",["pointerout","pointerover"]);xa("onPointerLeave",["pointerout","pointerover"]);go("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));go("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));go("onBeforeInput",["compositionend","keypress","textInput","paste"]);go("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));go("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));go("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Bl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),qR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Bl));function b_(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,Bk(r,e,void 0,t),t.currentTarget=null}function ab(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],i=r.event;r=r.listeners;e:{var s=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;b_(i,a,c),s=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;b_(i,a,c),s=l}}}if(Qd)throw t=ym,Qd=!1,ym=null,t}function Ze(t,e){var n=e[Cm];n===void 0&&(n=e[Cm]=new Set);var r=t+"__bubble";n.has(r)||(lb(e,t,2,!1),n.add(r))}function dp(t,e,n){var r=0;e&&(r|=4),lb(n,t,r,e)}var Hu="_reactListening"+Math.random().toString(36).slice(2);function Tc(t){if(!t[Hu]){t[Hu]=!0,mE.forEach(function(n){n!=="selectionchange"&&(qR.has(n)||dp(n,!1,t),dp(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hu]||(e[Hu]=!0,dp("selectionchange",!1,e))}}function lb(t,e,n,r){switch(qE(e)){case 1:var i=sR;break;case 4:i=oR;break;default:i=i0}n=i.bind(null,e,n,t),i=void 0,!gm||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?t.addEventListener(e,n,{capture:!0,passive:i}):t.addEventListener(e,n,!0):i!==void 0?t.addEventListener(e,n,{passive:i}):t.addEventListener(e,n,!1)}function hp(t,e,n,r,i){var s=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;o=o.return}for(;a!==null;){if(o=Ls(a),o===null)return;if(l=o.tag,l===5||l===6){r=s=o;continue e}a=a.parentNode}}r=r.return}NE(function(){var c=s,d=e0(n),h=[];e:{var f=ob.get(t);if(f!==void 0){var m=o0,b=t;switch(t){case"keypress":if(Ed(n)===0)break e;case"keydown":case"keyup":m=xR;break;case"focusin":b="focus",m=sp;break;case"focusout":b="blur",m=sp;break;case"beforeblur":case"afterblur":m=sp;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=d_;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=cR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=IR;break;case nb:case rb:case ib:m=hR;break;case sb:m=SR;break;case"scroll":m=aR;break;case"wheel":m=AR;break;case"copy":case"cut":case"paste":m=pR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=f_}var x=(e&4)!==0,R=!x&&t==="scroll",y=x?f!==null?f+"Capture":null:f;x=[];for(var v=c,T;v!==null;){T=v;var A=T.stateNode;if(T.tag===5&&A!==null&&(T=A,y!==null&&(A=_c(v,y),A!=null&&x.push(Sc(v,A,T)))),R)break;v=v.return}0<x.length&&(f=new m(f,b,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==pm&&(b=n.relatedTarget||n.fromElement)&&(Ls(b)||b[oi]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(b=n.relatedTarget||n.toElement,m=c,b=b?Ls(b):null,b!==null&&(R=yo(b),b!==R||b.tag!==5&&b.tag!==6)&&(b=null)):(m=null,b=c),m!==b)){if(x=d_,A="onMouseLeave",y="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(x=f_,A="onPointerLeave",y="onPointerEnter",v="pointer"),R=m==null?f:Zo(m),T=b==null?f:Zo(b),f=new x(A,v+"leave",m,n,d),f.target=R,f.relatedTarget=T,A=null,Ls(d)===c&&(x=new x(y,v+"enter",b,n,d),x.target=T,x.relatedTarget=R,A=x),R=A,m&&b)t:{for(x=m,y=b,v=0,T=x;T;T=No(T))v++;for(T=0,A=y;A;A=No(A))T++;for(;0<v-T;)x=No(x),v--;for(;0<T-v;)y=No(y),T--;for(;v--;){if(x===y||y!==null&&x===y.alternate)break t;x=No(x),y=No(y)}x=null}else x=null;m!==null&&I_(h,f,m,x,!1),b!==null&&R!==null&&I_(h,R,b,x,!0)}}e:{if(f=c?Zo(c):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var O=OR;else if(g_(f))if(XE)O=jR;else{O=LR;var L=zR}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(O=MR);if(O&&(O=O(t,c))){YE(h,O,n,d);break e}L&&L(t,f,c),t==="focusout"&&(L=f._wrapperState)&&L.controlled&&f.type==="number"&&cm(f,"number",f.value)}switch(L=c?Zo(c):window,t){case"focusin":(g_(L)||L.contentEditable==="true")&&(Xo=L,xm=c,ic=null);break;case"focusout":ic=xm=Xo=null;break;case"mousedown":Em=!0;break;case"contextmenu":case"mouseup":case"dragend":Em=!1,x_(h,n,d);break;case"selectionchange":if(UR)break;case"keydown":case"keyup":x_(h,n,d)}var S;if(l0)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Yo?WE(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(GE&&n.locale!=="ko"&&(Yo||I!=="onCompositionStart"?I==="onCompositionEnd"&&Yo&&(S=KE()):($i=d,s0="value"in $i?$i.value:$i.textContent,Yo=!0)),L=eh(c,I),0<L.length&&(I=new h_(I,t,null,n,d),h.push({event:I,listeners:L}),S?I.data=S:(S=QE(n),S!==null&&(I.data=S)))),(S=RR?NR(t,n):PR(t,n))&&(c=eh(c,"onBeforeInput"),0<c.length&&(d=new h_("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:c}),d.data=S))}ab(h,e)})}function Sc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function eh(t,e){for(var n=e+"Capture",r=[];t!==null;){var i=t,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=_c(t,n),s!=null&&r.unshift(Sc(t,s,i)),s=_c(t,e),s!=null&&r.push(Sc(t,s,i))),t=t.return}return r}function No(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function I_(t,e,n,r,i){for(var s=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=_c(n,s),l!=null&&o.unshift(Sc(n,l,a))):i||(l=_c(n,s),l!=null&&o.push(Sc(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var KR=/\r\n?/g,GR=/\u0000|\uFFFD/g;function T_(t){return(typeof t=="string"?t:""+t).replace(KR,`
`).replace(GR,"")}function qu(t,e,n){if(e=T_(e),T_(t)!==e&&n)throw Error(Z(425))}function th(){}var bm=null,Im=null;function Tm(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Sm=typeof setTimeout=="function"?setTimeout:void 0,WR=typeof clearTimeout=="function"?clearTimeout:void 0,S_=typeof Promise=="function"?Promise:void 0,QR=typeof queueMicrotask=="function"?queueMicrotask:typeof S_<"u"?function(t){return S_.resolve(null).then(t).catch(YR)}:Sm;function YR(t){setTimeout(function(){throw t})}function fp(t,e){var n=e,r=0;do{var i=n.nextSibling;if(t.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){t.removeChild(i),Ec(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);Ec(e)}function Gi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function C_(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Ya=Math.random().toString(36).slice(2),Sr="__reactFiber$"+Ya,Cc="__reactProps$"+Ya,oi="__reactContainer$"+Ya,Cm="__reactEvents$"+Ya,XR="__reactListeners$"+Ya,JR="__reactHandles$"+Ya;function Ls(t){var e=t[Sr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[oi]||n[Sr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=C_(t);t!==null;){if(n=t[Sr])return n;t=C_(t)}return e}t=n,n=t.parentNode}return null}function ou(t){return t=t[Sr]||t[oi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Z(33))}function nf(t){return t[Cc]||null}var Am=[],ea=-1;function ds(t){return{current:t}}function et(t){0>ea||(t.current=Am[ea],Am[ea]=null,ea--)}function We(t,e){ea++,Am[ea]=t.current,t.current=e}var ss={},Wt=ds(ss),mn=ds(!1),Ys=ss;function Ea(t,e){var n=t.type.contextTypes;if(!n)return ss;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=e[s];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=i),i}function gn(t){return t=t.childContextTypes,t!=null}function nh(){et(mn),et(Wt)}function A_(t,e,n){if(Wt.current!==ss)throw Error(Z(168));We(Wt,e),We(mn,n)}function cb(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(Z(108,zk(t)||"Unknown",i));return lt({},n,r)}function rh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ss,Ys=Wt.current,We(Wt,t),We(mn,mn.current),!0}function k_(t,e,n){var r=t.stateNode;if(!r)throw Error(Z(169));n?(t=cb(t,e,Ys),r.__reactInternalMemoizedMergedChildContext=t,et(mn),et(Wt),We(Wt,t)):et(mn),We(mn,n)}var Gr=null,rf=!1,pp=!1;function ub(t){Gr===null?Gr=[t]:Gr.push(t)}function ZR(t){rf=!0,ub(t)}function hs(){if(!pp&&Gr!==null){pp=!0;var t=0,e=$e;try{var n=Gr;for($e=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Gr=null,rf=!1}catch(i){throw Gr!==null&&(Gr=Gr.slice(t+1)),OE(t0,hs),i}finally{$e=e,pp=!1}}return null}var ta=[],na=0,ih=null,sh=0,Bn=[],Hn=0,Xs=null,Qr=1,Yr="";function As(t,e){ta[na++]=sh,ta[na++]=ih,ih=t,sh=e}function db(t,e,n){Bn[Hn++]=Qr,Bn[Hn++]=Yr,Bn[Hn++]=Xs,Xs=t;var r=Qr;t=Yr;var i=32-ur(r)-1;r&=~(1<<i),n+=1;var s=32-ur(e)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Qr=1<<32-ur(e)+i|n<<i|r,Yr=s+t}else Qr=1<<s|n<<i|r,Yr=t}function u0(t){t.return!==null&&(As(t,1),db(t,1,0))}function d0(t){for(;t===ih;)ih=ta[--na],ta[na]=null,sh=ta[--na],ta[na]=null;for(;t===Xs;)Xs=Bn[--Hn],Bn[Hn]=null,Yr=Bn[--Hn],Bn[Hn]=null,Qr=Bn[--Hn],Bn[Hn]=null}var Nn=null,kn=null,rt=!1,ar=null;function hb(t,e){var n=qn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function R_(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Nn=t,kn=Gi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Nn=t,kn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Xs!==null?{id:Qr,overflow:Yr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=qn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Nn=t,kn=null,!0):!1;default:return!1}}function km(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Rm(t){if(rt){var e=kn;if(e){var n=e;if(!R_(t,e)){if(km(t))throw Error(Z(418));e=Gi(n.nextSibling);var r=Nn;e&&R_(t,e)?hb(r,n):(t.flags=t.flags&-4097|2,rt=!1,Nn=t)}}else{if(km(t))throw Error(Z(418));t.flags=t.flags&-4097|2,rt=!1,Nn=t}}}function N_(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Nn=t}function Ku(t){if(t!==Nn)return!1;if(!rt)return N_(t),rt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Tm(t.type,t.memoizedProps)),e&&(e=kn)){if(km(t))throw fb(),Error(Z(418));for(;e;)hb(t,e),e=Gi(e.nextSibling)}if(N_(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Z(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){kn=Gi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}kn=null}}else kn=Nn?Gi(t.stateNode.nextSibling):null;return!0}function fb(){for(var t=kn;t;)t=Gi(t.nextSibling)}function ba(){kn=Nn=null,rt=!1}function h0(t){ar===null?ar=[t]:ar.push(t)}var eN=pi.ReactCurrentBatchConfig;function Cl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Z(309));var r=n.stateNode}if(!r)throw Error(Z(147,t));var i=r,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=i.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof t!="string")throw Error(Z(284));if(!n._owner)throw Error(Z(290,t))}return t}function Gu(t,e){throw t=Object.prototype.toString.call(e),Error(Z(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function P_(t){var e=t._init;return e(t._payload)}function pb(t){function e(y,v){if(t){var T=y.deletions;T===null?(y.deletions=[v],y.flags|=16):T.push(v)}}function n(y,v){if(!t)return null;for(;v!==null;)e(y,v),v=v.sibling;return null}function r(y,v){for(y=new Map;v!==null;)v.key!==null?y.set(v.key,v):y.set(v.index,v),v=v.sibling;return y}function i(y,v){return y=Xi(y,v),y.index=0,y.sibling=null,y}function s(y,v,T){return y.index=T,t?(T=y.alternate,T!==null?(T=T.index,T<v?(y.flags|=2,v):T):(y.flags|=2,v)):(y.flags|=1048576,v)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,v,T,A){return v===null||v.tag!==6?(v=xp(T,y.mode,A),v.return=y,v):(v=i(v,T),v.return=y,v)}function l(y,v,T,A){var O=T.type;return O===Qo?d(y,v,T.props.children,A,T.key):v!==null&&(v.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Ri&&P_(O)===v.type)?(A=i(v,T.props),A.ref=Cl(y,v,T),A.return=y,A):(A=kd(T.type,T.key,T.props,null,y.mode,A),A.ref=Cl(y,v,T),A.return=y,A)}function c(y,v,T,A){return v===null||v.tag!==4||v.stateNode.containerInfo!==T.containerInfo||v.stateNode.implementation!==T.implementation?(v=Ep(T,y.mode,A),v.return=y,v):(v=i(v,T.children||[]),v.return=y,v)}function d(y,v,T,A,O){return v===null||v.tag!==7?(v=qs(T,y.mode,A,O),v.return=y,v):(v=i(v,T),v.return=y,v)}function h(y,v,T){if(typeof v=="string"&&v!==""||typeof v=="number")return v=xp(""+v,y.mode,T),v.return=y,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case zu:return T=kd(v.type,v.key,v.props,null,y.mode,T),T.ref=Cl(y,null,v),T.return=y,T;case Wo:return v=Ep(v,y.mode,T),v.return=y,v;case Ri:var A=v._init;return h(y,A(v._payload),T)}if($l(v)||El(v))return v=qs(v,y.mode,T,null),v.return=y,v;Gu(y,v)}return null}function f(y,v,T,A){var O=v!==null?v.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return O!==null?null:a(y,v,""+T,A);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case zu:return T.key===O?l(y,v,T,A):null;case Wo:return T.key===O?c(y,v,T,A):null;case Ri:return O=T._init,f(y,v,O(T._payload),A)}if($l(T)||El(T))return O!==null?null:d(y,v,T,A,null);Gu(y,T)}return null}function m(y,v,T,A,O){if(typeof A=="string"&&A!==""||typeof A=="number")return y=y.get(T)||null,a(v,y,""+A,O);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case zu:return y=y.get(A.key===null?T:A.key)||null,l(v,y,A,O);case Wo:return y=y.get(A.key===null?T:A.key)||null,c(v,y,A,O);case Ri:var L=A._init;return m(y,v,T,L(A._payload),O)}if($l(A)||El(A))return y=y.get(T)||null,d(v,y,A,O,null);Gu(v,A)}return null}function b(y,v,T,A){for(var O=null,L=null,S=v,I=v=0,w=null;S!==null&&I<T.length;I++){S.index>I?(w=S,S=null):w=S.sibling;var E=f(y,S,T[I],A);if(E===null){S===null&&(S=w);break}t&&S&&E.alternate===null&&e(y,S),v=s(E,v,I),L===null?O=E:L.sibling=E,L=E,S=w}if(I===T.length)return n(y,S),rt&&As(y,I),O;if(S===null){for(;I<T.length;I++)S=h(y,T[I],A),S!==null&&(v=s(S,v,I),L===null?O=S:L.sibling=S,L=S);return rt&&As(y,I),O}for(S=r(y,S);I<T.length;I++)w=m(S,y,I,T[I],A),w!==null&&(t&&w.alternate!==null&&S.delete(w.key===null?I:w.key),v=s(w,v,I),L===null?O=w:L.sibling=w,L=w);return t&&S.forEach(function(C){return e(y,C)}),rt&&As(y,I),O}function x(y,v,T,A){var O=El(T);if(typeof O!="function")throw Error(Z(150));if(T=O.call(T),T==null)throw Error(Z(151));for(var L=O=null,S=v,I=v=0,w=null,E=T.next();S!==null&&!E.done;I++,E=T.next()){S.index>I?(w=S,S=null):w=S.sibling;var C=f(y,S,E.value,A);if(C===null){S===null&&(S=w);break}t&&S&&C.alternate===null&&e(y,S),v=s(C,v,I),L===null?O=C:L.sibling=C,L=C,S=w}if(E.done)return n(y,S),rt&&As(y,I),O;if(S===null){for(;!E.done;I++,E=T.next())E=h(y,E.value,A),E!==null&&(v=s(E,v,I),L===null?O=E:L.sibling=E,L=E);return rt&&As(y,I),O}for(S=r(y,S);!E.done;I++,E=T.next())E=m(S,y,I,E.value,A),E!==null&&(t&&E.alternate!==null&&S.delete(E.key===null?I:E.key),v=s(E,v,I),L===null?O=E:L.sibling=E,L=E);return t&&S.forEach(function(N){return e(y,N)}),rt&&As(y,I),O}function R(y,v,T,A){if(typeof T=="object"&&T!==null&&T.type===Qo&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case zu:e:{for(var O=T.key,L=v;L!==null;){if(L.key===O){if(O=T.type,O===Qo){if(L.tag===7){n(y,L.sibling),v=i(L,T.props.children),v.return=y,y=v;break e}}else if(L.elementType===O||typeof O=="object"&&O!==null&&O.$$typeof===Ri&&P_(O)===L.type){n(y,L.sibling),v=i(L,T.props),v.ref=Cl(y,L,T),v.return=y,y=v;break e}n(y,L);break}else e(y,L);L=L.sibling}T.type===Qo?(v=qs(T.props.children,y.mode,A,T.key),v.return=y,y=v):(A=kd(T.type,T.key,T.props,null,y.mode,A),A.ref=Cl(y,v,T),A.return=y,y=A)}return o(y);case Wo:e:{for(L=T.key;v!==null;){if(v.key===L)if(v.tag===4&&v.stateNode.containerInfo===T.containerInfo&&v.stateNode.implementation===T.implementation){n(y,v.sibling),v=i(v,T.children||[]),v.return=y,y=v;break e}else{n(y,v);break}else e(y,v);v=v.sibling}v=Ep(T,y.mode,A),v.return=y,y=v}return o(y);case Ri:return L=T._init,R(y,v,L(T._payload),A)}if($l(T))return b(y,v,T,A);if(El(T))return x(y,v,T,A);Gu(y,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,v!==null&&v.tag===6?(n(y,v.sibling),v=i(v,T),v.return=y,y=v):(n(y,v),v=xp(T,y.mode,A),v.return=y,y=v),o(y)):n(y,v)}return R}var Ia=pb(!0),mb=pb(!1),oh=ds(null),ah=null,ra=null,f0=null;function p0(){f0=ra=ah=null}function m0(t){var e=oh.current;et(oh),t._currentValue=e}function Nm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function da(t,e){ah=t,f0=ra=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(dn=!0),t.firstContext=null)}function Yn(t){var e=t._currentValue;if(f0!==t)if(t={context:t,memoizedValue:e,next:null},ra===null){if(ah===null)throw Error(Z(308));ra=t,ah.dependencies={lanes:0,firstContext:t}}else ra=ra.next=t;return e}var Ms=null;function g0(t){Ms===null?Ms=[t]:Ms.push(t)}function gb(t,e,n,r){var i=e.interleaved;return i===null?(n.next=n,g0(e)):(n.next=i.next,i.next=n),e.interleaved=n,ai(t,r)}function ai(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ni=!1;function y0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function yb(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ni(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Wi(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,De&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,ai(t,n)}return i=r.interleaved,i===null?(e.next=e,g0(r)):(e.next=i.next,i.next=e),r.interleaved=e,ai(t,n)}function bd(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,n0(t,n)}}function D_(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=e:s=s.next=e}else i=s=e;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function lh(t,e,n,r){var i=t.updateQueue;Ni=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?s=c:o.next=c,o=l;var d=t.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=c:a.next=c,d.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;o=0,d=c=l=null,a=s;do{var f=a.lane,m=a.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var b=t,x=a;switch(f=e,m=n,x.tag){case 1:if(b=x.payload,typeof b=="function"){h=b.call(m,h,f);break e}h=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=x.payload,f=typeof b=="function"?b.call(m,h,f):b,f==null)break e;h=lt({},h,f);break e;case 2:Ni=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,f=i.effects,f===null?i.effects=[a]:f.push(a))}else m={eventTime:m,lane:f,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(c=d=m,l=h):d=d.next=m,o|=f;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;f=a,a=f.next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}while(!0);if(d===null&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=d,e=i.shared.interleaved,e!==null){i=e;do o|=i.lane,i=i.next;while(i!==e)}else s===null&&(i.shared.lanes=0);Zs|=o,t.lanes=o,t.memoizedState=h}}function V_(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(Z(191,i));i.call(r)}}}var au={},Rr=ds(au),Ac=ds(au),kc=ds(au);function js(t){if(t===au)throw Error(Z(174));return t}function v0(t,e){switch(We(kc,e),We(Ac,t),We(Rr,au),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:dm(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=dm(e,t)}et(Rr),We(Rr,e)}function Ta(){et(Rr),et(Ac),et(kc)}function vb(t){js(kc.current);var e=js(Rr.current),n=dm(e,t.type);e!==n&&(We(Ac,t),We(Rr,n))}function _0(t){Ac.current===t&&(et(Rr),et(Ac))}var it=ds(0);function ch(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var mp=[];function w0(){for(var t=0;t<mp.length;t++)mp[t]._workInProgressVersionPrimary=null;mp.length=0}var Id=pi.ReactCurrentDispatcher,gp=pi.ReactCurrentBatchConfig,Js=0,ot=null,Et=null,Rt=null,uh=!1,sc=!1,Rc=0,tN=0;function Bt(){throw Error(Z(321))}function x0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!pr(t[n],e[n]))return!1;return!0}function E0(t,e,n,r,i,s){if(Js=s,ot=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Id.current=t===null||t.memoizedState===null?sN:oN,t=n(r,i),sc){s=0;do{if(sc=!1,Rc=0,25<=s)throw Error(Z(301));s+=1,Rt=Et=null,e.updateQueue=null,Id.current=aN,t=n(r,i)}while(sc)}if(Id.current=dh,e=Et!==null&&Et.next!==null,Js=0,Rt=Et=ot=null,uh=!1,e)throw Error(Z(300));return t}function b0(){var t=Rc!==0;return Rc=0,t}function Tr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?ot.memoizedState=Rt=t:Rt=Rt.next=t,Rt}function Xn(){if(Et===null){var t=ot.alternate;t=t!==null?t.memoizedState:null}else t=Et.next;var e=Rt===null?ot.memoizedState:Rt.next;if(e!==null)Rt=e,Et=t;else{if(t===null)throw Error(Z(310));Et=t,t={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},Rt===null?ot.memoizedState=Rt=t:Rt=Rt.next=t}return Rt}function Nc(t,e){return typeof e=="function"?e(t):e}function yp(t){var e=Xn(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=Et,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var a=o=null,l=null,c=s;do{var d=c.lane;if((Js&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,ot.lanes|=d,Zs|=d}c=c.next}while(c!==null&&c!==s);l===null?o=r:l.next=a,pr(r,e.memoizedState)||(dn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){i=t;do s=i.lane,ot.lanes|=s,Zs|=s,i=i.next;while(i!==t)}else i===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function vp(t){var e=Xn(),n=e.queue;if(n===null)throw Error(Z(311));n.lastRenderedReducer=t;var r=n.dispatch,i=n.pending,s=e.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=t(s,o.action),o=o.next;while(o!==i);pr(s,e.memoizedState)||(dn=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,r]}function _b(){}function wb(t,e){var n=ot,r=Xn(),i=e(),s=!pr(r.memoizedState,i);if(s&&(r.memoizedState=i,dn=!0),r=r.queue,I0(bb.bind(null,n,r,t),[t]),r.getSnapshot!==e||s||Rt!==null&&Rt.memoizedState.tag&1){if(n.flags|=2048,Pc(9,Eb.bind(null,n,r,i,e),void 0,null),Nt===null)throw Error(Z(349));Js&30||xb(n,e,i)}return i}function xb(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function Eb(t,e,n,r){e.value=n,e.getSnapshot=r,Ib(e)&&Tb(t)}function bb(t,e,n){return n(function(){Ib(e)&&Tb(t)})}function Ib(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!pr(t,n)}catch{return!0}}function Tb(t){var e=ai(t,1);e!==null&&dr(e,t,1,-1)}function O_(t){var e=Tr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Nc,lastRenderedState:t},e.queue=t,t=t.dispatch=iN.bind(null,ot,t),[e.memoizedState,t]}function Pc(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=ot.updateQueue,e===null?(e={lastEffect:null,stores:null},ot.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Sb(){return Xn().memoizedState}function Td(t,e,n,r){var i=Tr();ot.flags|=t,i.memoizedState=Pc(1|e,n,void 0,r===void 0?null:r)}function sf(t,e,n,r){var i=Xn();r=r===void 0?null:r;var s=void 0;if(Et!==null){var o=Et.memoizedState;if(s=o.destroy,r!==null&&x0(r,o.deps)){i.memoizedState=Pc(e,n,s,r);return}}ot.flags|=t,i.memoizedState=Pc(1|e,n,s,r)}function z_(t,e){return Td(8390656,8,t,e)}function I0(t,e){return sf(2048,8,t,e)}function Cb(t,e){return sf(4,2,t,e)}function Ab(t,e){return sf(4,4,t,e)}function kb(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Rb(t,e,n){return n=n!=null?n.concat([t]):null,sf(4,4,kb.bind(null,e,t),n)}function T0(){}function Nb(t,e){var n=Xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&x0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Pb(t,e){var n=Xn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&x0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Db(t,e,n){return Js&21?(pr(n,e)||(n=ME(),ot.lanes|=n,Zs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,dn=!0),t.memoizedState=n)}function nN(t,e){var n=$e;$e=n!==0&&4>n?n:4,t(!0);var r=gp.transition;gp.transition={};try{t(!1),e()}finally{$e=n,gp.transition=r}}function Vb(){return Xn().memoizedState}function rN(t,e,n){var r=Yi(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Ob(t))zb(e,n);else if(n=gb(t,e,n,r),n!==null){var i=Zt();dr(n,t,r,i),Lb(n,e,r)}}function iN(t,e,n){var r=Yi(t),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Ob(t))zb(e,i);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,pr(a,o)){var l=e.interleaved;l===null?(i.next=i,g0(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}n=gb(t,e,i,r),n!==null&&(i=Zt(),dr(n,t,r,i),Lb(n,e,r))}}function Ob(t){var e=t.alternate;return t===ot||e!==null&&e===ot}function zb(t,e){sc=uh=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Lb(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,n0(t,n)}}var dh={readContext:Yn,useCallback:Bt,useContext:Bt,useEffect:Bt,useImperativeHandle:Bt,useInsertionEffect:Bt,useLayoutEffect:Bt,useMemo:Bt,useReducer:Bt,useRef:Bt,useState:Bt,useDebugValue:Bt,useDeferredValue:Bt,useTransition:Bt,useMutableSource:Bt,useSyncExternalStore:Bt,useId:Bt,unstable_isNewReconciler:!1},sN={readContext:Yn,useCallback:function(t,e){return Tr().memoizedState=[t,e===void 0?null:e],t},useContext:Yn,useEffect:z_,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Td(4194308,4,kb.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Td(4194308,4,t,e)},useInsertionEffect:function(t,e){return Td(4,2,t,e)},useMemo:function(t,e){var n=Tr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Tr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=rN.bind(null,ot,t),[r.memoizedState,t]},useRef:function(t){var e=Tr();return t={current:t},e.memoizedState=t},useState:O_,useDebugValue:T0,useDeferredValue:function(t){return Tr().memoizedState=t},useTransition:function(){var t=O_(!1),e=t[0];return t=nN.bind(null,t[1]),Tr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=ot,i=Tr();if(rt){if(n===void 0)throw Error(Z(407));n=n()}else{if(n=e(),Nt===null)throw Error(Z(349));Js&30||xb(r,e,n)}i.memoizedState=n;var s={value:n,getSnapshot:e};return i.queue=s,z_(bb.bind(null,r,s,t),[t]),r.flags|=2048,Pc(9,Eb.bind(null,r,s,n,e),void 0,null),n},useId:function(){var t=Tr(),e=Nt.identifierPrefix;if(rt){var n=Yr,r=Qr;n=(r&~(1<<32-ur(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Rc++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=tN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},oN={readContext:Yn,useCallback:Nb,useContext:Yn,useEffect:I0,useImperativeHandle:Rb,useInsertionEffect:Cb,useLayoutEffect:Ab,useMemo:Pb,useReducer:yp,useRef:Sb,useState:function(){return yp(Nc)},useDebugValue:T0,useDeferredValue:function(t){var e=Xn();return Db(e,Et.memoizedState,t)},useTransition:function(){var t=yp(Nc)[0],e=Xn().memoizedState;return[t,e]},useMutableSource:_b,useSyncExternalStore:wb,useId:Vb,unstable_isNewReconciler:!1},aN={readContext:Yn,useCallback:Nb,useContext:Yn,useEffect:I0,useImperativeHandle:Rb,useInsertionEffect:Cb,useLayoutEffect:Ab,useMemo:Pb,useReducer:vp,useRef:Sb,useState:function(){return vp(Nc)},useDebugValue:T0,useDeferredValue:function(t){var e=Xn();return Et===null?e.memoizedState=t:Db(e,Et.memoizedState,t)},useTransition:function(){var t=vp(Nc)[0],e=Xn().memoizedState;return[t,e]},useMutableSource:_b,useSyncExternalStore:wb,useId:Vb,unstable_isNewReconciler:!1};function ir(t,e){if(t&&t.defaultProps){e=lt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function Pm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:lt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var of={isMounted:function(t){return(t=t._reactInternals)?yo(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Zt(),i=Yi(t),s=ni(r,i);s.payload=e,n!=null&&(s.callback=n),e=Wi(t,s,i),e!==null&&(dr(e,t,i,r),bd(e,t,i))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Zt(),i=Yi(t),s=ni(r,i);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Wi(t,s,i),e!==null&&(dr(e,t,i,r),bd(e,t,i))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Zt(),r=Yi(t),i=ni(n,r);i.tag=2,e!=null&&(i.callback=e),e=Wi(t,i,r),e!==null&&(dr(e,t,r,n),bd(e,t,r))}};function L_(t,e,n,r,i,s,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,s,o):e.prototype&&e.prototype.isPureReactComponent?!Ic(n,r)||!Ic(i,s):!0}function Mb(t,e,n){var r=!1,i=ss,s=e.contextType;return typeof s=="object"&&s!==null?s=Yn(s):(i=gn(e)?Ys:Wt.current,r=e.contextTypes,s=(r=r!=null)?Ea(t,i):ss),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=of,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=s),e}function M_(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&of.enqueueReplaceState(e,e.state,null)}function Dm(t,e,n,r){var i=t.stateNode;i.props=n,i.state=t.memoizedState,i.refs={},y0(t);var s=e.contextType;typeof s=="object"&&s!==null?i.context=Yn(s):(s=gn(e)?Ys:Wt.current,i.context=Ea(t,s)),i.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(Pm(t,e,s,n),i.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&of.enqueueReplaceState(i,i.state,null),lh(t,n,i,r),i.state=t.memoizedState),typeof i.componentDidMount=="function"&&(t.flags|=4194308)}function Sa(t,e){try{var n="",r=e;do n+=Ok(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:i,digest:null}}function _p(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Vm(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var lN=typeof WeakMap=="function"?WeakMap:Map;function jb(t,e,n){n=ni(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){fh||(fh=!0,Hm=r),Vm(t,e)},n}function Fb(t,e,n){n=ni(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;n.payload=function(){return r(i)},n.callback=function(){Vm(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){Vm(t,e),typeof r!="function"&&(Qi===null?Qi=new Set([this]):Qi.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function j_(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new lN;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(n)||(i.add(n),t=EN.bind(null,t,e,n),e.then(t,t))}function F_(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function $_(t,e,n,r,i){return t.mode&1?(t.flags|=65536,t.lanes=i,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ni(-1,1),e.tag=2,Wi(n,e,1))),n.lanes|=1),t)}var cN=pi.ReactCurrentOwner,dn=!1;function Jt(t,e,n,r){e.child=t===null?mb(e,null,n,r):Ia(e,t.child,n,r)}function U_(t,e,n,r,i){n=n.render;var s=e.ref;return da(e,i),r=E0(t,e,n,r,s,i),n=b0(),t!==null&&!dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,li(t,e,i)):(rt&&n&&u0(e),e.flags|=1,Jt(t,e,r,i),e.child)}function B_(t,e,n,r,i){if(t===null){var s=n.type;return typeof s=="function"&&!D0(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,$b(t,e,s,r,i)):(t=kd(n.type,null,r,e,e.mode,i),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Ic,n(o,r)&&t.ref===e.ref)return li(t,e,i)}return e.flags|=1,t=Xi(s,r),t.ref=e.ref,t.return=e,e.child=t}function $b(t,e,n,r,i){if(t!==null){var s=t.memoizedProps;if(Ic(s,r)&&t.ref===e.ref)if(dn=!1,e.pendingProps=r=s,(t.lanes&i)!==0)t.flags&131072&&(dn=!0);else return e.lanes=t.lanes,li(t,e,i)}return Om(t,e,n,r,i)}function Ub(t,e,n){var r=e.pendingProps,i=r.children,s=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},We(sa,Sn),Sn|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,We(sa,Sn),Sn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,We(sa,Sn),Sn|=r}else s!==null?(r=s.baseLanes|n,e.memoizedState=null):r=n,We(sa,Sn),Sn|=r;return Jt(t,e,i,n),e.child}function Bb(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function Om(t,e,n,r,i){var s=gn(n)?Ys:Wt.current;return s=Ea(e,s),da(e,i),n=E0(t,e,n,r,s,i),r=b0(),t!==null&&!dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~i,li(t,e,i)):(rt&&r&&u0(e),e.flags|=1,Jt(t,e,n,i),e.child)}function H_(t,e,n,r,i){if(gn(n)){var s=!0;rh(e)}else s=!1;if(da(e,i),e.stateNode===null)Sd(t,e),Mb(e,n,r),Dm(e,n,r,i),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=Yn(c):(c=gn(n)?Ys:Wt.current,c=Ea(e,c));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&M_(e,o,r,c),Ni=!1;var f=e.memoizedState;o.state=f,lh(e,r,o,i),l=e.memoizedState,a!==r||f!==l||mn.current||Ni?(typeof d=="function"&&(Pm(e,n,d,r),l=e.memoizedState),(a=Ni||L_(e,n,a,r,f,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,yb(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:ir(e.type,a),o.props=c,h=e.pendingProps,f=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=Yn(l):(l=gn(n)?Ys:Wt.current,l=Ea(e,l));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||f!==l)&&M_(e,o,r,l),Ni=!1,f=e.memoizedState,o.state=f,lh(e,r,o,i);var b=e.memoizedState;a!==h||f!==b||mn.current||Ni?(typeof m=="function"&&(Pm(e,n,m,r),b=e.memoizedState),(c=Ni||L_(e,n,c,r,f,b,l)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,b,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,b,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=b),o.props=r,o.state=b,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return zm(t,e,n,r,s,i)}function zm(t,e,n,r,i,s){Bb(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return i&&k_(e,n,!1),li(t,e,s);r=e.stateNode,cN.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ia(e,t.child,null,s),e.child=Ia(e,null,a,s)):Jt(t,e,a,s),e.memoizedState=r.state,i&&k_(e,n,!0),e.child}function Hb(t){var e=t.stateNode;e.pendingContext?A_(t,e.pendingContext,e.pendingContext!==e.context):e.context&&A_(t,e.context,!1),v0(t,e.containerInfo)}function q_(t,e,n,r,i){return ba(),h0(i),e.flags|=256,Jt(t,e,n,r),e.child}var Lm={dehydrated:null,treeContext:null,retryLane:0};function Mm(t){return{baseLanes:t,cachePool:null,transitions:null}}function qb(t,e,n){var r=e.pendingProps,i=it.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(i&2)!==0),a?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(i|=1),We(it,i&1),t===null)return Rm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,s?(r=e.mode,s=e.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=cf(o,r,0,null),t=qs(t,r,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=Mm(n),e.memoizedState=Lm,t):S0(e,o));if(i=t.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return uN(t,e,o,r,a,i,n);if(s){s=r.fallback,o=e.mode,i=t.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Xi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?s=Xi(a,s):(s=qs(s,o,n,null),s.flags|=2),s.return=e,r.return=e,r.sibling=s,e.child=r,r=s,s=e.child,o=t.child.memoizedState,o=o===null?Mm(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=t.childLanes&~n,e.memoizedState=Lm,r}return s=t.child,t=s.sibling,r=Xi(s,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function S0(t,e){return e=cf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Wu(t,e,n,r){return r!==null&&h0(r),Ia(e,t.child,null,n),t=S0(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function uN(t,e,n,r,i,s,o){if(n)return e.flags&256?(e.flags&=-257,r=_p(Error(Z(422))),Wu(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=r.fallback,i=e.mode,r=cf({mode:"visible",children:r.children},i,0,null),s=qs(s,i,o,null),s.flags|=2,r.return=e,s.return=e,r.sibling=s,e.child=r,e.mode&1&&Ia(e,t.child,null,o),e.child.memoizedState=Mm(o),e.memoizedState=Lm,s);if(!(e.mode&1))return Wu(t,e,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,s=Error(Z(419)),r=_p(s,r,void 0),Wu(t,e,o,r)}if(a=(o&t.childLanes)!==0,dn||a){if(r=Nt,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,ai(t,i),dr(r,t,i,-1))}return P0(),r=_p(Error(Z(421))),Wu(t,e,o,r)}return i.data==="$?"?(e.flags|=128,e.child=t.child,e=bN.bind(null,t),i._reactRetry=e,null):(t=s.treeContext,kn=Gi(i.nextSibling),Nn=e,rt=!0,ar=null,t!==null&&(Bn[Hn++]=Qr,Bn[Hn++]=Yr,Bn[Hn++]=Xs,Qr=t.id,Yr=t.overflow,Xs=e),e=S0(e,r.children),e.flags|=4096,e)}function K_(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Nm(t.return,e,n)}function wp(t,e,n,r,i){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Kb(t,e,n){var r=e.pendingProps,i=r.revealOrder,s=r.tail;if(Jt(t,e,r.children,n),r=it.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&K_(t,n,e);else if(t.tag===19)K_(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(We(it,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(n=e.child,i=null;n!==null;)t=n.alternate,t!==null&&ch(t)===null&&(i=n),n=n.sibling;n=i,n===null?(i=e.child,e.child=null):(i=n.sibling,n.sibling=null),wp(e,!1,i,n,s);break;case"backwards":for(n=null,i=e.child,e.child=null;i!==null;){if(t=i.alternate,t!==null&&ch(t)===null){e.child=i;break}t=i.sibling,i.sibling=n,n=i,i=t}wp(e,!0,n,null,s);break;case"together":wp(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Sd(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function li(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Zs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Z(153));if(e.child!==null){for(t=e.child,n=Xi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Xi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function dN(t,e,n){switch(e.tag){case 3:Hb(e),ba();break;case 5:vb(e);break;case 1:gn(e.type)&&rh(e);break;case 4:v0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;We(oh,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(We(it,it.current&1),e.flags|=128,null):n&e.child.childLanes?qb(t,e,n):(We(it,it.current&1),t=li(t,e,n),t!==null?t.sibling:null);We(it,it.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return Kb(t,e,n);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),We(it,it.current),r)break;return null;case 22:case 23:return e.lanes=0,Ub(t,e,n)}return li(t,e,n)}var Gb,jm,Wb,Qb;Gb=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jm=function(){};Wb=function(t,e,n,r){var i=t.memoizedProps;if(i!==r){t=e.stateNode,js(Rr.current);var s=null;switch(n){case"input":i=am(t,i),r=am(t,r),s=[];break;case"select":i=lt({},i,{value:void 0}),r=lt({},r,{value:void 0}),s=[];break;case"textarea":i=um(t,i),r=um(t,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=th)}hm(n,r);var o;n=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(yc.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(yc.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ze("scroll",t),s||a===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};Qb=function(t,e,n,r){n!==r&&(e.flags|=4)};function Al(t,e){if(!rt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ht(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=t,i=i.sibling;else for(i=t.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=t,i=i.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function hN(t,e,n){var r=e.pendingProps;switch(d0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(e),null;case 1:return gn(e.type)&&nh(),Ht(e),null;case 3:return r=e.stateNode,Ta(),et(mn),et(Wt),w0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ku(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ar!==null&&(Gm(ar),ar=null))),jm(t,e),Ht(e),null;case 5:_0(e);var i=js(kc.current);if(n=e.type,t!==null&&e.stateNode!=null)Wb(t,e,n,r,i),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Z(166));return Ht(e),null}if(t=js(Rr.current),Ku(e)){r=e.stateNode,n=e.type;var s=e.memoizedProps;switch(r[Sr]=e,r[Cc]=s,t=(e.mode&1)!==0,n){case"dialog":Ze("cancel",r),Ze("close",r);break;case"iframe":case"object":case"embed":Ze("load",r);break;case"video":case"audio":for(i=0;i<Bl.length;i++)Ze(Bl[i],r);break;case"source":Ze("error",r);break;case"img":case"image":case"link":Ze("error",r),Ze("load",r);break;case"details":Ze("toggle",r);break;case"input":t_(r,s),Ze("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ze("invalid",r);break;case"textarea":r_(r,s),Ze("invalid",r)}hm(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?r.textContent!==a&&(s.suppressHydrationWarning!==!0&&qu(r.textContent,a,t),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&qu(r.textContent,a,t),i=["children",""+a]):yc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ze("scroll",r)}switch(n){case"input":Lu(r),n_(r,s,!0);break;case"textarea":Lu(r),i_(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=th)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=bE(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[Sr]=e,t[Cc]=r,Gb(t,e,!1,!1),e.stateNode=t;e:{switch(o=fm(n,r),n){case"dialog":Ze("cancel",t),Ze("close",t),i=r;break;case"iframe":case"object":case"embed":Ze("load",t),i=r;break;case"video":case"audio":for(i=0;i<Bl.length;i++)Ze(Bl[i],t);i=r;break;case"source":Ze("error",t),i=r;break;case"img":case"image":case"link":Ze("error",t),Ze("load",t),i=r;break;case"details":Ze("toggle",t),i=r;break;case"input":t_(t,r),i=am(t,r),Ze("invalid",t);break;case"option":i=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},i=lt({},r,{value:void 0}),Ze("invalid",t);break;case"textarea":r_(t,r),i=um(t,r),Ze("invalid",t);break;default:i=r}hm(n,i),a=i;for(s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="style"?SE(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&IE(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&vc(t,l):typeof l=="number"&&vc(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(yc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ze("scroll",t):l!=null&&Yg(t,s,l,o))}switch(n){case"input":Lu(t),n_(t,r,!1);break;case"textarea":Lu(t),i_(t);break;case"option":r.value!=null&&t.setAttribute("value",""+is(r.value));break;case"select":t.multiple=!!r.multiple,s=r.value,s!=null?aa(t,!!r.multiple,s,!1):r.defaultValue!=null&&aa(t,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(t.onclick=th)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ht(e),null;case 6:if(t&&e.stateNode!=null)Qb(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Z(166));if(n=js(kc.current),js(Rr.current),Ku(e)){if(r=e.stateNode,n=e.memoizedProps,r[Sr]=e,(s=r.nodeValue!==n)&&(t=Nn,t!==null))switch(t.tag){case 3:qu(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&qu(r.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Sr]=e,e.stateNode=r}return Ht(e),null;case 13:if(et(it),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(rt&&kn!==null&&e.mode&1&&!(e.flags&128))fb(),ba(),e.flags|=98560,s=!1;else if(s=Ku(e),r!==null&&r.dehydrated!==null){if(t===null){if(!s)throw Error(Z(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(Z(317));s[Sr]=e}else ba(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ht(e),s=!1}else ar!==null&&(Gm(ar),ar=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||it.current&1?bt===0&&(bt=3):P0())),e.updateQueue!==null&&(e.flags|=4),Ht(e),null);case 4:return Ta(),jm(t,e),t===null&&Tc(e.stateNode.containerInfo),Ht(e),null;case 10:return m0(e.type._context),Ht(e),null;case 17:return gn(e.type)&&nh(),Ht(e),null;case 19:if(et(it),s=e.memoizedState,s===null)return Ht(e),null;if(r=(e.flags&128)!==0,o=s.rendering,o===null)if(r)Al(s,!1);else{if(bt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=ch(t),o!==null){for(e.flags|=128,Al(s,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)s=n,t=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,t=o.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return We(it,it.current&1|2),e.child}t=t.sibling}s.tail!==null&&ft()>Ca&&(e.flags|=128,r=!0,Al(s,!1),e.lanes=4194304)}else{if(!r)if(t=ch(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Al(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!rt)return Ht(e),null}else 2*ft()-s.renderingStartTime>Ca&&n!==1073741824&&(e.flags|=128,r=!0,Al(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(n=s.last,n!==null?n.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=ft(),e.sibling=null,n=it.current,We(it,r?n&1|2:n&1),e):(Ht(e),null);case 22:case 23:return N0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Sn&1073741824&&(Ht(e),e.subtreeFlags&6&&(e.flags|=8192)):Ht(e),null;case 24:return null;case 25:return null}throw Error(Z(156,e.tag))}function fN(t,e){switch(d0(e),e.tag){case 1:return gn(e.type)&&nh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Ta(),et(mn),et(Wt),w0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return _0(e),null;case 13:if(et(it),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Z(340));ba()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return et(it),null;case 4:return Ta(),null;case 10:return m0(e.type._context),null;case 22:case 23:return N0(),null;case 24:return null;default:return null}}var Qu=!1,Gt=!1,pN=typeof WeakSet=="function"?WeakSet:Set,le=null;function ia(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){ut(t,e,r)}else n.current=null}function Fm(t,e,n){try{n()}catch(r){ut(t,e,r)}}var G_=!1;function mN(t,e){if(bm=Jd,t=eb(),c0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(a=o+i),h!==s||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++c===i&&(a=o),f===s&&++d===r&&(l=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Im={focusedElem:t,selectionRange:n},Jd=!1,le=e;le!==null;)if(e=le,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,le=t;else for(;le!==null;){e=le;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var x=b.memoizedProps,R=b.memoizedState,y=e.stateNode,v=y.getSnapshotBeforeUpdate(e.elementType===e.type?x:ir(e.type,x),R);y.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Z(163))}}catch(A){ut(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,le=t;break}le=e.return}return b=G_,G_=!1,b}function oc(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&t)===t){var s=i.destroy;i.destroy=void 0,s!==void 0&&Fm(e,n,s)}i=i.next}while(i!==r)}}function af(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function $m(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function Yb(t){var e=t.alternate;e!==null&&(t.alternate=null,Yb(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Sr],delete e[Cc],delete e[Cm],delete e[XR],delete e[JR])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Xb(t){return t.tag===5||t.tag===3||t.tag===4}function W_(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Xb(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Um(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=th));else if(r!==4&&(t=t.child,t!==null))for(Um(t,e,n),t=t.sibling;t!==null;)Um(t,e,n),t=t.sibling}function Bm(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Bm(t,e,n),t=t.sibling;t!==null;)Bm(t,e,n),t=t.sibling}var Lt=null,sr=!1;function Ti(t,e,n){for(n=n.child;n!==null;)Jb(t,e,n),n=n.sibling}function Jb(t,e,n){if(kr&&typeof kr.onCommitFiberUnmount=="function")try{kr.onCommitFiberUnmount(Jh,n)}catch{}switch(n.tag){case 5:Gt||ia(n,e);case 6:var r=Lt,i=sr;Lt=null,Ti(t,e,n),Lt=r,sr=i,Lt!==null&&(sr?(t=Lt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Lt.removeChild(n.stateNode));break;case 18:Lt!==null&&(sr?(t=Lt,n=n.stateNode,t.nodeType===8?fp(t.parentNode,n):t.nodeType===1&&fp(t,n),Ec(t)):fp(Lt,n.stateNode));break;case 4:r=Lt,i=sr,Lt=n.stateNode.containerInfo,sr=!0,Ti(t,e,n),Lt=r,sr=i;break;case 0:case 11:case 14:case 15:if(!Gt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Fm(n,e,o),i=i.next}while(i!==r)}Ti(t,e,n);break;case 1:if(!Gt&&(ia(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){ut(n,e,a)}Ti(t,e,n);break;case 21:Ti(t,e,n);break;case 22:n.mode&1?(Gt=(r=Gt)||n.memoizedState!==null,Ti(t,e,n),Gt=r):Ti(t,e,n);break;default:Ti(t,e,n)}}function Q_(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new pN),e.forEach(function(r){var i=IN.bind(null,t,r);n.has(r)||(n.add(r),r.then(i,i))})}}function rr(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Lt=a.stateNode,sr=!1;break e;case 3:Lt=a.stateNode.containerInfo,sr=!0;break e;case 4:Lt=a.stateNode.containerInfo,sr=!0;break e}a=a.return}if(Lt===null)throw Error(Z(160));Jb(s,o,i),Lt=null,sr=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){ut(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)Zb(e,t),e=e.sibling}function Zb(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(rr(e,t),Ir(t),r&4){try{oc(3,t,t.return),af(3,t)}catch(x){ut(t,t.return,x)}try{oc(5,t,t.return)}catch(x){ut(t,t.return,x)}}break;case 1:rr(e,t),Ir(t),r&512&&n!==null&&ia(n,n.return);break;case 5:if(rr(e,t),Ir(t),r&512&&n!==null&&ia(n,n.return),t.flags&32){var i=t.stateNode;try{vc(i,"")}catch(x){ut(t,t.return,x)}}if(r&4&&(i=t.stateNode,i!=null)){var s=t.memoizedProps,o=n!==null?n.memoizedProps:s,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&xE(i,s),fm(a,o);var c=fm(a,s);for(o=0;o<l.length;o+=2){var d=l[o],h=l[o+1];d==="style"?SE(i,h):d==="dangerouslySetInnerHTML"?IE(i,h):d==="children"?vc(i,h):Yg(i,d,h,c)}switch(a){case"input":lm(i,s);break;case"textarea":EE(i,s);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?aa(i,!!s.multiple,m,!1):f!==!!s.multiple&&(s.defaultValue!=null?aa(i,!!s.multiple,s.defaultValue,!0):aa(i,!!s.multiple,s.multiple?[]:"",!1))}i[Cc]=s}catch(x){ut(t,t.return,x)}}break;case 6:if(rr(e,t),Ir(t),r&4){if(t.stateNode===null)throw Error(Z(162));i=t.stateNode,s=t.memoizedProps;try{i.nodeValue=s}catch(x){ut(t,t.return,x)}}break;case 3:if(rr(e,t),Ir(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ec(e.containerInfo)}catch(x){ut(t,t.return,x)}break;case 4:rr(e,t),Ir(t);break;case 13:rr(e,t),Ir(t),i=t.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(k0=ft())),r&4&&Q_(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Gt=(c=Gt)||d,rr(e,t),Gt=c):rr(e,t),Ir(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(le=t,d=t.child;d!==null;){for(h=le=d;le!==null;){switch(f=le,m=f.child,f.tag){case 0:case 11:case 14:case 15:oc(4,f,f.return);break;case 1:ia(f,f.return);var b=f.stateNode;if(typeof b.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(x){ut(r,n,x)}}break;case 5:ia(f,f.return);break;case 22:if(f.memoizedState!==null){X_(h);continue}}m!==null?(m.return=f,le=m):X_(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{i=h.stateNode,c?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=TE("display",o))}catch(x){ut(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(x){ut(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:rr(e,t),Ir(t),r&4&&Q_(t);break;case 21:break;default:rr(e,t),Ir(t)}}function Ir(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(Xb(n)){var r=n;break e}n=n.return}throw Error(Z(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(vc(i,""),r.flags&=-33);var s=W_(t);Bm(t,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,a=W_(t);Um(t,a,o);break;default:throw Error(Z(161))}}catch(l){ut(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function gN(t,e,n){le=t,eI(t)}function eI(t,e,n){for(var r=(t.mode&1)!==0;le!==null;){var i=le,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||Qu;if(!o){var a=i.alternate,l=a!==null&&a.memoizedState!==null||Gt;a=Qu;var c=Gt;if(Qu=o,(Gt=l)&&!c)for(le=i;le!==null;)o=le,l=o.child,o.tag===22&&o.memoizedState!==null?J_(i):l!==null?(l.return=o,le=l):J_(i);for(;s!==null;)le=s,eI(s),s=s.sibling;le=i,Qu=a,Gt=c}Y_(t)}else i.subtreeFlags&8772&&s!==null?(s.return=i,le=s):Y_(t)}}function Y_(t){for(;le!==null;){var e=le;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Gt||af(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Gt)if(n===null)r.componentDidMount();else{var i=e.elementType===e.type?n.memoizedProps:ir(e.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&V_(e,s,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}V_(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Ec(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Z(163))}Gt||e.flags&512&&$m(e)}catch(f){ut(e,e.return,f)}}if(e===t){le=null;break}if(n=e.sibling,n!==null){n.return=e.return,le=n;break}le=e.return}}function X_(t){for(;le!==null;){var e=le;if(e===t){le=null;break}var n=e.sibling;if(n!==null){n.return=e.return,le=n;break}le=e.return}}function J_(t){for(;le!==null;){var e=le;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{af(4,e)}catch(l){ut(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){ut(e,i,l)}}var s=e.return;try{$m(e)}catch(l){ut(e,s,l)}break;case 5:var o=e.return;try{$m(e)}catch(l){ut(e,o,l)}}}catch(l){ut(e,e.return,l)}if(e===t){le=null;break}var a=e.sibling;if(a!==null){a.return=e.return,le=a;break}le=e.return}}var yN=Math.ceil,hh=pi.ReactCurrentDispatcher,C0=pi.ReactCurrentOwner,Wn=pi.ReactCurrentBatchConfig,De=0,Nt=null,_t=null,jt=0,Sn=0,sa=ds(0),bt=0,Dc=null,Zs=0,lf=0,A0=0,ac=null,cn=null,k0=0,Ca=1/0,Kr=null,fh=!1,Hm=null,Qi=null,Yu=!1,Ui=null,ph=0,lc=0,qm=null,Cd=-1,Ad=0;function Zt(){return De&6?ft():Cd!==-1?Cd:Cd=ft()}function Yi(t){return t.mode&1?De&2&&jt!==0?jt&-jt:eN.transition!==null?(Ad===0&&(Ad=ME()),Ad):(t=$e,t!==0||(t=window.event,t=t===void 0?16:qE(t.type)),t):1}function dr(t,e,n,r){if(50<lc)throw lc=0,qm=null,Error(Z(185));iu(t,n,r),(!(De&2)||t!==Nt)&&(t===Nt&&(!(De&2)&&(lf|=n),bt===4&&Oi(t,jt)),yn(t,r),n===1&&De===0&&!(e.mode&1)&&(Ca=ft()+500,rf&&hs()))}function yn(t,e){var n=t.callbackNode;eR(t,e);var r=Xd(t,t===Nt?jt:0);if(r===0)n!==null&&a_(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&a_(n),e===1)t.tag===0?ZR(Z_.bind(null,t)):ub(Z_.bind(null,t)),QR(function(){!(De&6)&&hs()}),n=null;else{switch(jE(r)){case 1:n=t0;break;case 4:n=zE;break;case 16:n=Yd;break;case 536870912:n=LE;break;default:n=Yd}n=lI(n,tI.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function tI(t,e){if(Cd=-1,Ad=0,De&6)throw Error(Z(327));var n=t.callbackNode;if(ha()&&t.callbackNode!==n)return null;var r=Xd(t,t===Nt?jt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=mh(t,r);else{e=r;var i=De;De|=2;var s=rI();(Nt!==t||jt!==e)&&(Kr=null,Ca=ft()+500,Hs(t,e));do try{wN();break}catch(a){nI(t,a)}while(!0);p0(),hh.current=s,De=i,_t!==null?e=0:(Nt=null,jt=0,e=bt)}if(e!==0){if(e===2&&(i=vm(t),i!==0&&(r=i,e=Km(t,i))),e===1)throw n=Dc,Hs(t,0),Oi(t,r),yn(t,ft()),n;if(e===6)Oi(t,r);else{if(i=t.current.alternate,!(r&30)&&!vN(i)&&(e=mh(t,r),e===2&&(s=vm(t),s!==0&&(r=s,e=Km(t,s))),e===1))throw n=Dc,Hs(t,0),Oi(t,r),yn(t,ft()),n;switch(t.finishedWork=i,t.finishedLanes=r,e){case 0:case 1:throw Error(Z(345));case 2:ks(t,cn,Kr);break;case 3:if(Oi(t,r),(r&130023424)===r&&(e=k0+500-ft(),10<e)){if(Xd(t,0)!==0)break;if(i=t.suspendedLanes,(i&r)!==r){Zt(),t.pingedLanes|=t.suspendedLanes&i;break}t.timeoutHandle=Sm(ks.bind(null,t,cn,Kr),e);break}ks(t,cn,Kr);break;case 4:if(Oi(t,r),(r&4194240)===r)break;for(e=t.eventTimes,i=-1;0<r;){var o=31-ur(r);s=1<<o,o=e[o],o>i&&(i=o),r&=~s}if(r=i,r=ft()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*yN(r/1960))-r,10<r){t.timeoutHandle=Sm(ks.bind(null,t,cn,Kr),r);break}ks(t,cn,Kr);break;case 5:ks(t,cn,Kr);break;default:throw Error(Z(329))}}}return yn(t,ft()),t.callbackNode===n?tI.bind(null,t):null}function Km(t,e){var n=ac;return t.current.memoizedState.isDehydrated&&(Hs(t,e).flags|=256),t=mh(t,e),t!==2&&(e=cn,cn=n,e!==null&&Gm(e)),t}function Gm(t){cn===null?cn=t:cn.push.apply(cn,t)}function vN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!pr(s(),i))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oi(t,e){for(e&=~A0,e&=~lf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-ur(e),r=1<<n;t[n]=-1,e&=~r}}function Z_(t){if(De&6)throw Error(Z(327));ha();var e=Xd(t,0);if(!(e&1))return yn(t,ft()),null;var n=mh(t,e);if(t.tag!==0&&n===2){var r=vm(t);r!==0&&(e=r,n=Km(t,r))}if(n===1)throw n=Dc,Hs(t,0),Oi(t,e),yn(t,ft()),n;if(n===6)throw Error(Z(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ks(t,cn,Kr),yn(t,ft()),null}function R0(t,e){var n=De;De|=1;try{return t(e)}finally{De=n,De===0&&(Ca=ft()+500,rf&&hs())}}function eo(t){Ui!==null&&Ui.tag===0&&!(De&6)&&ha();var e=De;De|=1;var n=Wn.transition,r=$e;try{if(Wn.transition=null,$e=1,t)return t()}finally{$e=r,Wn.transition=n,De=e,!(De&6)&&hs()}}function N0(){Sn=sa.current,et(sa)}function Hs(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,WR(n)),_t!==null)for(n=_t.return;n!==null;){var r=n;switch(d0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&nh();break;case 3:Ta(),et(mn),et(Wt),w0();break;case 5:_0(r);break;case 4:Ta();break;case 13:et(it);break;case 19:et(it);break;case 10:m0(r.type._context);break;case 22:case 23:N0()}n=n.return}if(Nt=t,_t=t=Xi(t.current,null),jt=Sn=e,bt=0,Dc=null,A0=lf=Zs=0,cn=ac=null,Ms!==null){for(e=0;e<Ms.length;e++)if(n=Ms[e],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ms=null}return t}function nI(t,e){do{var n=_t;try{if(p0(),Id.current=dh,uh){for(var r=ot.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}uh=!1}if(Js=0,Rt=Et=ot=null,sc=!1,Rc=0,C0.current=null,n===null||n.return===null){bt=1,Dc=e,_t=null;break}e:{var s=t,o=n.return,a=n,l=e;if(e=jt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=F_(o);if(m!==null){m.flags&=-257,$_(m,o,a,s,e),m.mode&1&&j_(s,c,e),e=m,l=c;var b=e.updateQueue;if(b===null){var x=new Set;x.add(l),e.updateQueue=x}else b.add(l);break e}else{if(!(e&1)){j_(s,c,e),P0();break e}l=Error(Z(426))}}else if(rt&&a.mode&1){var R=F_(o);if(R!==null){!(R.flags&65536)&&(R.flags|=256),$_(R,o,a,s,e),h0(Sa(l,a));break e}}s=l=Sa(l,a),bt!==4&&(bt=2),ac===null?ac=[s]:ac.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var y=jb(s,l,e);D_(s,y);break e;case 1:a=l;var v=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof v.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Qi===null||!Qi.has(T)))){s.flags|=65536,e&=-e,s.lanes|=e;var A=Fb(s,a,e);D_(s,A);break e}}s=s.return}while(s!==null)}sI(n)}catch(O){e=O,_t===n&&n!==null&&(_t=n=n.return);continue}break}while(!0)}function rI(){var t=hh.current;return hh.current=dh,t===null?dh:t}function P0(){(bt===0||bt===3||bt===2)&&(bt=4),Nt===null||!(Zs&268435455)&&!(lf&268435455)||Oi(Nt,jt)}function mh(t,e){var n=De;De|=2;var r=rI();(Nt!==t||jt!==e)&&(Kr=null,Hs(t,e));do try{_N();break}catch(i){nI(t,i)}while(!0);if(p0(),De=n,hh.current=r,_t!==null)throw Error(Z(261));return Nt=null,jt=0,bt}function _N(){for(;_t!==null;)iI(_t)}function wN(){for(;_t!==null&&!qk();)iI(_t)}function iI(t){var e=aI(t.alternate,t,Sn);t.memoizedProps=t.pendingProps,e===null?sI(t):_t=e,C0.current=null}function sI(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=fN(n,e),n!==null){n.flags&=32767,_t=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{bt=6,_t=null;return}}else if(n=hN(n,e,Sn),n!==null){_t=n;return}if(e=e.sibling,e!==null){_t=e;return}_t=e=t}while(e!==null);bt===0&&(bt=5)}function ks(t,e,n){var r=$e,i=Wn.transition;try{Wn.transition=null,$e=1,xN(t,e,n,r)}finally{Wn.transition=i,$e=r}return null}function xN(t,e,n,r){do ha();while(Ui!==null);if(De&6)throw Error(Z(327));n=t.finishedWork;var i=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Z(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(tR(t,s),t===Nt&&(_t=Nt=null,jt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Yu||(Yu=!0,lI(Yd,function(){return ha(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Wn.transition,Wn.transition=null;var o=$e;$e=1;var a=De;De|=4,C0.current=null,mN(t,n),Zb(n,t),$R(Im),Jd=!!bm,Im=bm=null,t.current=n,gN(n),Kk(),De=a,$e=o,Wn.transition=s}else t.current=n;if(Yu&&(Yu=!1,Ui=t,ph=i),s=t.pendingLanes,s===0&&(Qi=null),Qk(n.stateNode),yn(t,ft()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)i=e[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(fh)throw fh=!1,t=Hm,Hm=null,t;return ph&1&&t.tag!==0&&ha(),s=t.pendingLanes,s&1?t===qm?lc++:(lc=0,qm=t):lc=0,hs(),null}function ha(){if(Ui!==null){var t=jE(ph),e=Wn.transition,n=$e;try{if(Wn.transition=null,$e=16>t?16:t,Ui===null)var r=!1;else{if(t=Ui,Ui=null,ph=0,De&6)throw Error(Z(331));var i=De;for(De|=4,le=t.current;le!==null;){var s=le,o=s.child;if(le.flags&16){var a=s.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(le=c;le!==null;){var d=le;switch(d.tag){case 0:case 11:case 15:oc(8,d,s)}var h=d.child;if(h!==null)h.return=d,le=h;else for(;le!==null;){d=le;var f=d.sibling,m=d.return;if(Yb(d),d===c){le=null;break}if(f!==null){f.return=m,le=f;break}le=m}}}var b=s.alternate;if(b!==null){var x=b.child;if(x!==null){b.child=null;do{var R=x.sibling;x.sibling=null,x=R}while(x!==null)}}le=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,le=o;else e:for(;le!==null;){if(s=le,s.flags&2048)switch(s.tag){case 0:case 11:case 15:oc(9,s,s.return)}var y=s.sibling;if(y!==null){y.return=s.return,le=y;break e}le=s.return}}var v=t.current;for(le=v;le!==null;){o=le;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,le=T;else e:for(o=v;le!==null;){if(a=le,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:af(9,a)}}catch(O){ut(a,a.return,O)}if(a===o){le=null;break e}var A=a.sibling;if(A!==null){A.return=a.return,le=A;break e}le=a.return}}if(De=i,hs(),kr&&typeof kr.onPostCommitFiberRoot=="function")try{kr.onPostCommitFiberRoot(Jh,t)}catch{}r=!0}return r}finally{$e=n,Wn.transition=e}}return!1}function ew(t,e,n){e=Sa(n,e),e=jb(t,e,1),t=Wi(t,e,1),e=Zt(),t!==null&&(iu(t,1,e),yn(t,e))}function ut(t,e,n){if(t.tag===3)ew(t,t,n);else for(;e!==null;){if(e.tag===3){ew(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Qi===null||!Qi.has(r))){t=Sa(n,t),t=Fb(e,t,1),e=Wi(e,t,1),t=Zt(),e!==null&&(iu(e,1,t),yn(e,t));break}}e=e.return}}function EN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Zt(),t.pingedLanes|=t.suspendedLanes&n,Nt===t&&(jt&n)===n&&(bt===4||bt===3&&(jt&130023424)===jt&&500>ft()-k0?Hs(t,0):A0|=n),yn(t,e)}function oI(t,e){e===0&&(t.mode&1?(e=Fu,Fu<<=1,!(Fu&130023424)&&(Fu=4194304)):e=1);var n=Zt();t=ai(t,e),t!==null&&(iu(t,e,n),yn(t,n))}function bN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),oI(t,n)}function IN(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,i=t.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Z(314))}r!==null&&r.delete(e),oI(t,n)}var aI;aI=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mn.current)dn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return dn=!1,dN(t,e,n);dn=!!(t.flags&131072)}else dn=!1,rt&&e.flags&1048576&&db(e,sh,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Sd(t,e),t=e.pendingProps;var i=Ea(e,Wt.current);da(e,n),i=E0(null,e,r,t,i,n);var s=b0();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,gn(r)?(s=!0,rh(e)):s=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,y0(e),i.updater=of,e.stateNode=i,i._reactInternals=e,Dm(e,r,t,n),e=zm(null,e,r,!0,s,n)):(e.tag=0,rt&&s&&u0(e),Jt(null,e,i,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Sd(t,e),t=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=SN(r),t=ir(r,t),i){case 0:e=Om(null,e,r,t,n);break e;case 1:e=H_(null,e,r,t,n);break e;case 11:e=U_(null,e,r,t,n);break e;case 14:e=B_(null,e,r,ir(r.type,t),n);break e}throw Error(Z(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),Om(t,e,r,i,n);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),H_(t,e,r,i,n);case 3:e:{if(Hb(e),t===null)throw Error(Z(387));r=e.pendingProps,s=e.memoizedState,i=s.element,yb(t,e),lh(e,r,null,n);var o=e.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){i=Sa(Error(Z(423)),e),e=q_(t,e,r,n,i);break e}else if(r!==i){i=Sa(Error(Z(424)),e),e=q_(t,e,r,n,i);break e}else for(kn=Gi(e.stateNode.containerInfo.firstChild),Nn=e,rt=!0,ar=null,n=mb(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ba(),r===i){e=li(t,e,n);break e}Jt(t,e,r,n)}e=e.child}return e;case 5:return vb(e),t===null&&Rm(e),r=e.type,i=e.pendingProps,s=t!==null?t.memoizedProps:null,o=i.children,Tm(r,i)?o=null:s!==null&&Tm(r,s)&&(e.flags|=32),Bb(t,e),Jt(t,e,o,n),e.child;case 6:return t===null&&Rm(e),null;case 13:return qb(t,e,n);case 4:return v0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ia(e,null,r,n):Jt(t,e,r,n),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),U_(t,e,r,i,n);case 7:return Jt(t,e,e.pendingProps,n),e.child;case 8:return Jt(t,e,e.pendingProps.children,n),e.child;case 12:return Jt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,s=e.memoizedProps,o=i.value,We(oh,r._currentValue),r._currentValue=o,s!==null)if(pr(s.value,o)){if(s.children===i.children&&!mn.current){e=li(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=ni(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),Nm(s.return,n,e),a.lanes|=n;break}l=l.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(Z(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),Nm(o,n,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Jt(t,e,i.children,n),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,da(e,n),i=Yn(i),r=r(i),e.flags|=1,Jt(t,e,r,n),e.child;case 14:return r=e.type,i=ir(r,e.pendingProps),i=ir(r.type,i),B_(t,e,r,i,n);case 15:return $b(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:ir(r,i),Sd(t,e),e.tag=1,gn(r)?(t=!0,rh(e)):t=!1,da(e,n),Mb(e,r,i),Dm(e,r,i,n),zm(null,e,r,!0,t,n);case 19:return Kb(t,e,n);case 22:return Ub(t,e,n)}throw Error(Z(156,e.tag))};function lI(t,e){return OE(t,e)}function TN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function qn(t,e,n,r){return new TN(t,e,n,r)}function D0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function SN(t){if(typeof t=="function")return D0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Jg)return 11;if(t===Zg)return 14}return 2}function Xi(t,e){var n=t.alternate;return n===null?(n=qn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function kd(t,e,n,r,i,s){var o=2;if(r=t,typeof t=="function")D0(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Qo:return qs(n.children,i,s,e);case Xg:o=8,i|=8;break;case rm:return t=qn(12,n,e,i|2),t.elementType=rm,t.lanes=s,t;case im:return t=qn(13,n,e,i),t.elementType=im,t.lanes=s,t;case sm:return t=qn(19,n,e,i),t.elementType=sm,t.lanes=s,t;case vE:return cf(n,i,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case gE:o=10;break e;case yE:o=9;break e;case Jg:o=11;break e;case Zg:o=14;break e;case Ri:o=16,r=null;break e}throw Error(Z(130,t==null?t:typeof t,""))}return e=qn(o,n,e,i),e.elementType=t,e.type=r,e.lanes=s,e}function qs(t,e,n,r){return t=qn(7,t,r,e),t.lanes=n,t}function cf(t,e,n,r){return t=qn(22,t,r,e),t.elementType=vE,t.lanes=n,t.stateNode={isHidden:!1},t}function xp(t,e,n){return t=qn(6,t,null,e),t.lanes=n,t}function Ep(t,e,n){return e=qn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function CN(t,e,n,r,i){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=np(0),this.expirationTimes=np(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=np(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function V0(t,e,n,r,i,s,o,a,l){return t=new CN(t,e,n,a,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=qn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},y0(s),t}function AN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wo,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function cI(t){if(!t)return ss;t=t._reactInternals;e:{if(yo(t)!==t||t.tag!==1)throw Error(Z(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(gn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Z(171))}if(t.tag===1){var n=t.type;if(gn(n))return cb(t,n,e)}return e}function uI(t,e,n,r,i,s,o,a,l){return t=V0(n,r,!0,t,i,s,o,a,l),t.context=cI(null),n=t.current,r=Zt(),i=Yi(n),s=ni(r,i),s.callback=e??null,Wi(n,s,i),t.current.lanes=i,iu(t,i,r),yn(t,r),t}function uf(t,e,n,r){var i=e.current,s=Zt(),o=Yi(i);return n=cI(n),e.context===null?e.context=n:e.pendingContext=n,e=ni(s,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=Wi(i,e,o),t!==null&&(dr(t,i,o,s),bd(t,i,o)),o}function gh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function tw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function O0(t,e){tw(t,e),(t=t.alternate)&&tw(t,e)}function kN(){return null}var dI=typeof reportError=="function"?reportError:function(t){console.error(t)};function z0(t){this._internalRoot=t}df.prototype.render=z0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Z(409));uf(t,e,null,null)};df.prototype.unmount=z0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;eo(function(){uf(null,t,null,null)}),e[oi]=null}};function df(t){this._internalRoot=t}df.prototype.unstable_scheduleHydration=function(t){if(t){var e=UE();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Vi.length&&e!==0&&e<Vi[n].priority;n++);Vi.splice(n,0,t),n===0&&HE(t)}};function L0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function hf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function nw(){}function RN(t,e,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var c=gh(o);s.call(c)}}var o=uI(e,r,t,0,null,!1,!1,"",nw);return t._reactRootContainer=o,t[oi]=o.current,Tc(t.nodeType===8?t.parentNode:t),eo(),o}for(;i=t.lastChild;)t.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=gh(l);a.call(c)}}var l=V0(t,0,!1,null,null,!1,!1,"",nw);return t._reactRootContainer=l,t[oi]=l.current,Tc(t.nodeType===8?t.parentNode:t),eo(function(){uf(e,l,n,r)}),l}function ff(t,e,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var a=i;i=function(){var l=gh(o);a.call(l)}}uf(e,o,t,i)}else o=RN(n,e,t,i,r);return gh(o)}FE=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ul(e.pendingLanes);n!==0&&(n0(e,n|1),yn(e,ft()),!(De&6)&&(Ca=ft()+500,hs()))}break;case 13:eo(function(){var r=ai(t,1);if(r!==null){var i=Zt();dr(r,t,1,i)}}),O0(t,1)}};r0=function(t){if(t.tag===13){var e=ai(t,134217728);if(e!==null){var n=Zt();dr(e,t,134217728,n)}O0(t,134217728)}};$E=function(t){if(t.tag===13){var e=Yi(t),n=ai(t,e);if(n!==null){var r=Zt();dr(n,t,e,r)}O0(t,e)}};UE=function(){return $e};BE=function(t,e){var n=$e;try{return $e=t,e()}finally{$e=n}};mm=function(t,e,n){switch(e){case"input":if(lm(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var i=nf(r);if(!i)throw Error(Z(90));wE(r),lm(r,i)}}}break;case"textarea":EE(t,n);break;case"select":e=n.value,e!=null&&aa(t,!!n.multiple,e,!1)}};kE=R0;RE=eo;var NN={usingClientEntryPoint:!1,Events:[ou,Zo,nf,CE,AE,R0]},kl={findFiberByHostInstance:Ls,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},PN={bundleType:kl.bundleType,version:kl.version,rendererPackageName:kl.rendererPackageName,rendererConfig:kl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=DE(t),t===null?null:t.stateNode},findFiberByHostInstance:kl.findFiberByHostInstance||kN,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xu.isDisabled&&Xu.supportsFiber)try{Jh=Xu.inject(PN),kr=Xu}catch{}}Ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=NN;Ln.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L0(e))throw Error(Z(200));return AN(t,e,null,n)};Ln.createRoot=function(t,e){if(!L0(t))throw Error(Z(299));var n=!1,r="",i=dI;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=V0(t,1,!1,null,null,n,!1,r,i),t[oi]=e.current,Tc(t.nodeType===8?t.parentNode:t),new z0(e)};Ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Z(188)):(t=Object.keys(t).join(","),Error(Z(268,t)));return t=DE(e),t=t===null?null:t.stateNode,t};Ln.flushSync=function(t){return eo(t)};Ln.hydrate=function(t,e,n){if(!hf(e))throw Error(Z(200));return ff(null,t,e,!0,n)};Ln.hydrateRoot=function(t,e,n){if(!L0(t))throw Error(Z(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=dI;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=uI(e,null,t,1,n??null,i,!1,s,o),t[oi]=e.current,Tc(t),r)for(t=0;t<r.length;t++)n=r[t],i=n._getVersion,i=i(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,i]:e.mutableSourceEagerHydrationData.push(n,i);return new df(e)};Ln.render=function(t,e,n){if(!hf(e))throw Error(Z(200));return ff(null,t,e,!1,n)};Ln.unmountComponentAtNode=function(t){if(!hf(t))throw Error(Z(40));return t._reactRootContainer?(eo(function(){ff(null,null,t,!1,function(){t._reactRootContainer=null,t[oi]=null})}),!0):!1};Ln.unstable_batchedUpdates=R0;Ln.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!hf(n))throw Error(Z(200));if(t==null||t._reactInternals===void 0)throw Error(Z(38));return ff(t,e,n,!1,r)};Ln.version="18.3.1-next-f1338f8080-20240426";function hI(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(hI)}catch(t){console.error(t)}}hI(),hE.exports=Ln;var Vc=hE.exports,rw=Vc;tm.createRoot=rw.createRoot,tm.hydrateRoot=rw.hydrateRoot;function Vt(t){if(typeof t=="string"||typeof t=="number")return""+t;let e="";if(Array.isArray(t))for(let n=0,r;n<t.length;n++)(r=Vt(t[n]))!==""&&(e+=(e&&" ")+r);else for(let n in t)t[n]&&(e+=(e&&" ")+n);return e}var fI={exports:{}},pI={},mI={exports:{}},gI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Aa=D;function DN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var VN=typeof Object.is=="function"?Object.is:DN,ON=Aa.useState,zN=Aa.useEffect,LN=Aa.useLayoutEffect,MN=Aa.useDebugValue;function jN(t,e){var n=e(),r=ON({inst:{value:n,getSnapshot:e}}),i=r[0].inst,s=r[1];return LN(function(){i.value=n,i.getSnapshot=e,bp(i)&&s({inst:i})},[t,n,e]),zN(function(){return bp(i)&&s({inst:i}),t(function(){bp(i)&&s({inst:i})})},[t]),MN(n),n}function bp(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!VN(t,n)}catch{return!0}}function FN(t,e){return e()}var $N=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?FN:jN;gI.useSyncExternalStore=Aa.useSyncExternalStore!==void 0?Aa.useSyncExternalStore:$N;mI.exports=gI;var UN=mI.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pf=D,BN=UN;function HN(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var qN=typeof Object.is=="function"?Object.is:HN,KN=BN.useSyncExternalStore,GN=pf.useRef,WN=pf.useEffect,QN=pf.useMemo,YN=pf.useDebugValue;pI.useSyncExternalStoreWithSelector=function(t,e,n,r,i){var s=GN(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=QN(function(){function l(m){if(!c){if(c=!0,d=m,m=r(m),i!==void 0&&o.hasValue){var b=o.value;if(i(b,m))return h=b}return h=m}if(b=h,qN(d,m))return b;var x=r(m);return i!==void 0&&i(b,x)?(d=m,b):(d=m,h=x)}var c=!1,d,h,f=n===void 0?null:n;return[function(){return l(e())},f===null?void 0:function(){return l(f())}]},[e,n,r,i]);var a=KN(t,s[0],s[1]);return WN(function(){o.hasValue=!0,o.value=a},[a]),YN(a),a};fI.exports=pI;var XN=fI.exports;const JN=eE(XN),ZN={},iw=t=>{let e;const n=new Set,r=(d,h)=>{const f=typeof d=="function"?d(e):d;if(!Object.is(f,e)){const m=e;e=h??(typeof f!="object"||f===null)?f:Object.assign({},e,f),n.forEach(b=>b(e,m))}},i=()=>e,l={setState:r,getState:i,getInitialState:()=>c,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(ZN?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},c=e=t(r,i,l);return l},eP=t=>t?iw(t):iw,{useDebugValue:tP}=K,{useSyncExternalStoreWithSelector:nP}=JN,rP=t=>t;function yI(t,e=rP,n){const r=nP(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return tP(r),r}const sw=(t,e)=>{const n=eP(t),r=(i,s=e)=>yI(n,i,s);return Object.assign(r,n),r},iP=(t,e)=>t?sw(t,e):sw;function Pt(t,e){if(Object.is(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(const[r,i]of t)if(!Object.is(i,e.get(r)))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(const r of t)if(!e.has(r))return!1;return!0}const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(e,r)||!Object.is(t[r],e[r]))return!1;return!0}var sP={value:()=>{}};function mf(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Rd(n)}function Rd(t){this._=t}function oP(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Rd.prototype=mf.prototype={constructor:Rd,on:function(t,e){var n=this._,r=oP(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=aP(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=ow(n[i],t.name,e);else if(e==null)for(i in n)n[i]=ow(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Rd(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function aP(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function ow(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=sP,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Wm="http://www.w3.org/1999/xhtml";const aw={svg:"http://www.w3.org/2000/svg",xhtml:Wm,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function gf(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),aw.hasOwnProperty(e)?{space:aw[e],local:t}:t}function lP(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Wm&&e.documentElement.namespaceURI===Wm?e.createElement(t):e.createElementNS(n,t)}}function cP(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function vI(t){var e=gf(t);return(e.local?cP:lP)(e)}function uP(){}function M0(t){return t==null?uP:function(){return this.querySelector(t)}}function dP(t){typeof t!="function"&&(t=M0(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),l,c,d=0;d<o;++d)(l=s[d])&&(c=t.call(l,l.__data__,d,s))&&("__data__"in l&&(c.__data__=l.__data__),a[d]=c);return new On(r,this._parents)}function hP(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function fP(){return[]}function _I(t){return t==null?fP:function(){return this.querySelectorAll(t)}}function pP(t){return function(){return hP(t.apply(this,arguments))}}function mP(t){typeof t=="function"?t=pP(t):t=_I(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(r.push(t.call(l,l.__data__,c,o)),i.push(l));return new On(r,i)}function wI(t){return function(){return this.matches(t)}}function xI(t){return function(e){return e.matches(t)}}var gP=Array.prototype.find;function yP(t){return function(){return gP.call(this.children,t)}}function vP(){return this.firstElementChild}function _P(t){return this.select(t==null?vP:yP(typeof t=="function"?t:xI(t)))}var wP=Array.prototype.filter;function xP(){return Array.from(this.children)}function EP(t){return function(){return wP.call(this.children,t)}}function bP(t){return this.selectAll(t==null?xP:EP(typeof t=="function"?t:xI(t)))}function IP(t){typeof t!="function"&&(t=wI(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new On(r,this._parents)}function EI(t){return new Array(t.length)}function TP(){return new On(this._enter||this._groups.map(EI),this._parents)}function yh(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}yh.prototype={constructor:yh,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function SP(t){return function(){return t}}function CP(t,e,n,r,i,s){for(var o=0,a,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new yh(t,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function AP(t,e,n,r,i,s,o){var a,l,c=new Map,d=e.length,h=s.length,f=new Array(d),m;for(a=0;a<d;++a)(l=e[a])&&(f[a]=m=o.call(l,l.__data__,a,e)+"",c.has(m)?i[a]=l:c.set(m,l));for(a=0;a<h;++a)m=o.call(t,s[a],a,s)+"",(l=c.get(m))?(r[a]=l,l.__data__=s[a],c.delete(m)):n[a]=new yh(t,s[a]);for(a=0;a<d;++a)(l=e[a])&&c.get(f[a])===l&&(i[a]=l)}function kP(t){return t.__data__}function RP(t,e){if(!arguments.length)return Array.from(this,kP);var n=e?AP:CP,r=this._parents,i=this._groups;typeof t!="function"&&(t=SP(t));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var d=r[c],h=i[c],f=h.length,m=NP(t.call(d,d&&d.__data__,c,r)),b=m.length,x=a[c]=new Array(b),R=o[c]=new Array(b),y=l[c]=new Array(f);n(d,h,x,R,y,m,e);for(var v=0,T=0,A,O;v<b;++v)if(A=x[v]){for(v>=T&&(T=v+1);!(O=R[T])&&++T<b;);A._next=O||null}}return o=new On(o,r),o._enter=a,o._exit=l,o}function NP(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function PP(){return new On(this._exit||this._groups.map(EI),this._parents)}function DP(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function VP(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var c=n[l],d=r[l],h=c.length,f=a[l]=new Array(h),m,b=0;b<h;++b)(m=c[b]||d[b])&&(f[b]=m);for(;l<i;++l)a[l]=n[l];return new On(a,this._parents)}function OP(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function zP(t){t||(t=LP);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,l=i[s]=new Array(a),c,d=0;d<a;++d)(c=o[d])&&(l[d]=c);l.sort(e)}return new On(i,this._parents).order()}function LP(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function MP(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function jP(){return Array.from(this)}function FP(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function $P(){let t=0;for(const e of this)++t;return t}function UP(){return!this.node()}function BP(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function HP(t){return function(){this.removeAttribute(t)}}function qP(t){return function(){this.removeAttributeNS(t.space,t.local)}}function KP(t,e){return function(){this.setAttribute(t,e)}}function GP(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function WP(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function QP(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function YP(t,e){var n=gf(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?qP:HP:typeof e=="function"?n.local?QP:WP:n.local?GP:KP)(n,e))}function bI(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function XP(t){return function(){this.style.removeProperty(t)}}function JP(t,e,n){return function(){this.style.setProperty(t,e,n)}}function ZP(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function eD(t,e,n){return arguments.length>1?this.each((e==null?XP:typeof e=="function"?ZP:JP)(t,e,n??"")):ka(this.node(),t)}function ka(t,e){return t.style.getPropertyValue(e)||bI(t).getComputedStyle(t,null).getPropertyValue(e)}function tD(t){return function(){delete this[t]}}function nD(t,e){return function(){this[t]=e}}function rD(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function iD(t,e){return arguments.length>1?this.each((e==null?tD:typeof e=="function"?rD:nD)(t,e)):this.node()[t]}function II(t){return t.trim().split(/^|\s+/)}function j0(t){return t.classList||new TI(t)}function TI(t){this._node=t,this._names=II(t.getAttribute("class")||"")}TI.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function SI(t,e){for(var n=j0(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function CI(t,e){for(var n=j0(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function sD(t){return function(){SI(this,t)}}function oD(t){return function(){CI(this,t)}}function aD(t,e){return function(){(e.apply(this,arguments)?SI:CI)(this,t)}}function lD(t,e){var n=II(t+"");if(arguments.length<2){for(var r=j0(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?aD:e?sD:oD)(n,e))}function cD(){this.textContent=""}function uD(t){return function(){this.textContent=t}}function dD(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function hD(t){return arguments.length?this.each(t==null?cD:(typeof t=="function"?dD:uD)(t)):this.node().textContent}function fD(){this.innerHTML=""}function pD(t){return function(){this.innerHTML=t}}function mD(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function gD(t){return arguments.length?this.each(t==null?fD:(typeof t=="function"?mD:pD)(t)):this.node().innerHTML}function yD(){this.nextSibling&&this.parentNode.appendChild(this)}function vD(){return this.each(yD)}function _D(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function wD(){return this.each(_D)}function xD(t){var e=typeof t=="function"?t:vI(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function ED(){return null}function bD(t,e){var n=typeof t=="function"?t:vI(t),r=e==null?ED:typeof e=="function"?e:M0(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function ID(){var t=this.parentNode;t&&t.removeChild(this)}function TD(){return this.each(ID)}function SD(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function CD(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function AD(t){return this.select(t?CD:SD)}function kD(t){return arguments.length?this.property("__data__",t):this.node().__data__}function RD(t){return function(e){t.call(this,e,this.__data__)}}function ND(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function PD(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function DD(t,e,n){return function(){var r=this.__on,i,s=RD(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function VD(t,e,n){var r=ND(t+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,d;l<c;++l)for(i=0,d=a[l];i<s;++i)if((o=r[i]).type===d.type&&o.name===d.name)return d.value}return}for(a=e?DD:PD,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function AI(t,e,n){var r=bI(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function OD(t,e){return function(){return AI(this,t,e)}}function zD(t,e){return function(){return AI(this,t,e.apply(this,arguments))}}function LD(t,e){return this.each((typeof e=="function"?zD:OD)(t,e))}function*MD(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var kI=[null];function On(t,e){this._groups=t,this._parents=e}function lu(){return new On([[document.documentElement]],kI)}function jD(){return this}On.prototype=lu.prototype={constructor:On,select:dP,selectAll:mP,selectChild:_P,selectChildren:bP,filter:IP,data:RP,enter:TP,exit:PP,join:DP,merge:VP,selection:jD,order:OP,sort:zP,call:MP,nodes:jP,node:FP,size:$P,empty:UP,each:BP,attr:YP,style:eD,property:iD,classed:lD,text:hD,html:gD,raise:vD,lower:wD,append:xD,insert:bD,remove:TD,clone:AD,datum:kD,on:VD,dispatch:LD,[Symbol.iterator]:MD};function Cn(t){return typeof t=="string"?new On([[document.querySelector(t)]],[document.documentElement]):new On([[t]],kI)}function FD(t){let e;for(;e=t.sourceEvent;)t=e;return t}function or(t,e){if(t=FD(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}const $D={passive:!1},Oc={capture:!0,passive:!1};function Ip(t){t.stopImmediatePropagation()}function fa(t){t.preventDefault(),t.stopImmediatePropagation()}function RI(t){var e=t.document.documentElement,n=Cn(t).on("dragstart.drag",fa,Oc);"onselectstart"in e?n.on("selectstart.drag",fa,Oc):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function NI(t,e){var n=t.document.documentElement,r=Cn(t).on("dragstart.drag",null);e&&(r.on("click.drag",fa,Oc),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ju=t=>()=>t;function Qm(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:l,dy:c,dispatch:d}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:d}})}Qm.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function UD(t){return!t.ctrlKey&&!t.button}function BD(){return this.parentNode}function HD(t,e){return e??{x:t.x,y:t.y}}function qD(){return navigator.maxTouchPoints||"ontouchstart"in this}function PI(){var t=UD,e=BD,n=HD,r=qD,i={},s=mf("start","drag","end"),o=0,a,l,c,d,h=0;function f(A){A.on("mousedown.drag",m).filter(r).on("touchstart.drag",R).on("touchmove.drag",y,$D).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(A,O){if(!(d||!t.call(this,A,O))){var L=T(this,e.call(this,A,O),A,O,"mouse");L&&(Cn(A.view).on("mousemove.drag",b,Oc).on("mouseup.drag",x,Oc),RI(A.view),Ip(A),c=!1,a=A.clientX,l=A.clientY,L("start",A))}}function b(A){if(fa(A),!c){var O=A.clientX-a,L=A.clientY-l;c=O*O+L*L>h}i.mouse("drag",A)}function x(A){Cn(A.view).on("mousemove.drag mouseup.drag",null),NI(A.view,c),fa(A),i.mouse("end",A)}function R(A,O){if(t.call(this,A,O)){var L=A.changedTouches,S=e.call(this,A,O),I=L.length,w,E;for(w=0;w<I;++w)(E=T(this,S,A,O,L[w].identifier,L[w]))&&(Ip(A),E("start",A,L[w]))}}function y(A){var O=A.changedTouches,L=O.length,S,I;for(S=0;S<L;++S)(I=i[O[S].identifier])&&(fa(A),I("drag",A,O[S]))}function v(A){var O=A.changedTouches,L=O.length,S,I;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),S=0;S<L;++S)(I=i[O[S].identifier])&&(Ip(A),I("end",A,O[S]))}function T(A,O,L,S,I,w){var E=s.copy(),C=or(w||L,O),N,k,P;if((P=n.call(A,new Qm("beforestart",{sourceEvent:L,target:f,identifier:I,active:o,x:C[0],y:C[1],dx:0,dy:0,dispatch:E}),S))!=null)return N=P.x-C[0]||0,k=P.y-C[1]||0,function j(z,U,F){var M=C,B;switch(z){case"start":i[I]=j,B=o++;break;case"end":delete i[I],--o;case"drag":C=or(F||U,O),B=o;break}E.call(z,A,new Qm(z,{sourceEvent:U,subject:P,target:f,identifier:I,active:B,x:C[0]+N,y:C[1]+k,dx:C[0]-M[0],dy:C[1]-M[1],dispatch:E}),S)}}return f.filter=function(A){return arguments.length?(t=typeof A=="function"?A:Ju(!!A),f):t},f.container=function(A){return arguments.length?(e=typeof A=="function"?A:Ju(A),f):e},f.subject=function(A){return arguments.length?(n=typeof A=="function"?A:Ju(A),f):n},f.touchable=function(A){return arguments.length?(r=typeof A=="function"?A:Ju(!!A),f):r},f.on=function(){var A=s.on.apply(s,arguments);return A===s?f:A},f.clickDistance=function(A){return arguments.length?(h=(A=+A)*A,f):Math.sqrt(h)},f}function F0(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function DI(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function cu(){}var zc=.7,vh=1/zc,pa="\\s*([+-]?\\d+)\\s*",Lc="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Nr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",KD=/^#([0-9a-f]{3,8})$/,GD=new RegExp(`^rgb\\(${pa},${pa},${pa}\\)$`),WD=new RegExp(`^rgb\\(${Nr},${Nr},${Nr}\\)$`),QD=new RegExp(`^rgba\\(${pa},${pa},${pa},${Lc}\\)$`),YD=new RegExp(`^rgba\\(${Nr},${Nr},${Nr},${Lc}\\)$`),XD=new RegExp(`^hsl\\(${Lc},${Nr},${Nr}\\)$`),JD=new RegExp(`^hsla\\(${Lc},${Nr},${Nr},${Lc}\\)$`),lw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};F0(cu,Mc,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:cw,formatHex:cw,formatHex8:ZD,formatHsl:eV,formatRgb:uw,toString:uw});function cw(){return this.rgb().formatHex()}function ZD(){return this.rgb().formatHex8()}function eV(){return VI(this).formatHsl()}function uw(){return this.rgb().formatRgb()}function Mc(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=KD.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?dw(e):n===3?new hn(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Zu(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Zu(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=GD.exec(t))?new hn(e[1],e[2],e[3],1):(e=WD.exec(t))?new hn(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=QD.exec(t))?Zu(e[1],e[2],e[3],e[4]):(e=YD.exec(t))?Zu(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=XD.exec(t))?pw(e[1],e[2]/100,e[3]/100,1):(e=JD.exec(t))?pw(e[1],e[2]/100,e[3]/100,e[4]):lw.hasOwnProperty(t)?dw(lw[t]):t==="transparent"?new hn(NaN,NaN,NaN,0):null}function dw(t){return new hn(t>>16&255,t>>8&255,t&255,1)}function Zu(t,e,n,r){return r<=0&&(t=e=n=NaN),new hn(t,e,n,r)}function tV(t){return t instanceof cu||(t=Mc(t)),t?(t=t.rgb(),new hn(t.r,t.g,t.b,t.opacity)):new hn}function Ym(t,e,n,r){return arguments.length===1?tV(t):new hn(t,e,n,r??1)}function hn(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}F0(hn,Ym,DI(cu,{brighter(t){return t=t==null?vh:Math.pow(vh,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?zc:Math.pow(zc,t),new hn(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new hn(Ks(this.r),Ks(this.g),Ks(this.b),_h(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:hw,formatHex:hw,formatHex8:nV,formatRgb:fw,toString:fw}));function hw(){return`#${Fs(this.r)}${Fs(this.g)}${Fs(this.b)}`}function nV(){return`#${Fs(this.r)}${Fs(this.g)}${Fs(this.b)}${Fs((isNaN(this.opacity)?1:this.opacity)*255)}`}function fw(){const t=_h(this.opacity);return`${t===1?"rgb(":"rgba("}${Ks(this.r)}, ${Ks(this.g)}, ${Ks(this.b)}${t===1?")":`, ${t})`}`}function _h(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Ks(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Fs(t){return t=Ks(t),(t<16?"0":"")+t.toString(16)}function pw(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new lr(t,e,n,r)}function VI(t){if(t instanceof lr)return new lr(t.h,t.s,t.l,t.opacity);if(t instanceof cu||(t=Mc(t)),!t)return new lr;if(t instanceof lr)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new lr(o,a,l,t.opacity)}function rV(t,e,n,r){return arguments.length===1?VI(t):new lr(t,e,n,r??1)}function lr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}F0(lr,rV,DI(cu,{brighter(t){return t=t==null?vh:Math.pow(vh,t),new lr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?zc:Math.pow(zc,t),new lr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new hn(Tp(t>=240?t-240:t+120,i,r),Tp(t,i,r),Tp(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new lr(mw(this.h),ed(this.s),ed(this.l),_h(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=_h(this.opacity);return`${t===1?"hsl(":"hsla("}${mw(this.h)}, ${ed(this.s)*100}%, ${ed(this.l)*100}%${t===1?")":`, ${t})`}`}}));function mw(t){return t=(t||0)%360,t<0?t+360:t}function ed(t){return Math.max(0,Math.min(1,t||0))}function Tp(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const OI=t=>()=>t;function iV(t,e){return function(n){return t+n*e}}function sV(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function oV(t){return(t=+t)==1?zI:function(e,n){return n-e?sV(e,n,t):OI(isNaN(e)?n:e)}}function zI(t,e){var n=e-t;return n?iV(t,n):OI(isNaN(t)?e:t)}const gw=function t(e){var n=oV(e);function r(i,s){var o=n((i=Ym(i)).r,(s=Ym(s)).r),a=n(i.g,s.g),l=n(i.b,s.b),c=zI(i.opacity,s.opacity);return function(d){return i.r=o(d),i.g=a(d),i.b=l(d),i.opacity=c(d),i+""}}return r.gamma=t,r}(1);function Pi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Xm=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Sp=new RegExp(Xm.source,"g");function aV(t){return function(){return t}}function lV(t){return function(e){return t(e)+""}}function cV(t,e){var n=Xm.lastIndex=Sp.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(r=Xm.exec(t))&&(i=Sp.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:Pi(r,i)})),n=Sp.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?lV(l[0].x):aV(e):(e=l.length,function(c){for(var d=0,h;d<e;++d)a[(h=l[d]).i]=h.x(c);return a.join("")})}var yw=180/Math.PI,Jm={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function LI(t,e,n,r,i,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*yw,skewX:Math.atan(l)*yw,scaleX:o,scaleY:a}}var td;function uV(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Jm:LI(e.a,e.b,e.c,e.d,e.e,e.f)}function dV(t){return t==null||(td||(td=document.createElementNS("http://www.w3.org/2000/svg","g")),td.setAttribute("transform",t),!(t=td.transform.baseVal.consolidate()))?Jm:(t=t.matrix,LI(t.a,t.b,t.c,t.d,t.e,t.f))}function MI(t,e,n,r){function i(c){return c.length?c.pop()+" ":""}function s(c,d,h,f,m,b){if(c!==h||d!==f){var x=m.push("translate(",null,e,null,n);b.push({i:x-4,x:Pi(c,h)},{i:x-2,x:Pi(d,f)})}else(h||f)&&m.push("translate("+h+e+f+n)}function o(c,d,h,f){c!==d?(c-d>180?d+=360:d-c>180&&(c+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:Pi(c,d)})):d&&h.push(i(h)+"rotate("+d+r)}function a(c,d,h,f){c!==d?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:Pi(c,d)}):d&&h.push(i(h)+"skewX("+d+r)}function l(c,d,h,f,m,b){if(c!==h||d!==f){var x=m.push(i(m)+"scale(",null,",",null,")");b.push({i:x-4,x:Pi(c,h)},{i:x-2,x:Pi(d,f)})}else(h!==1||f!==1)&&m.push(i(m)+"scale("+h+","+f+")")}return function(c,d){var h=[],f=[];return c=t(c),d=t(d),s(c.translateX,c.translateY,d.translateX,d.translateY,h,f),o(c.rotate,d.rotate,h,f),a(c.skewX,d.skewX,h,f),l(c.scaleX,c.scaleY,d.scaleX,d.scaleY,h,f),c=d=null,function(m){for(var b=-1,x=f.length,R;++b<x;)h[(R=f[b]).i]=R.x(m);return h.join("")}}}var hV=MI(uV,"px, ","px)","deg)"),fV=MI(dV,", ",")",")"),pV=1e-12;function vw(t){return((t=Math.exp(t))+1/t)/2}function mV(t){return((t=Math.exp(t))-1/t)/2}function gV(t){return((t=Math.exp(2*t))-1)/(t+1)}const yV=function t(e,n,r){function i(s,o){var a=s[0],l=s[1],c=s[2],d=o[0],h=o[1],f=o[2],m=d-a,b=h-l,x=m*m+b*b,R,y;if(x<pV)y=Math.log(f/c)/e,R=function(S){return[a+S*m,l+S*b,c*Math.exp(e*S*y)]};else{var v=Math.sqrt(x),T=(f*f-c*c+r*x)/(2*c*n*v),A=(f*f-c*c-r*x)/(2*f*n*v),O=Math.log(Math.sqrt(T*T+1)-T),L=Math.log(Math.sqrt(A*A+1)-A);y=(L-O)/e,R=function(S){var I=S*y,w=vw(O),E=c/(n*v)*(w*gV(e*I+O)-mV(O));return[a+E*m,l+E*b,c*w/vw(e*I+O)]}}return R.duration=y*1e3*e/Math.SQRT2,R}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return t(o,a,l)},i}(Math.SQRT2,2,4);var Ra=0,Hl=0,Rl=0,jI=1e3,wh,ql,xh=0,to=0,yf=0,jc=typeof performance=="object"&&performance.now?performance:Date,FI=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function $0(){return to||(FI(vV),to=jc.now()+yf)}function vV(){to=0}function Eh(){this._call=this._time=this._next=null}Eh.prototype=$I.prototype={constructor:Eh,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?$0():+n)+(e==null?0:+e),!this._next&&ql!==this&&(ql?ql._next=this:wh=this,ql=this),this._call=t,this._time=n,Zm()},stop:function(){this._call&&(this._call=null,this._time=1/0,Zm())}};function $I(t,e,n){var r=new Eh;return r.restart(t,e,n),r}function _V(){$0(),++Ra;for(var t=wh,e;t;)(e=to-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Ra}function _w(){to=(xh=jc.now())+yf,Ra=Hl=0;try{_V()}finally{Ra=0,xV(),to=0}}function wV(){var t=jc.now(),e=t-xh;e>jI&&(yf-=e,xh=t)}function xV(){for(var t,e=wh,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:wh=n);ql=t,Zm(r)}function Zm(t){if(!Ra){Hl&&(Hl=clearTimeout(Hl));var e=t-to;e>24?(t<1/0&&(Hl=setTimeout(_w,t-jc.now()-yf)),Rl&&(Rl=clearInterval(Rl))):(Rl||(xh=jc.now(),Rl=setInterval(wV,jI)),Ra=1,FI(_w))}}function ww(t,e,n){var r=new Eh;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}var EV=mf("start","end","cancel","interrupt"),bV=[],UI=0,xw=1,eg=2,Nd=3,Ew=4,tg=5,Pd=6;function vf(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;IV(t,n,{name:e,index:r,group:i,on:EV,tween:bV,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:UI})}function U0(t,e){var n=gr(t,e);if(n.state>UI)throw new Error("too late; already scheduled");return n}function zr(t,e){var n=gr(t,e);if(n.state>Nd)throw new Error("too late; already running");return n}function gr(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function IV(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=$I(s,0,n.time);function s(c){n.state=xw,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var d,h,f,m;if(n.state!==xw)return l();for(d in r)if(m=r[d],m.name===n.name){if(m.state===Nd)return ww(o);m.state===Ew?(m.state=Pd,m.timer.stop(),m.on.call("interrupt",t,t.__data__,m.index,m.group),delete r[d]):+d<e&&(m.state=Pd,m.timer.stop(),m.on.call("cancel",t,t.__data__,m.index,m.group),delete r[d])}if(ww(function(){n.state===Nd&&(n.state=Ew,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=eg,n.on.call("start",t,t.__data__,n.index,n.group),n.state===eg){for(n.state=Nd,i=new Array(f=n.tween.length),d=0,h=-1;d<f;++d)(m=n.tween[d].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=m);i.length=h+1}}function a(c){for(var d=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=tg,1),h=-1,f=i.length;++h<f;)i[h].call(t,d);n.state===tg&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Pd,n.timer.stop(),delete r[e];for(var c in r)return;delete t.__transition}}function Dd(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>eg&&r.state<tg,r.state=Pd,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function TV(t){return this.each(function(){Dd(this,t)})}function SV(t,e){var n,r;return function(){var i=zr(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function CV(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=zr(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:e,value:n},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}s.tween=i}}function AV(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=gr(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?SV:CV)(n,t,e))}function B0(t,e,n){var r=t._id;return t.each(function(){var i=zr(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return gr(i,r).value[e]}}function BI(t,e){var n;return(typeof e=="number"?Pi:e instanceof Mc?gw:(n=Mc(e))?(e=n,gw):cV)(t,e)}function kV(t){return function(){this.removeAttribute(t)}}function RV(t){return function(){this.removeAttributeNS(t.space,t.local)}}function NV(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function PV(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function DV(t,e,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function VV(t,e,n){var r,i,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function OV(t,e){var n=gf(t),r=n==="transform"?fV:BI;return this.attrTween(t,typeof e=="function"?(n.local?VV:DV)(n,r,B0(this,"attr."+t,e)):e==null?(n.local?RV:kV)(n):(n.local?PV:NV)(n,r,e))}function zV(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function LV(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function MV(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&LV(t,s)),n}return i._value=e,i}function jV(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&zV(t,s)),n}return i._value=e,i}function FV(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=gf(t);return this.tween(n,(r.local?MV:jV)(r,e))}function $V(t,e){return function(){U0(this,t).delay=+e.apply(this,arguments)}}function UV(t,e){return e=+e,function(){U0(this,t).delay=e}}function BV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?$V:UV)(e,t)):gr(this.node(),e).delay}function HV(t,e){return function(){zr(this,t).duration=+e.apply(this,arguments)}}function qV(t,e){return e=+e,function(){zr(this,t).duration=e}}function KV(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?HV:qV)(e,t)):gr(this.node(),e).duration}function GV(t,e){if(typeof e!="function")throw new Error;return function(){zr(this,t).ease=e}}function WV(t){var e=this._id;return arguments.length?this.each(GV(e,t)):gr(this.node(),e).ease}function QV(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;zr(this,t).ease=n}}function YV(t){if(typeof t!="function")throw new Error;return this.each(QV(this._id,t))}function XV(t){typeof t!="function"&&(t=wI(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new ci(r,this._parents,this._name,this._id)}function JV(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var l=e[a],c=n[a],d=l.length,h=o[a]=new Array(d),f,m=0;m<d;++m)(f=l[m]||c[m])&&(h[m]=f);for(;a<r;++a)o[a]=e[a];return new ci(o,this._parents,this._name,this._id)}function ZV(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function e4(t,e,n){var r,i,s=ZV(e)?U0:zr;return function(){var o=s(this,t),a=o.on;a!==r&&(i=(r=a).copy()).on(e,n),o.on=i}}function t4(t,e){var n=this._id;return arguments.length<2?gr(this.node(),n).on.on(t):this.each(e4(n,t,e))}function n4(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function r4(){return this.on("end.remove",n4(this._id))}function i4(t){var e=this._name,n=this._id;typeof t!="function"&&(t=M0(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],l=a.length,c=s[o]=new Array(l),d,h,f=0;f<l;++f)(d=a[f])&&(h=t.call(d,d.__data__,f,a))&&("__data__"in d&&(h.__data__=d.__data__),c[f]=h,vf(c[f],e,n,f,c,gr(d,n)));return new ci(s,this._parents,e,n)}function s4(t){var e=this._name,n=this._id;typeof t!="function"&&(t=_I(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l=r[a],c=l.length,d,h=0;h<c;++h)if(d=l[h]){for(var f=t.call(d,d.__data__,h,l),m,b=gr(d,n),x=0,R=f.length;x<R;++x)(m=f[x])&&vf(m,e,n,x,f,b);s.push(f),o.push(d)}return new ci(s,o,e,n)}var o4=lu.prototype.constructor;function a4(){return new o4(this._groups,this._parents)}function l4(t,e){var n,r,i;return function(){var s=ka(this,t),o=(this.style.removeProperty(t),ka(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function HI(t){return function(){this.style.removeProperty(t)}}function c4(t,e,n){var r,i=n+"",s;return function(){var o=ka(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function u4(t,e,n){var r,i,s;return function(){var o=ka(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),ka(this,t))),o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a))}}function d4(t,e){var n,r,i,s="style."+e,o="end."+s,a;return function(){var l=zr(this,t),c=l.on,d=l.value[s]==null?a||(a=HI(e)):void 0;(c!==n||i!==d)&&(r=(n=c).copy()).on(o,i=d),l.on=r}}function h4(t,e,n){var r=(t+="")=="transform"?hV:BI;return e==null?this.styleTween(t,l4(t,r)).on("end.style."+t,HI(t)):typeof e=="function"?this.styleTween(t,u4(t,r,B0(this,"style."+t,e))).each(d4(this._id,t)):this.styleTween(t,c4(t,r,e),n).on("end.style."+t,null)}function f4(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function p4(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&f4(t,o,n)),r}return s._value=e,s}function m4(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,p4(t,e,n??""))}function g4(t){return function(){this.textContent=t}}function y4(t){return function(){var e=t(this);this.textContent=e??""}}function v4(t){return this.tween("text",typeof t=="function"?y4(B0(this,"text",t)):g4(t==null?"":t+""))}function _4(t){return function(e){this.textContent=t.call(this,e)}}function w4(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&_4(i)),e}return r._value=t,r}function x4(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,w4(t))}function E4(){for(var t=this._name,e=this._id,n=qI(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var d=gr(l,e);vf(l,t,n,c,o,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new ci(r,this._parents,t,n)}function b4(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--i===0&&s()}};n.each(function(){var c=zr(this,r),d=c.on;d!==t&&(e=(t=d).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),i===0&&s()})}var I4=0;function ci(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function qI(){return++I4}var Hr=lu.prototype;ci.prototype={constructor:ci,select:i4,selectAll:s4,selectChild:Hr.selectChild,selectChildren:Hr.selectChildren,filter:XV,merge:JV,selection:a4,transition:E4,call:Hr.call,nodes:Hr.nodes,node:Hr.node,size:Hr.size,empty:Hr.empty,each:Hr.each,on:t4,attr:OV,attrTween:FV,style:h4,styleTween:m4,text:v4,textTween:x4,remove:r4,tween:AV,delay:BV,duration:KV,ease:WV,easeVarying:YV,end:b4,[Symbol.iterator]:Hr[Symbol.iterator]};function T4(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var S4={time:null,delay:0,duration:250,ease:T4};function C4(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function A4(t){var e,n;t instanceof ci?(e=t._id,t=t._name):(e=qI(),(n=S4).time=$0(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&vf(l,t,e,c,o,n||C4(l,e));return new ci(r,this._parents,t,e)}lu.prototype.interrupt=TV;lu.prototype.transition=A4;const nd=t=>()=>t;function k4(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Xr(t,e,n){this.k=t,this.x=e,this.y=n}Xr.prototype={constructor:Xr,scale:function(t){return t===1?this:new Xr(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Xr(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ri=new Xr(1,0,0);Xr.prototype;function Cp(t){t.stopImmediatePropagation()}function Nl(t){t.preventDefault(),t.stopImmediatePropagation()}function R4(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function N4(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function bw(){return this.__zoom||ri}function P4(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function D4(){return navigator.maxTouchPoints||"ontouchstart"in this}function V4(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function KI(){var t=R4,e=N4,n=V4,r=P4,i=D4,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=yV,c=mf("start","zoom","end"),d,h,f,m=500,b=150,x=0,R=10;function y(P){P.property("__zoom",bw).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",w).on("dblclick.zoom",E).filter(i).on("touchstart.zoom",C).on("touchmove.zoom",N).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(P,j,z,U){var F=P.selection?P.selection():P;F.property("__zoom",bw),P!==F?O(P,j,z,U):F.interrupt().each(function(){L(this,arguments).event(U).start().zoom(null,typeof j=="function"?j.apply(this,arguments):j).end()})},y.scaleBy=function(P,j,z,U){y.scaleTo(P,function(){var F=this.__zoom.k,M=typeof j=="function"?j.apply(this,arguments):j;return F*M},z,U)},y.scaleTo=function(P,j,z,U){y.transform(P,function(){var F=e.apply(this,arguments),M=this.__zoom,B=z==null?A(F):typeof z=="function"?z.apply(this,arguments):z,G=M.invert(B),$=typeof j=="function"?j.apply(this,arguments):j;return n(T(v(M,$),B,G),F,o)},z,U)},y.translateBy=function(P,j,z,U){y.transform(P,function(){return n(this.__zoom.translate(typeof j=="function"?j.apply(this,arguments):j,typeof z=="function"?z.apply(this,arguments):z),e.apply(this,arguments),o)},null,U)},y.translateTo=function(P,j,z,U,F){y.transform(P,function(){var M=e.apply(this,arguments),B=this.__zoom,G=U==null?A(M):typeof U=="function"?U.apply(this,arguments):U;return n(ri.translate(G[0],G[1]).scale(B.k).translate(typeof j=="function"?-j.apply(this,arguments):-j,typeof z=="function"?-z.apply(this,arguments):-z),M,o)},U,F)};function v(P,j){return j=Math.max(s[0],Math.min(s[1],j)),j===P.k?P:new Xr(j,P.x,P.y)}function T(P,j,z){var U=j[0]-z[0]*P.k,F=j[1]-z[1]*P.k;return U===P.x&&F===P.y?P:new Xr(P.k,U,F)}function A(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function O(P,j,z,U){P.on("start.zoom",function(){L(this,arguments).event(U).start()}).on("interrupt.zoom end.zoom",function(){L(this,arguments).event(U).end()}).tween("zoom",function(){var F=this,M=arguments,B=L(F,M).event(U),G=e.apply(F,M),$=z==null?A(G):typeof z=="function"?z.apply(F,M):z,Y=Math.max(G[1][0]-G[0][0],G[1][1]-G[0][1]),X=F.__zoom,ee=typeof j=="function"?j.apply(F,M):j,re=l(X.invert($).concat(Y/X.k),ee.invert($).concat(Y/ee.k));return function(fe){if(fe===1)fe=ee;else{var ie=re(fe),xe=Y/ie[2];fe=new Xr(xe,$[0]-ie[0]*xe,$[1]-ie[1]*xe)}B.zoom(null,fe)}})}function L(P,j,z){return!z&&P.__zooming||new S(P,j)}function S(P,j){this.that=P,this.args=j,this.active=0,this.sourceEvent=null,this.extent=e.apply(P,j),this.taps=0}S.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,j){return this.mouse&&P!=="mouse"&&(this.mouse[1]=j.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=j.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=j.invert(this.touch1[0])),this.that.__zoom=j,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var j=Cn(this.that).datum();c.call(P,this.that,new k4(P,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:c}),j)}};function I(P,...j){if(!t.apply(this,arguments))return;var z=L(this,j).event(P),U=this.__zoom,F=Math.max(s[0],Math.min(s[1],U.k*Math.pow(2,r.apply(this,arguments)))),M=or(P);if(z.wheel)(z.mouse[0][0]!==M[0]||z.mouse[0][1]!==M[1])&&(z.mouse[1]=U.invert(z.mouse[0]=M)),clearTimeout(z.wheel);else{if(U.k===F)return;z.mouse=[M,U.invert(M)],Dd(this),z.start()}Nl(P),z.wheel=setTimeout(B,b),z.zoom("mouse",n(T(v(U,F),z.mouse[0],z.mouse[1]),z.extent,o));function B(){z.wheel=null,z.end()}}function w(P,...j){if(f||!t.apply(this,arguments))return;var z=P.currentTarget,U=L(this,j,!0).event(P),F=Cn(P.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",Y,!0),M=or(P,z),B=P.clientX,G=P.clientY;RI(P.view),Cp(P),U.mouse=[M,this.__zoom.invert(M)],Dd(this),U.start();function $(X){if(Nl(X),!U.moved){var ee=X.clientX-B,re=X.clientY-G;U.moved=ee*ee+re*re>x}U.event(X).zoom("mouse",n(T(U.that.__zoom,U.mouse[0]=or(X,z),U.mouse[1]),U.extent,o))}function Y(X){F.on("mousemove.zoom mouseup.zoom",null),NI(X.view,U.moved),Nl(X),U.event(X).end()}}function E(P,...j){if(t.apply(this,arguments)){var z=this.__zoom,U=or(P.changedTouches?P.changedTouches[0]:P,this),F=z.invert(U),M=z.k*(P.shiftKey?.5:2),B=n(T(v(z,M),U,F),e.apply(this,j),o);Nl(P),a>0?Cn(this).transition().duration(a).call(O,B,U,P):Cn(this).call(y.transform,B,U,P)}}function C(P,...j){if(t.apply(this,arguments)){var z=P.touches,U=z.length,F=L(this,j,P.changedTouches.length===U).event(P),M,B,G,$;for(Cp(P),B=0;B<U;++B)G=z[B],$=or(G,this),$=[$,this.__zoom.invert($),G.identifier],F.touch0?!F.touch1&&F.touch0[2]!==$[2]&&(F.touch1=$,F.taps=0):(F.touch0=$,M=!0,F.taps=1+!!d);d&&(d=clearTimeout(d)),M&&(F.taps<2&&(h=$[0],d=setTimeout(function(){d=null},m)),Dd(this),F.start())}}function N(P,...j){if(this.__zooming){var z=L(this,j).event(P),U=P.changedTouches,F=U.length,M,B,G,$;for(Nl(P),M=0;M<F;++M)B=U[M],G=or(B,this),z.touch0&&z.touch0[2]===B.identifier?z.touch0[0]=G:z.touch1&&z.touch1[2]===B.identifier&&(z.touch1[0]=G);if(B=z.that.__zoom,z.touch1){var Y=z.touch0[0],X=z.touch0[1],ee=z.touch1[0],re=z.touch1[1],fe=(fe=ee[0]-Y[0])*fe+(fe=ee[1]-Y[1])*fe,ie=(ie=re[0]-X[0])*ie+(ie=re[1]-X[1])*ie;B=v(B,Math.sqrt(fe/ie)),G=[(Y[0]+ee[0])/2,(Y[1]+ee[1])/2],$=[(X[0]+re[0])/2,(X[1]+re[1])/2]}else if(z.touch0)G=z.touch0[0],$=z.touch0[1];else return;z.zoom("touch",n(T(B,G,$),z.extent,o))}}function k(P,...j){if(this.__zooming){var z=L(this,j).event(P),U=P.changedTouches,F=U.length,M,B;for(Cp(P),f&&clearTimeout(f),f=setTimeout(function(){f=null},m),M=0;M<F;++M)B=U[M],z.touch0&&z.touch0[2]===B.identifier?delete z.touch0:z.touch1&&z.touch1[2]===B.identifier&&delete z.touch1;if(z.touch1&&!z.touch0&&(z.touch0=z.touch1,delete z.touch1),z.touch0)z.touch0[1]=this.__zoom.invert(z.touch0[0]);else if(z.end(),z.taps===2&&(B=or(B,this),Math.hypot(h[0]-B[0],h[1]-B[1])<R)){var G=Cn(this).on("dblclick.zoom");G&&G.apply(this,arguments)}}}return y.wheelDelta=function(P){return arguments.length?(r=typeof P=="function"?P:nd(+P),y):r},y.filter=function(P){return arguments.length?(t=typeof P=="function"?P:nd(!!P),y):t},y.touchable=function(P){return arguments.length?(i=typeof P=="function"?P:nd(!!P),y):i},y.extent=function(P){return arguments.length?(e=typeof P=="function"?P:nd([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),y):e},y.scaleExtent=function(P){return arguments.length?(s[0]=+P[0],s[1]=+P[1],y):[s[0],s[1]]},y.translateExtent=function(P){return arguments.length?(o[0][0]=+P[0][0],o[1][0]=+P[1][0],o[0][1]=+P[0][1],o[1][1]=+P[1][1],y):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},y.constrain=function(P){return arguments.length?(n=P,y):n},y.duration=function(P){return arguments.length?(a=+P,y):a},y.interpolate=function(P){return arguments.length?(l=P,y):l},y.on=function(){var P=c.on.apply(c,arguments);return P===c?y:P},y.clickDistance=function(P){return arguments.length?(x=(P=+P)*P,y):Math.sqrt(x)},y.tapDistance=function(P){return arguments.length?(R=+P,y):R},y}const _f=D.createContext(null),O4=_f.Provider,ui={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:t=>`Node type "${t}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:t=>`The old edge with id=${t} does not exist.`,error009:t=>`Marker type "${t}" doesn't exist.`,error008:(t,e)=>`Couldn't create edge for ${t?"target":"source"} handle id: "${t?e.targetHandle:e.sourceHandle}", edge id: ${e.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:t=>`Edge type "${t}" not found. Using fallback type "default".`,error012:t=>`Node with id "${t}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},GI=ui.error001();function qe(t,e){const n=D.useContext(_f);if(n===null)throw new Error(GI);return yI(n,t,e)}const wt=()=>{const t=D.useContext(_f);if(t===null)throw new Error(GI);return D.useMemo(()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy}),[t])},z4=t=>t.userSelectionActive?"none":"all";function H0({position:t,children:e,className:n,style:r,...i}){const s=qe(z4),o=`${t}`.split("-");return K.createElement("div",{className:Vt(["react-flow__panel",n,...o]),style:{...r,pointerEvents:s},...i},e)}function L4({proOptions:t,position:e="bottom-right"}){return t!=null&&t.hideAttribution?null:K.createElement(H0,{position:e,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},K.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const M4=({x:t,y:e,label:n,labelStyle:r={},labelShowBg:i=!0,labelBgStyle:s={},labelBgPadding:o=[2,4],labelBgBorderRadius:a=2,children:l,className:c,...d})=>{const h=D.useRef(null),[f,m]=D.useState({x:0,y:0,width:0,height:0}),b=Vt(["react-flow__edge-textwrapper",c]);return D.useEffect(()=>{if(h.current){const x=h.current.getBBox();m({x:x.x,y:x.y,width:x.width,height:x.height})}},[n]),typeof n>"u"||!n?null:K.createElement("g",{transform:`translate(${t-f.width/2} ${e-f.height/2})`,className:b,visibility:f.width?"visible":"hidden",...d},i&&K.createElement("rect",{width:f.width+2*o[0],x:-o[0],y:-o[1],height:f.height+2*o[1],className:"react-flow__edge-textbg",style:s,rx:a,ry:a}),K.createElement("text",{className:"react-flow__edge-text",y:f.height/2,dy:"0.3em",ref:h,style:r},n),l)};var j4=D.memo(M4);const q0=t=>({width:t.offsetWidth,height:t.offsetHeight}),os=(t,e=0,n=1)=>Math.min(Math.max(t,e),n),K0=(t={x:0,y:0},e)=>({x:os(t.x,e[0][0],e[1][0]),y:os(t.y,e[0][1],e[1][1])}),Iw=(t,e,n)=>t<e?os(Math.abs(t-e),1,50)/50:t>n?-os(Math.abs(t-n),1,50)/50:0,WI=(t,e)=>{const n=Iw(t.x,35,e.width-35)*20,r=Iw(t.y,35,e.height-35)*20;return[n,r]},QI=t=>{var e;return((e=t.getRootNode)==null?void 0:e.call(t))||(window==null?void 0:window.document)},YI=(t,e)=>({x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x2,e.x2),y2:Math.max(t.y2,e.y2)}),Fc=({x:t,y:e,width:n,height:r})=>({x:t,y:e,x2:t+n,y2:e+r}),XI=({x:t,y:e,x2:n,y2:r})=>({x:t,y:e,width:n-t,height:r-e}),Tw=t=>({...t.positionAbsolute||{x:0,y:0},width:t.width||0,height:t.height||0}),F4=(t,e)=>XI(YI(Fc(t),Fc(e))),ng=(t,e)=>{const n=Math.max(0,Math.min(t.x+t.width,e.x+e.width)-Math.max(t.x,e.x)),r=Math.max(0,Math.min(t.y+t.height,e.y+e.height)-Math.max(t.y,e.y));return Math.ceil(n*r)},$4=t=>Kn(t.width)&&Kn(t.height)&&Kn(t.x)&&Kn(t.y),Kn=t=>!isNaN(t)&&isFinite(t),ht=Symbol.for("internals"),JI=["Enter"," ","Escape"],U4=(t,e)=>{},B4=t=>"nativeEvent"in t;function rg(t){var i,s;const e=B4(t)?t.nativeEvent:t,n=((s=(i=e.composedPath)==null?void 0:i.call(e))==null?void 0:s[0])||t.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const ZI=t=>"clientX"in t,Ji=(t,e)=>{var s,o;const n=ZI(t),r=n?t.clientX:(s=t.touches)==null?void 0:s[0].clientX,i=n?t.clientY:(o=t.touches)==null?void 0:o[0].clientY;return{x:r-((e==null?void 0:e.left)??0),y:i-((e==null?void 0:e.top)??0)}},bh=()=>{var t;return typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)==null?void 0:t.indexOf("Mac"))>=0},Xa=({id:t,path:e,labelX:n,labelY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m=20})=>K.createElement(K.Fragment,null,K.createElement("path",{id:t,style:d,d:e,fill:"none",className:"react-flow__edge-path",markerEnd:h,markerStart:f}),m&&K.createElement("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),i&&Kn(n)&&Kn(r)?K.createElement(j4,{x:n,y:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c}):null);Xa.displayName="BaseEdge";function Pl(t,e,n){return n===void 0?n:r=>{const i=e().edges.find(s=>s.id===t);i&&n(r,{...i})}}function eT({sourceX:t,sourceY:e,targetX:n,targetY:r}){const i=Math.abs(n-t)/2,s=n<t?n+i:n-i,o=Math.abs(r-e)/2,a=r<e?r+o:r-o;return[s,a,i,o]}function tT({sourceX:t,sourceY:e,targetX:n,targetY:r,sourceControlX:i,sourceControlY:s,targetControlX:o,targetControlY:a}){const l=t*.125+i*.375+o*.375+n*.125,c=e*.125+s*.375+a*.375+r*.125,d=Math.abs(l-t),h=Math.abs(c-e);return[l,c,d,h]}var no;(function(t){t.Strict="strict",t.Loose="loose"})(no||(no={}));var $s;(function(t){t.Free="free",t.Vertical="vertical",t.Horizontal="horizontal"})($s||($s={}));var $c;(function(t){t.Partial="partial",t.Full="full"})($c||($c={}));var zi;(function(t){t.Bezier="default",t.Straight="straight",t.Step="step",t.SmoothStep="smoothstep",t.SimpleBezier="simplebezier"})(zi||(zi={}));var Ih;(function(t){t.Arrow="arrow",t.ArrowClosed="arrowclosed"})(Ih||(Ih={}));var ce;(function(t){t.Left="left",t.Top="top",t.Right="right",t.Bottom="bottom"})(ce||(ce={}));function Sw({pos:t,x1:e,y1:n,x2:r,y2:i}){return t===ce.Left||t===ce.Right?[.5*(e+r),n]:[e,.5*(n+i)]}function nT({sourceX:t,sourceY:e,sourcePosition:n=ce.Bottom,targetX:r,targetY:i,targetPosition:s=ce.Top}){const[o,a]=Sw({pos:n,x1:t,y1:e,x2:r,y2:i}),[l,c]=Sw({pos:s,x1:r,y1:i,x2:t,y2:e}),[d,h,f,m]=tT({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:o,sourceControlY:a,targetControlX:l,targetControlY:c});return[`M${t},${e} C${o},${a} ${l},${c} ${r},${i}`,d,h,f,m]}const G0=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:i=ce.Bottom,targetPosition:s=ce.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:b,interactionWidth:x})=>{const[R,y,v]=nT({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:r,targetPosition:s});return K.createElement(Xa,{path:R,labelX:y,labelY:v,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:b,interactionWidth:x})});G0.displayName="SimpleBezierEdge";const Cw={[ce.Left]:{x:-1,y:0},[ce.Right]:{x:1,y:0},[ce.Top]:{x:0,y:-1},[ce.Bottom]:{x:0,y:1}},H4=({source:t,sourcePosition:e=ce.Bottom,target:n})=>e===ce.Left||e===ce.Right?t.x<n.x?{x:1,y:0}:{x:-1,y:0}:t.y<n.y?{x:0,y:1}:{x:0,y:-1},Aw=(t,e)=>Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));function q4({source:t,sourcePosition:e=ce.Bottom,target:n,targetPosition:r=ce.Top,center:i,offset:s}){const o=Cw[e],a=Cw[r],l={x:t.x+o.x*s,y:t.y+o.y*s},c={x:n.x+a.x*s,y:n.y+a.y*s},d=H4({source:l,sourcePosition:e,target:c}),h=d.x!==0?"x":"y",f=d[h];let m=[],b,x;const R={x:0,y:0},y={x:0,y:0},[v,T,A,O]=eT({sourceX:t.x,sourceY:t.y,targetX:n.x,targetY:n.y});if(o[h]*a[h]===-1){b=i.x??v,x=i.y??T;const S=[{x:b,y:l.y},{x:b,y:c.y}],I=[{x:l.x,y:x},{x:c.x,y:x}];o[h]===f?m=h==="x"?S:I:m=h==="x"?I:S}else{const S=[{x:l.x,y:c.y}],I=[{x:c.x,y:l.y}];if(h==="x"?m=o.x===f?I:S:m=o.y===f?S:I,e===r){const k=Math.abs(t[h]-n[h]);if(k<=s){const P=Math.min(s-1,s-k);o[h]===f?R[h]=(l[h]>t[h]?-1:1)*P:y[h]=(c[h]>n[h]?-1:1)*P}}if(e!==r){const k=h==="x"?"y":"x",P=o[h]===a[k],j=l[k]>c[k],z=l[k]<c[k];(o[h]===1&&(!P&&j||P&&z)||o[h]!==1&&(!P&&z||P&&j))&&(m=h==="x"?S:I)}const w={x:l.x+R.x,y:l.y+R.y},E={x:c.x+y.x,y:c.y+y.y},C=Math.max(Math.abs(w.x-m[0].x),Math.abs(E.x-m[0].x)),N=Math.max(Math.abs(w.y-m[0].y),Math.abs(E.y-m[0].y));C>=N?(b=(w.x+E.x)/2,x=m[0].y):(b=m[0].x,x=(w.y+E.y)/2)}return[[t,{x:l.x+R.x,y:l.y+R.y},...m,{x:c.x+y.x,y:c.y+y.y},n],b,x,A,O]}function K4(t,e,n,r){const i=Math.min(Aw(t,e)/2,Aw(e,n)/2,r),{x:s,y:o}=e;if(t.x===s&&s===n.x||t.y===o&&o===n.y)return`L${s} ${o}`;if(t.y===o){const c=t.x<n.x?-1:1,d=t.y<n.y?1:-1;return`L ${s+i*c},${o}Q ${s},${o} ${s},${o+i*d}`}const a=t.x<n.x?1:-1,l=t.y<n.y?-1:1;return`L ${s},${o+i*l}Q ${s},${o} ${s+i*a},${o}`}function Uc({sourceX:t,sourceY:e,sourcePosition:n=ce.Bottom,targetX:r,targetY:i,targetPosition:s=ce.Top,borderRadius:o=5,centerX:a,centerY:l,offset:c=20}){const[d,h,f,m,b]=q4({source:{x:t,y:e},sourcePosition:n,target:{x:r,y:i},targetPosition:s,center:{x:a,y:l},offset:c});return[d.reduce((R,y,v)=>{let T="";return v>0&&v<d.length-1?T=K4(d[v-1],y,d[v+1],o):T=`${v===0?"M":"L"}${y.x} ${y.y}`,R+=T,R},""),h,f,m,b]}const wf=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,sourcePosition:h=ce.Bottom,targetPosition:f=ce.Top,markerEnd:m,markerStart:b,pathOptions:x,interactionWidth:R})=>{const[y,v,T]=Uc({sourceX:t,sourceY:e,sourcePosition:h,targetX:n,targetY:r,targetPosition:f,borderRadius:x==null?void 0:x.borderRadius,offset:x==null?void 0:x.offset});return K.createElement(Xa,{path:y,labelX:v,labelY:T,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:m,markerStart:b,interactionWidth:R})});wf.displayName="SmoothStepEdge";const W0=D.memo(t=>{var e;return K.createElement(wf,{...t,pathOptions:D.useMemo(()=>{var n;return{borderRadius:0,offset:(n=t.pathOptions)==null?void 0:n.offset}},[(e=t.pathOptions)==null?void 0:e.offset])})});W0.displayName="StepEdge";function rT({sourceX:t,sourceY:e,targetX:n,targetY:r}){const[i,s,o,a]=eT({sourceX:t,sourceY:e,targetX:n,targetY:r});return[`M ${t},${e}L ${n},${r}`,i,s,o,a]}const Q0=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m})=>{const[b,x,R]=rT({sourceX:t,sourceY:e,targetX:n,targetY:r});return K.createElement(Xa,{path:b,labelX:x,labelY:R,label:i,labelStyle:s,labelShowBg:o,labelBgStyle:a,labelBgPadding:l,labelBgBorderRadius:c,style:d,markerEnd:h,markerStart:f,interactionWidth:m})});Q0.displayName="StraightEdge";function rd(t,e){return t>=0?.5*t:e*25*Math.sqrt(-t)}function kw({pos:t,x1:e,y1:n,x2:r,y2:i,c:s}){switch(t){case ce.Left:return[e-rd(e-r,s),n];case ce.Right:return[e+rd(r-e,s),n];case ce.Top:return[e,n-rd(n-i,s)];case ce.Bottom:return[e,n+rd(i-n,s)]}}function Y0({sourceX:t,sourceY:e,sourcePosition:n=ce.Bottom,targetX:r,targetY:i,targetPosition:s=ce.Top,curvature:o=.25}){const[a,l]=kw({pos:n,x1:t,y1:e,x2:r,y2:i,c:o}),[c,d]=kw({pos:s,x1:r,y1:i,x2:t,y2:e,c:o}),[h,f,m,b]=tT({sourceX:t,sourceY:e,targetX:r,targetY:i,sourceControlX:a,sourceControlY:l,targetControlX:c,targetControlY:d});return[`M${t},${e} C${a},${l} ${c},${d} ${r},${i}`,h,f,m,b]}const Th=D.memo(({sourceX:t,sourceY:e,targetX:n,targetY:r,sourcePosition:i=ce.Bottom,targetPosition:s=ce.Top,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:b,pathOptions:x,interactionWidth:R})=>{const[y,v,T]=Y0({sourceX:t,sourceY:e,sourcePosition:i,targetX:n,targetY:r,targetPosition:s,curvature:x==null?void 0:x.curvature});return K.createElement(Xa,{path:y,labelX:v,labelY:T,label:o,labelStyle:a,labelShowBg:l,labelBgStyle:c,labelBgPadding:d,labelBgBorderRadius:h,style:f,markerEnd:m,markerStart:b,interactionWidth:R})});Th.displayName="BezierEdge";const X0=D.createContext(null),G4=X0.Provider;X0.Consumer;const iT=()=>D.useContext(X0),W4=t=>"id"in t&&"source"in t&&"target"in t,Q4=({source:t,sourceHandle:e,target:n,targetHandle:r})=>`reactflow__edge-${t}${e||""}-${n}${r||""}`,ig=(t,e)=>typeof t>"u"?"":typeof t=="string"?t:`${e?`${e}__`:""}${Object.keys(t).sort().map(r=>`${r}=${t[r]}`).join("&")}`,Y4=(t,e)=>e.some(n=>n.source===t.source&&n.target===t.target&&(n.sourceHandle===t.sourceHandle||!n.sourceHandle&&!t.sourceHandle)&&(n.targetHandle===t.targetHandle||!n.targetHandle&&!t.targetHandle)),sT=(t,e)=>{if(!t.source||!t.target)return e;let n;return W4(t)?n={...t}:n={...t,id:Q4(t)},Y4(n,e)?e:e.concat(n)},sg=({x:t,y:e},[n,r,i],s,[o,a])=>{const l={x:(t-n)/i,y:(e-r)/i};return s?{x:o*Math.round(l.x/o),y:a*Math.round(l.y/a)}:l},oT=({x:t,y:e},[n,r,i])=>({x:t*i+n,y:e*i+r}),Gs=(t,e=[0,0])=>{if(!t)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(t.width??0)*e[0],r=(t.height??0)*e[1],i={x:t.position.x-n,y:t.position.y-r};return{...i,positionAbsolute:t.positionAbsolute?{x:t.positionAbsolute.x-n,y:t.positionAbsolute.y-r}:i}},uu=(t,e=[0,0])=>{if(t.length===0)return{x:0,y:0,width:0,height:0};const n=t.reduce((r,i)=>{const{x:s,y:o}=Gs(i,e).positionAbsolute;return YI(r,Fc({x:s,y:o,width:i.width||0,height:i.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return XI(n)},aT=(t,e,[n,r,i]=[0,0,1],s=!1,o=!1,a=[0,0])=>{const l={x:(e.x-n)/i,y:(e.y-r)/i,width:e.width/i,height:e.height/i},c=[];return t.forEach(d=>{const{width:h,height:f,selectable:m=!0,hidden:b=!1}=d;if(o&&!m||b)return!1;const{positionAbsolute:x}=Gs(d,a),R={x:x.x,y:x.y,width:h||0,height:f||0},y=ng(l,R),v=typeof h>"u"||typeof f>"u"||h===null||f===null,T=s&&y>0,A=(h||0)*(f||0);(v||T||y>=A||d.dragging)&&c.push(d)}),c},lT=(t,e)=>{const n=t.map(r=>r.id);return e.filter(r=>n.includes(r.source)||n.includes(r.target))},cT=(t,e,n,r,i,s=.1)=>{const o=e/(t.width*(1+s)),a=n/(t.height*(1+s)),l=Math.min(o,a),c=os(l,r,i),d=t.x+t.width/2,h=t.y+t.height/2,f=e/2-d*c,m=n/2-h*c;return{x:f,y:m,zoom:c}},Rs=(t,e=0)=>t.transition().duration(e);function Rw(t,e,n,r){return(e[n]||[]).reduce((i,s)=>{var o,a;return`${t.id}-${s.id}-${n}`!==r&&i.push({id:s.id||null,type:n,nodeId:t.id,x:(((o=t.positionAbsolute)==null?void 0:o.x)??0)+s.x+s.width/2,y:(((a=t.positionAbsolute)==null?void 0:a.y)??0)+s.y+s.height/2}),i},[])}function X4(t,e,n,r,i,s){const{x:o,y:a}=Ji(t),c=e.elementsFromPoint(o,a).find(b=>b.classList.contains("react-flow__handle"));if(c){const b=c.getAttribute("data-nodeid");if(b){const x=J0(void 0,c),R=c.getAttribute("data-handleid"),y=s({nodeId:b,id:R,type:x});if(y){const v=i.find(T=>T.nodeId===b&&T.type===x&&T.id===R);return{handle:{id:R,type:x,nodeId:b,x:(v==null?void 0:v.x)||n.x,y:(v==null?void 0:v.y)||n.y},validHandleResult:y}}}}let d=[],h=1/0;if(i.forEach(b=>{const x=Math.sqrt((b.x-n.x)**2+(b.y-n.y)**2);if(x<=r){const R=s(b);x<=h&&(x<h?d=[{handle:b,validHandleResult:R}]:x===h&&d.push({handle:b,validHandleResult:R}),h=x)}}),!d.length)return{handle:null,validHandleResult:uT()};if(d.length===1)return d[0];const f=d.some(({validHandleResult:b})=>b.isValid),m=d.some(({handle:b})=>b.type==="target");return d.find(({handle:b,validHandleResult:x})=>m?b.type==="target":f?x.isValid:!0)||d[0]}const J4={source:null,target:null,sourceHandle:null,targetHandle:null},uT=()=>({handleDomNode:null,isValid:!1,connection:J4,endHandle:null});function dT(t,e,n,r,i,s,o){const a=i==="target",l=o.querySelector(`.react-flow__handle[data-id="${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`),c={...uT(),handleDomNode:l};if(l){const d=J0(void 0,l),h=l.getAttribute("data-nodeid"),f=l.getAttribute("data-handleid"),m=l.classList.contains("connectable"),b=l.classList.contains("connectableend"),x={source:a?h:n,sourceHandle:a?f:r,target:a?n:h,targetHandle:a?r:f};c.connection=x,m&&b&&(e===no.Strict?a&&d==="source"||!a&&d==="target":h!==n||f!==r)&&(c.endHandle={nodeId:h,handleId:f,type:d},c.isValid=s(x))}return c}function Z4({nodes:t,nodeId:e,handleId:n,handleType:r}){return t.reduce((i,s)=>{if(s[ht]){const{handleBounds:o}=s[ht];let a=[],l=[];o&&(a=Rw(s,o,"source",`${e}-${n}-${r}`),l=Rw(s,o,"target",`${e}-${n}-${r}`)),i.push(...a,...l)}return i},[])}function J0(t,e){return t||(e!=null&&e.classList.contains("target")?"target":e!=null&&e.classList.contains("source")?"source":null)}function Ap(t){t==null||t.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function e5(t,e){let n=null;return e?n="valid":t&&!e&&(n="invalid"),n}function hT({event:t,handleId:e,nodeId:n,onConnect:r,isTarget:i,getState:s,setState:o,isValidConnection:a,edgeUpdaterType:l,onReconnectEnd:c}){const d=QI(t.target),{connectionMode:h,domNode:f,autoPanOnConnect:m,connectionRadius:b,onConnectStart:x,panBy:R,getNodes:y,cancelConnection:v}=s();let T=0,A;const{x:O,y:L}=Ji(t),S=d==null?void 0:d.elementFromPoint(O,L),I=J0(l,S),w=f==null?void 0:f.getBoundingClientRect();if(!w||!I)return;let E,C=Ji(t,w),N=!1,k=null,P=!1,j=null;const z=Z4({nodes:y(),nodeId:n,handleId:e,handleType:I}),U=()=>{if(!m)return;const[B,G]=WI(C,w);R({x:B,y:G}),T=requestAnimationFrame(U)};o({connectionPosition:C,connectionStatus:null,connectionNodeId:n,connectionHandleId:e,connectionHandleType:I,connectionStartHandle:{nodeId:n,handleId:e,type:I},connectionEndHandle:null}),x==null||x(t,{nodeId:n,handleId:e,handleType:I});function F(B){const{transform:G}=s();C=Ji(B,w);const{handle:$,validHandleResult:Y}=X4(B,d,sg(C,G,!1,[1,1]),b,z,X=>dT(X,h,n,e,i?"target":"source",a,d));if(A=$,N||(U(),N=!0),j=Y.handleDomNode,k=Y.connection,P=Y.isValid,o({connectionPosition:A&&P?oT({x:A.x,y:A.y},G):C,connectionStatus:e5(!!A,P),connectionEndHandle:Y.endHandle}),!A&&!P&&!j)return Ap(E);k.source!==k.target&&j&&(Ap(E),E=j,j.classList.add("connecting","react-flow__handle-connecting"),j.classList.toggle("valid",P),j.classList.toggle("react-flow__handle-valid",P))}function M(B){var G,$;(A||j)&&k&&P&&(r==null||r(k)),($=(G=s()).onConnectEnd)==null||$.call(G,B),l&&(c==null||c(B)),Ap(E),v(),cancelAnimationFrame(T),N=!1,P=!1,k=null,j=null,d.removeEventListener("mousemove",F),d.removeEventListener("mouseup",M),d.removeEventListener("touchmove",F),d.removeEventListener("touchend",M)}d.addEventListener("mousemove",F),d.addEventListener("mouseup",M),d.addEventListener("touchmove",F),d.addEventListener("touchend",M)}const Nw=()=>!0,t5=t=>({connectionStartHandle:t.connectionStartHandle,connectOnClick:t.connectOnClick,noPanClassName:t.noPanClassName}),n5=(t,e,n)=>r=>{const{connectionStartHandle:i,connectionEndHandle:s,connectionClickStartHandle:o}=r;return{connecting:(i==null?void 0:i.nodeId)===t&&(i==null?void 0:i.handleId)===e&&(i==null?void 0:i.type)===n||(s==null?void 0:s.nodeId)===t&&(s==null?void 0:s.handleId)===e&&(s==null?void 0:s.type)===n,clickConnecting:(o==null?void 0:o.nodeId)===t&&(o==null?void 0:o.handleId)===e&&(o==null?void 0:o.type)===n}},fT=D.forwardRef(({type:t="source",position:e=ce.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:i=!0,isConnectableEnd:s=!0,id:o,onConnect:a,children:l,className:c,onMouseDown:d,onTouchStart:h,...f},m)=>{var w,E;const b=o||null,x=t==="target",R=wt(),y=iT(),{connectOnClick:v,noPanClassName:T}=qe(t5,Pt),{connecting:A,clickConnecting:O}=qe(n5(y,b,t),Pt);y||(E=(w=R.getState()).onError)==null||E.call(w,"010",ui.error010());const L=C=>{const{defaultEdgeOptions:N,onConnect:k,hasDefaultEdges:P}=R.getState(),j={...N,...C};if(P){const{edges:z,setEdges:U}=R.getState();U(sT(j,z))}k==null||k(j),a==null||a(j)},S=C=>{if(!y)return;const N=ZI(C);i&&(N&&C.button===0||!N)&&hT({event:C,handleId:b,nodeId:y,onConnect:L,isTarget:x,getState:R.getState,setState:R.setState,isValidConnection:n||R.getState().isValidConnection||Nw}),N?d==null||d(C):h==null||h(C)},I=C=>{const{onClickConnectStart:N,onClickConnectEnd:k,connectionClickStartHandle:P,connectionMode:j,isValidConnection:z}=R.getState();if(!y||!P&&!i)return;if(!P){N==null||N(C,{nodeId:y,handleId:b,handleType:t}),R.setState({connectionClickStartHandle:{nodeId:y,type:t,handleId:b}});return}const U=QI(C.target),F=n||z||Nw,{connection:M,isValid:B}=dT({nodeId:y,id:b,type:t},j,P.nodeId,P.handleId||null,P.type,F,U);B&&L(M),k==null||k(C),R.setState({connectionClickStartHandle:null})};return K.createElement("div",{"data-handleid":b,"data-nodeid":y,"data-handlepos":e,"data-id":`${y}-${b}-${t}`,className:Vt(["react-flow__handle",`react-flow__handle-${e}`,"nodrag",T,c,{source:!x,target:x,connectable:r,connectablestart:i,connectableend:s,connecting:O,connectionindicator:r&&(i&&!A||s&&A)}]),onMouseDown:S,onTouchStart:S,onClick:v?I:void 0,ref:m,...f},l)});fT.displayName="Handle";var xn=D.memo(fT);const pT=({data:t,isConnectable:e,targetPosition:n=ce.Top,sourcePosition:r=ce.Bottom})=>K.createElement(K.Fragment,null,K.createElement(xn,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label,K.createElement(xn,{type:"source",position:r,isConnectable:e}));pT.displayName="DefaultNode";var og=D.memo(pT);const mT=({data:t,isConnectable:e,sourcePosition:n=ce.Bottom})=>K.createElement(K.Fragment,null,t==null?void 0:t.label,K.createElement(xn,{type:"source",position:n,isConnectable:e}));mT.displayName="InputNode";var gT=D.memo(mT);const yT=({data:t,isConnectable:e,targetPosition:n=ce.Top})=>K.createElement(K.Fragment,null,K.createElement(xn,{type:"target",position:n,isConnectable:e}),t==null?void 0:t.label);yT.displayName="OutputNode";var vT=D.memo(yT);const Z0=()=>null;Z0.displayName="GroupNode";const r5=t=>({selectedNodes:t.getNodes().filter(e=>e.selected),selectedEdges:t.edges.filter(e=>e.selected).map(e=>({...e}))}),id=t=>t.id;function i5(t,e){return Pt(t.selectedNodes.map(id),e.selectedNodes.map(id))&&Pt(t.selectedEdges.map(id),e.selectedEdges.map(id))}const _T=D.memo(({onSelectionChange:t})=>{const e=wt(),{selectedNodes:n,selectedEdges:r}=qe(r5,i5);return D.useEffect(()=>{const i={nodes:n,edges:r};t==null||t(i),e.getState().onSelectionChange.forEach(s=>s(i))},[n,r,t]),null});_T.displayName="SelectionListener";const s5=t=>!!t.onSelectionChange;function o5({onSelectionChange:t}){const e=qe(s5);return t||e?K.createElement(_T,{onSelectionChange:t}):null}const a5=t=>({setNodes:t.setNodes,setEdges:t.setEdges,setDefaultNodesAndEdges:t.setDefaultNodesAndEdges,setMinZoom:t.setMinZoom,setMaxZoom:t.setMaxZoom,setTranslateExtent:t.setTranslateExtent,setNodeExtent:t.setNodeExtent,reset:t.reset});function Po(t,e){D.useEffect(()=>{typeof t<"u"&&e(t)},[t])}function be(t,e,n){D.useEffect(()=>{typeof e<"u"&&n({[t]:e})},[e])}const l5=({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:i,onConnectStart:s,onConnectEnd:o,onClickConnectStart:a,onClickConnectEnd:l,nodesDraggable:c,nodesConnectable:d,nodesFocusable:h,edgesFocusable:f,edgesUpdatable:m,elevateNodesOnSelect:b,minZoom:x,maxZoom:R,nodeExtent:y,onNodesChange:v,onEdgesChange:T,elementsSelectable:A,connectionMode:O,snapGrid:L,snapToGrid:S,translateExtent:I,connectOnClick:w,defaultEdgeOptions:E,fitView:C,fitViewOptions:N,onNodesDelete:k,onEdgesDelete:P,onNodeDrag:j,onNodeDragStart:z,onNodeDragStop:U,onSelectionDrag:F,onSelectionDragStart:M,onSelectionDragStop:B,noPanClassName:G,nodeOrigin:$,rfId:Y,autoPanOnConnect:X,autoPanOnNodeDrag:ee,onError:re,connectionRadius:fe,isValidConnection:ie,nodeDragThreshold:xe})=>{const{setNodes:ve,setEdges:Re,setDefaultNodesAndEdges:Le,setMinZoom:tt,setMaxZoom:Me,setTranslateExtent:Ve,setNodeExtent:Be,reset:Ee}=qe(a5,Pt),oe=wt();return D.useEffect(()=>{const Ce=r==null?void 0:r.map(St=>({...St,...E}));return Le(n,Ce),()=>{Ee()}},[]),be("defaultEdgeOptions",E,oe.setState),be("connectionMode",O,oe.setState),be("onConnect",i,oe.setState),be("onConnectStart",s,oe.setState),be("onConnectEnd",o,oe.setState),be("onClickConnectStart",a,oe.setState),be("onClickConnectEnd",l,oe.setState),be("nodesDraggable",c,oe.setState),be("nodesConnectable",d,oe.setState),be("nodesFocusable",h,oe.setState),be("edgesFocusable",f,oe.setState),be("edgesUpdatable",m,oe.setState),be("elementsSelectable",A,oe.setState),be("elevateNodesOnSelect",b,oe.setState),be("snapToGrid",S,oe.setState),be("snapGrid",L,oe.setState),be("onNodesChange",v,oe.setState),be("onEdgesChange",T,oe.setState),be("connectOnClick",w,oe.setState),be("fitViewOnInit",C,oe.setState),be("fitViewOnInitOptions",N,oe.setState),be("onNodesDelete",k,oe.setState),be("onEdgesDelete",P,oe.setState),be("onNodeDrag",j,oe.setState),be("onNodeDragStart",z,oe.setState),be("onNodeDragStop",U,oe.setState),be("onSelectionDrag",F,oe.setState),be("onSelectionDragStart",M,oe.setState),be("onSelectionDragStop",B,oe.setState),be("noPanClassName",G,oe.setState),be("nodeOrigin",$,oe.setState),be("rfId",Y,oe.setState),be("autoPanOnConnect",X,oe.setState),be("autoPanOnNodeDrag",ee,oe.setState),be("onError",re,oe.setState),be("connectionRadius",fe,oe.setState),be("isValidConnection",ie,oe.setState),be("nodeDragThreshold",xe,oe.setState),Po(t,ve),Po(e,Re),Po(x,tt),Po(R,Me),Po(I,Ve),Po(y,Be),null},Pw={display:"none"},c5={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},wT="react-flow__node-desc",xT="react-flow__edge-desc",u5="react-flow__aria-live",d5=t=>t.ariaLiveMessage;function h5({rfId:t}){const e=qe(d5);return K.createElement("div",{id:`${u5}-${t}`,"aria-live":"assertive","aria-atomic":"true",style:c5},e)}function f5({rfId:t,disableKeyboardA11y:e}){return K.createElement(K.Fragment,null,K.createElement("div",{id:`${wT}-${t}`,style:Pw},"Press enter or space to select a node.",!e&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),K.createElement("div",{id:`${xT}-${t}`,style:Pw},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!e&&K.createElement(h5,{rfId:t}))}var Bc=(t=null,e={actInsideInputWithModifier:!0})=>{const[n,r]=D.useState(!1),i=D.useRef(!1),s=D.useRef(new Set([])),[o,a]=D.useMemo(()=>{if(t!==null){const c=(Array.isArray(t)?t:[t]).filter(h=>typeof h=="string").map(h=>h.split("+")),d=c.reduce((h,f)=>h.concat(...f),[]);return[c,d]}return[[],[]]},[t]);return D.useEffect(()=>{const l=typeof document<"u"?document:null,c=(e==null?void 0:e.target)||l;if(t!==null){const d=m=>{if(i.current=m.ctrlKey||m.metaKey||m.shiftKey,(!i.current||i.current&&!e.actInsideInputWithModifier)&&rg(m))return!1;const x=Vw(m.code,a);s.current.add(m[x]),Dw(o,s.current,!1)&&(m.preventDefault(),r(!0))},h=m=>{if((!i.current||i.current&&!e.actInsideInputWithModifier)&&rg(m))return!1;const x=Vw(m.code,a);Dw(o,s.current,!0)?(r(!1),s.current.clear()):s.current.delete(m[x]),m.key==="Meta"&&s.current.clear(),i.current=!1},f=()=>{s.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",d),c==null||c.addEventListener("keyup",h),window.addEventListener("blur",f),()=>{c==null||c.removeEventListener("keydown",d),c==null||c.removeEventListener("keyup",h),window.removeEventListener("blur",f)}}},[t,r]),n};function Dw(t,e,n){return t.filter(r=>n||r.length===e.size).some(r=>r.every(i=>e.has(i)))}function Vw(t,e){return e.includes(t)?"code":"key"}function ET(t,e,n,r){var a,l;const i=t.parentNode||t.parentId;if(!i)return n;const s=e.get(i),o=Gs(s,r);return ET(s,e,{x:(n.x??0)+o.x,y:(n.y??0)+o.y,z:(((a=s[ht])==null?void 0:a.z)??0)>(n.z??0)?((l=s[ht])==null?void 0:l.z)??0:n.z??0},r)}function bT(t,e,n){t.forEach(r=>{var s;const i=r.parentNode||r.parentId;if(i&&!t.has(i))throw new Error(`Parent node ${i} not found`);if(i||n!=null&&n[r.id]){const{x:o,y:a,z:l}=ET(r,t,{...r.position,z:((s=r[ht])==null?void 0:s.z)??0},e);r.positionAbsolute={x:o,y:a},r[ht].z=l,n!=null&&n[r.id]&&(r[ht].isParent=!0)}})}function kp(t,e,n,r){const i=new Map,s={},o=r?1e3:0;return t.forEach(a=>{var m;const l=(Kn(a.zIndex)?a.zIndex:0)+(a.selected?o:0),c=e.get(a.id),d={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},h=a.parentNode||a.parentId;h&&(s[h]=!0);const f=(c==null?void 0:c.type)&&(c==null?void 0:c.type)!==a.type;Object.defineProperty(d,ht,{enumerable:!1,value:{handleBounds:f||(m=c==null?void 0:c[ht])==null?void 0:m.handleBounds,z:l}}),i.set(a.id,d)}),bT(i,n,s),i}function IT(t,e={}){const{getNodes:n,width:r,height:i,minZoom:s,maxZoom:o,d3Zoom:a,d3Selection:l,fitViewOnInitDone:c,fitViewOnInit:d,nodeOrigin:h}=t(),f=e.initial&&!c&&d;if(a&&l&&(f||!e.initial)){const b=n().filter(R=>{var v;const y=e.includeHiddenNodes?R.width&&R.height:!R.hidden;return(v=e.nodes)!=null&&v.length?y&&e.nodes.some(T=>T.id===R.id):y}),x=b.every(R=>R.width&&R.height);if(b.length>0&&x){const R=uu(b,h),{x:y,y:v,zoom:T}=cT(R,r,i,e.minZoom??s,e.maxZoom??o,e.padding??.1),A=ri.translate(y,v).scale(T);return typeof e.duration=="number"&&e.duration>0?a.transform(Rs(l,e.duration),A):a.transform(l,A),!0}}return!1}function p5(t,e){return t.forEach(n=>{const r=e.get(n.id);r&&e.set(r.id,{...r,[ht]:r[ht],selected:n.selected})}),new Map(e)}function m5(t,e){return e.map(n=>{const r=t.find(i=>i.id===n.id);return r&&(n.selected=r.selected),n})}function sd({changedNodes:t,changedEdges:e,get:n,set:r}){const{nodeInternals:i,edges:s,onNodesChange:o,onEdgesChange:a,hasDefaultNodes:l,hasDefaultEdges:c}=n();t!=null&&t.length&&(l&&r({nodeInternals:p5(t,i)}),o==null||o(t)),e!=null&&e.length&&(c&&r({edges:m5(e,s)}),a==null||a(e))}const Do=()=>{},g5={zoomIn:Do,zoomOut:Do,zoomTo:Do,getZoom:()=>1,setViewport:Do,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Do,fitBounds:Do,project:t=>t,screenToFlowPosition:t=>t,flowToScreenPosition:t=>t,viewportInitialized:!1},y5=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection}),v5=()=>{const t=wt(),{d3Zoom:e,d3Selection:n}=qe(y5,Pt);return D.useMemo(()=>n&&e?{zoomIn:i=>e.scaleBy(Rs(n,i==null?void 0:i.duration),1.2),zoomOut:i=>e.scaleBy(Rs(n,i==null?void 0:i.duration),1/1.2),zoomTo:(i,s)=>e.scaleTo(Rs(n,s==null?void 0:s.duration),i),getZoom:()=>t.getState().transform[2],setViewport:(i,s)=>{const[o,a,l]=t.getState().transform,c=ri.translate(i.x??o,i.y??a).scale(i.zoom??l);e.transform(Rs(n,s==null?void 0:s.duration),c)},getViewport:()=>{const[i,s,o]=t.getState().transform;return{x:i,y:s,zoom:o}},fitView:i=>IT(t.getState,i),setCenter:(i,s,o)=>{const{width:a,height:l,maxZoom:c}=t.getState(),d=typeof(o==null?void 0:o.zoom)<"u"?o.zoom:c,h=a/2-i*d,f=l/2-s*d,m=ri.translate(h,f).scale(d);e.transform(Rs(n,o==null?void 0:o.duration),m)},fitBounds:(i,s)=>{const{width:o,height:a,minZoom:l,maxZoom:c}=t.getState(),{x:d,y:h,zoom:f}=cT(i,o,a,l,c,(s==null?void 0:s.padding)??.1),m=ri.translate(d,h).scale(f);e.transform(Rs(n,s==null?void 0:s.duration),m)},project:i=>{const{transform:s,snapToGrid:o,snapGrid:a}=t.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),sg(i,s,o,a)},screenToFlowPosition:i=>{const{transform:s,snapToGrid:o,snapGrid:a,domNode:l}=t.getState();if(!l)return i;const{x:c,y:d}=l.getBoundingClientRect(),h={x:i.x-c,y:i.y-d};return sg(h,s,o,a)},flowToScreenPosition:i=>{const{transform:s,domNode:o}=t.getState();if(!o)return i;const{x:a,y:l}=o.getBoundingClientRect(),c=oT(i,s);return{x:c.x+a,y:c.y+l}},viewportInitialized:!0}:g5,[e,n])};function Lr(){const t=v5(),e=wt(),n=D.useCallback(()=>e.getState().getNodes().map(x=>({...x})),[]),r=D.useCallback(x=>e.getState().nodeInternals.get(x),[]),i=D.useCallback(()=>{const{edges:x=[]}=e.getState();return x.map(R=>({...R}))},[]),s=D.useCallback(x=>{const{edges:R=[]}=e.getState();return R.find(y=>y.id===x)},[]),o=D.useCallback(x=>{const{getNodes:R,setNodes:y,hasDefaultNodes:v,onNodesChange:T}=e.getState(),A=R(),O=typeof x=="function"?x(A):x;if(v)y(O);else if(T){const L=O.length===0?A.map(S=>({type:"remove",id:S.id})):O.map(S=>({item:S,type:"reset"}));T(L)}},[]),a=D.useCallback(x=>{const{edges:R=[],setEdges:y,hasDefaultEdges:v,onEdgesChange:T}=e.getState(),A=typeof x=="function"?x(R):x;if(v)y(A);else if(T){const O=A.length===0?R.map(L=>({type:"remove",id:L.id})):A.map(L=>({item:L,type:"reset"}));T(O)}},[]),l=D.useCallback(x=>{const R=Array.isArray(x)?x:[x],{getNodes:y,setNodes:v,hasDefaultNodes:T,onNodesChange:A}=e.getState();if(T){const L=[...y(),...R];v(L)}else if(A){const O=R.map(L=>({item:L,type:"add"}));A(O)}},[]),c=D.useCallback(x=>{const R=Array.isArray(x)?x:[x],{edges:y=[],setEdges:v,hasDefaultEdges:T,onEdgesChange:A}=e.getState();if(T)v([...y,...R]);else if(A){const O=R.map(L=>({item:L,type:"add"}));A(O)}},[]),d=D.useCallback(()=>{const{getNodes:x,edges:R=[],transform:y}=e.getState(),[v,T,A]=y;return{nodes:x().map(O=>({...O})),edges:R.map(O=>({...O})),viewport:{x:v,y:T,zoom:A}}},[]),h=D.useCallback(({nodes:x,edges:R})=>{const{nodeInternals:y,getNodes:v,edges:T,hasDefaultNodes:A,hasDefaultEdges:O,onNodesDelete:L,onEdgesDelete:S,onNodesChange:I,onEdgesChange:w}=e.getState(),E=(x||[]).map(j=>j.id),C=(R||[]).map(j=>j.id),N=v().reduce((j,z)=>{const U=z.parentNode||z.parentId,F=!E.includes(z.id)&&U&&j.find(B=>B.id===U);return(typeof z.deletable=="boolean"?z.deletable:!0)&&(E.includes(z.id)||F)&&j.push(z),j},[]),k=T.filter(j=>typeof j.deletable=="boolean"?j.deletable:!0),P=k.filter(j=>C.includes(j.id));if(N||P){const j=lT(N,k),z=[...P,...j],U=z.reduce((F,M)=>(F.includes(M.id)||F.push(M.id),F),[]);if((O||A)&&(O&&e.setState({edges:T.filter(F=>!U.includes(F.id))}),A&&(N.forEach(F=>{y.delete(F.id)}),e.setState({nodeInternals:new Map(y)}))),U.length>0&&(S==null||S(z),w&&w(U.map(F=>({id:F,type:"remove"})))),N.length>0&&(L==null||L(N),I)){const F=N.map(M=>({id:M.id,type:"remove"}));I(F)}}},[]),f=D.useCallback(x=>{const R=$4(x),y=R?null:e.getState().nodeInternals.get(x.id);return!R&&!y?[null,null,R]:[R?x:Tw(y),y,R]},[]),m=D.useCallback((x,R=!0,y)=>{const[v,T,A]=f(x);return v?(y||e.getState().getNodes()).filter(O=>{if(!A&&(O.id===T.id||!O.positionAbsolute))return!1;const L=Tw(O),S=ng(L,v);return R&&S>0||S>=v.width*v.height}):[]},[]),b=D.useCallback((x,R,y=!0)=>{const[v]=f(x);if(!v)return!1;const T=ng(v,R);return y&&T>0||T>=v.width*v.height},[]);return D.useMemo(()=>({...t,getNodes:n,getNode:r,getEdges:i,getEdge:s,setNodes:o,setEdges:a,addNodes:l,addEdges:c,toObject:d,deleteElements:h,getIntersectingNodes:m,isNodeIntersecting:b}),[t,n,r,i,s,o,a,l,c,d,h,m,b])}const _5={actInsideInputWithModifier:!1};var w5=({deleteKeyCode:t,multiSelectionKeyCode:e})=>{const n=wt(),{deleteElements:r}=Lr(),i=Bc(t,_5),s=Bc(e);D.useEffect(()=>{if(i){const{edges:o,getNodes:a}=n.getState(),l=a().filter(d=>d.selected),c=o.filter(d=>d.selected);r({nodes:l,edges:c}),n.setState({nodesSelectionActive:!1})}},[i]),D.useEffect(()=>{n.setState({multiSelectionActive:s})},[s])};function x5(t){const e=wt();D.useEffect(()=>{let n;const r=()=>{var s,o;if(!t.current)return;const i=q0(t.current);(i.height===0||i.width===0)&&((o=(s=e.getState()).onError)==null||o.call(s,"004",ui.error004())),e.setState({width:i.width||500,height:i.height||500})};return r(),window.addEventListener("resize",r),t.current&&(n=new ResizeObserver(()=>r()),n.observe(t.current)),()=>{window.removeEventListener("resize",r),n&&t.current&&n.unobserve(t.current)}},[])}const ey={position:"absolute",width:"100%",height:"100%",top:0,left:0},E5=(t,e)=>t.x!==e.x||t.y!==e.y||t.zoom!==e.k,od=t=>({x:t.x,y:t.y,zoom:t.k}),Vo=(t,e)=>t.target.closest(`.${e}`),Ow=(t,e)=>e===2&&Array.isArray(t)&&t.includes(2),zw=t=>{const e=t.ctrlKey&&bh()?10:1;return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*e},b5=t=>({d3Zoom:t.d3Zoom,d3Selection:t.d3Selection,d3ZoomHandler:t.d3ZoomHandler,userSelectionActive:t.userSelectionActive}),I5=({onMove:t,onMoveStart:e,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:i=!0,zoomOnPinch:s=!0,panOnScroll:o=!1,panOnScrollSpeed:a=.5,panOnScrollMode:l=$s.Free,zoomOnDoubleClick:c=!0,elementsSelectable:d,panOnDrag:h=!0,defaultViewport:f,translateExtent:m,minZoom:b,maxZoom:x,zoomActivationKeyCode:R,preventScrolling:y=!0,children:v,noWheelClassName:T,noPanClassName:A})=>{const O=D.useRef(),L=wt(),S=D.useRef(!1),I=D.useRef(!1),w=D.useRef(null),E=D.useRef({x:0,y:0,zoom:0}),{d3Zoom:C,d3Selection:N,d3ZoomHandler:k,userSelectionActive:P}=qe(b5,Pt),j=Bc(R),z=D.useRef(0),U=D.useRef(!1),F=D.useRef();return x5(w),D.useEffect(()=>{if(w.current){const M=w.current.getBoundingClientRect(),B=KI().scaleExtent([b,x]).translateExtent(m),G=Cn(w.current).call(B),$=ri.translate(f.x,f.y).scale(os(f.zoom,b,x)),Y=[[0,0],[M.width,M.height]],X=B.constrain()($,Y,m);B.transform(G,X),B.wheelDelta(zw),L.setState({d3Zoom:B,d3Selection:G,d3ZoomHandler:G.on("wheel.zoom"),transform:[X.x,X.y,X.k],domNode:w.current.closest(".react-flow")})}},[]),D.useEffect(()=>{N&&C&&(o&&!j&&!P?N.on("wheel.zoom",M=>{if(Vo(M,T))return!1;M.preventDefault(),M.stopImmediatePropagation();const B=N.property("__zoom").k||1;if(M.ctrlKey&&s){const ie=or(M),xe=zw(M),ve=B*Math.pow(2,xe);C.scaleTo(N,ve,ie,M);return}const G=M.deltaMode===1?20:1;let $=l===$s.Vertical?0:M.deltaX*G,Y=l===$s.Horizontal?0:M.deltaY*G;!bh()&&M.shiftKey&&l!==$s.Vertical&&($=M.deltaY*G,Y=0),C.translateBy(N,-($/B)*a,-(Y/B)*a,{internal:!0});const X=od(N.property("__zoom")),{onViewportChangeStart:ee,onViewportChange:re,onViewportChangeEnd:fe}=L.getState();clearTimeout(F.current),U.current||(U.current=!0,e==null||e(M,X),ee==null||ee(X)),U.current&&(t==null||t(M,X),re==null||re(X),F.current=setTimeout(()=>{n==null||n(M,X),fe==null||fe(X),U.current=!1},150))},{passive:!1}):typeof k<"u"&&N.on("wheel.zoom",function(M,B){if(!y&&M.type==="wheel"&&!M.ctrlKey||Vo(M,T))return null;M.preventDefault(),k.call(this,M,B)},{passive:!1}))},[P,o,l,N,C,k,j,s,y,T,e,t,n]),D.useEffect(()=>{C&&C.on("start",M=>{var $,Y;if(!M.sourceEvent||M.sourceEvent.internal)return null;z.current=($=M.sourceEvent)==null?void 0:$.button;const{onViewportChangeStart:B}=L.getState(),G=od(M.transform);S.current=!0,E.current=G,((Y=M.sourceEvent)==null?void 0:Y.type)==="mousedown"&&L.setState({paneDragging:!0}),B==null||B(G),e==null||e(M.sourceEvent,G)})},[C,e]),D.useEffect(()=>{C&&(P&&!S.current?C.on("zoom",null):P||C.on("zoom",M=>{var G;const{onViewportChange:B}=L.getState();if(L.setState({transform:[M.transform.x,M.transform.y,M.transform.k]}),I.current=!!(r&&Ow(h,z.current??0)),(t||B)&&!((G=M.sourceEvent)!=null&&G.internal)){const $=od(M.transform);B==null||B($),t==null||t(M.sourceEvent,$)}}))},[P,C,t,h,r]),D.useEffect(()=>{C&&C.on("end",M=>{if(!M.sourceEvent||M.sourceEvent.internal)return null;const{onViewportChangeEnd:B}=L.getState();if(S.current=!1,L.setState({paneDragging:!1}),r&&Ow(h,z.current??0)&&!I.current&&r(M.sourceEvent),I.current=!1,(n||B)&&E5(E.current,M.transform)){const G=od(M.transform);E.current=G,clearTimeout(O.current),O.current=setTimeout(()=>{B==null||B(G),n==null||n(M.sourceEvent,G)},o?150:0)}})},[C,o,h,n,r]),D.useEffect(()=>{C&&C.filter(M=>{const B=j||i,G=s&&M.ctrlKey;if((h===!0||Array.isArray(h)&&h.includes(1))&&M.button===1&&M.type==="mousedown"&&(Vo(M,"react-flow__node")||Vo(M,"react-flow__edge")))return!0;if(!h&&!B&&!o&&!c&&!s||P||!c&&M.type==="dblclick"||Vo(M,T)&&M.type==="wheel"||Vo(M,A)&&(M.type!=="wheel"||o&&M.type==="wheel"&&!j)||!s&&M.ctrlKey&&M.type==="wheel"||!B&&!o&&!G&&M.type==="wheel"||!h&&(M.type==="mousedown"||M.type==="touchstart")||Array.isArray(h)&&!h.includes(M.button)&&M.type==="mousedown")return!1;const $=Array.isArray(h)&&h.includes(M.button)||!M.button||M.button<=1;return(!M.ctrlKey||M.type==="wheel")&&$})},[P,C,i,s,o,c,h,d,j]),K.createElement("div",{className:"react-flow__renderer",ref:w,style:ey},v)},T5=t=>({userSelectionActive:t.userSelectionActive,userSelectionRect:t.userSelectionRect});function S5(){const{userSelectionActive:t,userSelectionRect:e}=qe(T5,Pt);return t&&e?K.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:e.width,height:e.height,transform:`translate(${e.x}px, ${e.y}px)`}}):null}function Lw(t,e){const n=e.parentNode||e.parentId,r=t.find(i=>i.id===n);if(r){const i=e.position.x+e.width-r.width,s=e.position.y+e.height-r.height;if(i>0||s>0||e.position.x<0||e.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,i>0&&(r.style.width+=i),s>0&&(r.style.height+=s),e.position.x<0){const o=Math.abs(e.position.x);r.position.x=r.position.x-o,r.style.width+=o,e.position.x=0}if(e.position.y<0){const o=Math.abs(e.position.y);r.position.y=r.position.y-o,r.style.height+=o,e.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function TT(t,e){if(t.some(r=>r.type==="reset"))return t.filter(r=>r.type==="reset").map(r=>r.item);const n=t.filter(r=>r.type==="add").map(r=>r.item);return e.reduce((r,i)=>{const s=t.filter(a=>a.id===i.id);if(s.length===0)return r.push(i),r;const o={...i};for(const a of s)if(a)switch(a.type){case"select":{o.selected=a.selected;break}case"position":{typeof a.position<"u"&&(o.position=a.position),typeof a.positionAbsolute<"u"&&(o.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(o.dragging=a.dragging),o.expandParent&&Lw(r,o);break}case"dimensions":{typeof a.dimensions<"u"&&(o.width=a.dimensions.width,o.height=a.dimensions.height),typeof a.updateStyle<"u"&&(o.style={...o.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(o.resizing=a.resizing),o.expandParent&&Lw(r,o);break}case"remove":return r}return r.push(o),r},n)}function ST(t,e){return TT(t,e)}function C5(t,e){return TT(t,e)}const Di=(t,e)=>({id:t,type:"select",selected:e});function oa(t,e){return t.reduce((n,r)=>{const i=e.includes(r.id);return!r.selected&&i?(r.selected=!0,n.push(Di(r.id,!0))):r.selected&&!i&&(r.selected=!1,n.push(Di(r.id,!1))),n},[])}const Rp=(t,e)=>n=>{n.target===e.current&&(t==null||t(n))},A5=t=>({userSelectionActive:t.userSelectionActive,elementsSelectable:t.elementsSelectable,dragging:t.paneDragging}),CT=D.memo(({isSelecting:t,selectionMode:e=$c.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:i,onPaneClick:s,onPaneContextMenu:o,onPaneScroll:a,onPaneMouseEnter:l,onPaneMouseMove:c,onPaneMouseLeave:d,children:h})=>{const f=D.useRef(null),m=wt(),b=D.useRef(0),x=D.useRef(0),R=D.useRef(),{userSelectionActive:y,elementsSelectable:v,dragging:T}=qe(A5,Pt),A=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),b.current=0,x.current=0},O=k=>{s==null||s(k),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},L=k=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){k.preventDefault();return}o==null||o(k)},S=a?k=>a(k):void 0,I=k=>{const{resetSelectedElements:P,domNode:j}=m.getState();if(R.current=j==null?void 0:j.getBoundingClientRect(),!v||!t||k.button!==0||k.target!==f.current||!R.current)return;const{x:z,y:U}=Ji(k,R.current);P(),m.setState({userSelectionRect:{width:0,height:0,startX:z,startY:U,x:z,y:U}}),r==null||r(k)},w=k=>{const{userSelectionRect:P,nodeInternals:j,edges:z,transform:U,onNodesChange:F,onEdgesChange:M,nodeOrigin:B,getNodes:G}=m.getState();if(!t||!R.current||!P)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const $=Ji(k,R.current),Y=P.startX??0,X=P.startY??0,ee={...P,x:$.x<Y?$.x:Y,y:$.y<X?$.y:X,width:Math.abs($.x-Y),height:Math.abs($.y-X)},re=G(),fe=aT(j,ee,U,e===$c.Partial,!0,B),ie=lT(fe,z).map(ve=>ve.id),xe=fe.map(ve=>ve.id);if(b.current!==xe.length){b.current=xe.length;const ve=oa(re,xe);ve.length&&(F==null||F(ve))}if(x.current!==ie.length){x.current=ie.length;const ve=oa(z,ie);ve.length&&(M==null||M(ve))}m.setState({userSelectionRect:ee})},E=k=>{if(k.button!==0)return;const{userSelectionRect:P}=m.getState();!y&&P&&k.target===f.current&&(O==null||O(k)),m.setState({nodesSelectionActive:b.current>0}),A(),i==null||i(k)},C=k=>{y&&(m.setState({nodesSelectionActive:b.current>0}),i==null||i(k)),A()},N=v&&(t||y);return K.createElement("div",{className:Vt(["react-flow__pane",{dragging:T,selection:t}]),onClick:N?void 0:Rp(O,f),onContextMenu:Rp(L,f),onWheel:Rp(S,f),onMouseEnter:N?void 0:l,onMouseDown:N?I:void 0,onMouseMove:N?w:c,onMouseUp:N?E:void 0,onMouseLeave:N?C:d,ref:f,style:ey},h,K.createElement(S5,null))});CT.displayName="Pane";function AT(t,e){const n=t.parentNode||t.parentId;if(!n)return!1;const r=e.get(n);return r?r.selected?!0:AT(r,e):!1}function Mw(t,e,n){let r=t;do{if(r!=null&&r.matches(e))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function k5(t,e,n,r){return Array.from(t.values()).filter(i=>(i.selected||i.id===r)&&(!i.parentNode||i.parentId||!AT(i,t))&&(i.draggable||e&&typeof i.draggable>"u")).map(i=>{var s,o;return{id:i.id,position:i.position||{x:0,y:0},positionAbsolute:i.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((s=i.positionAbsolute)==null?void 0:s.x)??0),y:n.y-(((o=i.positionAbsolute)==null?void 0:o.y)??0)},delta:{x:0,y:0},extent:i.extent,parentNode:i.parentNode||i.parentId,parentId:i.parentNode||i.parentId,width:i.width,height:i.height,expandParent:i.expandParent}})}function R5(t,e){return!e||e==="parent"?e:[e[0],[e[1][0]-(t.width||0),e[1][1]-(t.height||0)]]}function kT(t,e,n,r,i=[0,0],s){const o=R5(t,t.extent||r);let a=o;const l=t.parentNode||t.parentId;if(t.extent==="parent"&&!t.expandParent)if(l&&t.width&&t.height){const h=n.get(l),{x:f,y:m}=Gs(h,i).positionAbsolute;a=h&&Kn(f)&&Kn(m)&&Kn(h.width)&&Kn(h.height)?[[f+t.width*i[0],m+t.height*i[1]],[f+h.width-t.width+t.width*i[0],m+h.height-t.height+t.height*i[1]]]:a}else s==null||s("005",ui.error005()),a=o;else if(t.extent&&l&&t.extent!=="parent"){const h=n.get(l),{x:f,y:m}=Gs(h,i).positionAbsolute;a=[[t.extent[0][0]+f,t.extent[0][1]+m],[t.extent[1][0]+f,t.extent[1][1]+m]]}let c={x:0,y:0};if(l){const h=n.get(l);c=Gs(h,i).positionAbsolute}const d=a&&a!=="parent"?K0(e,a):e;return{position:{x:d.x-c.x,y:d.y-c.y},positionAbsolute:d}}function Np({nodeId:t,dragItems:e,nodeInternals:n}){const r=e.map(i=>({...n.get(i.id),position:i.position,positionAbsolute:i.positionAbsolute}));return[t?r.find(i=>i.id===t):r[0],r]}const jw=(t,e,n,r)=>{const i=e.querySelectorAll(t);if(!i||!i.length)return null;const s=Array.from(i),o=e.getBoundingClientRect(),a={x:o.width*r[0],y:o.height*r[1]};return s.map(l=>{const c=l.getBoundingClientRect();return{id:l.getAttribute("data-handleid"),position:l.getAttribute("data-handlepos"),x:(c.left-o.left-a.x)/n,y:(c.top-o.top-a.y)/n,...q0(l)}})};function Dl(t,e,n){return n===void 0?n:r=>{const i=e().nodeInternals.get(t);i&&n(r,{...i})}}function ag({id:t,store:e,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:i,unselectNodesAndEdges:s,multiSelectionActive:o,nodeInternals:a,onError:l}=e.getState(),c=a.get(t);if(!c){l==null||l("012",ui.error012(t));return}e.setState({nodesSelectionActive:!1}),c.selected?(n||c.selected&&o)&&(s({nodes:[c],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):i([t])}function RT(){const t=wt();return D.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:i,snapToGrid:s}=t.getState(),o=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,l={x:(o-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:s?i[0]*Math.round(l.x/i[0]):l.x,ySnapped:s?i[1]*Math.round(l.y/i[1]):l.y,...l}},[])}function Pp(t){return(e,n,r)=>t==null?void 0:t(e,r)}function NT({nodeRef:t,disabled:e=!1,noDragClassName:n,handleSelector:r,nodeId:i,isSelectable:s,selectNodesOnDrag:o}){const a=wt(),[l,c]=D.useState(!1),d=D.useRef([]),h=D.useRef({x:null,y:null}),f=D.useRef(0),m=D.useRef(null),b=D.useRef({x:0,y:0}),x=D.useRef(null),R=D.useRef(!1),y=D.useRef(!1),v=D.useRef(!1),T=RT();return D.useEffect(()=>{if(t!=null&&t.current){const A=Cn(t.current),O=({x:I,y:w})=>{const{nodeInternals:E,onNodeDrag:C,onSelectionDrag:N,updateNodePositions:k,nodeExtent:P,snapGrid:j,snapToGrid:z,nodeOrigin:U,onError:F}=a.getState();h.current={x:I,y:w};let M=!1,B={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&P){const $=uu(d.current,U);B=Fc($)}if(d.current=d.current.map($=>{const Y={x:I-$.distance.x,y:w-$.distance.y};z&&(Y.x=j[0]*Math.round(Y.x/j[0]),Y.y=j[1]*Math.round(Y.y/j[1]));const X=[[P[0][0],P[0][1]],[P[1][0],P[1][1]]];d.current.length>1&&P&&!$.extent&&(X[0][0]=$.positionAbsolute.x-B.x+P[0][0],X[1][0]=$.positionAbsolute.x+($.width??0)-B.x2+P[1][0],X[0][1]=$.positionAbsolute.y-B.y+P[0][1],X[1][1]=$.positionAbsolute.y+($.height??0)-B.y2+P[1][1]);const ee=kT($,Y,E,X,U,F);return M=M||$.position.x!==ee.position.x||$.position.y!==ee.position.y,$.position=ee.position,$.positionAbsolute=ee.positionAbsolute,$}),!M)return;k(d.current,!0,!0),c(!0);const G=i?C:Pp(N);if(G&&x.current){const[$,Y]=Np({nodeId:i,dragItems:d.current,nodeInternals:E});G(x.current,$,Y)}},L=()=>{if(!m.current)return;const[I,w]=WI(b.current,m.current);if(I!==0||w!==0){const{transform:E,panBy:C}=a.getState();h.current.x=(h.current.x??0)-I/E[2],h.current.y=(h.current.y??0)-w/E[2],C({x:I,y:w})&&O(h.current)}f.current=requestAnimationFrame(L)},S=I=>{var U;const{nodeInternals:w,multiSelectionActive:E,nodesDraggable:C,unselectNodesAndEdges:N,onNodeDragStart:k,onSelectionDragStart:P}=a.getState();y.current=!0;const j=i?k:Pp(P);(!o||!s)&&!E&&i&&((U=w.get(i))!=null&&U.selected||N()),i&&s&&o&&ag({id:i,store:a,nodeRef:t});const z=T(I);if(h.current=z,d.current=k5(w,C,z,i),j&&d.current){const[F,M]=Np({nodeId:i,dragItems:d.current,nodeInternals:w});j(I.sourceEvent,F,M)}};if(e)A.on(".drag",null);else{const I=PI().on("start",w=>{const{domNode:E,nodeDragThreshold:C}=a.getState();C===0&&S(w),v.current=!1;const N=T(w);h.current=N,m.current=(E==null?void 0:E.getBoundingClientRect())||null,b.current=Ji(w.sourceEvent,m.current)}).on("drag",w=>{var k,P;const E=T(w),{autoPanOnNodeDrag:C,nodeDragThreshold:N}=a.getState();if(w.sourceEvent.type==="touchmove"&&w.sourceEvent.touches.length>1&&(v.current=!0),!v.current){if(!R.current&&y.current&&C&&(R.current=!0,L()),!y.current){const j=E.xSnapped-(((k=h==null?void 0:h.current)==null?void 0:k.x)??0),z=E.ySnapped-(((P=h==null?void 0:h.current)==null?void 0:P.y)??0);Math.sqrt(j*j+z*z)>N&&S(w)}(h.current.x!==E.xSnapped||h.current.y!==E.ySnapped)&&d.current&&y.current&&(x.current=w.sourceEvent,b.current=Ji(w.sourceEvent,m.current),O(E))}}).on("end",w=>{if(!(!y.current||v.current)&&(c(!1),R.current=!1,y.current=!1,cancelAnimationFrame(f.current),d.current)){const{updateNodePositions:E,nodeInternals:C,onNodeDragStop:N,onSelectionDragStop:k}=a.getState(),P=i?N:Pp(k);if(E(d.current,!1,!1),P){const[j,z]=Np({nodeId:i,dragItems:d.current,nodeInternals:C});P(w.sourceEvent,j,z)}}}).filter(w=>{const E=w.target;return!w.button&&(!n||!Mw(E,`.${n}`,t))&&(!r||Mw(E,r,t))});return A.call(I),()=>{A.on(".drag",null)}}}},[t,e,n,r,s,a,i,o,T]),l}function PT(){const t=wt();return D.useCallback(n=>{const{nodeInternals:r,nodeExtent:i,updateNodePositions:s,getNodes:o,snapToGrid:a,snapGrid:l,onError:c,nodesDraggable:d}=t.getState(),h=o().filter(v=>v.selected&&(v.draggable||d&&typeof v.draggable>"u")),f=a?l[0]:5,m=a?l[1]:5,b=n.isShiftPressed?4:1,x=n.x*f*b,R=n.y*m*b,y=h.map(v=>{if(v.positionAbsolute){const T={x:v.positionAbsolute.x+x,y:v.positionAbsolute.y+R};a&&(T.x=l[0]*Math.round(T.x/l[0]),T.y=l[1]*Math.round(T.y/l[1]));const{positionAbsolute:A,position:O}=kT(v,T,r,i,void 0,c);v.position=O,v.positionAbsolute=A}return v});s(y,!0,!1)},[])}const ma={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Vl=t=>{const e=({id:n,type:r,data:i,xPos:s,yPos:o,xPosOrigin:a,yPosOrigin:l,selected:c,onClick:d,onMouseEnter:h,onMouseMove:f,onMouseLeave:m,onContextMenu:b,onDoubleClick:x,style:R,className:y,isDraggable:v,isSelectable:T,isConnectable:A,isFocusable:O,selectNodesOnDrag:L,sourcePosition:S,targetPosition:I,hidden:w,resizeObserver:E,dragHandle:C,zIndex:N,isParent:k,noDragClassName:P,noPanClassName:j,initialized:z,disableKeyboardA11y:U,ariaLabel:F,rfId:M,hasHandleBounds:B})=>{const G=wt(),$=D.useRef(null),Y=D.useRef(null),X=D.useRef(S),ee=D.useRef(I),re=D.useRef(r),fe=T||v||d||h||f||m,ie=PT(),xe=Dl(n,G.getState,h),ve=Dl(n,G.getState,f),Re=Dl(n,G.getState,m),Le=Dl(n,G.getState,b),tt=Dl(n,G.getState,x),Me=Ee=>{const{nodeDragThreshold:oe}=G.getState();if(T&&(!L||!v||oe>0)&&ag({id:n,store:G,nodeRef:$}),d){const Ce=G.getState().nodeInternals.get(n);Ce&&d(Ee,{...Ce})}},Ve=Ee=>{if(!rg(Ee)&&!U)if(JI.includes(Ee.key)&&T){const oe=Ee.key==="Escape";ag({id:n,store:G,unselect:oe,nodeRef:$})}else v&&c&&Object.prototype.hasOwnProperty.call(ma,Ee.key)&&(G.setState({ariaLiveMessage:`Moved selected node ${Ee.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~s}, y: ${~~o}`}),ie({x:ma[Ee.key].x,y:ma[Ee.key].y,isShiftPressed:Ee.shiftKey}))};D.useEffect(()=>()=>{Y.current&&(E==null||E.unobserve(Y.current),Y.current=null)},[]),D.useEffect(()=>{if($.current&&!w){const Ee=$.current;(!z||!B||Y.current!==Ee)&&(Y.current&&(E==null||E.unobserve(Y.current)),E==null||E.observe(Ee),Y.current=Ee)}},[w,z,B]),D.useEffect(()=>{const Ee=re.current!==r,oe=X.current!==S,Ce=ee.current!==I;$.current&&(Ee||oe||Ce)&&(Ee&&(re.current=r),oe&&(X.current=S),Ce&&(ee.current=I),G.getState().updateNodeDimensions([{id:n,nodeElement:$.current,forceUpdate:!0}]))},[n,r,S,I]);const Be=NT({nodeRef:$,disabled:w||!v,noDragClassName:P,handleSelector:C,nodeId:n,isSelectable:T,selectNodesOnDrag:L});return w?null:K.createElement("div",{className:Vt(["react-flow__node",`react-flow__node-${r}`,{[j]:v},y,{selected:c,selectable:T,parent:k,dragging:Be}]),ref:$,style:{zIndex:N,transform:`translate(${a}px,${l}px)`,pointerEvents:fe?"all":"none",visibility:z?"visible":"hidden",...R},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:xe,onMouseMove:ve,onMouseLeave:Re,onContextMenu:Le,onClick:Me,onDoubleClick:tt,onKeyDown:O?Ve:void 0,tabIndex:O?0:void 0,role:O?"button":void 0,"aria-describedby":U?void 0:`${wT}-${M}`,"aria-label":F},K.createElement(G4,{value:n},K.createElement(t,{id:n,data:i,type:r,xPos:s,yPos:o,selected:c,isConnectable:A,sourcePosition:S,targetPosition:I,dragging:Be,dragHandle:C,zIndex:N})))};return e.displayName="NodeWrapper",D.memo(e)};const N5=t=>{const e=t.getNodes().filter(n=>n.selected);return{...uu(e,t.nodeOrigin),transformString:`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`,userSelectionActive:t.userSelectionActive}};function P5({onSelectionContextMenu:t,noPanClassName:e,disableKeyboardA11y:n}){const r=wt(),{width:i,height:s,x:o,y:a,transformString:l,userSelectionActive:c}=qe(N5,Pt),d=PT(),h=D.useRef(null);if(D.useEffect(()=>{var b;n||(b=h.current)==null||b.focus({preventScroll:!0})},[n]),NT({nodeRef:h}),c||!i||!s)return null;const f=t?b=>{const x=r.getState().getNodes().filter(R=>R.selected);t(b,x)}:void 0,m=b=>{Object.prototype.hasOwnProperty.call(ma,b.key)&&d({x:ma[b.key].x,y:ma[b.key].y,isShiftPressed:b.shiftKey})};return K.createElement("div",{className:Vt(["react-flow__nodesselection","react-flow__container",e]),style:{transform:l}},K.createElement("div",{ref:h,className:"react-flow__nodesselection-rect",onContextMenu:f,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:i,height:s,top:a,left:o}}))}var D5=D.memo(P5);const V5=t=>t.nodesSelectionActive,DT=({children:t,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,deleteKeyCode:a,onMove:l,onMoveStart:c,onMoveEnd:d,selectionKeyCode:h,selectionOnDrag:f,selectionMode:m,onSelectionStart:b,onSelectionEnd:x,multiSelectionKeyCode:R,panActivationKeyCode:y,zoomActivationKeyCode:v,elementsSelectable:T,zoomOnScroll:A,zoomOnPinch:O,panOnScroll:L,panOnScrollSpeed:S,panOnScrollMode:I,zoomOnDoubleClick:w,panOnDrag:E,defaultViewport:C,translateExtent:N,minZoom:k,maxZoom:P,preventScrolling:j,onSelectionContextMenu:z,noWheelClassName:U,noPanClassName:F,disableKeyboardA11y:M})=>{const B=qe(V5),G=Bc(h),$=Bc(y),Y=$||E,X=$||L,ee=G||f&&Y!==!0;return w5({deleteKeyCode:a,multiSelectionKeyCode:R}),K.createElement(I5,{onMove:l,onMoveStart:c,onMoveEnd:d,onPaneContextMenu:s,elementsSelectable:T,zoomOnScroll:A,zoomOnPinch:O,panOnScroll:X,panOnScrollSpeed:S,panOnScrollMode:I,zoomOnDoubleClick:w,panOnDrag:!G&&Y,defaultViewport:C,translateExtent:N,minZoom:k,maxZoom:P,zoomActivationKeyCode:v,preventScrolling:j,noWheelClassName:U,noPanClassName:F},K.createElement(CT,{onSelectionStart:b,onSelectionEnd:x,onPaneClick:e,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:i,onPaneContextMenu:s,onPaneScroll:o,panOnDrag:Y,isSelecting:!!ee,selectionMode:m},t,B&&K.createElement(D5,{onSelectionContextMenu:z,noPanClassName:F,disableKeyboardA11y:M})))};DT.displayName="FlowRenderer";var O5=D.memo(DT);function z5(t){return qe(D.useCallback(n=>t?aT(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[t]))}function L5(t){const e={input:Vl(t.input||gT),default:Vl(t.default||og),output:Vl(t.output||vT),group:Vl(t.group||Z0)},n={},r=Object.keys(t).filter(i=>!["input","default","output","group"].includes(i)).reduce((i,s)=>(i[s]=Vl(t[s]||og),i),n);return{...e,...r}}const M5=({x:t,y:e,width:n,height:r,origin:i})=>!n||!r?{x:t,y:e}:i[0]<0||i[1]<0||i[0]>1||i[1]>1?{x:t,y:e}:{x:t-n*i[0],y:e-r*i[1]},j5=t=>({nodesDraggable:t.nodesDraggable,nodesConnectable:t.nodesConnectable,nodesFocusable:t.nodesFocusable,elementsSelectable:t.elementsSelectable,updateNodeDimensions:t.updateNodeDimensions,onError:t.onError}),VT=t=>{const{nodesDraggable:e,nodesConnectable:n,nodesFocusable:r,elementsSelectable:i,updateNodeDimensions:s,onError:o}=qe(j5,Pt),a=z5(t.onlyRenderVisibleElements),l=D.useRef(),c=D.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(h=>{const f=h.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));s(f)});return l.current=d,d},[]);return D.useEffect(()=>()=>{var d;(d=l==null?void 0:l.current)==null||d.disconnect()},[]),K.createElement("div",{className:"react-flow__nodes",style:ey},a.map(d=>{var O,L,S;let h=d.type||"default";t.nodeTypes[h]||(o==null||o("003",ui.error003(h)),h="default");const f=t.nodeTypes[h]||t.nodeTypes.default,m=!!(d.draggable||e&&typeof d.draggable>"u"),b=!!(d.selectable||i&&typeof d.selectable>"u"),x=!!(d.connectable||n&&typeof d.connectable>"u"),R=!!(d.focusable||r&&typeof d.focusable>"u"),y=t.nodeExtent?K0(d.positionAbsolute,t.nodeExtent):d.positionAbsolute,v=(y==null?void 0:y.x)??0,T=(y==null?void 0:y.y)??0,A=M5({x:v,y:T,width:d.width??0,height:d.height??0,origin:t.nodeOrigin});return K.createElement(f,{key:d.id,id:d.id,className:d.className,style:d.style,type:h,data:d.data,sourcePosition:d.sourcePosition||ce.Bottom,targetPosition:d.targetPosition||ce.Top,hidden:d.hidden,xPos:v,yPos:T,xPosOrigin:A.x,yPosOrigin:A.y,selectNodesOnDrag:t.selectNodesOnDrag,onClick:t.onNodeClick,onMouseEnter:t.onNodeMouseEnter,onMouseMove:t.onNodeMouseMove,onMouseLeave:t.onNodeMouseLeave,onContextMenu:t.onNodeContextMenu,onDoubleClick:t.onNodeDoubleClick,selected:!!d.selected,isDraggable:m,isSelectable:b,isConnectable:x,isFocusable:R,resizeObserver:c,dragHandle:d.dragHandle,zIndex:((O=d[ht])==null?void 0:O.z)??0,isParent:!!((L=d[ht])!=null&&L.isParent),noDragClassName:t.noDragClassName,noPanClassName:t.noPanClassName,initialized:!!d.width&&!!d.height,rfId:t.rfId,disableKeyboardA11y:t.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((S=d[ht])!=null&&S.handleBounds)})}))};VT.displayName="NodeRenderer";var F5=D.memo(VT);const $5=(t,e,n)=>n===ce.Left?t-e:n===ce.Right?t+e:t,U5=(t,e,n)=>n===ce.Top?t-e:n===ce.Bottom?t+e:t,Fw="react-flow__edgeupdater",$w=({position:t,centerX:e,centerY:n,radius:r=10,onMouseDown:i,onMouseEnter:s,onMouseOut:o,type:a})=>K.createElement("circle",{onMouseDown:i,onMouseEnter:s,onMouseOut:o,className:Vt([Fw,`${Fw}-${a}`]),cx:$5(e,r,t),cy:U5(n,r,t),r,stroke:"transparent",fill:"transparent"}),B5=()=>!0;var Oo=t=>{const e=({id:n,className:r,type:i,data:s,onClick:o,onEdgeDoubleClick:a,selected:l,animated:c,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:m,labelBgPadding:b,labelBgBorderRadius:x,style:R,source:y,target:v,sourceX:T,sourceY:A,targetX:O,targetY:L,sourcePosition:S,targetPosition:I,elementsSelectable:w,hidden:E,sourceHandleId:C,targetHandleId:N,onContextMenu:k,onMouseEnter:P,onMouseMove:j,onMouseLeave:z,reconnectRadius:U,onReconnect:F,onReconnectStart:M,onReconnectEnd:B,markerEnd:G,markerStart:$,rfId:Y,ariaLabel:X,isFocusable:ee,isReconnectable:re,pathOptions:fe,interactionWidth:ie,disableKeyboardA11y:xe})=>{const ve=D.useRef(null),[Re,Le]=D.useState(!1),[tt,Me]=D.useState(!1),Ve=wt(),Be=D.useMemo(()=>`url('#${ig($,Y)}')`,[$,Y]),Ee=D.useMemo(()=>`url('#${ig(G,Y)}')`,[G,Y]);if(E)return null;const oe=yt=>{var Xt;const{edges:Ke,addSelectedEdges:sn,unselectNodesAndEdges:Fn,multiSelectionActive:Ge}=Ve.getState(),on=Ke.find(Zn=>Zn.id===n);on&&(w&&(Ve.setState({nodesSelectionActive:!1}),on.selected&&Ge?(Fn({nodes:[],edges:[on]}),(Xt=ve.current)==null||Xt.blur()):sn([n])),o&&o(yt,on))},Ce=Pl(n,Ve.getState,a),St=Pl(n,Ve.getState,k),En=Pl(n,Ve.getState,P),jn=Pl(n,Ve.getState,j),Qt=Pl(n,Ve.getState,z),Ye=(yt,Ke)=>{if(yt.button!==0)return;const{edges:sn,isValidConnection:Fn}=Ve.getState(),Ge=Ke?v:y,on=(Ke?N:C)||null,Xt=Ke?"target":"source",Zn=Fn||B5,yi=Ke,_r=sn.find(bn=>bn.id===n);Me(!0),M==null||M(yt,_r,Xt);const er=bn=>{Me(!1),B==null||B(bn,_r,Xt)};hT({event:yt,handleId:on,nodeId:Ge,onConnect:bn=>F==null?void 0:F(_r,bn),isTarget:yi,getState:Ve.getState,setState:Ve.setState,isValidConnection:Zn,edgeUpdaterType:Xt,onReconnectEnd:er})},gt=yt=>Ye(yt,!0),Ne=yt=>Ye(yt,!1),ze=()=>Le(!0),Ct=()=>Le(!1),Yt=!w&&!o,vr=yt=>{var Ke;if(!xe&&JI.includes(yt.key)&&w){const{unselectNodesAndEdges:sn,addSelectedEdges:Fn,edges:Ge}=Ve.getState();yt.key==="Escape"?((Ke=ve.current)==null||Ke.blur(),sn({edges:[Ge.find(Xt=>Xt.id===n)]})):Fn([n])}};return K.createElement("g",{className:Vt(["react-flow__edge",`react-flow__edge-${i}`,r,{selected:l,animated:c,inactive:Yt,updating:Re}]),onClick:oe,onDoubleClick:Ce,onContextMenu:St,onMouseEnter:En,onMouseMove:jn,onMouseLeave:Qt,onKeyDown:ee?vr:void 0,tabIndex:ee?0:void 0,role:ee?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":X===null?void 0:X||`Edge from ${y} to ${v}`,"aria-describedby":ee?`${xT}-${Y}`:void 0,ref:ve},!tt&&K.createElement(t,{id:n,source:y,target:v,selected:l,animated:c,label:d,labelStyle:h,labelShowBg:f,labelBgStyle:m,labelBgPadding:b,labelBgBorderRadius:x,data:s,style:R,sourceX:T,sourceY:A,targetX:O,targetY:L,sourcePosition:S,targetPosition:I,sourceHandleId:C,targetHandleId:N,markerStart:Be,markerEnd:Ee,pathOptions:fe,interactionWidth:ie}),re&&K.createElement(K.Fragment,null,(re==="source"||re===!0)&&K.createElement($w,{position:S,centerX:T,centerY:A,radius:U,onMouseDown:gt,onMouseEnter:ze,onMouseOut:Ct,type:"source"}),(re==="target"||re===!0)&&K.createElement($w,{position:I,centerX:O,centerY:L,radius:U,onMouseDown:Ne,onMouseEnter:ze,onMouseOut:Ct,type:"target"})))};return e.displayName="EdgeWrapper",D.memo(e)};function H5(t){const e={default:Oo(t.default||Th),straight:Oo(t.bezier||Q0),step:Oo(t.step||W0),smoothstep:Oo(t.step||wf),simplebezier:Oo(t.simplebezier||G0)},n={},r=Object.keys(t).filter(i=>!["default","bezier"].includes(i)).reduce((i,s)=>(i[s]=Oo(t[s]||Th),i),n);return{...e,...r}}function Uw(t,e,n=null){const r=((n==null?void 0:n.x)||0)+e.x,i=((n==null?void 0:n.y)||0)+e.y,s=(n==null?void 0:n.width)||e.width,o=(n==null?void 0:n.height)||e.height;switch(t){case ce.Top:return{x:r+s/2,y:i};case ce.Right:return{x:r+s,y:i+o/2};case ce.Bottom:return{x:r+s/2,y:i+o};case ce.Left:return{x:r,y:i+o/2}}}function Bw(t,e){return t?t.length===1||!e?t[0]:e&&t.find(n=>n.id===e)||null:null}const q5=(t,e,n,r,i,s)=>{const o=Uw(n,t,e),a=Uw(s,r,i);return{sourceX:o.x,sourceY:o.y,targetX:a.x,targetY:a.y}};function K5({sourcePos:t,targetPos:e,sourceWidth:n,sourceHeight:r,targetWidth:i,targetHeight:s,width:o,height:a,transform:l}){const c={x:Math.min(t.x,e.x),y:Math.min(t.y,e.y),x2:Math.max(t.x+n,e.x+i),y2:Math.max(t.y+r,e.y+s)};c.x===c.x2&&(c.x2+=1),c.y===c.y2&&(c.y2+=1);const d=Fc({x:(0-l[0])/l[2],y:(0-l[1])/l[2],width:o/l[2],height:a/l[2]}),h=Math.max(0,Math.min(d.x2,c.x2)-Math.max(d.x,c.x)),f=Math.max(0,Math.min(d.y2,c.y2)-Math.max(d.y,c.y));return Math.ceil(h*f)>0}function Hw(t){var r,i,s,o,a;const e=((r=t==null?void 0:t[ht])==null?void 0:r.handleBounds)||null,n=e&&(t==null?void 0:t.width)&&(t==null?void 0:t.height)&&typeof((i=t==null?void 0:t.positionAbsolute)==null?void 0:i.x)<"u"&&typeof((s=t==null?void 0:t.positionAbsolute)==null?void 0:s.y)<"u";return[{x:((o=t==null?void 0:t.positionAbsolute)==null?void 0:o.x)||0,y:((a=t==null?void 0:t.positionAbsolute)==null?void 0:a.y)||0,width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0},e,!!n]}const G5=[{level:0,isMaxLevel:!0,edges:[]}];function W5(t,e,n=!1){let r=-1;const i=t.reduce((o,a)=>{var d,h;const l=Kn(a.zIndex);let c=l?a.zIndex:0;if(n){const f=e.get(a.target),m=e.get(a.source),b=a.selected||(f==null?void 0:f.selected)||(m==null?void 0:m.selected),x=Math.max(((d=m==null?void 0:m[ht])==null?void 0:d.z)||0,((h=f==null?void 0:f[ht])==null?void 0:h.z)||0,1e3);c=(l?a.zIndex:0)+(b?x:0)}return o[c]?o[c].push(a):o[c]=[a],r=c>r?c:r,o},{}),s=Object.entries(i).map(([o,a])=>{const l=+o;return{edges:a,level:l,isMaxLevel:l===r}});return s.length===0?G5:s}function Q5(t,e,n){const r=qe(D.useCallback(i=>t?i.edges.filter(s=>{const o=e.get(s.source),a=e.get(s.target);return(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&K5({sourcePos:o.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:o.width,sourceHeight:o.height,targetWidth:a.width,targetHeight:a.height,width:i.width,height:i.height,transform:i.transform})}):i.edges,[t,e]));return W5(r,e,n)}const Y5=({color:t="none",strokeWidth:e=1})=>K.createElement("polyline",{style:{stroke:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),X5=({color:t="none",strokeWidth:e=1})=>K.createElement("polyline",{style:{stroke:t,fill:t,strokeWidth:e},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),qw={[Ih.Arrow]:Y5,[Ih.ArrowClosed]:X5};function J5(t){const e=wt();return D.useMemo(()=>{var i,s;return Object.prototype.hasOwnProperty.call(qw,t)?qw[t]:((s=(i=e.getState()).onError)==null||s.call(i,"009",ui.error009(t)),null)},[t])}const Z5=({id:t,type:e,color:n,width:r=12.5,height:i=12.5,markerUnits:s="strokeWidth",strokeWidth:o,orient:a="auto-start-reverse"})=>{const l=J5(e);return l?K.createElement("marker",{className:"react-flow__arrowhead",id:t,markerWidth:`${r}`,markerHeight:`${i}`,viewBox:"-10 -10 20 20",markerUnits:s,orient:a,refX:"0",refY:"0"},K.createElement(l,{color:n,strokeWidth:o})):null},eO=({defaultColor:t,rfId:e})=>n=>{const r=[];return n.edges.reduce((i,s)=>([s.markerStart,s.markerEnd].forEach(o=>{if(o&&typeof o=="object"){const a=ig(o,e);r.includes(a)||(i.push({id:a,color:o.color||t,...o}),r.push(a))}}),i),[]).sort((i,s)=>i.id.localeCompare(s.id))},OT=({defaultColor:t,rfId:e})=>{const n=qe(D.useCallback(eO({defaultColor:t,rfId:e}),[t,e]),(r,i)=>!(r.length!==i.length||r.some((s,o)=>s.id!==i[o].id)));return K.createElement("defs",null,n.map(r=>K.createElement(Z5,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};OT.displayName="MarkerDefinitions";var tO=D.memo(OT);const nO=t=>({nodesConnectable:t.nodesConnectable,edgesFocusable:t.edgesFocusable,edgesUpdatable:t.edgesUpdatable,elementsSelectable:t.elementsSelectable,width:t.width,height:t.height,connectionMode:t.connectionMode,nodeInternals:t.nodeInternals,onError:t.onError}),zT=({defaultMarkerColor:t,onlyRenderVisibleElements:e,elevateEdgesOnSelect:n,rfId:r,edgeTypes:i,noPanClassName:s,onEdgeContextMenu:o,onEdgeMouseEnter:a,onEdgeMouseMove:l,onEdgeMouseLeave:c,onEdgeClick:d,onEdgeDoubleClick:h,onReconnect:f,onReconnectStart:m,onReconnectEnd:b,reconnectRadius:x,children:R,disableKeyboardA11y:y})=>{const{edgesFocusable:v,edgesUpdatable:T,elementsSelectable:A,width:O,height:L,connectionMode:S,nodeInternals:I,onError:w}=qe(nO,Pt),E=Q5(e,I,n);return O?K.createElement(K.Fragment,null,E.map(({level:C,edges:N,isMaxLevel:k})=>K.createElement("svg",{key:C,style:{zIndex:C},width:O,height:L,className:"react-flow__edges react-flow__container"},k&&K.createElement(tO,{defaultColor:t,rfId:r}),K.createElement("g",null,N.map(P=>{const[j,z,U]=Hw(I.get(P.source)),[F,M,B]=Hw(I.get(P.target));if(!U||!B)return null;let G=P.type||"default";i[G]||(w==null||w("011",ui.error011(G)),G="default");const $=i[G]||i.default,Y=S===no.Strict?M.target:(M.target??[]).concat(M.source??[]),X=Bw(z.source,P.sourceHandle),ee=Bw(Y,P.targetHandle),re=(X==null?void 0:X.position)||ce.Bottom,fe=(ee==null?void 0:ee.position)||ce.Top,ie=!!(P.focusable||v&&typeof P.focusable>"u"),xe=P.reconnectable||P.updatable,ve=typeof f<"u"&&(xe||T&&typeof xe>"u");if(!X||!ee)return w==null||w("008",ui.error008(X,P)),null;const{sourceX:Re,sourceY:Le,targetX:tt,targetY:Me}=q5(j,X,re,F,ee,fe);return K.createElement($,{key:P.id,id:P.id,className:Vt([P.className,s]),type:G,data:P.data,selected:!!P.selected,animated:!!P.animated,hidden:!!P.hidden,label:P.label,labelStyle:P.labelStyle,labelShowBg:P.labelShowBg,labelBgStyle:P.labelBgStyle,labelBgPadding:P.labelBgPadding,labelBgBorderRadius:P.labelBgBorderRadius,style:P.style,source:P.source,target:P.target,sourceHandleId:P.sourceHandle,targetHandleId:P.targetHandle,markerEnd:P.markerEnd,markerStart:P.markerStart,sourceX:Re,sourceY:Le,targetX:tt,targetY:Me,sourcePosition:re,targetPosition:fe,elementsSelectable:A,onContextMenu:o,onMouseEnter:a,onMouseMove:l,onMouseLeave:c,onClick:d,onEdgeDoubleClick:h,onReconnect:f,onReconnectStart:m,onReconnectEnd:b,reconnectRadius:x,rfId:r,ariaLabel:P.ariaLabel,isFocusable:ie,isReconnectable:ve,pathOptions:"pathOptions"in P?P.pathOptions:void 0,interactionWidth:P.interactionWidth,disableKeyboardA11y:y})})))),R):null};zT.displayName="EdgeRenderer";var rO=D.memo(zT);const iO=t=>`translate(${t.transform[0]}px,${t.transform[1]}px) scale(${t.transform[2]})`;function sO({children:t}){const e=qe(iO);return K.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:e}},t)}function oO(t){const e=Lr(),n=D.useRef(!1);D.useEffect(()=>{!n.current&&e.viewportInitialized&&t&&(setTimeout(()=>t(e),1),n.current=!0)},[t,e.viewportInitialized])}const aO={[ce.Left]:ce.Right,[ce.Right]:ce.Left,[ce.Top]:ce.Bottom,[ce.Bottom]:ce.Top},LT=({nodeId:t,handleType:e,style:n,type:r=zi.Bezier,CustomComponent:i,connectionStatus:s})=>{var L,S,I;const{fromNode:o,handleId:a,toX:l,toY:c,connectionMode:d}=qe(D.useCallback(w=>({fromNode:w.nodeInternals.get(t),handleId:w.connectionHandleId,toX:(w.connectionPosition.x-w.transform[0])/w.transform[2],toY:(w.connectionPosition.y-w.transform[1])/w.transform[2],connectionMode:w.connectionMode}),[t]),Pt),h=(L=o==null?void 0:o[ht])==null?void 0:L.handleBounds;let f=h==null?void 0:h[e];if(d===no.Loose&&(f=f||(h==null?void 0:h[e==="source"?"target":"source"])),!o||!f)return null;const m=a?f.find(w=>w.id===a):f[0],b=m?m.x+m.width/2:(o.width??0)/2,x=m?m.y+m.height/2:o.height??0,R=(((S=o.positionAbsolute)==null?void 0:S.x)??0)+b,y=(((I=o.positionAbsolute)==null?void 0:I.y)??0)+x,v=m==null?void 0:m.position,T=v?aO[v]:null;if(!v||!T)return null;if(i)return K.createElement(i,{connectionLineType:r,connectionLineStyle:n,fromNode:o,fromHandle:m,fromX:R,fromY:y,toX:l,toY:c,fromPosition:v,toPosition:T,connectionStatus:s});let A="";const O={sourceX:R,sourceY:y,sourcePosition:v,targetX:l,targetY:c,targetPosition:T};return r===zi.Bezier?[A]=Y0(O):r===zi.Step?[A]=Uc({...O,borderRadius:0}):r===zi.SmoothStep?[A]=Uc(O):r===zi.SimpleBezier?[A]=nT(O):A=`M${R},${y} ${l},${c}`,K.createElement("path",{d:A,fill:"none",className:"react-flow__connection-path",style:n})};LT.displayName="ConnectionLine";const lO=t=>({nodeId:t.connectionNodeId,handleType:t.connectionHandleType,nodesConnectable:t.nodesConnectable,connectionStatus:t.connectionStatus,width:t.width,height:t.height});function cO({containerStyle:t,style:e,type:n,component:r}){const{nodeId:i,handleType:s,nodesConnectable:o,width:a,height:l,connectionStatus:c}=qe(lO,Pt);return!(i&&s&&a&&o)?null:K.createElement("svg",{style:t,width:a,height:l,className:"react-flow__edges react-flow__connectionline react-flow__container"},K.createElement("g",{className:Vt(["react-flow__connection",c])},K.createElement(LT,{nodeId:i,handleType:s,style:e,type:n,CustomComponent:r,connectionStatus:c})))}function Kw(t,e){return D.useRef(null),wt(),D.useMemo(()=>e(t),[t])}const MT=({nodeTypes:t,edgeTypes:e,onMove:n,onMoveStart:r,onMoveEnd:i,onInit:s,onNodeClick:o,onEdgeClick:a,onNodeDoubleClick:l,onEdgeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:m,onSelectionContextMenu:b,onSelectionStart:x,onSelectionEnd:R,connectionLineType:y,connectionLineStyle:v,connectionLineComponent:T,connectionLineContainerStyle:A,selectionKeyCode:O,selectionOnDrag:L,selectionMode:S,multiSelectionKeyCode:I,panActivationKeyCode:w,zoomActivationKeyCode:E,deleteKeyCode:C,onlyRenderVisibleElements:N,elementsSelectable:k,selectNodesOnDrag:P,defaultViewport:j,translateExtent:z,minZoom:U,maxZoom:F,preventScrolling:M,defaultMarkerColor:B,zoomOnScroll:G,zoomOnPinch:$,panOnScroll:Y,panOnScrollSpeed:X,panOnScrollMode:ee,zoomOnDoubleClick:re,panOnDrag:fe,onPaneClick:ie,onPaneMouseEnter:xe,onPaneMouseMove:ve,onPaneMouseLeave:Re,onPaneScroll:Le,onPaneContextMenu:tt,onEdgeContextMenu:Me,onEdgeMouseEnter:Ve,onEdgeMouseMove:Be,onEdgeMouseLeave:Ee,onReconnect:oe,onReconnectStart:Ce,onReconnectEnd:St,reconnectRadius:En,noDragClassName:jn,noWheelClassName:Qt,noPanClassName:Ye,elevateEdgesOnSelect:gt,disableKeyboardA11y:Ne,nodeOrigin:ze,nodeExtent:Ct,rfId:Yt})=>{const vr=Kw(t,L5),yt=Kw(e,H5);return oO(s),K.createElement(O5,{onPaneClick:ie,onPaneMouseEnter:xe,onPaneMouseMove:ve,onPaneMouseLeave:Re,onPaneContextMenu:tt,onPaneScroll:Le,deleteKeyCode:C,selectionKeyCode:O,selectionOnDrag:L,selectionMode:S,onSelectionStart:x,onSelectionEnd:R,multiSelectionKeyCode:I,panActivationKeyCode:w,zoomActivationKeyCode:E,elementsSelectable:k,onMove:n,onMoveStart:r,onMoveEnd:i,zoomOnScroll:G,zoomOnPinch:$,zoomOnDoubleClick:re,panOnScroll:Y,panOnScrollSpeed:X,panOnScrollMode:ee,panOnDrag:fe,defaultViewport:j,translateExtent:z,minZoom:U,maxZoom:F,onSelectionContextMenu:b,preventScrolling:M,noDragClassName:jn,noWheelClassName:Qt,noPanClassName:Ye,disableKeyboardA11y:Ne},K.createElement(sO,null,K.createElement(rO,{edgeTypes:yt,onEdgeClick:a,onEdgeDoubleClick:c,onlyRenderVisibleElements:N,onEdgeContextMenu:Me,onEdgeMouseEnter:Ve,onEdgeMouseMove:Be,onEdgeMouseLeave:Ee,onReconnect:oe,onReconnectStart:Ce,onReconnectEnd:St,reconnectRadius:En,defaultMarkerColor:B,noPanClassName:Ye,elevateEdgesOnSelect:!!gt,disableKeyboardA11y:Ne,rfId:Yt},K.createElement(cO,{style:v,type:y,component:T,containerStyle:A})),K.createElement("div",{className:"react-flow__edgelabel-renderer"}),K.createElement(F5,{nodeTypes:vr,onNodeClick:o,onNodeDoubleClick:l,onNodeMouseEnter:d,onNodeMouseMove:h,onNodeMouseLeave:f,onNodeContextMenu:m,selectNodesOnDrag:P,onlyRenderVisibleElements:N,noPanClassName:Ye,noDragClassName:jn,disableKeyboardA11y:Ne,nodeOrigin:ze,nodeExtent:Ct,rfId:Yt})))};MT.displayName="GraphView";var uO=D.memo(MT);const lg=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Si={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:lg,nodeExtent:lg,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:no.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:U4,isValidConnection:void 0},dO=()=>iP((t,e)=>({...Si,setNodes:n=>{const{nodeInternals:r,nodeOrigin:i,elevateNodesOnSelect:s}=e();t({nodeInternals:kp(n,r,i,s)})},getNodes:()=>Array.from(e().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=e();t({edges:n.map(i=>({...r,...i}))})},setDefaultNodesAndEdges:(n,r)=>{const i=typeof n<"u",s=typeof r<"u",o=i?kp(n,new Map,e().nodeOrigin,e().elevateNodesOnSelect):new Map;t({nodeInternals:o,edges:s?r:[],hasDefaultNodes:i,hasDefaultEdges:s})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:i,fitViewOnInit:s,fitViewOnInitDone:o,fitViewOnInitOptions:a,domNode:l,nodeOrigin:c}=e(),d=l==null?void 0:l.querySelector(".react-flow__viewport");if(!d)return;const h=window.getComputedStyle(d),{m22:f}=new window.DOMMatrixReadOnly(h.transform),m=n.reduce((x,R)=>{const y=i.get(R.id);if(y!=null&&y.hidden)i.set(y.id,{...y,[ht]:{...y[ht],handleBounds:void 0}});else if(y){const v=q0(R.nodeElement);!!(v.width&&v.height&&(y.width!==v.width||y.height!==v.height||R.forceUpdate))&&(i.set(y.id,{...y,[ht]:{...y[ht],handleBounds:{source:jw(".source",R.nodeElement,f,c),target:jw(".target",R.nodeElement,f,c)}},...v}),x.push({id:y.id,type:"dimensions",dimensions:v}))}return x},[]);bT(i,c);const b=o||s&&!o&&IT(e,{initial:!0,...a});t({nodeInternals:new Map(i),fitViewOnInitDone:b}),(m==null?void 0:m.length)>0&&(r==null||r(m))},updateNodePositions:(n,r=!0,i=!1)=>{const{triggerNodeChanges:s}=e(),o=n.map(a=>{const l={id:a.id,type:"position",dragging:i};return r&&(l.positionAbsolute=a.positionAbsolute,l.position=a.position),l});s(o)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:i,hasDefaultNodes:s,nodeOrigin:o,getNodes:a,elevateNodesOnSelect:l}=e();if(n!=null&&n.length){if(s){const c=ST(n,a()),d=kp(c,i,o,l);t({nodeInternals:d})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=e();let o,a=null;r?o=n.map(l=>Di(l,!0)):(o=oa(s(),n),a=oa(i,[])),sd({changedNodes:o,changedEdges:a,get:e,set:t})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:i,getNodes:s}=e();let o,a=null;r?o=n.map(l=>Di(l,!0)):(o=oa(i,n),a=oa(s(),[])),sd({changedNodes:a,changedEdges:o,get:e,set:t})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:i,getNodes:s}=e(),o=n||s(),a=r||i,l=o.map(d=>(d.selected=!1,Di(d.id,!1))),c=a.map(d=>Di(d.id,!1));sd({changedNodes:l,changedEdges:c,get:e,set:t})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:i}=e();r==null||r.scaleExtent([n,i]),t({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:i}=e();r==null||r.scaleExtent([i,n]),t({maxZoom:n})},setTranslateExtent:n=>{var r;(r=e().d3Zoom)==null||r.translateExtent(n),t({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=e(),s=r().filter(a=>a.selected).map(a=>Di(a.id,!1)),o=n.filter(a=>a.selected).map(a=>Di(a.id,!1));sd({changedNodes:s,changedEdges:o,get:e,set:t})},setNodeExtent:n=>{const{nodeInternals:r}=e();r.forEach(i=>{i.positionAbsolute=K0(i.position,n)}),t({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:i,height:s,d3Zoom:o,d3Selection:a,translateExtent:l}=e();if(!o||!a||!n.x&&!n.y)return!1;const c=ri.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),d=[[0,0],[i,s]],h=o==null?void 0:o.constrain()(c,d,l);return o.transform(a,h),r[0]!==h.x||r[1]!==h.y||r[2]!==h.k},cancelConnection:()=>t({connectionNodeId:Si.connectionNodeId,connectionHandleId:Si.connectionHandleId,connectionHandleType:Si.connectionHandleType,connectionStatus:Si.connectionStatus,connectionStartHandle:Si.connectionStartHandle,connectionEndHandle:Si.connectionEndHandle}),reset:()=>t({...Si})}),Object.is),ty=({children:t})=>{const e=D.useRef(null);return e.current||(e.current=dO()),K.createElement(O4,{value:e.current},t)};ty.displayName="ReactFlowProvider";const jT=({children:t})=>D.useContext(_f)?K.createElement(K.Fragment,null,t):K.createElement(ty,null,t);jT.displayName="ReactFlowWrapper";const hO={input:gT,default:og,output:vT,group:Z0},fO={default:Th,straight:Q0,step:W0,smoothstep:wf,simplebezier:G0},pO=[0,0],mO=[15,15],gO={x:0,y:0,zoom:1},yO={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},FT=D.forwardRef(({nodes:t,edges:e,defaultNodes:n,defaultEdges:r,className:i,nodeTypes:s=hO,edgeTypes:o=fO,onNodeClick:a,onEdgeClick:l,onInit:c,onMove:d,onMoveStart:h,onMoveEnd:f,onConnect:m,onConnectStart:b,onConnectEnd:x,onClickConnectStart:R,onClickConnectEnd:y,onNodeMouseEnter:v,onNodeMouseMove:T,onNodeMouseLeave:A,onNodeContextMenu:O,onNodeDoubleClick:L,onNodeDragStart:S,onNodeDrag:I,onNodeDragStop:w,onNodesDelete:E,onEdgesDelete:C,onSelectionChange:N,onSelectionDragStart:k,onSelectionDrag:P,onSelectionDragStop:j,onSelectionContextMenu:z,onSelectionStart:U,onSelectionEnd:F,connectionMode:M=no.Strict,connectionLineType:B=zi.Bezier,connectionLineStyle:G,connectionLineComponent:$,connectionLineContainerStyle:Y,deleteKeyCode:X="Backspace",selectionKeyCode:ee="Shift",selectionOnDrag:re=!1,selectionMode:fe=$c.Full,panActivationKeyCode:ie="Space",multiSelectionKeyCode:xe=bh()?"Meta":"Control",zoomActivationKeyCode:ve=bh()?"Meta":"Control",snapToGrid:Re=!1,snapGrid:Le=mO,onlyRenderVisibleElements:tt=!1,selectNodesOnDrag:Me=!0,nodesDraggable:Ve,nodesConnectable:Be,nodesFocusable:Ee,nodeOrigin:oe=pO,edgesFocusable:Ce,edgesUpdatable:St,elementsSelectable:En,defaultViewport:jn=gO,minZoom:Qt=.5,maxZoom:Ye=2,translateExtent:gt=lg,preventScrolling:Ne=!0,nodeExtent:ze,defaultMarkerColor:Ct="#b1b1b7",zoomOnScroll:Yt=!0,zoomOnPinch:vr=!0,panOnScroll:yt=!1,panOnScrollSpeed:Ke=.5,panOnScrollMode:sn=$s.Free,zoomOnDoubleClick:Fn=!0,panOnDrag:Ge=!0,onPaneClick:on,onPaneMouseEnter:Xt,onPaneMouseMove:Zn,onPaneMouseLeave:yi,onPaneScroll:_r,onPaneContextMenu:er,children:vi,onEdgeContextMenu:bn,onEdgeDoubleClick:tr,onEdgeMouseEnter:xo,onEdgeMouseMove:_i,onEdgeMouseLeave:Eo,onEdgeUpdate:wr,onEdgeUpdateStart:bo,onEdgeUpdateEnd:xt,onReconnect:Io,onReconnectStart:jr,onReconnectEnd:an,reconnectRadius:cl=10,edgeUpdaterRadius:ul=10,onNodesChange:xr,onEdgesChange:dl,noDragClassName:hl="nodrag",noWheelClassName:wi="nowheel",noPanClassName:_s="nopan",fitView:ws=!1,fitViewOptions:xi,connectOnClick:$n=!0,attributionPosition:xs,proOptions:To,defaultEdgeOptions:Es,elevateNodesOnSelect:Fr=!0,elevateEdgesOnSelect:bs=!1,disableKeyboardA11y:Is=!1,autoPanOnConnect:fl=!0,autoPanOnNodeDrag:Er=!0,connectionRadius:So=20,isValidConnection:Ei,onError:br,style:Un,id:_e,nodeDragThreshold:me,...Ae},Pe)=>{const Xe=_e||"1";return K.createElement("div",{...Ae,style:{...Un,...yO},ref:Pe,className:Vt(["react-flow",i]),"data-testid":"rf__wrapper",id:_e},K.createElement(jT,null,K.createElement(uO,{onInit:c,onMove:d,onMoveStart:h,onMoveEnd:f,onNodeClick:a,onEdgeClick:l,onNodeMouseEnter:v,onNodeMouseMove:T,onNodeMouseLeave:A,onNodeContextMenu:O,onNodeDoubleClick:L,nodeTypes:s,edgeTypes:o,connectionLineType:B,connectionLineStyle:G,connectionLineComponent:$,connectionLineContainerStyle:Y,selectionKeyCode:ee,selectionOnDrag:re,selectionMode:fe,deleteKeyCode:X,multiSelectionKeyCode:xe,panActivationKeyCode:ie,zoomActivationKeyCode:ve,onlyRenderVisibleElements:tt,selectNodesOnDrag:Me,defaultViewport:jn,translateExtent:gt,minZoom:Qt,maxZoom:Ye,preventScrolling:Ne,zoomOnScroll:Yt,zoomOnPinch:vr,zoomOnDoubleClick:Fn,panOnScroll:yt,panOnScrollSpeed:Ke,panOnScrollMode:sn,panOnDrag:Ge,onPaneClick:on,onPaneMouseEnter:Xt,onPaneMouseMove:Zn,onPaneMouseLeave:yi,onPaneScroll:_r,onPaneContextMenu:er,onSelectionContextMenu:z,onSelectionStart:U,onSelectionEnd:F,onEdgeContextMenu:bn,onEdgeDoubleClick:tr,onEdgeMouseEnter:xo,onEdgeMouseMove:_i,onEdgeMouseLeave:Eo,onReconnect:Io??wr,onReconnectStart:jr??bo,onReconnectEnd:an??xt,reconnectRadius:cl??ul,defaultMarkerColor:Ct,noDragClassName:hl,noWheelClassName:wi,noPanClassName:_s,elevateEdgesOnSelect:bs,rfId:Xe,disableKeyboardA11y:Is,nodeOrigin:oe,nodeExtent:ze}),K.createElement(l5,{nodes:t,edges:e,defaultNodes:n,defaultEdges:r,onConnect:m,onConnectStart:b,onConnectEnd:x,onClickConnectStart:R,onClickConnectEnd:y,nodesDraggable:Ve,nodesConnectable:Be,nodesFocusable:Ee,edgesFocusable:Ce,edgesUpdatable:St,elementsSelectable:En,elevateNodesOnSelect:Fr,minZoom:Qt,maxZoom:Ye,nodeExtent:ze,onNodesChange:xr,onEdgesChange:dl,snapToGrid:Re,snapGrid:Le,connectionMode:M,translateExtent:gt,connectOnClick:$n,defaultEdgeOptions:Es,fitView:ws,fitViewOptions:xi,onNodesDelete:E,onEdgesDelete:C,onNodeDragStart:S,onNodeDrag:I,onNodeDragStop:w,onSelectionDrag:P,onSelectionDragStart:k,onSelectionDragStop:j,noPanClassName:_s,nodeOrigin:oe,rfId:Xe,autoPanOnConnect:fl,autoPanOnNodeDrag:Er,onError:br,connectionRadius:So,isValidConnection:Ei,nodeDragThreshold:me}),K.createElement(o5,{onSelectionChange:N}),vi,K.createElement(L4,{proOptions:To,position:xs}),K.createElement(f5,{rfId:Xe,disableKeyboardA11y:Is})))});FT.displayName="ReactFlow";const vO=t=>{var e;return(e=t.domNode)==null?void 0:e.querySelector(".react-flow__edgelabel-renderer")};function _O({children:t}){const e=qe(vO);return e?Vc.createPortal(t,e):null}function $T(t){return e=>{const[n,r]=D.useState(e),i=D.useCallback(s=>r(o=>t(s,o)),[]);return[n,r,i]}}const wO=$T(ST),xO=$T(C5),UT=({id:t,x:e,y:n,width:r,height:i,style:s,color:o,strokeColor:a,strokeWidth:l,className:c,borderRadius:d,shapeRendering:h,onClick:f,selected:m})=>{const{background:b,backgroundColor:x}=s||{},R=o||b||x;return K.createElement("rect",{className:Vt(["react-flow__minimap-node",{selected:m},c]),x:e,y:n,rx:d,ry:d,width:r,height:i,fill:R,stroke:a,strokeWidth:l,shapeRendering:h,onClick:f?y=>f(y,t):void 0})};UT.displayName="MiniMapNode";var EO=D.memo(UT);const bO=t=>t.nodeOrigin,IO=t=>t.getNodes().filter(e=>!e.hidden&&e.width&&e.height),Dp=t=>t instanceof Function?t:()=>t;function TO({nodeStrokeColor:t="transparent",nodeColor:e="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:i=2,nodeComponent:s=EO,onClick:o}){const a=qe(IO,Pt),l=qe(bO),c=Dp(e),d=Dp(t),h=Dp(n),f=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return K.createElement(K.Fragment,null,a.map(m=>{const{x:b,y:x}=Gs(m,l).positionAbsolute;return K.createElement(s,{key:m.id,x:b,y:x,width:m.width,height:m.height,style:m.style,selected:m.selected,className:h(m),color:c(m),borderRadius:r,strokeColor:d(m),strokeWidth:i,shapeRendering:f,onClick:o,id:m.id})}))}var SO=D.memo(TO);const CO=200,AO=150,kO=t=>{const e=t.getNodes(),n={x:-t.transform[0]/t.transform[2],y:-t.transform[1]/t.transform[2],width:t.width/t.transform[2],height:t.height/t.transform[2]};return{viewBB:n,boundingRect:e.length>0?F4(uu(e,t.nodeOrigin),n):n,rfId:t.rfId}},RO="react-flow__minimap-desc";function BT({style:t,className:e,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:i="",nodeBorderRadius:s=5,nodeStrokeWidth:o=2,nodeComponent:a,maskColor:l="rgb(240, 240, 240, 0.6)",maskStrokeColor:c="none",maskStrokeWidth:d=1,position:h="bottom-right",onClick:f,onNodeClick:m,pannable:b=!1,zoomable:x=!1,ariaLabel:R="React Flow mini map",inversePan:y=!1,zoomStep:v=10,offsetScale:T=5}){const A=wt(),O=D.useRef(null),{boundingRect:L,viewBB:S,rfId:I}=qe(kO,Pt),w=(t==null?void 0:t.width)??CO,E=(t==null?void 0:t.height)??AO,C=L.width/w,N=L.height/E,k=Math.max(C,N),P=k*w,j=k*E,z=T*k,U=L.x-(P-L.width)/2-z,F=L.y-(j-L.height)/2-z,M=P+z*2,B=j+z*2,G=`${RO}-${I}`,$=D.useRef(0);$.current=k,D.useEffect(()=>{if(O.current){const ee=Cn(O.current),re=xe=>{const{transform:ve,d3Selection:Re,d3Zoom:Le}=A.getState();if(xe.sourceEvent.type!=="wheel"||!Re||!Le)return;const tt=-xe.sourceEvent.deltaY*(xe.sourceEvent.deltaMode===1?.05:xe.sourceEvent.deltaMode?1:.002)*v,Me=ve[2]*Math.pow(2,tt);Le.scaleTo(Re,Me)},fe=xe=>{const{transform:ve,d3Selection:Re,d3Zoom:Le,translateExtent:tt,width:Me,height:Ve}=A.getState();if(xe.sourceEvent.type!=="mousemove"||!Re||!Le)return;const Be=$.current*Math.max(1,ve[2])*(y?-1:1),Ee={x:ve[0]-xe.sourceEvent.movementX*Be,y:ve[1]-xe.sourceEvent.movementY*Be},oe=[[0,0],[Me,Ve]],Ce=ri.translate(Ee.x,Ee.y).scale(ve[2]),St=Le.constrain()(Ce,oe,tt);Le.transform(Re,St)},ie=KI().on("zoom",b?fe:null).on("zoom.wheel",x?re:null);return ee.call(ie),()=>{ee.on("zoom",null)}}},[b,x,y,v]);const Y=f?ee=>{const re=or(ee);f(ee,{x:re[0],y:re[1]})}:void 0,X=m?(ee,re)=>{const fe=A.getState().nodeInternals.get(re);m(ee,fe)}:void 0;return K.createElement(H0,{position:h,style:t,className:Vt(["react-flow__minimap",e]),"data-testid":"rf__minimap"},K.createElement("svg",{width:w,height:E,viewBox:`${U} ${F} ${M} ${B}`,role:"img","aria-labelledby":G,ref:O,onClick:Y},R&&K.createElement("title",{id:G},R),K.createElement(SO,{onClick:X,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:s,nodeClassName:i,nodeStrokeWidth:o,nodeComponent:a}),K.createElement("path",{className:"react-flow__minimap-mask",d:`M${U-z},${F-z}h${M+z*2}v${B+z*2}h${-M-z*2}z
        M${S.x},${S.y}h${S.width}v${S.height}h${-S.width}z`,fill:l,fillRule:"evenodd",stroke:c,strokeWidth:d,pointerEvents:"none"})))}BT.displayName="MiniMap";var NO=D.memo(BT);function PO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},K.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function DO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},K.createElement("path",{d:"M0 0h32v4.2H0z"}))}function VO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},K.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function OO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},K.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function zO(){return K.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},K.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Kl=({children:t,className:e,...n})=>K.createElement("button",{type:"button",className:Vt(["react-flow__controls-button",e]),...n},t);Kl.displayName="ControlButton";const LO=t=>({isInteractive:t.nodesDraggable||t.nodesConnectable||t.elementsSelectable,minZoomReached:t.transform[2]<=t.minZoom,maxZoomReached:t.transform[2]>=t.maxZoom}),HT=({style:t,showZoom:e=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:i,onZoomIn:s,onZoomOut:o,onFitView:a,onInteractiveChange:l,className:c,children:d,position:h="bottom-left"})=>{const f=wt(),[m,b]=D.useState(!1),{isInteractive:x,minZoomReached:R,maxZoomReached:y}=qe(LO,Pt),{zoomIn:v,zoomOut:T,fitView:A}=Lr();if(D.useEffect(()=>{b(!0)},[]),!m)return null;const O=()=>{v(),s==null||s()},L=()=>{T(),o==null||o()},S=()=>{A(i),a==null||a()},I=()=>{f.setState({nodesDraggable:!x,nodesConnectable:!x,elementsSelectable:!x}),l==null||l(!x)};return K.createElement(H0,{className:Vt(["react-flow__controls",c]),position:h,style:t,"data-testid":"rf__controls"},e&&K.createElement(K.Fragment,null,K.createElement(Kl,{onClick:O,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:y},K.createElement(PO,null)),K.createElement(Kl,{onClick:L,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:R},K.createElement(DO,null))),n&&K.createElement(Kl,{className:"react-flow__controls-fitview",onClick:S,title:"fit view","aria-label":"fit view"},K.createElement(VO,null)),r&&K.createElement(Kl,{className:"react-flow__controls-interactive",onClick:I,title:"toggle interactivity","aria-label":"toggle interactivity"},x?K.createElement(zO,null):K.createElement(OO,null)),d)};HT.displayName="Controls";var MO=D.memo(HT),hr;(function(t){t.Lines="lines",t.Dots="dots",t.Cross="cross"})(hr||(hr={}));function jO({color:t,dimensions:e,lineWidth:n}){return K.createElement("path",{stroke:t,strokeWidth:n,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`})}function FO({color:t,radius:e}){return K.createElement("circle",{cx:e,cy:e,r:e,fill:t})}const $O={[hr.Dots]:"#91919a",[hr.Lines]:"#eee",[hr.Cross]:"#e2e2e2"},UO={[hr.Dots]:1,[hr.Lines]:1,[hr.Cross]:6},BO=t=>({transform:t.transform,patternId:`pattern-${t.rfId}`});function qT({id:t,variant:e=hr.Dots,gap:n=20,size:r,lineWidth:i=1,offset:s=2,color:o,style:a,className:l}){const c=D.useRef(null),{transform:d,patternId:h}=qe(BO,Pt),f=o||$O[e],m=r||UO[e],b=e===hr.Dots,x=e===hr.Cross,R=Array.isArray(n)?n:[n,n],y=[R[0]*d[2]||1,R[1]*d[2]||1],v=m*d[2],T=x?[v,v]:y,A=b?[v/s,v/s]:[T[0]/s,T[1]/s];return K.createElement("svg",{className:Vt(["react-flow__background",l]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:c,"data-testid":"rf__background"},K.createElement("pattern",{id:h+t,x:d[0]%y[0],y:d[1]%y[1],width:y[0],height:y[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${A[0]},-${A[1]})`},b?K.createElement(FO,{color:f,radius:v/s}):K.createElement(jO,{dimensions:T,color:f,lineWidth:i})),K.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${h+t})`}))}qT.displayName="Background";var HO=D.memo(qT),ga;(function(t){t.Line="line",t.Handle="handle"})(ga||(ga={}));function qO({width:t,prevWidth:e,height:n,prevHeight:r,invertX:i,invertY:s}){const o=t-e,a=n-r,l=[o>0?1:o<0?-1:0,a>0?1:a<0?-1:0];return o&&i&&(l[0]=l[0]*-1),a&&s&&(l[1]=l[1]*-1),l}const KT={width:0,height:0,x:0,y:0},KO={...KT,pointerX:0,pointerY:0,aspectRatio:1};function GO({nodeId:t,position:e,variant:n=ga.Handle,className:r,style:i={},children:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,shouldResize:f,onResizeStart:m,onResize:b,onResizeEnd:x}){const R=iT(),y=typeof t=="string"?t:R,v=wt(),T=D.useRef(null),A=D.useRef(KO),O=D.useRef(KT),L=RT(),S=n===ga.Line?"right":"bottom-right",I=e??S;D.useEffect(()=>{if(!T.current||!y)return;const N=Cn(T.current),k=I.includes("right")||I.includes("left"),P=I.includes("bottom")||I.includes("top"),j=I.includes("left"),z=I.includes("top"),U=PI().on("start",F=>{const M=v.getState().nodeInternals.get(y),{xSnapped:B,ySnapped:G}=L(F);O.current={width:(M==null?void 0:M.width)??0,height:(M==null?void 0:M.height)??0,x:(M==null?void 0:M.position.x)??0,y:(M==null?void 0:M.position.y)??0},A.current={...O.current,pointerX:B,pointerY:G,aspectRatio:O.current.width/O.current.height},m==null||m(F,{...O.current})}).on("drag",F=>{const{nodeInternals:M,triggerNodeChanges:B}=v.getState(),{xSnapped:G,ySnapped:$}=L(F),Y=M.get(y);if(Y){const X=[],{pointerX:ee,pointerY:re,width:fe,height:ie,x:xe,y:ve,aspectRatio:Re}=A.current,{x:Le,y:tt,width:Me,height:Ve}=O.current,Be=Math.floor(k?G-ee:0),Ee=Math.floor(P?$-re:0);let oe=os(fe+(j?-Be:Be),a,c),Ce=os(ie+(z?-Ee:Ee),l,d);if(h){const gt=oe/Ce,Ne=k&&P,ze=k&&!P,Ct=P&&!k;oe=gt<=Re&&Ne||Ct?Ce*Re:oe,Ce=gt>Re&&Ne||ze?oe/Re:Ce,oe>=c?(oe=c,Ce=c/Re):oe<=a&&(oe=a,Ce=a/Re),Ce>=d?(Ce=d,oe=d*Re):Ce<=l&&(Ce=l,oe=l*Re)}const St=oe!==Me,En=Ce!==Ve;if(j||z){const gt=j?xe-(oe-fe):xe,Ne=z?ve-(Ce-ie):ve,ze=gt!==Le&&St,Ct=Ne!==tt&&En;if(ze||Ct){const Yt={id:Y.id,type:"position",position:{x:ze?gt:Le,y:Ct?Ne:tt}};X.push(Yt),O.current.x=Yt.position.x,O.current.y=Yt.position.y}}if(St||En){const gt={id:y,type:"dimensions",updateStyle:!0,resizing:!0,dimensions:{width:oe,height:Ce}};X.push(gt),O.current.width=oe,O.current.height=Ce}if(X.length===0)return;const jn=qO({width:O.current.width,prevWidth:Me,height:O.current.height,prevHeight:Ve,invertX:j,invertY:z}),Qt={...O.current,direction:jn};if((f==null?void 0:f(F,Qt))===!1)return;b==null||b(F,Qt),B(X)}}).on("end",F=>{const M={id:y,type:"dimensions",resizing:!1};x==null||x(F,{...O.current}),v.getState().triggerNodeChanges([M])});return N.call(U),()=>{N.on(".drag",null)}},[y,I,a,l,c,d,h,L,m,b,x]);const w=I.split("-"),E=n===ga.Line?"borderColor":"backgroundColor",C=o?{...i,[E]:o}:i;return K.createElement("div",{className:Vt(["react-flow__resize-control","nodrag",...w,n,r]),ref:T,style:C},s)}var Gw=D.memo(GO);const WO=["top-left","top-right","bottom-left","bottom-right"],QO=["top","right","bottom","left"];function Ja({nodeId:t,isVisible:e=!0,handleClassName:n,handleStyle:r,lineClassName:i,lineStyle:s,color:o,minWidth:a=10,minHeight:l=10,maxWidth:c=Number.MAX_VALUE,maxHeight:d=Number.MAX_VALUE,keepAspectRatio:h=!1,shouldResize:f,onResizeStart:m,onResize:b,onResizeEnd:x}){return e?K.createElement(K.Fragment,null,QO.map(R=>K.createElement(Gw,{key:R,className:i,style:s,nodeId:t,position:R,variant:ga.Line,color:o,minWidth:a,minHeight:l,maxWidth:c,maxHeight:d,onResizeStart:m,keepAspectRatio:h,shouldResize:f,onResize:b,onResizeEnd:x})),WO.map(R=>K.createElement(Gw,{key:R,className:n,style:r,nodeId:t,position:R,color:o,minWidth:a,minHeight:l,maxWidth:c,maxHeight:d,onResizeStart:m,keepAspectRatio:h,shouldResize:f,onResize:b,onResizeEnd:x}))):null}/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YO=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),GT=(...t)=>t.filter((e,n,r)=>!!e&&r.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var XO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=D.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...a},l)=>D.createElement("svg",{ref:l,...XO,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:GT("lucide",i),...a},[...o.map(([c,d])=>D.createElement(c,d)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=(t,e)=>{const n=D.forwardRef(({className:r,...i},s)=>D.createElement(JO,{ref:s,iconNode:e,className:GT(`lucide-${YO(t)}`,r),...i}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=ae("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=ae("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ez=ae("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tz=ae("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=ae("BoxSelect",[["path",{d:"M5 3a2 2 0 0 0-2 2",key:"y57alp"}],["path",{d:"M19 3a2 2 0 0 1 2 2",key:"18rm91"}],["path",{d:"M21 19a2 2 0 0 1-2 2",key:"1j7049"}],["path",{d:"M5 21a2 2 0 0 1-2-2",key:"sbafld"}],["path",{d:"M9 3h1",key:"1yesri"}],["path",{d:"M9 21h1",key:"15o7lz"}],["path",{d:"M14 3h1",key:"1ec4yj"}],["path",{d:"M14 21h1",key:"v9vybs"}],["path",{d:"M3 9v1",key:"1r0deq"}],["path",{d:"M21 9v1",key:"mxsmne"}],["path",{d:"M3 14v1",key:"vnatye"}],["path",{d:"M21 14v1",key:"169vum"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WT=ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QT=ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nz=ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rz=ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iz=ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sz=ae("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oz=ae("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const az=ae("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=ae("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lz=ae("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cz=ae("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=ae("CornerDownRight",[["polyline",{points:"15 10 20 15 15 20",key:"1q7qjw"}],["path",{d:"M4 4v7a4 4 0 0 0 4 4h12",key:"z08zvw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uz=ae("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dz=ae("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hz=ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=ae("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fz=ae("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XT=ae("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pz=ae("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mz=ae("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=ae("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gz=ae("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yz=ae("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=ae("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qr=ae("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vz=ae("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=ae("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _z=ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oy=ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wz=ae("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xz=ae("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=ae("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ez=ae("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eS=ae("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vp=ae("MousePointer",[["path",{d:"m3 3 7.07 16.97 2.51-7.39 7.39-2.51L3 3z",key:"y2ucgo"}],["path",{d:"m13 13 6 6",key:"1nhxnf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bz=ae("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Iz=ae("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tz=ae("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sz=ae("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cz=ae("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Za=ae("PinOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M9 9v1.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24V17h12",key:"13x2n8"}],["path",{d:"M15 9.34V6h1a2 2 0 0 0 0-4H7.89",key:"reo3ki"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const el=ae("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Az=ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=ae("Recycle",[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kz=ae("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tS=ae("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rz=ae("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nz=ae("RotateCw",[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pz=ae("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nS=ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rS=ae("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dz=ae("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vz=ae("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iS=ae("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sS=ae("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oS=ae("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aS=ae("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oz=ae("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zz=ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lz=ae("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mz=ae("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),jz=({connectionColor:t="#dc2626",setConnectionColor:e=()=>{},connectionLineType:n,setConnectionLineType:r,lastSaved:i,onSave:s,onLoad:o,onClear:a,onHelp:l,isDarkMode:c,toggleTheme:d,searchTerm:h,setSearchTerm:f,onExport:m,isOpen:b,onToggle:x,onOpenCaseManager:R,currentBoardName:y,onToggleZen:v,onNextMatch:T,onPrevMatch:A,onToggleBg:O,onLogout:L,currentUser:S,isSyncing:I})=>{const w=D.useRef(null),[E,C]=D.useState(()=>{try{const j=localStorage.getItem("sidebar-sections");return j?JSON.parse(j):{evidence:!0,connection:!0,extras:!0,zones:!0}}catch{return{evidence:!0,connection:!0,extras:!0,zones:!0}}});D.useEffect(()=>{localStorage.setItem("sidebar-sections",JSON.stringify(E))},[E]);const N=j=>{C(z=>({...z,[j]:!z[j]}))},k=()=>{const j=Object.values(E).some(z=>z);C(Object.keys(E).reduce((z,U)=>({...z,[U]:!j}),{}))},P=(j,z,U)=>{j.dataTransfer.setData("application/reactflow",z),j.dataTransfer.setData("application/category",U),j.dataTransfer.effectAllowed="move"};return p.jsxs("div",{className:`absolute top-0 left-0 h-full z-50 transition-transform duration-300 ease-in-out ${b?"translate-x-0":"-translate-x-full"}`,children:[p.jsxs("aside",{className:`h-full w-80 border-r flex flex-col shadow-2xl backdrop-blur-xl transition-colors duration-500 ease-in-out ${c?"bg-zinc-900/95 border-zinc-800":"bg-white/90 border-gray-200"}`,children:[p.jsxs("div",{className:`p-3 border-b transition-colors duration-500 ${c?"border-zinc-800":"border-gray-200"}`,children:[p.jsxs("div",{className:"flex justify-between items-start",children:[p.jsx("div",{children:p.jsxs("h1",{className:"text-lg font-bold text-red-500 tracking-widest uppercase leading-tight",children:["Detective",p.jsx("br",{}),"Board"]})}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:k,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:Object.values(E).some(j=>j)?"Colapsar todo":"Expandir todo",children:Object.values(E).some(j=>j)?p.jsx(oz,{size:16}):p.jsx(sz,{size:16})}),p.jsx("button",{onClick:v,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Modo Zen (Pantalla Completa)",children:p.jsx(wz,{size:16})}),p.jsx("button",{onClick:O,className:`p-2 rounded-full ${c?"bg-zinc-800 text-zinc-400 hover:bg-zinc-700 hover:text-white":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Cambiar Fondo (Corcho/Pizarra/Papel)",children:p.jsx(Iz,{size:16})}),p.jsx("button",{onClick:d,className:`p-2 rounded-full ${c?"bg-zinc-800 text-yellow-400 hover:bg-zinc-700":"bg-gray-100 text-zinc-600 hover:bg-gray-200"}`,title:"Cambiar tema",children:c?p.jsx(sS,{size:16}):p.jsx(eS,{size:16})})]})]}),y&&p.jsxs("div",{className:"mt-2 px-2 py-1 bg-zinc-100/5 rounded border border-zinc-500/20",children:[p.jsx("p",{className:"text-xs text-zinc-500 font-mono uppercase mb-0",children:"Expediente:"}),p.jsx("p",{className:`text-xs font-bold font-mono truncate w-full ${c?"text-yellow-500":"text-yellow-700"}`,title:y,children:y})]})]}),p.jsx("div",{className:"px-3 pt-2 pb-1",children:p.jsxs("div",{className:`flex items-center px-2 py-1.5 rounded border transition-colors duration-500 ${c?"bg-zinc-950 border-zinc-800":"bg-white border-gray-300"}`,children:[p.jsx(nS,{size:12,className:"text-zinc-500 mr-2"}),p.jsx("input",{type:"text",name:"search",placeholder:"Buscar pistas...",value:h,onChange:j=>f(j.target.value),className:`bg-transparent w-full text-xs outline-none font-mono ${c?"text-zinc-300 placeholder-zinc-600":"text-zinc-700 placeholder-zinc-400"}`}),h&&p.jsxs("div",{className:"flex gap-1 ml-1 border-l border-zinc-700 pl-1",children:[p.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),A()},className:"p-0.5 hover:text-white text-zinc-500 transition-colors",title:"Anterior",children:p.jsx(tz,{size:12})}),p.jsx("button",{type:"button",onClick:j=>{j.preventDefault(),T()},className:"p-0.5 hover:text-white text-zinc-500 transition-colors",title:"Siguiente",children:p.jsx(ZO,{size:12})})]})]})}),p.jsxs("div",{className:"p-3 space-y-2 overflow-y-auto",children:[p.jsx(ad,{title:"Evidencia",icon:pz,isDarkMode:c,isOpen:E.evidence,onToggle:()=>N("evidence"),children:p.jsxs("div",{className:"grid grid-cols-2 gap-1.5",children:[p.jsx(At,{onDragStart:P,type:"evidence",category:"person",icon:ay,label:"Sospechoso",color:"border-blue-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"evidence",category:"place",icon:JT,label:"Lugar",color:"border-green-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"evidence",category:"clue",icon:ry,label:"Pista",color:"border-yellow-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"evidence",category:"event",icon:WT,label:"Evento",color:"border-red-500",isDarkMode:c,compact:!0})]})}),p.jsxs(ad,{title:"Configuracin de Hilo",icon:cg,isDarkMode:c,isOpen:E.connection,onToggle:()=>N("connection"),children:[p.jsx("div",{className:"flex items-center justify-center gap-3 mb-2 px-1 py-0.5",children:[{color:"#dc2626",label:"Rojo"},{color:"#3b82f6",label:"Azul"},{color:"#22c55e",label:"Verde"},{color:"#eab308",label:"Amarillo"},{color:"#a855f7",label:"Morado"}].map(j=>p.jsx("button",{onClick:()=>e(j.color),className:`w-5 h-5 rounded-full border-2 transition-all ${t===j.color?"border-white scale-100 ring-1 ring-zinc-500":"border-transparent hover:scale-100"}`,style:{backgroundColor:j.color},title:j.label},j.color))}),p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:()=>r("straight"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="straight"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Recta",children:p.jsx(ZT,{size:14})}),p.jsx("button",{onClick:()=>r("default"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="default"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Curva",children:p.jsx(cg,{size:14})}),p.jsx("button",{onClick:()=>r("step"),className:`flex-1 py-1.5 rounded border flex justify-center items-center transition-colors ${n==="step"?c?"bg-zinc-800 border-zinc-600 text-white":"bg-white border-gray-300 text-black shadow-sm":c?"border-transparent text-zinc-500 hover:bg-zinc-800/50":"border-transparent text-zinc-400 hover:bg-gray-100"}`,title:"Lnea Escalonada",children:p.jsx(YT,{size:14})})]})]}),p.jsx(ad,{title:"Extras",icon:vz,isDarkMode:c,isOpen:E.extras,onToggle:()=>N("extras"),children:p.jsxs("div",{className:"grid grid-cols-4 gap-1.5",children:[p.jsx(At,{onDragStart:P,type:"note",category:"note",icon:iS,label:"Nota",color:"border-yellow-400",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"text",category:"text",icon:aS,label:"Texto",color:"border-zinc-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"image",category:"image",icon:iy,label:"Imagen",color:"border-purple-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"url",category:"url",icon:sy,label:"URL",color:"border-blue-500",isDarkMode:c,compact:!0})]})}),p.jsx(ad,{title:"Zonas y Sellos",icon:Ww,isDarkMode:c,isOpen:E.zones,onToggle:()=>N("zones"),children:p.jsxs("div",{className:"space-y-2",children:[p.jsx(At,{onDragStart:P,type:"zone",category:"zone",icon:Ww,label:"Zona de Grupo",color:"border-zinc-600",isDarkMode:c}),p.jsxs("div",{className:"grid grid-cols-3 gap-1.5 pt-1",children:[p.jsx(At,{onDragStart:P,type:"stamp",category:"solved",icon:az,label:"Resuelto",color:"border-green-600",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"stamp",category:"discarded",icon:lz,label:"Descartado",color:"border-red-600",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"stamp",category:"key",icon:Vz,label:"Clave",color:"border-yellow-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"stamp",category:"question",icon:ug,label:"?",color:"border-blue-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"stamp",category:"important",icon:oS,label:"!",color:"border-orange-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"stamp",category:"verify",icon:XT,label:"Ojo",color:"border-purple-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"stamp",category:"danger",icon:rS,label:"Peligro",color:"border-red-600",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"stamp",category:"confidential",icon:Na,label:"Top",color:"border-zinc-500",isDarkMode:c,compact:!0}),p.jsx(At,{onDragStart:P,type:"stamp",category:"custom",icon:Tz,label:"Personalizado",color:"border-zinc-400",isDarkMode:c,compact:!0})]})]})})]}),p.jsxs("div",{className:`mt-auto p-3 border-t space-y-2 transition-colors duration-500 ${c?"border-zinc-800":"border-gray-200"}`,children:[p.jsxs("button",{onClick:R,title:"Abrir gestor de expedientes",className:`w-full py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-yellow-900/20 text-yellow-500 border-yellow-900/50 hover:bg-yellow-900/40":"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100"}`,children:[p.jsx(mz,{size:14})," Gestionar Casos"]}),p.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[p.jsxs("button",{onClick:s,className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Guardar (JSON)",children:[p.jsx(Pz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Guardar"})]}),p.jsxs("button",{onClick:()=>w.current.click(),className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Cargar (JSON)",children:[p.jsx(zz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"Cargar"})]}),p.jsxs("button",{onClick:m,className:`flex flex-col items-center justify-center p-2 border rounded transition-colors ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,title:"Exportar (PNG)",children:[p.jsx(hz,{size:16,className:"mb-1"}),p.jsx("span",{className:"text-[9px] font-bold uppercase",children:"PNG"})]})]}),p.jsx("input",{type:"file",name:"file-upload",ref:w,onChange:o,className:"hidden",accept:".json"}),p.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[p.jsxs("button",{onClick:a,title:"Borrar todo el contenido",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-red-900/20 text-red-500 border-red-900/50 hover:bg-red-900/40":"bg-red-50 text-red-600 border-red-200 hover:bg-red-100"}`,children:[p.jsx(dg,{size:14})," Limpiar"]}),p.jsxs("button",{onClick:l,title:"Ver atajos de teclado",className:`py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 ${c?"bg-zinc-900 text-zinc-400 border-zinc-800 hover:bg-zinc-800 hover:text-white":"bg-white text-zinc-600 border-gray-200 hover:bg-gray-50 hover:text-black shadow-sm"}`,children:[p.jsx(ug,{size:14})," Ayuda"]})]}),i&&p.jsxs("div",{className:`text-[10px] text-center mt-2 font-mono ${c?"text-zinc-600":"text-gray-400"}`,children:["Guardado: ",i.toLocaleTimeString()]}),p.jsxs("button",{onClick:L,className:`w-full py-2 border transition-colors text-[10px] uppercase font-bold rounded flex items-center justify-center gap-2 mt-2 ${c?"bg-red-950/50 text-red-500 border-red-900/30 hover:bg-red-900/40":"bg-red-50 text-red-600 border-red-200 hover:bg-red-100"}`,children:[p.jsx(_z,{size:14})," Cerrar Sesin"]})]})]}),p.jsx("button",{onClick:x,className:`absolute top-6 -right-8 p-1.5 rounded-r-md shadow-md border-y border-r cursor-pointer flex items-center justify-center transition-colors duration-500 ${c?"bg-zinc-900 border-zinc-800 text-zinc-400 hover:text-white":"bg-white border-gray-200 text-zinc-600 hover:text-black"}`,title:b?"Ocultar barra lateral":"Mostrar barra lateral",children:b?p.jsx(rz,{size:16}):p.jsx(iz,{size:16})})]})},ad=({title:t,icon:e,isDarkMode:n,children:r,isOpen:i,onToggle:s})=>p.jsxs("div",{className:`p-2 rounded-lg border transition-all duration-200 ${n?"bg-zinc-950/50 border-zinc-800":"bg-white border-gray-200 shadow-sm"}`,children:[p.jsxs("button",{onClick:s,className:`w-full text-xs font-bold uppercase flex items-center justify-between gap-2 ${n?"text-zinc-500 hover:text-zinc-300":"text-zinc-600 hover:text-zinc-800"}`,children:[p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(e,{size:10})," ",t]}),p.jsx("div",{className:`transition-transform duration-300 ${i?"rotate-0":"-rotate-90"}`,children:p.jsx(nz,{size:12})})]}),p.jsx("div",{className:`grid transition-all duration-300 ease-in-out ${i?"grid-rows-[1fr] opacity-100 mt-2":"grid-rows-[0fr] opacity-0 mt-0"}`,children:p.jsx("div",{className:"overflow-hidden",children:r})})]}),At=({onDragStart:t,type:e,category:n,icon:r,label:i,color:s,isDarkMode:o,compact:a})=>p.jsxs("div",{className:`${a?"flex flex-col items-center justify-center p-2 gap-1 text-center":"flex items-center gap-3 p-3"} rounded cursor-grab border-l-4 ${s.replace("border-","border-l-")} transition-all ${a?"hover:scale-105":"hover:translate-x-2"} ${o?"bg-zinc-800/40 border-y border-r border-zinc-800 hover:bg-zinc-800":"bg-white border-y border-r border-gray-200 hover:bg-gray-50 shadow-sm"}`,onDragStart:l=>t(l,e,n),draggable:!0,title:i,children:[p.jsx(r,{size:a?16:18,className:s.replace("border-","text-")}),p.jsx("span",{className:`${a?"text-[10px]":"text-sm"} font-bold font-mono ${o?"text-zinc-300":"text-zinc-700"}`,children:i})]}),Fz=({isOpen:t,onClose:e,node:n,onSave:r,onDelete:i,isDarkMode:s})=>{const[o,a]=D.useState(""),[l,c]=D.useState(""),[d,h]=D.useState(""),[f,m]=D.useState("clue"),[b,x]=D.useState(!1);if(D.useEffect(()=>{n&&(a(n.data.label||""),c(n.data.description||""),h(n.data.image||""),m(n.data.category||"clue"),x(!1))},[n]),!t)return null;if(b)return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm",children:p.jsxs("div",{className:`${s?"bg-zinc-900":"bg-white"} border border-red-900/50 p-6 rounded-lg w-96 shadow-2xl animate-in fade-in zoom-in duration-200 text-center`,children:[p.jsx("h2",{className:"text-xl font-bold text-red-500 font-mono tracking-wider mb-4",children:"ELIMINAR EVIDENCIA?"}),p.jsx("p",{className:`${s?"text-zinc-400":"text-gray-600"} text-sm font-mono mb-6`,children:"Esta accin es irreversible. Ests seguro?"}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsx("button",{onClick:()=>x(!1),className:`px-4 py-2 ${s?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:"Cancelar"}),p.jsx("button",{onClick:()=>i(n.id),className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Confirmar"})]})]})});const R=y=>{y.preventDefault(),r(n.id,{...n.data,label:o,description:l,image:d,category:f}),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm",children:p.jsxs("div",{className:`${s?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-96 shadow-2xl animate-in fade-in zoom-in duration-200`,children:[p.jsxs("div",{className:`flex justify-between items-center mb-4 border-b ${s?"border-zinc-800":"border-gray-200"} pb-2`,children:[p.jsx("h2",{className:"text-xl font-bold text-red-500 font-mono tracking-wider",children:"EDITAR EVIDENCIA"}),p.jsx("button",{onClick:e,className:`${s?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(fs,{size:20})})]}),p.jsxs("form",{onSubmit:R,className:"space-y-4",children:[p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-category",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Categora"}),p.jsxs("select",{id:"evidence-category",name:"evidence-category",value:f,onChange:y=>m(y.target.value),className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all text-sm`,children:[p.jsx("option",{value:"person",children:"Sospechoso"}),p.jsx("option",{value:"place",children:"Lugar"}),p.jsx("option",{value:"clue",children:"Pista"}),p.jsx("option",{value:"event",children:"Evento"})]})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-title",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Ttulo"}),p.jsx("input",{id:"evidence-title",type:"text",name:"evidence-title",value:o,onChange:y=>a(y.target.value),className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all`,autoFocus:!0})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-description",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Descripcin"}),p.jsx("textarea",{id:"evidence-description",name:"evidence-description",value:l,onChange:y=>c(y.target.value),rows:4,className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-300":"bg-gray-50 border-gray-300 text-gray-700"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono text-sm resize-none transition-all`})]}),p.jsxs("div",{children:[p.jsx("label",{htmlFor:"evidence-image-url",className:`block text-xs font-bold ${s?"text-zinc-500":"text-gray-500"} uppercase mb-1 font-mono`,children:"Imagen (URL o Local)"}),p.jsxs("div",{className:"space-y-2",children:[p.jsx("input",{id:"evidence-image-url",type:"text",name:"evidence-image-url",value:d,onChange:y=>h(y.target.value),placeholder:"https://...",className:`w-full ${s?"bg-zinc-950 border-zinc-800 text-gray-400":"bg-gray-50 border-gray-300 text-gray-600"} border p-2 rounded focus:border-red-900 outline-none font-mono text-xs`}),p.jsx("div",{className:`text-[10px] ${s?"text-zinc-600":"text-gray-400"} text-center font-mono uppercase tracking-widest`,children:"- O -"}),p.jsxs("label",{className:`flex items-center justify-center w-full p-2 ${s?"bg-zinc-950 border-zinc-800 hover:border-zinc-600 hover:text-zinc-200":"bg-gray-50 border-gray-300 hover:border-gray-400 hover:text-gray-800"} border border-dashed rounded cursor-pointer transition-colors group`,children:[p.jsx("span",{className:`text-xs ${s?"text-zinc-500 group-hover:text-zinc-300":"text-gray-500 group-hover:text-gray-700"} font-mono uppercase`,children:"Subir archivo local"}),p.jsx("input",{type:"file",name:"evidence-image-file",className:"hidden",accept:"image/*",onChange:y=>{const v=y.target.files[0];if(v){const T=new FileReader;T.onload=A=>h(A.target.result),T.readAsDataURL(v)}}})]})]})]}),n.data.status&&p.jsx("div",{className:`flex justify-end pt-2 border-t ${s?"border-zinc-800":"border-gray-200"}`,children:p.jsxs("button",{type:"button",onClick:()=>{r(n.id,{...n.data,status:null}),e()},className:"text-[10px] flex items-center gap-1 text-orange-500 hover:text-orange-400 uppercase font-bold tracking-wider",children:[p.jsx(ny,{size:12})," Quitar Sello"]})}),p.jsxs("div",{className:`flex justify-between items-center mt-6 pt-4 border-t ${s?"border-zinc-800":"border-gray-200"}`,children:[p.jsx("button",{type:"button",onClick:()=>x(!0),className:"text-red-600 hover:text-red-500 text-xs font-bold uppercase tracking-wider transition-colors",children:"Eliminar"}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:`px-4 py-2 ${s?"text-zinc-400 hover:text-white":"text-gray-500 hover:text-gray-800"} text-xs font-bold uppercase tracking-wider transition-colors`,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Guardar"})]})]})]})]})})};let ld;const $z=new Uint8Array(16);function Uz(){if(!ld&&(ld=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ld))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ld($z)}const zt=[];for(let t=0;t<256;++t)zt.push((t+256).toString(16).slice(1));function Bz(t,e=0){return zt[t[e+0]]+zt[t[e+1]]+zt[t[e+2]]+zt[t[e+3]]+"-"+zt[t[e+4]]+zt[t[e+5]]+"-"+zt[t[e+6]]+zt[t[e+7]]+"-"+zt[t[e+8]]+zt[t[e+9]]+"-"+zt[t[e+10]]+zt[t[e+11]]+zt[t[e+12]]+zt[t[e+13]]+zt[t[e+14]]+zt[t[e+15]]}const Hz=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Xw={randomUUID:Hz};function An(t,e,n){if(Xw.randomUUID&&!t)return Xw.randomUUID();t=t||{};const r=t.random||(t.rng||Uz)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,Bz(r)}function qz({top:t,left:e,right:n,bottom:r,clientX:i,clientY:s,onHide:o,takeSnapshot:a,setNodes:l}){const{screenToFlowPosition:c,setCenter:d,getZoom:h}=Lr(),f=b=>{b.stopPropagation();const{x,y:R}=c({x:i,y:s});d(x,R,{zoom:h(),duration:800}),o()},m=D.useCallback((b,x,R)=>{const y=c({x:i,y:s}),v={id:An(),type:b,position:y,data:{label:R,category:x}};a(),l(T=>T.concat(v)),o()},[i,s,c,a,l,o]);return p.jsxs("div",{style:{top:t,left:e,right:n,bottom:r},className:"absolute z-50 bg-zinc-800 border border-zinc-700 shadow-xl rounded-md overflow-hidden min-w-[150px] flex flex-col animate-in fade-in zoom-in duration-100",children:[p.jsxs("button",{onClick:f,className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors border-b border-zinc-700",children:[p.jsx(dz,{size:14,className:"text-blue-400"})," Centrar Vista"]}),p.jsxs("button",{onClick:()=>m("note","note","Nota"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(iS,{size:14,className:"text-yellow-500"})," Aadir Nota"]}),p.jsxs("button",{onClick:()=>m("text","text","Texto"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(aS,{size:14,className:"text-zinc-400"})," Aadir Texto"]}),p.jsxs("button",{onClick:()=>m("image","image","Imagen"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(iy,{size:14,className:"text-purple-500"})," Aadir Imagen"]}),p.jsxs("button",{onClick:()=>m("url","url","Enlace"),className:"w-full text-left px-4 py-2 text-sm text-zinc-300 hover:bg-zinc-700 hover:text-white flex items-center gap-2 transition-colors",children:[p.jsx(sy,{size:14,className:"text-blue-400"})," Aadir URL"]})]})}const Kz=({isOpen:t,onClose:e,onConfirm:n,title:r,message:i,confirmText:s="Confirmar",cancelText:o="Cancelar",isDanger:a=!1,isDarkMode:l})=>t?p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[300] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${l?"bg-zinc-900":"bg-white"} border ${a?"border-red-900/50":l?"border-zinc-700":"border-gray-200"} p-6 rounded-lg w-96 shadow-2xl animate-in zoom-in duration-200 text-center`,children:[p.jsx("h2",{className:`text-xl font-bold ${a?"text-red-500":l?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-4`,children:r}),p.jsx("p",{className:`${l?"text-zinc-400":"text-gray-600"} text-sm font-mono mb-6`,children:i}),p.jsxs("div",{className:"flex justify-center gap-4",children:[p.jsx("button",{onClick:e,className:`px-4 py-2 ${l?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:o}),p.jsx("button",{onClick:()=>{n&&n(),e()},className:`px-6 py-2 ${a?"bg-red-900/80 hover:bg-red-800 text-red-100 border-red-900":"bg-blue-900/80 hover:bg-blue-800 text-blue-100 border-blue-900"} text-xs font-bold uppercase tracking-wider rounded shadow-lg border transition-all`,children:s})]})]})}):null,Gz=({isOpen:t,onClose:e,isDarkMode:n})=>{if(!t)return null;const r=[{key:"Doble Clic (Nodo)",desc:"Editar contenido de la evidencia",icon:Vp},{key:"Doble Clic (Hilo)",desc:"Aadir/Editar etiqueta de relacin",icon:Vp},{key:"Clic (Hilo)",desc:"Cambiar estilo (Slido / Punteado)",icon:Vp},{key:"Backspace",desc:"Eliminar elementos seleccionados",icon:qr},{key:"Ctrl + D",desc:"Duplicar nodos seleccionados",icon:qr},{key:"Ctrl + Z",desc:"Deshacer accin",icon:qr},{key:"Ctrl + Y",desc:"Rehacer accin",icon:qr},{key:"Ctrl + S",desc:"Guardar tablero manualmente",icon:qr},{key:"Ctrl + V",desc:"Pegar imagen del portapapeles",icon:qr},{key:"F3 / Shift + F3",desc:"Navegar resultados de bsqueda",icon:qr},{key:"Shift + C",desc:"Conectar nodos seleccionados",icon:qr},{key:"Ctrl + Shift + L",desc:"Bloquear/Desbloquear seleccin",icon:Na}];return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${n?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-[500px] shadow-2xl animate-in zoom-in duration-200 relative`,children:[p.jsx("button",{onClick:e,className:`absolute top-4 right-4 ${n?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(fs,{size:20})}),p.jsxs("h2",{className:`text-xl font-bold ${n?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-6 flex items-center gap-2`,children:[p.jsx(qr,{className:"text-red-500"})," ATAJOS DE TECLADO"]}),p.jsx("div",{className:"grid grid-cols-1 gap-3",children:r.map((i,s)=>p.jsxs("div",{className:`flex items-center justify-between p-2 rounded border transition-colors ${n?"bg-zinc-950/50 border-zinc-800/50 hover:border-zinc-700":"bg-gray-50 border-gray-200 hover:border-gray-300"}`,children:[p.jsxs("div",{className:"flex items-center gap-3",children:[p.jsx(i.icon,{size:14,className:n?"text-zinc-500":"text-gray-400"}),p.jsx("span",{className:`${n?"text-zinc-300":"text-gray-700"} text-sm font-mono`,children:i.desc})]}),p.jsx("span",{className:"text-xs font-bold text-red-400 bg-red-900/10 px-2 py-1 rounded border border-red-900/20 font-mono",children:i.key})]},s))})]})})},Wz=({isOpen:t,onClose:e,onConfirm:n,onDelete:r,title:i,initialValue:s="",initialColor:o="#dc2626",initialType:a,showTypeSelector:l=!1,colorLabel:c="Color",placeholder:d="Escribe una relacin...",isDarkMode:h})=>{const[f,m]=D.useState(s),[b,x]=D.useState(o),[R,y]=D.useState(a||"default");if(D.useEffect(()=>{t&&(m(s),x(o),a&&y(a))},[t,s,o,a]),!t)return null;const v=[{color:"#dc2626",label:"Rojo"},{color:"#3b82f6",label:"Azul"},{color:"#22c55e",label:"Verde"},{color:"#eab308",label:"Amarillo"},{color:"#a855f7",label:"Morado"}],T=A=>{A.preventDefault(),n(f,b,R),e()};return p.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-[100] backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${h?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border p-6 rounded-lg w-96 shadow-2xl animate-in zoom-in duration-200`,children:[p.jsx("h2",{className:`text-xl font-bold ${h?"text-zinc-100":"text-gray-800"} font-mono tracking-wider mb-4`,children:i}),p.jsxs("form",{onSubmit:T,children:[p.jsx("input",{type:"text",name:"input-value",value:f,onChange:A=>m(A.target.value),className:`w-full ${h?"bg-zinc-950 border-zinc-800 text-gray-200":"bg-gray-50 border-gray-300 text-gray-900"} border p-2 rounded focus:border-red-900 focus:ring-1 focus:ring-red-900 outline-none font-mono transition-all mb-4`,autoFocus:!0,placeholder:d}),l&&p.jsxs("div",{className:"mb-4",children:[p.jsx("span",{className:`block text-xs font-bold ${h?"text-zinc-500":"text-gray-500"} uppercase mb-2 font-mono`,children:"Tipo de Conexin"}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{type:"button",onClick:()=>y("straight"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="straight"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Recta",children:p.jsx(ZT,{size:16})}),p.jsx("button",{type:"button",onClick:()=>y("default"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="default"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Curva",children:p.jsx(cg,{size:16})}),p.jsx("button",{type:"button",onClick:()=>y("step"),className:`flex-1 py-2 rounded border flex justify-center items-center transition-colors ${R==="step"?h?"bg-zinc-800 border-zinc-500 text-white":"bg-white border-gray-400 text-black shadow-sm":"border-transparent text-zinc-500 hover:bg-zinc-800/50"}`,title:"Escalonada",children:p.jsx(YT,{size:16})})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("span",{className:`block text-xs font-bold ${h?"text-zinc-500":"text-gray-500"} uppercase mb-2 font-mono`,children:c}),p.jsx("div",{className:"flex gap-3",children:v.map(A=>p.jsx("button",{type:"button",onClick:()=>x(A.color),className:`w-6 h-6 rounded-full border-2 transition-all ${b===A.color?(h?"border-white ring-zinc-400":"border-gray-800 ring-gray-400")+" scale-110 ring-1":"border-transparent hover:scale-110"}`,style:{backgroundColor:A.color},title:A.label},A.color))})]}),p.jsxs("div",{className:"flex justify-between items-center",children:[r?p.jsx("button",{type:"button",onClick:r,className:"text-red-600 hover:text-red-500 text-xs font-bold uppercase tracking-wider transition-colors",children:"Eliminar"}):p.jsx("div",{}),p.jsxs("div",{className:"flex gap-3",children:[p.jsx("button",{type:"button",onClick:e,className:`px-4 py-2 ${h?"text-zinc-400 hover:text-white border-zinc-700 hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 border-gray-300 hover:bg-gray-100"} text-xs font-bold uppercase tracking-wider transition-colors border rounded`,children:"Cancelar"}),p.jsx("button",{type:"submit",className:"px-6 py-2 bg-red-900/80 hover:bg-red-800 text-red-100 text-xs font-bold uppercase tracking-wider rounded shadow-lg border border-red-900 transition-all",children:"Guardar"})]})]})]})]})})},Qz=({isOpen:t,onClose:e,boards:n,currentBoardId:r,onSwitch:i,onCreate:s,onDelete:o,onRename:a,onClone:l,onReorder:c,trash:d,onRestore:h,onPermanentDelete:f,isDarkMode:m})=>{const[b,x]=D.useState(null),[R,y]=D.useState(""),[v,T]=D.useState(!1),[A,O]=D.useState(""),[L,S]=D.useState(null),[I,w]=D.useState(""),[E,C]=D.useState("manual"),[N,k]=D.useState(!1),P=D.useMemo(()=>{let Y=(N?d:n).filter(X=>X.name.toLowerCase().includes(I.toLowerCase()));return E==="name"?Y.sort((X,ee)=>X.name.localeCompare(ee.name)):E==="created"?Y.sort((X,ee)=>ee.createdAt-X.createdAt):E==="modified"?Y.sort((X,ee)=>(ee.lastModified||0)-(X.lastModified||0)):Y},[n,d,I,E,N]),j=E==="manual"&&!I&&!N,z=($,Y)=>{$.dataTransfer.setData("boardIndex",Y),$.dataTransfer.effectAllowed="move"},U=$=>{$.preventDefault(),$.dataTransfer.dropEffect="move"},F=($,Y)=>{$.preventDefault();const X=parseInt($.dataTransfer.getData("boardIndex"));if(isNaN(X)||X===Y)return;const ee=[...n],[re]=ee.splice(X,1);ee.splice(Y,0,re),c(ee)};if(!t)return null;const M=$=>{x($.id),y($.name)},B=()=>{R.trim()&&a(b,R),x(null)},G=()=>{A.trim()&&(s(A),O(""),T(!1))};return p.jsx("div",{className:"fixed inset-0 bg-black/90 z-[200] flex items-center justify-center backdrop-blur-sm animate-in fade-in duration-200",children:p.jsxs("div",{className:`${m?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} border w-[900px] h-[600px] rounded-lg shadow-2xl flex flex-col overflow-hidden`,children:[p.jsxs("div",{className:`p-6 border-b ${m?"border-zinc-800 bg-zinc-950":"border-gray-200 bg-gray-50"} flex justify-between items-center z-50 relative`,children:[p.jsxs("div",{children:[p.jsxs("h2",{className:`text-2xl font-bold ${m?"text-zinc-100":"text-gray-800"} font-mono tracking-widest flex items-center gap-3 uppercase`,children:[N?p.jsx(Yw,{className:"text-red-500",size:28}):p.jsx(Qw,{className:"text-yellow-600",size:28}),N?"PAPELERA DE RECICLAJE":"ARCHIVOS DE CASO"]}),p.jsx("p",{className:`${m?"text-zinc-500":"text-gray-500"} text-xs font-mono mt-1`,children:N?"Restaura casos eliminados o brralos definitivamente":"Selecciona un expediente para investigar"})]}),p.jsx("button",{onClick:e,className:`${m?"text-zinc-500 hover:text-white":"text-gray-400 hover:text-gray-700"} transition-colors`,children:p.jsx(fs,{size:24})})]}),p.jsxs("div",{className:`px-6 py-3 border-b flex gap-4 items-center justify-between ${m?"border-zinc-800 bg-zinc-900/50":"border-gray-200 bg-gray-50/50"}`,children:[p.jsxs("div",{className:`flex-1 flex items-center px-3 py-1.5 rounded border ${m?"bg-zinc-950 border-zinc-700":"bg-white border-gray-300"}`,children:[p.jsx(nS,{size:14,className:m?"text-zinc-500":"text-gray-400"}),p.jsx("input",{type:"text",name:"case-search",placeholder:"Buscar expediente...",value:I,onChange:$=>w($.target.value),className:`ml-2 bg-transparent w-full text-xs outline-none font-mono ${m?"text-zinc-300 placeholder-zinc-600":"text-zinc-700 placeholder-zinc-400"}`})]}),p.jsxs("button",{onClick:()=>k(!N),className:`flex items-center gap-2 px-3 py-1.5 rounded border text-xs font-bold uppercase transition-colors ${N?m?"bg-red-900/30 border-red-800 text-red-400":"bg-red-50 border-red-200 text-red-600":m?"bg-zinc-900 border-zinc-700 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-600 hover:text-black"}`,children:[N?p.jsx(Qw,{size:14}):p.jsx(Yw,{size:14}),N?"Ver Archivos":"Papelera"]}),p.jsxs("div",{className:"flex items-center gap-2",children:[p.jsx(ez,{size:14,className:m?"text-zinc-500":"text-gray-400"}),p.jsxs("select",{name:"sort-cases",value:E,onChange:$=>C($.target.value),className:`text-xs font-mono p-1.5 rounded border outline-none cursor-pointer ${m?"bg-zinc-950 border-zinc-700 text-zinc-300":"bg-white border-gray-300 text-zinc-700"}`,children:[p.jsx("option",{value:"manual",children:"Manual (Arrastrar)"}),p.jsx("option",{value:"name",children:"Nombre (A-Z)"}),p.jsx("option",{value:"created",children:"Creado (Reciente)"}),p.jsx("option",{value:"modified",children:"Modificado (Reciente)"})]})]})]}),p.jsx("div",{className:`flex-1 p-8 overflow-y-auto overflow-x-hidden ${m?"bg-zinc-900/50":"bg-gray-100"}`,children:p.jsxs("div",{className:"flex flex-wrap justify-center items-start gap-y-12 pl-8 pb-12 pt-[2px]",children:[!I&&!N&&(v?p.jsx("div",{className:"relative w-56 h-40 -ml-12 first:ml-0 z-50 transition-all duration-300 shadow-2xl transform scale-105",children:p.jsxs("div",{className:`flex flex-col items-center justify-center h-full border-2 border-dashed border-yellow-600/50 bg-yellow-900/10 rounded-lg p-4 animate-in zoom-in duration-200 ${m?"bg-zinc-900":"bg-white"}`,children:[p.jsx("span",{className:"text-yellow-500 font-mono text-xs font-bold mb-2",children:"NOMBRE DEL CASO"}),p.jsx("input",{type:"text",name:"new-case-name",autoFocus:!0,value:A,onChange:$=>O($.target.value),onKeyDown:$=>{$.key==="Enter"&&G(),$.key==="Escape"&&T(!1)},placeholder:"Ej: El Robo del Siglo",className:`${m?"bg-zinc-950 border-zinc-700 text-white":"bg-white border-gray-300 text-gray-900"} border text-xs p-2 w-full rounded outline-none focus:border-yellow-600 font-mono text-center mb-2`}),p.jsxs("div",{className:"flex gap-2",children:[p.jsx("button",{onClick:()=>T(!1),className:`${m?"text-zinc-500 hover:text-white hover:bg-zinc-800":"text-gray-500 hover:text-gray-800 hover:bg-gray-200"} text-[10px] uppercase font-bold px-2 py-1 rounded`,children:"Cancelar"}),p.jsx("button",{onClick:G,className:"text-zinc-900 bg-yellow-600 hover:bg-yellow-500 text-[10px] uppercase font-bold px-3 py-1 rounded",children:"Crear"})]})]})}):p.jsx("button",{onClick:()=>{T(!0),O(`Caso #${n.length+1}`)},className:"relative w-56 h-40 -ml-12 first:ml-0 transition-all duration-300 group",style:{zIndex:L==="new"?50:0,transform:L==="new"?"translateY(-1rem) scale(1.05) rotate(0deg)":"rotate(-3deg)"},onMouseEnter:()=>S("new"),onMouseLeave:()=>S(null),children:p.jsxs("div",{className:`flex flex-col items-center justify-center h-full border-2 border-dashed rounded-lg shadow-lg ${m?"border-zinc-700 hover:border-zinc-500 bg-zinc-800/50":"border-gray-300 hover:border-gray-400 bg-white"}`,children:[p.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center mb-3 transition-all group-hover:scale-110 ${m?"bg-zinc-800 group-hover:bg-zinc-700":"bg-gray-200 group-hover:bg-gray-300"}`,children:p.jsx(Az,{className:m?"text-zinc-400 group-hover:text-white":"text-gray-500 group-hover:text-gray-800"})}),p.jsx("span",{className:`${m?"text-zinc-400 group-hover:text-white":"text-gray-500 group-hover:text-gray-800"} font-mono text-sm font-bold`,children:"NUEVO CASO"})]})})),P.map(($,Y)=>{const X=L===$.id,ee=r===$.id,re=$.isDeleting,fe=Y%3===0?"2deg":Y%3===1?"-1deg":"3deg";return p.jsx("div",{draggable:j,onDragStart:ie=>z(ie,Y),onDragOver:U,onDrop:ie=>F(ie,Y),className:"relative w-56 h-40 -ml-12 transition-all duration-300 ease-out cursor-pointer group",style:{zIndex:X?50:Y+1,transform:X?"translateY(-1.5rem) scale(1.1) rotate(0deg)":`rotate(${fe})`,animation:re?"delete-burn 0.5s ease-in-out forwards":"none",pointerEvents:re?"none":"auto"},onMouseEnter:()=>S($.id),onMouseLeave:()=>S(null),onClick:()=>{b!==$.id&&!N&&i($.id)},children:p.jsxs("div",{className:`relative flex flex-col h-full border-2 rounded-lg overflow-hidden shadow-[0_5px_15px_rgba(0,0,0,0.5)] transition-colors duration-300
                    ${ee?m?"border-yellow-500 bg-yellow-900/40":"border-yellow-500 bg-yellow-100":m?N?"border-zinc-700 bg-zinc-900/50":"border-yellow-900/40 bg-yellow-950/30 hover:border-yellow-700 hover:bg-yellow-900/20":N?"border-gray-300 bg-gray-100":"border-yellow-200 bg-yellow-50 hover:border-yellow-300 hover:bg-yellow-100"}
                `,children:[j&&X&&p.jsx("div",{className:"absolute top-2 right-2 text-yellow-600/50",children:p.jsx(yz,{size:16})}),p.jsx("div",{className:`absolute top-0 left-0 w-24 h-6 rounded-br-lg border-b-2 border-r-2 shadow-sm transition-colors duration-300
                        ${ee?"bg-yellow-500 border-yellow-500":m?N?"bg-zinc-800 border-zinc-700":"bg-yellow-900/40 border-yellow-900/40 group-hover:bg-yellow-800 group-hover:border-yellow-700":N?"bg-gray-300 border-gray-300":"bg-yellow-200 border-yellow-200 group-hover:bg-yellow-300 group-hover:border-yellow-300"}
                    `}),p.jsxs("div",{className:"flex-1 p-4 pt-8 flex flex-col items-center justify-between text-center",children:[p.jsxs("div",{children:[p.jsx(ry,{size:32,className:`mb-2 drop-shadow-md transition-colors duration-300 ${ee?m?"text-yellow-400":"text-yellow-600":m?"text-yellow-800/60 group-hover:text-yellow-600":"text-yellow-300 group-hover:text-yellow-500"}`}),b===$.id?p.jsxs("div",{className:"flex items-center gap-1 w-full",onClick:ie=>ie.stopPropagation(),children:[p.jsx("input",{type:"text",name:"edit-case-name",value:R,onChange:ie=>y(ie.target.value),className:`${m?"bg-zinc-950 border-zinc-600 text-white":"bg-white border-gray-300 text-gray-900"} border text-xs p-1 w-full rounded outline-none focus:border-yellow-600 font-mono`,autoFocus:!0,onKeyDown:ie=>ie.key==="Enter"&&B()}),p.jsx("button",{onClick:B,className:"text-green-500 hover:text-green-400",children:p.jsx(QT,{size:14})})]}):p.jsx("h3",{className:`font-mono font-bold text-sm line-clamp-2 ${r===$.id?m?"text-yellow-100":"text-yellow-800":m?N?"text-zinc-500 line-through":"text-zinc-300":N?"text-gray-400 line-through":"text-gray-700"}`,onDoubleClick:ie=>{N||(ie.stopPropagation(),M($))},children:$.name})]}),p.jsxs("div",{className:`text-[10px] ${m?"text-zinc-500":"text-gray-500"} font-mono w-full`,children:[$.lastModified&&p.jsxs("p",{children:["Modif: ",new Date($.lastModified).toLocaleString([],{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})]}),p.jsxs("p",{className:`${m?"text-zinc-600":"text-gray-400"}`,children:["Creado: ",new Date($.createdAt).toLocaleDateString()]})]})]}),p.jsx("div",{className:`absolute bottom-2 right-2 flex gap-1 ${N?"opacity-100":"opacity-0 group-hover:opacity-100"} transition-opacity z-50`,onClick:ie=>ie.stopPropagation(),children:N?p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:ie=>{ie.stopPropagation(),h($.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-green-500 hover:text-green-400 hover:bg-zinc-950 border-zinc-700":"bg-white text-green-600 hover:text-green-700 hover:bg-gray-50 border-gray-200"}`,title:"Restaurar Caso",children:p.jsx(tS,{size:12})}),p.jsx("button",{onClick:ie=>{ie.stopPropagation(),f($.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-red-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-red-600 hover:bg-gray-50 border-gray-200"}`,title:"Eliminar Definitivamente",children:p.jsx(dg,{size:12})})]}):p.jsxs(p.Fragment,{children:[p.jsx("button",{onClick:ie=>{ie.preventDefault(),ie.stopPropagation(),l($.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-green-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-green-600 hover:bg-gray-50 border-gray-200"}`,title:"Clonar Caso",children:p.jsx(cz,{size:12})}),p.jsx("button",{onClick:ie=>{ie.stopPropagation(),M($)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-blue-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-blue-600 hover:bg-gray-50 border-gray-200"}`,title:"Renombrar Caso",children:p.jsx(Cz,{size:12})}),n.length>1&&p.jsx("button",{onClick:ie=>{ie.stopPropagation(),o($.id)},className:`p-1.5 rounded border ${m?"bg-zinc-900 text-zinc-500 hover:text-red-500 hover:bg-zinc-950 border-zinc-700":"bg-white text-gray-400 hover:text-red-600 hover:bg-gray-50 border-gray-200"}`,title:"Mover a Papelera",children:p.jsx(dg,{size:12})})]})})]})},$.id)})]})}),p.jsx("div",{className:`p-4 border-t text-center z-50 relative ${m?"bg-zinc-950 border-zinc-800":"bg-gray-50 border-gray-200"}`,children:p.jsx("p",{className:`${m?"text-zinc-600":"text-gray-400"} text-[10px] font-mono`,children:"CONFIDENCIAL - SOLO PARA USO OFICIAL"})})]})})},Yz=({isZenMode:t,setIsZenMode:e,undo:n,redo:r,isDarkMode:i})=>p.jsxs("div",{className:"absolute top-4 right-4 z-50 flex gap-2",children:[!t&&p.jsxs(p.Fragment,{children:[p.jsxs("button",{onClick:n,className:`px-4 py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 shadow-lg ${i?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-white text-zinc-600 border-gray-300 hover:bg-gray-100"}`,title:"Deshacer (Ctrl+Z)",children:[p.jsx(Oz,{size:14})," Deshacer"]}),p.jsxs("button",{onClick:r,className:`px-4 py-2 border transition-colors text-xs uppercase font-bold rounded flex items-center justify-center gap-2 shadow-lg ${i?"bg-zinc-800 text-zinc-300 border-zinc-700 hover:bg-zinc-700":"bg-white text-zinc-600 border-gray-300 hover:bg-gray-100"}`,title:"Rehacer (Ctrl+Y)",children:[p.jsx(kz,{size:14})," Rehacer"]})]}),t&&p.jsxs("button",{onClick:()=>e(!1),className:"px-4 py-2 bg-black/50 hover:bg-black/80 text-white border border-white/20 rounded backdrop-blur-sm flex items-center gap-2 transition-all animate-in fade-in",title:"Salir de Modo Zen (Esc)",children:[p.jsx(xz,{size:14})," Salir"]})]}),ly=(t,e)=>{if(!t||!t.type.startsWith("image/"))return;const n=new FileReader;n.onload=r=>{const i=new Image;i.onload=()=>{let o=i.width,a=i.height;if(o>400||a>400){const h=o/a;o>a?(o=400,a=400/h):(a=400,o=400*h)}const l=document.createElement("canvas");l.width=o,l.height=a,l.getContext("2d").drawImage(i,0,0,o,a);const d=l.toDataURL("image/jpeg",.7);e(d,o,a)},i.src=r.target.result},n.readAsDataURL(t)},Xz=({isInteractive:t,reactFlowInstance:e,takeSnapshot:n,setNodes:r})=>{D.useEffect(()=>{const i=s=>{if(!t||!e)return;const o=s.clipboardData.items;for(const a of o)if(a.type.indexOf("image")!==-1){const l=a.getAsFile();ly(l,(c,d,h)=>{const f=e.screenToFlowPosition({x:window.innerWidth/2,y:window.innerHeight/2}),m={id:An(),type:"image",position:f,data:{label:"Imagen Pegada",image:c},style:{width:d,height:h}};n(),r(b=>b.concat(m))})}};return window.addEventListener("paste",i),()=>window.removeEventListener("paste",i)},[e,t,n,r])};function Jz(t,e){if(t.match(/^[a-z]+:\/\//i))return t;if(t.match(/^\/\//))return window.location.protocol+t;if(t.match(/^[a-z]+:/i))return t;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),i=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(i),e&&(r.href=e),i.href=t,i.href}const Zz=(()=>{let t=0;const e=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(t+=1,`u${e()}${t}`)})();function Zi(t){const e=[];for(let n=0,r=t.length;n<r;n++)e.push(t[n]);return e}let zo=null;function lS(t={}){return zo||(t.includeStyleProperties?(zo=t.includeStyleProperties,zo):(zo=Zi(window.getComputedStyle(document.documentElement)),zo))}function Sh(t,e){const r=(t.ownerDocument.defaultView||window).getComputedStyle(t).getPropertyValue(e);return r?parseFloat(r.replace("px","")):0}function eL(t){const e=Sh(t,"border-left-width"),n=Sh(t,"border-right-width");return t.clientWidth+e+n}function tL(t){const e=Sh(t,"border-top-width"),n=Sh(t,"border-bottom-width");return t.clientHeight+e+n}function cS(t,e={}){const n=e.width||eL(t),r=e.height||tL(t);return{width:n,height:r}}function nL(){let t,e;try{e=process}catch{}const n=e&&e.env?e.env.devicePixelRatio:null;return n&&(t=parseInt(n,10),Number.isNaN(t)&&(t=1)),t||window.devicePixelRatio||1}const Tn=16384;function rL(t){(t.width>Tn||t.height>Tn)&&(t.width>Tn&&t.height>Tn?t.width>t.height?(t.height*=Tn/t.width,t.width=Tn):(t.width*=Tn/t.height,t.height=Tn):t.width>Tn?(t.height*=Tn/t.width,t.width=Tn):(t.width*=Tn/t.height,t.height=Tn))}function Ch(t){return new Promise((e,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>e(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=t})}async function iL(t){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(t)).then(encodeURIComponent).then(e=>`data:image/svg+xml;charset=utf-8,${e}`)}async function sL(t,e,n){const r="http://www.w3.org/2000/svg",i=document.createElementNS(r,"svg"),s=document.createElementNS(r,"foreignObject");return i.setAttribute("width",`${e}`),i.setAttribute("height",`${n}`),i.setAttribute("viewBox",`0 0 ${e} ${n}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),s.setAttribute("x","0"),s.setAttribute("y","0"),s.setAttribute("externalResourcesRequired","true"),i.appendChild(s),s.appendChild(t),iL(i)}const vn=(t,e)=>{if(t instanceof e)return!0;const n=Object.getPrototypeOf(t);return n===null?!1:n.constructor.name===e.name||vn(n,e)};function oL(t){const e=t.getPropertyValue("content");return`${t.cssText} content: '${e.replace(/'|"/g,"")}';`}function aL(t,e){return lS(e).map(n=>{const r=t.getPropertyValue(n),i=t.getPropertyPriority(n);return`${n}: ${r}${i?" !important":""};`}).join(" ")}function lL(t,e,n,r){const i=`.${t}:${e}`,s=n.cssText?oL(n):aL(n,r);return document.createTextNode(`${i}{${s}}`)}function Jw(t,e,n,r){const i=window.getComputedStyle(t,n),s=i.getPropertyValue("content");if(s===""||s==="none")return;const o=Zz();try{e.className=`${e.className} ${o}`}catch{return}const a=document.createElement("style");a.appendChild(lL(o,n,i,r)),e.appendChild(a)}function cL(t,e,n){Jw(t,e,":before",n),Jw(t,e,":after",n)}const Zw="application/font-woff",ex="image/jpeg",uL={woff:Zw,woff2:Zw,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:ex,jpeg:ex,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function dL(t){const e=/\.([^./]*?)$/g.exec(t);return e?e[1]:""}function cy(t){const e=dL(t).toLowerCase();return uL[e]||""}function hL(t){return t.split(/,/)[1]}function hg(t){return t.search(/^(data:)/)!==-1}function fL(t,e){return`data:${e};base64,${t}`}async function uS(t,e,n){const r=await fetch(t,e);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const i=await r.blob();return new Promise((s,o)=>{const a=new FileReader;a.onerror=o,a.onloadend=()=>{try{s(n({res:r,result:a.result}))}catch(l){o(l)}},a.readAsDataURL(i)})}const Op={};function pL(t,e,n){let r=t.replace(/\?.*/,"");return n&&(r=t),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),e?`[${e}]${r}`:r}async function uy(t,e,n){const r=pL(t,e,n.includeQueryParams);if(Op[r]!=null)return Op[r];n.cacheBust&&(t+=(/\?/.test(t)?"&":"?")+new Date().getTime());let i;try{const s=await uS(t,n.fetchRequestInit,({res:o,result:a})=>(e||(e=o.headers.get("Content-Type")||""),hL(a)));i=fL(s,e)}catch(s){i=n.imagePlaceholder||"";let o=`Failed to fetch resource: ${t}`;s&&(o=typeof s=="string"?s:s.message),o&&console.warn(o)}return Op[r]=i,i}async function mL(t){const e=t.toDataURL();return e==="data:,"?t.cloneNode(!1):Ch(e)}async function gL(t,e){if(t.currentSrc){const s=document.createElement("canvas"),o=s.getContext("2d");s.width=t.clientWidth,s.height=t.clientHeight,o==null||o.drawImage(t,0,0,s.width,s.height);const a=s.toDataURL();return Ch(a)}const n=t.poster,r=cy(n),i=await uy(n,r,e);return Ch(i)}async function yL(t,e){var n;try{if(!((n=t==null?void 0:t.contentDocument)===null||n===void 0)&&n.body)return await xf(t.contentDocument.body,e,!0)}catch{}return t.cloneNode(!1)}async function vL(t,e){return vn(t,HTMLCanvasElement)?mL(t):vn(t,HTMLVideoElement)?gL(t,e):vn(t,HTMLIFrameElement)?yL(t,e):t.cloneNode(dS(t))}const _L=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SLOT",dS=t=>t.tagName!=null&&t.tagName.toUpperCase()==="SVG";async function wL(t,e,n){var r,i;if(dS(e))return e;let s=[];return _L(t)&&t.assignedNodes?s=Zi(t.assignedNodes()):vn(t,HTMLIFrameElement)&&(!((r=t.contentDocument)===null||r===void 0)&&r.body)?s=Zi(t.contentDocument.body.childNodes):s=Zi(((i=t.shadowRoot)!==null&&i!==void 0?i:t).childNodes),s.length===0||vn(t,HTMLVideoElement)||await s.reduce((o,a)=>o.then(()=>xf(a,n)).then(l=>{l&&e.appendChild(l)}),Promise.resolve()),e}function xL(t,e,n){const r=e.style;if(!r)return;const i=window.getComputedStyle(t);i.cssText?(r.cssText=i.cssText,r.transformOrigin=i.transformOrigin):lS(n).forEach(s=>{let o=i.getPropertyValue(s);s==="font-size"&&o.endsWith("px")&&(o=`${Math.floor(parseFloat(o.substring(0,o.length-2)))-.1}px`),vn(t,HTMLIFrameElement)&&s==="display"&&o==="inline"&&(o="block"),s==="d"&&e.getAttribute("d")&&(o=`path(${e.getAttribute("d")})`),r.setProperty(s,o,i.getPropertyPriority(s))})}function EL(t,e){vn(t,HTMLTextAreaElement)&&(e.innerHTML=t.value),vn(t,HTMLInputElement)&&e.setAttribute("value",t.value)}function bL(t,e){if(vn(t,HTMLSelectElement)){const n=e,r=Array.from(n.children).find(i=>t.value===i.getAttribute("value"));r&&r.setAttribute("selected","")}}function IL(t,e,n){return vn(e,Element)&&(xL(t,e,n),cL(t,e,n),EL(t,e),bL(t,e)),e}async function TL(t,e){const n=t.querySelectorAll?t.querySelectorAll("use"):[];if(n.length===0)return t;const r={};for(let s=0;s<n.length;s++){const a=n[s].getAttribute("xlink:href");if(a){const l=t.querySelector(a),c=document.querySelector(a);!l&&c&&!r[a]&&(r[a]=await xf(c,e,!0))}}const i=Object.values(r);if(i.length){const s="http://www.w3.org/1999/xhtml",o=document.createElementNS(s,"svg");o.setAttribute("xmlns",s),o.style.position="absolute",o.style.width="0",o.style.height="0",o.style.overflow="hidden",o.style.display="none";const a=document.createElementNS(s,"defs");o.appendChild(a);for(let l=0;l<i.length;l++)a.appendChild(i[l]);t.appendChild(o)}return t}async function xf(t,e,n){return!n&&e.filter&&!e.filter(t)?null:Promise.resolve(t).then(r=>vL(r,e)).then(r=>wL(t,r,e)).then(r=>IL(t,r,e)).then(r=>TL(r,e))}const hS=/url\((['"]?)([^'"]+?)\1\)/g,SL=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,CL=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function AL(t){const e=t.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${e})(['"]?\\))`,"g")}function kL(t){const e=[];return t.replace(hS,(n,r,i)=>(e.push(i),n)),e.filter(n=>!hg(n))}async function RL(t,e,n,r,i){try{const s=n?Jz(e,n):e,o=cy(e);let a;return i||(a=await uy(s,o,r)),t.replace(AL(e),`$1${a}$3`)}catch{}return t}function NL(t,{preferredFontFormat:e}){return e?t.replace(CL,n=>{for(;;){const[r,,i]=SL.exec(n)||[];if(!i)return"";if(i===e)return`src: ${r};`}}):t}function fS(t){return t.search(hS)!==-1}async function pS(t,e,n){if(!fS(t))return t;const r=NL(t,n);return kL(r).reduce((s,o)=>s.then(a=>RL(a,o,e,n)),Promise.resolve(r))}async function Lo(t,e,n){var r;const i=(r=e.style)===null||r===void 0?void 0:r.getPropertyValue(t);if(i){const s=await pS(i,null,n);return e.style.setProperty(t,s,e.style.getPropertyPriority(t)),!0}return!1}async function PL(t,e){await Lo("background",t,e)||await Lo("background-image",t,e),await Lo("mask",t,e)||await Lo("-webkit-mask",t,e)||await Lo("mask-image",t,e)||await Lo("-webkit-mask-image",t,e)}async function DL(t,e){const n=vn(t,HTMLImageElement);if(!(n&&!hg(t.src))&&!(vn(t,SVGImageElement)&&!hg(t.href.baseVal)))return;const r=n?t.src:t.href.baseVal,i=await uy(r,cy(r),e);await new Promise((s,o)=>{t.onload=s,t.onerror=e.onImageErrorHandler?(...l)=>{try{s(e.onImageErrorHandler(...l))}catch(c){o(c)}}:o;const a=t;a.decode&&(a.decode=s),a.loading==="lazy"&&(a.loading="eager"),n?(t.srcset="",t.src=i):t.href.baseVal=i})}async function VL(t,e){const r=Zi(t.childNodes).map(i=>mS(i,e));await Promise.all(r).then(()=>t)}async function mS(t,e){vn(t,Element)&&(await PL(t,e),await DL(t,e),await VL(t,e))}function OL(t,e){const{style:n}=t;e.backgroundColor&&(n.backgroundColor=e.backgroundColor),e.width&&(n.width=`${e.width}px`),e.height&&(n.height=`${e.height}px`);const r=e.style;return r!=null&&Object.keys(r).forEach(i=>{n[i]=r[i]}),t}const tx={};async function nx(t){let e=tx[t];if(e!=null)return e;const r=await(await fetch(t)).text();return e={url:t,cssText:r},tx[t]=e,e}async function rx(t,e){let n=t.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,s=(n.match(/url\([^)]+\)/g)||[]).map(async o=>{let a=o.replace(r,"$1");return a.startsWith("https://")||(a=new URL(a,t.url).href),uS(a,e.fetchRequestInit,({result:l})=>(n=n.replace(o,`url(${l})`),[o,l]))});return Promise.all(s).then(()=>n)}function ix(t){if(t==null)return[];const e=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=t.replace(n,"");const i=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const l=i.exec(r);if(l===null)break;e.push(l[0])}r=r.replace(i,"");const s=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,o="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",a=new RegExp(o,"gi");for(;;){let l=s.exec(r);if(l===null){if(l=a.exec(r),l===null)break;s.lastIndex=a.lastIndex}else a.lastIndex=s.lastIndex;e.push(l[0])}return e}async function zL(t,e){const n=[],r=[];return t.forEach(i=>{if("cssRules"in i)try{Zi(i.cssRules||[]).forEach((s,o)=>{if(s.type===CSSRule.IMPORT_RULE){let a=o+1;const l=s.href,c=nx(l).then(d=>rx(d,e)).then(d=>ix(d).forEach(h=>{try{i.insertRule(h,h.startsWith("@import")?a+=1:i.cssRules.length)}catch(f){console.error("Error inserting rule from remote css",{rule:h,error:f})}})).catch(d=>{console.error("Error loading remote css",d.toString())});r.push(c)}})}catch(s){const o=t.find(a=>a.href==null)||document.styleSheets[0];i.href!=null&&r.push(nx(i.href).then(a=>rx(a,e)).then(a=>ix(a).forEach(l=>{o.insertRule(l,o.cssRules.length)})).catch(a=>{console.error("Error loading remote stylesheet",a)})),console.error("Error inlining remote css file",s)}}),Promise.all(r).then(()=>(t.forEach(i=>{if("cssRules"in i)try{Zi(i.cssRules||[]).forEach(s=>{n.push(s)})}catch(s){console.error(`Error while reading CSS rules from ${i.href}`,s)}}),n))}function LL(t){return t.filter(e=>e.type===CSSRule.FONT_FACE_RULE).filter(e=>fS(e.style.getPropertyValue("src")))}async function ML(t,e){if(t.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Zi(t.ownerDocument.styleSheets),r=await zL(n,e);return LL(r)}function gS(t){return t.trim().replace(/["']/g,"")}function jL(t){const e=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(s=>{e.add(gS(s))}),Array.from(r.children).forEach(s=>{s instanceof HTMLElement&&n(s)})}return n(t),e}async function FL(t,e){const n=await ML(t,e),r=jL(t);return(await Promise.all(n.filter(s=>r.has(gS(s.style.fontFamily))).map(s=>{const o=s.parentStyleSheet?s.parentStyleSheet.href:null;return pS(s.cssText,o,e)}))).join(`
`)}async function $L(t,e){const n=e.fontEmbedCSS!=null?e.fontEmbedCSS:e.skipFonts?null:await FL(t,e);if(n){const r=document.createElement("style"),i=document.createTextNode(n);r.appendChild(i),t.firstChild?t.insertBefore(r,t.firstChild):t.appendChild(r)}}async function UL(t,e={}){const{width:n,height:r}=cS(t,e),i=await xf(t,e,!0);return await $L(i,e),await mS(i,e),OL(i,e),await sL(i,n,r)}async function BL(t,e={}){const{width:n,height:r}=cS(t,e),i=await UL(t,e),s=await Ch(i),o=document.createElement("canvas"),a=o.getContext("2d"),l=e.pixelRatio||nL(),c=e.canvasWidth||n,d=e.canvasHeight||r;return o.width=c*l,o.height=d*l,e.skipAutoScale||rL(o),o.style.width=`${c}`,o.style.height=`${d}`,e.backgroundColor&&(a.fillStyle=e.backgroundColor,a.fillRect(0,0,o.width,o.height)),a.drawImage(s,0,0,o.width,o.height),o}async function sx(t,e={}){return(await BL(t,e)).toDataURL()}const HL=({reactFlowWrapper:t,reactFlowInstance:e,boards:n,currentBoardId:r,bgType:i,isDarkMode:s,setNodes:o})=>{const[a,l]=D.useState(!1),c=D.useCallback(async()=>{if(t.current===null||!e||!o)return;l(!0),await new Promise(z=>setTimeout(z,100));const{x:d,y:h,zoom:f}=e.getViewport(),m=e.getNodes(),b=m.filter(z=>z.selected),x=b.map(z=>z.id);x.length>0&&(o(z=>z.map(U=>({...U,selected:!1}))),await new Promise(z=>setTimeout(z,50)));const R=b.length>0?b:m;if(R.length===0){l(!1),x.length>0&&o(z=>z.map(U=>({...U,selected:x.includes(U.id)})));return}const y=uu(R),v=100,T=y.width+v*2,A=y.height+v*2,O=-y.x+v,L=-y.y+v;e.setViewport({x:O,y:L,zoom:1}),await new Promise(z=>setTimeout(z,1e3)),document.fonts&&await document.fonts.ready;const I=t.current.querySelector(".react-flow");if(!I){l(!1),x.length>0&&o(z=>z.map(U=>({...U,selected:x.includes(U.id)})));return}const w=n.find(z=>z.id===r),C=(w?w.name:"Tablero sin nombre").toUpperCase(),N=Math.max(16,Math.min(72,T*.04)),k=N*.5;let P={};i==="cork"?P={backgroundColor:s?"#18181b":"#e5e5e5",backgroundImage:s?"radial-gradient(rgba(255,255,255,0.05) 1px, transparent 1px), radial-gradient(rgba(255,255,255,0.02) 1px, transparent 1px)":"radial-gradient(#999 1px, transparent 1px), radial-gradient(#999 1px, transparent 1px)",backgroundSize:"40px 40px",backgroundPosition:"0 0, 20px 20px"}:i==="blackboard"?P={backgroundColor:s?"#27272a":"#ffffff",backgroundImage:s?"linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px)":"radial-gradient(#e5e7eb 2px, transparent 2px)",backgroundSize:s?"100px 100px":"30px 30px"}:P={backgroundColor:s?"#1e293b":"#f0f9ff",backgroundImage:s?"linear-gradient(#334155 1px, transparent 1px), linear-gradient(90deg, #334155 1px, transparent 1px)":"linear-gradient(#cbd5e1 1px, transparent 1px), linear-gradient(90deg, #cbd5e1 1px, transparent 1px)",backgroundSize:"20px 20px"};const j={pixelRatio:2,skipAutoScale:!0,backgroundColor:P.backgroundColor,width:T,height:A,style:{width:`${T}px`,height:`${A}px`,overflow:"visible",fontFamily:"'Courier Prime', monospace",...P},imagePlaceholder:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",filter:z=>!(z.classList&&(z.classList.contains("react-flow__controls")||z.classList.contains("react-flow__minimap")||z.classList.contains("react-flow__attribution")))};try{let z;try{z=await sx(I,{...j,useCORS:!0})}catch(re){console.warn("Error exportando con CORS, reintentando sin CORS...",re),await new Promise(fe=>setTimeout(fe,1e3)),z=await sx(I,{...j,useCORS:!1})}const U=document.createElement("canvas"),F=j.pixelRatio||1;U.width=T*F,U.height=A*F;const M=U.getContext("2d"),B=new Image;await new Promise((re,fe)=>{B.onload=re,B.onerror=fe,B.src=z}),M.drawImage(B,0,0);const G=N*F;M.font=`bold ${G}px "Courier Prime", monospace`,M.fillStyle=s?"rgba(255, 255, 255, 0.4)":"rgba(0, 0, 0, 0.4)",M.shadowColor=s?"rgba(0, 0, 0, 0.7)":"rgba(0, 0, 0, 0.2)",M.shadowBlur=3*F,M.shadowOffsetX=1*F,M.shadowOffsetY=1*F,M.textAlign="right",M.textBaseline="bottom";const $=k*F;M.fillText(C,U.width-$,U.height-$),z=U.toDataURL("image/png");const Y=document.createElement("a"),X=n.find(re=>re.id===r),ee=X?X.name.replace(/[^a-z0-9\u00C0-\u017F\s-_]/gi,""):"caso-detective";Y.download=`${ee}.png`,Y.href=z,Y.click()}catch(z){console.error("Error al exportar",z),alert("Error al generar la imagen. Si utilizas imgenes externas (URL), es posible que tengan restricciones de seguridad (CORS).")}finally{e.setViewport({x:d,y:h,zoom:f}),x.length>0&&o(z=>z.map(U=>({...U,selected:x.includes(U.id)}))),l(!1)}},[t,s,e,n,r,i,o]);return{isExporting:a,onExport:c}},qL="default-case",zp=(t,e=[])=>{let n=localStorage.getItem(`board-${t}-nodes`),r=localStorage.getItem(`board-${t}-edges`),i=localStorage.getItem(`board-${t}-bg`);return!n&&t===qL&&(n=localStorage.getItem("detective-board-nodes"),r=localStorage.getItem("detective-board-edges")),{nodes:n?JSON.parse(n):e,edges:r?JSON.parse(r):[],bgType:i||"cork"}},cd="default-case",KL=({nodes:t,edges:e,bgType:n,setNodes:r,setEdges:i,setBgType:s,reactFlowInstance:o,clearHistory:a,setCaseManagerOpen:l,setConfirmModal:c,lastSaved:d})=>{const[h,f]=D.useState(()=>{try{const w=localStorage.getItem("detective-boards-list");return w?JSON.parse(w):localStorage.getItem("detective-board-nodes")?[{id:cd,name:"Caso #001: Principal",createdAt:Date.now(),lastModified:Date.now()}]:[{id:cd,name:"Caso #001: Nuevo",createdAt:Date.now(),lastModified:Date.now()}]}catch{return[{id:cd,name:"Caso #001: Nuevo",createdAt:Date.now(),lastModified:Date.now()}]}}),[m,b]=D.useState(()=>{try{const w=localStorage.getItem("detective-boards-trash");return w?JSON.parse(w):[]}catch{return[]}}),[x,R]=D.useState(()=>localStorage.getItem("detective-current-board-id")||cd);D.useEffect(()=>{localStorage.setItem("detective-boards-list",JSON.stringify(h))},[h]),D.useEffect(()=>{localStorage.setItem("detective-boards-trash",JSON.stringify(m))},[m]),D.useEffect(()=>{localStorage.setItem("detective-current-board-id",x)},[x]),D.useEffect(()=>{d&&f(w=>w.map(E=>E.id===x?{...E,lastModified:d.getTime()}:E))},[d,x]),D.useEffect(()=>{const w=h.find(E=>E.id===x);w&&(document.title=`${w.name} | Detective Board`)},[x,h]);const y=D.useCallback(w=>{localStorage.setItem(`board-${x}-nodes`,JSON.stringify(t)),localStorage.setItem(`board-${x}-edges`,JSON.stringify(e)),localStorage.setItem(`board-${x}-bg`,n);const E=zp(w);r(E.nodes),i(E.edges),s(E.bgType),R(w),a(),l(!1),o&&setTimeout(()=>{o.fitView({duration:800,padding:.2})},100)},[x,t,e,n,r,i,s,a,o,l]),v=w=>{if(!w)return;const E=An(),C={id:E,name:w,createdAt:Date.now(),lastModified:Date.now()};f(N=>[...N,C]),y(E)},T=w=>{h.length<=1||c({isOpen:!0,title:"MOVER A PAPELERA?",message:"El caso se mover a la papelera. Podrs restaurarlo si lo necesitas.",isDanger:!0,confirmText:"Mover",onConfirm:()=>{f(E=>E.map(C=>C.id===w?{...C,isDeleting:!0}:C)),setTimeout(()=>{const E=h.find(N=>N.id===w),C=h.filter(N=>N.id!==w);if(E){const{isDeleting:N,...k}=E;b(P=>[{...k,deletedAt:Date.now()},...P])}if(f(C),x===w){const N=C[0].id,k=zp(N);r(k.nodes),i(k.edges),s(k.bgType),R(N),a(),o&&setTimeout(()=>{o.fitView({duration:800,padding:.2})},100)}},500)}})},A=D.useCallback(w=>{const E=m.find(C=>C.id===w);E&&(b(C=>C.filter(N=>N.id!==w)),f(C=>[...C,{...E,isDeleting:!1}]))},[m]),O=D.useCallback(w=>{c({isOpen:!0,title:"ELIMINAR DEFINITIVAMENTE?",message:"Esta accin es irreversible. Los datos del caso se borrarn del disco para siempre.",isDanger:!0,confirmText:"Eliminar",onConfirm:()=>{b(E=>E.filter(C=>C.id!==w)),localStorage.removeItem(`board-${w}-nodes`),localStorage.removeItem(`board-${w}-edges`),localStorage.removeItem(`board-${w}-bg`)}})},[]),L=(w,E)=>{f(C=>C.map(N=>N.id===w?{...N,name:E}:N))},S=D.useCallback(w=>{f(w)},[]),I=D.useCallback(w=>{const E=h.find(C=>C.id===w);E&&c({isOpen:!0,title:"CLONAR CASO?",message:`Deseas crear una copia del expediente "${E.name}"?`,confirmText:"Clonar",onConfirm:()=>{let C,N,k;if(w===x)C=t,N=e,k=n;else{const z=zp(w);C=z.nodes,N=z.edges,k=z.bgType}const P=An(),j={id:P,name:`${E.name} (Copia)`,createdAt:Date.now(),lastModified:Date.now()};localStorage.setItem(`board-${P}-nodes`,JSON.stringify(C)),localStorage.setItem(`board-${P}-edges`,JSON.stringify(N)),localStorage.setItem(`board-${P}-bg`,k),f(z=>{const U=z.findIndex(M=>M.id===w),F=[...z];return F.splice(U+1,0,j),F}),y(P)}})},[h,y,x,t,e,n,c]);return D.useEffect(()=>{h.length>0&&!h.find(w=>w.id===x)&&y(h[0].id)},[h,x,y]),{boards:h,setBoards:f,trash:m,currentBoardId:x,setCurrentBoardId:R,handleSwitchBoard:y,handleCreateBoard:v,handleDeleteBoard:T,handleRestoreBoard:A,handlePermanentDelete:O,handleRenameBoard:L,handleReorderBoards:S,handleCloneBoard:I}},GL=({onSave:t,undo:e,redo:n,duplicateSelected:r,navigateSearch:i,reactFlowInstance:s,edges:o,setEdges:a,takeSnapshot:l,connectionLineType:c,connectionColor:d})=>{D.useEffect(()=>{const h=f=>{if((f.ctrlKey||f.metaKey)&&f.key==="s"&&(f.preventDefault(),t()),(f.ctrlKey||f.metaKey)&&f.key==="z"&&(f.preventDefault(),f.shiftKey?n():e()),(f.ctrlKey||f.metaKey)&&f.key==="y"&&(f.preventDefault(),n()),(f.ctrlKey||f.metaKey)&&f.key==="d"&&(f.preventDefault(),r()),f.key==="F3"&&(f.preventDefault(),f.shiftKey?i("prev"):i("next")),f.shiftKey&&f.key.toLowerCase()==="c"){if(f.preventDefault(),!s)return;const m=s.getNodes().filter(b=>b.selected);if(m.length>=2){m.sort((x,R)=>x.position.x-R.position.x);const b=[];for(let x=0;x<m.length-1;x++){const R=m[x],y=m[x+1];o.some(T=>T.source===R.id&&T.target===y.id||T.source===y.id&&T.target===R.id)||b.push({id:An(),source:R.id,target:y.id,type:c,style:{stroke:d,strokeWidth:2},className:"quick-draw"})}b.length>0&&(l(),a(x=>x.concat(b)))}}};return window.addEventListener("keydown",h),()=>window.removeEventListener("keydown",h)},[t,e,n,r,i,o,c,d,s,a,l])},WL=({isInteractive:t,reactFlowInstance:e,setNodes:n,takeSnapshot:r,setPendingStampNodeId:i,setInputModalOpen:s,setEditingEdge:o,setEditingNode:a})=>{const l=D.useCallback(d=>{if(d.preventDefault(),!t){d.dataTransfer.dropEffect="none";return}d.dataTransfer.dropEffect="move"},[t]),c=D.useCallback(d=>{if(d.preventDefault(),!t)return;if(d.dataTransfer.files&&d.dataTransfer.files.length>0){const R=d.dataTransfer.files[0];ly(R,(y,v,T)=>{const A=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),O={id:An(),type:"image",position:A,data:{label:"Imagen",image:y},style:{width:v,height:T}};r(),n(L=>L.concat(O))});return}const h=d.dataTransfer.getData("text/uri-list")||d.dataTransfer.getData("text/plain");if(h&&(h.startsWith("data:image")||h.startsWith("http"))){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:An(),type:"image",position:R,data:{label:"Imagen Extrada",image:h},style:{width:300,height:300}};r(),n(v=>v.concat(y));return}const f=d.dataTransfer.getData("application/reactflow"),m=d.dataTransfer.getData("application/category");if(typeof f>"u"||!f)return;if(f==="stamp"){const R=d.dataTransfer.getData("application/category"),y=R==="custom",v=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),A=e.getIntersectingNodes({x:v.x,y:v.y,width:1,height:1}).slice().reverse().find(O=>O.type==="evidence"||O.type==="note"||O.type==="image");if(A){if(y){i(A.id),s(!0),o(null),a(null);return}r(),n(O=>O.map(L=>L.id===A.id?{...L,data:{...L.data,status:R}}:L))}return}if(f==="zone"){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:An(),type:"zone",position:R,data:{label:"ZONA SEGURA"},style:{width:300,height:300,backgroundColor:"rgba(113, 113, 122, 0.05)",borderColor:"#71717a"}};r(),n(v=>[y,...v]);return}if(f==="url"){const R=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),y={id:An(),type:"url",position:R,data:{url:"",label:"Nuevo Enlace"},style:{width:300,height:250}};r(),n(v=>v.concat(y));return}const b=e.screenToFlowPosition({x:d.clientX,y:d.clientY}),x={id:An(),type:f,position:b,data:{label:`Nuevo ${m}`,category:m,description:"Doble click para editar..."}};r(),n(R=>R.concat(x))},[e,n,t,r,i,s,o,a]);return{onDragOver:l,onDrop:c}},dy=({status:t})=>{if(typeof t=="object"&&t.type==="custom")return p.jsx("div",{className:"border-4 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif",borderColor:t.color,color:t.color,backgroundColor:`${t.color}30`},children:t.label});switch(t){case"solved":return p.jsx("div",{className:"border-4 border-green-600 text-green-600 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-green-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"RESUELTO"});case"discarded":return p.jsx("div",{className:"border-4 border-red-600 text-red-600 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-red-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"DESCARTADO"});case"key":return p.jsx("div",{className:"border-4 border-yellow-500 text-yellow-500 font-black text-xl px-2 py-1 rounded opacity-90 uppercase tracking-widest bg-yellow-950/30 backdrop-blur-sm shadow-lg stamp-animation",style:{fontFamily:"Stencil, sans-serif"},children:"CLAVE"});case"question":return p.jsx("div",{className:"border-4 border-blue-500 text-blue-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-blue-950/30",children:p.jsx(ug,{size:40,strokeWidth:3})});case"important":return p.jsx("div",{className:"border-4 border-orange-500 text-orange-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-orange-950/30",children:p.jsx(oS,{size:40,strokeWidth:3})});case"verify":return p.jsx("div",{className:"border-4 border-purple-500 text-purple-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-purple-950/30",children:p.jsx(XT,{size:40,strokeWidth:3})});case"danger":return p.jsx("div",{className:"border-4 border-red-600 text-red-600 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-red-950/30",children:p.jsx(rS,{size:40,strokeWidth:3})});case"confidential":return p.jsx("div",{className:"border-4 border-zinc-500 text-zinc-500 rounded-full p-2 opacity-90 backdrop-blur-sm shadow-lg stamp-animation bg-zinc-950/30",children:p.jsx(Na,{size:40,strokeWidth:3})});default:return null}},ox={person:{color:"border-blue-500",icon:ay,dark:{bg:"bg-gradient-to-br from-blue-900 to-blue-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-blue-50 to-blue-100",text:"text-blue-900/70",title:"text-blue-950",border:"border-black/10"}},place:{color:"border-green-500",icon:JT,dark:{bg:"bg-gradient-to-br from-green-900 to-green-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-green-50 to-green-100",text:"text-green-900/70",title:"text-green-950",border:"border-black/10"}},clue:{color:"border-orange-500",icon:ry,dark:{bg:"bg-gradient-to-br from-orange-900 to-orange-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-orange-50 to-orange-100",text:"text-orange-900/70",title:"text-orange-950",border:"border-black/10"}},event:{color:"border-red-500",icon:WT,dark:{bg:"bg-gradient-to-br from-red-900 to-red-950",text:"text-gray-400",title:"text-gray-100",border:"border-white/10"},light:{bg:"bg-gradient-to-br from-red-50 to-red-100",text:"text-red-900/70",title:"text-red-950",border:"border-black/10"}}},QL=({id:t,data:e,selected:n,isDarkMode:r})=>{const i=ox[e.category]||ox.clue,s=r?i.dark:i.light,o=i.icon,{setNodes:a}=Lr(),l=!!e.locked,[c,d]=D.useState(!1),h=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]),f=m=>{m.stopPropagation(),a(b=>b.map(x=>{if(x.id===t){const R=!!x.data.locked;return{...x,draggable:!0,data:{...x.data,locked:!R}}}return x}))};return p.jsxs("div",{className:`
        relative h-full w-full shadow-[0_10px_20px_-5px_rgba(0,0,0,0.6)] rounded-sm border-l-4 transition-all duration-300 ease-out group
        ${i.color} ${s.bg}
        ${n?"ring-2 ring-white scale-105 shadow-[0_25px_50px_-12px_rgba(0,0,0,0.9)] z-50":"hover:scale-105 hover:-translate-y-1 hover:shadow-[0_20px_40px_-5px_rgba(0,0,0,0.8)] hover:z-40"}
        ${l?"nodrag":""} ${e.isDeleting?"deleting-default":""}
      `,children:[p.jsx(Ja,{color:"#ef4444",isVisible:n&&!l,minWidth:250,minHeight:150,handleStyle:{width:15,height:15}}),(n||l)&&p.jsx("button",{onClick:f,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${l?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:l?p.jsx(el,{size:12}):p.jsx(Za,{size:12})}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(xn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(xn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${h}deg)`},children:p.jsx(dy,{status:e.status},JSON.stringify(e.status))}),p.jsxs("div",{className:"p-3 flex flex-col gap-2 h-full w-full overflow-hidden",children:[p.jsxs("div",{className:`flex items-center justify-between border-b ${s.border} pb-2`,children:[p.jsx("span",{className:`text-xs uppercase tracking-widest ${s.text} font-bold`,children:e.category}),p.jsx(o,{size:16,className:s.text})]}),e.image&&p.jsx("div",{className:`nodrag w-full h-32 overflow-hidden rounded-sm border ${s.border} sepia-[.5] cursor-zoom-in hover:sepia-0 transition-all`,onClick:m=>{m.stopPropagation(),d(!0)},children:p.jsx("img",{src:e.image,alt:"evidence",className:"w-full h-full object-cover"})}),c&&Vc.createPortal(p.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-8 cursor-zoom-out backdrop-blur-sm animate-in fade-in duration-200",onClick:m=>{m.stopPropagation(),d(!1)},children:p.jsx("img",{src:e.image,alt:"Evidence HD",className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm"})}),document.body),p.jsxs("div",{children:[p.jsx("h3",{className:`text-lg font-bold ${s.title} leading-tight font-mono`,children:e.label}),p.jsx("p",{className:`text-xs ${s.text} mt-1 font-mono leading-relaxed`,children:e.description})]})]})]})},YL=D.memo(QL),Lp={yellow:{bg:"from-yellow-100 to-yellow-300",btn:"bg-yellow-500"},green:{bg:"from-green-100 to-green-300",btn:"bg-green-500"},blue:{bg:"from-blue-100 to-blue-300",btn:"bg-blue-500"},red:{bg:"from-red-100 to-red-300",btn:"bg-red-500"},purple:{bg:"from-purple-100 to-purple-300",btn:"bg-purple-500"}},XL=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Lr(),o=!!e.locked,a=Lp[e.color]||Lp.yellow,l=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]),c=f=>{f.stopPropagation(),s(m=>m.map(b=>{if(b.id===t){const x=!!b.data.locked;return{...b,draggable:!0,data:{...b.data,locked:!x}}}return b}))},d=f=>{s(m=>m.map(b=>b.id===t?{...b,data:{...b.data,color:f}}:b))},h=()=>{s(f=>f.map(m=>m.id===t?{...m,data:{...m.data,status:null}}:m))};return p.jsxs(p.Fragment,{children:[p.jsx(Ja,{color:"#eab308",isVisible:n&&!o,minWidth:150,minHeight:150,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{i({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(fs,{size:12})}),(n||o)&&p.jsx("button",{onClick:c,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${o?"bg-red-900 border-red-700 text-red-200":"bg-yellow-500 border-yellow-700 text-white hover:bg-yellow-600"}`,children:o?p.jsx(el,{size:12}):p.jsx(Za,{size:12})}),n&&!o&&p.jsxs("div",{className:`nodrag absolute -bottom-8 left-1/2 transform -translate-x-1/2 flex gap-1 p-1.5 rounded-full shadow-xl border z-50 backdrop-blur-sm ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[Object.entries(Lp).map(([f,m])=>p.jsx("button",{onClick:()=>d(f),className:`w-4 h-4 rounded-full ${m.btn} border border-white/20 hover:scale-125 transition-transform`},f)),e.status&&p.jsx("button",{onClick:h,className:`w-4 h-4 rounded-full flex items-center justify-center border border-white/20 hover:scale-125 transition-transform ml-1 ${r?"bg-zinc-700 text-zinc-400 hover:text-white":"bg-gray-200 text-gray-500 hover:text-black"}`,title:"Quitar Sello",children:p.jsx(ny,{size:10})})]}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(xn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(xn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${l}deg)`},children:p.jsx(dy,{status:e.status},JSON.stringify(e.status))}),p.jsxs("div",{className:`relative h-full w-full bg-gradient-to-br ${a.bg} shadow-[5px_5px_15px_rgba(0,0,0,0.5)] rotate-1 p-4 note-rough border-t border-l border-white/50 flex flex-col transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-1 hover:shadow-[10px_15px_25px_rgba(0,0,0,0.6)] overflow-hidden ${o?"nodrag":""} ${e.isDeleting?"deleting-note":""}`,children:[p.jsx("div",{className:"absolute inset-0 paper-texture pointer-events-none opacity-50 mix-blend-multiply"}),p.jsx("textarea",{name:"note-content",className:"nodrag relative z-10 w-full h-full bg-transparent resize-none outline-none text-gray-800 placeholder-yellow-600/50 text-lg leading-relaxed",placeholder:"Escribe una nota...",defaultValue:e.label,onChange:f=>e.label=f.target.value,style:{fontFamily:'"Comic Sans MS", "Chalkboard SE", sans-serif'}})]})]})},JL=D.memo(XL),ZL=({isOpen:t,onClose:e,imageSrc:n,onCropComplete:r})=>{const[i,s]=D.useState(1),[o,a]=D.useState({x:0,y:0}),[l,c]=D.useState(!1),[d,h]=D.useState({x:0,y:0}),f=D.useRef(null),m=D.useRef(null);if(D.useEffect(()=>{t&&(s(1),a({x:0,y:0}))},[t,n]),!t||!n)return null;const b=v=>{c(!0),h({x:v.clientX-o.x,y:v.clientY-o.y})},x=v=>{l&&a({x:v.clientX-d.x,y:v.clientY-d.y})},R=()=>{c(!1)},y=()=>{const v=document.createElement("canvas"),T=v.getContext("2d"),A=m.current,O=f.current,L=A.clientWidth,S=A.clientHeight;v.width=L,v.height=S;const I=L/2,w=S/2;T.translate(I+o.x,w+o.y),T.scale(i,i),T.drawImage(O,-O.naturalWidth/2,-O.naturalHeight/2),r(v.toDataURL("image/jpeg",.9)),e()};return p.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center p-4 animate-in fade-in duration-200 select-none",onMouseUp:R,onMouseLeave:R,children:[p.jsxs("div",{className:"w-full max-w-lg flex justify-between items-center mb-4",children:[p.jsxs("h2",{className:"text-zinc-100 font-mono font-bold text-lg flex items-center gap-2",children:[p.jsx(bz,{size:18})," AJUSTAR RECORTE"]}),p.jsx("button",{onClick:e,className:"text-zinc-400 hover:text-white",children:p.jsx(fs,{})})]}),p.jsxs("div",{ref:m,className:"relative w-[400px] h-[400px] bg-zinc-900 overflow-hidden border-2 border-dashed border-zinc-500 cursor-move shadow-2xl rounded-sm",onMouseDown:b,onMouseMove:x,children:[p.jsx("img",{ref:f,src:n,alt:"Crop target",className:"absolute max-w-none origin-center pointer-events-none",style:{left:"50%",top:"50%",transform:`translate(-50%, -50%) translate(${o.x}px, ${o.y}px) scale(${i})`}}),p.jsxs("div",{className:"absolute inset-0 pointer-events-none opacity-30",children:[p.jsx("div",{className:"w-full h-1/3 border-b border-white/50 absolute top-0"}),p.jsx("div",{className:"w-full h-1/3 border-b border-white/50 absolute top-1/3"}),p.jsx("div",{className:"h-full w-1/3 border-r border-white/50 absolute left-0"}),p.jsx("div",{className:"h-full w-1/3 border-r border-white/50 absolute left-1/3"})]})]}),p.jsxs("div",{className:"mt-6 flex items-center gap-4 w-full max-w-md bg-zinc-900 p-4 rounded-lg border border-zinc-800",children:[p.jsx(Mz,{size:20,className:"text-zinc-400"}),p.jsx("input",{type:"range",name:"crop-scale",min:"0.1",max:"3",step:"0.05",value:i,onChange:v=>s(parseFloat(v.target.value)),className:"w-full accent-red-600 h-1 bg-zinc-700 rounded-lg appearance-none cursor-pointer"}),p.jsx(Lz,{size:20,className:"text-zinc-400"})]}),p.jsxs("div",{className:"mt-6 flex gap-4",children:[p.jsx("button",{onClick:e,className:"px-6 py-2 border border-zinc-600 text-zinc-300 hover:text-white rounded font-bold uppercase text-xs tracking-wider transition-colors",children:"Cancelar"}),p.jsxs("button",{onClick:y,className:"px-6 py-2 bg-red-600 hover:bg-red-700 text-white rounded font-bold uppercase text-xs tracking-wider shadow-lg flex items-center gap-2 transition-colors",children:[p.jsx(QT,{size:16})," Aplicar"]})]})]})},eM=({id:t,data:e,selected:n,isDarkMode:r})=>{const[i,s]=D.useState(e.image),[o,a]=D.useState(!1),[l,c]=D.useState(!1),[d,h]=D.useState(!1),[f,m]=D.useState(e.filters||{brightness:100,contrast:100,grayscale:0,sepia:0}),{deleteElements:b,setNodes:x,getNode:R}=Lr(),y=!!e.locked,v=D.useMemo(()=>Math.floor(Math.random()*40)-20,[e.status]);D.useEffect(()=>{e.filters&&m(e.filters)},[e.filters]),D.useEffect(()=>{if(e.image&&e.image.startsWith("http")){const E=new Image;E.crossOrigin="Anonymous",E.src=e.image,E.onload=()=>{try{const C=document.createElement("canvas");C.width=E.width,C.height=E.height,C.getContext("2d").drawImage(E,0,0);const k=C.toDataURL("image/jpeg");k.length>100&&(s(k),x(P=>P.map(j=>j.id===t?{...j,data:{...j.data,image:k}}:j)))}catch{}}}},[]);const T=E=>{E.stopPropagation(),x(C=>C.map(N=>{if(N.id===t){const k=!!N.data.locked;return{...N,draggable:!0,data:{...N.data,locked:!k}}}return N}))},A=E=>{const C=E.target.files[0];C&&ly(C,(N,k,P)=>{s(N),x(j=>j.map(z=>z.id===t?{...z,data:{...z.data,image:N},style:{...z.style,width:k,height:P}}:z))})},O=E=>{if(!i)return;const C=new Image;C.src=i,C.onload=()=>{var F,M;const N=document.createElement("canvas");N.width=C.height,N.height=C.width;const k=N.getContext("2d");k.translate(N.width/2,N.height/2),k.rotate(E==="right"?90*Math.PI/180:-90*Math.PI/180),k.drawImage(C,-C.width/2,-C.height/2);const P=N.toDataURL();s(P);const j=R(t),z=(F=j==null?void 0:j.style)==null?void 0:F.width,U=(M=j==null?void 0:j.style)==null?void 0:M.height;x(B=>B.map(G=>G.id===t?{...G,data:{...G.data,image:P},style:{...G.style,width:U,height:z}}:G))}},L=()=>{c(!0)},S=E=>{s(E),x(C=>C.map(N=>N.id===t?{...N,data:{...N.data,image:E},style:{...N.style,width:300,height:300}}:N))},I=()=>{x(E=>E.map(C=>C.id===t?{...C,data:{...C.data,status:null}}:C))},w=(E,C)=>{const N={...f,[E]:C};m(N),x(k=>k.map(P=>P.id===t?{...P,data:{...P.data,filters:N}}:P))};return p.jsxs(p.Fragment,{children:[p.jsx(Ja,{color:"#ef4444",isVisible:n&&!y,minWidth:100,minHeight:100,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{b({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(fs,{size:12})}),(n||y)&&p.jsx("button",{onClick:T,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${y?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:y?p.jsx(el,{size:12}):p.jsx(Za,{size:12})}),n&&!y&&i&&p.jsxs("div",{className:`nodrag absolute -bottom-9 left-1/2 transform -translate-x-1/2 flex gap-1 p-1.5 rounded-full shadow-xl border z-50 backdrop-blur-sm items-center ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[p.jsx("button",{onClick:()=>h(!d),className:`p-1.5 rounded-full transition-colors ${d?"bg-blue-600 text-white":r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Filtros",children:p.jsx(Dz,{size:14})}),p.jsx("div",{className:`w-px h-4 mx-0.5 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsx("button",{onClick:()=>O("left"),className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Rotar Izquierda",children:p.jsx(Rz,{size:14})}),p.jsx("button",{onClick:L,className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Recortar",children:p.jsx(uz,{size:14})}),p.jsx("button",{onClick:()=>O("right"),className:`p-1.5 rounded-full transition-colors ${r?"text-zinc-400 hover:text-white hover:bg-zinc-700":"text-zinc-500 hover:text-black hover:bg-gray-200"}`,title:"Rotar Derecha",children:p.jsx(Nz,{size:14})}),e.status&&p.jsx("button",{onClick:I,className:`p-1.5 text-red-500 hover:text-red-400 rounded-full transition-colors ${r?"hover:bg-zinc-700":"hover:bg-gray-200"}`,title:"Quitar Sello",children:p.jsx(ny,{size:14})})]}),d&&n&&!y&&p.jsxs("div",{className:`nodrag absolute -bottom-44 left-1/2 transform -translate-x-1/2 p-3 rounded-lg border z-50 w-48 backdrop-blur-sm flex flex-col gap-2 shadow-2xl animate-in fade-in slide-in-from-bottom-2 ${r?"bg-zinc-900/95 border-zinc-700":"bg-white/95 border-gray-200"}`,children:[p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Brillo"})," ",p.jsxs("span",{children:[f.brightness,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"200",value:f.brightness,onChange:E=>w("brightness",parseInt(E.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Contraste"})," ",p.jsxs("span",{children:[f.contrast,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"200",value:f.contrast,onChange:E=>w("contrast",parseInt(E.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"B/N"})," ",p.jsxs("span",{children:[f.grayscale,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"100",value:f.grayscale,onChange:E=>w("grayscale",parseInt(E.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`}),p.jsxs("div",{className:`flex items-center justify-between text-[10px] font-mono ${r?"text-zinc-400":"text-zinc-600"}`,children:[p.jsx("span",{children:"Sepia"})," ",p.jsxs("span",{children:[f.sepia,"%"]})]}),p.jsx("input",{type:"range",min:"0",max:"100",value:f.sepia,onChange:E=>w("sepia",parseInt(E.target.value)),className:`w-full h-1 rounded-lg appearance-none cursor-pointer accent-blue-500 ${r?"bg-zinc-700":"bg-gray-300"}`})]}),p.jsx("div",{className:"tape-visual"}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(xn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(xn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),e.status&&p.jsx("div",{className:"absolute -top-4 -right-4 z-50 pointer-events-none select-none",style:{transform:`rotate(${v}deg)`},children:p.jsx(dy,{status:e.status},JSON.stringify(e.status))}),p.jsx("div",{className:`h-full w-full ${i?"bg-zinc-100 p-2 pb-10 rotate-1 hover:rotate-0":r?"bg-zinc-900/50 border-zinc-700 hover:border-zinc-500":"bg-gray-200/50 border-gray-400 hover:border-gray-500"} shadow-[0_10px_20px_-5px_rgba(0,0,0,0.7)] flex items-center justify-center overflow-hidden rounded-sm relative group transition-all duration-300 ease-out hover:scale-105 hover:-translate-y-1 hover:shadow-[0_25px_50px_-12px_rgba(0,0,0,0.9)] ${y?"nodrag":""} ${e.isDeleting?"deleting-image":""} border-2 border-dashed`,children:i?p.jsxs("div",{className:"w-full h-full cursor-zoom-in",onClick:E=>{E.stopPropagation(),a(!0)},children:[p.jsx("img",{src:i,alt:"evidence",className:"w-full h-full object-cover border border-zinc-200",style:{filter:`brightness(${f.brightness}%) contrast(${f.contrast}%) grayscale(${f.grayscale}%) sepia(${f.sepia}%)`}}),p.jsx("div",{className:"absolute bottom-0 left-0 w-full h-10 flex items-center justify-center px-2",children:p.jsx("input",{type:"text",name:"image-caption",className:"nodrag w-full bg-transparent text-center text-zinc-800 text-xs outline-none placeholder-zinc-400/50 border-none p-0",placeholder:"",defaultValue:e.caption,onChange:E=>e.caption=E.target.value,onClick:E=>E.stopPropagation(),style:{fontFamily:'"Comic Sans MS", "Chalkboard SE", cursive'}})})]}):p.jsxs("div",{className:"flex flex-col items-center justify-center w-full h-full p-2 gap-1",children:[p.jsxs("label",{className:`nodrag cursor-pointer flex flex-col items-center gap-1 transition-colors ${r?"text-zinc-500 hover:text-zinc-300":"text-zinc-500 hover:text-zinc-700"}`,children:[p.jsx(iy,{size:24}),p.jsx("span",{className:"text-[10px] font-mono uppercase text-center",children:"Subir Local"}),p.jsx("input",{type:"file",name:"upload-image",className:"hidden",accept:"image/*",onChange:A})]}),p.jsx("div",{className:`text-[10px] font-mono ${r?"text-zinc-600":"text-zinc-400"}`,children:"- O -"}),p.jsx("input",{type:"text",name:"image-url",placeholder:"Pegar URL...",className:`nodrag w-full border text-[10px] p-1 rounded outline-none focus:border-purple-500 font-mono text-center ${r?"bg-zinc-950 border-zinc-700 text-zinc-300":"bg-white border-gray-300 text-zinc-700"}`,onKeyDown:E=>{if(E.key==="Enter"){const C=E.currentTarget.value;s(C),e.image=C;const N=new Image;N.crossOrigin="Anonymous",N.onload=()=>{try{const k=document.createElement("canvas");k.width=N.width,k.height=N.height,k.getContext("2d").drawImage(N,0,0);const j=k.toDataURL("image/jpeg");s(j),x(z=>z.map(U=>U.id===t?{...U,data:{...U.data,image:j}}:U))}catch(k){console.warn("CORS blocked",k)}},N.src=C}}})]})}),o&&Vc.createPortal(p.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-8 cursor-zoom-out backdrop-blur-sm animate-in fade-in duration-200",onClick:E=>{E.stopPropagation(),a(!1)},children:p.jsx("img",{src:i,alt:"Evidence HD",className:"max-w-full max-h-full object-contain shadow-2xl rounded-sm",style:{filter:`brightness(${f.brightness}%) contrast(${f.contrast}%) grayscale(${f.grayscale}%) sepia(${f.sepia}%)`}})}),document.body),l&&Vc.createPortal(p.jsx(ZL,{isOpen:l,onClose:()=>c(!1),imageSrc:i,onCropComplete:S}),document.body)]})},tM=D.memo(eM),nM=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Lr(),o=!!e.locked,a=h=>{h.stopPropagation(),s(f=>f.map(m=>{if(m.id===t){const b=!!m.data.locked;return{...m,draggable:!0,data:{...m.data,locked:!b}}}return m}))},l=(h,f)=>{s(m=>m.map(b=>b.id===t?{...b,data:{...b.data,[h]:f}}:b))},c=["#e5e5e5","#18181b","#ef4444","#3b82f6","#22c55e","#eab308"],d=[{label:"S",val:"14px"},{label:"M",val:"24px"},{label:"L",val:"36px"},{label:"XL",val:"48px"}];return p.jsxs(p.Fragment,{children:[p.jsx(Ja,{color:"#71717a",isVisible:n&&!o,minWidth:100,minHeight:30,handleStyle:{width:15,height:15}}),n&&p.jsx("button",{onClick:()=>{i({nodes:[{id:t}]})},className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(fs,{size:12})}),(n||o)&&p.jsx("button",{onClick:a,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${o?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:o?p.jsx(el,{size:12}):p.jsx(Za,{size:12})}),n&&!o&&p.jsxs("div",{className:`nodrag absolute -bottom-10 left-1/2 transform -translate-x-1/2 flex flex-col gap-1 p-1.5 rounded-lg shadow-xl border z-50 backdrop-blur-sm items-center ${r?"bg-zinc-900/90 border-zinc-700":"bg-white/90 border-gray-200"}`,children:[p.jsx("div",{className:"flex gap-1",children:c.map(h=>p.jsx("button",{onClick:()=>l("color",h),className:"w-4 h-4 rounded-full border border-white/20 hover:scale-125 transition-transform",style:{backgroundColor:h}},h))}),p.jsx("div",{className:`flex gap-1 border-t pt-1 mt-0.5 ${r?"border-white/10":"border-black/10"}`,children:d.map(h=>p.jsx("button",{onClick:()=>l("fontSize",h.val),className:`text-[8px] px-1 font-mono border rounded ${r?"text-zinc-300 hover:text-white border-zinc-700 bg-zinc-800 hover:bg-zinc-700":"text-zinc-600 hover:text-black border-gray-300 bg-gray-100 hover:bg-gray-200"}`,children:h.label},h.label))})]}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(xn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(xn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),p.jsx("div",{className:`h-full w-full p-2 flex items-center justify-center overflow-hidden border border-transparent hover:border-zinc-700/50 rounded transition-colors ${o?"nodrag":""} ${e.isDeleting?"deleting-default":""}`,children:p.jsx("textarea",{name:"text-content",className:`nodrag w-full h-full bg-transparent resize-none outline-none font-bold text-center p-2 ${e.color?"":"text-node-content text-gray-200"}`,placeholder:"Escribe un ttulo...",defaultValue:e.label,onChange:h=>e.label=h.target.value,style:{fontFamily:'"Courier Prime", monospace',color:e.color,fontSize:e.fontSize||"24px"}})})]})},rM=D.memo(nM),iM=({id:t,data:e,selected:n,style:r,isDarkMode:i})=>{const{setNodes:s}=Lr(),o=(r==null?void 0:r.borderColor)||"#71717a",a=(r==null?void 0:r.backgroundColor)||(i?"rgba(113, 113, 122, 0.05)":"rgba(100, 116, 139, 0.05)"),l=!!e.locked,c=d=>{d.stopPropagation(),s(h=>h.map(f=>{if(f.id===t){const m=!!f.data.locked;return{...f,draggable:m,data:{...f.data,locked:!m}}}return f}))};return p.jsxs(p.Fragment,{children:[p.jsx(Ja,{color:o,isVisible:n&&!l,minWidth:150,minHeight:150}),(n||l)&&p.jsx("button",{onClick:c,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${l?"bg-red-900 border-red-700 text-red-200":i?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:l?p.jsx(el,{size:12}):p.jsx(Za,{size:12})}),p.jsx("div",{className:`h-full w-full border-2 border-dashed rounded-xl transition-colors ${l?"nodrag":""} ${e.isDeleting?"deleting-zone":""}`,style:{borderColor:o,backgroundColor:a},children:p.jsx("div",{className:`absolute -top-3 left-4 px-2 py-0.5 rounded text-[10px] font-mono uppercase tracking-widest select-none whitespace-nowrap shadow-sm ${i?"bg-zinc-800 border border-zinc-700 text-zinc-400":"bg-white border border-gray-300 text-gray-600"}`,children:e.label})})]})},sM=D.memo(iM),oM=({id:t,data:e,selected:n,isDarkMode:r})=>{const{deleteElements:i,setNodes:s}=Lr(),[o,a]=D.useState(e.url||""),[l,c]=D.useState(!e.url),d=!!e.showIframe,[h,f]=D.useState(!1),[m,b]=D.useState(0),[x,R]=D.useState(null),[y,v]=D.useState(!0),[T,A]=D.useState(!1),O=!!e.locked,L=D.useMemo(()=>{if(!e.url)return"";try{const P=new URL(e.url);if(P.hostname.includes("youtube.com")||P.hostname.includes("youtu.be")){let z=null;if(P.hostname.includes("youtu.be"))z=P.pathname.slice(1);else if(P.searchParams.has("v"))z=P.searchParams.get("v");else if(P.pathname.startsWith("/embed/"))return e.url;if(z)return`https://www.youtube-nocookie.com/embed/${z}?rel=0&modestbranding=1&iv_load_policy=3&controls=1&playsinline=1&loop=1&playlist=${z}`}}catch{}return e.url},[e.url]),S=e.url?`https://s.wordpress.com/mshots/v1/${encodeURIComponent(e.url)}?w=400&v=${m}`:null,I=S?`https://wsrv.nl/?url=${encodeURIComponent(S)}`:null;D.useEffect(()=>{if(R(null),!I)return;(j=>{const z=new Image;z.crossOrigin="Anonymous",z.referrerPolicy="no-referrer",z.src=j,z.onload=()=>{try{const U=document.createElement("canvas");U.width=z.width,U.height=z.height,U.getContext("2d").drawImage(z,0,0);const M=U.toDataURL("image/jpeg");R(M),v(!1)}catch{v(!1),A(!0)}},z.onerror=()=>{v(!1),A(!0)}})(I)},[I]);const w=P=>{P.stopPropagation(),s(j=>j.map(z=>{if(z.id===t){const U=!!z.data.locked;return{...z,draggable:U,data:{...z.data,locked:!U}}}return z}))},E=()=>{let P=o;P&&!P.startsWith("http")&&(P="https://"+P),s(j=>j.map(z=>z.id===t?{...z,data:{...z.data,url:P,showIframe:!1}}:z)),c(!1),f(!1),A(!1),v(!0)},C=()=>{c(!0),f(!1),A(!1),v(!0)},N=P=>{P.stopPropagation(),b(j=>j+1),f(!1),A(!1),v(!0)},k=()=>{const P=!d;f(!1),s(j=>j.map(z=>z.id===t?{...z,data:{...z.data,showIframe:P}}:z))};return p.jsxs(p.Fragment,{children:[p.jsx(Ja,{color:"#3b82f6",isVisible:n&&!O,minWidth:200,minHeight:100}),n&&p.jsx("button",{onClick:()=>i({nodes:[{id:t}]}),className:"nodrag absolute -top-3 -right-3 bg-red-500 text-white rounded-full p-1 shadow-md hover:bg-red-600 z-50 transition-transform hover:scale-110",children:p.jsx(fs,{size:12})}),(n||O)&&p.jsx("button",{onClick:w,className:`nodrag absolute -top-3 -left-3 z-50 p-1 rounded-full shadow-md border transition-all ${O?"bg-red-900 border-red-700 text-red-200":r?"bg-zinc-800 border-zinc-600 text-zinc-400 hover:text-white":"bg-white border-gray-300 text-gray-500 hover:text-black"}`,children:O?p.jsx(el,{size:12}):p.jsx(Za,{size:12})}),p.jsxs("div",{className:"absolute -top-3 w-4 h-4 z-50",style:{left:"calc(50% - 8px)"},children:[p.jsx("div",{className:"w-full h-full rounded-full pin-3d pointer-events-none"}),p.jsx(xn,{type:"target",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}}),p.jsx(xn,{type:"source",position:ce.Top,style:{position:"absolute",top:"7px",left:"7px",width:"2px",height:"2px",opacity:0,background:"transparent",border:"none"}})]}),p.jsxs("div",{className:`relative w-full h-full rounded-lg overflow-hidden border-2 transition-all shadow-lg flex flex-col ${r?"bg-zinc-900 border-zinc-700":"bg-white border-gray-200"} ${O?"nodrag":""} ${e.isDeleting?"deleting-default":""}`,children:[p.jsxs("div",{className:`h-8 flex items-center px-2 gap-2 border-b ${r?"bg-zinc-800 border-zinc-700":"bg-gray-100 border-gray-200"}`,children:[p.jsx(gz,{size:14,className:"text-blue-500"}),p.jsx("span",{className:`text-[10px] font-mono truncate flex-1 ${r?"text-zinc-400":"text-gray-600"}`,children:e.url?new URL(e.url).hostname:"ENLACE WEB"}),!l&&p.jsxs("div",{className:"flex gap-1",children:[p.jsx("button",{onClick:k,className:`text-zinc-500 transition-colors ${d?"text-blue-500":"hover:text-blue-500"}`,title:d?"Ver miniatura":"Ver interactivo",children:p.jsx(Ez,{size:12})}),p.jsx("button",{onClick:N,className:"text-zinc-500 hover:text-green-500 transition-colors",title:"Actualizar miniatura",children:p.jsx(tS,{size:12})}),p.jsx("button",{onClick:C,className:"text-zinc-500 hover:text-blue-500 transition-colors",children:p.jsx(Sz,{size:12})})]})]}),p.jsx("div",{className:"flex-1 relative bg-black/5 group",children:l?p.jsxs("div",{className:"p-4 flex flex-col gap-2 h-full justify-center",children:[p.jsx("input",{type:"text",name:"url-input",value:o,onChange:P=>a(P.target.value),placeholder:"https://ejemplo.com",className:`nodrag w-full text-xs p-2 rounded border outline-none font-mono ${r?"bg-zinc-950 border-zinc-700 text-white":"bg-white border-gray-300 text-black"}`,onKeyDown:P=>P.key==="Enter"&&E()}),p.jsx("button",{onClick:E,className:"bg-blue-600 text-white text-xs py-1 rounded hover:bg-blue-500 font-bold uppercase",children:"Guardar"})]}):p.jsxs("div",{className:"absolute inset-0 flex flex-col",children:[p.jsx("div",{className:"flex-1 relative overflow-hidden bg-zinc-200 dark:bg-zinc-800 min-h-0",children:d?p.jsxs(p.Fragment,{children:[p.jsx("div",{className:`absolute top-0 left-0 w-full py-1 px-2 flex flex-col gap-1 items-center justify-center z-20 ${r?"bg-zinc-950/80":"bg-white/80"} backdrop-blur-[2px]`,children:p.jsx("span",{className:`text-[9px] leading-tight text-center select-none ${r?"text-zinc-400":"text-zinc-600"}`,children:"Si no carga, el sitio bloquea la conexin."})}),p.jsx("iframe",{src:L,className:"w-full h-full border-none relative z-10 bg-white",title:"Embedded Content",loading:"lazy",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms allow-presentation allow-modals allow-popups-to-escape-sandbox",onError:P=>{console.warn("Error loading iframe:",e.url),P.target.style.display="none"}},m)]}):p.jsxs(p.Fragment,{children:[y&&e.url&&p.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center p-4 text-center z-20",children:p.jsx("div",{className:"w-6 h-6 border-2 border-zinc-400 border-t-transparent rounded-full animate-spin"})}),x&&!T&&p.jsx("img",{src:x,alt:"Preview",className:"w-full h-full object-cover opacity-90 hover:opacity-100 transition-opacity"}),p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:(!e.url||T)&&p.jsx(sy,{size:32,className:"text-zinc-400"})})]})}),p.jsxs("a",{href:e.url,target:"_blank",rel:"noopener",draggable:"false",onDragStart:P=>P.preventDefault(),className:`nodrag h-10 shrink-0 flex items-center justify-center gap-2 text-xs font-bold uppercase transition-colors z-10 relative ${r?"bg-zinc-800 hover:bg-zinc-700 text-blue-400":"bg-gray-200 hover:bg-gray-300 text-zinc-900"}`,children:[p.jsx(fz,{size:14})," Visitar Sitio"]})]})})]})]})},aM=D.memo(oM),Ef=({id:t,sourceX:e,sourceY:n,targetX:r,targetY:i,sourcePosition:s,targetPosition:o,style:a={},markerEnd:l,label:c,type:d,className:h})=>{let f="",m=0,b=0;const x={sourceX:e,sourceY:n,targetX:r,targetY:i,sourcePosition:s,targetPosition:o};return d==="straight"?[f,m,b]=rT(x):d==="step"?[f,m,b]=Uc({...x,borderRadius:0}):d==="smoothstep"?[f,m,b]=Uc(x):[f,m,b]=Y0(x),p.jsxs(p.Fragment,{children:[p.jsx(Xa,{path:f,markerEnd:l,style:a,className:h}),c&&p.jsx(_O,{children:p.jsx("div",{style:{position:"absolute",transform:`translate(-50%, -50%) translate(${m}px,${b}px)`,pointerEvents:"all"},className:"nodrag nopan",children:p.jsx("div",{className:"custom-edge-label",children:c})})})]})},lM=t=>p.jsx(Ef,{...t,type:"straight"}),cM=t=>p.jsx(Ef,{...t,type:"step"}),uM=t=>p.jsx(Ef,{...t,type:"smoothstep"}),dM=t=>p.jsx(Ef,{...t,type:"default"}),yS=D.createContext(!0),Mo=t=>e=>{const n=D.useContext(yS);return D.createElement(t,{...e,isDarkMode:n})},hM={evidence:Mo(YL),note:Mo(JL),image:Mo(tM),text:Mo(rM),zone:Mo(sM),url:Mo(aM)},fM={default:dM,straight:lM,step:cM,smoothstep:uM},pM=({connectionColor:t})=>{const e=D.useMemo(()=>({hideAttribution:!0}),[]),n=D.useMemo(()=>({stroke:t,strokeWidth:2}),[t]),r=D.useCallback(i=>{switch(i.type){case"evidence":switch(i.data.category){case"person":return"#3b82f6";case"place":return"#22c55e";case"clue":return"#f97316";case"event":return"#ef4444";default:return"#ef4444"}case"note":return"#eab308";case"image":return"#a855f7";case"text":return"#71717a";default:return"#ef4444"}},[]);return{nodeTypes:hM,edgeTypes:fM,proOptions:e,connectionLineStyle:n,nodeColor:r}},mM=(t,e,n,r)=>{const[i,s]=D.useState([]),[o,a]=D.useState([]),l=D.useCallback(()=>{s(f=>[...f,{nodes:t,edges:e}]),a([])},[t,e]),c=D.useCallback(()=>{if(i.length===0)return;const f=i[i.length-1],m=i.slice(0,i.length-1);a(b=>[{nodes:t,edges:e},...b]),s(m),n(f.nodes),r(f.edges)},[i,t,e,n,r]),d=D.useCallback(()=>{if(o.length===0)return;const f=o[0],m=o.slice(1);s(b=>[...b,{nodes:t,edges:e}]),a(m),n(f.nodes),r(f.edges)},[o,t,e,n,r]),h=D.useCallback(()=>{s([]),a([])},[]);return{takeSnapshot:l,undo:c,redo:d,clearHistory:h,canUndo:i.length>0,canRedo:o.length>0}},gM=({nodes:t,edges:e,setNodes:n,setEdges:r,onNodesChange:i,onEdgesChange:s})=>{const{takeSnapshot:o,undo:a,redo:l,clearHistory:c}=mM(t,e,n,r),d=D.useCallback(b=>{n(x=>{var y;const R=x.find(v=>v.id===b);return!R||(y=R.data)!=null&&y.isDeleting?x:(setTimeout(()=>{n(v=>{var A;const T=v.find(O=>O.id===b);return T&&((A=T.data)!=null&&A.isDeleting)?v.filter(O=>O.id!==b):v}),r(v=>v.filter(T=>T.source!==b&&T.target!==b))},500),x.map(v=>v.id===b?{...v,data:{...v.data,isDeleting:!0}}:v))})},[n,r]),h=D.useCallback(b=>{r(x=>{var y;const R=x.find(v=>v.id===b);return!R||(y=R.className)!=null&&y.includes("deleting-edge")?x:(setTimeout(()=>{r(v=>v.filter(T=>T.id!==b))},300),x.map(v=>v.id===b?{...v,className:`${v.className||""} deleting-edge`}:v))})},[r]),f=D.useCallback(b=>{const x=b.filter(y=>y.type!=="remove"),R=b.filter(y=>y.type==="remove");R.length>0&&(o(),R.forEach(y=>d(y.id))),x.length>0&&i(x)},[i,o,d]),m=D.useCallback(b=>{const x=b.filter(y=>y.type!=="remove"),R=b.filter(y=>y.type==="remove");R.length>0&&(o(),R.forEach(y=>h(y.id))),x.length>0&&s(x)},[s,o,h]);return{takeSnapshot:o,undo:a,redo:l,clearHistory:c,onNodesChangeWithHistory:f,onEdgesChangeWithHistory:m,animateAndRemoveNode:d,animateAndRemoveEdge:h}},yM=(t,e,n,r,i)=>{const[s,o]=D.useState(null),a=D.useRef(null),l=D.useCallback(c=>{if(c.button!==2||!n||c.target.closest(".react-flow__node")||c.target.closest(".react-flow__edge")||c.target.closest(".react-flow__controls")||c.target.closest(".react-flow__minimap"))return;c.preventDefault();const{left:d,top:h}=t.current.getBoundingClientRect(),f=c.clientX-d,m=c.clientY-h;a.current={startX:f,startY:m,x:f,y:m,width:0,height:0,isDragging:!1};const b=R=>{if(R.buttons===0){x(R);return}if(!a.current||!t.current)return;const y=t.current.getBoundingClientRect(),v=R.clientX-y.left,T=R.clientY-y.top,A=Math.min(a.current.startX,v),O=Math.min(a.current.startY,T),L=Math.abs(v-a.current.startX),S=Math.abs(T-a.current.startY);(L>5||S>5)&&(a.current={...a.current,x:A,y:O,width:L,height:S,isDragging:!0},o({...a.current}))},x=R=>{var T;window.removeEventListener("pointermove",b),window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",x);const y=(T=a.current)==null?void 0:T.isDragging,v=a.current;if(a.current=null,o(null),!y)r(R);else if(v&&e){const A=t.current.getBoundingClientRect(),O=e.screenToFlowPosition({x:A.left+v.x,y:A.top+v.y}),L=e.screenToFlowPosition({x:A.left+v.x+v.width,y:A.top+v.y+v.height}),S={x:Math.min(O.x,L.x),y:Math.min(O.y,L.y),width:Math.abs(L.x-O.x),height:Math.abs(L.y-O.y)},I=e.getNodes().filter(w=>{var P,j,z,U;const E=w.width??((P=w.measured)==null?void 0:P.width)??200,C=w.height??((j=w.measured)==null?void 0:j.height)??150,N=((z=w.positionAbsolute)==null?void 0:z.x)??w.position.x,k=((U=w.positionAbsolute)==null?void 0:U.y)??w.position.y;return S.x<N+E&&S.x+S.width>N&&S.y<k+C&&S.y+S.height>k});i(w=>w.map(E=>({...E,selected:I.some(C=>C.id===E.id)||R.shiftKey&&E.selected})))}};window.addEventListener("pointermove",b),window.addEventListener("pointerup",x),window.addEventListener("pointercancel",x)},[n,r,e,i,t]);return{selectionRect:s,handleRightPointerDown:l}},vM=({isInteractive:t,reactFlowInstance:e,reactFlowWrapper:n,setEdges:r,setNodes:i,connectionLineType:s,connectionColor:o,takeSnapshot:a,setEditingNode:l,setEditingEdge:c,setInputModalOpen:d,setEditModalOpen:h,setMenu:f})=>{const m=D.useCallback(I=>{a(),r(w=>sT({...I,type:s,style:{stroke:o,strokeWidth:2}},w))},[r,o,a,s]),b=D.useCallback((I,w)=>{I.preventDefault(),I.stopPropagation(),t&&(l(null),c(w),d(!0))},[t,l,c,d]),x=D.useCallback((I,w)=>{t&&(a(),r(E=>E.map(C=>{var N;if(C.id===w.id){const k=(N=C.style)==null?void 0:N.strokeDasharray;return{...C,style:{...C.style,strokeDasharray:k?void 0:"10,10"}}}return C})))},[r,t,a]),R=D.useCallback(()=>f(null),[f]),y=D.useCallback(I=>{if(I.preventDefault(),!t)return;const w=n.current.getBoundingClientRect();f({top:I.clientY<w.bottom-200?I.clientY-w.top:void 0,left:I.clientX<w.right-200?I.clientX-w.left:void 0,right:I.clientX>=w.right-200?w.width-(I.clientX-w.left):void 0,bottom:I.clientY>=w.bottom-200?w.height-(I.clientY-w.top):void 0,clientX:I.clientX,clientY:I.clientY})},[t,n,f]),{selectionRect:v,handleRightPointerDown:T}=yM(n,e,t,y,i),A=D.useCallback((I,w)=>{w.type==="evidence"?(l(w),h(!0)):w.type==="zone"&&(c(null),l(w),d(!0))},[l,h,c,d]),O=D.useCallback((I,w)=>{a(),w.type!=="zone"&&i(E=>{const C=E.findIndex(P=>P.id===w.id);if(C===E.length-1)return E;const N=[...E],[k]=N.splice(C,1);return N.push(k),N})},[a,i]),L=D.useCallback(()=>{n.current&&n.current.classList.add("is-moving")},[n]),S=D.useCallback(()=>{n.current&&n.current.classList.remove("is-moving")},[n]);return{onConnect:m,onEdgeContextMenu:b,onEdgeClick:x,onPaneClick:R,onPaneContextMenu:y,onNodeDoubleClick:A,onNodeDragStart:O,onMoveStart:L,onMoveEnd:S,selectionRect:v,handleRightPointerDown:T}},_M=({reactFlowInstance:t,boards:e,currentBoardId:n,bgType:r,setBoards:i,setNodes:s,setEdges:o,setBgType:a,handleSwitchBoard:l,clearHistory:c,takeSnapshot:d,setConfirmModal:h})=>{const f=D.useCallback(()=>{if(t){const R={...t.toObject(),bgType:r},y=new Blob([JSON.stringify(R,null,2)],{type:"application/json"}),v=URL.createObjectURL(y),T=document.createElement("a");T.href=v;const A=e.find(L=>L.id===n),O=A?A.name.replace(/[^a-z0-9\u00C0-\u017F\s-_]/gi,""):"caso-detective";T.download=`${O}.json`,T.click(),URL.revokeObjectURL(v)}},[t,e,n,r]),m=D.useCallback(x=>{const R=x.target.files[0];if(!R)return;const y=R.name.replace(/\.json$/i,""),v=new FileReader;v.onload=T=>{try{const A=JSON.parse(T.target.result);if(A&&(A.nodes||A.edges)){const O=A.nodes||[],L=A.edges||[],S=A.bgType||"cork",I=e.find(w=>w.name===y);if(I)h({isOpen:!0,title:"SOBRESCRIBIR CASO?",message:`Ya existe un caso llamado "${y}". Deseas sobrescribir sus datos con este archivo?`,confirmText:"Sobrescribir",cancelText:"Cancelar",isDanger:!0,onConfirm:()=>{localStorage.setItem(`board-${I.id}-nodes`,JSON.stringify(O)),localStorage.setItem(`board-${I.id}-edges`,JSON.stringify(L)),localStorage.setItem(`board-${I.id}-bg`,S),I.id===n?(s(O),o(L),a(S),c()):l(I.id)}});else{const w=An(),E={id:w,name:y,createdAt:Date.now(),lastModified:Date.now()};localStorage.setItem(`board-${w}-nodes`,JSON.stringify(O)),localStorage.setItem(`board-${w}-edges`,JSON.stringify(L)),localStorage.setItem(`board-${w}-bg`,S),i(C=>[...C,E]),l(w)}}}catch(A){console.error("Error al cargar el caso",A),alert("El archivo no es vlido.")}},v.readAsText(R),x.target.value=""},[e,n,s,o,a,l,i,h,c]),b=D.useCallback(()=>{h({isOpen:!0,title:"LIMPIAR TABLERO?",message:"Ests seguro de que quieres eliminar todo el contenido del tablero? Esta accin no se puede deshacer.",onConfirm:()=>{d(),s([]),o([])},isDanger:!0})},[d,s,o,h]);return{onSave:f,onLoad:m,onClear:b}},wM=({searchTerm:t,setNodes:e,reactFlowInstance:n})=>(D.useEffect(()=>{if(e(i=>i.map(s=>{var c,d;if(!t)return{...s,style:{...s.style,opacity:1}};const o=((c=s.data.label)==null?void 0:c.toLowerCase())||"",a=((d=s.data.description)==null?void 0:d.toLowerCase())||"",l=o.includes(t.toLowerCase())||a.includes(t.toLowerCase());return{...s,style:{...s.style,opacity:l?1:.1}}})),t&&t.length>1&&n){const s=n.getNodes().find(o=>{var c,d;const a=((c=o.data.label)==null?void 0:c.toLowerCase())||"",l=((d=o.data.description)==null?void 0:d.toLowerCase())||"";return a.includes(t.toLowerCase())||l.includes(t.toLowerCase())});s&&n.setCenter(s.position.x+(s.width||0)/2,s.position.y+(s.height||0)/2,{zoom:1.5,duration:800})}},[t,e,n]),{navigateSearch:D.useCallback(i=>{if(!t||!n)return;const o=n.getNodes().filter(f=>{var x,R;const m=((x=f.data.label)==null?void 0:x.toLowerCase())||"",b=((R=f.data.description)==null?void 0:R.toLowerCase())||"";return m.includes(t.toLowerCase())||b.includes(t.toLowerCase())});if(o.length===0)return;const a=o.findIndex(f=>f.selected);let l=i==="next"?a+1:a-1;l>=o.length&&(l=0),l<0&&(l=o.length-1);const c=o[l];e(f=>f.map(m=>({...m,selected:m.id===c.id})));const d=c.width||150,h=c.height||50;n.setCenter(c.position.x+d/2,c.position.y+h/2,{zoom:1.5,duration:600})},[t,n,e])}),xM=t=>{const[e,n]=D.useState("#dc2626"),[r,i]=D.useState("straight"),[s,o]=D.useState(!0),[a,l]=D.useState(!0),[c,d]=D.useState(""),[h,f]=D.useState(!0),[m,b]=D.useState(!1),[x,R]=D.useState(t),y=D.useCallback(()=>{const v=["cork","blackboard","paper"];R(T=>v[(v.indexOf(T)+1)%v.length])},[]);return{connectionColor:e,setConnectionColor:n,connectionLineType:r,setConnectionLineType:i,isInteractive:s,setIsInteractive:o,isDarkMode:a,setIsDarkMode:l,searchTerm:c,setSearchTerm:d,isSidebarOpen:h,setIsSidebarOpen:f,isZenMode:m,setIsZenMode:b,bgType:x,setBgType:R,toggleBackground:y}},EM=({reactFlowInstance:t,setNodes:e,setEdges:n,takeSnapshot:r,animateAndRemoveNode:i,animateAndRemoveEdge:s,setEditModalOpen:o,setEditingNode:a,setEditingEdge:l,setInputModalOpen:c,setConnectionColor:d,setConnectionLineType:h,setPendingStampNodeId:f})=>{const m=D.useCallback((O,L)=>{r(),e(S=>S.map(I=>I.id===O?{...I,data:L}:I))},[e,r]),b=D.useCallback(O=>{r(),i(O),o(!1),a(null)},[i,r,o,a]),x=D.useCallback(()=>{if(!t)return;const O=t.getNodes().filter(L=>L.selected);if(O.length>0){r();const L=new Map,S=O.map(E=>{const C=An();return L.set(E.id,C),{...E,id:C,position:{x:E.position.x+50,y:E.position.y+50},selected:!0,data:{...E.data}}}),w=t.getEdges().filter(E=>L.has(E.source)&&L.has(E.target)).map(E=>({...E,id:An(),source:L.get(E.source),target:L.get(E.target),selected:!0}));e(E=>E.map(C=>({...C,selected:!1})).concat(S)),n(E=>E.map(C=>({...C,selected:!1})).concat(w))}},[t,e,n,r]),R=D.useCallback(O=>{d(O),n(L=>L.map(S=>S.selected?{...S,style:{...S.style,stroke:O}}:S))},[n,d]),y=D.useCallback(O=>{h(O),n(L=>L.map(S=>S.selected?{...S,type:O}:S))},[n,h]),v=D.useCallback((O,L,S,I)=>{I&&(r(),n(w=>w.map(E=>E.id===I.id?{...E,label:O,type:S||E.type,style:{...E.style,stroke:L},labelStyle:void 0,labelBgStyle:void 0}:E)),l(null))},[n,r,l]),T=D.useCallback((O,L)=>{O?(r(),s(O.id),l(null),c(!1)):L&&L.type==="zone"&&(b(L.id),c(!1))},[s,b,r,l,c]),A=D.useCallback((O,L,S,I,w,E)=>{I?v(O,L,S,I):w&&w.type==="zone"?(r(),e(C=>C.map(N=>N.id===w.id?{...N,data:{...N.data,label:O},style:{...N.style,borderColor:L,backgroundColor:`${L}10`}}:N)),a(null),c(!1)):E&&(r(),e(C=>C.map(N=>N.id===E?{...N,data:{...N.data,status:{type:"custom",label:O||"SELLO",color:L}}}:N)),f(null),c(!1))},[v,e,r,a,c,f]);return{handleSaveNode:m,handleDeleteNode:b,duplicateSelected:x,handleConnectionColorChange:R,handleConnectionLineTypeChange:y,handleEdgeLabelSave:v,handleEdgeDelete:T,handleInputModalConfirm:A}};var ax={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vS=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=i&63|128):(i&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=i&63|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=i&63|128)}return e},bM=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=t[n++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=t[n++],o=t[n++],a=t[n++],l=((i&7)<<18|(s&63)<<12|(o&63)<<6|a&63)-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(l&1023))}else{const s=t[n++],o=t[n++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},_S={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<t.length;i+=3){const s=t[i],o=i+1<t.length,a=o?t[i+1]:0,l=i+2<t.length,c=l?t[i+2]:0,d=s>>2,h=(s&3)<<4|a>>4;let f=(a&15)<<2|c>>6,m=c&63;l||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(vS(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):bM(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<t.length;){const s=n[t.charAt(i++)],a=i<t.length?n[t.charAt(i)]:0;++i;const c=i<t.length?n[t.charAt(i)]:64;++i;const h=i<t.length?n[t.charAt(i)]:64;if(++i,s==null||a==null||c==null||h==null)throw new IM;const f=s<<2|a>>4;if(r.push(f),c!==64){const m=a<<4&240|c>>2;if(r.push(m),h!==64){const b=c<<6&192|h;r.push(b)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class IM extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const TM=function(t){const e=vS(t);return _S.encodeByteArray(e,!0)},wS=function(t){return TM(t).replace(/\./g,"")},xS=function(t){try{return _S.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SM(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CM=()=>SM().__FIREBASE_DEFAULTS__,AM=()=>{if(typeof process>"u"||typeof ax>"u")return;const t=ax.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},kM=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&xS(t[1]);return e&&JSON.parse(e)},bf=()=>{try{return CM()||AM()||kM()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},RM=t=>{var e,n;return(n=(e=bf())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},ES=()=>{var t;return(t=bf())===null||t===void 0?void 0:t.config},bS=t=>{var e;return(e=bf())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NM{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function It(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function PM(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(It())}function DM(){var t;const e=(t=bf())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function VM(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function IS(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function OM(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zM(){const t=It();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function TS(){return!DM()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function hy(){try{return typeof indexedDB=="object"}catch{return!1}}function SS(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(n){e(n)}})}function LM(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM="FirebaseError";class yr extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=MM,Object.setPrototypeOf(this,yr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,vo.prototype.create)}}class vo{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?jM(s,r):"Error",a=`${this.serviceName}: ${o} (${i}).`;return new yr(i,a,r)}}function jM(t,e){return t.replace(FM,(n,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const FM=/\{\$([^}]+)}/g;function $M(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Pa(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const i of n){if(!r.includes(i))return!1;const s=t[i],o=e[i];if(lx(s)&&lx(o)){if(!Pa(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function lx(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function du(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Gl(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Wl(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function UM(t,e){const n=new BM(t,e);return n.subscribe.bind(n)}class BM{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let i;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");HM(e,["next","error","complete"])?i=e:i={next:e,error:n,complete:r},i.next===void 0&&(i.next=Mp),i.error===void 0&&(i.error=Mp),i.complete===void 0&&(i.complete=Mp);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function HM(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function Mp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qM=1e3,KM=2,GM=4*60*60*1e3,WM=.5;function cx(t,e=qM,n=KM){const r=e*Math.pow(n,t),i=Math.round(WM*r*(Math.random()-.5)*2);return Math.min(GM,r+i)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dt(t){return t&&t._delegate?t._delegate:t}class mr{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QM{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new NM;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:n});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(XM(e))try{this.getOrInitializeService({instanceIdentifier:Ns})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(n);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Ns){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Ns){return this.instances.has(e)}getOptions(e=Ns){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[s,o]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(s);r===a&&o.resolve(i)}return i}onInit(e,n){var r;const i=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const i of r)try{i(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:YM(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Ns){return this.component?this.component.multipleInstances?e:Ns:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YM(t){return t===Ns?void 0:t}function XM(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JM{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new QM(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Te;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Te||(Te={}));const ZM={debug:Te.DEBUG,verbose:Te.VERBOSE,info:Te.INFO,warn:Te.WARN,error:Te.ERROR,silent:Te.SILENT},e3=Te.INFO,t3={[Te.DEBUG]:"log",[Te.VERBOSE]:"log",[Te.INFO]:"info",[Te.WARN]:"warn",[Te.ERROR]:"error"},n3=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),i=t3[e];if(i)console[i](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class If{constructor(e){this.name=e,this._logLevel=e3,this._logHandler=n3,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Te))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ZM[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Te.DEBUG,...e),this._logHandler(this,Te.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Te.VERBOSE,...e),this._logHandler(this,Te.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Te.INFO,...e),this._logHandler(this,Te.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Te.WARN,...e),this._logHandler(this,Te.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Te.ERROR,...e),this._logHandler(this,Te.ERROR,...e)}}const r3=(t,e)=>e.some(n=>t instanceof n);let ux,dx;function i3(){return ux||(ux=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s3(){return dx||(dx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const CS=new WeakMap,fg=new WeakMap,AS=new WeakMap,jp=new WeakMap,fy=new WeakMap;function o3(t){const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("success",s),t.removeEventListener("error",o)},s=()=>{n(es(t.result)),i()},o=()=>{r(t.error),i()};t.addEventListener("success",s),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&CS.set(n,t)}).catch(()=>{}),fy.set(e,t),e}function a3(t){if(fg.has(t))return;const e=new Promise((n,r)=>{const i=()=>{t.removeEventListener("complete",s),t.removeEventListener("error",o),t.removeEventListener("abort",o)},s=()=>{n(),i()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),i()};t.addEventListener("complete",s),t.addEventListener("error",o),t.addEventListener("abort",o)});fg.set(t,e)}let pg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return fg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||AS.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return es(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function l3(t){pg=t(pg)}function c3(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Fp(this),e,...n);return AS.set(r,e.sort?e.sort():[e]),es(r)}:s3().includes(t)?function(...e){return t.apply(Fp(this),e),es(CS.get(this))}:function(...e){return es(t.apply(Fp(this),e))}}function u3(t){return typeof t=="function"?c3(t):(t instanceof IDBTransaction&&a3(t),r3(t,i3())?new Proxy(t,pg):t)}function es(t){if(t instanceof IDBRequest)return o3(t);if(jp.has(t))return jp.get(t);const e=u3(t);return e!==t&&(jp.set(t,e),fy.set(e,t)),e}const Fp=t=>fy.get(t);function kS(t,e,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(t,e),a=es(o);return r&&o.addEventListener("upgradeneeded",l=>{r(es(o.result),l.oldVersion,l.newVersion,es(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{s&&l.addEventListener("close",()=>s()),i&&l.addEventListener("versionchange",c=>i(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}const d3=["get","getKey","getAll","getAllKeys","count"],h3=["put","add","delete","clear"],$p=new Map;function hx(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if($p.get(e))return $p.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,i=h3.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||d3.includes(n)))return;const s=async function(o,...a){const l=this.transaction(o,i?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),i&&l.done]))[0]};return $p.set(e,s),s}l3(t=>({...t,get:(e,n,r)=>hx(e,n)||t.get(e,n,r),has:(e,n)=>!!hx(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(p3(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function p3(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const mg="@firebase/app",fx="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di=new If("@firebase/app"),m3="@firebase/app-compat",g3="@firebase/analytics-compat",y3="@firebase/analytics",v3="@firebase/app-check-compat",_3="@firebase/app-check",w3="@firebase/auth",x3="@firebase/auth-compat",E3="@firebase/database",b3="@firebase/data-connect",I3="@firebase/database-compat",T3="@firebase/functions",S3="@firebase/functions-compat",C3="@firebase/installations",A3="@firebase/installations-compat",k3="@firebase/messaging",R3="@firebase/messaging-compat",N3="@firebase/performance",P3="@firebase/performance-compat",D3="@firebase/remote-config",V3="@firebase/remote-config-compat",O3="@firebase/storage",z3="@firebase/storage-compat",L3="@firebase/firestore",M3="@firebase/vertexai-preview",j3="@firebase/firestore-compat",F3="firebase",$3="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg="[DEFAULT]",U3={[mg]:"fire-core",[m3]:"fire-core-compat",[y3]:"fire-analytics",[g3]:"fire-analytics-compat",[_3]:"fire-app-check",[v3]:"fire-app-check-compat",[w3]:"fire-auth",[x3]:"fire-auth-compat",[E3]:"fire-rtdb",[b3]:"fire-data-connect",[I3]:"fire-rtdb-compat",[T3]:"fire-fn",[S3]:"fire-fn-compat",[C3]:"fire-iid",[A3]:"fire-iid-compat",[k3]:"fire-fcm",[R3]:"fire-fcm-compat",[N3]:"fire-perf",[P3]:"fire-perf-compat",[D3]:"fire-rc",[V3]:"fire-rc-compat",[O3]:"fire-gcs",[z3]:"fire-gcs-compat",[L3]:"fire-fst",[j3]:"fire-fst-compat",[M3]:"fire-vertex","fire-js":"fire-js",[F3]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ah=new Map,B3=new Map,yg=new Map;function px(t,e){try{t.container.addComponent(e)}catch(n){di.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Vr(t){const e=t.name;if(yg.has(e))return di.debug(`There were multiple attempts to register component ${e}.`),!1;yg.set(e,t);for(const n of Ah.values())px(n,t);for(const n of B3.values())px(n,t);return!0}function _o(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function cr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H3={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ts=new vo("app","Firebase",H3);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q3{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new mr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ts.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tl=$3;function RS(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:gg,automaticDataCollectionEnabled:!1},e),i=r.name;if(typeof i!="string"||!i)throw ts.create("bad-app-name",{appName:String(i)});if(n||(n=ES()),!n)throw ts.create("no-options");const s=Ah.get(i);if(s){if(Pa(n,s.options)&&Pa(r,s.config))return s;throw ts.create("duplicate-app",{appName:i})}const o=new JM(i);for(const l of yg.values())o.addComponent(l);const a=new q3(n,r,o);return Ah.set(i,a),a}function NS(t=gg){const e=Ah.get(t);if(!e&&t===gg&&ES())return RS();if(!e)throw ts.create("no-app",{appName:t});return e}function Qn(t,e,n){var r;let i=(r=U3[t])!==null&&r!==void 0?r:t;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),di.warn(a.join(" "));return}Vr(new mr(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K3="firebase-heartbeat-database",G3=1,Hc="firebase-heartbeat-store";let Up=null;function PS(){return Up||(Up=kS(K3,G3,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Hc)}catch(n){console.warn(n)}}}}).catch(t=>{throw ts.create("idb-open",{originalErrorMessage:t.message})})),Up}async function W3(t){try{const n=(await PS()).transaction(Hc),r=await n.objectStore(Hc).get(DS(t));return await n.done,r}catch(e){if(e instanceof yr)di.warn(e.message);else{const n=ts.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});di.warn(n.message)}}}async function mx(t,e){try{const r=(await PS()).transaction(Hc,"readwrite");await r.objectStore(Hc).put(e,DS(t)),await r.done}catch(n){if(n instanceof yr)di.warn(n.message);else{const r=ts.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});di.warn(r.message)}}}function DS(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q3=1024,Y3=30*24*60*60*1e3;class X3{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Z3(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=gx();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s)?void 0:(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const a=new Date(o.date).valueOf();return Date.now()-a<=Y3}),this._storage.overwrite(this._heartbeatsCache))}catch(r){di.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=gx(),{heartbeatsToSend:r,unsentEntries:i}=J3(this._heartbeatsCache.heartbeats),s=wS(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(n){return di.warn(n),""}}}function gx(){return new Date().toISOString().substring(0,10)}function J3(t,e=Q3){const n=[];let r=t.slice();for(const i of t){const s=n.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),yx(n)>e){s.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),yx(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Z3{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return hy()?SS().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await W3(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return mx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const i=await this.read();return mx(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function yx(t){return wS(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ej(t){Vr(new mr("platform-logger",e=>new f3(e),"PRIVATE")),Vr(new mr("heartbeat",e=>new X3(e),"PRIVATE")),Qn(mg,fx,t),Qn(mg,fx,"esm2017"),Qn("fire-js","")}ej("");function py(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]]);return n}function VS(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tj=VS,OS=new vo("auth","Firebase",VS());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kh=new If("@firebase/auth");function nj(t,...e){kh.logLevel<=Te.WARN&&kh.warn(`Auth (${tl}): ${t}`,...e)}function Vd(t,...e){kh.logLevel<=Te.ERROR&&kh.error(`Auth (${tl}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(t,...e){throw gy(t,...e)}function fr(t,...e){return gy(t,...e)}function my(t,e,n){const r=Object.assign(Object.assign({},tj()),{[e]:n});return new vo("auth","Firebase",r).create(e,{appName:t.name})}function ii(t){return my(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rj(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&Jn(t,"argument-error"),my(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function gy(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return OS.create(t,...e)}function ge(t,e,...n){if(!t)throw gy(e,...n)}function Jr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Vd(e),new Error(e)}function hi(t,e){t||Jr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function ij(){return vx()==="http:"||vx()==="https:"}function vx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(ij()||IS()||"connection"in navigator)?navigator.onLine:!0}function oj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e,n){this.shortDelay=e,this.longDelay=n,hi(n>e,"Short delay should be less than long delay!"),this.isMobile=PM()||OM()}get(){return sj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(t,e){hi(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zS{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Jr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Jr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Jr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lj=new hu(3e4,6e4);function mi(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Mr(t,e,n,r,i={}){return LS(t,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const a=du(Object.assign({key:t.config.apiKey},o)).slice(1),l=await t._getAdditionalHeaders();l["Content-Type"]="application/json",t.languageCode&&(l["X-Firebase-Locale"]=t.languageCode);const c=Object.assign({method:e,headers:l},s);return VM()||(c.referrerPolicy="no-referrer"),zS.fetch()(MS(t,t.config.apiHost,n,a),c)})}async function LS(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},aj),e);try{const i=new uj(t),s=await Promise.race([n(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw ud(t,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const a=s.ok?o.errorMessage:o.error.message,[l,c]=a.split(" : ");if(l==="FEDERATED_USER_ID_ALREADY_LINKED")throw ud(t,"credential-already-in-use",o);if(l==="EMAIL_EXISTS")throw ud(t,"email-already-in-use",o);if(l==="USER_DISABLED")throw ud(t,"user-disabled",o);const d=r[l]||l.toLowerCase().replace(/[_\s]+/g,"-");if(c)throw my(t,d,c);Jn(t,d)}}catch(i){if(i instanceof yr)throw i;Jn(t,"network-request-failed",{message:String(i)})}}async function fu(t,e,n,r,i={}){const s=await Mr(t,e,n,r,i);return"mfaPendingCredential"in s&&Jn(t,"multi-factor-auth-required",{_serverResponse:s}),s}function MS(t,e,n,r){const i=`${e}${n}?${r}`;return t.config.emulator?yy(t.config,i):`${t.config.apiScheme}://${i}`}function cj(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class uj{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(fr(this.auth,"network-request-failed")),lj.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ud(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=fr(t,e,r);return i.customData._tokenResponse=n,i}function _x(t){return t!==void 0&&t.enterprise!==void 0}class dj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return cj(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function hj(t,e){return Mr(t,"GET","/v2/recaptchaConfig",mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fj(t,e){return Mr(t,"POST","/v1/accounts:delete",e)}async function jS(t,e){return Mr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function pj(t,e=!1){const n=Dt(t),r=await n.getIdToken(e),i=vy(r);ge(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:cc(Bp(i.auth_time)),issuedAtTime:cc(Bp(i.iat)),expirationTime:cc(Bp(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Bp(t){return Number(t)*1e3}function vy(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Vd("JWT malformed, contained fewer than 3 sections"),null;try{const i=xS(n);return i?JSON.parse(i):(Vd("Failed to decode base64 JWT payload"),null)}catch(i){return Vd("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function wx(t){const e=vy(t);return ge(e,"internal-error"),ge(typeof e.exp<"u","internal-error"),ge(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Da(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof yr&&mj(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function mj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _g{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=cc(this.lastLoginAt),this.creationTime=cc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rh(t){var e;const n=t.auth,r=await t.getIdToken(),i=await Da(t,jS(n,{idToken:r}));ge(i==null?void 0:i.users.length,n,"internal-error");const s=i.users[0];t._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?FS(s.providerUserInfo):[],a=vj(t.providerData,o),l=t.isAnonymous,c=!(t.email&&s.passwordHash)&&!(a!=null&&a.length),d=l?c:!1,h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new _g(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function yj(t){const e=Dt(t);await Rh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vj(t,e){return[...t.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function FS(t){return t.map(e=>{var{providerId:n}=e,r=py(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _j(t,e){const n=await LS(t,{},async()=>{const r=du({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=t.config,o=MS(t,i,"/v1/token",`key=${s}`),a=await t._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",zS.fetch()(o,{method:"POST",headers:a,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function wj(t,e){return Mr(t,"POST","/v2/accounts:revokeToken",mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ge(e.idToken,"internal-error"),ge(typeof e.idToken<"u","internal-error"),ge(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):wx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){ge(e.length!==0,"internal-error");const n=wx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(ge(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:i,expiresIn:s}=await _j(e,n);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:i,expirationTime:s}=n,o=new ya;return r&&(ge(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(ge(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ge(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ya,this.toJSON())}_performRefresh(){return Jr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ci(t,e){ge(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Zr{constructor(e){var{uid:n,auth:r,stsTokenManager:i}=e,s=py(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new gj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new _g(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const n=await Da(this,this.stsTokenManager.getToken(this.auth,e));return ge(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return pj(this,e)}reload(){return yj(this)}_assign(e){this!==e&&(ge(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Zr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){ge(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Rh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(cr(this.auth.app))return Promise.reject(ii(this.auth));const e=await this.getIdToken();return await Da(this,fj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,i,s,o,a,l,c,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(i=n.email)!==null&&i!==void 0?i:void 0,m=(s=n.phoneNumber)!==null&&s!==void 0?s:void 0,b=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(a=n.tenantId)!==null&&a!==void 0?a:void 0,R=(l=n._redirectEventId)!==null&&l!==void 0?l:void 0,y=(c=n.createdAt)!==null&&c!==void 0?c:void 0,v=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:T,emailVerified:A,isAnonymous:O,providerData:L,stsTokenManager:S}=n;ge(T&&S,e,"internal-error");const I=ya.fromJSON(this.name,S);ge(typeof T=="string",e,"internal-error"),Ci(h,e.name),Ci(f,e.name),ge(typeof A=="boolean",e,"internal-error"),ge(typeof O=="boolean",e,"internal-error"),Ci(m,e.name),Ci(b,e.name),Ci(x,e.name),Ci(R,e.name),Ci(y,e.name),Ci(v,e.name);const w=new Zr({uid:T,auth:e,email:f,emailVerified:A,displayName:h,isAnonymous:O,photoURL:b,phoneNumber:m,tenantId:x,stsTokenManager:I,createdAt:y,lastLoginAt:v});return L&&Array.isArray(L)&&(w.providerData=L.map(E=>Object.assign({},E))),R&&(w._redirectEventId=R),w}static async _fromIdTokenResponse(e,n,r=!1){const i=new ya;i.updateFromServerResponse(n);const s=new Zr({uid:n.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await Rh(s),s}static async _fromGetAccountInfoResponse(e,n,r){const i=n.users[0];ge(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?FS(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),a=new ya;a.updateFromIdToken(r);const l=new Zr({uid:i.localId,auth:e,stsTokenManager:a,isAnonymous:o}),c={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new _g(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(l,c),l}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx=new Map;function ei(t){hi(t instanceof Function,"Expected a class definition");let e=xx.get(t);return e?(hi(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,xx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $S{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}$S.type="NONE";const Ex=$S;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Od(t,e,n){return`firebase:${t}:${e}:${n}`}class va{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Od(this.userKey,i.apiKey,s),this.fullPersistenceKey=Od("persistence",i.apiKey,s),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Zr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new va(ei(Ex),e,r);const i=(await Promise.all(n.map(async c=>{if(await c._isAvailable())return c}))).filter(c=>c);let s=i[0]||ei(Ex);const o=Od(r,e.config.apiKey,e.name);let a=null;for(const c of n)try{const d=await c._get(o);if(d){const h=Zr._fromJSON(e,d);c!==s&&(a=h),s=c;break}}catch{}const l=i.filter(c=>c._shouldAllowMigration);return!s._shouldAllowMigration||!l.length?new va(s,e,r):(s=l[0],a&&await s._set(o,a.toJSON()),await Promise.all(n.map(async c=>{if(c!==s)try{await c._remove(o)}catch{}})),new va(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bx(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(qS(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(US(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(GS(e))return"Blackberry";if(WS(e))return"Webos";if(BS(e))return"Safari";if((e.includes("chrome/")||HS(e))&&!e.includes("edge/"))return"Chrome";if(KS(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function US(t=It()){return/firefox\//i.test(t)}function BS(t=It()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function HS(t=It()){return/crios\//i.test(t)}function qS(t=It()){return/iemobile/i.test(t)}function KS(t=It()){return/android/i.test(t)}function GS(t=It()){return/blackberry/i.test(t)}function WS(t=It()){return/webos/i.test(t)}function _y(t=It()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function xj(t=It()){var e;return _y(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Ej(){return zM()&&document.documentMode===10}function QS(t=It()){return _y(t)||KS(t)||WS(t)||GS(t)||/windows phone/i.test(t)||qS(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YS(t,e=[]){let n;switch(t){case"Browser":n=bx(It());break;case"Worker":n=`${bx(It())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${tl}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=s=>new Promise((o,a)=>{try{const l=e(s);o(l)}catch(l){a(l)}});r.onAbort=n,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const i of n)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ij(t,e={}){return Mr(t,"GET","/v2/passwordPolicy",mi(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj=6;class Sj{constructor(e){var n,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Tj,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,i,s,o,a;const l={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,l),this.validatePasswordCharacterOptions(e,l),l.isValid&&(l.isValid=(n=l.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),l.isValid&&(l.isValid=(r=l.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),l.isValid&&(l.isValid=(i=l.containsLowercaseLetter)!==null&&i!==void 0?i:!0),l.isValid&&(l.isValid=(s=l.containsUppercaseLetter)!==null&&s!==void 0?s:!0),l.isValid&&(l.isValid=(o=l.containsNumericCharacter)!==null&&o!==void 0?o:!0),l.isValid&&(l.isValid=(a=l.containsNonAlphanumericCharacter)!==null&&a!==void 0?a:!0),l}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),i&&(n.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cj{constructor(e,n,r,i){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ix(this),this.idTokenSubscription=new Ix(this),this.beforeStateQueue=new bj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=OS,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=ei(n)),this._initializationPromise=this.queue(async()=>{var r,i;if(!this._deleted&&(this.persistenceManager=await va.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await jS(this,{idToken:e}),r=await Zr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(cr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(a=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(a,a))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,a=i==null?void 0:i._redirectEventId,l=await this.tryRedirectSignIn(e);(!o||o===a)&&(l!=null&&l.user)&&(i=l.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ge(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Rh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=oj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(cr(this.app))return Promise.reject(ii(this));const n=e?Dt(e):null;return n&&ge(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&ge(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return cr(this.app)?Promise.reject(ii(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return cr(this.app)?Promise.reject(ii(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ei(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Ij(this),n=new Sj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new vo("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await wj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&ei(e)||this._popupRedirectResolver;ge(n,this,"argument-error"),this.redirectPersistenceManager=await va.create(this,[ei(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,i){if(this._deleted)return()=>{};const s=typeof n=="function"?n:n.next.bind(n);let o=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(ge(a,this,"internal-error"),a.then(()=>{o||s(this.currentUser)}),typeof n=="function"){const l=e.addObserver(n,r,i);return()=>{o=!0,l()}}else{const l=e.addObserver(n);return()=>{o=!0,l()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ge(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=YS(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(n["X-Firebase-AppCheck"]=i),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&nj(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function gi(t){return Dt(t)}class Ix{constructor(e){this.auth=e,this.observer=null,this.addObserver=UM(n=>this.observer=n)}get next(){return ge(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Aj(t){Tf=t}function XS(t){return Tf.loadJS(t)}function kj(){return Tf.recaptchaEnterpriseScript}function Rj(){return Tf.gapiScript}function Nj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const Pj="recaptcha-enterprise",Dj="NO_RECAPTCHA";class Vj{constructor(e){this.type=Pj,this.auth=gi(e)}async verify(e="verify",n=!1){async function r(s){if(!n){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,a)=>{hj(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(l=>{if(l.recaptchaKey===void 0)a(new Error("recaptcha Enterprise site key undefined"));else{const c=new dj(l);return s.tenantId==null?s._agentRecaptchaConfig=c:s._tenantRecaptchaConfigs[s.tenantId]=c,o(c.siteKey)}}).catch(l=>{a(l)})})}function i(s,o,a){const l=window.grecaptcha;_x(l)?l.enterprise.ready(()=>{l.enterprise.execute(s,{action:e}).then(c=>{o(c)}).catch(()=>{o(Dj)})}):a(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((s,o)=>{r(this.auth).then(a=>{if(!n&&_x(window.grecaptcha))i(a,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let l=kj();l.length!==0&&(l+=a),XS(l).then(()=>{i(a,s,o)}).catch(c=>{o(c)})}}).catch(a=>{o(a)})})}}async function Tx(t,e,n,r=!1){const i=new Vj(t);let s;try{s=await i.verify(n)}catch{s=await i.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Nh(t,e,n,r){var i;if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Tx(t,e,n,n==="getOobCode");return r(t,s)}else return r(t,e).catch(async s=>{if(s.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Tx(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(s)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oj(t,e){const n=_o(t,"auth");if(n.isInitialized()){const i=n.getImmediate(),s=n.getOptions();if(Pa(s,e??{}))return i;Jn(i,"already-initialized")}return n.initialize({options:e})}function zj(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ei);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Lj(t,e,n){const r=gi(t);ge(r._canInitEmulator,r,"emulator-config-failed"),ge(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=JS(e),{host:o,port:a}=Mj(e),l=a===null?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),jj()}function JS(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Mj(t){const e=JS(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:Sx(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:Sx(o)}}}function Sx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function jj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Jr("not implemented")}_getIdTokenResponse(e){return Jr("not implemented")}_linkToIdToken(e,n){return Jr("not implemented")}_getReauthenticationResolver(e){return Jr("not implemented")}}async function Fj(t,e){return Mr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $j(t,e){return fu(t,"POST","/v1/accounts:signInWithPassword",mi(t,e))}async function Uj(t,e){return Mr(t,"POST","/v1/accounts:sendOobCode",mi(t,e))}async function Bj(t,e){return Uj(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Hj(t,e){return fu(t,"POST","/v1/accounts:signInWithEmailLink",mi(t,e))}async function qj(t,e){return fu(t,"POST","/v1/accounts:signInWithEmailLink",mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc extends wy{constructor(e,n,r,i=null){super("password",r),this._email=e,this._password=n,this._tenantId=i}static _fromEmailAndPassword(e,n){return new qc(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new qc(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nh(e,n,"signInWithPassword",$j);case"emailLink":return Hj(e,{email:this._email,oobCode:this._password});default:Jn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nh(e,r,"signUpPassword",Fj);case"emailLink":return qj(e,{idToken:n,email:this._email,oobCode:this._password});default:Jn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _a(t,e){return fu(t,"POST","/v1/accounts:signInWithIdp",mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj="http://localhost";class ro extends wy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new ro(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Jn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=n,s=py(n,["providerId","signInMethod"]);if(!r||!i)return null;const o=new ro(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return _a(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,_a(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,_a(e,n)}buildRequest(){const e={requestUri:Kj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=du(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Wj(t){const e=Gl(Wl(t)).link,n=e?Gl(Wl(e)).deep_link_id:null,r=Gl(Wl(t)).deep_link_id;return(r?Gl(Wl(r)).link:null)||r||n||e||t}class xy{constructor(e){var n,r,i,s,o,a;const l=Gl(Wl(e)),c=(n=l.apiKey)!==null&&n!==void 0?n:null,d=(r=l.oobCode)!==null&&r!==void 0?r:null,h=Gj((i=l.mode)!==null&&i!==void 0?i:null);ge(c&&d&&h,"argument-error"),this.apiKey=c,this.operation=h,this.code=d,this.continueUrl=(s=l.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=l.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(a=l.tenantId)!==null&&a!==void 0?a:null}static parseLink(e){const n=Wj(e);try{return new xy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl{constructor(){this.providerId=nl.PROVIDER_ID}static credential(e,n){return qc._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=xy.parseLink(n);return ge(r,"argument-error"),qc._fromEmailAndCode(e,r.code,r.tenantId)}}nl.PROVIDER_ID="password";nl.EMAIL_PASSWORD_SIGN_IN_METHOD="password";nl.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ey{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu extends Ey{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li extends pu{constructor(){super("facebook.com")}static credential(e){return ro._fromParams({providerId:Li.PROVIDER_ID,signInMethod:Li.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Li.credentialFromTaggedObject(e)}static credentialFromError(e){return Li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Li.credential(e.oauthAccessToken)}catch{return null}}}Li.FACEBOOK_SIGN_IN_METHOD="facebook.com";Li.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wr extends pu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return ro._fromParams({providerId:Wr.PROVIDER_ID,signInMethod:Wr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Wr.credentialFromTaggedObject(e)}static credentialFromError(e){return Wr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Wr.credential(n,r)}catch{return null}}}Wr.GOOGLE_SIGN_IN_METHOD="google.com";Wr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mi extends pu{constructor(){super("github.com")}static credential(e){return ro._fromParams({providerId:Mi.PROVIDER_ID,signInMethod:Mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Mi.credentialFromTaggedObject(e)}static credentialFromError(e){return Mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Mi.credential(e.oauthAccessToken)}catch{return null}}}Mi.GITHUB_SIGN_IN_METHOD="github.com";Mi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ji extends pu{constructor(){super("twitter.com")}static credential(e,n){return ro._fromParams({providerId:ji.PROVIDER_ID,signInMethod:ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return ji.credentialFromTaggedObject(e)}static credentialFromError(e){return ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return ji.credential(n,r)}catch{return null}}}ji.TWITTER_SIGN_IN_METHOD="twitter.com";ji.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qj(t,e){return fu(t,"POST","/v1/accounts:signUp",mi(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class io{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,i=!1){const s=await Zr._fromIdTokenResponse(e,r,i),o=Cx(r);return new io({user:s,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const i=Cx(r);return new io({user:e,providerId:i,_tokenResponse:r,operationType:n})}}function Cx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ph extends yr{constructor(e,n,r,i){var s;super(n.code,n.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,Ph.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,i){return new Ph(e,n,r,i)}}function ZS(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Ph._fromErrorAndOperation(t,s,e,r):s})}async function Yj(t,e,n=!1){const r=await Da(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return io._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xj(t,e,n=!1){const{auth:r}=t;if(cr(r.app))return Promise.reject(ii(r));const i="reauthenticate";try{const s=await Da(t,ZS(r,i,e,t),n);ge(s.idToken,r,"internal-error");const o=vy(s.idToken);ge(o,r,"internal-error");const{sub:a}=o;return ge(t.uid===a,r,"user-mismatch"),io._forOperation(t,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Jn(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e2(t,e,n=!1){if(cr(t.app))return Promise.reject(ii(t));const r="signIn",i=await ZS(t,r,e),s=await io._fromIdTokenResponse(t,r,i);return n||await t._updateCurrentUser(s.user),s}async function Jj(t,e){return e2(gi(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t2(t){const e=gi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Zj(t,e,n){const r=gi(t);await Nh(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Bj)}async function e6(t,e,n){if(cr(t.app))return Promise.reject(ii(t));const r=gi(t),o=await Nh(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Qj).catch(l=>{throw l.code==="auth/password-does-not-meet-requirements"&&t2(t),l}),a=await io._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(a.user),a}function t6(t,e,n){return cr(t.app)?Promise.reject(ii(t)):Jj(Dt(t),nl.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&t2(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n6(t,e){return Mr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r6(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Dt(t),s={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await Da(r,n6(r.auth,s));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const a=r.providerData.find(({providerId:l})=>l==="password");a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function i6(t,e,n,r){return Dt(t).onIdTokenChanged(e,n,r)}function s6(t,e,n){return Dt(t).beforeAuthStateChanged(e,n)}function o6(t,e,n,r){return Dt(t).onAuthStateChanged(e,n,r)}function a6(t){return Dt(t).signOut()}const Dh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Dh,"1"),this.storage.removeItem(Dh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6=1e3,c6=10;class r2 extends n2{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=QS(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),i=this.localCache[n];r!==i&&e(n,i,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,a,l)=>{this.notifyListeners(o,l)});return}const r=e.key;n?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);Ej()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,c6):i()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},l6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}r2.type="LOCAL";const u6=r2;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2 extends n2{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}i2.type="SESSION";const s2=i2;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d6(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(i=>i.isListeningto(e));if(n)return n;const r=new Sf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:i,data:s}=n.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const a=Array.from(o).map(async c=>c(n.origin,s)),l=await d6(a);n.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:l})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Sf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function by(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((a,l)=>{const c=by("",20);i.port1.start();const d=setTimeout(()=>{l(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(h){const f=h;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),s=setTimeout(()=>{l(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),a(f.data.response);break;default:clearTimeout(d),clearTimeout(s),l(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:c,data:n},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(){return window}function f6(t){Pr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o2(){return typeof Pr().WorkerGlobalScope<"u"&&typeof Pr().importScripts=="function"}async function p6(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function m6(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function g6(){return o2()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="firebaseLocalStorageDb",y6=1,Vh="firebaseLocalStorage",l2="fbase_key";class mu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Cf(t,e){return t.transaction([Vh],e?"readwrite":"readonly").objectStore(Vh)}function v6(){const t=indexedDB.deleteDatabase(a2);return new mu(t).toPromise()}function wg(){const t=indexedDB.open(a2,y6);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Vh,{keyPath:l2})}catch(i){n(i)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Vh)?e(r):(r.close(),await v6(),e(await wg()))})})}async function Ax(t,e,n){const r=Cf(t,!0).put({[l2]:e,value:n});return new mu(r).toPromise()}async function _6(t,e){const n=Cf(t,!1).get(e),r=await new mu(n).toPromise();return r===void 0?null:r.value}function kx(t,e){const n=Cf(t,!0).delete(e);return new mu(n).toPromise()}const w6=800,x6=3;class c2{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await wg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>x6)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return o2()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Sf._getInstance(g6()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await p6(),!this.activeServiceWorker)return;this.sender=new h6(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||m6()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wg();return await Ax(e,Dh,"1"),await kx(e,Dh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Ax(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>_6(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>kx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Cf(i,!1).getAll();return new mu(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),n.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),n.push(i));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),w6)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}c2.type="LOCAL";const E6=c2;new hu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function u2(t,e){return e?ei(e):(ge(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy extends wy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _a(e,this._buildIdpRequest())}_linkToIdToken(e,n){return _a(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return _a(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function b6(t){return e2(t.auth,new Iy(t),t.bypassAuthState)}function I6(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),Xj(n,new Iy(t),t.bypassAuthState)}async function T6(t){const{auth:e,user:n}=t;return ge(n,e,"internal-error"),Yj(n,new Iy(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,n,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:i,tenantId:s,error:o,type:a}=e;if(o){this.reject(o);return}const l={auth:this.auth,requestUri:n,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(l))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return b6;case"linkViaPopup":case"linkViaRedirect":return T6;case"reauthViaPopup":case"reauthViaRedirect":return I6;default:Jn(this.auth,"internal-error")}}resolve(e){hi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){hi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S6=new hu(2e3,1e4);async function C6(t,e,n){if(cr(t.app))return Promise.reject(fr(t,"operation-not-supported-in-this-environment"));const r=gi(t);rj(t,e,Ey);const i=u2(r,n);return new Us(r,"signInViaPopup",e,i).executeNotNull()}class Us extends d2{constructor(e,n,r,i,s){super(e,n,i,s),this.provider=r,this.authWindow=null,this.pollId=null,Us.currentPopupAction&&Us.currentPopupAction.cancel(),Us.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ge(e,this.auth,"internal-error"),e}async onExecution(){hi(this.filter.length===1,"Popup operations only handle one event");const e=by();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(fr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(fr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Us.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(fr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,S6.get())};e()}}Us.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A6="pendingRedirect",zd=new Map;class k6 extends d2{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=zd.get(this.auth._key());if(!e){try{const r=await R6(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}zd.set(this.auth._key(),e)}return this.bypassAuthState||zd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function R6(t,e){const n=D6(e),r=P6(t);if(!await r._isAvailable())return!1;const i=await r._get(n)==="true";return await r._remove(n),i}function N6(t,e){zd.set(t._key(),e)}function P6(t){return ei(t._redirectPersistence)}function D6(t){return Od(A6,t.config.apiKey,t.name)}async function V6(t,e,n=!1){if(cr(t.app))return Promise.reject(ii(t));const r=gi(t),i=u2(r,e),o=await new k6(r,i,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O6=10*60*1e3;class z6{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!L6(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!h2(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(fr(this.auth,i))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=O6&&this.cachedEventUids.clear(),this.cachedEventUids.has(Rx(e))}saveEventToCache(e){this.cachedEventUids.add(Rx(e)),this.lastProcessedEventTime=Date.now()}}function Rx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function h2({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function L6(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return h2(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function M6(t,e={}){return Mr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,F6=/^https?/;async function $6(t){if(t.config.emulator)return;const{authorizedDomains:e}=await M6(t);for(const n of e)try{if(U6(n))return}catch{}Jn(t,"unauthorized-domain")}function U6(t){const e=vg(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!F6.test(n))return!1;if(j6.test(t))return r===t;const i=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B6=new hu(3e4,6e4);function Nx(){const t=Pr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function H6(t){return new Promise((e,n)=>{var r,i,s;function o(){Nx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Nx(),n(fr(t,"network-request-failed"))},timeout:B6.get()})}if(!((i=(r=Pr().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Pr().gapi)===null||s===void 0)&&s.load)o();else{const a=Nj("iframefcb");return Pr()[a]=()=>{gapi.load?o():n(fr(t,"network-request-failed"))},XS(`${Rj()}?onload=${a}`).catch(l=>n(l))}}).catch(e=>{throw Ld=null,e})}let Ld=null;function q6(t){return Ld=Ld||H6(t),Ld}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K6=new hu(5e3,15e3),G6="__/auth/iframe",W6="emulator/auth/iframe",Q6={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Y6=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function X6(t){const e=t.config;ge(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?yy(e,W6):`https://${t.config.authDomain}/${G6}`,r={apiKey:e.apiKey,appName:t.name,v:tl},i=Y6.get(t.config.apiHost);i&&(r.eid=i);const s=t._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${du(r).slice(1)}`}async function J6(t){const e=await q6(t),n=Pr().gapi;return ge(n,t,"internal-error"),e.open({where:document.body,url:X6(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Q6,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=fr(t,"network-request-failed"),a=Pr().setTimeout(()=>{s(o)},K6.get());function l(){Pr().clearTimeout(a),i(r)}r.ping(l).then(l,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z6={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},e9=500,t9=600,n9="_blank",r9="http://localhost";class Px{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function i9(t,e,n,r=e9,i=t9){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},Z6),{width:r.toString(),height:i.toString(),top:s,left:o}),c=It().toLowerCase();n&&(a=HS(c)?n9:n),US(c)&&(e=e||r9,l.scrollbars="yes");const d=Object.entries(l).reduce((f,[m,b])=>`${f}${m}=${b},`,"");if(xj(c)&&a!=="_self")return s9(e||"",a),new Px(null);const h=window.open(e||"",a,d);ge(h,t,"popup-blocked");try{h.focus()}catch{}return new Px(h)}function s9(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o9="__/auth/handler",a9="emulator/auth/handler",l9=encodeURIComponent("fac");async function Dx(t,e,n,r,i,s){ge(t.config.authDomain,t,"auth-domain-config-required"),ge(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:tl,eventId:i};if(e instanceof Ey){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",$M(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries({}))o[d]=h}if(e instanceof pu){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const a=o;for(const d of Object.keys(a))a[d]===void 0&&delete a[d];const l=await t._getAppCheckToken(),c=l?`#${l9}=${encodeURIComponent(l)}`:"";return`${c9(t)}?${du(a).slice(1)}${c}`}function c9({config:t}){return t.emulator?yy(t,a9):`https://${t.authDomain}/${o9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp="webStorageSupport";class u9{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=s2,this._completeRedirectFn=V6,this._overrideRedirectResult=N6}async _openPopup(e,n,r,i){var s;hi((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await Dx(e,n,r,vg(),i);return i9(e,o,by())}async _openRedirect(e,n,r,i){await this._originValidation(e);const s=await Dx(e,n,r,vg(),i);return f6(s),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:i,promise:s}=this.eventManagers[n];return i?Promise.resolve(i):(hi(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await J6(e),r=new z6(e);return n.register("authEvent",i=>(ge(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Hp,{type:Hp},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Hp];o!==void 0&&n(!!o),Jn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=$6(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return QS()||BS()||_y()}}const d9=u9;var Vx="@firebase/auth",Ox="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h9{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){ge(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f9(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function p9(t){Vr(new mr("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;ge(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:YS(t)},c=new Cj(r,i,s,l);return zj(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Vr(new mr("auth-internal",e=>{const n=gi(e.getProvider("auth").getImmediate());return(r=>new h9(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Qn(Vx,Ox,f9(t)),Qn(Vx,Ox,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m9=5*60,g9=bS("authIdTokenMaxAge")||m9;let zx=null;const y9=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>g9)return;const i=n==null?void 0:n.token;zx!==i&&(zx=i,await fetch(t,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function v9(t=NS()){const e=_o(t,"auth");if(e.isInitialized())return e.getImmediate();const n=Oj(t,{popupRedirectResolver:d9,persistence:[E6,u6,s2]}),r=bS("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=y9(s.toString());s6(n,o,()=>o(n.currentUser)),i6(n,a=>o(a))}}const i=RM("auth");return i&&Lj(n,`http://${i}`),n}function _9(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Aj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=i=>{const s=fr("internal-error");s.customData=i,n(s)},r.type="text/javascript",r.charset="UTF-8",_9().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});p9("Browser");var w9="firebase",x9="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Qn(w9,x9,"app");var Lx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ws,f2;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(S,I){function w(){}w.prototype=I.prototype,S.D=I.prototype,S.prototype=new w,S.prototype.constructor=S,S.C=function(E,C,N){for(var k=Array(arguments.length-2),P=2;P<arguments.length;P++)k[P-2]=arguments[P];return I.prototype[C].apply(E,k)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(S,I,w){w||(w=0);var E=Array(16);if(typeof I=="string")for(var C=0;16>C;++C)E[C]=I.charCodeAt(w++)|I.charCodeAt(w++)<<8|I.charCodeAt(w++)<<16|I.charCodeAt(w++)<<24;else for(C=0;16>C;++C)E[C]=I[w++]|I[w++]<<8|I[w++]<<16|I[w++]<<24;I=S.g[0],w=S.g[1],C=S.g[2];var N=S.g[3],k=I+(N^w&(C^N))+E[0]+3614090360&4294967295;I=w+(k<<7&4294967295|k>>>25),k=N+(C^I&(w^C))+E[1]+3905402710&4294967295,N=I+(k<<12&4294967295|k>>>20),k=C+(w^N&(I^w))+E[2]+606105819&4294967295,C=N+(k<<17&4294967295|k>>>15),k=w+(I^C&(N^I))+E[3]+3250441966&4294967295,w=C+(k<<22&4294967295|k>>>10),k=I+(N^w&(C^N))+E[4]+4118548399&4294967295,I=w+(k<<7&4294967295|k>>>25),k=N+(C^I&(w^C))+E[5]+1200080426&4294967295,N=I+(k<<12&4294967295|k>>>20),k=C+(w^N&(I^w))+E[6]+2821735955&4294967295,C=N+(k<<17&4294967295|k>>>15),k=w+(I^C&(N^I))+E[7]+4249261313&4294967295,w=C+(k<<22&4294967295|k>>>10),k=I+(N^w&(C^N))+E[8]+1770035416&4294967295,I=w+(k<<7&4294967295|k>>>25),k=N+(C^I&(w^C))+E[9]+2336552879&4294967295,N=I+(k<<12&4294967295|k>>>20),k=C+(w^N&(I^w))+E[10]+4294925233&4294967295,C=N+(k<<17&4294967295|k>>>15),k=w+(I^C&(N^I))+E[11]+2304563134&4294967295,w=C+(k<<22&4294967295|k>>>10),k=I+(N^w&(C^N))+E[12]+1804603682&4294967295,I=w+(k<<7&4294967295|k>>>25),k=N+(C^I&(w^C))+E[13]+4254626195&4294967295,N=I+(k<<12&4294967295|k>>>20),k=C+(w^N&(I^w))+E[14]+2792965006&4294967295,C=N+(k<<17&4294967295|k>>>15),k=w+(I^C&(N^I))+E[15]+1236535329&4294967295,w=C+(k<<22&4294967295|k>>>10),k=I+(C^N&(w^C))+E[1]+4129170786&4294967295,I=w+(k<<5&4294967295|k>>>27),k=N+(w^C&(I^w))+E[6]+3225465664&4294967295,N=I+(k<<9&4294967295|k>>>23),k=C+(I^w&(N^I))+E[11]+643717713&4294967295,C=N+(k<<14&4294967295|k>>>18),k=w+(N^I&(C^N))+E[0]+3921069994&4294967295,w=C+(k<<20&4294967295|k>>>12),k=I+(C^N&(w^C))+E[5]+3593408605&4294967295,I=w+(k<<5&4294967295|k>>>27),k=N+(w^C&(I^w))+E[10]+38016083&4294967295,N=I+(k<<9&4294967295|k>>>23),k=C+(I^w&(N^I))+E[15]+3634488961&4294967295,C=N+(k<<14&4294967295|k>>>18),k=w+(N^I&(C^N))+E[4]+3889429448&4294967295,w=C+(k<<20&4294967295|k>>>12),k=I+(C^N&(w^C))+E[9]+568446438&4294967295,I=w+(k<<5&4294967295|k>>>27),k=N+(w^C&(I^w))+E[14]+3275163606&4294967295,N=I+(k<<9&4294967295|k>>>23),k=C+(I^w&(N^I))+E[3]+4107603335&4294967295,C=N+(k<<14&4294967295|k>>>18),k=w+(N^I&(C^N))+E[8]+1163531501&4294967295,w=C+(k<<20&4294967295|k>>>12),k=I+(C^N&(w^C))+E[13]+2850285829&4294967295,I=w+(k<<5&4294967295|k>>>27),k=N+(w^C&(I^w))+E[2]+4243563512&4294967295,N=I+(k<<9&4294967295|k>>>23),k=C+(I^w&(N^I))+E[7]+1735328473&4294967295,C=N+(k<<14&4294967295|k>>>18),k=w+(N^I&(C^N))+E[12]+2368359562&4294967295,w=C+(k<<20&4294967295|k>>>12),k=I+(w^C^N)+E[5]+4294588738&4294967295,I=w+(k<<4&4294967295|k>>>28),k=N+(I^w^C)+E[8]+2272392833&4294967295,N=I+(k<<11&4294967295|k>>>21),k=C+(N^I^w)+E[11]+1839030562&4294967295,C=N+(k<<16&4294967295|k>>>16),k=w+(C^N^I)+E[14]+4259657740&4294967295,w=C+(k<<23&4294967295|k>>>9),k=I+(w^C^N)+E[1]+2763975236&4294967295,I=w+(k<<4&4294967295|k>>>28),k=N+(I^w^C)+E[4]+1272893353&4294967295,N=I+(k<<11&4294967295|k>>>21),k=C+(N^I^w)+E[7]+4139469664&4294967295,C=N+(k<<16&4294967295|k>>>16),k=w+(C^N^I)+E[10]+3200236656&4294967295,w=C+(k<<23&4294967295|k>>>9),k=I+(w^C^N)+E[13]+681279174&4294967295,I=w+(k<<4&4294967295|k>>>28),k=N+(I^w^C)+E[0]+3936430074&4294967295,N=I+(k<<11&4294967295|k>>>21),k=C+(N^I^w)+E[3]+3572445317&4294967295,C=N+(k<<16&4294967295|k>>>16),k=w+(C^N^I)+E[6]+76029189&4294967295,w=C+(k<<23&4294967295|k>>>9),k=I+(w^C^N)+E[9]+3654602809&4294967295,I=w+(k<<4&4294967295|k>>>28),k=N+(I^w^C)+E[12]+3873151461&4294967295,N=I+(k<<11&4294967295|k>>>21),k=C+(N^I^w)+E[15]+530742520&4294967295,C=N+(k<<16&4294967295|k>>>16),k=w+(C^N^I)+E[2]+3299628645&4294967295,w=C+(k<<23&4294967295|k>>>9),k=I+(C^(w|~N))+E[0]+4096336452&4294967295,I=w+(k<<6&4294967295|k>>>26),k=N+(w^(I|~C))+E[7]+1126891415&4294967295,N=I+(k<<10&4294967295|k>>>22),k=C+(I^(N|~w))+E[14]+2878612391&4294967295,C=N+(k<<15&4294967295|k>>>17),k=w+(N^(C|~I))+E[5]+4237533241&4294967295,w=C+(k<<21&4294967295|k>>>11),k=I+(C^(w|~N))+E[12]+1700485571&4294967295,I=w+(k<<6&4294967295|k>>>26),k=N+(w^(I|~C))+E[3]+2399980690&4294967295,N=I+(k<<10&4294967295|k>>>22),k=C+(I^(N|~w))+E[10]+4293915773&4294967295,C=N+(k<<15&4294967295|k>>>17),k=w+(N^(C|~I))+E[1]+2240044497&4294967295,w=C+(k<<21&4294967295|k>>>11),k=I+(C^(w|~N))+E[8]+1873313359&4294967295,I=w+(k<<6&4294967295|k>>>26),k=N+(w^(I|~C))+E[15]+4264355552&4294967295,N=I+(k<<10&4294967295|k>>>22),k=C+(I^(N|~w))+E[6]+2734768916&4294967295,C=N+(k<<15&4294967295|k>>>17),k=w+(N^(C|~I))+E[13]+1309151649&4294967295,w=C+(k<<21&4294967295|k>>>11),k=I+(C^(w|~N))+E[4]+4149444226&4294967295,I=w+(k<<6&4294967295|k>>>26),k=N+(w^(I|~C))+E[11]+3174756917&4294967295,N=I+(k<<10&4294967295|k>>>22),k=C+(I^(N|~w))+E[2]+718787259&4294967295,C=N+(k<<15&4294967295|k>>>17),k=w+(N^(C|~I))+E[9]+3951481745&4294967295,S.g[0]=S.g[0]+I&4294967295,S.g[1]=S.g[1]+(C+(k<<21&4294967295|k>>>11))&4294967295,S.g[2]=S.g[2]+C&4294967295,S.g[3]=S.g[3]+N&4294967295}r.prototype.u=function(S,I){I===void 0&&(I=S.length);for(var w=I-this.blockSize,E=this.B,C=this.h,N=0;N<I;){if(C==0)for(;N<=w;)i(this,S,N),N+=this.blockSize;if(typeof S=="string"){for(;N<I;)if(E[C++]=S.charCodeAt(N++),C==this.blockSize){i(this,E),C=0;break}}else for(;N<I;)if(E[C++]=S[N++],C==this.blockSize){i(this,E),C=0;break}}this.h=C,this.o+=I},r.prototype.v=function(){var S=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);S[0]=128;for(var I=1;I<S.length-8;++I)S[I]=0;var w=8*this.o;for(I=S.length-8;I<S.length;++I)S[I]=w&255,w/=256;for(this.u(S),S=Array(16),I=w=0;4>I;++I)for(var E=0;32>E;E+=8)S[w++]=this.g[I]>>>E&255;return S};function s(S,I){var w=a;return Object.prototype.hasOwnProperty.call(w,S)?w[S]:w[S]=I(S)}function o(S,I){this.h=I;for(var w=[],E=!0,C=S.length-1;0<=C;C--){var N=S[C]|0;E&&N==I||(w[C]=N,E=!1)}this.g=w}var a={};function l(S){return-128<=S&&128>S?s(S,function(I){return new o([I|0],0>I?-1:0)}):new o([S|0],0>S?-1:0)}function c(S){if(isNaN(S)||!isFinite(S))return h;if(0>S)return R(c(-S));for(var I=[],w=1,E=0;S>=w;E++)I[E]=S/w|0,w*=4294967296;return new o(I,0)}function d(S,I){if(S.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(S.charAt(0)=="-")return R(d(S.substring(1),I));if(0<=S.indexOf("-"))throw Error('number format error: interior "-" character');for(var w=c(Math.pow(I,8)),E=h,C=0;C<S.length;C+=8){var N=Math.min(8,S.length-C),k=parseInt(S.substring(C,C+N),I);8>N?(N=c(Math.pow(I,N)),E=E.j(N).add(c(k))):(E=E.j(w),E=E.add(c(k)))}return E}var h=l(0),f=l(1),m=l(16777216);t=o.prototype,t.m=function(){if(x(this))return-R(this).m();for(var S=0,I=1,w=0;w<this.g.length;w++){var E=this.i(w);S+=(0<=E?E:4294967296+E)*I,I*=4294967296}return S},t.toString=function(S){if(S=S||10,2>S||36<S)throw Error("radix out of range: "+S);if(b(this))return"0";if(x(this))return"-"+R(this).toString(S);for(var I=c(Math.pow(S,6)),w=this,E="";;){var C=A(w,I).g;w=y(w,C.j(I));var N=((0<w.g.length?w.g[0]:w.h)>>>0).toString(S);if(w=C,b(w))return N+E;for(;6>N.length;)N="0"+N;E=N+E}},t.i=function(S){return 0>S?0:S<this.g.length?this.g[S]:this.h};function b(S){if(S.h!=0)return!1;for(var I=0;I<S.g.length;I++)if(S.g[I]!=0)return!1;return!0}function x(S){return S.h==-1}t.l=function(S){return S=y(this,S),x(S)?-1:b(S)?0:1};function R(S){for(var I=S.g.length,w=[],E=0;E<I;E++)w[E]=~S.g[E];return new o(w,~S.h).add(f)}t.abs=function(){return x(this)?R(this):this},t.add=function(S){for(var I=Math.max(this.g.length,S.g.length),w=[],E=0,C=0;C<=I;C++){var N=E+(this.i(C)&65535)+(S.i(C)&65535),k=(N>>>16)+(this.i(C)>>>16)+(S.i(C)>>>16);E=k>>>16,N&=65535,k&=65535,w[C]=k<<16|N}return new o(w,w[w.length-1]&-2147483648?-1:0)};function y(S,I){return S.add(R(I))}t.j=function(S){if(b(this)||b(S))return h;if(x(this))return x(S)?R(this).j(R(S)):R(R(this).j(S));if(x(S))return R(this.j(R(S)));if(0>this.l(m)&&0>S.l(m))return c(this.m()*S.m());for(var I=this.g.length+S.g.length,w=[],E=0;E<2*I;E++)w[E]=0;for(E=0;E<this.g.length;E++)for(var C=0;C<S.g.length;C++){var N=this.i(E)>>>16,k=this.i(E)&65535,P=S.i(C)>>>16,j=S.i(C)&65535;w[2*E+2*C]+=k*j,v(w,2*E+2*C),w[2*E+2*C+1]+=N*j,v(w,2*E+2*C+1),w[2*E+2*C+1]+=k*P,v(w,2*E+2*C+1),w[2*E+2*C+2]+=N*P,v(w,2*E+2*C+2)}for(E=0;E<I;E++)w[E]=w[2*E+1]<<16|w[2*E];for(E=I;E<2*I;E++)w[E]=0;return new o(w,0)};function v(S,I){for(;(S[I]&65535)!=S[I];)S[I+1]+=S[I]>>>16,S[I]&=65535,I++}function T(S,I){this.g=S,this.h=I}function A(S,I){if(b(I))throw Error("division by zero");if(b(S))return new T(h,h);if(x(S))return I=A(R(S),I),new T(R(I.g),R(I.h));if(x(I))return I=A(S,R(I)),new T(R(I.g),I.h);if(30<S.g.length){if(x(S)||x(I))throw Error("slowDivide_ only works with positive integers.");for(var w=f,E=I;0>=E.l(S);)w=O(w),E=O(E);var C=L(w,1),N=L(E,1);for(E=L(E,2),w=L(w,2);!b(E);){var k=N.add(E);0>=k.l(S)&&(C=C.add(w),N=k),E=L(E,1),w=L(w,1)}return I=y(S,C.j(I)),new T(C,I)}for(C=h;0<=S.l(I);){for(w=Math.max(1,Math.floor(S.m()/I.m())),E=Math.ceil(Math.log(w)/Math.LN2),E=48>=E?1:Math.pow(2,E-48),N=c(w),k=N.j(I);x(k)||0<k.l(S);)w-=E,N=c(w),k=N.j(I);b(N)&&(N=f),C=C.add(N),S=y(S,k)}return new T(C,S)}t.A=function(S){return A(this,S).h},t.and=function(S){for(var I=Math.max(this.g.length,S.g.length),w=[],E=0;E<I;E++)w[E]=this.i(E)&S.i(E);return new o(w,this.h&S.h)},t.or=function(S){for(var I=Math.max(this.g.length,S.g.length),w=[],E=0;E<I;E++)w[E]=this.i(E)|S.i(E);return new o(w,this.h|S.h)},t.xor=function(S){for(var I=Math.max(this.g.length,S.g.length),w=[],E=0;E<I;E++)w[E]=this.i(E)^S.i(E);return new o(w,this.h^S.h)};function O(S){for(var I=S.g.length+1,w=[],E=0;E<I;E++)w[E]=S.i(E)<<1|S.i(E-1)>>>31;return new o(w,S.h)}function L(S,I){var w=I>>5;I%=32;for(var E=S.g.length-w,C=[],N=0;N<E;N++)C[N]=0<I?S.i(N+w)>>>I|S.i(N+w+1)<<32-I:S.i(N+w);return new o(C,S.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,f2=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=c,o.fromString=d,Ws=o}).apply(typeof Lx<"u"?Lx:typeof self<"u"?self:typeof window<"u"?window:{});var dd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var p2,Ql,m2,Md,xg,g2,y2,v2;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,g,_){return u==Array.prototype||u==Object.prototype||(u[g]=_.value),u};function n(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof dd=="object"&&dd];for(var g=0;g<u.length;++g){var _=u[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=n(this);function i(u,g){if(g)e:{var _=r;u=u.split(".");for(var V=0;V<u.length-1;V++){var H=u[V];if(!(H in _))break e;_=_[H]}u=u[u.length-1],V=_[u],g=g(V),g!=V&&g!=null&&e(_,u,{configurable:!0,writable:!0,value:g})}}function s(u,g){u instanceof String&&(u+="");var _=0,V=!1,H={next:function(){if(!V&&_<u.length){var W=_++;return{value:g(W,u[W]),done:!1}}return V=!0,{done:!0,value:void 0}}};return H[Symbol.iterator]=function(){return H},H}i("Array.prototype.values",function(u){return u||function(){return s(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},a=this||self;function l(u){var g=typeof u;return g=g!="object"?g:u?Array.isArray(u)?"array":g:"null",g=="array"||g=="object"&&typeof u.length=="number"}function c(u){var g=typeof u;return g=="object"&&u!=null||g=="function"}function d(u,g,_){return u.call.apply(u.bind,arguments)}function h(u,g,_){if(!u)throw Error();if(2<arguments.length){var V=Array.prototype.slice.call(arguments,2);return function(){var H=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(H,V),u.apply(g,H)}}return function(){return u.apply(g,arguments)}}function f(u,g,_){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(u,g){var _=Array.prototype.slice.call(arguments,1);return function(){var V=_.slice();return V.push.apply(V,arguments),u.apply(this,V)}}function b(u,g){function _(){}_.prototype=g.prototype,u.aa=g.prototype,u.prototype=new _,u.prototype.constructor=u,u.Qb=function(V,H,W){for(var te=Array(arguments.length-2),He=2;He<arguments.length;He++)te[He-2]=arguments[He];return g.prototype[H].apply(V,te)}}function x(u){const g=u.length;if(0<g){const _=Array(g);for(let V=0;V<g;V++)_[V]=u[V];return _}return[]}function R(u,g){for(let _=1;_<arguments.length;_++){const V=arguments[_];if(l(V)){const H=u.length||0,W=V.length||0;u.length=H+W;for(let te=0;te<W;te++)u[H+te]=V[te]}else u.push(V)}}class y{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function v(u){return/^[\s\xa0]*$/.test(u)}function T(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function A(u){return A[" "](u),u}A[" "]=function(){};var O=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function L(u,g,_){for(const V in u)g.call(_,u[V],V,u)}function S(u,g){for(const _ in u)g.call(void 0,u[_],_,u)}function I(u){const g={};for(const _ in u)g[_]=u[_];return g}const w="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function E(u,g){let _,V;for(let H=1;H<arguments.length;H++){V=arguments[H];for(_ in V)u[_]=V[_];for(let W=0;W<w.length;W++)_=w[W],Object.prototype.hasOwnProperty.call(V,_)&&(u[_]=V[_])}}function C(u){var g=1;u=u.split(":");const _=[];for(;0<g&&u.length;)_.push(u.shift()),g--;return u.length&&_.push(u.join(":")),_}function N(u){a.setTimeout(()=>{throw u},0)}function k(){var u=M;let g=null;return u.g&&(g=u.g,u.g=u.g.next,u.g||(u.h=null),g.next=null),g}class P{constructor(){this.h=this.g=null}add(g,_){const V=j.get();V.set(g,_),this.h?this.h.next=V:this.g=V,this.h=V}}var j=new y(()=>new z,u=>u.reset());class z{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let U,F=!1,M=new P,B=()=>{const u=a.Promise.resolve(void 0);U=()=>{u.then(G)}};var G=()=>{for(var u;u=k();){try{u.h.call(u.g)}catch(_){N(_)}var g=j;g.j(u),100>g.h&&(g.h++,u.next=g.g,g.g=u)}F=!1};function $(){this.s=this.s,this.C=this.C}$.prototype.s=!1,$.prototype.ma=function(){this.s||(this.s=!0,this.N())},$.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function Y(u,g){this.type=u,this.g=this.target=g,this.defaultPrevented=!1}Y.prototype.h=function(){this.defaultPrevented=!0};var X=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,g=Object.defineProperty({},"passive",{get:function(){u=!0}});try{const _=()=>{};a.addEventListener("test",_,g),a.removeEventListener("test",_,g)}catch{}return u}();function ee(u,g){if(Y.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var _=this.type=u.type,V=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=g,g=u.relatedTarget){if(O){e:{try{A(g.nodeName);var H=!0;break e}catch{}H=!1}H||(g=null)}}else _=="mouseover"?g=u.fromElement:_=="mouseout"&&(g=u.toElement);this.relatedTarget=g,V?(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:re[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&ee.aa.h.call(this)}}b(ee,Y);var re={2:"touch",3:"pen",4:"mouse"};ee.prototype.h=function(){ee.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var fe="closure_listenable_"+(1e6*Math.random()|0),ie=0;function xe(u,g,_,V,H){this.listener=u,this.proxy=null,this.src=g,this.type=_,this.capture=!!V,this.ha=H,this.key=++ie,this.da=this.fa=!1}function ve(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Re(u){this.src=u,this.g={},this.h=0}Re.prototype.add=function(u,g,_,V,H){var W=u.toString();u=this.g[W],u||(u=this.g[W]=[],this.h++);var te=tt(u,g,V,H);return-1<te?(g=u[te],_||(g.fa=!1)):(g=new xe(g,this.src,W,!!V,H),g.fa=_,u.push(g)),g};function Le(u,g){var _=g.type;if(_ in u.g){var V=u.g[_],H=Array.prototype.indexOf.call(V,g,void 0),W;(W=0<=H)&&Array.prototype.splice.call(V,H,1),W&&(ve(g),u.g[_].length==0&&(delete u.g[_],u.h--))}}function tt(u,g,_,V){for(var H=0;H<u.length;++H){var W=u[H];if(!W.da&&W.listener==g&&W.capture==!!_&&W.ha==V)return H}return-1}var Me="closure_lm_"+(1e6*Math.random()|0),Ve={};function Be(u,g,_,V,H){if(Array.isArray(g)){for(var W=0;W<g.length;W++)Be(u,g[W],_,V,H);return null}return _=gt(_),u&&u[fe]?u.K(g,_,c(V)?!!V.capture:!1,H):Ee(u,g,_,!1,V,H)}function Ee(u,g,_,V,H,W){if(!g)throw Error("Invalid event type");var te=c(H)?!!H.capture:!!H,He=Qt(u);if(He||(u[Me]=He=new Re(u)),_=He.add(g,_,V,te,W),_.proxy)return _;if(V=oe(),_.proxy=V,V.src=u,V.listener=_,u.addEventListener)X||(H=te),H===void 0&&(H=!1),u.addEventListener(g.toString(),V,H);else if(u.attachEvent)u.attachEvent(En(g.toString()),V);else if(u.addListener&&u.removeListener)u.addListener(V);else throw Error("addEventListener and attachEvent are unavailable.");return _}function oe(){function u(_){return g.call(u.src,u.listener,_)}const g=jn;return u}function Ce(u,g,_,V,H){if(Array.isArray(g))for(var W=0;W<g.length;W++)Ce(u,g[W],_,V,H);else V=c(V)?!!V.capture:!!V,_=gt(_),u&&u[fe]?(u=u.i,g=String(g).toString(),g in u.g&&(W=u.g[g],_=tt(W,_,V,H),-1<_&&(ve(W[_]),Array.prototype.splice.call(W,_,1),W.length==0&&(delete u.g[g],u.h--)))):u&&(u=Qt(u))&&(g=u.g[g.toString()],u=-1,g&&(u=tt(g,_,V,H)),(_=-1<u?g[u]:null)&&St(_))}function St(u){if(typeof u!="number"&&u&&!u.da){var g=u.src;if(g&&g[fe])Le(g.i,u);else{var _=u.type,V=u.proxy;g.removeEventListener?g.removeEventListener(_,V,u.capture):g.detachEvent?g.detachEvent(En(_),V):g.addListener&&g.removeListener&&g.removeListener(V),(_=Qt(g))?(Le(_,u),_.h==0&&(_.src=null,g[Me]=null)):ve(u)}}}function En(u){return u in Ve?Ve[u]:Ve[u]="on"+u}function jn(u,g){if(u.da)u=!0;else{g=new ee(g,this);var _=u.listener,V=u.ha||u.src;u.fa&&St(u),u=_.call(V,g)}return u}function Qt(u){return u=u[Me],u instanceof Re?u:null}var Ye="__closure_events_fn_"+(1e9*Math.random()>>>0);function gt(u){return typeof u=="function"?u:(u[Ye]||(u[Ye]=function(g){return u.handleEvent(g)}),u[Ye])}function Ne(){$.call(this),this.i=new Re(this),this.M=this,this.F=null}b(Ne,$),Ne.prototype[fe]=!0,Ne.prototype.removeEventListener=function(u,g,_,V){Ce(this,u,g,_,V)};function ze(u,g){var _,V=u.F;if(V)for(_=[];V;V=V.F)_.push(V);if(u=u.M,V=g.type||g,typeof g=="string")g=new Y(g,u);else if(g instanceof Y)g.target=g.target||u;else{var H=g;g=new Y(V,u),E(g,H)}if(H=!0,_)for(var W=_.length-1;0<=W;W--){var te=g.g=_[W];H=Ct(te,V,!0,g)&&H}if(te=g.g=u,H=Ct(te,V,!0,g)&&H,H=Ct(te,V,!1,g)&&H,_)for(W=0;W<_.length;W++)te=g.g=_[W],H=Ct(te,V,!1,g)&&H}Ne.prototype.N=function(){if(Ne.aa.N.call(this),this.i){var u=this.i,g;for(g in u.g){for(var _=u.g[g],V=0;V<_.length;V++)ve(_[V]);delete u.g[g],u.h--}}this.F=null},Ne.prototype.K=function(u,g,_,V){return this.i.add(String(u),g,!1,_,V)},Ne.prototype.L=function(u,g,_,V){return this.i.add(String(u),g,!0,_,V)};function Ct(u,g,_,V){if(g=u.i.g[String(g)],!g)return!0;g=g.concat();for(var H=!0,W=0;W<g.length;++W){var te=g[W];if(te&&!te.da&&te.capture==_){var He=te.listener,Ot=te.ha||te.src;te.fa&&Le(u.i,te),H=He.call(Ot,V)!==!1&&H}}return H&&!V.defaultPrevented}function Yt(u,g,_){if(typeof u=="function")_&&(u=f(u,_));else if(u&&typeof u.handleEvent=="function")u=f(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:a.setTimeout(u,g||0)}function vr(u){u.g=Yt(()=>{u.g=null,u.i&&(u.i=!1,vr(u))},u.l);const g=u.h;u.h=null,u.m.apply(null,g)}class yt extends ${constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:vr(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ke(u){$.call(this),this.h=u,this.g={}}b(Ke,$);var sn=[];function Fn(u){L(u.g,function(g,_){this.g.hasOwnProperty(_)&&St(g)},u),u.g={}}Ke.prototype.N=function(){Ke.aa.N.call(this),Fn(this)},Ke.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ge=a.JSON.stringify,on=a.JSON.parse,Xt=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function Zn(){}Zn.prototype.h=null;function yi(u){return u.h||(u.h=u.i())}function _r(){}var er={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function vi(){Y.call(this,"d")}b(vi,Y);function bn(){Y.call(this,"c")}b(bn,Y);var tr={},xo=null;function _i(){return xo=xo||new Ne}tr.La="serverreachability";function Eo(u){Y.call(this,tr.La,u)}b(Eo,Y);function wr(u){const g=_i();ze(g,new Eo(g))}tr.STAT_EVENT="statevent";function bo(u,g){Y.call(this,tr.STAT_EVENT,u),this.stat=g}b(bo,Y);function xt(u){const g=_i();ze(g,new bo(g,u))}tr.Ma="timingevent";function Io(u,g){Y.call(this,tr.Ma,u),this.size=g}b(Io,Y);function jr(u,g){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},g)}function an(){this.g=!0}an.prototype.xa=function(){this.g=!1};function cl(u,g,_,V,H,W){u.info(function(){if(u.g)if(W)for(var te="",He=W.split("&"),Ot=0;Ot<He.length;Ot++){var Oe=He[Ot].split("=");if(1<Oe.length){var $t=Oe[0];Oe=Oe[1];var Ut=$t.split("_");te=2<=Ut.length&&Ut[1]=="type"?te+($t+"="+Oe+"&"):te+($t+"=redacted&")}}else te=null;else te=W;return"XMLHTTP REQ ("+V+") [attempt "+H+"]: "+g+`
`+_+`
`+te})}function ul(u,g,_,V,H,W,te){u.info(function(){return"XMLHTTP RESP ("+V+") [ attempt "+H+"]: "+g+`
`+_+`
`+W+" "+te})}function xr(u,g,_,V){u.info(function(){return"XMLHTTP TEXT ("+g+"): "+hl(u,_)+(V?" "+V:"")})}function dl(u,g){u.info(function(){return"TIMEOUT: "+g})}an.prototype.info=function(){};function hl(u,g){if(!u.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(u=0;u<_.length;u++)if(Array.isArray(_[u])){var V=_[u];if(!(2>V.length)){var H=V[1];if(Array.isArray(H)&&!(1>H.length)){var W=H[0];if(W!="noop"&&W!="stop"&&W!="close")for(var te=1;te<H.length;te++)H[te]=""}}}}return Ge(_)}catch{return g}}var wi={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_s={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},ws;function xi(){}b(xi,Zn),xi.prototype.g=function(){return new XMLHttpRequest},xi.prototype.i=function(){return{}},ws=new xi;function $n(u,g,_,V){this.j=u,this.i=g,this.l=_,this.R=V||1,this.U=new Ke(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new xs}function xs(){this.i=null,this.g="",this.h=!1}var To={},Es={};function Fr(u,g,_){u.L=1,u.v=Su(Ur(g)),u.m=_,u.P=!0,bs(u,null)}function bs(u,g){u.F=Date.now(),Er(u),u.A=Ur(u.v);var _=u.A,V=u.R;Array.isArray(V)||(V=[String(V)]),Cv(_.i,"t",V),u.C=0,_=u.j.J,u.h=new xs,u.g=qv(u.j,_?g:null,!u.m),0<u.O&&(u.M=new yt(f(u.Y,u,u.g),u.O)),g=u.U,_=u.g,V=u.ca;var H="readystatechange";Array.isArray(H)||(H&&(sn[0]=H.toString()),H=sn);for(var W=0;W<H.length;W++){var te=Be(_,H[W],V||g.handleEvent,!1,g.h||g);if(!te)break;g.g[te.key]=te}g=u.H?I(u.H):{},u.m?(u.u||(u.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,g)):(u.u="GET",u.g.ea(u.A,u.u,null,g)),wr(),cl(u.i,u.u,u.A,u.l,u.R,u.m)}$n.prototype.ca=function(u){u=u.target;const g=this.M;g&&Br(u)==3?g.j():this.Y(u)},$n.prototype.Y=function(u){try{if(u==this.g)e:{const Ut=Br(this.g);var g=this.g.Ba();const Ro=this.g.Z();if(!(3>Ut)&&(Ut!=3||this.g&&(this.h.h||this.g.oa()||Vv(this.g)))){this.J||Ut!=4||g==7||(g==8||0>=Ro?wr(3):wr(2)),Ei(this);var _=this.g.Z();this.X=_;t:if(Is(this)){var V=Vv(this.g);u="";var H=V.length,W=Br(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Un(this),br(this);var te="";break t}this.h.i=new a.TextDecoder}for(g=0;g<H;g++)this.h.h=!0,u+=this.h.i.decode(V[g],{stream:!(W&&g==H-1)});V.length=0,this.h.g+=u,this.C=0,te=this.h.g}else te=this.g.oa();if(this.o=_==200,ul(this.i,this.u,this.A,this.l,this.R,Ut,_),this.o){if(this.T&&!this.K){t:{if(this.g){var He,Ot=this.g;if((He=Ot.g?Ot.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(He)){var Oe=He;break t}}Oe=null}if(_=Oe)xr(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,_e(this,_);else{this.o=!1,this.s=3,xt(12),Un(this),br(this);break e}}if(this.P){_=!0;let nr;for(;!this.J&&this.C<te.length;)if(nr=fl(this,te),nr==Es){Ut==4&&(this.s=4,xt(14),_=!1),xr(this.i,this.l,null,"[Incomplete Response]");break}else if(nr==To){this.s=4,xt(15),xr(this.i,this.l,te,"[Invalid Chunk]"),_=!1;break}else xr(this.i,this.l,nr,null),_e(this,nr);if(Is(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ut!=4||te.length!=0||this.h.h||(this.s=1,xt(16),_=!1),this.o=this.o&&_,!_)xr(this.i,this.l,te,"[Invalid Chunked Response]"),Un(this),br(this);else if(0<te.length&&!this.W){this.W=!0;var $t=this.j;$t.g==this&&$t.ba&&!$t.M&&($t.j.info("Great, no buffering proxy detected. Bytes received: "+te.length),Qf($t),$t.M=!0,xt(11))}}else xr(this.i,this.l,te,null),_e(this,te);Ut==4&&Un(this),this.o&&!this.J&&(Ut==4?$v(this.j,this):(this.o=!1,Er(this)))}else ok(this.g),_==400&&0<te.indexOf("Unknown SID")?(this.s=3,xt(12)):(this.s=0,xt(13)),Un(this),br(this)}}}catch{}finally{}};function Is(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function fl(u,g){var _=u.C,V=g.indexOf(`
`,_);return V==-1?Es:(_=Number(g.substring(_,V)),isNaN(_)?To:(V+=1,V+_>g.length?Es:(g=g.slice(V,V+_),u.C=V+_,g)))}$n.prototype.cancel=function(){this.J=!0,Un(this)};function Er(u){u.S=Date.now()+u.I,So(u,u.I)}function So(u,g){if(u.B!=null)throw Error("WatchDog timer not null");u.B=jr(f(u.ba,u),g)}function Ei(u){u.B&&(a.clearTimeout(u.B),u.B=null)}$n.prototype.ba=function(){this.B=null;const u=Date.now();0<=u-this.S?(dl(this.i,this.A),this.L!=2&&(wr(),xt(17)),Un(this),this.s=2,br(this)):So(this,this.S-u)};function br(u){u.j.G==0||u.J||$v(u.j,u)}function Un(u){Ei(u);var g=u.M;g&&typeof g.ma=="function"&&g.ma(),u.M=null,Fn(u.U),u.g&&(g=u.g,u.g=null,g.abort(),g.ma())}function _e(u,g){try{var _=u.j;if(_.G!=0&&(_.g==u||$r(_.h,u))){if(!u.K&&$r(_.h,u)&&_.G==3){try{var V=_.Da.g.parse(g)}catch{V=null}if(Array.isArray(V)&&V.length==3){var H=V;if(H[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<u.F)Pu(_),Ru(_);else break e;Wf(_),xt(18)}}else _.za=H[1],0<_.za-_.T&&37500>H[2]&&_.F&&_.v==0&&!_.C&&(_.C=jr(f(_.Za,_),6e3));if(1>=Xe(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Ss(_,11)}else if((u.K||_.g==u)&&Pu(_),!v(g))for(H=_.Da.g.parse(g),g=0;g<H.length;g++){let Oe=H[g];if(_.T=Oe[0],Oe=Oe[1],_.G==2)if(Oe[0]=="c"){_.K=Oe[1],_.ia=Oe[2];const $t=Oe[3];$t!=null&&(_.la=$t,_.j.info("VER="+_.la));const Ut=Oe[4];Ut!=null&&(_.Aa=Ut,_.j.info("SVER="+_.Aa));const Ro=Oe[5];Ro!=null&&typeof Ro=="number"&&0<Ro&&(V=1.5*Ro,_.L=V,_.j.info("backChannelRequestTimeoutMs_="+V)),V=_;const nr=u.g;if(nr){const Vu=nr.g?nr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Vu){var W=V.h;W.g||Vu.indexOf("spdy")==-1&&Vu.indexOf("quic")==-1&&Vu.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(Co(W,W.h),W.h=null))}if(V.D){const Yf=nr.g?nr.g.getResponseHeader("X-HTTP-Session-Id"):null;Yf&&(V.ya=Yf,Je(V.I,V.D,Yf))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-u.F,_.j.info("Handshake RTT: "+_.R+"ms")),V=_;var te=u;if(V.qa=Hv(V,V.J?V.ia:null,V.W),te.K){pl(V.h,te);var He=te,Ot=V.L;Ot&&(He.I=Ot),He.B&&(Ei(He),Er(He)),V.g=te}else jv(V);0<_.i.length&&Nu(_)}else Oe[0]!="stop"&&Oe[0]!="close"||Ss(_,7);else _.G==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?Ss(_,7):Gf(_):Oe[0]!="noop"&&_.l&&_.l.ta(Oe),_.v=0)}}wr(4)}catch{}}var me=class{constructor(u,g){this.g=u,this.map=g}};function Ae(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Pe(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Xe(u){return u.h?1:u.g?u.g.size:0}function $r(u,g){return u.h?u.h==g:u.g?u.g.has(g):!1}function Co(u,g){u.g?u.g.add(g):u.h=g}function pl(u,g){u.h&&u.h==g?u.h=null:u.g&&u.g.has(g)&&u.g.delete(g)}Ae.prototype.cancel=function(){if(this.i=bu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const u of this.g.values())u.cancel();this.g.clear()}};function bu(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let g=u.i;for(const _ of u.g.values())g=g.concat(_.D);return g}return x(u.i)}function qA(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(l(u)){for(var g=[],_=u.length,V=0;V<_;V++)g.push(u[V]);return g}g=[],_=0;for(V in u)g[_++]=u[V];return g}function KA(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(l(u)||typeof u=="string"){var g=[];u=u.length;for(var _=0;_<u;_++)g.push(_);return g}g=[],_=0;for(const V in u)g[_++]=V;return g}}}function xv(u,g){if(u.forEach&&typeof u.forEach=="function")u.forEach(g,void 0);else if(l(u)||typeof u=="string")Array.prototype.forEach.call(u,g,void 0);else for(var _=KA(u),V=qA(u),H=V.length,W=0;W<H;W++)g.call(void 0,V[W],_&&_[W],u)}var Ev=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function GA(u,g){if(u){u=u.split("&");for(var _=0;_<u.length;_++){var V=u[_].indexOf("="),H=null;if(0<=V){var W=u[_].substring(0,V);H=u[_].substring(V+1)}else W=u[_];g(W,H?decodeURIComponent(H.replace(/\+/g," ")):"")}}}function Ts(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Ts){this.h=u.h,Iu(this,u.j),this.o=u.o,this.g=u.g,Tu(this,u.s),this.l=u.l;var g=u.i,_=new yl;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),bv(this,_),this.m=u.m}else u&&(g=String(u).match(Ev))?(this.h=!1,Iu(this,g[1]||"",!0),this.o=ml(g[2]||""),this.g=ml(g[3]||"",!0),Tu(this,g[4]),this.l=ml(g[5]||"",!0),bv(this,g[6]||"",!0),this.m=ml(g[7]||"")):(this.h=!1,this.i=new yl(null,this.h))}Ts.prototype.toString=function(){var u=[],g=this.j;g&&u.push(gl(g,Iv,!0),":");var _=this.g;return(_||g=="file")&&(u.push("//"),(g=this.o)&&u.push(gl(g,Iv,!0),"@"),u.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&u.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&u.push("/"),u.push(gl(_,_.charAt(0)=="/"?YA:QA,!0))),(_=this.i.toString())&&u.push("?",_),(_=this.m)&&u.push("#",gl(_,JA)),u.join("")};function Ur(u){return new Ts(u)}function Iu(u,g,_){u.j=_?ml(g,!0):g,u.j&&(u.j=u.j.replace(/:$/,""))}function Tu(u,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);u.s=g}else u.s=null}function bv(u,g,_){g instanceof yl?(u.i=g,ZA(u.i,u.h)):(_||(g=gl(g,XA)),u.i=new yl(g,u.h))}function Je(u,g,_){u.i.set(g,_)}function Su(u){return Je(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function ml(u,g){return u?g?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function gl(u,g,_){return typeof u=="string"?(u=encodeURI(u).replace(g,WA),_&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function WA(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var Iv=/[#\/\?@]/g,QA=/[#\?:]/g,YA=/[#\?]/g,XA=/[#\?@]/g,JA=/#/g;function yl(u,g){this.h=this.g=null,this.i=u||null,this.j=!!g}function bi(u){u.g||(u.g=new Map,u.h=0,u.i&&GA(u.i,function(g,_){u.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}t=yl.prototype,t.add=function(u,g){bi(this),this.i=null,u=Ao(this,u);var _=this.g.get(u);return _||this.g.set(u,_=[]),_.push(g),this.h+=1,this};function Tv(u,g){bi(u),g=Ao(u,g),u.g.has(g)&&(u.i=null,u.h-=u.g.get(g).length,u.g.delete(g))}function Sv(u,g){return bi(u),g=Ao(u,g),u.g.has(g)}t.forEach=function(u,g){bi(this),this.g.forEach(function(_,V){_.forEach(function(H){u.call(g,H,V,this)},this)},this)},t.na=function(){bi(this);const u=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let V=0;V<g.length;V++){const H=u[V];for(let W=0;W<H.length;W++)_.push(g[V])}return _},t.V=function(u){bi(this);let g=[];if(typeof u=="string")Sv(this,u)&&(g=g.concat(this.g.get(Ao(this,u))));else{u=Array.from(this.g.values());for(let _=0;_<u.length;_++)g=g.concat(u[_])}return g},t.set=function(u,g){return bi(this),this.i=null,u=Ao(this,u),Sv(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[g]),this.h+=1,this},t.get=function(u,g){return u?(u=this.V(u),0<u.length?String(u[0]):g):g};function Cv(u,g,_){Tv(u,g),0<_.length&&(u.i=null,u.g.set(Ao(u,g),x(_)),u.h+=_.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const u=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var V=g[_];const W=encodeURIComponent(String(V)),te=this.V(V);for(V=0;V<te.length;V++){var H=W;te[V]!==""&&(H+="="+encodeURIComponent(String(te[V]))),u.push(H)}}return this.i=u.join("&")};function Ao(u,g){return g=String(g),u.j&&(g=g.toLowerCase()),g}function ZA(u,g){g&&!u.j&&(bi(u),u.i=null,u.g.forEach(function(_,V){var H=V.toLowerCase();V!=H&&(Tv(this,V),Cv(this,H,_))},u)),u.j=g}function ek(u,g){const _=new an;if(a.Image){const V=new Image;V.onload=m(Ii,_,"TestLoadImage: loaded",!0,g,V),V.onerror=m(Ii,_,"TestLoadImage: error",!1,g,V),V.onabort=m(Ii,_,"TestLoadImage: abort",!1,g,V),V.ontimeout=m(Ii,_,"TestLoadImage: timeout",!1,g,V),a.setTimeout(function(){V.ontimeout&&V.ontimeout()},1e4),V.src=u}else g(!1)}function tk(u,g){const _=new an,V=new AbortController,H=setTimeout(()=>{V.abort(),Ii(_,"TestPingServer: timeout",!1,g)},1e4);fetch(u,{signal:V.signal}).then(W=>{clearTimeout(H),W.ok?Ii(_,"TestPingServer: ok",!0,g):Ii(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(H),Ii(_,"TestPingServer: error",!1,g)})}function Ii(u,g,_,V,H){try{H&&(H.onload=null,H.onerror=null,H.onabort=null,H.ontimeout=null),V(_)}catch{}}function nk(){this.g=new Xt}function rk(u,g,_){const V=_||"";try{xv(u,function(H,W){let te=H;c(H)&&(te=Ge(H)),g.push(V+W+"="+encodeURIComponent(te))})}catch(H){throw g.push(V+"type="+encodeURIComponent("_badmap")),H}}function Cu(u){this.l=u.Ub||null,this.j=u.eb||!1}b(Cu,Zn),Cu.prototype.g=function(){return new Au(this.l,this.j)},Cu.prototype.i=function(u){return function(){return u}}({});function Au(u,g){Ne.call(this),this.D=u,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(Au,Ne),t=Au.prototype,t.open=function(u,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=g,this.readyState=1,_l(this)},t.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(g.body=u),(this.D||a).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,vl(this)),this.readyState=0},t.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,_l(this)),this.g&&(this.readyState=3,_l(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Av(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function Av(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}t.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var g=u.value?u.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!u.done}))&&(this.response=this.responseText+=g)}u.done?vl(this):_l(this),this.readyState==3&&Av(this)}},t.Ra=function(u){this.g&&(this.response=this.responseText=u,vl(this))},t.Qa=function(u){this.g&&(this.response=u,vl(this))},t.ga=function(){this.g&&vl(this)};function vl(u){u.readyState=4,u.l=null,u.j=null,u.v=null,_l(u)}t.setRequestHeader=function(u,g){this.u.append(u,g)},t.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const u=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,u.push(_[0]+": "+_[1]),_=g.next();return u.join(`\r
`)};function _l(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(Au.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function kv(u){let g="";return L(u,function(_,V){g+=V,g+=":",g+=_,g+=`\r
`}),g}function Kf(u,g,_){e:{for(V in _){var V=!1;break e}V=!0}V||(_=kv(_),typeof u=="string"?_!=null&&encodeURIComponent(String(_)):Je(u,g,_))}function ct(u){Ne.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(ct,Ne);var ik=/^https?$/i,sk=["POST","PUT"];t=ct.prototype,t.Ha=function(u){this.J=u},t.ea=function(u,g,_,V){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);g=g?g.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():ws.g(),this.v=this.o?yi(this.o):yi(ws),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(g,String(u),!0),this.B=!1}catch(W){Rv(this,W);return}if(u=_||"",_=new Map(this.headers),V)if(Object.getPrototypeOf(V)===Object.prototype)for(var H in V)_.set(H,V[H]);else if(typeof V.keys=="function"&&typeof V.get=="function")for(const W of V.keys())_.set(W,V.get(W));else throw Error("Unknown input type for opt_headers: "+String(V));V=Array.from(_.keys()).find(W=>W.toLowerCase()=="content-type"),H=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(sk,g,void 0))||V||H||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,te]of _)this.g.setRequestHeader(W,te);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Dv(this),this.u=!0,this.g.send(u),this.u=!1}catch(W){Rv(this,W)}};function Rv(u,g){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=g,u.m=5,Nv(u),ku(u)}function Nv(u){u.A||(u.A=!0,ze(u,"complete"),ze(u,"error"))}t.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,ze(this,"complete"),ze(this,"abort"),ku(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ku(this,!0)),ct.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Pv(this):this.bb())},t.bb=function(){Pv(this)};function Pv(u){if(u.h&&typeof o<"u"&&(!u.v[1]||Br(u)!=4||u.Z()!=2)){if(u.u&&Br(u)==4)Yt(u.Ea,0,u);else if(ze(u,"readystatechange"),Br(u)==4){u.h=!1;try{const te=u.Z();e:switch(te){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var V;if(V=te===0){var H=String(u.D).match(Ev)[1]||null;!H&&a.self&&a.self.location&&(H=a.self.location.protocol.slice(0,-1)),V=!ik.test(H?H.toLowerCase():"")}_=V}if(_)ze(u,"complete"),ze(u,"success");else{u.m=6;try{var W=2<Br(u)?u.g.statusText:""}catch{W=""}u.l=W+" ["+u.Z()+"]",Nv(u)}}finally{ku(u)}}}}function ku(u,g){if(u.g){Dv(u);const _=u.g,V=u.v[0]?()=>{}:null;u.g=null,u.v=null,g||ze(u,"ready");try{_.onreadystatechange=V}catch{}}}function Dv(u){u.I&&(a.clearTimeout(u.I),u.I=null)}t.isActive=function(){return!!this.g};function Br(u){return u.g?u.g.readyState:0}t.Z=function(){try{return 2<Br(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(u){if(this.g){var g=this.g.responseText;return u&&g.indexOf(u)==0&&(g=g.substring(u.length)),on(g)}};function Vv(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function ok(u){const g={};u=(u.g&&2<=Br(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let V=0;V<u.length;V++){if(v(u[V]))continue;var _=C(u[V]);const H=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const W=g[H]||[];g[H]=W,W.push(_)}S(g,function(V){return V.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function wl(u,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[u]||g}function Ov(u){this.Aa=0,this.i=[],this.j=new an,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=wl("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=wl("baseRetryDelayMs",5e3,u),this.cb=wl("retryDelaySeedMs",1e4,u),this.Wa=wl("forwardChannelMaxRetries",2,u),this.wa=wl("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new Ae(u&&u.concurrentRequestLimit),this.Da=new nk,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ov.prototype,t.la=8,t.G=1,t.connect=function(u,g,_,V){xt(0),this.W=u,this.H=g||{},_&&V!==void 0&&(this.H.OSID=_,this.H.OAID=V),this.F=this.X,this.I=Hv(this,null,this.W),Nu(this)};function Gf(u){if(zv(u),u.G==3){var g=u.U++,_=Ur(u.I);if(Je(_,"SID",u.K),Je(_,"RID",g),Je(_,"TYPE","terminate"),xl(u,_),g=new $n(u,u.j,g),g.L=2,g.v=Su(Ur(_)),_=!1,a.navigator&&a.navigator.sendBeacon)try{_=a.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&a.Image&&(new Image().src=g.v,_=!0),_||(g.g=qv(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Er(g)}Bv(u)}function Ru(u){u.g&&(Qf(u),u.g.cancel(),u.g=null)}function zv(u){Ru(u),u.u&&(a.clearTimeout(u.u),u.u=null),Pu(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function Nu(u){if(!Pe(u.h)&&!u.s){u.s=!0;var g=u.Ga;U||B(),F||(U(),F=!0),M.add(g,u),u.B=0}}function ak(u,g){return Xe(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=g.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=jr(f(u.Ga,u,g),Uv(u,u.B)),u.B++,!0)}t.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;const H=new $n(this,this.j,u);let W=this.o;if(this.S&&(W?(W=I(W),E(W,this.S)):W=this.S),this.m!==null||this.O||(H.H=W,W=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var V=this.i[_];if("__data__"in V.map&&(V=V.map.__data__,typeof V=="string")){V=V.length;break t}V=void 0}if(V===void 0)break;if(g+=V,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=Mv(this,H,g),_=Ur(this.I),Je(_,"RID",u),Je(_,"CVER",22),this.D&&Je(_,"X-HTTP-Session-Id",this.D),xl(this,_),W&&(this.O?g="headers="+encodeURIComponent(String(kv(W)))+"&"+g:this.m&&Kf(_,this.m,W)),Co(this.h,H),this.Ua&&Je(_,"TYPE","init"),this.P?(Je(_,"$req",g),Je(_,"SID","null"),H.T=!0,Fr(H,_,null)):Fr(H,_,g),this.G=2}}else this.G==3&&(u?Lv(this,u):this.i.length==0||Pe(this.h)||Lv(this))};function Lv(u,g){var _;g?_=g.l:_=u.U++;const V=Ur(u.I);Je(V,"SID",u.K),Je(V,"RID",_),Je(V,"AID",u.T),xl(u,V),u.m&&u.o&&Kf(V,u.m,u.o),_=new $n(u,u.j,_,u.B+1),u.m===null&&(_.H=u.o),g&&(u.i=g.D.concat(u.i)),g=Mv(u,_,1e3),_.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Co(u.h,_),Fr(_,V,g)}function xl(u,g){u.H&&L(u.H,function(_,V){Je(g,V,_)}),u.l&&xv({},function(_,V){Je(g,V,_)})}function Mv(u,g,_){_=Math.min(u.i.length,_);var V=u.l?f(u.l.Na,u.l,u):null;e:{var H=u.i;let W=-1;for(;;){const te=["count="+_];W==-1?0<_?(W=H[0].g,te.push("ofs="+W)):W=0:te.push("ofs="+W);let He=!0;for(let Ot=0;Ot<_;Ot++){let Oe=H[Ot].g;const $t=H[Ot].map;if(Oe-=W,0>Oe)W=Math.max(0,H[Ot].g-100),He=!1;else try{rk($t,te,"req"+Oe+"_")}catch{V&&V($t)}}if(He){V=te.join("&");break e}}}return u=u.i.splice(0,_),g.D=u,V}function jv(u){if(!u.g&&!u.u){u.Y=1;var g=u.Fa;U||B(),F||(U(),F=!0),M.add(g,u),u.v=0}}function Wf(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=jr(f(u.Fa,u),Uv(u,u.v)),u.v++,!0)}t.Fa=function(){if(this.u=null,Fv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=jr(f(this.ab,this),u)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xt(10),Ru(this),Fv(this))};function Qf(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Fv(u){u.g=new $n(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var g=Ur(u.qa);Je(g,"RID","rpc"),Je(g,"SID",u.K),Je(g,"AID",u.T),Je(g,"CI",u.F?"0":"1"),!u.F&&u.ja&&Je(g,"TO",u.ja),Je(g,"TYPE","xmlhttp"),xl(u,g),u.m&&u.o&&Kf(g,u.m,u.o),u.L&&(u.g.I=u.L);var _=u.g;u=u.ia,_.L=1,_.v=Su(Ur(g)),_.m=null,_.P=!0,bs(_,u)}t.Za=function(){this.C!=null&&(this.C=null,Ru(this),Wf(this),xt(19))};function Pu(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function $v(u,g){var _=null;if(u.g==g){Pu(u),Qf(u),u.g=null;var V=2}else if($r(u.h,g))_=g.D,pl(u.h,g),V=1;else return;if(u.G!=0){if(g.o)if(V==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var H=u.B;V=_i(),ze(V,new Io(V,_)),Nu(u)}else jv(u);else if(H=g.s,H==3||H==0&&0<g.X||!(V==1&&ak(u,g)||V==2&&Wf(u)))switch(_&&0<_.length&&(g=u.h,g.i=g.i.concat(_)),H){case 1:Ss(u,5);break;case 4:Ss(u,10);break;case 3:Ss(u,6);break;default:Ss(u,2)}}}function Uv(u,g){let _=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(_*=2),_*g}function Ss(u,g){if(u.j.info("Error code "+g),g==2){var _=f(u.fb,u),V=u.Xa;const H=!V;V=new Ts(V||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Iu(V,"https"),Su(V),H?ek(V.toString(),_):tk(V.toString(),_)}else xt(2);u.G=0,u.l&&u.l.sa(g),Bv(u),zv(u)}t.fb=function(u){u?(this.j.info("Successfully pinged google.com"),xt(2)):(this.j.info("Failed to ping google.com"),xt(1))};function Bv(u){if(u.G=0,u.ka=[],u.l){const g=bu(u.h);(g.length!=0||u.i.length!=0)&&(R(u.ka,g),R(u.ka,u.i),u.h.i.length=0,x(u.i),u.i.length=0),u.l.ra()}}function Hv(u,g,_){var V=_ instanceof Ts?Ur(_):new Ts(_);if(V.g!="")g&&(V.g=g+"."+V.g),Tu(V,V.s);else{var H=a.location;V=H.protocol,g=g?g+"."+H.hostname:H.hostname,H=+H.port;var W=new Ts(null);V&&Iu(W,V),g&&(W.g=g),H&&Tu(W,H),_&&(W.l=_),V=W}return _=u.D,g=u.ya,_&&g&&Je(V,_,g),Je(V,"VER",u.la),xl(u,V),V}function qv(u,g,_){if(g&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=u.Ca&&!u.pa?new ct(new Cu({eb:_})):new ct(u.pa),g.Ha(u.J),g}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Kv(){}t=Kv.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Du(){}Du.prototype.g=function(u,g){return new In(u,g)};function In(u,g){Ne.call(this),this.g=new Ov(g),this.l=u,this.h=g&&g.messageUrlParams||null,u=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(u?u["X-WebChannel-Content-Type"]=g.messageContentType:u={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(u?u["X-WebChannel-Client-Profile"]=g.va:u={"X-WebChannel-Client-Profile":g.va}),this.g.S=u,(u=g&&g.Sb)&&!v(u)&&(this.g.m=u),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!v(g)&&(this.g.D=g,u=this.h,u!==null&&g in u&&(u=this.h,g in u&&delete u[g])),this.j=new ko(this)}b(In,Ne),In.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},In.prototype.close=function(){Gf(this.g)},In.prototype.o=function(u){var g=this.g;if(typeof u=="string"){var _={};_.__data__=u,u=_}else this.u&&(_={},_.__data__=Ge(u),u=_);g.i.push(new me(g.Ya++,u)),g.G==3&&Nu(g)},In.prototype.N=function(){this.g.l=null,delete this.j,Gf(this.g),delete this.g,In.aa.N.call(this)};function Gv(u){vi.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var g=u.__sm__;if(g){e:{for(const _ in g){u=_;break e}u=void 0}(this.i=u)&&(u=this.i,g=g!==null&&u in g?g[u]:void 0),this.data=g}else this.data=u}b(Gv,vi);function Wv(){bn.call(this),this.status=1}b(Wv,bn);function ko(u){this.g=u}b(ko,Kv),ko.prototype.ua=function(){ze(this.g,"a")},ko.prototype.ta=function(u){ze(this.g,new Gv(u))},ko.prototype.sa=function(u){ze(this.g,new Wv)},ko.prototype.ra=function(){ze(this.g,"b")},Du.prototype.createWebChannel=Du.prototype.g,In.prototype.send=In.prototype.o,In.prototype.open=In.prototype.m,In.prototype.close=In.prototype.close,v2=function(){return new Du},y2=function(){return _i()},g2=tr,xg={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},wi.NO_ERROR=0,wi.TIMEOUT=8,wi.HTTP_ERROR=6,Md=wi,_s.COMPLETE="complete",m2=_s,_r.EventType=er,er.OPEN="a",er.CLOSE="b",er.ERROR="c",er.MESSAGE="d",Ne.prototype.listen=Ne.prototype.K,Ql=_r,ct.prototype.listenOnce=ct.prototype.L,ct.prototype.getLastError=ct.prototype.Ka,ct.prototype.getLastErrorCode=ct.prototype.Ba,ct.prototype.getStatus=ct.prototype.Z,ct.prototype.getResponseJson=ct.prototype.Oa,ct.prototype.getResponseText=ct.prototype.oa,ct.prototype.send=ct.prototype.ea,ct.prototype.setWithCredentials=ct.prototype.Ha,p2=ct}).apply(typeof dd<"u"?dd:typeof self<"u"?self:typeof window<"u"?window:{});const Mx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Kt.UNAUTHENTICATED=new Kt(null),Kt.GOOGLE_CREDENTIALS=new Kt("google-credentials-uid"),Kt.FIRST_PARTY=new Kt("first-party-uid"),Kt.MOCK_USER=new Kt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=new If("@firebase/firestore");function Bo(){return so.logLevel}function J(t,...e){if(so.logLevel<=Te.DEBUG){const n=e.map(Ty);so.debug(`Firestore (${rl}): ${t}`,...n)}}function pt(t,...e){if(so.logLevel<=Te.ERROR){const n=e.map(Ty);so.error(`Firestore (${rl}): ${t}`,...n)}}function Kc(t,...e){if(so.logLevel<=Te.WARN){const n=e.map(Ty);so.warn(`Firestore (${rl}): ${t}`,...n)}}function Ty(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ue(t="Unexpected state"){const e=`FIRESTORE (${rl}) INTERNAL ASSERTION FAILED: `+t;throw pt(e),new Error(e)}function he(t,e){t||ue()}function de(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ne extends yr{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E9{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class b9{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Kt.UNAUTHENTICATED))}shutdown(){}}class I9{constructor(e){this.t=e,this.currentUser=Kt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){he(this.o===void 0);let r=this.i;const i=l=>this.i!==r?(r=this.i,n(l)):Promise.resolve();let s=new Dr;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Dr,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const l=s;e.enqueueRetryable(async()=>{await l.promise,await i(this.currentUser)})},a=l=>{J("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=l,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(l=>a(l)),setTimeout(()=>{if(!this.auth){const l=this.t.getImmediate({optional:!0});l?a(l):(J("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Dr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(J("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(he(typeof r.accessToken=="string"),new E9(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return he(e===null||typeof e=="string"),new Kt(e)}}class T9{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Kt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class S9{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new T9(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Kt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class C9{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class A9{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){he(this.o===void 0);const r=s=>{s.error!=null&&J("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,J("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{J("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):J("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(he(typeof n.token=="string"),this.R=n.token,new C9(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k9(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _2{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const i=k9(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<n&&(r+=e.charAt(i[s]%e.length))}return r}}function ye(t,e){return t<e?-1:t>e?1:0}function Va(t,e,n){return t.length===e.length&&t.every((r,i)=>n(r,e[i]))}function w2(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ne(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ne(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ne(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ne(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return at.fromMillis(Date.now())}static fromDate(e){return at.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new at(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ye(this.nanoseconds,e.nanoseconds):ye(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new pe(e)}static min(){return new pe(new at(0,0))}static max(){return new pe(new at(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e,n,r){n===void 0?n=0:n>e.length&&ue(),r===void 0?r=e.length-n:r>e.length-n&&ue(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Gc.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Gc?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let i=0;i<r;i++){const s=e.get(i),o=n.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class je extends Gc{construct(e,n,r){return new je(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ne(Q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(i=>i.length>0))}return new je(n)}static emptyPath(){return new je([])}}const R9=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class st extends Gc{construct(e,n,r){return new st(e,n,r)}static isValidIdentifier(e){return R9.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),st.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new st(["__name__"])}static fromServerFormat(e){const n=[];let r="",i=0;const s=()=>{if(r.length===0)throw new ne(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if(a==="\\"){if(i+1===e.length)throw new ne(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if(l!=="\\"&&l!=="."&&l!=="`")throw new ne(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else a==="`"?(o=!o,i++):a!=="."||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ne(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new st(n)}static emptyPath(){return new st([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class se{constructor(e){this.path=e}static fromPath(e){return new se(je.fromString(e))}static fromName(e){return new se(je.fromString(e).popFirst(5))}static empty(){return new se(je.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&je.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return je.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new se(new je(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oh{constructor(e,n,r,i){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=i}}function Eg(t){return t.fields.find(e=>e.kind===2)}function Ps(t){return t.fields.filter(e=>e.kind!==2)}Oh.UNKNOWN_ID=-1;class jd{constructor(e,n){this.fieldPath=e,this.kind=n}}class Wc{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Wc(0,zn.min())}}function x2(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,i=pe.fromTimestamp(r===1e9?new at(n+1,0):new at(n,r));return new zn(i,se.empty(),e)}function E2(t){return new zn(t.readTime,t.key,-1)}class zn{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new zn(pe.min(),se.empty(),-1)}static max(){return new zn(pe.max(),se.empty(),-1)}}function Sy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=se.comparator(t.documentKey,e.documentKey),n!==0?n:ye(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const b2="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class I2{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ps(t){if(t.code!==Q.FAILED_PRECONDITION||t.message!==b2)throw t;J("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&ue(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new q((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(n,s).next(r,i)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof q?n:q.resolve(n)}catch(n){return q.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):q.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):q.reject(n)}static resolve(e){return new q((n,r)=>{n(e)})}static reject(e){return new q((n,r)=>{r(e)})}static waitFor(e){return new q((n,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&n()},l=>r(l))}),o=!0,s===i&&n()})}static or(e){let n=q.resolve(!1);for(const r of e)n=n.next(i=>i?q.resolve(i):r());return n}static forEach(e,n){const r=[];return e.forEach((i,s)=>{r.push(n.call(this,i,s))}),this.waitFor(r)}static mapArray(e,n){return new q((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=l;n(e[c]).next(d=>{o[c]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,n){return new q((r,i)=>{const s=()=>{e()===!0?n().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new Dr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new uc(e,n.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=Cy(r.target.error);this.V.reject(new uc(e,i))}}static open(e,n,r,i){try{return new Af(n,e.transaction(i,r))}catch(s){throw new uc(n,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(J("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new P9(n)}}class ns{constructor(e,n,r){this.name=e,this.version=n,this.p=r,ns.S(It())===12.2&&pt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return J("SimpleDb","Removing database:",e),Ds(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!hy())return!1;if(ns.v())return!0;const e=It(),n=ns.S(e),r=0<n&&n<10,i=T2(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}async M(e){return this.db||(J("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;n(o)},i.onblocked=()=>{r(new uc(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new ne(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ne(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new uc(e,o))},i.onupgradeneeded=s=>{J("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;this.p.O(o,i.transaction,s.oldVersion,this.version).next(()=>{J("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,i){const s=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const a=Af.open(this.db,e,s?"readonly":"readwrite",r),l=i(a).next(c=>(a.g(),c)).catch(c=>(a.abort(c),q.reject(c))).toPromise();return l.catch(()=>{}),await a.m,l}catch(a){const l=a,c=l.name!=="FirebaseError"&&o<3;if(J("SimpleDb","Transaction failed with error:",l.message,"Retrying:",c),this.close(),!c)return Promise.reject(l)}}}close(){this.db&&this.db.close(),this.db=void 0}}function T2(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class N9{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ds(this.B.delete())}}class uc extends ne{constructor(e,n){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function ms(t){return t.name==="IndexedDbTransactionError"}class P9{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(J("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(J("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ds(r)}add(e){return J("SimpleDb","ADD",this.store.name,e,e),Ds(this.store.add(e))}get(e){return Ds(this.store.get(e)).next(n=>(n===void 0&&(n=null),J("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return J("SimpleDb","DELETE",this.store.name,e),Ds(this.store.delete(e))}count(){return J("SimpleDb","COUNT",this.store.name),Ds(this.store.count())}U(e,n){const r=this.options(e,n),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new q((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new q((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,n){J("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,n);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,n){let r;n?r=e:(r={},n=e);const i=this.cursor(r);return this.W(i,n)}Y(e){const n=this.cursor({});return new q((r,i)=>{n.onerror=s=>{const o=Cy(s.target.error);i(o)},n.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,n){const r=[];return new q((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new N9(a),c=n(a.primaryKey,a.value,l);if(c instanceof q){const d=c.catch(h=>(l.done(),q.reject(h)));r.push(d)}l.isDone?i():l.K===null?a.continue():a.continue(l.K)}}).next(()=>q.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function Ds(t){return new q((e,n)=>{t.onsuccess=r=>{const i=r.target.result;e(i)},t.onerror=r=>{const i=Cy(r.target.error);n(i)}})}let jx=!1;function Cy(t){const e=ns.S(It());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ne("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return jx||(jx=!0,setTimeout(()=>{throw r},0)),r}}return t}class D9{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){J("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{J("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){ms(n)?J("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await ps(n)}await this.X(6e4)})}}class V9{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const r=new Set;let i=n,s=!0;return q.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return J("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>n-i)}ne(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(i=>this.localStore.localDocuments.getNextDocuments(e,n,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(J("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,n,a))).next(()=>o.size)}))}re(e,n){let r=e;return n.changes.forEach((i,s)=>{const o=E2(s);Sy(o,r)>0&&(r=o)}),new zn(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}fn.oe=-1;function kf(t){return t==null}function Qc(t){return t===0&&1/t==-1/0}function S2(t){return typeof t=="number"&&Number.isInteger(t)&&!Qc(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function en(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=Fx(e)),e=O9(t.get(n),e);return Fx(e)}function O9(t,e){let n=e;const r=t.length;for(let i=0;i<r;i++){const s=t.charAt(i);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function Fx(t){return t+""}function Cr(t){const e=t.length;if(he(e>=2),e===2)return he(t.charAt(0)===""&&t.charAt(1)===""),je.emptyPath();const n=e-2,r=[];let i="";for(let s=0;s<e;){const o=t.indexOf("",s);switch((o<0||o>n)&&ue(),t.charAt(o+1)){case"":const a=t.substring(s,o);let l;i.length===0?l=a:(i+=a,l=i,i=""),r.push(l);break;case"":i+=t.substring(s,o),i+="\0";break;case"":i+=t.substring(s,o+1);break;default:ue()}s=o+2}return new je(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $x=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fd(t,e){return[t,en(e)]}function C2(t,e,n){return[t,en(e),n]}const z9={},L9=["prefixPath","collectionGroup","readTime","documentId"],M9=["prefixPath","collectionGroup","documentId"],j9=["collectionGroup","readTime","prefixPath","documentId"],F9=["canonicalId","targetId"],$9=["targetId","path"],U9=["path","targetId"],B9=["collectionId","parent"],H9=["indexId","uid"],q9=["uid","sequenceNumber"],K9=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],G9=["indexId","uid","orderedDocumentKey"],W9=["userId","collectionPath","documentId"],Q9=["userId","collectionPath","largestBatchId"],Y9=["userId","collectionGroup","largestBatchId"],A2=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],X9=[...A2,"documentOverlays"],k2=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],R2=k2,Ay=[...R2,"indexConfiguration","indexState","indexEntries"],J9=Ay,Z9=[...Ay,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bg extends I2{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function Tt(t,e){const n=de(t);return ns.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function il(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function N2(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qe{constructor(e,n){this.comparator=e,this.root=n||Mt.EMPTY}insert(e,n){return new Qe(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Mt.BLACK,null,null))}remove(e){return new Qe(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return n+r.left.size;i<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new hd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new hd(this.root,e,this.comparator,!1)}getReverseIterator(){return new hd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new hd(this.root,e,this.comparator,!0)}}class hd{constructor(e,n,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=n?r(e.key,n):1,n&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Mt{constructor(e,n,r,i,s){this.key=e,this.value=n,this.color=r??Mt.RED,this.left=i??Mt.EMPTY,this.right=s??Mt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,i,s){return new Mt(e??this.key,n??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,n,r),null):s===0?i.copy(null,n,null,null,null):i.copy(null,null,null,null,i.right.insert(e,n,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Mt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),n(e,i.key)===0){if(i.right.isEmpty())return Mt.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Mt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Mt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw ue();const e=this.left.check();if(e!==this.right.check())throw ue();return e+(this.isRed()?0:1)}}Mt.EMPTY=null,Mt.RED=!0,Mt.BLACK=!1;Mt.EMPTY=new class{constructor(){this.size=0}get key(){throw ue()}get value(){throw ue()}get color(){throw ue()}get left(){throw ue()}get right(){throw ue()}copy(e,n,r,i,s){return this}insert(e,n,r){return new Mt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ue{constructor(e){this.comparator=e,this.data=new Qe(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;n(i.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Bx(this.data.getIterator())}getIteratorFrom(e){return new Bx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Ue)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Ue(this.comparator);return n.data=e,n}}class Bx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function jo(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gn{constructor(e){this.fields=e,e.sort(st.comparator)}static empty(){return new Gn([])}unionWith(e){let n=new Ue(st.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Gn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Va(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P2 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new P2("Invalid base64 string: "+s):s}}(e);return new mt(n)}static fromUint8Array(e){const n=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new mt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ye(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}mt.EMPTY_BYTE_STRING=new mt("");const eF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function fi(t){if(he(!!t),typeof t=="string"){let e=0;const n=eF.exec(t);if(he(!!n),n[1]){let i=n[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(t.seconds),nanos:nt(t.nanos)}}function nt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function as(t){return typeof t=="string"?mt.fromBase64String(t):mt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ky(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Ry(t){const e=t.mapValue.fields.__previous_value__;return ky(e)?Ry(e):e}function Yc(t){const e=fi(t.mapValue.fields.__local_write_time__.timestampValue);return new at(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tF{constructor(e,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=c}}class oo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new oo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof oo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},$d={nullValue:"NULL_VALUE"};function ao(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?ky(t)?4:D2(t)?9007199254740991:Rf(t)?10:11:ue()}function Or(t,e){if(t===e)return!0;const n=ao(t);if(n!==ao(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Yc(t).isEqual(Yc(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=fi(i.timestampValue),a=fi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(i,s){return as(i.bytesValue).isEqual(as(s.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(i,s){return nt(i.geoPointValue.latitude)===nt(s.geoPointValue.latitude)&&nt(i.geoPointValue.longitude)===nt(s.geoPointValue.longitude)}(t,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return nt(i.integerValue)===nt(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=nt(i.doubleValue),a=nt(s.doubleValue);return o===a?Qc(o)===Qc(a):isNaN(o)&&isNaN(a)}return!1}(t,e);case 9:return Va(t.arrayValue.values||[],e.arrayValue.values||[],Or);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Ux(o)!==Ux(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(a[l]===void 0||!Or(o[l],a[l])))return!1;return!0}(t,e);default:return ue()}}function Xc(t,e){return(t.values||[]).find(n=>Or(n,e))!==void 0}function ls(t,e){if(t===e)return 0;const n=ao(t),r=ao(e);if(n!==r)return ye(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ye(t.booleanValue,e.booleanValue);case 2:return function(s,o){const a=nt(s.integerValue||s.doubleValue),l=nt(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(t,e);case 3:return Hx(t.timestampValue,e.timestampValue);case 4:return Hx(Yc(t),Yc(e));case 5:return ye(t.stringValue,e.stringValue);case 6:return function(s,o){const a=as(s),l=as(o);return a.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let c=0;c<a.length&&c<l.length;c++){const d=ye(a[c],l[c]);if(d!==0)return d}return ye(a.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(s,o){const a=ye(nt(s.latitude),nt(o.latitude));return a!==0?a:ye(nt(s.longitude),nt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return qx(t.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,c,d;const h=s.fields||{},f=o.fields||{},m=(a=h.value)===null||a===void 0?void 0:a.arrayValue,b=(l=f.value)===null||l===void 0?void 0:l.arrayValue,x=ye(((c=m==null?void 0:m.values)===null||c===void 0?void 0:c.length)||0,((d=b==null?void 0:b.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:qx(m,b)}(t.mapValue,e.mapValue);case 11:return function(s,o){if(s===Bi.mapValue&&o===Bi.mapValue)return 0;if(s===Bi.mapValue)return 1;if(o===Bi.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),c=o.fields||{},d=Object.keys(c);l.sort(),d.sort();for(let h=0;h<l.length&&h<d.length;++h){const f=ye(l[h],d[h]);if(f!==0)return f;const m=ls(a[l[h]],c[d[h]]);if(m!==0)return m}return ye(l.length,d.length)}(t.mapValue,e.mapValue);default:throw ue()}}function Hx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ye(t,e);const n=fi(t),r=fi(e),i=ye(n.seconds,r.seconds);return i!==0?i:ye(n.nanos,r.nanos)}function qx(t,e){const n=t.values||[],r=e.values||[];for(let i=0;i<n.length&&i<r.length;++i){const s=ls(n[i],r[i]);if(s)return s}return ye(n.length,r.length)}function Oa(t){return Ig(t)}function Ig(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=fi(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return as(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return se.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",i=!0;for(const s of n.values||[])i?i=!1:r+=",",r+=Ig(s);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Ig(n.fields[o])}`;return i+"}"}(t.mapValue):ue()}function Jc(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Tg(t){return!!t&&"integerValue"in t}function Zc(t){return!!t&&"arrayValue"in t}function Kx(t){return!!t&&"nullValue"in t}function Gx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Ud(t){return!!t&&"mapValue"in t}function Rf(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function dc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return il(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=dc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=dc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function D2(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const V2={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function nF(t){return"nullValue"in t?$d:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?Jc(oo.empty(),se.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Rf(t)?V2:{mapValue:{}}:ue()}function rF(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?Jc(oo.empty(),se.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?V2:"mapValue"in t?Rf(t)?{mapValue:{}}:Bi:ue()}function Wx(t,e){const n=ls(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function Qx(t,e){const n=ls(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{constructor(e){this.value=e}static empty(){return new un({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Ud(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=dc(n)}setAll(e){let n=st.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!n.isImmediateParentOf(a)){const l=this.getFieldsMap(n);this.applyChanges(l,r,i),r={},i=[],n=a.popLast()}o?r[a.lastSegment()]=dc(o):i.push(a.lastSegment())});const s=this.getFieldsMap(n);this.applyChanges(s,r,i)}delete(e){const n=this.field(e.popLast());Ud(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Or(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=n.mapValue.fields[e.get(r)];Ud(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=i),n=i}return n.mapValue.fields}applyChanges(e,n,r){il(n,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new un(dc(this.value))}}function O2(t){const e=[];return il(t.fields,(n,r)=>{const i=new st([n]);if(Ud(r)){const s=O2(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Gn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n,r,i,s,o,a){this.key=e,this.documentType=n,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new dt(e,0,pe.min(),pe.min(),pe.min(),un.empty(),0)}static newFoundDocument(e,n,r,i){return new dt(e,1,n,pe.min(),r,i,0)}static newNoDocument(e,n){return new dt(e,2,n,pe.min(),pe.min(),un.empty(),0)}static newUnknownDocument(e,n){return new dt(e,3,n,pe.min(),pe.min(),un.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(pe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=un.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=un.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=pe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof dt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new dt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e,n){this.position=e,this.inclusive=n}}function Yx(t,e,n){let r=0;for(let i=0;i<t.position.length;i++){const s=e[i],o=t.position[i];if(s.field.isKeyField()?r=se.comparator(se.fromName(o.referenceValue),n.key):r=ls(o,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function Xx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Or(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,n="asc"){this.field=e,this.dir=n}}function iF(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z2{}class Se extends z2{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new sF(e,n,r):n==="array-contains"?new lF(e,r):n==="in"?new U2(e,r):n==="not-in"?new cF(e,r):n==="array-contains-any"?new uF(e,r):new Se(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new oF(e,r):new aF(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(ls(n,this.value)):n!==null&&ao(this.value)===ao(n)&&this.matchesComparison(ls(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return ue()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fe extends z2{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Fe(e,n)}matches(e){return La(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function La(t){return t.op==="and"}function Sg(t){return t.op==="or"}function Ny(t){return L2(t)&&La(t)}function L2(t){for(const e of t.filters)if(e instanceof Fe)return!1;return!0}function Cg(t){if(t instanceof Se)return t.field.canonicalString()+t.op.toString()+Oa(t.value);if(Ny(t))return t.filters.map(e=>Cg(e)).join(",");{const e=t.filters.map(n=>Cg(n)).join(",");return`${t.op}(${e})`}}function M2(t,e){return t instanceof Se?function(r,i){return i instanceof Se&&r.op===i.op&&r.field.isEqual(i.field)&&Or(r.value,i.value)}(t,e):t instanceof Fe?function(r,i){return i instanceof Fe&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,a)=>s&&M2(o,i.filters[a]),!0):!1}(t,e):void ue()}function j2(t,e){const n=t.filters.concat(e);return Fe.create(n,t.op)}function F2(t){return t instanceof Se?function(n){return`${n.field.canonicalString()} ${n.op} ${Oa(n.value)}`}(t):t instanceof Fe?function(n){return n.op.toString()+" {"+n.getFilters().map(F2).join(" ,")+"}"}(t):"Filter"}class sF extends Se{constructor(e,n,r){super(e,n,r),this.key=se.fromName(r.referenceValue)}matches(e){const n=se.comparator(e.key,this.key);return this.matchesComparison(n)}}class oF extends Se{constructor(e,n){super(e,"in",n),this.keys=$2("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class aF extends Se{constructor(e,n){super(e,"not-in",n),this.keys=$2("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function $2(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>se.fromName(r.referenceValue))}class lF extends Se{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Zc(n)&&Xc(n.arrayValue,this.value)}}class U2 extends Se{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Xc(this.value.arrayValue,n)}}class cF extends Se{constructor(e,n){super(e,"not-in",n)}matches(e){if(Xc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Xc(this.value.arrayValue,n)}}class uF extends Se{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Zc(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Xc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dF{constructor(e,n=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function Ag(t,e=null,n=[],r=[],i=null,s=null,o=null){return new dF(t,e,n,r,i,s,o)}function lo(t){const e=de(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Cg(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),kf(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>Oa(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>Oa(r)).join(",")),e.ue=n}return e.ue}function gu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!iF(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!M2(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Xx(t.startAt,e.startAt)&&Xx(t.endAt,e.endAt)}function Lh(t){return se.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Mh(t,e){return t.filters.filter(n=>n instanceof Se&&n.field.isEqual(e))}function Jx(t,e,n){let r=$d,i=!0;for(const s of Mh(t,e)){let o=$d,a=!0;switch(s.op){case"<":case"<=":o=nF(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=$d}Wx({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Wx({value:r,inclusive:i},{value:o,inclusive:n.inclusive})<0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}function Zx(t,e,n){let r=Bi,i=!0;for(const s of Mh(t,e)){let o=Bi,a=!0;switch(s.op){case">=":case">":o=rF(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Bi}Qx({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(n!==null){for(let s=0;s<t.orderBy.length;++s)if(t.orderBy[s].field.isEqual(e)){const o=n.position[s];Qx({value:r,inclusive:i},{value:o,inclusive:n.inclusive})>0&&(r=o,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,n=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function B2(t,e,n,r,i,s,o,a){return new yu(t,e,n,r,i,s,o,a)}function Nf(t){return new yu(t)}function e1(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function H2(t){return t.collectionGroup!==null}function hc(t){const e=de(t);if(e.ce===null){e.ce=[];const n=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),n.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new Ue(st.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(c=>{c.isInequality()&&(a=a.add(c.field))})}),a})(e).forEach(s=>{n.has(s.canonicalString())||s.isKeyField()||e.ce.push(new zh(s,r))}),n.has(st.keyField().canonicalString())||e.ce.push(new zh(st.keyField(),r))}return e.ce}function Pn(t){const e=de(t);return e.le||(e.le=hF(e,hc(t))),e.le}function hF(t,e){if(t.limitType==="F")return Ag(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new zh(i.field,s)});const n=t.endAt?new za(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new za(t.startAt.position,t.startAt.inclusive):null;return Ag(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function kg(t,e){const n=t.filters.concat([e]);return new yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Rg(t,e,n){return new yu(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Pf(t,e){return gu(Pn(t),Pn(e))&&t.limitType===e.limitType}function q2(t){return`${lo(Pn(t))}|lt:${t.limitType}`}function Ho(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(i=>F2(i)).join(", ")}]`),kf(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(i=>Oa(i)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(i=>Oa(i)).join(",")),`Target(${r})`}(Pn(t))}; limitType=${t.limitType})`}function vu(t,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):se.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(t,e)&&function(r,i){for(const s of hc(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(t,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(t,e)&&function(r,i){return!(r.startAt&&!function(o,a,l){const c=Yx(o,a,l);return o.inclusive?c<=0:c<0}(r.startAt,hc(r),i)||r.endAt&&!function(o,a,l){const c=Yx(o,a,l);return o.inclusive?c>=0:c>0}(r.endAt,hc(r),i))}(t,e)}function K2(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function G2(t){return(e,n)=>{let r=!1;for(const i of hc(t)){const s=fF(i,e,n);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function fF(t,e,n){const r=t.field.isKeyField()?se.comparator(e.key,n.key):function(s,o,a){const l=o.data.field(s),c=a.data.field(s);return l!==null&&c!==null?ls(l,c):ue()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return ue()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,n]);i.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[n]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){il(this.inner,(n,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return N2(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF=new Qe(se.comparator);function Rn(){return pF}const W2=new Qe(se.comparator);function Yl(...t){let e=W2;for(const n of t)e=e.insert(n.key,n);return e}function Q2(t){let e=W2;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Ar(){return fc()}function Y2(){return fc()}function fc(){return new gs(t=>t.toString(),(t,e)=>t.isEqual(e))}const mF=new Qe(se.comparator),gF=new Ue(se.comparator);function we(...t){let e=gF;for(const n of t)e=e.add(n);return e}const yF=new Ue(ye);function Py(){return yF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Qc(e)?"-0":e}}function X2(t){return{integerValue:""+t}}function vF(t,e){return S2(e)?X2(e):Dy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(){this._=void 0}}function _F(t,e,n){return t instanceof Ma?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&ky(s)&&(s=Ry(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(n,e):t instanceof ja?Z2(t,e):t instanceof Fa?eC(t,e):function(i,s){const o=J2(i,s),a=t1(o)+t1(i.Pe);return Tg(o)&&Tg(i.Pe)?X2(a):Dy(i.serializer,a)}(t,e)}function wF(t,e,n){return t instanceof ja?Z2(t,e):t instanceof Fa?eC(t,e):n}function J2(t,e){return t instanceof eu?function(r){return Tg(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Ma extends Df{}class ja extends Df{constructor(e){super(),this.elements=e}}function Z2(t,e){const n=tC(e);for(const r of t.elements)n.some(i=>Or(i,r))||n.push(r);return{arrayValue:{values:n}}}class Fa extends Df{constructor(e){super(),this.elements=e}}function eC(t,e){let n=tC(e);for(const r of t.elements)n=n.filter(i=>!Or(i,r));return{arrayValue:{values:n}}}class eu extends Df{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function t1(t){return nt(t.integerValue||t.doubleValue)}function tC(t){return Zc(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(e,n){this.field=e,this.transform=n}}function xF(t,e){return t.field.isEqual(e.field)&&function(r,i){return r instanceof ja&&i instanceof ja||r instanceof Fa&&i instanceof Fa?Va(r.elements,i.elements,Or):r instanceof eu&&i instanceof eu?Or(r.Pe,i.Pe):r instanceof Ma&&i instanceof Ma}(t.transform,e.transform)}class EF{constructor(e,n){this.version=e,this.transformResults=n}}class pn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new pn}static exists(e){return new pn(void 0,e)}static updateTime(e){return new pn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bd(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Vf{}function rC(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Of(t.key,pn.none()):new sl(t.key,t.data,pn.none());{const n=t.data,r=un.empty();let i=new Ue(st.comparator);for(let s of e.fields)if(!i.has(s)){let o=n.field(s);o===null&&s.length>1&&(s=s.popLast(),o=n.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new ys(t.key,r,new Gn(i.toArray()),pn.none())}}function bF(t,e,n){t instanceof sl?function(i,s,o){const a=i.value.clone(),l=r1(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(t,e,n):t instanceof ys?function(i,s,o){if(!Bd(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=r1(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(iC(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function pc(t,e,n,r){return t instanceof sl?function(s,o,a,l){if(!Bd(s.precondition,o))return a;const c=s.value.clone(),d=i1(s.fieldTransforms,l,o);return c.setAll(d),o.convertToFoundDocument(o.version,c).setHasLocalMutations(),null}(t,e,n,r):t instanceof ys?function(s,o,a,l){if(!Bd(s.precondition,o))return a;const c=i1(s.fieldTransforms,l,o),d=o.data;return d.setAll(iC(s)),d.setAll(c),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(s,o,a){return Bd(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(t,e,n)}function IF(t,e){let n=null;for(const r of t.fieldTransforms){const i=e.data.field(r.field),s=J2(r.transform,i||null);s!=null&&(n===null&&(n=un.empty()),n.set(r.field,s))}return n||null}function n1(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&Va(r,i,(s,o)=>xF(s,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class sl extends Vf{constructor(e,n,r,i=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class ys extends Vf{constructor(e,n,r,i,s=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function iC(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function r1(t,e,n){const r=new Map;he(t.length===n.length);for(let i=0;i<n.length;i++){const s=t[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,wF(o,a,n[i]))}return r}function i1(t,e,n){const r=new Map;for(const i of t){const s=i.transform,o=n.data.field(i.field);r.set(i.field,_F(s,o,e))}return r}class Of extends Vf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class sC extends Vf{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vy{constructor(e,n,r,i){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&bF(s,e,r[i])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=pc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=pc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Y2();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=n.has(i.key)?null:a;const l=rC(o,a);l!==null&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(pe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),we())}isEqual(e){return this.batchId===e.batchId&&Va(this.mutations,e.mutations,(n,r)=>n1(n,r))&&Va(this.baseMutations,e.baseMutations,(n,r)=>n1(n,r))}}class Oy{constructor(e,n,r,i){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=i}static from(e,n,r){he(e.mutations.length===r.length);let i=function(){return mF}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new Oy(e,n,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zy{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TF{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt,ke;function SF(t){switch(t){default:return ue();case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0}}function oC(t){if(t===void 0)return pt("GRPC error has no .code"),Q.UNKNOWN;switch(t){case vt.OK:return Q.OK;case vt.CANCELLED:return Q.CANCELLED;case vt.UNKNOWN:return Q.UNKNOWN;case vt.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case vt.INTERNAL:return Q.INTERNAL;case vt.UNAVAILABLE:return Q.UNAVAILABLE;case vt.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case vt.NOT_FOUND:return Q.NOT_FOUND;case vt.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case vt.ABORTED:return Q.ABORTED;case vt.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case vt.DATA_LOSS:return Q.DATA_LOSS;default:return ue()}}(ke=vt||(vt={}))[ke.OK=0]="OK",ke[ke.CANCELLED=1]="CANCELLED",ke[ke.UNKNOWN=2]="UNKNOWN",ke[ke.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ke[ke.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ke[ke.NOT_FOUND=5]="NOT_FOUND",ke[ke.ALREADY_EXISTS=6]="ALREADY_EXISTS",ke[ke.PERMISSION_DENIED=7]="PERMISSION_DENIED",ke[ke.UNAUTHENTICATED=16]="UNAUTHENTICATED",ke[ke.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ke[ke.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ke[ke.ABORTED=10]="ABORTED",ke[ke.OUT_OF_RANGE=11]="OUT_OF_RANGE",ke[ke.UNIMPLEMENTED=12]="UNIMPLEMENTED",ke[ke.INTERNAL=13]="INTERNAL",ke[ke.UNAVAILABLE=14]="UNAVAILABLE",ke[ke.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CF(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AF=new Ws([4294967295,4294967295],0);function s1(t){const e=CF().encode(t),n=new f2;return n.update(e),new Uint8Array(n.digest())}function o1(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Ws([n,r],0),new Ws([i,s],0)]}class Ly{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Xl(`Invalid padding: ${n}`);if(r<0)throw new Xl(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Xl(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Xl(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ws.fromNumber(this.Ie)}Ee(e,n,r){let i=e.add(n.multiply(Ws.fromNumber(r)));return i.compare(AF)===1&&(i=new Ws([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=s1(e),[r,i]=o1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,n,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Ly(s,i,n);return r.forEach(a=>o.insert(a)),o}insert(e){if(this.Ie===0)return;const n=s1(e),[r,i]=o1(n);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Xl extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(e,n,r,i,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const i=new Map;return i.set(e,wu.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new _u(pe.min(),i,new Qe(ye),Rn(),we())}}class wu{constructor(e,n,r,i,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new wu(r,n,we(),we(),we())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(e,n,r,i){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=i}}class aC{constructor(e,n){this.targetId=e,this.me=n}}class lC{constructor(e,n,r=mt.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=i}}class a1{constructor(){this.fe=0,this.ge=c1(),this.pe=mt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=we(),n=we(),r=we();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:n=n.add(i);break;case 1:r=r.add(i);break;default:ue()}}),new wu(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=c1()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,he(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class kF{constructor(e){this.Le=e,this.Be=new Map,this.ke=Rn(),this.qe=l1(),this.Qe=new Qe(ye)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:ue()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,i)=>{this.ze(i)&&n(i)})}He(e){const n=e.targetId,r=e.me.count,i=this.Je(n);if(i){const s=i.target;if(Lh(s))if(r===0){const o=new se(s.path);this.Ue(n,o,dt.newNoDocument(o,pe.min()))}else he(r===1);else{const o=this.Ye(n);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;if(l!==0){this.je(n);const c=l===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,c)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=n;let o,a;try{o=as(r).toUint8Array()}catch(l){if(l instanceof P2)return Kc("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new Ly(o,i,s)}catch(l){return Kc(l instanceof Xl?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return a.Ie===0?null:a}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(n,s,null),i++)}),i}rt(e){const n=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&Lh(a.target)){const l=new se(a.target.path);this.ke.get(l)!==null||this.it(o,l)||this.Ue(o,l,dt.newNoDocument(l,e))}s.be&&(n.set(o,s.ve()),s.Ce())}});let r=we();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const c=this.Je(l);return!c||c.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new _u(e,n,this.Qe,this.ke,r);return this.ke=Rn(),this.qe=l1(),this.Qe=new Qe(ye),i}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,n)?i.Fe(n,1):i.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new a1,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Ue(ye),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||J("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new a1),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function l1(){return new Qe(se.comparator)}function c1(){return new Qe(se.comparator)}const RF={asc:"ASCENDING",desc:"DESCENDING"},NF={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},PF={and:"AND",or:"OR"};class DF{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Ng(t,e){return t.useProto3Json||kf(e)?e:{value:e}}function $a(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function cC(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function VF(t,e){return $a(t,e.toTimestamp())}function tn(t){return he(!!t),pe.fromTimestamp(function(n){const r=fi(n);return new at(r.seconds,r.nanos)}(t))}function My(t,e){return Pg(t,e).canonicalString()}function Pg(t,e){const n=function(i){return new je(["projects",i.projectId,"databases",i.database])}(t).child("documents");return e===void 0?n:n.child(e)}function uC(t){const e=je.fromString(t);return he(_C(e)),e}function jh(t,e){return My(t.databaseId,e.path)}function Qs(t,e){const n=uC(e);if(n.get(1)!==t.databaseId.projectId)throw new ne(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ne(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new se(fC(n))}function dC(t,e){return My(t.databaseId,e)}function hC(t){const e=uC(t);return e.length===4?je.emptyPath():fC(e)}function Dg(t){return new je(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function fC(t){return he(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function u1(t,e,n){return{name:jh(t,e),fields:n.value.mapValue.fields}}function OF(t,e,n){const r=Qs(t,e.name),i=tn(e.updateTime),s=e.createTime?tn(e.createTime):pe.min(),o=new un({mapValue:{fields:e.fields}}),a=dt.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function zF(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(c){return c==="NO_CHANGE"?0:c==="ADD"?1:c==="REMOVE"?2:c==="CURRENT"?3:c==="RESET"?4:ue()}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(c,d){return c.useProto3Json?(he(d===void 0||typeof d=="string"),mt.fromBase64String(d||"")):(he(d===void 0||d instanceof Buffer||d instanceof Uint8Array),mt.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(c){const d=c.code===void 0?Q.UNKNOWN:oC(c.code);return new ne(d,c.message||"")}(o);n=new lC(r,i,s,a||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=Qs(t,r.document.name),s=tn(r.document.updateTime),o=r.document.createTime?tn(r.document.createTime):pe.min(),a=new un({mapValue:{fields:r.document.fields}}),l=dt.newFoundDocument(i,s,o,a),c=r.targetIds||[],d=r.removedTargetIds||[];n=new Hd(c,d,l.key,l)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=Qs(t,r.document),s=r.readTime?tn(r.readTime):pe.min(),o=dt.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Hd([],a,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=Qs(t,r.document),s=r.removedTargetIds||[];n=new Hd([],s,i,null)}else{if(!("filter"in e))return ue();{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new TF(i,s),a=r.targetId;n=new aC(a,o)}}return n}function Fh(t,e){let n;if(e instanceof sl)n={update:u1(t,e.key,e.value)};else if(e instanceof Of)n={delete:jh(t,e.key)};else if(e instanceof ys)n={update:u1(t,e.key,e.data),updateMask:UF(e.fieldMask)};else{if(!(e instanceof sC))return ue();n={verify:jh(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof Ma)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof ja)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Fa)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof eu)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw ue()}(0,r))),e.precondition.isNone||(n.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:VF(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:ue()}(t,e.precondition)),n}function Vg(t,e){const n=e.currentDocument?function(s){return s.updateTime!==void 0?pn.updateTime(tn(s.updateTime)):s.exists!==void 0?pn.exists(s.exists):pn.none()}(e.currentDocument):pn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;if("setToServerValue"in a)he(a.setToServerValue==="REQUEST_TIME"),l=new Ma;else if("appendMissingElements"in a){const d=a.appendMissingElements.values||[];l=new ja(d)}else if("removeAllFromArray"in a){const d=a.removeAllFromArray.values||[];l=new Fa(d)}else"increment"in a?l=new eu(o,a.increment):ue();const c=st.fromServerFormat(a.fieldPath);return new nC(c,l)}(t,i)):[];if(e.update){e.update.name;const i=Qs(t,e.update.name),s=new un({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(l){const c=l.fieldPaths||[];return new Gn(c.map(d=>st.fromServerFormat(d)))}(e.updateMask);return new ys(i,s,o,n,r)}return new sl(i,s,n,r)}if(e.delete){const i=Qs(t,e.delete);return new Of(i,n)}if(e.verify){const i=Qs(t,e.verify);return new sC(i,n)}return ue()}function LF(t,e){return t&&t.length>0?(he(e!==void 0),t.map(n=>function(i,s){let o=i.updateTime?tn(i.updateTime):tn(s);return o.isEqual(pe.min())&&(o=tn(s)),new EF(o,i.transformResults||[])}(n,e))):[]}function pC(t,e){return{documents:[dC(t,e.path)]}}function mC(t,e){const n={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=dC(t,i);const s=function(c){if(c.length!==0)return vC(Fe.create(c,"and"))}(e.filters);s&&(n.structuredQuery.where=s);const o=function(c){if(c.length!==0)return c.map(d=>function(f){return{field:qo(f.field),direction:jF(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Ng(t,e.limit);return a!==null&&(n.structuredQuery.limit=a),e.startAt&&(n.structuredQuery.startAt=function(c){return{before:c.inclusive,values:c.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(c){return{before:!c.inclusive,values:c.position}}(e.endAt)),{_t:n,parent:i}}function gC(t){let e=hC(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){he(r===1);const d=n.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];n.where&&(s=function(h){const f=yC(h);return f instanceof Fe&&Ny(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(b){return new zh(Ko(b.field),function(R){switch(R){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(f))}(n.orderBy));let a=null;n.limit&&(a=function(h){let f;return f=typeof h=="object"?h.value:h,kf(f)?null:f}(n.limit));let l=null;n.startAt&&(l=function(h){const f=!!h.before,m=h.values||[];return new za(m,f)}(n.startAt));let c=null;return n.endAt&&(c=function(h){const f=!h.before,m=h.values||[];return new za(m,f)}(n.endAt)),B2(e,i,o,s,a,"F",l,c)}function MF(t,e){const n=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ue()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function yC(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ko(n.unaryFilter.field);return Se.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=Ko(n.unaryFilter.field);return Se.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=Ko(n.unaryFilter.field);return Se.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ko(n.unaryFilter.field);return Se.create(o,"!=",{nullValue:"NULL_VALUE"});default:return ue()}}(t):t.fieldFilter!==void 0?function(n){return Se.create(Ko(n.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return ue()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Fe.create(n.compositeFilter.filters.map(r=>yC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return ue()}}(n.compositeFilter.op))}(t):ue()}function jF(t){return RF[t]}function FF(t){return NF[t]}function $F(t){return PF[t]}function qo(t){return{fieldPath:t.canonicalString()}}function Ko(t){return st.fromServerFormat(t.fieldPath)}function vC(t){return t instanceof Se?function(n){if(n.op==="=="){if(Gx(n.value))return{unaryFilter:{field:qo(n.field),op:"IS_NAN"}};if(Kx(n.value))return{unaryFilter:{field:qo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Gx(n.value))return{unaryFilter:{field:qo(n.field),op:"IS_NOT_NAN"}};if(Kx(n.value))return{unaryFilter:{field:qo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:qo(n.field),op:FF(n.op),value:n.value}}}(t):t instanceof Fe?function(n){const r=n.getFilters().map(i=>vC(i));return r.length===1?r[0]:{compositeFilter:{op:$F(n.op),filters:r}}}(t):ue()}function UF(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function _C(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e,n,r,i,s=pe.min(),o=pe.min(),a=mt.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new ti(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ti(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ti(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e){this.ct=e}}function BF(t,e){let n;if(e.document)n=OF(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=se.fromSegments(e.noDocument.path),i=uo(e.noDocument.readTime);n=dt.newNoDocument(r,i),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return ue();{const r=se.fromSegments(e.unknownDocument.path),i=uo(e.unknownDocument.version);n=dt.newUnknownDocument(r,i)}}return e.readTime&&n.setReadTime(function(i){const s=new at(i[0],i[1]);return pe.fromTimestamp(s)}(e.readTime)),n}function d1(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:$h(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:jh(s,o.key),fields:o.data.value.mapValue.fields,updateTime:$a(s,o.version.toTimestamp()),createTime:$a(s,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:co(e.version)};else{if(!e.isUnknownDocument())return ue();r.unknownDocument={path:n.path.toArray(),version:co(e.version)}}return r}function $h(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function co(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function uo(t){const e=new at(t.seconds,t.nanoseconds);return pe.fromTimestamp(e)}function Vs(t,e){const n=(e.baseMutations||[]).map(s=>Vg(t.ct,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const a=e.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>Vg(t.ct,s)),i=at.fromMillis(e.localWriteTimeMs);return new Vy(e.batchId,i,n,r)}function Jl(t){const e=uo(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?uo(t.lastLimboFreeSnapshotVersion):pe.min();let r;return r=function(s){return s.documents!==void 0}(t.query)?function(s){return he(s.documents.length===1),Pn(Nf(hC(s.documents[0])))}(t.query):function(s){return Pn(gC(s))}(t.query),new ti(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,mt.fromBase64String(t.resumeToken))}function xC(t,e){const n=co(e.snapshotVersion),r=co(e.lastLimboFreeSnapshotVersion);let i;i=Lh(e.target)?pC(t.ct,e.target):mC(t.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:lo(e.target),readTime:n,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function EC(t){const e=gC({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Rg(e,e.limit,"L"):e}function qp(t,e){return new zy(e.largestBatchId,Vg(t.ct,e.overlayMutation))}function h1(t,e){const n=e.path.lastSegment();return[t,en(e.path.popLast()),n]}function f1(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:co(r.readTime),documentKey:en(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HF{getBundleMetadata(e,n){return p1(e).get(n).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:uo(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,n){return p1(e).put(function(i){return{bundleId:i.id,createTime:co(tn(i.createTime)),version:i.version}}(n))}getNamedQuery(e,n){return m1(e).get(n).next(r=>{if(r)return function(s){return{name:s.name,query:EC(s.bundledQuery),readTime:uo(s.readTime)}}(r)})}saveNamedQuery(e,n){return m1(e).put(function(i){return{name:i.name,readTime:co(tn(i.readTime)),bundledQuery:i.bundledQuery}}(n))}}function p1(t){return Tt(t,"bundles")}function m1(t){return Tt(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zf{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const r=n.uid||"";return new zf(e,r)}getOverlay(e,n){return Ol(e).get(h1(this.userId,n)).next(r=>r?qp(this.serializer,r):null)}getOverlays(e,n){const r=Ar();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){const i=[];return r.forEach((s,o)=>{const a=new zy(n,o);i.push(this.ht(e,a))}),q.waitFor(i)}removeOverlaysForBatchId(e,n,r){const i=new Set;n.forEach(o=>i.add(en(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Ol(e).j("collectionPathOverlayIndex",a))}),q.waitFor(s)}getOverlaysForCollection(e,n,r){const i=Ar(),s=en(n),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Ol(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const c=qp(this.serializer,l);i.set(c.getKey(),c)}return i})}getOverlaysForCollectionGroup(e,n,r,i){const s=Ar();let o;const a=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return Ol(e).J({index:"collectionGroupOverlayIndex",range:a},(l,c,d)=>{const h=qp(this.serializer,c);s.size()<i||h.largestBatchId===o?(s.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>s)}ht(e,n){return Ol(e).put(function(i,s,o){const[a,l,c]=h1(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:c,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Fh(i.ct,o.mutation)}}(this.serializer,this.userId,n))}}function Ol(t){return Tt(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qF{Pt(e){return Tt(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?mt.fromUint8Array(r):mt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Os{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(nt(e.integerValue));else if("doubleValue"in e){const r=nt(e.doubleValue);isNaN(r)?this.dt(n,13):(this.dt(n,15),Qc(r)?n.At(0):n.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(n,20),typeof r=="string"&&(r=fi(r)),n.Rt(`${r.seconds||""}`),n.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(as(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(n,45),n.At(r.latitude||0),n.At(r.longitude||0)}else"mapValue"in e?D2(e)?this.dt(n,Number.MAX_SAFE_INTEGER):Rf(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):ue()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const r=e.fields||{};this.dt(n,55);for(const i of Object.keys(r))this.Vt(i,n),this.Tt(r[i],n)}wt(e,n){var r,i;const s=e.fields||{};this.dt(n,53);const o="value",a=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.dt(n,15),n.At(nt(a)),this.Vt(o,n),this.Tt(s[o],n)}bt(e,n){const r=e.values||[];this.dt(n,50);for(const i of r)this.Tt(i,n)}yt(e,n){this.dt(n,37),se.fromName(e).path.forEach(r=>{this.dt(n,60),this.Dt(r,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}Os.vt=new Os;function KF(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function g1(t){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=KF(255&r[s]);if(i+=o,o!==8)break}return i}(t);return Math.ceil(e/8)}class GF{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ft(r.value),r=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Ot(r.value),r=n.next();this.Nt()}Lt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=n.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=n.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const n=this.qt(e),r=g1(n);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=255&n[i]}Kt(e){const n=this.qt(e),r=g1(n);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=n.length-r;i<n.length;++i)this.buffer[this.position++]=~(255&n[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=(128&n[0])!=0;n[0]^=r?255:128;for(let i=1;i<n.length;++i)n[i]^=r?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class WF{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class QF{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class zl{constructor(){this.jt=new GF,this.Ht=new WF(this.jt),this.Jt=new QF(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zs{constructor(e,n,r,i){this.indexId=e,this.documentKey=n,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.directionalValue,0),n!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new zs(this.indexId,this.documentKey,this.arrayValue,r)}}function Ai(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=y1(t.arrayValue,e.arrayValue),n!==0?n:(n=y1(t.directionalValue,e.directionalValue),n!==0?n:se.comparator(t.documentKey,e.documentKey)))}function y1(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v1{constructor(e){this.Xt=new Ue((n,r)=>st.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const r=n;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(he(e.collectionGroup===this.collectionId),this.nn)return!1;const n=Eg(e);if(n!==void 0&&!this.sn(n))return!1;const r=Ps(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s){const a=r[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let e=new Ue(st.comparator);const n=[];for(const r of this.tn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new jd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new jd(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new jd(r.field,r.dir==="asc"?0:1)));return new Oh(Oh.UNKNOWN_ID,this.collectionId,n,Wc.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(t){var e,n;if(he(t instanceof Se||t instanceof Fe),t instanceof Se){if(t instanceof U2){const i=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(s=>Se.create(t.field,"==",s)))||[];return Fe.create(i,"or")}return t}const r=t.filters.map(i=>bC(i));return Fe.create(r,t.op)}function YF(t){if(t.getFilters().length===0)return[];const e=Lg(bC(t));return he(IC(e)),Og(e)||zg(e)?[e]:e.getFilters()}function Og(t){return t instanceof Se}function zg(t){return t instanceof Fe&&Ny(t)}function IC(t){return Og(t)||zg(t)||function(n){if(n instanceof Fe&&Sg(n)){for(const r of n.getFilters())if(!Og(r)&&!zg(r))return!1;return!0}return!1}(t)}function Lg(t){if(he(t instanceof Se||t instanceof Fe),t instanceof Se)return t;if(t.filters.length===1)return Lg(t.filters[0]);const e=t.filters.map(r=>Lg(r));let n=Fe.create(e,t.op);return n=Uh(n),IC(n)?n:(he(n instanceof Fe),he(La(n)),he(n.filters.length>1),n.filters.reduce((r,i)=>jy(r,i)))}function jy(t,e){let n;return he(t instanceof Se||t instanceof Fe),he(e instanceof Se||e instanceof Fe),n=t instanceof Se?e instanceof Se?function(i,s){return Fe.create([i,s],"and")}(t,e):_1(t,e):e instanceof Se?_1(e,t):function(i,s){if(he(i.filters.length>0&&s.filters.length>0),La(i)&&La(s))return j2(i,s.getFilters());const o=Sg(i)?i:s,a=Sg(i)?s:i,l=o.filters.map(c=>jy(c,a));return Fe.create(l,"or")}(t,e),Uh(n)}function _1(t,e){if(La(e))return j2(e,t.getFilters());{const n=e.filters.map(r=>jy(t,r));return Fe.create(n,"or")}}function Uh(t){if(he(t instanceof Se||t instanceof Fe),t instanceof Se)return t;const e=t.getFilters();if(e.length===1)return Uh(e[0]);if(L2(t))return t;const n=e.map(i=>Uh(i)),r=[];return n.forEach(i=>{i instanceof Se?r.push(i):i instanceof Fe&&(i.op===t.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:Fe.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XF{constructor(){this.un=new Fy}addToCollectionParentIndex(e,n){return this.un.add(n),q.resolve()}getCollectionParents(e,n){return q.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return q.resolve()}deleteFieldIndex(e,n){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,n){return q.resolve()}getDocumentsMatchingTarget(e,n){return q.resolve(null)}getIndexType(e,n){return q.resolve(0)}getFieldIndexes(e,n){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,n){return q.resolve(zn.min())}getMinOffsetFromCollectionGroup(e,n){return q.resolve(zn.min())}updateCollectionGroup(e,n,r){return q.resolve()}updateIndexEntries(e,n){return q.resolve()}}class Fy{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n]||new Ue(je.comparator),s=!i.has(r);return this.index[n]=i.add(r),s}has(e){const n=e.lastSegment(),r=e.popLast(),i=this.index[n];return i&&i.has(r)}getEntries(e){return(this.index[e]||new Ue(je.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fd=new Uint8Array(0);class JF{constructor(e,n){this.databaseId=n,this.cn=new Fy,this.ln=new gs(r=>lo(r),(r,i)=>gu(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const r=n.lastSegment(),i=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const s={collectionId:r,parent:en(i)};return w1(e).put(s)}return q.resolve()}getCollectionParents(e,n){const r=[],i=IDBKeyRange.bound([n,""],[w2(n),""],!1,!0);return w1(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==n)break;r.push(Cr(o.parent))}return r})}addFieldIndex(e,n){const r=Ll(e),i=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])}}(n);delete i.indexId;const s=r.add(i);if(n.indexState){const o=$o(e);return s.next(a=>{o.put(f1(a,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return s.next()}deleteFieldIndex(e,n){const r=Ll(e),i=$o(e),s=Fo(e);return r.delete(n.indexId).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=Ll(e),r=Fo(e),i=$o(e);return n.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,n){return q.forEach(this.hn(n),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new v1(r).an();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,n){const r=Fo(e);let i=!0;const s=new Map;return q.forEach(this.hn(n),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=we();const a=[];return q.forEach(s,(l,c)=>{J("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(A=>`${A.fieldPath}:${A.kind}`).join(",")}`}(l)} to execute ${lo(n)}`);const d=function(T,A){const O=Eg(A);if(O===void 0)return null;for(const L of Mh(T,O.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(c,l),h=function(T,A){const O=new Map;for(const L of Ps(A))for(const S of Mh(T,L.fieldPath))switch(S.op){case"==":case"in":O.set(L.fieldPath.canonicalString(),S.value);break;case"not-in":case"!=":return O.set(L.fieldPath.canonicalString(),S.value),Array.from(O.values())}return null}(c,l),f=function(T,A){const O=[];let L=!0;for(const S of Ps(A)){const I=S.kind===0?Jx(T,S.fieldPath,T.startAt):Zx(T,S.fieldPath,T.startAt);O.push(I.value),L&&(L=I.inclusive)}return new za(O,L)}(c,l),m=function(T,A){const O=[];let L=!0;for(const S of Ps(A)){const I=S.kind===0?Zx(T,S.fieldPath,T.endAt):Jx(T,S.fieldPath,T.endAt);O.push(I.value),L&&(L=I.inclusive)}return new za(O,L)}(c,l),b=this.In(l,c,f),x=this.In(l,c,m),R=this.Tn(l,c,h),y=this.En(l.indexId,d,b,f.inclusive,x,m.inclusive,R);return q.forEach(y,v=>r.G(v,n.limit).next(T=>{T.forEach(A=>{const O=se.fromSegments(A.documentKey);o.has(O)||(o=o.add(O),a.push(O))})}))}).next(()=>a)}return q.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=YF(Fe.create(e.filters,"and")).map(r=>Ag(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,r,i,s,o,a){const l=(n!=null?n.length:1)*Math.max(r.length,s.length),c=l/(n!=null?n.length:1),d=[];for(let h=0;h<l;++h){const f=n?this.dn(n[h/c]):fd,m=this.An(e,f,r[h%c],i),b=this.Rn(e,f,s[h%c],o),x=a.map(R=>this.An(e,f,R,!0));d.push(...this.createRange(m,b,x))}return d}An(e,n,r,i){const s=new zs(e,se.empty(),n,r);return i?s:s.Zt()}Rn(e,n,r,i){const s=new zs(e,se.empty(),n,r);return i?s.Zt():s}Pn(e,n){const r=new v1(n),i=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,n){let r=2;const i=this.hn(n);return q.forEach(i,s=>this.Pn(e,s).next(o=>{o?r!==0&&o.fields.length<function(l){let c=new Ue(st.comparator),d=!1;for(const h of l.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:c=c.add(f.field));for(const h of l.orderBy)h.field.isKeyField()||(c=c.add(h.field));return c.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&i.length>1&&r===2?1:r)}Vn(e,n){const r=new zl;for(const i of Ps(e)){const s=n.data.field(i.fieldPath);if(s==null)return null;const o=r.Yt(i.kind);Os.vt.It(s,o)}return r.zt()}dn(e){const n=new zl;return Os.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const r=new zl;return Os.vt.It(Jc(this.databaseId,n),r.Yt(function(s){const o=Ps(s);return o.length===0?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,n,r){if(r===null)return[];let i=[];i.push(new zl);let s=0;for(const o of Ps(e)){const a=r[s++];for(const l of i)if(this.fn(n,o.fieldPath)&&Zc(a))i=this.gn(i,o,a);else{const c=l.Yt(o.kind);Os.vt.It(a,c)}}return this.pn(i)}In(e,n,r){return this.Tn(e,n,r.position)}pn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].zt();return n}gn(e,n,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new zl;l.seed(a.zt()),Os.vt.It(o,l.Yt(n.kind)),s.push(l)}return s}fn(e,n){return!!e.filters.find(r=>r instanceof Se&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=Ll(e),i=$o(e);return(n?r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):r.U()).next(s=>{const o=[];return q.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,h){const f=h?new Wc(h.sequenceNumber,new zn(uo(h.readTime),new se(Cr(h.documentKey)),h.largestBatchId)):Wc.empty(),m=d.fields.map(([b,x])=>new jd(st.fromServerFormat(b),x));return new Oh(d.indexId,d.collectionGroup,m,f)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:ye(r.collectionGroup,i.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const i=Ll(e),s=$o(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(a=>q.forEach(a,l=>s.put(f1(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return q.forEach(n,(i,s)=>{const o=r.get(i.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),q.forEach(a,l=>this.wn(e,i,l).next(c=>{const d=this.Sn(s,l);return c.isEqual(d)?q.resolve():this.bn(e,s,l,c,d)}))))})}Dn(e,n,r,i){return Fo(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,n.key),documentKey:n.key.path.toArray()})}vn(e,n,r,i){return Fo(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,n.key),n.key.path.toArray()])}wn(e,n,r){const i=Fo(e);let s=new Ue(Ai);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,n)])},(o,a)=>{s=s.add(new zs(r.indexId,n,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,n){let r=new Ue(Ai);const i=this.Vn(n,e);if(i==null)return r;const s=Eg(n);if(s!=null){const o=e.data.field(s.fieldPath);if(Zc(o))for(const a of o.arrayValue.values||[])r=r.add(new zs(n.indexId,e.key,this.dn(a),i))}else r=r.add(new zs(n.indexId,e.key,fd,i));return r}bn(e,n,r,i,s){J("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(l,c,d,h,f){const m=l.getIterator(),b=c.getIterator();let x=jo(m),R=jo(b);for(;x||R;){let y=!1,v=!1;if(x&&R){const T=d(x,R);T<0?v=!0:T>0&&(y=!0)}else x!=null?v=!0:y=!0;y?(h(R),R=jo(b)):v?(f(x),x=jo(m)):(x=jo(m),R=jo(b))}}(i,s,Ai,a=>{o.push(this.Dn(e,n,r,a))},a=>{o.push(this.vn(e,n,r,a))}),q.waitFor(o)}yn(e){let n=1;return $o(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),n=i.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,a)=>Ai(o,a)).filter((o,a,l)=>!a||Ai(o,l[a-1])!==0);const i=[];i.push(e);for(const o of r){const a=Ai(o,e),l=Ai(o,n);if(a===0)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(n);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];const a=[i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,fd,[]],l=[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,fd,[]];s.push(IDBKeyRange.bound(a,l))}return s}Cn(e,n){return Ai(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(x1)}getMinOffset(e,n){return q.mapArray(this.hn(n),r=>this.Pn(e,r).next(i=>i||ue())).next(x1)}}function w1(t){return Tt(t,"collectionParents")}function Fo(t){return Tt(t,"indexEntries")}function Ll(t){return Tt(t,"indexConfiguration")}function $o(t){return Tt(t,"indexState")}function x1(t){he(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const i=t[r].indexState.offset;Sy(i,e)<0&&(e=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new zn(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E1={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ln{constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new ln(e,ln.DEFAULT_COLLECTION_PERCENTILE,ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(t,e,n){const r=t.store("mutations"),i=t.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},(d,h,f)=>(a++,f.delete()));s.push(l.next(()=>{he(a===1)}));const c=[];for(const d of n.mutations){const h=C2(e,d.key.path,n.batchId);s.push(i.delete(h)),c.push(d.key)}return q.waitFor(s).next(()=>c)}function Bh(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw ue();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ln.DEFAULT_COLLECTION_PERCENTILE=10,ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ln.DEFAULT=new ln(41943040,ln.DEFAULT_COLLECTION_PERCENTILE,ln.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ln.DISABLED=new ln(-1,0,0);class Lf{constructor(e,n,r,i){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,n,r,i){he(e.uid!=="");const s=e.isAuthenticated()?e.uid:"";return new Lf(s,n,r,i)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ki(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,i){const s=Go(e),o=ki(e);return o.add({}).next(a=>{he(typeof a=="number");const l=new Vy(a,n,r,i),c=function(m,b,x){const R=x.baseMutations.map(v=>Fh(m.ct,v)),y=x.mutations.map(v=>Fh(m.ct,v));return{userId:b,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:R,mutations:y}}(this.serializer,this.userId,l),d=[];let h=new Ue((f,m)=>ye(f.canonicalString(),m.canonicalString()));for(const f of i){const m=C2(this.userId,f.key.path,a);h=h.add(f.key.path.popLast()),d.push(o.put(c)),d.push(s.put(m,z9))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),q.waitFor(d).next(()=>l)})}lookupMutationBatch(e,n){return ki(e).get(n).next(r=>r?(he(r.userId===this.userId),Vs(this.serializer,r)):null)}Mn(e,n){return this.Fn[n]?q.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const i=r.keys();return this.Fn[n]=i,i}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return ki(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(he(a.batchId>=r),s=Vs(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return ki(e).J({index:"userMutationsIndex",range:n,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ki(e).U("userMutationsIndex",n).next(r=>r.map(i=>Vs(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Fd(this.userId,n.path),i=IDBKeyRange.lowerBound(r),s=[];return Go(e).J({range:i},(o,a,l)=>{const[c,d,h]=o,f=Cr(d);if(c===this.userId&&n.path.isEqual(f))return ki(e).get(h).next(m=>{if(!m)throw ue();he(m.userId===this.userId),s.push(Vs(this.serializer,m))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ue(ye);const i=[];return n.forEach(s=>{const o=Fd(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=Go(e).J({range:a},(c,d,h)=>{const[f,m,b]=c,x=Cr(m);f===this.userId&&s.path.isEqual(x)?r=r.add(b):h.done()});i.push(l)}),q.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1,s=Fd(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new Ue(ye);return Go(e).J({range:o},(l,c,d)=>{const[h,f,m]=l,b=Cr(f);h===this.userId&&r.isPrefixOf(b)?b.length===i&&(a=a.add(m)):d.done()}).next(()=>this.xn(e,a))}xn(e,n){const r=[],i=[];return n.forEach(s=>{i.push(ki(e).get(s).next(o=>{if(o===null)throw ue();he(o.userId===this.userId),r.push(Vs(this.serializer,o))}))}),q.waitFor(i).next(()=>r)}removeMutationBatch(e,n){return TC(e._e,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),q.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return q.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return Go(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=Cr(s[1]);i.push(l)}else a.done()}).next(()=>{he(i.length===0)})})}containsKey(e,n){return SC(e,this.userId,n)}Nn(e){return CC(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function SC(t,e,n){const r=Fd(e,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Go(t).J({range:s,H:!0},(a,l,c)=>{const[d,h,f]=a;d===e&&h===i&&(o=!0),c.done()}).next(()=>o)}function ki(t){return Tt(t,"mutations")}function Go(t){return Tt(t,"documentMutations")}function CC(t){return Tt(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ho{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ho(0)}static kn(){return new ho(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZF{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const r=new ho(n.highestTargetId);return n.highestTargetId=r.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>pe.fromTimestamp(new at(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=n,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),n>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=n),this.Qn(e,i)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(n,r),this.Qn(e,r))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Uo(e).delete(n.targetId)).next(()=>this.qn(e)).next(r=>(he(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,n,r){let i=0;const s=[];return Uo(e).J((o,a)=>{const l=Jl(a);l.sequenceNumber<=n&&r.get(l.targetId)===null&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>q.waitFor(s)).next(()=>i)}forEachTarget(e,n){return Uo(e).J((r,i)=>{const s=Jl(i);n(s)})}qn(e){return b1(e).get("targetGlobalKey").next(n=>(he(n!==null),n))}Qn(e,n){return b1(e).put("targetGlobalKey",n)}Kn(e,n){return Uo(e).put(xC(this.serializer,n))}$n(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const r=lo(n),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Uo(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const c=Jl(a);gu(n,c.target)&&(s=c,l.done())}).next(()=>s)}addMatchingKeys(e,n,r){const i=[],s=Fi(e);return n.forEach(o=>{const a=en(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),q.waitFor(i)}removeMatchingKeys(e,n,r){const i=Fi(e);return q.forEach(n,s=>{const o=en(s.path);return q.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,n){const r=Fi(e),i=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),i=Fi(e);let s=we();return i.J({range:r,H:!0},(o,a,l)=>{const c=Cr(o[1]),d=new se(c);s=s.add(d)}).next(()=>s)}containsKey(e,n){const r=en(n.path),i=IDBKeyRange.bound([r],[w2(r)],!1,!0);let s=0;return Fi(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,c)=>{o!==0&&(s++,c.done())}).next(()=>s>0)}ot(e,n){return Uo(e).get(n).next(r=>r?Jl(r):null)}}function Uo(t){return Tt(t,"targets")}function b1(t){return Tt(t,"targetGlobal")}function Fi(t){return Tt(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I1([t,e],[n,r]){const i=ye(t,n);return i===0?ye(e,r):i}class e${constructor(e){this.Un=e,this.buffer=new Ue(I1),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();I1(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class t${constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){J("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){ms(n)?J("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await ps(n)}await this.Hn(3e5)})}}class n${constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return q.resolve(fn.oe);const r=new e$(n);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Jn.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(J("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(E1)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(J("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),E1):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let r,i,s,o,a,l,c;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(J("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),i=this.params.maximumSequenceNumbersToCollect):i=h,o=Date.now(),this.nthSequenceNumber(e,i))).next(h=>(r=h,a=Date.now(),this.removeTargets(e,r,n))).next(h=>(s=h,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(c=Date.now(),Bo()<=Te.DEBUG&&J("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${i} in `+(a-o)+`ms
	Removed ${s} targets in `+(l-a)+`ms
	Removed ${h} documents in `+(c-l)+`ms
Total Duration: ${c-d}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:h})))}}function r$(t,e){return new n$(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i${constructor(e,n){this.db=e,this.garbageCollector=r$(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(i=>r+i))}er(e){let n=0;return this.Zn(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(r,i)=>n(i))}addReference(e,n,r){return pd(e,r)}removeReference(e,n,r){return pd(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return pd(e,n)}nr(e,n){return function(i,s){let o=!1;return CC(i).Y(a=>SC(i,a,s).next(l=>(l&&(o=!0),q.resolve(!l)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=n){const l=this.nr(e,o).next(c=>{if(!c)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,pe.min()),Fi(e).delete(function(h){return[0,en(h.path)]}(o))))});i.push(l)}}).next(()=>q.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return pd(e,n)}tr(e,n){const r=Fi(e);let i,s=fn.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:c})=>{o===0?(s!==fn.oe&&n(new se(Cr(i)),s),s=c,i=l):s=fn.oe}).next(()=>{s!==fn.oe&&n(new se(Cr(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function pd(t,e){return Fi(t).put(function(r,i){return{targetId:0,path:en(r.path),sequenceNumber:i}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(){this.changes=new gs(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,dt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?q.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s${constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return Cs(e).put(r)}removeEntry(e,n,r){return Cs(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],$h(o),a[a.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.rr(e,r)))}getEntry(e,n){let r=dt.newInvalidDocument(n);return Cs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ml(n))},(i,s)=>{r=this.ir(n,s)}).next(()=>r)}sr(e,n){let r={size:0,document:dt.newInvalidDocument(n)};return Cs(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Ml(n))},(i,s)=>{r={document:this.ir(n,s),size:Bh(s)}}).next(()=>r)}getEntries(e,n){let r=Rn();return this._r(e,n,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,n){let r=Rn(),i=new Qe(se.comparator);return this._r(e,n,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,Bh(o))}).next(()=>({documents:r,ur:i}))}_r(e,n,r){if(n.isEmpty())return q.resolve();let i=new Ue(C1);n.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Ml(i.first()),Ml(i.last())),o=i.getIterator();let a=o.getNext();return Cs(e).J({index:"documentKeyIndex",range:s},(l,c,d)=>{const h=se.fromSegments([...c.prefixPath,c.collectionGroup,c.documentId]);for(;a&&C1(a,h)<0;)r(a,null),a=o.getNext();a&&a.isEqual(h)&&(r(a,c),a=o.hasNext()?o.getNext():null),a?d.$(Ml(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,i,s){const o=n.path,a=[o.popLast().toArray(),o.lastSegment(),$h(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Cs(e).U(IDBKeyRange.bound(a,l,!0)).next(c=>{s==null||s.incrementDocumentReadCount(c.length);let d=Rn();for(const h of c){const f=this.ir(se.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(vu(n,f)||i.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,i){let s=Rn();const o=S1(n,r),a=S1(n,zn.max());return Cs(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,c,d)=>{const h=this.ir(se.fromSegments(c.prefixPath.concat(c.collectionGroup,c.documentId)),c);s=s.insert(h.key,h),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new o$(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return T1(e).get("remoteDocumentGlobalKey").next(n=>(he(!!n),n))}rr(e,n){return T1(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const r=BF(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(pe.min())))return r}return dt.newInvalidDocument(e)}}function kC(t){return new s$(t)}class o$ extends AC{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new gs(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const n=[];let r=0,i=new Ue((s,o)=>ye(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(n.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=d1(this.cr.serializer,o);i=i.add(s.path.popLast());const c=Bh(l);r+=c-a.size,n.push(this.cr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=d1(this.cr.serializer,o.convertToNoDocument(pe.min()));n.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),n.push(this.cr.updateMetadata(e,r)),q.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(r=>(this.lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function T1(t){return Tt(t,"remoteDocumentGlobal")}function Cs(t){return Tt(t,"remoteDocumentsV14")}function Ml(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function S1(t,e){const n=e.documentKey.path.toArray();return[t,$h(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function C1(t,e){const n=t.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=ye(n[s],r[s]),i)return i;return i=ye(n.length,r.length),i||(i=ye(n[n.length-2],r[r.length-2]),i||ye(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a${constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RC{constructor(e,n,r,i){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,n))).next(i=>(r!==null&&pc(r.mutation,i,Gn.empty(),at.now()),i))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,we()).next(()=>r))}getLocalViewOfDocuments(e,n,r=we()){const i=Ar();return this.populateOverlays(e,i,n).next(()=>this.computeViews(e,n,i,r).next(s=>{let o=Yl();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Ar();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,we()))}populateOverlays(e,n,r){const i=[];return r.forEach(s=>{n.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{n.set(o,a)})})}computeViews(e,n,r,i){let s=Rn();const o=fc(),a=function(){return fc()}();return n.forEach((l,c)=>{const d=r.get(c.key);i.has(c.key)&&(d===void 0||d.mutation instanceof ys)?s=s.insert(c.key,c):d!==void 0?(o.set(c.key,d.mutation.getFieldMask()),pc(d.mutation,c,d.mutation.getFieldMask(),at.now())):o.set(c.key,Gn.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((c,d)=>o.set(c,d)),n.forEach((c,d)=>{var h;return a.set(c,new a$(d,(h=o.get(c))!==null&&h!==void 0?h:null))}),a))}recalculateAndSaveOverlays(e,n){const r=fc();let i=new Qe((o,a)=>o-a),s=we();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const a of o)a.keys().forEach(l=>{const c=n.get(l);if(c===null)return;let d=r.get(l)||Gn.empty();d=a.applyToLocalView(c,d),r.set(l,d);const h=(i.get(a.batchId)||we()).add(l);i=i.insert(a.batchId,h)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),c=l.key,d=l.value,h=Y2();d.forEach(f=>{if(!s.has(f)){const m=rC(n.get(f),r.get(f));m!==null&&h.set(f,m),s=s.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,c,h))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,i){return function(o){return se.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):H2(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,i):this.getDocumentsMatchingCollectionQuery(e,n,r,i)}getNextDocuments(e,n,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,i-s.size):q.resolve(Ar());let a=-1,l=s;return o.next(c=>q.forEach(c,(d,h)=>(a<h.largestBatchId&&(a=h.largestBatchId),s.get(d)?q.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{l=l.insert(d,f)}))).next(()=>this.populateOverlays(e,c,s)).next(()=>this.computeViews(e,l,c,we())).next(d=>({batchId:a,changes:Q2(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new se(n)).next(r=>{let i=Yl();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,n,r,i){const s=n.collectionGroup;let o=Yl();return this.indexManager.getCollectionParents(e,s).next(a=>q.forEach(a,l=>{const c=function(h,f){return new yu(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,l.child(s));return this.getDocumentsMatchingCollectionQuery(e,c,r,i).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,s,i))).next(o=>{s.forEach((l,c)=>{const d=c.getKey();o.get(d)===null&&(o=o.insert(d,dt.newInvalidDocument(d)))});let a=Yl();return o.forEach((l,c)=>{const d=s.get(l);d!==void 0&&pc(d.mutation,c,Gn.empty(),at.now()),vu(n,c)&&(a=a.insert(l,c))}),a})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l${constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return q.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(i){return{id:i.id,version:i.version,createTime:tn(i.createTime)}}(n)),q.resolve()}getNamedQuery(e,n){return q.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(i){return{name:i.name,query:EC(i.bundledQuery),readTime:tn(i.readTime)}}(n)),q.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c${constructor(){this.overlays=new Qe(se.comparator),this.Ir=new Map}getOverlay(e,n){return q.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Ar();return q.forEach(n,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((i,s)=>{this.ht(e,n,s)}),q.resolve()}removeOverlaysForBatchId(e,n,r){const i=this.Ir.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),q.resolve()}getOverlaysForCollection(e,n,r){const i=Ar(),s=n.length+1,o=new se(n.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,c=l.getKey();if(!n.isPrefixOf(c.path))break;c.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return q.resolve(i)}getOverlaysForCollectionGroup(e,n,r,i){let s=new Qe((c,d)=>c-d);const o=this.overlays.getIterator();for(;o.hasNext();){const c=o.getNext().value;if(c.getKey().getCollectionGroup()===n&&c.largestBatchId>r){let d=s.get(c.largestBatchId);d===null&&(d=Ar(),s=s.insert(c.largestBatchId,d)),d.set(c.getKey(),c)}}const a=Ar(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((c,d)=>a.set(c,d)),!(a.size()>=i)););return q.resolve(a)}ht(e,n,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new zy(n,r));let s=this.Ir.get(n);s===void 0&&(s=we(),this.Ir.set(n,s)),this.Ir.set(n,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u${constructor(){this.sessionToken=mt.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,q.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y{constructor(){this.Tr=new Ue(kt.Er),this.dr=new Ue(kt.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new kt(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new kt(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new se(new je([])),r=new kt(n,e),i=new kt(n,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new se(new je([])),r=new kt(n,e),i=new kt(n,e+1);let s=we();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const n=new kt(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class kt{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return se.comparator(e.key,n.key)||ye(e.wr,n.wr)}static Ar(e,n){return ye(e.wr,n.wr)||se.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d${constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Ue(kt.Er)}checkEmpty(e){return q.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,i){const s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Vy(s,n,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new kt(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,n){return q.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,i=this.vr(r),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new kt(n,0),i=new kt(n,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Ue(ye);return n.forEach(i=>{const s=new kt(i,0),o=new kt(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),q.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,i=r.length+1;let s=r;se.isDocumentKey(s)||(s=s.child(""));const o=new kt(new se(s),0);let a=new Ue(ye);return this.br.forEachWhile(l=>{const c=l.key.path;return!!r.isPrefixOf(c)&&(c.length===i&&(a=a.add(l.wr)),!0)},o),q.resolve(this.Cr(a))}Cr(e){const n=[];return e.forEach(r=>{const i=this.Dr(r);i!==null&&n.push(i)}),n}removeMutationBatch(e,n){he(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return q.forEach(n.mutations,i=>{const s=new kt(i.key,n.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new kt(n,0),i=this.br.firstAfterOrEqual(r);return q.resolve(n.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,q.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h${constructor(e){this.Mr=e,this.docs=function(){return new Qe(se.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return q.resolve(r?r.document.mutableCopy():dt.newInvalidDocument(n))}getEntries(e,n){let r=Rn();return n.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():dt.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,n,r,i){let s=Rn();const o=n.path,a=new se(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:c,value:{document:d}}=l.getNext();if(!o.isPrefixOf(c.path))break;c.path.length>o.length+1||Sy(E2(d),r)<=0||(i.has(d.key)||vu(n,d))&&(s=s.insert(d.key,d.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,n,r,i){ue()}Or(e,n){return q.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new f$(this)}getSize(e){return q.resolve(this.size)}}class f$ extends AC{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?n.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),q.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p${constructor(e){this.persistence=e,this.Nr=new gs(n=>lo(n),gu),this.lastRemoteSnapshotVersion=pe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new $y,this.targetCount=0,this.kr=ho.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,i)=>n(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),q.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ho(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,q.resolve()}updateTargetData(e,n){return this.Kn(n),q.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,n,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=n&&r.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return q.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),q.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const i=this.persistence.referenceDelegate,s=[];return i&&n.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),q.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return q.resolve(r)}containsKey(e,n){return q.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NC{constructor(e,n){this.qr={},this.overlays={},this.Qr=new fn(0),this.Kr=!1,this.Kr=!0,this.$r=new u$,this.referenceDelegate=e(this),this.Ur=new p$(this),this.indexManager=new XF,this.remoteDocumentCache=function(i){return new h$(i)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new wC(n),this.Gr=new l$(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new c$,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new d$(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("MemoryPersistence","Starting transaction:",e);const i=new m$(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,n){return q.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class m$ extends I2{constructor(e){super(),this.currentSequenceNumber=e}}class Mf{constructor(e){this.persistence=e,this.Jr=new $y,this.Yr=null}static Zr(e){return new Mf(e)}get Xr(){if(this.Yr)return this.Yr;throw ue()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),q.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),q.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.Xr,r=>{const i=se.fromPath(r);return this.ei(e,i).next(s=>{s||n.removeEntry(i,pe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return q.or([()=>q.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g${constructor(e){this.serializer=e}O(e,n,r,i){const s=new Af("createOrUpgrade",n);r<1&&i>=1&&(function(l){l.createObjectStore("owner")}(e),function(l){l.createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$x,{unique:!0}),l.createObjectStore("documentMutations")}(e),A1(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=q.resolve();return r<3&&i>=3&&(r!==0&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),A1(e)),o=o.next(()=>function(l){const c=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:pe.min().toTimestamp(),targetCount:0};return c.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(l,c){return c.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",$x,{unique:!0});const h=c.store("mutations"),f=d.map(m=>h.put(m));return q.waitFor(f)})}(e,s))),o=o.next(()=>{(function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(l){const c=l.createObjectStore("documentOverlays",{keyPath:W9});c.createIndex("collectionPathOverlayIndex",Q9,{unique:!1}),c.createIndex("collectionGroupOverlayIndex",Y9,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const c=l.createObjectStore("remoteDocumentsV14",{keyPath:L9});c.createIndex("documentKeyIndex",M9),c.createIndex("collectionGroupIndex",j9)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:H9}).createIndex("sequenceNumberIndex",q9,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:K9}).createIndex("documentKeyIndex",G9,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(l){l.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((r,i)=>{n+=Bh(i)}).next(()=>{const r={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const n=e.store("mutationQueues"),r=e.store("mutations");return n.U().next(i=>q.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>q.forEach(a,l=>{he(l.userId===s.userId);const c=Vs(this.serializer,l);return TC(e,s.userId,c).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new je(o),c=function(h){return[0,en(h)]}(l);s.push(n.get(c).next(d=>d?q.resolve():(h=>n.put({targetId:0,path:en(h),sequenceNumber:i.highestListenSequenceNumber}))(l)))}).next(()=>q.waitFor(s))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:B9});const r=n.store("collectionParents"),i=new Fy,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:en(l)})}};return n.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new je(o);return s(l.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,a,l],c)=>{const d=Cr(a);return s(d.popLast())}))}oi(e){const n=e.store("targets");return n.J((r,i)=>{const s=Jl(i),o=xC(this.serializer,s);return n.put(o)})}_i(e,n){const r=n.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=n.store("remoteDocumentsV14"),l=function(h){return h.document?new se(je.fromString(h.document.name).popFirst(5)):h.noDocument?se.fromSegments(h.noDocument.path):h.unknownDocument?se.fromSegments(h.unknownDocument.path):ue()}(o).path.toArray(),c={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(a.put(c))}).next(()=>q.waitFor(i))}ai(e,n){const r=n.store("mutations"),i=kC(this.serializer),s=new NC(Mf.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var c;let d=(c=a.get(l.userId))!==null&&c!==void 0?c:we();Vs(this.serializer,l).keys().forEach(h=>d=d.add(h)),a.set(l.userId,d)}),q.forEach(a,(l,c)=>{const d=new Kt(c),h=zf.lt(this.serializer,d),f=s.getIndexManager(d),m=Lf.lt(d,this.serializer,f,s.referenceDelegate);return new RC(i,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new bg(n,fn.oe),l).next()})})}}function A1(t){t.createObjectStore("targetDocuments",{keyPath:$9}).createIndex("documentTargetsIndex",U9,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",F9,{unique:!0}),t.createObjectStore("targetGlobal")}const Kp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class Uy{constructor(e,n,r,i,s,o,a,l,c,d,h=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=c,this.li=d,this.hi=h,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=f=>Promise.resolve(),!Uy.D())throw new ne(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new i$(this,i),this.Ai=n+"main",this.serializer=new wC(l),this.Ri=new ns(this.Ai,this.hi,new g$(this.serializer)),this.$r=new qF,this.Ur=new ZF(this.referenceDelegate,this.serializer),this.remoteDocumentCache=kC(this.serializer),this.Gr=new HF,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,d===!1&&pt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ne(Q.FAILED_PRECONDITION,Kp);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new fn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>md(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(ms(e))return J("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return J("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return jl(e).get("owner").next(n=>q.resolve(this.vi(n)))}Ci(e){return md(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Tt(n,"clientMetadata");return r.U().next(i=>{const s=this.xi(i,18e5),o=i.filter(a=>s.indexOf(a)===-1);return q.forEach(o,a=>r.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?q.resolve(!0):jl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new ne(Q.FAILED_PRECONDITION,Kp);return!1}}return!(!this.networkEnabled||!this.inForeground)||md(e).U().next(r=>this.xi(r,5e3).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,a=this.networkEnabled===i.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&J("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new bg(e,fn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(r=>this.Mi(r.updateTimeMs,n)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>md(e).U().next(n=>this.xi(n,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return Lf.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new JF(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return zf.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,r){J("IndexedDbPersistence","Starting transaction:",e);const i=n==="readonly"?"readonly":"readwrite",s=function(l){return l===17?Z9:l===16?J9:l===15?Ay:l===14?R2:l===13?k2:l===12?X9:l===11?A2:void ue()}(this.hi);let o;return this.Ri.runTransaction(e,i,s,a=>(o=new bg(a,this.Qr?this.Qr.next():fn.oe),n==="readwrite-primary"?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw pt(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ne(Q.FAILED_PRECONDITION,b2);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return jl(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ne(Q.FAILED_PRECONDITION,Kp)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return jl(e).put("owner",n)}static D(){return ns.D()}bi(e){const n=jl(e);return n.get("owner").next(r=>this.vi(r)?(J("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):q.resolve())}Mi(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(pt(`Detected an update time that is in the future: ${e} > ${r}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;TS()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const r=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return J("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return pt("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){pt("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function jl(t){return Tt(t,"owner")}function md(t){return Tt(t,"clientMetadata")}function PC(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,n,r,i){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=i}static Wi(e,n){let r=we(),i=we();for(const s of n.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new By(e,n.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y${constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return TS()?8:T2(It())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,i){const s={result:null};return this.Yi(e,n).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,n,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new y$;return this.Xi(e,n,o).next(a=>{if(s.result=a,this.zi)return this.es(e,n,o,a.size)})}).next(()=>s.result)}es(e,n,r,i){return r.documentReadCount<this.ji?(Bo()<=Te.DEBUG&&J("QueryEngine","SDK will not create cache indexes for query:",Ho(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),q.resolve()):(Bo()<=Te.DEBUG&&J("QueryEngine","Query:",Ho(n),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Bo()<=Te.DEBUG&&J("QueryEngine","The SDK decides to create cache indexes for query:",Ho(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Pn(n))):q.resolve())}Yi(e,n){if(e1(n))return q.resolve(null);let r=Pn(n);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(n.limit!==null&&i===1&&(n=Rg(n,null,"F"),r=Pn(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=we(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const c=this.ts(n,a);return this.ns(n,c,o,l.readTime)?this.Yi(e,Rg(n,null,"F")):this.rs(e,c,n,l)}))})))}Zi(e,n,r,i){return e1(n)||i.isEqual(pe.min())?q.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(n,s);return this.ns(n,o,r,i)?q.resolve(null):(Bo()<=Te.DEBUG&&J("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ho(n)),this.rs(e,o,n,x2(i,-1)).next(a=>a))})}ts(e,n){let r=new Ue(G2(e));return n.forEach((i,s)=>{vu(e,s)&&(r=r.add(s))}),r}ns(e,n,r,i){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const s=e.limitType==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,n,r){return Bo()<=Te.DEBUG&&J("QueryEngine","Using full collection scan to execute query:",Ho(n)),this.Ji.getDocumentsMatchingQuery(e,n,zn.min(),r)}rs(e,n,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(n.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v${constructor(e,n,r,i){this.persistence=e,this.ss=n,this.serializer=i,this.os=new Qe(ye),this._s=new gs(s=>lo(s),gu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new RC(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function VC(t,e,n,r){return new v$(t,e,n,r)}async function OC(t,e){const n=de(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let i;return n.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=we();for(const c of i){o.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}for(const c of s){a.push(c.batchId);for(const d of c.mutations)l=l.add(d.key)}return n.localDocuments.getDocuments(r,l).next(c=>({hs:c,removedBatchIds:o,addedBatchIds:a}))})})}function _$(t,e){const n=de(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=n.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,c,d){const h=c.batch,f=h.keys();let m=q.resolve();return f.forEach(b=>{m=m.next(()=>d.getEntry(l,b)).next(x=>{const R=c.docVersions.get(b);he(R!==null),x.version.compareTo(R)<0&&(h.applyToRemoteDocument(x,c),x.isValidDocument()&&(x.setReadTime(c.commitVersion),d.addEntry(x)))})}),m.next(()=>a.mutationQueue.removeMutationBatch(l,h))}(n,r,e,s).next(()=>s.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=we();for(let c=0;c<a.mutationResults.length;++c)a.mutationResults[c].transformResults.length>0&&(l=l.add(a.batch.mutations[c].key));return l}(e))).next(()=>n.localDocuments.getDocuments(r,i))})}function zC(t){const e=de(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function w$(t,e){const n=de(t),r=e.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];e.targetChanges.forEach((d,h)=>{const f=i.get(h);if(!f)return;a.push(n.Ur.removeMatchingKeys(s,d.removedDocuments,h).next(()=>n.Ur.addMatchingKeys(s,d.addedDocuments,h)));let m=f.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(mt.EMPTY_BYTE_STRING,pe.min()).withLastLimboFreeSnapshotVersion(pe.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),i=i.insert(h,m),function(x,R,y){return x.resumeToken.approximateByteSize()===0||R.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(f,m,d)&&a.push(n.Ur.updateTargetData(s,m))});let l=Rn(),c=we();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(x$(s,o,e.documentUpdates).next(d=>{l=d.Ps,c=d.Is})),!r.isEqual(pe.min())){const d=n.Ur.getLastRemoteSnapshotVersion(s).next(h=>n.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return q.waitFor(a).next(()=>o.apply(s)).next(()=>n.localDocuments.getLocalViewOfDocuments(s,l,c)).next(()=>l)}).then(s=>(n.os=i,s))}function x$(t,e,n){let r=we(),i=we();return n.forEach(s=>r=r.add(s)),e.getEntries(t,r).next(s=>{let o=Rn();return n.forEach((a,l)=>{const c=s.get(a);l.isFoundDocument()!==c.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(pe.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!c.isValidDocument()||l.version.compareTo(c.version)>0||l.version.compareTo(c.version)===0&&c.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):J("LocalStore","Ignoring outdated watch update for ",a,". Current version:",c.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function E$(t,e){const n=de(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function Hh(t,e){const n=de(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return n.Ur.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):n.Ur.allocateTargetId(r).next(o=>(i=new ti(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=n.os.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Ua(t,e,n){const r=de(t),i=r.os.get(e),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ms(o))throw o;J("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)}function Mg(t,e,n){const r=de(t);let i=pe.min(),s=we();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,c,d){const h=de(l),f=h._s.get(d);return f!==void 0?q.resolve(h.os.get(f)):h.Ur.getTargetData(c,d)}(r,o,Pn(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?i:pe.min(),n?s:we())).next(a=>(jC(r,K2(e),a),{documents:a,Ts:s})))}function LC(t,e){const n=de(t),r=de(n.Ur),i=n.os.get(e);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function MC(t,e){const n=de(t),r=n.us.get(e)||pe.min();return n.persistence.runTransaction("Get new document changes","readonly",i=>n.cs.getAllFromCollectionGroup(i,e,x2(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(jC(n,e,i),i))}function jC(t,e,n){let r=t.us.get(e)||pe.min();n.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),t.us.set(e,r)}function k1(t,e){return`firestore_clients_${t}_${e}`}function R1(t,e,n){let r=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function Gp(t,e){return`firestore_targets_${t}_${e}`}class qh{constructor(e,n,r,i){this.user=e,this.batchId=n,this.state=r,this.error=i}static Rs(e,n,r){const i=JSON.parse(r);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new ne(i.error.code,i.error.message))),o?new qh(e,n,i.state,s):(pt("SharedClientState",`Failed to parse mutation state for ID '${n}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class mc{constructor(e,n,r){this.targetId=e,this.state=n,this.error=r}static Rs(e,n){const r=JSON.parse(n);let i,s=typeof r=="object"&&["not-current","current","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return s&&r.error&&(s=typeof r.error.message=="string"&&typeof r.error.code=="string",s&&(i=new ne(r.error.code,r.error.message))),s?new mc(e,r.state,i):(pt("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Kh{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const r=JSON.parse(n);let i=typeof r=="object"&&r.activeTargetIds instanceof Array,s=Py();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=S2(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Kh(e,s):(pt("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class Hy{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new Hy(n.clientId,n.onlineState):(pt("SharedClientState",`Failed to parse online state: ${e}`),null)}}class jg{constructor(){this.activeTargetIds=Py()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Wp{constructor(e,n,r,i,s){this.window=e,this.ui=n,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Qe(ye),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=k1(this.persistenceKey,this.ps),this.vs=function(l){return`firestore_sequence_number_${l}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new jg),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(l){return`firestore_online_state_${l}`}(this.persistenceKey),this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const r of e){if(r===this.ps)continue;const i=this.getItem(k1(this.persistenceKey,r));if(i){const s=Kh.Rs(r,i);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const r=this.Ls(n);r&&this.Bs(r)}for(const r of this.bs)this.ws(r);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,r){this.qs(e,n,r),this.Qs(e)}addLocalQueryTarget(e,n=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Gp(this.persistenceKey,e));if(i){const s=mc.Rs(e,i);s&&(r=s.state)}}return n&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Gp(this.persistenceKey,e))}updateQueryState(e,n,r){this.$s(e,n,r)}handleUserChange(e,n,r){n.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return J("SharedClientState","READ",e,n),n}setItem(e,n){J("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){J("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(J("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void pt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const r=this.Gs(n.key);return this.zs(r,null)}{const r=this.js(n.key,n.newValue);if(r)return this.zs(r.clientId,r)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const r=this.Hs(n.key,n.newValue);if(r)return this.Js(r)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const r=this.Ys(n.key,n.newValue);if(r)return this.Zs(r)}}else if(n.key===this.xs){if(n.newValue!==null){const r=this.Ls(n.newValue);if(r)return this.Bs(r)}}else if(n.key===this.vs){const r=function(s){let o=fn.oe;if(s!=null)try{const a=JSON.parse(s);he(typeof a=="number"),o=a}catch(a){pt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(n.newValue);r!==fn.oe&&this.sequenceNumberHandler(r)}else if(n.key===this.Os){const r=this.Xs(n.newValue);await Promise.all(r.map(i=>this.syncEngine.eo(i)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,r){const i=new qh(this.currentUser,e,n,r),s=R1(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const n=R1(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,r){const i=Gp(this.persistenceKey,e),s=new mc(e,n,r);this.setItem(i,s.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const r=this.Gs(e);return Kh.Rs(r,n)}Hs(e,n){const r=this.Fs.exec(e),i=Number(r[1]),s=r[2]!==void 0?r[2]:null;return qh.Rs(new Kt(s),i,n)}Ys(e,n){const r=this.Ms.exec(e),i=Number(r[1]);return mc.Rs(i,n)}Ls(e){return Hy.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);J("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const r=n?this.Ss.insert(e,n):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=Py();return e.forEach((r,i)=>{n=n.unionWith(i.activeTargetIds)}),n}}class FC{constructor(){this.so=new jg,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new jg,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b${_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N1{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){J("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){J("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let gd=null;function Qp(){return gd===null?gd=function(){return 268435456+Math.round(2147483648*Math.random())}():gd++,"0x"+gd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I$={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T${constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qt="WebChannelConnection";class S$ extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${i}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(n,r,i,s,o){const a=Qp(),l=this.xo(n,r.toUriEncodedString());J("RestConnection",`Sending RPC '${n}' ${a}:`,l,i);const c={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(c,s,o),this.No(n,l,c,i).then(d=>(J("RestConnection",`Received RPC '${n}' ${a}: `,d),d),d=>{throw Kc("RestConnection",`RPC '${n}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(n,r,i,s,o,a){return this.Mo(n,r,i,s,o)}Oo(n,r,i){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+rl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>n[o]=s),i&&i.headers.forEach((s,o)=>n[o]=s)}xo(n,r){const i=I$[n];return`${this.Do}/v1/${r}:${i}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,i){const s=Qp();return new Promise((o,a)=>{const l=new p2;l.setWithCredentials(!0),l.listenOnce(m2.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Md.NO_ERROR:const d=l.getResponseJson();J(qt,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case Md.TIMEOUT:J(qt,`RPC '${e}' ${s} timed out`),a(new ne(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Md.HTTP_ERROR:const h=l.getStatus();if(J(qt,`RPC '${e}' ${s} failed with status:`,h,"response text:",l.getResponseText()),h>0){let f=l.getResponseJson();Array.isArray(f)&&(f=f[0]);const m=f==null?void 0:f.error;if(m&&m.status&&m.message){const b=function(R){const y=R.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(y)>=0?y:Q.UNKNOWN}(m.status);a(new ne(b,m.message))}else a(new ne(Q.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ne(Q.UNAVAILABLE,"Connection failed."));break;default:ue()}}finally{J(qt,`RPC '${e}' ${s} completed.`)}});const c=JSON.stringify(i);J(qt,`RPC '${e}' ${s} sending request:`,i),l.send(n,"POST",c,r,15)})}Bo(e,n,r){const i=Qp(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=v2(),a=y2(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;c!==void 0&&(l.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,n,r),l.encodeInitMessageHeaders=!0;const d=s.join("");J(qt,`Creating RPC '${e}' stream ${i}: ${d}`,l);const h=o.createWebChannel(d,l);let f=!1,m=!1;const b=new T$({Io:R=>{m?J(qt,`Not sending because RPC '${e}' stream ${i} is closed:`,R):(f||(J(qt,`Opening RPC '${e}' stream ${i} transport.`),h.open(),f=!0),J(qt,`RPC '${e}' stream ${i} sending:`,R),h.send(R))},To:()=>h.close()}),x=(R,y,v)=>{R.listen(y,T=>{try{v(T)}catch(A){setTimeout(()=>{throw A},0)}})};return x(h,Ql.EventType.OPEN,()=>{m||(J(qt,`RPC '${e}' stream ${i} transport opened.`),b.yo())}),x(h,Ql.EventType.CLOSE,()=>{m||(m=!0,J(qt,`RPC '${e}' stream ${i} transport closed`),b.So())}),x(h,Ql.EventType.ERROR,R=>{m||(m=!0,Kc(qt,`RPC '${e}' stream ${i} transport errored:`,R),b.So(new ne(Q.UNAVAILABLE,"The operation could not be completed")))}),x(h,Ql.EventType.MESSAGE,R=>{var y;if(!m){const v=R.data[0];he(!!v);const T=v,A=T.error||((y=T[0])===null||y===void 0?void 0:y.error);if(A){J(qt,`RPC '${e}' stream ${i} received error:`,A);const O=A.status;let L=function(w){const E=vt[w];if(E!==void 0)return oC(E)}(O),S=A.message;L===void 0&&(L=Q.INTERNAL,S="Unknown error status: "+O+" with message "+A.message),m=!0,b.So(new ne(L,S)),h.close()}else J(qt,`RPC '${e}' stream ${i} received:`,v),b.bo(v)}}),x(a,g2.STAT_EVENT,R=>{R.stat===xg.PROXY?J(qt,`RPC '${e}' stream ${i} detected buffering proxy`):R.stat===xg.NOPROXY&&J(qt,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{b.wo()},0),b}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $C(){return typeof window<"u"?window:null}function qd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jf(t){return new DF(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UC{constructor(e,n,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,n-r);i>0&&J("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BC{constructor(e,n,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new UC(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Q.RESOURCE_EXHAUSTED?(pt(n.toString()),pt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===n&&this.P_(r,i)},r=>{e(()=>{const i=new ne(Q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>++this.e_==1?this.E_(i):this.onNext(i))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return J("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(J("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class C$ extends BC{constructor(e,n,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=zF(this.serializer,e),r=function(s){if(!("targetChange"in s))return pe.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?pe.min():o.readTime?tn(o.readTime):pe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Dg(this.serializer),n.addTarget=function(s,o){let a;const l=o.target;if(a=Lh(l)?{documents:pC(s,l)}:{query:mC(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=cC(s,o.resumeToken);const c=Ng(s,o.expectedCount);c!==null&&(a.expectedCount=c)}else if(o.snapshotVersion.compareTo(pe.min())>0){a.readTime=$a(s,o.snapshotVersion.toTimestamp());const c=Ng(s,o.expectedCount);c!==null&&(a.expectedCount=c)}return a}(this.serializer,e);const r=MF(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Dg(this.serializer),n.removeTarget=e,this.a_(n)}}class A$ extends BC{constructor(e,n,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return he(!!e.streamToken),this.lastStreamToken=e.streamToken,he(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){he(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=LF(e.writeResults,e.commitTime),r=tn(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Dg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Fh(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k$ extends class{}{constructor(e,n,r,i){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ne(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,Pg(n,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ne(Q.UNKNOWN,s.toString())})}Lo(e,n,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,Pg(n,r),i,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ne(Q.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class R${constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(pt(n),this.D_=!1):J("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N${constructor(e,n,r,i,s){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{r.enqueueAndForget(async()=>{wo(this)&&(J("RemoteStore","Restarting streams for network reachability change."),await async function(l){const c=de(l);c.L_.add(4),await xu(c),c.q_.set("Unknown"),c.L_.delete(4),await Ff(c)}(this))})}),this.q_=new R$(r,i)}}async function Ff(t){if(wo(t))for(const e of t.B_)await e(!0)}async function xu(t){for(const e of t.B_)await e(!1)}function $f(t,e){const n=de(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Gy(n)?Ky(n):al(n).r_()&&qy(n,e))}function Ba(t,e){const n=de(t),r=al(n);n.N_.delete(e),r.r_()&&HC(n,e),n.N_.size===0&&(r.r_()?r.o_():wo(n)&&n.q_.set("Unknown"))}function qy(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(pe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}al(t).A_(e)}function HC(t,e){t.Q_.xe(e),al(t).R_(e)}function Ky(t){t.Q_=new kF({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),al(t).start(),t.q_.v_()}function Gy(t){return wo(t)&&!al(t).n_()&&t.N_.size>0}function wo(t){return de(t).L_.size===0}function qC(t){t.Q_=void 0}async function P$(t){t.q_.set("Online")}async function D$(t){t.N_.forEach((e,n)=>{qy(t,e)})}async function V$(t,e){qC(t),Gy(t)?(t.q_.M_(e),Ky(t)):t.q_.set("Unknown")}async function O$(t,e,n){if(t.q_.set("Online"),e instanceof lC&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const a of s.targetIds)i.N_.has(a)&&(await i.remoteSyncer.rejectListen(a,o),i.N_.delete(a),i.Q_.removeTarget(a))}(t,e)}catch(r){J("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Gh(t,r)}else if(e instanceof Hd?t.Q_.Ke(e):e instanceof aC?t.Q_.He(e):t.Q_.We(e),!n.isEqual(pe.min()))try{const r=await zC(t.localStore);n.compareTo(r)>=0&&await function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,c)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(c);d&&s.N_.set(c,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,c)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(mt.EMPTY_BYTE_STRING,d.snapshotVersion)),HC(s,l);const h=new ti(d.target,l,c,d.sequenceNumber);qy(s,h)}),s.remoteSyncer.applyRemoteEvent(a)}(t,n)}catch(r){J("RemoteStore","Failed to raise snapshot:",r),await Gh(t,r)}}async function Gh(t,e,n){if(!ms(e))throw e;t.L_.add(1),await xu(t),t.q_.set("Offline"),n||(n=()=>zC(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{J("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Ff(t)})}function KC(t,e){return e().catch(n=>Gh(t,n,e))}async function ol(t){const e=de(t),n=cs(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;z$(e);)try{const i=await E$(e.localStore,r);if(i===null){e.O_.length===0&&n.o_();break}r=i.batchId,L$(e,i)}catch(i){await Gh(e,i)}GC(e)&&WC(e)}function z$(t){return wo(t)&&t.O_.length<10}function L$(t,e){t.O_.push(e);const n=cs(t);n.r_()&&n.V_&&n.m_(e.mutations)}function GC(t){return wo(t)&&!cs(t).n_()&&t.O_.length>0}function WC(t){cs(t).start()}async function M$(t){cs(t).p_()}async function j$(t){const e=cs(t);for(const n of t.O_)e.m_(n.mutations)}async function F$(t,e,n){const r=t.O_.shift(),i=Oy.from(r,e,n);await KC(t,()=>t.remoteSyncer.applySuccessfulWrite(i)),await ol(t)}async function $$(t,e){e&&cs(t).V_&&await async function(r,i){if(function(o){return SF(o)&&o!==Q.ABORTED}(i.code)){const s=r.O_.shift();cs(r).s_(),await KC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await ol(r)}}(t,e),GC(t)&&WC(t)}async function P1(t,e){const n=de(t);n.asyncQueue.verifyOperationInProgress(),J("RemoteStore","RemoteStore received new credentials");const r=wo(n);n.L_.add(3),await xu(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Ff(n)}async function Fg(t,e){const n=de(t);e?(n.L_.delete(2),await Ff(n)):e||(n.L_.add(2),await xu(n),n.q_.set("Unknown"))}function al(t){return t.K_||(t.K_=function(n,r,i){const s=de(n);return s.w_(),new C$(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:P$.bind(null,t),Ro:D$.bind(null,t),mo:V$.bind(null,t),d_:O$.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Gy(t)?Ky(t):t.q_.set("Unknown")):(await t.K_.stop(),qC(t))})),t.K_}function cs(t){return t.U_||(t.U_=function(n,r,i){const s=de(n);return s.w_(),new A$(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:M$.bind(null,t),mo:$$.bind(null,t),f_:j$.bind(null,t),g_:F$.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await ol(t)):(await t.U_.stop(),t.O_.length>0&&(J("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wy{constructor(e,n,r,i,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Dr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,i,s){const o=Date.now()+r,a=new Wy(e,n,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ne(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Qy(t,e){if(pt("AsyncQueue",`${e}: ${t}`),ms(t))return new ne(Q.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e){this.comparator=e?(n,r)=>e(n,r)||se.comparator(n.key,r.key):(n,r)=>se.comparator(n.key,r.key),this.keyedMap=Yl(),this.sortedSet=new Qe(this.comparator)}static emptySet(e){return new wa(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof wa)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const i=n.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new wa;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D1{constructor(){this.W_=new Qe(se.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):ue():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ha{constructor(e,n,r,i,s,o,a,l,c){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=c}static fromInitialDocuments(e,n,r,i,s){const o=[];return n.forEach(a=>{o.push({type:0,doc:a})}),new Ha(e,n,wa.emptySet(n),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Pf(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let i=0;i<n.length;i++)if(n[i].type!==r[i].type||!n[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U${constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class B${constructor(){this.queries=V1(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const i=de(n),s=i.queries;i.queries=V1(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})})(this,new ne(Q.ABORTED,"Firestore shutting down"))}}function V1(){return new gs(t=>q2(t),Pf)}async function QC(t,e){const n=de(t);let r=3;const i=e.query;let s=n.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new U$,r=e.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(o){const a=Qy(o,`Initialization of query '${Ho(e.query)}' failed`);return void e.onError(a)}n.queries.set(i,s),s.j_.push(e),e.Z_(n.onlineState),s.z_&&e.X_(s.z_)&&Yy(n)}async function YC(t,e){const n=de(t),r=e.query;let i=3;const s=n.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),s.j_.length===0?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function H$(t,e){const n=de(t);let r=!1;for(const i of e){const s=i.query,o=n.queries.get(s);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&Yy(n)}function q$(t,e,n){const r=de(t),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(e)}function Yy(t){t.Y_.forEach(e=>{e.next()})}var $g,O1;(O1=$g||($g={})).ea="default",O1.Cache="cache";class XC{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Ha(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ha.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==$g.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JC{constructor(e){this.key=e}}class ZC{constructor(e){this.key=e}}class K${constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=we(),this.mutatedKeys=we(),this.Aa=G2(e),this.Ra=new wa(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new D1,i=n?n.Ra:this.Ra;let s=n?n.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,c=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,h)=>{const f=i.get(d),m=vu(this.query,h)?h:null,b=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let R=!1;f&&m?f.data.isEqual(m.data)?b!==x&&(r.track({type:3,doc:m}),R=!0):this.ga(f,m)||(r.track({type:2,doc:m}),R=!0,(l&&this.Aa(m,l)>0||c&&this.Aa(m,c)<0)&&(a=!0)):!f&&m?(r.track({type:0,doc:m}),R=!0):f&&!m&&(r.track({type:1,doc:f}),R=!0,(l||c)&&(a=!0)),R&&(m?(o=o.add(m),s=x?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,h)=>function(m,b){const x=R=>{switch(R){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ue()}};return x(m)-x(b)}(d.type,h.type)||this.Aa(d.doc,h.doc)),this.pa(r),i=i!=null&&i;const a=n&&!i?this.ya():[],l=this.da.size===0&&this.current&&!i?1:0,c=l!==this.Ea;return this.Ea=l,o.length!==0||c?{snapshot:new Ha(this.query,e.Ra,s,o,e.mutatedKeys,l===0,c,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new D1,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=we(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new ZC(r))}),this.da.forEach(r=>{e.has(r)||n.push(new JC(r))}),n}ba(e){this.Ta=e.Ts,this.da=we();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ha.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class G${constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class W${constructor(e){this.key=e,this.va=!1}}class Q${constructor(e,n,r,i,s,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new gs(a=>q2(a),Pf),this.Ma=new Map,this.xa=new Set,this.Oa=new Qe(se.comparator),this.Na=new Map,this.La=new $y,this.Ba={},this.ka=new Map,this.qa=ho.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function Y$(t,e,n=!0){const r=Uf(t);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await eA(r,e,n,!0),i}async function X$(t,e){const n=Uf(t);await eA(n,e,!0,!1)}async function eA(t,e,n,r){const i=await Hh(t.localStore,Pn(e)),s=i.targetId,o=t.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Xy(t,e,s,o==="current",i.resumeToken)),t.isPrimaryClient&&n&&$f(t.remoteStore,i),a}async function Xy(t,e,n,r,i){t.Ka=(h,f,m)=>async function(x,R,y,v){let T=R.view.ma(y);T.ns&&(T=await Mg(x.localStore,R.query,!1).then(({documents:S})=>R.view.ma(S,T)));const A=v&&v.targetChanges.get(R.targetId),O=v&&v.targetMismatches.get(R.targetId)!=null,L=R.view.applyChanges(T,x.isPrimaryClient,A,O);return Ug(x,R.targetId,L.wa),L.snapshot}(t,h,f,m);const s=await Mg(t.localStore,e,!0),o=new K$(e,s.Ts),a=o.ma(s.documents),l=wu.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",i),c=o.applyChanges(a,t.isPrimaryClient,l);Ug(t,n,c.wa);const d=new G$(e,n,o);return t.Fa.set(e,d),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),c.snapshot}async function J$(t,e,n){const r=de(t),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Pf(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Ua(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Ba(r.remoteStore,i.targetId),qa(r,i.targetId)}).catch(ps)):(qa(r,i.targetId),await Ua(r.localStore,i.targetId,!0))}async function Z$(t,e){const n=de(t),r=n.Fa.get(e),i=n.Ma.get(r.targetId);n.isPrimaryClient&&i.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ba(n.remoteStore,r.targetId))}async function eU(t,e,n){const r=tv(t);try{const i=await function(o,a){const l=de(o),c=at.now(),d=a.reduce((m,b)=>m.add(b.key),we());let h,f;return l.persistence.runTransaction("Locally write mutations","readwrite",m=>{let b=Rn(),x=we();return l.cs.getEntries(m,d).next(R=>{b=R,b.forEach((y,v)=>{v.isValidDocument()||(x=x.add(y))})}).next(()=>l.localDocuments.getOverlayedDocuments(m,b)).next(R=>{h=R;const y=[];for(const v of a){const T=IF(v,h.get(v.key).overlayedDocument);T!=null&&y.push(new ys(v.key,T,O2(T.value.mapValue),pn.exists(!0)))}return l.mutationQueue.addMutationBatch(m,c,y,a)}).next(R=>{f=R;const y=R.applyToLocalDocumentSet(h,x);return l.documentOverlayCache.saveOverlays(m,R.batchId,y)})}).then(()=>({batchId:f.batchId,changes:Q2(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let c=o.Ba[o.currentUser.toKey()];c||(c=new Qe(ye)),c=c.insert(a,l),o.Ba[o.currentUser.toKey()]=c}(r,i.batchId,n),await vs(r,i.changes),await ol(r.remoteStore)}catch(i){const s=Qy(i,"Failed to persist write");n.reject(s)}}async function tA(t,e){const n=de(t);try{const r=await w$(n.localStore,e);e.targetChanges.forEach((i,s)=>{const o=n.Na.get(s);o&&(he(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?he(o.va):i.removedDocuments.size>0&&(he(o.va),o.va=!1))}),await vs(n,r,e)}catch(r){await ps(r)}}function z1(t,e,n){const r=de(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=de(o);l.onlineState=a;let c=!1;l.queries.forEach((d,h)=>{for(const f of h.j_)f.Z_(a)&&(c=!0)}),c&&Yy(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function tU(t,e,n){const r=de(t);r.sharedClientState.updateQueryState(e,"rejected",n);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Qe(se.comparator);o=o.insert(s,dt.newNoDocument(s,pe.min()));const a=we().add(s),l=new _u(pe.min(),new Map,new Qe(ye),o,a);await tA(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),ev(r)}else await Ua(r.localStore,e,!1).then(()=>qa(r,e,n)).catch(ps)}async function nU(t,e){const n=de(t),r=e.batch.batchId;try{const i=await _$(n.localStore,e);Zy(n,r,null),Jy(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await vs(n,i)}catch(i){await ps(i)}}async function rU(t,e,n){const r=de(t);try{const i=await function(o,a){const l=de(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",c=>{let d;return l.mutationQueue.lookupMutationBatch(c,a).next(h=>(he(h!==null),d=h.keys(),l.mutationQueue.removeMutationBatch(c,h))).next(()=>l.mutationQueue.performConsistencyCheck(c)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(c,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(c,d)).next(()=>l.localDocuments.getDocuments(c,d))})}(r.localStore,e);Zy(r,e,n),Jy(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await vs(r,i)}catch(i){await ps(i)}}function Jy(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Zy(t,e,n){const r=de(t);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(n?s.reject(n):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function qa(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||nA(t,r)})}function nA(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Ba(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),ev(t))}function Ug(t,e,n){for(const r of n)r instanceof JC?(t.La.addReference(r.key,e),iU(t,r)):r instanceof ZC?(J("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||nA(t,r.key)):ue()}function iU(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(J("SyncEngine","New document in limbo: "+n),t.xa.add(r),ev(t))}function ev(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new se(je.fromString(e)),r=t.qa.next();t.Na.set(r,new W$(n)),t.Oa=t.Oa.insert(n,r),$f(t.remoteStore,new ti(Pn(Nf(n.path)),r,"TargetPurposeLimboResolution",fn.oe))}}async function vs(t,e,n){const r=de(t),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,n).then(c=>{var d;if((c||n)&&r.isPrimaryClient){const h=c?!c.fromCache:(d=n==null?void 0:n.targetChanges.get(l.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,h?"current":"not-current")}if(c){i.push(c);const h=By.Wi(l.targetId,c);s.push(h)}}))}),await Promise.all(o),r.Ca.d_(i),await async function(l,c){const d=de(l);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>q.forEach(c,f=>q.forEach(f.$i,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>q.forEach(f.Ui,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!ms(h))throw h;J("LocalStore","Failed to update sequence numbers: "+h)}for(const h of c){const f=h.targetId;if(!h.fromCache){const m=d.os.get(f),b=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(b);d.os=d.os.insert(f,x)}}}(r.localStore,s))}async function sU(t,e){const n=de(t);if(!n.currentUser.isEqual(e)){J("SyncEngine","User change. New user:",e.toKey());const r=await OC(n.localStore,e);n.currentUser=e,function(s,o){s.ka.forEach(a=>{a.forEach(l=>{l.reject(new ne(Q.CANCELLED,o))})}),s.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await vs(n,r.hs)}}function oU(t,e){const n=de(t),r=n.Na.get(e);if(r&&r.va)return we().add(r.key);{let i=we();const s=n.Ma.get(e);if(!s)return i;for(const o of s){const a=n.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}async function aU(t,e){const n=de(t),r=await Mg(n.localStore,e.query,!0),i=e.view.ba(r);return n.isPrimaryClient&&Ug(n,e.targetId,i.wa),i}async function lU(t,e){const n=de(t);return MC(n.localStore,e).then(r=>vs(n,r))}async function cU(t,e,n,r){const i=de(t),s=await function(a,l){const c=de(a),d=de(c.mutationQueue);return c.persistence.runTransaction("Lookup mutation documents","readonly",h=>d.Mn(h,l).next(f=>f?c.localDocuments.getDocuments(h,f):q.resolve(null)))}(i.localStore,e);s!==null?(n==="pending"?await ol(i.remoteStore):n==="acknowledged"||n==="rejected"?(Zy(i,e,r||null),Jy(i,e),function(a,l){de(de(a).mutationQueue).On(l)}(i.localStore,e)):ue(),await vs(i,s)):J("SyncEngine","Cannot apply mutation batch with id: "+e)}async function uU(t,e){const n=de(t);if(Uf(n),tv(n),e===!0&&n.Qa!==!0){const r=n.sharedClientState.getAllActiveQueryTargets(),i=await L1(n,r.toArray());n.Qa=!0,await Fg(n.remoteStore,!0);for(const s of i)$f(n.remoteStore,s)}else if(e===!1&&n.Qa!==!1){const r=[];let i=Promise.resolve();n.Ma.forEach((s,o)=>{n.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(qa(n,o),Ua(n.localStore,o,!0))),Ba(n.remoteStore,o)}),await i,await L1(n,r),function(o){const a=de(o);a.Na.forEach((l,c)=>{Ba(a.remoteStore,c)}),a.La.pr(),a.Na=new Map,a.Oa=new Qe(se.comparator)}(n),n.Qa=!1,await Fg(n.remoteStore,!1)}}async function L1(t,e,n){const r=de(t),i=[],s=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&l.length!==0){a=await Hh(r.localStore,Pn(l[0]));for(const c of l){const d=r.Fa.get(c),h=await aU(r,d);h.snapshot&&s.push(h.snapshot)}}else{const c=await LC(r.localStore,o);a=await Hh(r.localStore,c),await Xy(r,rA(c),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i}function rA(t){return B2(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function dU(t){return function(n){return de(de(n).persistence).Qi()}(de(t).localStore)}async function hU(t,e,n,r){const i=de(t);if(i.Qa)return void J("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(n){case"current":case"not-current":{const o=await MC(i.localStore,K2(s[0])),a=_u.createSynthesizedRemoteEventForCurrentChange(e,n==="current",mt.EMPTY_BYTE_STRING);await vs(i,o,a);break}case"rejected":await Ua(i.localStore,e,!0),qa(i,e,r);break;default:ue()}}async function fU(t,e,n){const r=Uf(t);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){J("SyncEngine","Adding an already active target "+i);continue}const s=await LC(r.localStore,i),o=await Hh(r.localStore,s);await Xy(r,rA(s),o.targetId,!1,o.resumeToken),$f(r.remoteStore,o)}for(const i of n)r.Ma.has(i)&&await Ua(r.localStore,i,!1).then(()=>{Ba(r.remoteStore,i),qa(r,i)}).catch(ps)}}function Uf(t){const e=de(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tA.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oU.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=tU.bind(null,e),e.Ca.d_=H$.bind(null,e.eventManager),e.Ca.$a=q$.bind(null,e.eventManager),e}function tv(t){const e=de(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=nU.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=rU.bind(null,e),e}class tu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=jf(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return VC(this.persistence,new DC,e.initialUser,this.serializer)}Ga(e){return new NC(Mf.Zr,this.serializer)}Wa(e){return new FC}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}tu.provider={build:()=>new tu};class iA extends tu{constructor(e,n,r){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await tv(this.Ja.syncEngine),await ol(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return VC(this.persistence,new DC,e.initialUser,this.serializer)}ja(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new t$(r,e.asyncQueue,n)}Ha(e,n){const r=new V9(n,this.persistence);return new D9(e.asyncQueue,r)}Ga(e){const n=PC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?ln.withCacheSize(this.cacheSizeBytes):ln.DEFAULT;return new Uy(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,$C(),qd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new FC}}class pU extends iA{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof Wp&&(this.sharedClientState.syncEngine={no:cU.bind(null,n),ro:hU.bind(null,n),io:fU.bind(null,n),Qi:dU.bind(null,n),eo:lU.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async r=>{await uU(this.Ja.syncEngine,r),this.gcScheduler&&(r&&!this.gcScheduler.started?this.gcScheduler.start():r||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(r&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():r||this.indexBackfillerScheduler.stop())})}Wa(e){const n=$C();if(!Wp.D(n))throw new ne(Q.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=PC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Wp(n,e.asyncQueue,r,e.clientId,e.initialUser)}}class nu{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>z1(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=sU.bind(null,this.syncEngine),await Fg(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new B$}()}createDatastore(e){const n=jf(e.databaseInfo.databaseId),r=function(s){return new S$(s)}(e.databaseInfo);return function(s,o,a,l){return new k$(s,o,a,l)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,i,s,o,a){return new N$(r,i,s,o,a)}(this.localStore,this.datastore,e.asyncQueue,n=>z1(this.syncEngine,n,0),function(){return N1.D()?new N1:new b$}())}createSyncEngine(e,n){return function(i,s,o,a,l,c,d){const h=new Q$(i,s,o,a,l,c);return d&&(h.Qa=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(i){const s=de(i);J("RemoteStore","RemoteStore shutting down."),s.L_.add(5),await xu(s),s.k_.shutdown(),s.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}nu.provider={build:()=>new nu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):pt("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mU{constructor(e,n,r,i,s){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=i,this.user=Kt.UNAUTHENTICATED,this.clientId=_2.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{J("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(J("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Dr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Qy(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Yp(t,e){t.asyncQueue.verifyOperationInProgress(),J("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async i=>{r.isEqual(i)||(await OC(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function M1(t,e){t.asyncQueue.verifyOperationInProgress();const n=await gU(t);J("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>P1(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,i)=>P1(e.remoteStore,i)),t._onlineComponents=e}async function gU(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){J("FirestoreClient","Using user provided OfflineComponentProvider");try{await Yp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(i){return i.name==="FirebaseError"?i.code===Q.FAILED_PRECONDITION||i.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(n))throw n;Kc("Error using user provided cache. Falling back to memory cache: "+n),await Yp(t,new tu)}}else J("FirestoreClient","Using default OfflineComponentProvider"),await Yp(t,new tu);return t._offlineComponents}async function oA(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(J("FirestoreClient","Using user provided OnlineComponentProvider"),await M1(t,t._uninitializedComponentsProvider._online)):(J("FirestoreClient","Using default OnlineComponentProvider"),await M1(t,new nu))),t._onlineComponents}function yU(t){return oA(t).then(e=>e.syncEngine)}async function aA(t){const e=await oA(t),n=e.eventManager;return n.onListen=Y$.bind(null,e.syncEngine),n.onUnlisten=J$.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=X$.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Z$.bind(null,e.syncEngine),n}function vU(t,e,n={}){const r=new Dr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new sA({next:f=>{d.Za(),o.enqueueAndForget(()=>YC(s,h));const m=f.docs.has(a);!m&&f.fromCache?c.reject(new ne(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&l&&l.source==="server"?c.reject(new ne(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new XC(Nf(a.path),d,{includeMetadataChanges:!0,_a:!0});return QC(s,h)}(await aA(t),t.asyncQueue,e,n,r)),r.promise}function _U(t,e,n={}){const r=new Dr;return t.asyncQueue.enqueueAndForget(async()=>function(s,o,a,l,c){const d=new sA({next:f=>{d.Za(),o.enqueueAndForget(()=>YC(s,h)),f.fromCache&&l.source==="server"?c.reject(new ne(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):c.resolve(f)},error:f=>c.reject(f)}),h=new XC(a,d,{includeMetadataChanges:!0,_a:!0});return QC(s,h)}(await aA(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lA(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j1=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cA(t,e,n){if(!n)throw new ne(Q.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function wU(t,e,n,r){if(e===!0&&r===!0)throw new ne(Q.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function F1(t){if(!se.isDocumentKey(t))throw new ne(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function $1(t){if(se.isDocumentKey(t))throw new ne(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Bf(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":ue()}function fo(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ne(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Bf(t);throw new ne(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U1{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ne(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ne(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}wU("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lA((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new ne(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ne(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ne(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class nv{constructor(e,n,r,i){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new U1({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ne(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ne(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new U1(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new b9;switch(r.type){case"firstParty":return new S9(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ne(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=j1.get(n);r&&(J("ComponentProvider","Removing Datastore"),j1.delete(n),r.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ll{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ll(this.firestore,e,this._query)}}class _n{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new _n(this.firestore,e,this._key)}}class rs extends ll{constructor(e,n,r){super(e,n,Nf(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new _n(this.firestore,null,new se(e))}withConverter(e){return new rs(this.firestore,e,this._path)}}function xU(t,e,...n){if(t=Dt(t),cA("collection","path",e),t instanceof nv){const r=je.fromString(e,...n);return $1(r),new rs(t,null,r)}{if(!(t instanceof _n||t instanceof rs))throw new ne(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return $1(r),new rs(t.firestore,null,r)}}function Xp(t,e,...n){if(t=Dt(t),arguments.length===1&&(e=_2.newId()),cA("doc","path",e),t instanceof nv){const r=je.fromString(e,...n);return F1(r),new _n(t,null,new se(r))}{if(!(t instanceof _n||t instanceof rs))throw new ne(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(je.fromString(e,...n));return F1(r),new _n(t.firestore,t instanceof rs?t.converter:null,new se(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new UC(this,"async_queue_retry"),this.Vu=()=>{const r=qd();r&&J("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=qd();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=qd();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Dr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ms(e))throw e;J("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const i=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(r);throw pt("INTERNAL UNHANDLED ERROR: ",i),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const i=Wy.createAndSchedule(this,e,n,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&ue()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class Eu extends nv{constructor(e,n,r,i){super(e,n,r,i),this.type="firestore",this._queue=new B1,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new B1(e),this._firestoreClient=void 0,await e}}}function EU(t,e,n){n||(n="(default)");const r=_o(t,"firestore");if(r.isInitialized(n)){const i=r.getImmediate({identifier:n}),s=r.getOptions(n);if(Pa(s,e))return i;throw new ne(Q.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ne(Q.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ne(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return r.initialize({options:e,instanceIdentifier:n})}function rv(t){if(t._terminated)throw new ne(Q.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||bU(t),t._firestoreClient}function bU(t){var e,n,r;const i=t._freezeSettings(),s=function(a,l,c,d){return new tF(a,l,c,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,lA(d.experimentalLongPollingOptions),d.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,i);t._componentsProvider||!((n=i.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),t._firestoreClient=new mU(t._authCredentials,t._appCheckCredentials,t._queue,s,t._componentsProvider&&function(a){const l=a==null?void 0:a._online.build();return{_offline:a==null?void 0:a._offline.build(l),_online:l}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ka(mt.fromBase64String(e))}catch(n){throw new ne(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Ka(mt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ne(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new st(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ov{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ne(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ne(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ye(this._lat,e._lat)||ye(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class av{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IU=/^__.*__$/;class TU{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ys(e,this.data,this.fieldMask,n,this.fieldTransforms):new sl(e,this.data,n,this.fieldTransforms)}}function uA(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ue()}}class lv{constructor(e,n,r,i,s,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new lv(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Wh(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(uA(this.Cu)&&IU.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class SU{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||jf(e)}Qu(e,n,r,i=!1){return new lv({Cu:e,methodName:n,qu:r,path:st.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function dA(t){const e=t._freezeSettings(),n=jf(t._databaseId);return new SU(t._databaseId,!!e.ignoreUndefinedProperties,n)}function CU(t,e,n,r,i,s={}){const o=t.Qu(s.merge||s.mergeFields?2:0,e,n,i);pA("Data must be an object, but it was:",o,r);const a=hA(r,o);let l,c;if(s.merge)l=new Gn(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const h of s.mergeFields){const f=kU(e,h,n);if(!o.contains(f))throw new ne(Q.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);NU(d,f)||d.push(f)}l=new Gn(d),c=o.fieldTransforms.filter(h=>l.covers(h.field))}else l=null,c=o.fieldTransforms;return new TU(new un(a),l,c)}class cv extends sv{_toFieldTransform(e){return new nC(e.path,new Ma)}isEqual(e){return e instanceof cv}}function AU(t,e,n,r=!1){return uv(n,t.Qu(r?4:3,e))}function uv(t,e){if(fA(t=Dt(t)))return pA("Unsupported field value:",e,t),hA(t,e);if(t instanceof sv)return function(r,i){if(!uA(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=uv(a,i.Lu(o));l==null&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(t,e)}return function(r,i){if((r=Dt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return vF(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=at.fromDate(r);return{timestampValue:$a(i.serializer,s)}}if(r instanceof at){const s=new at(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:$a(i.serializer,s)}}if(r instanceof ov)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Ka)return{bytesValue:cC(i.serializer,r._byteString)};if(r instanceof _n){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:My(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof av)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(l=>{if(typeof l!="number")throw a.Bu("VectorValues must only contain numeric values.");return Dy(a.serializer,l)})}}}}}}(r,i);throw i.Bu(`Unsupported field value: ${Bf(r)}`)}(t,e)}function hA(t,e){const n={};return N2(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):il(t,(r,i)=>{const s=uv(i,e.Mu(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function fA(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof at||t instanceof ov||t instanceof Ka||t instanceof _n||t instanceof sv||t instanceof av)}function pA(t,e,n){if(!fA(n)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(n)){const r=Bf(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function kU(t,e,n){if((e=Dt(e))instanceof iv)return e._internalPath;if(typeof e=="string")return mA(t,e);throw Wh("Field path arguments must be of type string or ",t,!1,void 0,n)}const RU=new RegExp("[~\\*/\\[\\]]");function mA(t,e,n){if(e.search(RU)>=0)throw Wh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new iv(...e.split("."))._internalPath}catch{throw Wh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Wh(t,e,n,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let a=`Function ${e}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ne(Q.INVALID_ARGUMENT,a+t+l)}function NU(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gA{constructor(e,n,r,i,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new _n(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new PU(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(yA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class PU extends gA{data(){return super.data()}}function yA(t,e){return typeof e=="string"?mA(t,e):e instanceof iv?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DU(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ne(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class dv{}class VU extends dv{}function OU(t,e,...n){let r=[];e instanceof dv&&r.push(e),r=r.concat(n),function(s){const o=s.filter(l=>l instanceof fv).length,a=s.filter(l=>l instanceof hv).length;if(o>1||o>0&&a>0)throw new ne(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)t=i._apply(t);return t}class hv extends VU{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new hv(e,n,r)}_apply(e){const n=this._parse(e);return vA(e._query,n),new ll(e.firestore,e.converter,kg(e._query,n))}_parse(e){const n=dA(e.firestore);return function(s,o,a,l,c,d,h){let f;if(c.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ne(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){q1(h,d);const m=[];for(const b of h)m.push(H1(l,s,b));f={arrayValue:{values:m}}}else f=H1(l,s,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||q1(h,d),f=AU(a,o,h,d==="in"||d==="not-in");return Se.create(c,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class fv extends dv{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new fv(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Fe.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)vA(o,l),o=kg(o,l)}(e._query,n),new ll(e.firestore,e.converter,kg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function H1(t,e,n){if(typeof(n=Dt(n))=="string"){if(n==="")throw new ne(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!H2(e)&&n.indexOf("/")!==-1)throw new ne(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(je.fromString(n));if(!se.isDocumentKey(r))throw new ne(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Jc(t,new se(r))}if(n instanceof _n)return Jc(t,n._key);throw new ne(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Bf(n)}.`)}function q1(t,e){if(!Array.isArray(t)||t.length===0)throw new ne(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vA(t,e){const n=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(t.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ne(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ne(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class zU{convertValue(e,n="none"){switch(ao(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(as(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw ue()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return il(e,(i,s)=>{r[i]=this.convertValue(s,n)}),r}convertVectorValue(e){var n,r,i;const s=(i=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>nt(o.doubleValue));return new av(s)}convertGeoPoint(e){return new ov(nt(e.latitude),nt(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Ry(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Yc(e));default:return null}}convertTimestamp(e){const n=fi(e);return new at(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=je.fromString(e);he(_C(r));const i=new oo(r.get(1),r.get(3)),s=new se(r.popFirst(5));return i.isEqual(n)||pt(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LU(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zl{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class _A extends gA{constructor(e,n,r,i,s,o){super(e,n,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Kd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(yA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Kd extends _A{data(e={}){return super.data(e)}}class MU{constructor(e,n,r,i){this._firestore=e,this._userDataWriter=n,this._snapshot=i,this.metadata=new Zl(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Kd(this._firestore,this._userDataWriter,r.key,r,new Zl(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ne(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>{const l=new Kd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);return a.doc,{type:"added",doc:l,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{const l=new Kd(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Zl(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let c=-1,d=-1;return a.type!==0&&(c=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:jU(a.type),doc:l,oldIndex:c,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function jU(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ue()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FU(t){t=fo(t,_n);const e=fo(t.firestore,Eu);return vU(rv(e),t._key).then(n=>HU(e,t,n))}class wA extends zU{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ka(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new _n(this.firestore,null,n)}}function $U(t){t=fo(t,ll);const e=fo(t.firestore,Eu),n=rv(e),r=new wA(e);return DU(t._query),_U(n,t._query).then(i=>new MU(e,r,t,i))}function UU(t,e,n){t=fo(t,_n);const r=fo(t.firestore,Eu),i=LU(t.converter,e,n);return xA(r,[CU(dA(r),"setDoc",t._key,i,t.converter!==null,n).toMutation(t._key,pn.none())])}function BU(t){return xA(fo(t.firestore,Eu),[new Of(t._key,pn.none())])}function xA(t,e){return function(r,i){const s=new Dr;return r.asyncQueue.enqueueAndForget(async()=>eU(await yU(r),i,s)),s.promise}(rv(t),e)}function HU(t,e,n){const r=n.docs.get(e._key),i=new wA(t);return new _A(t,i,e._key,r,new Zl(n.hasPendingWrites,n.fromCache),e.converter)}class qU{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=QU(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function KU(t){return new qU(t)}class GU{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=nu.provider,this._offlineComponentProvider={build:n=>new iA(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class WU{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=nu.provider,this._offlineComponentProvider={build:n=>new pU(n,e==null?void 0:e.cacheSizeBytes)}}}function QU(t){return new GU(void 0)}function YU(){return new WU}function XU(){return new cv("serverTimestamp")}(function(e,n=!0){(function(i){rl=i})(tl),Vr(new mr("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new Eu(new I9(r.getProvider("auth-internal")),new A9(r.getProvider("app-check-internal")),function(c,d){if(!Object.prototype.hasOwnProperty.apply(c.options,["projectId"]))throw new ne(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oo(c.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:n},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Qn(Mx,"4.7.3",e),Qn(Mx,"4.7.3","esm2017")})();const EA="@firebase/installations",pv="0.6.9";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bA=1e4,IA=`w:${pv}`,TA="FIS_v2",JU="https://firebaseinstallations.googleapis.com/v1",ZU=60*60*1e3,e8="installations",t8="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n8={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},po=new vo(e8,t8,n8);function SA(t){return t instanceof yr&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA({projectId:t}){return`${JU}/projects/${t}/installations`}function AA(t){return{token:t.token,requestStatus:2,expiresIn:i8(t.expiresIn),creationTime:Date.now()}}async function kA(t,e){const r=(await e.json()).error;return po.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function RA({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function r8(t,{refreshToken:e}){const n=RA(t);return n.append("Authorization",s8(e)),n}async function NA(t){const e=await t();return e.status>=500&&e.status<600?t():e}function i8(t){return Number(t.replace("s","000"))}function s8(t){return`${TA} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function o8({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=CA(t),i=RA(t),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={fid:n,authVersion:TA,appId:t.appId,sdkVersion:IA},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await NA(()=>fetch(r,a));if(l.ok){const c=await l.json();return{fid:c.fid||n,registrationStatus:2,refreshToken:c.refreshToken,authToken:AA(c.authToken)}}else throw await kA("Create Installation",l)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PA(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a8(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l8=/^[cdef][\w-]{21}$/,Bg="";function c8(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=u8(t);return l8.test(n)?n:Bg}catch{return Bg}}function u8(t){return a8(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hf(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DA=new Map;function VA(t,e){const n=Hf(t);OA(n,e),d8(n,e)}function OA(t,e){const n=DA.get(t);if(n)for(const r of n)r(e)}function d8(t,e){const n=h8();n&&n.postMessage({key:t,fid:e}),f8()}let Bs=null;function h8(){return!Bs&&"BroadcastChannel"in self&&(Bs=new BroadcastChannel("[Firebase] FID Change"),Bs.onmessage=t=>{OA(t.data.key,t.data.fid)}),Bs}function f8(){DA.size===0&&Bs&&(Bs.close(),Bs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p8="firebase-installations-database",m8=1,mo="firebase-installations-store";let Jp=null;function mv(){return Jp||(Jp=kS(p8,m8,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(mo)}}})),Jp}async function Qh(t,e){const n=Hf(t),i=(await mv()).transaction(mo,"readwrite"),s=i.objectStore(mo),o=await s.get(n);return await s.put(e,n),await i.done,(!o||o.fid!==e.fid)&&VA(t,e.fid),e}async function zA(t){const e=Hf(t),r=(await mv()).transaction(mo,"readwrite");await r.objectStore(mo).delete(e),await r.done}async function qf(t,e){const n=Hf(t),i=(await mv()).transaction(mo,"readwrite"),s=i.objectStore(mo),o=await s.get(n),a=e(o);return a===void 0?await s.delete(n):await s.put(a,n),await i.done,a&&(!o||o.fid!==a.fid)&&VA(t,a.fid),a}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gv(t){let e;const n=await qf(t.appConfig,r=>{const i=g8(r),s=y8(t,i);return e=s.registrationPromise,s.installationEntry});return n.fid===Bg?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function g8(t){const e=t||{fid:c8(),registrationStatus:0};return LA(e)}function y8(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const i=Promise.reject(po.create("app-offline"));return{installationEntry:e,registrationPromise:i}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=v8(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:_8(t)}:{installationEntry:e}}async function v8(t,e){try{const n=await o8(t,e);return Qh(t.appConfig,n)}catch(n){throw SA(n)&&n.customData.serverCode===409?await zA(t.appConfig):await Qh(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function _8(t){let e=await K1(t.appConfig);for(;e.registrationStatus===1;)await PA(100),e=await K1(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await gv(t);return r||n}return e}function K1(t){return qf(t,e=>{if(!e)throw po.create("installation-not-found");return LA(e)})}function LA(t){return w8(t)?{fid:t.fid,registrationStatus:0}:t}function w8(t){return t.registrationStatus===1&&t.registrationTime+bA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x8({appConfig:t,heartbeatServiceProvider:e},n){const r=E8(t,n),i=r8(t,n),s=e.getImmediate({optional:!0});if(s){const c=await s.getHeartbeatsHeader();c&&i.append("x-firebase-client",c)}const o={installation:{sdkVersion:IA,appId:t.appId}},a={method:"POST",headers:i,body:JSON.stringify(o)},l=await NA(()=>fetch(r,a));if(l.ok){const c=await l.json();return AA(c)}else throw await kA("Generate Auth Token",l)}function E8(t,{fid:e}){return`${CA(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yv(t,e=!1){let n;const r=await qf(t.appConfig,s=>{if(!MA(s))throw po.create("not-registered");const o=s.authToken;if(!e&&T8(o))return s;if(o.requestStatus===1)return n=b8(t,e),s;{if(!navigator.onLine)throw po.create("app-offline");const a=C8(s);return n=I8(t,a),a}});return n?await n:r.authToken}async function b8(t,e){let n=await G1(t.appConfig);for(;n.authToken.requestStatus===1;)await PA(100),n=await G1(t.appConfig);const r=n.authToken;return r.requestStatus===0?yv(t,e):r}function G1(t){return qf(t,e=>{if(!MA(e))throw po.create("not-registered");const n=e.authToken;return A8(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function I8(t,e){try{const n=await x8(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await Qh(t.appConfig,r),n}catch(n){if(SA(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await zA(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Qh(t.appConfig,r)}throw n}}function MA(t){return t!==void 0&&t.registrationStatus===2}function T8(t){return t.requestStatus===2&&!S8(t)}function S8(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+ZU}function C8(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function A8(t){return t.requestStatus===1&&t.requestTime+bA<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k8(t){const e=t,{installationEntry:n,registrationPromise:r}=await gv(e);return r?r.catch(console.error):yv(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function R8(t,e=!1){const n=t;return await N8(n),(await yv(n,e)).token}async function N8(t){const{registrationPromise:e}=await gv(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function P8(t){if(!t||!t.options)throw Zp("App Configuration");if(!t.name)throw Zp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw Zp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function Zp(t){return po.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jA="installations",D8="installations-internal",V8=t=>{const e=t.getProvider("app").getImmediate(),n=P8(e),r=_o(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},O8=t=>{const e=t.getProvider("app").getImmediate(),n=_o(e,jA).getImmediate();return{getId:()=>k8(n),getToken:i=>R8(n,i)}};function z8(){Vr(new mr(jA,V8,"PUBLIC")),Vr(new mr(D8,O8,"PRIVATE"))}z8();Qn(EA,pv);Qn(EA,pv,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh="analytics",L8="firebase_id",M8="origin",j8=60*1e3,F8="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",vv="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wn=new If("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $8={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Dn=new vo("analytics","Analytics",$8);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function U8(t){if(!t.startsWith(vv)){const e=Dn.create("invalid-gtag-resource",{gtagURL:t});return wn.warn(e.message),""}return t}function FA(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function B8(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function H8(t,e){const n=B8("firebase-js-sdk-policy",{createScriptURL:U8}),r=document.createElement("script"),i=`${vv}?l=${t}&id=${e}`;r.src=n?n==null?void 0:n.createScriptURL(i):i,r.async=!0,document.head.appendChild(r)}function q8(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function K8(t,e,n,r,i,s){const o=r[i];try{if(o)await e[o];else{const l=(await FA(n)).find(c=>c.measurementId===i);l&&await e[l.appId]}}catch(a){wn.error(a)}t("config",i,s)}async function G8(t,e,n,r,i){try{let s=[];if(i&&i.send_to){let o=i.send_to;Array.isArray(o)||(o=[o]);const a=await FA(n);for(const l of o){const c=a.find(h=>h.measurementId===l),d=c&&e[c.appId];if(d)s.push(d);else{s=[];break}}}s.length===0&&(s=Object.values(e)),await Promise.all(s),t("event",r,i||{})}catch(s){wn.error(s)}}function W8(t,e,n,r){async function i(s,...o){try{if(s==="event"){const[a,l]=o;await G8(t,e,n,a,l)}else if(s==="config"){const[a,l]=o;await K8(t,e,n,r,a,l)}else if(s==="consent"){const[a,l]=o;t("consent",a,l)}else if(s==="get"){const[a,l,c]=o;t("get",a,l,c)}else if(s==="set"){const[a]=o;t("set",a)}else t(s,...o)}catch(a){wn.error(a)}}return i}function Q8(t,e,n,r,i){let s=function(...o){window[r].push(arguments)};return window[i]&&typeof window[i]=="function"&&(s=window[i]),window[i]=W8(s,t,e,n),{gtagCore:s,wrappedGtag:window[i]}}function Y8(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(vv)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X8=30,J8=1e3;class Z8{constructor(e={},n=J8){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const $A=new Z8;function eB(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function tB(t){var e;const{appId:n,apiKey:r}=t,i={method:"GET",headers:eB(r)},s=F8.replace("{app-id}",n),o=await fetch(s,i);if(o.status!==200&&o.status!==304){let a="";try{const l=await o.json();!((e=l.error)===null||e===void 0)&&e.message&&(a=l.error.message)}catch{}throw Dn.create("config-fetch-failed",{httpStatus:o.status,responseMessage:a})}return o.json()}async function nB(t,e=$A,n){const{appId:r,apiKey:i,measurementId:s}=t.options;if(!r)throw Dn.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw Dn.create("no-api-key")}const o=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new sB;return setTimeout(async()=>{a.abort()},j8),UA({appId:r,apiKey:i,measurementId:s},o,a,e)}async function UA(t,{throttleEndTimeMillis:e,backoffCount:n},r,i=$A){var s;const{appId:o,measurementId:a}=t;try{await rB(r,e)}catch(l){if(a)return wn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${l==null?void 0:l.message}]`),{appId:o,measurementId:a};throw l}try{const l=await tB(t);return i.deleteThrottleMetadata(o),l}catch(l){const c=l;if(!iB(c)){if(i.deleteThrottleMetadata(o),a)return wn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${c==null?void 0:c.message}]`),{appId:o,measurementId:a};throw l}const d=Number((s=c==null?void 0:c.customData)===null||s===void 0?void 0:s.httpStatus)===503?cx(n,i.intervalMillis,X8):cx(n,i.intervalMillis),h={throttleEndTimeMillis:Date.now()+d,backoffCount:n+1};return i.setThrottleMetadata(o,h),wn.debug(`Calling attemptFetch again in ${d} millis`),UA(t,h,r,i)}}function rB(t,e){return new Promise((n,r)=>{const i=Math.max(e-Date.now(),0),s=setTimeout(n,i);t.addEventListener(()=>{clearTimeout(s),r(Dn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function iB(t){if(!(t instanceof yr)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class sB{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function oB(t,e,n,r,i){if(i&&i.global){t("event",n,r);return}else{const s=await e,o=Object.assign(Object.assign({},r),{send_to:s});t("event",n,o)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aB(){if(hy())try{await SS()}catch(t){return wn.warn(Dn.create("indexeddb-unavailable",{errorInfo:t==null?void 0:t.toString()}).message),!1}else return wn.warn(Dn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function lB(t,e,n,r,i,s,o){var a;const l=nB(t);l.then(m=>{n[m.measurementId]=m.appId,t.options.measurementId&&m.measurementId!==t.options.measurementId&&wn.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${m.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(m=>wn.error(m)),e.push(l);const c=aB().then(m=>{if(m)return r.getId()}),[d,h]=await Promise.all([l,c]);Y8(s)||H8(s,d.measurementId),i("js",new Date);const f=(a=o==null?void 0:o.config)!==null&&a!==void 0?a:{};return f[M8]="firebase",f.update=!0,h!=null&&(f[L8]=h),i("config",d.measurementId,f),d.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cB{constructor(e){this.app=e}_delete(){return delete gc[this.app.options.appId],Promise.resolve()}}let gc={},W1=[];const Q1={};let em="dataLayer",uB="gtag",Y1,BA,X1=!1;function dB(){const t=[];if(IS()&&t.push("This is a browser extension environment."),LM()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,i)=>`(${i+1}) ${r}`).join(" "),n=Dn.create("invalid-analytics-context",{errorInfo:e});wn.warn(n.message)}}function hB(t,e,n){dB();const r=t.options.appId;if(!r)throw Dn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)wn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Dn.create("no-api-key");if(gc[r]!=null)throw Dn.create("already-exists",{id:r});if(!X1){q8(em);const{wrappedGtag:s,gtagCore:o}=Q8(gc,W1,Q1,em,uB);BA=s,Y1=o,X1=!0}return gc[r]=lB(t,W1,Q1,e,Y1,em,n),new cB(t)}function fB(t=NS()){t=Dt(t);const e=_o(t,Yh);return e.isInitialized()?e.getImmediate():pB(t)}function pB(t,e={}){const n=_o(t,Yh);if(n.isInitialized()){const i=n.getImmediate();if(Pa(e,n.getOptions()))return i;throw Dn.create("already-initialized")}return n.initialize({options:e})}function mB(t,e,n,r){t=Dt(t),oB(BA,gc[t.app.options.appId],e,n,r).catch(i=>wn.error(i))}const J1="@firebase/analytics",Z1="0.10.8";function gB(){Vr(new mr(Yh,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("installations-internal").getImmediate();return hB(r,i,n)},"PUBLIC")),Vr(new mr("analytics-internal",t,"PRIVATE")),Qn(J1,Z1),Qn(J1,Z1,"esm2017");function t(e){try{const n=e.getProvider(Yh).getImmediate();return{logEvent:(r,i,s)=>mB(n,r,i,s)}}catch(n){throw Dn.create("interop-component-reg-failed",{reason:n})}}}gB();const yB={apiKey:"AIzaSyBRvglSh40aRJFOA9SNxoyBhNjslW_7p8k",authDomain:"detective-board-b108b.firebaseapp.com",projectId:"detective-board-b108b",storageBucket:"detective-board-b108b.firebasestorage.app",messagingSenderId:"140107009046",appId:"1:140107009046:web:49e3c650ea0e90a5f2b937",measurementId:"G-TBJ91VEM4Y"},_v=RS(yB);fB(_v);const Ga=v9(_v),yd=EU(_v,{localCache:KU({tabManager:YU()})}),vB=new Wr,HA=D.createContext();function wv(){return D.useContext(HA)}function _B({children:t}){const[e,n]=D.useState(null),[r,i]=D.useState(!0);D.useEffect(()=>o6(Ga,a=>{n(a),i(!1)}),[]);const s={currentUser:e};return p.jsx(HA.Provider,{value:s,children:!r&&t})}const wB=({onSwitchToSignUp:t,onForgotPassword:e,isDarkMode:n})=>{const[r,i]=D.useState(""),[s,o]=D.useState(""),[a,l]=D.useState(""),c=async h=>{h.preventDefault(),l("");try{await t6(Ga,r,s)}catch(f){console.error(f),l("Error: "+f.message)}},d=async()=>{l("");try{await C6(Ga,vB)}catch(h){console.error(h),h.code==="auth/cancelled-popup-request"?l(""):l("Error Google: "+h.message)}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:c,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${n?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${n?"text-white":"text-gray-800"}`,children:"INICIAR SESIN"}),a&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:a}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${n?"text-zinc-400":"text-gray-600"}`,htmlFor:"login-email",children:"Correo"}),p.jsxs("div",{className:"relative",children:[p.jsx(oy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${n?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"login-email",type:"email",placeholder:"detective@agencia.com",value:r,onChange:h=>i(h.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${n?"text-zinc-400":"text-gray-600"}`,htmlFor:"login-password",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Na,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${n?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${n?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"login-password",type:"password",placeholder:"",value:s,onChange:h=>o(h.target.value),required:!0})]})]}),p.jsxs("div",{className:"flex flex-col gap-4",children:[p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Entrar"}),p.jsxs("div",{className:"relative flex py-1 items-center",children:[p.jsx("div",{className:`flex-grow border-t ${n?"border-zinc-600":"border-gray-300"}`}),p.jsx("span",{className:`flex-shrink mx-2 text-xs ${n?"text-zinc-500":"text-gray-400"}`,children:"O"}),p.jsx("div",{className:`flex-grow border-t ${n?"border-zinc-600":"border-gray-300"}`})]}),p.jsxs("button",{onClick:d,type:"button",className:`flex items-center justify-center gap-3 font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition-all active:scale-95 ${n?"bg-white text-gray-700 hover:bg-gray-100":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-50"}`,children:[p.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[p.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),p.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),p.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),p.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),p.jsx("div",{className:"text-center mt-6",children:p.jsx("a",{onClick:e,className:"inline-block align-baseline font-bold text-sm text-blue-400 hover:text-blue-300 cursor-pointer",children:"Olvidaste tu contrasea?"})})]}),p.jsxs("p",{className:`text-center text-xs ${n?"text-zinc-500":"text-gray-500"}`,children:["No tienes cuenta?"," ",p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Regstrate aqu."})]})]})},xB=({onSwitchToLogin:t,isDarkMode:e})=>{const[n,r]=D.useState(""),[i,s]=D.useState(""),[o,a]=D.useState(""),[l,c]=D.useState(""),[d,h]=D.useState(""),f=async m=>{if(m.preventDefault(),o!==l)return h("Las contraseas no coinciden.");h("");try{const b=await e6(Ga,i,o);await r6(b.user,{displayName:n})}catch(b){console.error(b),b.code==="auth/email-already-in-use"?h("Este correo ya est en uso."):b.code==="auth/weak-password"?h("La contrasea es muy dbil (mnimo 6 caracteres)."):h("Error: "+b.message)}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:f,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${e?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${e?"text-white":"text-gray-800"}`,children:"CREAR CUENTA"}),d&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:d}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-name",children:"Nombre"}),p.jsxs("div",{className:"relative",children:[p.jsx(ay,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-name",type:"text",placeholder:"Sherlock Holmes",value:n,onChange:m=>r(m.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-email",children:"Correo"}),p.jsxs("div",{className:"relative",children:[p.jsx(oy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-email",type:"email",placeholder:"detective@agencia.com",value:i,onChange:m=>s(m.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-password",children:"Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Na,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-password",type:"password",placeholder:"",value:o,onChange:m=>a(m.target.value),required:!0})]})]}),p.jsxs("div",{className:"mb-6",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"signup-confirm-password",children:"Confirmar Contrasea"}),p.jsxs("div",{className:"relative",children:[p.jsx(Na,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 mb-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"signup-confirm-password",type:"password",placeholder:"",value:l,onChange:m=>c(m.target.value),required:!0})]})]}),p.jsx("div",{className:"flex flex-col gap-4",children:p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Registrarse"})})]}),p.jsxs("p",{className:`text-center text-xs ${e?"text-zinc-500":"text-gray-500"}`,children:["Ya tienes una cuenta?"," ",p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Inicia sesin."})]})]})},EB=({onSwitchToLogin:t,isDarkMode:e})=>{const[n,r]=D.useState(""),[i,s]=D.useState(""),[o,a]=D.useState(""),l=async c=>{c.preventDefault(),a(""),s("");try{await Zj(Ga,n),s("Revisa tu correo! Se ha enviado un enlace para restablecer tu contrasea.")}catch{a("Error al enviar el correo. Verifica que la direccin sea correcta.")}};return p.jsxs("div",{className:"w-full max-w-xs mx-auto",children:[p.jsxs("form",{onSubmit:l,className:`shadow-xl rounded-lg px-8 pt-6 pb-8 mb-4 border transition-colors duration-300 ${e?"bg-zinc-800 border-zinc-700":"bg-white border-gray-200"}`,children:[p.jsx("h2",{className:`text-2xl font-bold mb-6 text-center font-mono ${e?"text-white":"text-gray-800"}`,children:"RECUPERAR CONTRASEA"}),o&&p.jsx("p",{className:"bg-red-900/50 text-red-300 text-xs p-3 rounded mb-4",children:o}),i&&p.jsx("p",{className:"bg-green-900/50 text-green-300 text-xs p-3 rounded mb-4",children:i}),p.jsxs("div",{className:"mb-4",children:[p.jsx("label",{className:`block text-sm font-bold mb-2 ${e?"text-zinc-400":"text-gray-600"}`,htmlFor:"reset-email",children:"Correo Electrnico"}),p.jsxs("div",{className:"relative",children:[p.jsx(oy,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${e?"text-zinc-500":"text-gray-400"}`,size:16}),p.jsx("input",{className:`shadow appearance-none border rounded w-full py-2 pl-10 pr-3 leading-tight focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors ${e?"bg-zinc-700 border-zinc-600 text-white placeholder-zinc-500":"bg-gray-50 border-gray-300 text-gray-900 placeholder-gray-400"}`,id:"reset-email",type:"email",placeholder:"detective@agencia.com",value:n,onChange:c=>r(c.target.value),required:!0})]})]}),p.jsx("div",{className:"flex flex-col gap-4",children:p.jsx("button",{className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline uppercase transition-transform active:scale-95",type:"submit",children:"Enviar Enlace"})})]}),p.jsx("p",{className:`text-center text-xs ${e?"text-zinc-500":"text-gray-500"}`,children:p.jsx("a",{onClick:t,className:"text-red-400 hover:text-red-300 font-bold cursor-pointer",children:"Volver a Iniciar Sesin"})})]})},bB=()=>{const[t,e]=D.useState("login"),[n,r]=D.useState(!0),i=()=>{switch(t){case"signup":return p.jsx(xB,{onSwitchToLogin:()=>e("login"),isDarkMode:n});case"forgot":return p.jsx(EB,{onSwitchToLogin:()=>e("login"),isDarkMode:n});case"login":default:return p.jsx(wB,{onSwitchToSignUp:()=>e("signup"),onForgotPassword:()=>e("forgot"),isDarkMode:n})}};return p.jsxs("div",{className:`w-screen h-screen flex flex-col items-center justify-center p-4 transition-colors duration-500 ${n?"bg-zinc-900":"bg-gray-100"}`,children:[p.jsx("button",{onClick:()=>r(!n),className:`absolute top-4 right-4 p-2 rounded-full transition-colors ${n?"bg-zinc-800 text-yellow-400 hover:bg-zinc-700":"bg-white text-gray-600 hover:bg-gray-200 shadow-sm"}`,children:n?p.jsx(sS,{size:20}):p.jsx(eS,{size:20})}),p.jsx("h1",{className:`text-5xl font-black font-mono mb-8 tracking-[0.2em] uppercase text-center ${n?"text-zinc-500":"text-zinc-400"}`,children:"DETECTIVE BOARD"}),p.jsx("div",{className:"w-full flex justify-center animate-in fade-in slide-in-from-bottom-8 duration-500",children:i()},t)]})},IB=()=>{const{currentUser:t}=wv(),e=D.useCallback(async(s,o)=>{if(!(!t||!s))try{const a=Xp(yd,"users",t.uid,"boards",s),l=JSON.parse(JSON.stringify(o));await UU(a,{...l,updatedAt:XU(),ownerId:t.uid},{merge:!0})}catch(a){console.error("Error al guardar en Firestore:",a)}},[t]),n=D.useCallback(async s=>{if(!t||!s)return null;try{const o=Xp(yd,"users",t.uid,"boards",s),a=await FU(o);return a.exists()?a.data():null}catch(o){throw console.error("Error al cargar de Firestore:",o),o}},[t]),r=D.useCallback(async()=>{if(!t)return[];try{const s=xU(yd,"users",t.uid,"boards"),o=OU(s);return(await $U(o)).docs.map(l=>({id:l.id,...l.data()}))}catch(s){throw console.error("Error al obtener tableros:",s),s}},[t]),i=D.useCallback(async s=>{t&&await BU(Xp(yd,"users",t.uid,"boards",s))},[t]);return{saveBoard:e,loadBoard:n,getBoards:r,deleteBoard:i}},TB=()=>{var Ei,br,Un;const t=D.useRef(null),{currentUser:e}=wv(),[n,r]=D.useState(!1),[i,s,o]=wO([]),[a,l,c]=xO([]),[d,h]=D.useState(null),[f,m]=D.useState(!1),[b,x]=D.useState(null),[R,y]=D.useState(null),[v,T]=D.useState(null),[A,O]=D.useState({isOpen:!1,title:"",message:"",onConfirm:null,isDanger:!1}),[L,S]=D.useState(!1),[I,w]=D.useState(!1),[E,C]=D.useState(null),[N,k]=D.useState(null),[P,j]=D.useState(!1),[z,U]=D.useState(!1),F=D.useRef(!1),{saveBoard:M,loadBoard:B,getBoards:G}=IB(),{connectionColor:$,setConnectionColor:Y,connectionLineType:X,setConnectionLineType:ee,isInteractive:re,setIsInteractive:fe,isDarkMode:ie,setIsDarkMode:xe,searchTerm:ve,setSearchTerm:Re,isSidebarOpen:Le,setIsSidebarOpen:tt,isZenMode:Me,setIsZenMode:Ve,bgType:Be,setBgType:Ee,toggleBackground:oe}=xM("cork"),{nodeTypes:Ce,edgeTypes:St,proOptions:En,connectionLineStyle:jn,nodeColor:Qt}=pM({connectionColor:$}),{takeSnapshot:Ye,undo:gt,redo:Ne,clearHistory:ze,onNodesChangeWithHistory:Ct,onEdgesChangeWithHistory:Yt,animateAndRemoveNode:vr,animateAndRemoveEdge:yt}=gM({nodes:i,edges:a,setNodes:s,setEdges:l,onNodesChange:o,onEdgesChange:c}),{boards:Ke,setBoards:sn,trash:Fn,currentBoardId:Ge,setCurrentBoardId:on,handleSwitchBoard:Xt,handleCreateBoard:Zn,handleDeleteBoard:yi,handleRestoreBoard:_r,handlePermanentDelete:er,handleRenameBoard:vi,handleReorderBoards:bn,handleCloneBoard:tr}=KL({nodes:i,edges:a,bgType:Be,setNodes:s,setEdges:l,setBgType:Ee,reactFlowInstance:d,clearHistory:ze,setCaseManagerOpen:r,setConfirmModal:O,lastSaved:R});D.useEffect(()=>{(async()=>{if(e){U(!1);try{const me=await G();if(me.length>0){const Ae=me.map(Pe=>{var Xe,$r;return{...Pe,createdAt:(Xe=Pe.createdAt)!=null&&Xe.toMillis?Pe.createdAt.toMillis():Pe.createdAt||Date.now(),lastModified:($r=Pe.updatedAt)!=null&&$r.toMillis?Pe.updatedAt.toMillis():Pe.updatedAt||Date.now()}}).sort((Pe,Xe)=>Xe.lastModified-Pe.lastModified);sn(Ae),(!Ge||!Ae.find(Pe=>Pe.id===Ge))&&on(Ae[0].id)}else console.log("No se encontraron tableros remotos.")}catch(me){console.error("Error sincronizando tableros:",me)}finally{U(!0)}}})()},[e,G,sn,on]),D.useEffect(()=>{(async()=>{var me;if(z&&Ge){j(!0),F.current=!1;try{const Ae=await B(Ge);Ae?(s(Ae.nodes||[]),l(Ae.edges||[]),Ae.bgType&&Ee(Ae.bgType),F.current=!0):Ke.some(Xe=>Xe.id===Ge)?(s([]),l([]),F.current=!0):console.warn("ID de tablero obsoleto detectado, omitiendo carga para evitar sobrescritura.")}catch(Ae){Ae.code==="unavailable"||(me=Ae.message)!=null&&me.includes("offline")?console.warn("Modo offline: No se pudo sincronizar con la nube, usando cach local si existe."):console.error("Error cargando tablero:",Ae)}finally{j(!1)}}})()},[Ge,B,s,l,Ee,z,Ke]),D.useEffect(()=>{if(P||!F.current)return;const _e=setTimeout(()=>{var me;Ge&&(M(Ge,{nodes:i,edges:a,bgType:Be,name:((me=Ke.find(Ae=>Ae.id===Ge))==null?void 0:me.name)||"Caso Sin Nombre"}),y(new Date))},2e3);return()=>clearTimeout(_e)},[i,a,Be,Ge,M,Ke,P]),D.useEffect(()=>{const _e=me=>{me.preventDefault(),me.returnValue=""};return window.addEventListener("beforeunload",_e),()=>window.removeEventListener("beforeunload",_e)},[]),Xz({isInteractive:re,reactFlowInstance:d,takeSnapshot:Ye,setNodes:s});const{onConnect:xo,onEdgeContextMenu:_i,onEdgeClick:Eo,onPaneClick:wr,onNodeDoubleClick:bo,onNodeDragStart:xt,onMoveStart:Io,onMoveEnd:jr,selectionRect:an,handleRightPointerDown:cl}=vM({isInteractive:re,reactFlowInstance:d,reactFlowWrapper:t,setEdges:l,setNodes:s,connectionLineType:X,connectionColor:$,takeSnapshot:Ye,setEditingNode:x,setEditingEdge:C,setInputModalOpen:w,setEditModalOpen:m,setMenu:T});D.useEffect(()=>{const _e=me=>{me.key==="Escape"&&Me&&Ve(!1)};return window.addEventListener("keydown",_e),()=>window.removeEventListener("keydown",_e)},[Me]);const{handleSaveNode:ul,handleDeleteNode:xr,duplicateSelected:dl,handleConnectionColorChange:hl,handleConnectionLineTypeChange:wi,handleEdgeDelete:_s,handleInputModalConfirm:ws}=EM({reactFlowInstance:d,setNodes:s,setEdges:l,takeSnapshot:Ye,animateAndRemoveNode:vr,animateAndRemoveEdge:yt,setEditModalOpen:m,setEditingNode:x,setEditingEdge:C,setInputModalOpen:w,setConnectionColor:Y,setConnectionLineType:ee,setPendingStampNodeId:k}),{onDragOver:xi,onDrop:$n}=WL({isInteractive:re,reactFlowInstance:d,setNodes:s,takeSnapshot:Ye,setPendingStampNodeId:k,setInputModalOpen:w,setEditingEdge:C,setEditingNode:x}),{onSave:xs,onLoad:To,onClear:Es}=_M({reactFlowInstance:d,boards:Ke,currentBoardId:Ge,bgType:Be,setBoards:sn,setNodes:s,setEdges:l,setBgType:Ee,handleSwitchBoard:Xt,clearHistory:ze,takeSnapshot:Ye,setConfirmModal:O}),{navigateSearch:Fr}=wM({searchTerm:ve,setNodes:s,reactFlowInstance:d}),bs=K.useCallback(()=>{Ye(),s(_e=>{const me=_e.filter(Pe=>Pe.selected);if(me.length===0)return _e;const Ae=me.some(Pe=>!Pe.data.locked);return _e.map(Pe=>Pe.selected?{...Pe,data:{...Pe.data,locked:Ae},draggable:!Ae}:Pe)})},[s,Ye]);D.useEffect(()=>{const _e=me=>{["INPUT","TEXTAREA","SELECT"].includes(me.target.tagName)||me.target.isContentEditable||(me.ctrlKey||me.metaKey)&&me.shiftKey&&me.key.toLowerCase()==="l"&&(me.preventDefault(),bs())};return window.addEventListener("keydown",_e),()=>window.removeEventListener("keydown",_e)},[bs]),D.useEffect(()=>{const _e=i.filter(me=>me.selected).map(me=>me.id);l(me=>{let Ae=!1;const Pe=me.map(Xe=>{var pl;const $r=_e.includes(Xe.source)||_e.includes(Xe.target),Co=(pl=Xe.className)==null?void 0:pl.includes("animated-flow");if($r&&!Co){Ae=!0;const bu=(Xe.className||"").replace("quick-draw","").trim();return{...Xe,className:`${bu} animated-flow`.trim()}}else if(!$r&&Co)return Ae=!0,{...Xe,className:(Xe.className||"").replace("animated-flow","").trim()};return Xe});return Ae?Pe:me})},[i,l]),D.useEffect(()=>{if(a.some(me=>{var Ae;return(Ae=me.className)==null?void 0:Ae.includes("quick-draw")})){const me=setTimeout(()=>{l(Ae=>Ae.map(Pe=>{var Xe;return(Xe=Pe.className)!=null&&Xe.includes("quick-draw")?{...Pe,className:Pe.className.replace("quick-draw","").trim()}:Pe}))},1e3);return()=>clearTimeout(me)}},[a,l]);const{isExporting:Is,onExport:fl}=HL({reactFlowWrapper:t,reactFlowInstance:d,boards:Ke,currentBoardId:Ge,bgType:Be,isDarkMode:ie,setNodes:s});GL({onSave:xs,undo:gt,redo:Ne,duplicateSelected:dl,navigateSearch:Fr,reactFlowInstance:d,edges:a,setEdges:l,takeSnapshot:Ye,connectionLineType:X,connectionColor:$});const Er=Ke.find(_e=>_e.id===Ge),So=async()=>{try{await a6(Ga)}catch(_e){console.error("Error al cerrar sesin",_e)}};return p.jsx("div",{className:`flex h-screen w-screen transition-colors duration-500 ease-in-out ${ie?"bg-[#1a1a1a]":"bg-gray-50 light-mode"}`,children:p.jsx(yS.Provider,{value:ie,children:p.jsxs(ty,{children:[!Me&&p.jsx(jz,{connectionColor:$,setConnectionColor:hl,connectionLineType:X,setConnectionLineType:wi,lastSaved:R,onSave:xs,onLoad:To,onClear:Es,onHelp:()=>S(!0),isDarkMode:ie,toggleTheme:()=>xe(!ie),searchTerm:ve,setSearchTerm:Re,onExport:fl,isOpen:Le,onToggle:()=>tt(!Le),onOpenCaseManager:()=>r(!0),currentBoardName:Er==null?void 0:Er.name,onToggleZen:()=>Ve(!0),onNextMatch:()=>Fr("next"),onPrevMatch:()=>Fr("prev"),onToggleBg:oe,onLogout:So,currentUser:e,isSyncing:P||!z}),p.jsxs("div",{className:"flex-grow h-full relative overflow-hidden",ref:t,style:{"--connection-color":$},onPointerDown:cl,onContextMenu:_e=>_e.preventDefault(),children:[p.jsx(Yz,{isZenMode:Me,setIsZenMode:Ve,undo:gt,redo:Ne,isDarkMode:ie}),p.jsxs(FT,{nodes:i,edges:a,onNodesChange:Ct,onEdgesChange:Yt,onConnect:xo,onInit:h,onDrop:$n,onDragOver:xi,onNodeDoubleClick:bo,onEdgeClick:Eo,onEdgeContextMenu:_i,onPaneClick:wr,nodeTypes:Ce,edgeTypes:St,fitView:!0,className:`${Be==="cork"?"cork-pattern":Be==="blackboard"?"blackboard-pattern":"graph-paper-pattern"} ${re?"":"board-locked"} ${ie?"":"light-mode"}`,connectionLineType:X,connectionLineStyle:jn,nodesDraggable:re,proOptions:En,elevateNodesOnSelect:!1,nodesConnectable:re,elementsSelectable:re,panOnDrag:re,zoomOnScroll:re,zoomOnPinch:re,panOnScroll:re,zoomOnDoubleClick:re,onNodeDragStart:xt,onMoveStart:Io,onMoveEnd:jr,connectionRadius:30,children:[!Me&&p.jsx(MO,{showInteractive:!0,onInteractiveChange:fe,fitViewOptions:{duration:800,padding:.2},style:{left:Le?"340px":"10px",transition:"left 0.2s ease-in-out"}}),!Me&&p.jsx(NO,{nodeColor:Qt,maskColor:ie?"rgba(0, 0, 0, 0.6)":"rgba(0, 0, 0, 0.1)",className:ie?"bg-zinc-900 border border-zinc-800":"bg-white border border-gray-200 shadow-md"}),p.jsx(HO,{gap:20,size:1,color:ie?"#444":"#aaa",variant:"dots",className:"opacity-20"}),v&&p.jsx(qz,{onClick:wr,...v,onHide:()=>T(null),takeSnapshot:Ye,setNodes:s}),i.length===0&&p.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-10 select-none",children:p.jsxs("div",{className:`text-center ${ie?"opacity-10":"opacity-20"}`,children:[p.jsx("h1",{className:"text-5xl md:text-7xl font-black text-zinc-500 font-mono mb-4 tracking-[0.2em] uppercase",children:"CONFIDENCIAL"}),p.jsx("p",{className:"text-sm text-zinc-500 font-mono uppercase tracking-widest",children:"Arrastra evidencia o haz doble clic"})]})}),p.jsx("svg",{style:{position:"absolute",top:0,left:0,width:0,height:0,pointerEvents:"none"},children:p.jsx("defs",{children:p.jsxs("filter",{id:"yarn-texture",x:"-20%",y:"-20%",width:"140%",height:"140%",children:[p.jsx("feTurbulence",{type:"fractalNoise",baseFrequency:"0.8",numOctaves:"3",result:"noise"}),p.jsx("feDisplacementMap",{in:"SourceGraphic",in2:"noise",scale:"1.5"})]})})})]}),p.jsx("div",{className:"absolute inset-0 pointer-events-none z-[5] bg-[radial-gradient(circle_at_center,transparent_40%,rgba(0,0,0,0.6)_100%)]"}),Is&&p.jsxs("div",{className:"absolute inset-0 z-[100] bg-black/90 flex flex-col items-center justify-center backdrop-blur-sm animate-in fade-in duration-200 cursor-wait",children:[p.jsx("div",{className:"w-16 h-16 border-4 border-red-600 border-t-transparent rounded-full animate-spin mb-4"}),p.jsx("h2",{className:"text-xl font-bold text-white font-mono tracking-widest animate-pulse",children:"REVELANDO EVIDENCIA..."}),p.jsx("p",{className:"text-zinc-400 text-xs font-mono mt-2",children:"Procesando fotografa del tablero completo."})]}),an&&an.isDragging&&p.jsx("div",{className:"absolute z-50 pointer-events-none",style:{left:`${an.x}px`,top:`${an.y}px`,width:`${an.width}px`,height:`${an.height}px`,border:"2px dashed #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)"}})]}),p.jsx(Fz,{isOpen:f,onClose:()=>m(!1),node:b,onSave:ul,onDelete:xr,isDarkMode:ie}),p.jsx(Kz,{isOpen:A.isOpen,onClose:()=>O(_e=>({..._e,isOpen:!1})),onConfirm:A.onConfirm,title:A.title,message:A.message,isDanger:A.isDanger,confirmText:A.confirmText,cancelText:A.cancelText,isDarkMode:ie}),p.jsx(Gz,{isOpen:L,onClose:()=>S(!1),isDarkMode:ie}),p.jsx(Wz,{isOpen:I,onClose:()=>{w(!1),C(null),x(null),k(null)},onConfirm:(_e,me,Ae)=>ws(_e,me,Ae,E,b,N),onDelete:()=>{N?(Ye(),s(_e=>_e.map(me=>me.id===N?{...me,data:{...me.data,status:null}}:me)),w(!1),k(null)):_s(E,b)},title:E?"EDITAR CONEXIN":N?"CREAR SELLO":"EDITAR ZONA",initialValue:E?E.label||"":N?"":((Ei=b==null?void 0:b.data)==null?void 0:Ei.label)||"",initialColor:E?((br=E.style)==null?void 0:br.stroke)||"#dc2626":N?"#dc2626":((Un=b==null?void 0:b.style)==null?void 0:Un.borderColor)||"#71717a",initialType:E==null?void 0:E.type,showTypeSelector:!!E,colorLabel:E?"Color del Hilo":N?"Color del Sello":"Color de Zona",placeholder:N?"Texto del sello (ej: CONFIRMADO)":"Escribe una etiqueta...",isDarkMode:ie}),p.jsx(Qz,{isOpen:n,onClose:()=>r(!1),boards:Ke,currentBoardId:Ge,onSwitch:Xt,onCreate:Zn,onDelete:yi,onRename:vi,onClone:tr,onReorder:bn,trash:Fn,onRestore:_r,onPermanentDelete:er,isDarkMode:ie})]})})})},SB=()=>{const{currentUser:t}=wv();return D.useEffect(()=>{document.title="Detective Board";const e="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%2024%2024%22%20fill%3D%22none%22%20stroke%3D%22%23dc2626%22%20stroke-width%3D%222.5%22%20stroke-linecap%3D%22round%22%20stroke-linejoin%3D%22round%22%3E%3Ccircle%20cx%3D%2211%22%20cy%3D%2211%22%20r%3D%228%22%3E%3C%2Fcircle%3E%3Cline%20x1%3D%2221%22%20y1%3D%2221%22%20x2%3D%2216.65%22%20y2%3D%2216.65%22%3E%3C%2Fline%3E%3C%2Fsvg%3E";let n=document.querySelector("link[rel~='icon']");n||(n=document.createElement("link"),n.rel="icon",document.head.appendChild(n)),n.href=e},[]),t?p.jsx(TB,{}):p.jsx(bB,{})};tm.createRoot(document.getElementById("root")).render(p.jsx(K.StrictMode,{children:p.jsx(_B,{children:p.jsx(SB,{})})}));
